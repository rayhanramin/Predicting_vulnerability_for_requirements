<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20053:096b191f8462122f21500bd9343d7a66aabe5ab7</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 096b191f8462122f21500bd9343d7a66aabe5ab7" />
<meta property="og:url" content="/comm-central/rev/096b191f8462122f21500bd9343d7a66aabe5ab7" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable object-curly-spacing rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 096b191f8462122f21500bd9343d7a66aabe5ab7 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/096b191f8462122f21500bd9343d7a66aabe5ab7">shortlog</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/096b191f8462122f21500bd9343d7a66aabe5ab7">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7">files</a> |
changeset |
<a href="/comm-central/raw-rev/096b191f8462122f21500bd9343d7a66aabe5ab7">raw</a>  | <a href="/comm-central/archive/096b191f8462122f21500bd9343d7a66aabe5ab7.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable object-curly-spacing rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 13:59:36 +0200</td></tr>

<tr>
 <td>changeset 20053</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/096b191f8462122f21500bd9343d7a66aabe5ab7">096b191f8462122f21500bd9343d7a66aabe5ab7</a></td>
</tr>



<tr>
<td>parent 20052</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/377282fc615d97ac51cdc94ed1f52f8e7cc702f1">377282fc615d97ac51cdc94ed1f52f8e7cc702f1</a>
</td>
</tr>

<tr>
<td>child 20054</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/553bba9bac6170bf502c352648823625cad9e606">553bba9bac6170bf502c352648823625cad9e606</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=096b191f8462122f21500bd9343d7a66aabe5ab7">12301</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Fri, 16 Sep 2016 20:42:08 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@c4a3561ecc3f [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=c4a3561ecc3f9a5e8db41c904c144d71362007fa">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=c4a3561ecc3f9a5e8db41c904c144d71362007fa&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=c4a3561ecc3f9a5e8db41c904c144d71362007fa&newProject=comm-central&newRevision=096b191f8462122f21500bd9343d7a66aabe5ab7&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=c4a3561ecc3f9a5e8db41c904c144d71362007fa&newProject=comm-central&newRevision=096b191f8462122f21500bd9343d7a66aabe5ab7&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=c4a3561ecc3f9a5e8db41c904c144d71362007fa&newProject=comm-central&newRevision=096b191f8462122f21500bd9343d7a66aabe5ab7&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable object-curly-spacing rule. r=MakeMyDay

MozReview-Commit-ID: 6SfKzSo0c6c</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/backend/icaljs/calICSService-worker.js">calendar/base/backend/icaljs/calICSService-worker.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/backend/icaljs/calICSService-worker.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/backend/icaljs/calICSService-worker.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/backend/icaljs/calICSService-worker.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/backend/icaljs/calICSService-worker.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/backend/icaljs/calICSService-worker.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/agenda-listbox.js">calendar/base/content/agenda-listbox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/agenda-listbox.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/agenda-listbox.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/agenda-listbox.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/agenda-listbox.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/agenda-listbox.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-task-tree.xml">calendar/base/content/calendar-task-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-task-tree.xml">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-task-tree.xml">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-task-tree.xml">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-task-tree.xml">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-task-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-ui-utils.js">calendar/base/content/calendar-ui-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-ui-utils.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-ui-utils.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-ui-utils.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-ui-utils.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-ui-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-unifinder.js">calendar/base/content/calendar-unifinder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-unifinder.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-unifinder.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-unifinder.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-unifinder.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/calendar-unifinder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/today-pane.js">calendar/base/content/today-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/today-pane.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/today-pane.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/today-pane.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/today-pane.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/today-pane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/widgets/calendar-alarm-widget.xml">calendar/base/content/widgets/calendar-alarm-widget.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/widgets/calendar-alarm-widget.xml">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/widgets/calendar-alarm-widget.xml">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/widgets/calendar-alarm-widget.xml">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/widgets/calendar-alarm-widget.xml">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/content/widgets/calendar-alarm-widget.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calAuthUtils.jsm">calendar/base/modules/calAuthUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calAuthUtils.jsm">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calAuthUtils.jsm">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calAuthUtils.jsm">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calAuthUtils.jsm">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calAuthUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calExtract.jsm">calendar/base/modules/calExtract.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calExtract.jsm">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calExtract.jsm">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calExtract.jsm">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calExtract.jsm">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/modules/calExtract.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calTimezoneService.js">calendar/base/src/calTimezoneService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calTimezoneService.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calTimezoneService.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calTimezoneService.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calTimezoneService.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calTimezoneService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/html-item-editing/react-code.js">calendar/lightning/content/html-item-editing/react-code.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/html-item-editing/react-code.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/html-item-editing/react-code.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/html-item-editing/react-code.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/html-item-editing/react-code.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/html-item-editing/react-code.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/imip-bar.js">calendar/lightning/content/imip-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/imip-bar.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/imip-bar.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/imip-bar.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/imip-bar.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/lightning/content/imip-bar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/shared-modules/calendar-utils.js">calendar/test/mozmill/shared-modules/calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/shared-modules/calendar-utils.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/shared-modules/calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/shared-modules/calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/shared-modules/calendar-utils.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/shared-modules/calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/testAlarmDefaultValue.js">calendar/test/mozmill/testAlarmDefaultValue.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/testAlarmDefaultValue.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/testAlarmDefaultValue.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/testAlarmDefaultValue.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/testAlarmDefaultValue.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/testAlarmDefaultValue.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/timezoneTests/test2.js">calendar/test/mozmill/timezoneTests/test2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/timezoneTests/test2.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/timezoneTests/test2.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/timezoneTests/test2.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/timezoneTests/test2.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/mozmill/timezoneTests/test2.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/head_consts.js">calendar/test/unit/head_consts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/head_consts.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/head_consts.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/head_consts.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/head_consts.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/head_consts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_bug1199942.js">calendar/test/unit/test_bug1199942.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_bug1199942.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_bug1199942.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_bug1199942.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_bug1199942.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_bug1199942.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_calutils.js">calendar/test/unit/test_calutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_calutils.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_calutils.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_calutils.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_calutils.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_calutils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_extract.js">calendar/test/unit/test_extract.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_extract.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_extract.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_extract.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_extract.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_extract.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_freebusy_service.js">calendar/test/unit/test_freebusy_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_freebusy_service.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_freebusy_service.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_freebusy_service.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_freebusy_service.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_freebusy_service.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_gdata_provider.js">calendar/test/unit/test_gdata_provider.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_gdata_provider.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_gdata_provider.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_gdata_provider.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_gdata_provider.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_gdata_provider.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_ltninvitationutils.js">calendar/test/unit/test_ltninvitationutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_ltninvitationutils.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_ltninvitationutils.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_ltninvitationutils.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_ltninvitationutils.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_ltninvitationutils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_search_service.js">calendar/test/unit/test_search_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_search_service.js">file</a> |
<a href="/comm-central/annotate/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_search_service.js">annotate</a> |
<a href="/comm-central/diff/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_search_service.js">diff</a> |
<a href="/comm-central/comparison/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_search_service.js">comparison</a> |
<a href="/comm-central/log/096b191f8462122f21500bd9343d7a66aabe5ab7/calendar/test/unit/test_search_service.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -205,16 +205,19 @@</span>
<a href="#l1.4"></a><span id="l1.4">     &quot;no-var&quot;: 0,</span>
<a href="#l1.5"></a><span id="l1.5">     &quot;mozilla/var-only-at-top-level&quot;: 1,</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">     // Disallow global and local variables that aren't used, but allow unused function arguments.</span>
<a href="#l1.8"></a><span id="l1.8">     &quot;no-unused-vars&quot;: [2, {&quot;vars&quot;: &quot;all&quot;, &quot;args&quot;: &quot;none&quot;, &quot;varsIgnorePattern&quot;: &quot;EXPORTED_SYMBOLS&quot;}],</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">     &quot;mozilla/mark-test-function-used&quot;: 1,</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // Require padding inside curly braces</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    &quot;object-curly-spacing&quot;: [2, &quot;always&quot;],</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+</span>
<a href="#l1.15"></a><span id="l1.15">     // Will enable these rules later</span>
<a href="#l1.16"></a><span id="l1.16">     &quot;block-spacing&quot;: 0,</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;no-lonely-if&quot;: 0,</span>
<a href="#l1.18"></a><span id="l1.18">     &quot;space-before-blocks&quot;: 0,</span>
<a href="#l1.19"></a><span id="l1.19">     &quot;computed-property-spacing&quot;: 0,</span>
<a href="#l1.20"></a><span id="l1.20">     &quot;consistent-return&quot;: 0,</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22">     // The following rules will not be enabled currently, but are kept here for</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calICSService-worker.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calICSService-worker.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -11,12 +11,12 @@ var NS_ERROR_FAILURE = 2147500037;</span>
<a href="#l2.4"></a><span id="l2.4"> </span>
<a href="#l2.5"></a><span id="l2.5"> importScripts(&quot;resource://calendar/modules/ical.js&quot;);</span>
<a href="#l2.6"></a><span id="l2.6"> </span>
<a href="#l2.7"></a><span id="l2.7"> onmessage = function onmessage(event) {</span>
<a href="#l2.8"></a><span id="l2.8">     try {</span>
<a href="#l2.9"></a><span id="l2.9">         let comp = ICAL.parse(event.data);</span>
<a href="#l2.10"></a><span id="l2.10">         postMessage({ rc: NS_OK, data: comp });</span>
<a href="#l2.11"></a><span id="l2.11">     } catch (e) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        postMessage({ rc: NS_ERROR_FAILURE, data: &quot;Exception occurred: &quot; + e});</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        postMessage({ rc: NS_ERROR_FAILURE, data: &quot;Exception occurred: &quot; + e });</span>
<a href="#l2.14"></a><span id="l2.14">     }</span>
<a href="#l2.15"></a><span id="l2.15">     close();</span>
<a href="#l2.16"></a><span id="l2.16"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -140,48 +140,48 @@ function onCheckboxChange(event) {</span>
<a href="#l3.4"></a><span id="l3.4">                 leaveloop = (!agendaListbox.isEventListItem(listItem));</span>
<a href="#l3.5"></a><span id="l3.5">                 if (!leaveloop) {</span>
<a href="#l3.6"></a><span id="l3.6">                     listItem.remove();</span>
<a href="#l3.7"></a><span id="l3.7">                     listItem = nextItemSibling;</span>
<a href="#l3.8"></a><span id="l3.8">                 }</span>
<a href="#l3.9"></a><span id="l3.9">             }</span>
<a href="#l3.10"></a><span id="l3.10">         } while (!leaveloop);</span>
<a href="#l3.11"></a><span id="l3.11">     }</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    calendarController.onSelectionChanged({detail: []});</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    calendarController.onSelectionChanged({ detail: [] });</span>
<a href="#l3.14"></a><span id="l3.14"> };</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16"> /**</span>
<a href="#l3.17"></a><span id="l3.17">  * Handler function called when an agenda listbox item is selected</span>
<a href="#l3.18"></a><span id="l3.18">  *</span>
<a href="#l3.19"></a><span id="l3.19">  * @param aListItem     The agenda-base-richlist-item that was selected.</span>
<a href="#l3.20"></a><span id="l3.20">  */</span>
<a href="#l3.21"></a><span id="l3.21"> agendaListbox.onSelect =</span>
<a href="#l3.22"></a><span id="l3.22"> function onSelect(aListItem) {</span>
<a href="#l3.23"></a><span id="l3.23">     let listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l3.24"></a><span id="l3.24">     let item = aListItem || listbox.selectedItem;</span>
<a href="#l3.25"></a><span id="l3.25">     if (aListItem) {</span>
<a href="#l3.26"></a><span id="l3.26">         listbox.selectedItem = item;</span>
<a href="#l3.27"></a><span id="l3.27">     }</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineminus">-    calendarController.onSelectionChanged({detail: agendaListbox.getSelectedItems()});</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+    calendarController.onSelectionChanged({ detail: agendaListbox.getSelectedItems() });</span>
<a href="#l3.30"></a><span id="l3.30"> };</span>
<a href="#l3.31"></a><span id="l3.31"> </span>
<a href="#l3.32"></a><span id="l3.32"> /**</span>
<a href="#l3.33"></a><span id="l3.33">  * Handler function called when the agenda listbox becomes focused</span>
<a href="#l3.34"></a><span id="l3.34">  */</span>
<a href="#l3.35"></a><span id="l3.35"> agendaListbox.onFocus =</span>
<a href="#l3.36"></a><span id="l3.36"> function onFocus() {</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-    calendarController.onSelectionChanged({detail: agendaListbox.getSelectedItems()});</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+    calendarController.onSelectionChanged({ detail: agendaListbox.getSelectedItems() });</span>
<a href="#l3.39"></a><span id="l3.39"> };</span>
<a href="#l3.40"></a><span id="l3.40"> </span>
<a href="#l3.41"></a><span id="l3.41"> /**</span>
<a href="#l3.42"></a><span id="l3.42">  * Handler function called when the agenda listbox loses focus.</span>
<a href="#l3.43"></a><span id="l3.43">  */</span>
<a href="#l3.44"></a><span id="l3.44"> agendaListbox.onBlur =</span>
<a href="#l3.45"></a><span id="l3.45"> function onBlur() {</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-    calendarController.onSelectionChanged({detail: []});</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineplus">+    calendarController.onSelectionChanged({ detail: [] });</span>
<a href="#l3.48"></a><span id="l3.48"> };</span>
<a href="#l3.49"></a><span id="l3.49"> </span>
<a href="#l3.50"></a><span id="l3.50"> </span>
<a href="#l3.51"></a><span id="l3.51"> /**</span>
<a href="#l3.52"></a><span id="l3.52">  * Handler function called when a key was pressed on the agenda listbox</span>
<a href="#l3.53"></a><span id="l3.53">  */</span>
<a href="#l3.54"></a><span id="l3.54"> agendaListbox.onKeyPress =</span>
<a href="#l3.55"></a><span id="l3.55"> function onKeyPress(aEvent) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -552,17 +552,17 @@ function promptOccurrenceModification(aI</span>
<a href="#l4.4"></a><span id="l4.4">     } else if (aItem.parentItem.recurrenceInfo.getExceptionFor(aItem.recurrenceId)) {</span>
<a href="#l4.5"></a><span id="l4.5">         // If the user wants to edit an occurrence which is already an exception</span>
<a href="#l4.6"></a><span id="l4.6">         // always edit this single item.</span>
<a href="#l4.7"></a><span id="l4.7">         // XXX  Why? I think its ok to ask also for exceptions.</span>
<a href="#l4.8"></a><span id="l4.8">         type = MODIFY_OCCURRENCE;</span>
<a href="#l4.9"></a><span id="l4.9">     } else {</span>
<a href="#l4.10"></a><span id="l4.10">         // Prompt the user. Setting modal blocks the dialog until it is closed. We</span>
<a href="#l4.11"></a><span id="l4.11">         // use rv to pass our return value.</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-        let rv = { value: CANCEL, item: aItem, action: aAction};</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+        let rv = { value: CANCEL, item: aItem, action: aAction };</span>
<a href="#l4.14"></a><span id="l4.14">         window.openDialog(&quot;chrome://calendar/content/calendar-occurrence-prompt.xul&quot;,</span>
<a href="#l4.15"></a><span id="l4.15">                           &quot;PromptOccurrenceModification&quot;,</span>
<a href="#l4.16"></a><span id="l4.16">                           &quot;centerscreen,chrome,modal,titlebar&quot;,</span>
<a href="#l4.17"></a><span id="l4.17">                           rv);</span>
<a href="#l4.18"></a><span id="l4.18">         type = rv.value;</span>
<a href="#l4.19"></a><span id="l4.19">     }</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">     switch (type) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -920,27 +920,27 @@</span>
<a href="#l5.4"></a><span id="l5.4">            * Step 1: Look for an existing column with room for the item.</span>
<a href="#l5.5"></a><span id="l5.5">            * Step 2: Look for a previously placed item that can be shrunk in</span>
<a href="#l5.6"></a><span id="l5.6">            *         width to make room for the item.</span>
<a href="#l5.7"></a><span id="l5.7">            * Step 3: Give up and create a new column for the item.</span>
<a href="#l5.8"></a><span id="l5.8">            *</span>
<a href="#l5.9"></a><span id="l5.9">            * (The steps are explained in more detail as we come to them)</span>
<a href="#l5.10"></a><span id="l5.10">            */</span>
<a href="#l5.11"></a><span id="l5.11">           for (let i in this.mEventInfos) {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-              let curItemInfo = {event: this.mEventInfos[i].event,</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-                                 layoutStart: this.mEventInfos[i].layoutStart,</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-                                 layoutEnd: this.mEventInfos[i].layoutEnd};</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+              let curItemInfo = { event: this.mEventInfos[i].event,</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+                                  layoutStart: this.mEventInfos[i].layoutStart,</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+                                  layoutEnd: this.mEventInfos[i].layoutEnd };</span>
<a href="#l5.18"></a><span id="l5.18">               if (!latestItemEnd) {</span>
<a href="#l5.19"></a><span id="l5.19">                  latestItemEnd = curItemInfo.layoutEnd;</span>
<a href="#l5.20"></a><span id="l5.20">               }</span>
<a href="#l5.21"></a><span id="l5.21">               if (currentBlob.length &amp;&amp; latestItemEnd &amp;&amp;</span>
<a href="#l5.22"></a><span id="l5.22">                   curItemInfo.layoutStart.compare(latestItemEnd) != -1) {</span>
<a href="#l5.23"></a><span id="l5.23">                   // We're done with this current blob because item starts</span>
<a href="#l5.24"></a><span id="l5.24">                   // after the last event in the current blob ended.</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-                  blobs.push({blob: currentBlob, totalCols: colEndArray.length});</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+                  blobs.push({ blob: currentBlob, totalCols: colEndArray.length });</span>
<a href="#l5.27"></a><span id="l5.27"> </span>
<a href="#l5.28"></a><span id="l5.28">                   // Reset our variables</span>
<a href="#l5.29"></a><span id="l5.29">                   currentBlob = [];</span>
<a href="#l5.30"></a><span id="l5.30">                   colEndArray = [];</span>
<a href="#l5.31"></a><span id="l5.31">               }</span>
<a href="#l5.32"></a><span id="l5.32"> </span>
<a href="#l5.33"></a><span id="l5.33">               // Place the item in its correct place in the blob</span>
<a href="#l5.34"></a><span id="l5.34">               let placedItem = false;</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineat">@@ -976,19 +976,19 @@</span>
<a href="#l5.36"></a><span id="l5.36">                           // can't expand any further</span>
<a href="#l5.37"></a><span id="l5.37">                           if (nextColEnd.compare(curItemInfo.layoutStart) == 1) {</span>
<a href="#l5.38"></a><span id="l5.38">                               break;</span>
<a href="#l5.39"></a><span id="l5.39">                           }</span>
<a href="#l5.40"></a><span id="l5.40">                           colEndArray[lastCol] = curItemInfo;</span>
<a href="#l5.41"></a><span id="l5.41">                           lastCol++;</span>
<a href="#l5.42"></a><span id="l5.42">                       }</span>
<a href="#l5.43"></a><span id="l5.43">                       // Now construct the info we need to push into the blob</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineminus">-                      currentBlob.push({itemInfo: curItemInfo,</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineminus">-                                        startCol: ii,</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineminus">-                                        colSpan: lastCol - ii});</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+                      currentBlob.push({ itemInfo: curItemInfo,</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+                                         startCol: ii,</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+                                         colSpan: lastCol - ii });</span>
<a href="#l5.50"></a><span id="l5.50"> </span>
<a href="#l5.51"></a><span id="l5.51">                       // Update latestItemEnd</span>
<a href="#l5.52"></a><span id="l5.52">                       if (latestItemEnd &amp;&amp;</span>
<a href="#l5.53"></a><span id="l5.53">                           curItemInfo.layoutEnd.compare(latestItemEnd) == 1) {</span>
<a href="#l5.54"></a><span id="l5.54">                           latestItemEnd = curItemInfo.layoutEnd;</span>
<a href="#l5.55"></a><span id="l5.55">                       }</span>
<a href="#l5.56"></a><span id="l5.56">                       placedItem = true;</span>
<a href="#l5.57"></a><span id="l5.57">                       break; // Stop iterating through colEndArray</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineat">@@ -1019,29 +1019,29 @@</span>
<a href="#l5.59"></a><span id="l5.59">               for (let jj = 1; jj &lt; colEndArray.length; ++jj) {</span>
<a href="#l5.60"></a><span id="l5.60">                   if (colEndArray[jj].event.hashId == colEndArray[jj - 1].event.hashId) {</span>
<a href="#l5.61"></a><span id="l5.61">                       // Good we found a item that spanned multiple columns.</span>
<a href="#l5.62"></a><span id="l5.62">                       // Find it in the blob so we can modify its properties</span>
<a href="#l5.63"></a><span id="l5.63">                       for (let kk in currentBlob) {</span>
<a href="#l5.64"></a><span id="l5.64">                           if (currentBlob[kk].itemInfo.event.hashId == colEndArray[jj].event.hashId) {</span>
<a href="#l5.65"></a><span id="l5.65">                               // Take all but the first spot that the item spanned</span>
<a href="#l5.66"></a><span id="l5.66">                               let spanOfShrunkItem = currentBlob[kk].colSpan;</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineminus">-                              currentBlob.push({itemInfo: curItemInfo,</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineminus">-                                                startCol: Number(currentBlob[kk].startCol) + 1,</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineminus">-                                                colSpan: spanOfShrunkItem - 1});</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+                              currentBlob.push({ itemInfo: curItemInfo,</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+                                                 startCol: Number(currentBlob[kk].startCol) + 1,</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+                                                 colSpan: spanOfShrunkItem - 1 });</span>
<a href="#l5.73"></a><span id="l5.73"> </span>
<a href="#l5.74"></a><span id="l5.74">                               // Update colEndArray</span>
<a href="#l5.75"></a><span id="l5.75">                               for (let ll = jj; ll &lt; jj + spanOfShrunkItem - 1; ll++) {</span>
<a href="#l5.76"></a><span id="l5.76">                                   colEndArray[ll] = curItemInfo;</span>
<a href="#l5.77"></a><span id="l5.77">                               }</span>
<a href="#l5.78"></a><span id="l5.78"> </span>
<a href="#l5.79"></a><span id="l5.79">                               // Modify the data on the old item</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineminus">-                              currentBlob[kk] = {itemInfo: currentBlob[kk].itemInfo,</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-                                                 startCol: currentBlob[kk].startCol,</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineminus">-                                                 colSpan: 1};</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+                              currentBlob[kk] = { itemInfo: currentBlob[kk].itemInfo,</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+                                                  startCol: currentBlob[kk].startCol,</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+                                                  colSpan: 1 };</span>
<a href="#l5.86"></a><span id="l5.86">                               // Update latestItemEnd</span>
<a href="#l5.87"></a><span id="l5.87">                               if (latestItemEnd &amp;&amp;</span>
<a href="#l5.88"></a><span id="l5.88">                                   curItemInfo.layoutEnd.compare(latestItemEnd) == 1) {</span>
<a href="#l5.89"></a><span id="l5.89">                                   latestItemEnd = curItemInfo.layoutEnd;</span>
<a href="#l5.90"></a><span id="l5.90">                               }</span>
<a href="#l5.91"></a><span id="l5.91">                               break; // Stop iterating through currentBlob</span>
<a href="#l5.92"></a><span id="l5.92">                           }</span>
<a href="#l5.93"></a><span id="l5.93">                       }</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineat">@@ -1066,35 +1066,35 @@</span>
<a href="#l5.95"></a><span id="l5.95">               // * Note that there can only be one, because we sorted our</span>
<a href="#l5.96"></a><span id="l5.96">               //   events by start time, so this event must start later than</span>
<a href="#l5.97"></a><span id="l5.97">               //   the start of any possible conflicts.</span>
<a href="#l5.98"></a><span id="l5.98">               let lastColNum = colEndArray.length;</span>
<a href="#l5.99"></a><span id="l5.99">               for (let mm in currentBlob) {</span>
<a href="#l5.100"></a><span id="l5.100">                   let mmEnd = currentBlob[mm].itemInfo.layoutEnd;</span>
<a href="#l5.101"></a><span id="l5.101">                   if (currentBlob[mm].startCol + currentBlob[mm].colSpan == lastColNum &amp;&amp;</span>
<a href="#l5.102"></a><span id="l5.102">                       mmEnd.compare(curItemInfo.layoutStart) != 1) {</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineminus">-                      currentBlob[mm] = {itemInfo: currentBlob[mm].itemInfo,</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineminus">-                                         startCol: currentBlob[mm].startCol,</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineminus">-                                         colSpan: currentBlob[mm].colSpan + 1};</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+                      currentBlob[mm] = { itemInfo: currentBlob[mm].itemInfo,</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+                                          startCol: currentBlob[mm].startCol,</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+                                          colSpan: currentBlob[mm].colSpan + 1 };</span>
<a href="#l5.109"></a><span id="l5.109">                   }</span>
<a href="#l5.110"></a><span id="l5.110">               }</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineminus">-              currentBlob.push({itemInfo: curItemInfo,</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineminus">-                                startCol: colEndArray.length,</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineminus">-                                colSpan: 1});</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineplus">+              currentBlob.push({ itemInfo: curItemInfo,</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineplus">+                                 startCol: colEndArray.length,</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+                                 colSpan: 1 });</span>
<a href="#l5.117"></a><span id="l5.117">               colEndArray.push(curItemInfo);</span>
<a href="#l5.118"></a><span id="l5.118"> </span>
<a href="#l5.119"></a><span id="l5.119">               // Update latestItemEnd</span>
<a href="#l5.120"></a><span id="l5.120">               if (latestItemEnd &amp;&amp; curItemInfo.layoutEnd.compare(latestItemEnd) == 1) {</span>
<a href="#l5.121"></a><span id="l5.121">                   latestItemEnd = curItemInfo.layoutEnd;</span>
<a href="#l5.122"></a><span id="l5.122">               }</span>
<a href="#l5.123"></a><span id="l5.123">               // Go get the next item</span>
<a href="#l5.124"></a><span id="l5.124">           }</span>
<a href="#l5.125"></a><span id="l5.125">           // Add the last blob</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineminus">-          blobs.push({blob: currentBlob,</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineminus">-                      totalCols: colEndArray.length});</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+          blobs.push({ blob: currentBlob,</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+                       totalCols: colEndArray.length });</span>
<a href="#l5.130"></a><span id="l5.130">           return this.setupBoxStructure(blobs);</span>
<a href="#l5.131"></a><span id="l5.131">         ]]&gt;&lt;/body&gt;</span>
<a href="#l5.132"></a><span id="l5.132">       &lt;/method&gt;</span>
<a href="#l5.133"></a><span id="l5.133">       &lt;method name=&quot;setupBoxStructure&quot;&gt;</span>
<a href="#l5.134"></a><span id="l5.134">         &lt;parameter name=&quot;aBlobs&quot;/&gt;</span>
<a href="#l5.135"></a><span id="l5.135">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l5.136"></a><span id="l5.136">           // This is actually going to end up being a 3-d array</span>
<a href="#l5.137"></a><span id="l5.137">           // 1st dimension: &quot;layers&quot;, sets of columns of events that all</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineat">@@ -1207,24 +1207,24 @@</span>
<a href="#l5.139"></a><span id="l5.139">                   // dst gaps in this case. converting the date/times to</span>
<a href="#l5.140"></a><span id="l5.140">                   // floating conveys this idea in a natural way. note that</span>
<a href="#l5.141"></a><span id="l5.141">                   // we explicitly don't use getInTimezone() as it would</span>
<a href="#l5.142"></a><span id="l5.142">                   // be slightly more expensive in terms of performance.</span>
<a href="#l5.143"></a><span id="l5.143">                   let floatstart = start.clone();</span>
<a href="#l5.144"></a><span id="l5.144">                   floatstart.timezone = floating();</span>
<a href="#l5.145"></a><span id="l5.145">                   let dur = floatstart.subtractDate(prevEnd);</span>
<a href="#l5.146"></a><span id="l5.146">                   if (dur.inSeconds) {</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineminus">-                      col.push({duration: dur});</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+                      col.push({ duration: dur });</span>
<a href="#l5.149"></a><span id="l5.149">                   }</span>
<a href="#l5.150"></a><span id="l5.150">                   let floatend = end.clone();</span>
<a href="#l5.151"></a><span id="l5.151">                   floatend.timezone = floating();</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineminus">-                  col.push({event: data.itemInfo.event,</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineminus">-                            endDate: end,</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineminus">-                            startDate: start,</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineminus">-                            duration: floatend.subtractDate(floatstart)});</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+                  col.push({ event: data.itemInfo.event,</span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+                             endDate: end,</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+                             startDate: start,</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+                             duration: floatend.subtractDate(floatstart) });</span>
<a href="#l5.160"></a><span id="l5.160">               }</span>
<a href="#l5.161"></a><span id="l5.161">               layerOffset = layers.length;</span>
<a href="#l5.162"></a><span id="l5.162">           }</span>
<a href="#l5.163"></a><span id="l5.163">           return layers;</span>
<a href="#l5.164"></a><span id="l5.164">         ]]&gt;&lt;/body&gt;</span>
<a href="#l5.165"></a><span id="l5.165">       &lt;/method&gt;</span>
<a href="#l5.166"></a><span id="l5.166"> </span>
<a href="#l5.167"></a><span id="l5.167">       &lt;method name=&quot;getShadowElements&quot;&gt;</span>
<a href="#l5.168"></a><span id="l5.168" class="difflineat">@@ -1540,26 +1540,26 @@</span>
<a href="#l5.169"></a><span id="l5.169">           let deltamin = curmin - dragState.origMin;</span>
<a href="#l5.170"></a><span id="l5.170"> </span>
<a href="#l5.171"></a><span id="l5.171">           let shadowElements;</span>
<a href="#l5.172"></a><span id="l5.172">           if (dragState.dragType == &quot;new&quot;) {</span>
<a href="#l5.173"></a><span id="l5.173">               // Extend deltamin in a linear way over the columns</span>
<a href="#l5.174"></a><span id="l5.174">               deltamin += minutesInDay * dragState.jumpedColumns;</span>
<a href="#l5.175"></a><span id="l5.175">               if (deltamin &lt; 0) {</span>
<a href="#l5.176"></a><span id="l5.176">                   // create a new event modifying the start. End time is fixed</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineminus">-                  shadowElements = {shadows: 1 - dragState.jumpedColumns,</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineminus">-                                    offset: 0,</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineminus">-                                    startMin: curmin,</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineminus">-                                    endMin: dragState.origMin};</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineplus">+                  shadowElements = { shadows: 1 - dragState.jumpedColumns,</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineplus">+                                     offset: 0,</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+                                     startMin: curmin,</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+                                     endMin: dragState.origMin };</span>
<a href="#l5.185"></a><span id="l5.185">               } else {</span>
<a href="#l5.186"></a><span id="l5.186">                   // create a new event modifying the end. Start time is fixed</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineminus">-                  shadowElements = {shadows: dragState.jumpedColumns + 1,</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineminus">-                                    offset: dragState.jumpedColumns,</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineminus">-                                    startMin: dragState.origMin,</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineminus">-                                    endMin: curmin};</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+                  shadowElements = { shadows: dragState.jumpedColumns + 1,</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineplus">+                                     offset: dragState.jumpedColumns,</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+                                     startMin: dragState.origMin,</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+                                     endMin: curmin };</span>
<a href="#l5.195"></a><span id="l5.195">               }</span>
<a href="#l5.196"></a><span id="l5.196">               dragState.startMin = shadowElements.startMin;</span>
<a href="#l5.197"></a><span id="l5.197">               dragState.endMin = shadowElements.endMin;</span>
<a href="#l5.198"></a><span id="l5.198">           } else if (dragState.dragType == &quot;move&quot;) {</span>
<a href="#l5.199"></a><span id="l5.199">               // if we're moving, we modify startMin and endMin of the shadow.</span>
<a href="#l5.200"></a><span id="l5.200">               shadowElements = col.getShadowElements(dragState.origMinStart + deltamin,</span>
<a href="#l5.201"></a><span id="l5.201">                                                      dragState.origMinEnd + deltamin);</span>
<a href="#l5.202"></a><span id="l5.202">               dragState.startMin = shadowElements.startMin;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree.xml</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -420,20 +420,20 @@</span>
<a href="#l6.4"></a><span id="l6.4">               for (let item of modItems.mArray) {</span>
<a href="#l6.5"></a><span id="l6.5">                   if (item.hashId in this.binding.mHash2Index) {</span>
<a href="#l6.6"></a><span id="l6.6">                       // make sure we're using the new version of a modified item</span>
<a href="#l6.7"></a><span id="l6.7">                       this.binding.mTaskArray[this.binding.mHash2Index[item.hashId]] = item;</span>
<a href="#l6.8"></a><span id="l6.8">                   }</span>
<a href="#l6.9"></a><span id="l6.9">               }</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">               // remove the old items working backward from the end so the indexes stay valid</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-              remIndexes.sort(function(a, b) {return b - a;}).forEach(function(index) {</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+              remIndexes.sort((a, b) =&gt; b - a).forEach((index) =&gt; {</span>
<a href="#l6.14"></a><span id="l6.14">                   this.binding.mTaskArray.splice(index, 1);</span>
<a href="#l6.15"></a><span id="l6.15">                   this.treebox.rowCountChanged(index, -1);</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-              }, this);</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+              });</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">               // add the new items</span>
<a href="#l6.20"></a><span id="l6.20">               for (let item of addItems.mArray) {</span>
<a href="#l6.21"></a><span id="l6.21">                   if (!(item.hashId in this.binding.mHash2Index)) {</span>
<a href="#l6.22"></a><span id="l6.22">                       let index = this.binding.mTaskArray.length;</span>
<a href="#l6.23"></a><span id="l6.23">                       this.binding.mTaskArray.push(item);</span>
<a href="#l6.24"></a><span id="l6.24">                       this.binding.mHash2Index[item.hashId] = index;</span>
<a href="#l6.25"></a><span id="l6.25">                       this.treebox.rowCountChanged(index, 1);</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineat">@@ -1100,28 +1100,28 @@</span>
<a href="#l6.27"></a><span id="l6.27">                 let context = document.getElementById(this.getAttribute(&quot;context&quot;));</span>
<a href="#l6.28"></a><span id="l6.28">                 if (context &amp;&amp; context.state) {</span>
<a href="#l6.29"></a><span id="l6.29">                     menuOpen = (context.state == &quot;open&quot;) || (context.state == &quot;showing&quot;);</span>
<a href="#l6.30"></a><span id="l6.30">                 }</span>
<a href="#l6.31"></a><span id="l6.31">             }</span>
<a href="#l6.32"></a><span id="l6.32"> </span>
<a href="#l6.33"></a><span id="l6.33">             let focused = (document.activeElement == tree) || menuOpen;</span>
<a href="#l6.34"></a><span id="l6.34"> </span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-            calendarController.onSelectionChanged({detail: (focused ? this.selectedTasks : [])});</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+            calendarController.onSelectionChanged({ detail: (focused ? this.selectedTasks : []) });</span>
<a href="#l6.37"></a><span id="l6.37">             calendarController.todo_tasktree_focused = focused;</span>
<a href="#l6.38"></a><span id="l6.38">         ]]&gt;&lt;/body&gt;</span>
<a href="#l6.39"></a><span id="l6.39">       &lt;/method&gt;</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41">     &lt;/implementation&gt;</span>
<a href="#l6.42"></a><span id="l6.42"> </span>
<a href="#l6.43"></a><span id="l6.43">     &lt;handlers&gt;</span>
<a href="#l6.44"></a><span id="l6.44">       &lt;handler event=&quot;select&quot;&gt;&lt;![CDATA[</span>
<a href="#l6.45"></a><span id="l6.45">         this.mTreeView.onSelect(event);</span>
<a href="#l6.46"></a><span id="l6.46">         if (calendarController.todo_tasktree_focused) {</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-          calendarController.onSelectionChanged({detail: this.selectedTasks});</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+          calendarController.onSelectionChanged({ detail: this.selectedTasks });</span>
<a href="#l6.49"></a><span id="l6.49">         }</span>
<a href="#l6.50"></a><span id="l6.50">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l6.51"></a><span id="l6.51">       &lt;handler event=&quot;focus&quot;&gt;&lt;![CDATA[</span>
<a href="#l6.52"></a><span id="l6.52">         this.updateFocus();</span>
<a href="#l6.53"></a><span id="l6.53">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l6.54"></a><span id="l6.54">       &lt;handler event=&quot;blur&quot;&gt;&lt;![CDATA[</span>
<a href="#l6.55"></a><span id="l6.55">         this.updateFocus();</span>
<a href="#l6.56"></a><span id="l6.56">       ]]&gt;&lt;/handler&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -426,20 +426,20 @@ function updateListboxDeleteButton(listb</span>
<a href="#l7.4"></a><span id="l7.4">  *</span>
<a href="#l7.5"></a><span id="l7.5">  * @param aLength         The number to use to determine the plural form</span>
<a href="#l7.6"></a><span id="l7.6">  * @param aUnit           The unit to find the plural form of</span>
<a href="#l7.7"></a><span id="l7.7">  * @param aIncludeLength  (optional) If true, the length will be included in the</span>
<a href="#l7.8"></a><span id="l7.8">  *                          result. If false, only the pluralized unit is returned.</span>
<a href="#l7.9"></a><span id="l7.9">  * @return                A string containg the pluralized version of the unit</span>
<a href="#l7.10"></a><span id="l7.10">  */</span>
<a href="#l7.11"></a><span id="l7.11"> function unitPluralForm(aLength, aUnit, aIncludeLength=true) {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    let unitProp = {&quot;minutes&quot;: &quot;unitMinutes&quot;,</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-                    &quot;hours&quot;: &quot;unitHours&quot;,</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-                    &quot;days&quot;: &quot;unitDays&quot;,</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-                    &quot;weeks&quot;: &quot;unitWeeks&quot;}[aUnit] || &quot;unitMinutes&quot;;</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+    let unitProp = { &quot;minutes&quot;: &quot;unitMinutes&quot;,</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+                     &quot;hours&quot;: &quot;unitHours&quot;,</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+                     &quot;days&quot;: &quot;unitDays&quot;,</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+                     &quot;weeks&quot;: &quot;unitWeeks&quot; }[aUnit] || &quot;unitMinutes&quot;;</span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21">     return PluralForm.get(aLength, cal.calGetString(&quot;calendar&quot;, unitProp))</span>
<a href="#l7.22"></a><span id="l7.22">                      .replace(&quot;#1&quot;, aIncludeLength ? aLength : &quot;&quot;).trim();</span>
<a href="#l7.23"></a><span id="l7.23"> }</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25"> /**</span>
<a href="#l7.26"></a><span id="l7.26">  * Update the given unit label to show the correct plural form.</span>
<a href="#l7.27"></a><span id="l7.27">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-unifinder.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-unifinder.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -352,17 +352,17 @@ function unifinderSelect(event) {</span>
<a href="#l8.4"></a><span id="l8.4">         // Go to the day of the selected item in the current view.</span>
<a href="#l8.5"></a><span id="l8.5">         currentView().goToDay(selectedItems[0].startDate);</span>
<a href="#l8.6"></a><span id="l8.6">     }</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8">     // Set up the selected items in the view. Pass in true, so we don't end</span>
<a href="#l8.9"></a><span id="l8.9">     // up in a circular loop</span>
<a href="#l8.10"></a><span id="l8.10">     currentView().setSelectedItems(selectedItems.length, selectedItems, true);</span>
<a href="#l8.11"></a><span id="l8.11">     currentView().centerSelectedItems();</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    calendarController.onSelectionChanged({detail: selectedItems});</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    calendarController.onSelectionChanged({ detail: selectedItems });</span>
<a href="#l8.14"></a><span id="l8.14">     document.getElementById(&quot;unifinder-search-results-tree&quot;).focus();</span>
<a href="#l8.15"></a><span id="l8.15"> }</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17"> /**</span>
<a href="#l8.18"></a><span id="l8.18">  * Handler function for keypress in the unifinder.</span>
<a href="#l8.19"></a><span id="l8.19">  *</span>
<a href="#l8.20"></a><span id="l8.20">  * @param aEvent        The DOM Key event.</span>
<a href="#l8.21"></a><span id="l8.21">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/today-pane.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/today-pane.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -9,20 +9,22 @@ Components.utils.import(&quot;resource://cale</span>
<a href="#l9.4"></a><span id="l9.4">  */</span>
<a href="#l9.5"></a><span id="l9.5"> var TodayPane = {</span>
<a href="#l9.6"></a><span id="l9.6">     paneViews: null,</span>
<a href="#l9.7"></a><span id="l9.7">     start: null,</span>
<a href="#l9.8"></a><span id="l9.8">     cwlabel: null,</span>
<a href="#l9.9"></a><span id="l9.9">     previousMode:  null,</span>
<a href="#l9.10"></a><span id="l9.10">     switchCounter: 0,</span>
<a href="#l9.11"></a><span id="l9.11">     minidayTimer: null,</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    minidayDrag: {startX: 0,</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-                  startY: 0,</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-                  distance: 0,</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-                  session: false},</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+    minidayDrag: {</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+        startX: 0,</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+        startY: 0,</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+        distance: 0,</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+        session: false</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+    },</span>
<a href="#l9.22"></a><span id="l9.22"> </span>
<a href="#l9.23"></a><span id="l9.23">     /**</span>
<a href="#l9.24"></a><span id="l9.24">      * Load Handler, sets up the today pane controls.</span>
<a href="#l9.25"></a><span id="l9.25">      */</span>
<a href="#l9.26"></a><span id="l9.26">     onLoad: function onLoad() {</span>
<a href="#l9.27"></a><span id="l9.27">         TodayPane.paneViews = [ cal.calGetString(&quot;calendar&quot;, &quot;eventsandtasks&quot;),</span>
<a href="#l9.28"></a><span id="l9.28">                                 cal.calGetString(&quot;calendar&quot;, &quot;tasksonly&quot;),</span>
<a href="#l9.29"></a><span id="l9.29">                                 cal.calGetString(&quot;calendar&quot;, &quot;eventsonly&quot;) ];</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineat">@@ -126,17 +128,17 @@ var TodayPane = {</span>
<a href="#l9.31"></a><span id="l9.31">                 switchCalendarView(&quot;week&quot;, true);</span>
<a href="#l9.32"></a><span id="l9.32">             } else if (aEvent.target.parentNode.id == &quot;monthNameContainer&quot;) {</span>
<a href="#l9.33"></a><span id="l9.33">                 switchCalendarView(&quot;month&quot;, true);</span>
<a href="#l9.34"></a><span id="l9.34">             } else {</span>
<a href="#l9.35"></a><span id="l9.35">                 return;</span>
<a href="#l9.36"></a><span id="l9.36">             }</span>
<a href="#l9.37"></a><span id="l9.37">             let title = document.getElementById('calendar-tab-button')</span>
<a href="#l9.38"></a><span id="l9.38">                             .getAttribute('tooltiptext');</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-            document.getElementById('tabmail').openTab('calendar', {title: title});</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineplus">+            document.getElementById('tabmail').openTab('calendar', { title: title });</span>
<a href="#l9.41"></a><span id="l9.41">             currentView().goToDay(agendaListbox.today.start);</span>
<a href="#l9.42"></a><span id="l9.42">         }</span>
<a href="#l9.43"></a><span id="l9.43">     },</span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45">     /**</span>
<a href="#l9.46"></a><span id="l9.46">      * Set conditions about start dragging on day-label or start switching</span>
<a href="#l9.47"></a><span id="l9.47">      * with time on navigation buttons.</span>
<a href="#l9.48"></a><span id="l9.48">      */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-alarm-widget.xml</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-alarm-widget.xml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -321,17 +321,17 @@</span>
<a href="#l10.4"></a><span id="l10.4">       &lt;method name=&quot;updateAccessibleName&quot;&gt;</span>
<a href="#l10.5"></a><span id="l10.5">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l10.6"></a><span id="l10.6">           let unitList = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;snooze-unit-menulist&quot;);</span>
<a href="#l10.7"></a><span id="l10.7">           let unitPopup = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;snooze-unit-menupopup&quot;);</span>
<a href="#l10.8"></a><span id="l10.8">           let unitValue = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;snooze-value-textbox&quot;);</span>
<a href="#l10.9"></a><span id="l10.9">           let okButton = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;snooze-popup-ok&quot;);</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11">           function unitName(list) {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-              return {1: &quot;unitMinutes&quot;, 60: &quot;unitHours&quot;, 1440: &quot;unitDays&quot;}[list.value] || &quot;unitMinutes&quot;;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+              return { 1: &quot;unitMinutes&quot;, 60: &quot;unitHours&quot;, 1440: &quot;unitDays&quot; }[list.value] || &quot;unitMinutes&quot;;</span>
<a href="#l10.14"></a><span id="l10.14">           }</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16">           let pluralString = cal.calGetString(&quot;calendar&quot;, unitName(unitList));</span>
<a href="#l10.17"></a><span id="l10.17">           let unitPlural = PluralForm.get(unitValue.value, pluralString)</span>
<a href="#l10.18"></a><span id="l10.18">                                      .replace(&quot;#1&quot;, unitValue.value);</span>
<a href="#l10.19"></a><span id="l10.19"> </span>
<a href="#l10.20"></a><span id="l10.20">           let accessibleString = cal.calGetString(&quot;calendar-alarms&quot;,</span>
<a href="#l10.21"></a><span id="l10.21">                                                   &quot;reminderSnoozeOkA11y&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/modules/calAuthUtils.jsm</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/modules/calAuthUtils.jsm</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -196,22 +196,22 @@ cal.auth.Prompt.prototype = {</span>
<a href="#l11.4"></a><span id="l11.4">             if (this.mReturnedLogins[keyStr] &amp;&amp;</span>
<a href="#l11.5"></a><span id="l11.5">                 now.getTime() - this.mReturnedLogins[keyStr].getTime() &lt; 60000) {</span>
<a href="#l11.6"></a><span id="l11.6">                 cal.LOG(&quot;Credentials removed for: user=&quot; + username + &quot;, host=&quot; + aPasswordRealm.prePath + &quot;, realm=&quot; + aPasswordRealm.realm)</span>
<a href="#l11.7"></a><span id="l11.7"> ;</span>
<a href="#l11.8"></a><span id="l11.8">                 delete this.mReturnedLogins[keyStr];</span>
<a href="#l11.9"></a><span id="l11.9">                 cal.auth.passwordManagerRemove(username,</span>
<a href="#l11.10"></a><span id="l11.10">                                                aPasswordRealm.prePath,</span>
<a href="#l11.11"></a><span id="l11.11">                                                aPasswordRealm.realm);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-                return {found: false, username: username};</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+                return { found: false, username: username };</span>
<a href="#l11.14"></a><span id="l11.14">             } else {</span>
<a href="#l11.15"></a><span id="l11.15">                 this.mReturnedLogins[keyStr] = now;</span>
<a href="#l11.16"></a><span id="l11.16">             }</span>
<a href="#l11.17"></a><span id="l11.17">         }</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineminus">-        return {found: found, username: username, password: password};</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+        return { found: found, username: username, password: password };</span>
<a href="#l11.20"></a><span id="l11.20">     },</span>
<a href="#l11.21"></a><span id="l11.21"> </span>
<a href="#l11.22"></a><span id="l11.22">     /**</span>
<a href="#l11.23"></a><span id="l11.23">      * Requests a username and a password. Implementations will commonly show a</span>
<a href="#l11.24"></a><span id="l11.24">      * dialog with a username and password field, depending on flags also a</span>
<a href="#l11.25"></a><span id="l11.25">      * domain field.</span>
<a href="#l11.26"></a><span id="l11.26">      *</span>
<a href="#l11.27"></a><span id="l11.27">      * @param aChannel</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/modules/calExtract.jsm</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/modules/calExtract.jsm</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -266,22 +266,23 @@ Extractor.prototype = {</span>
<a href="#l12.4"></a><span id="l12.4">         }</span>
<a href="#l12.5"></a><span id="l12.5"> </span>
<a href="#l12.6"></a><span id="l12.6">         initial.year = now.getFullYear();</span>
<a href="#l12.7"></a><span id="l12.7">         initial.month = now.getMonth() + 1;</span>
<a href="#l12.8"></a><span id="l12.8">         initial.day = now.getDate();</span>
<a href="#l12.9"></a><span id="l12.9">         initial.hour = now.getHours();</span>
<a href="#l12.10"></a><span id="l12.10">         initial.minute = now.getMinutes();</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-        this.collected.push({year: initial.year,</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-                             month: initial.month,</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-                             day: initial.day,</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-                             hour: initial.hour,</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-                             minute: initial.minute,</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-                             relation: &quot;start&quot;</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+        this.collected.push({</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+            year: initial.year,</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+            month: initial.month,</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+            day: initial.day,</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+            hour: initial.hour,</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+            minute: initial.minute,</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+            relation: &quot;start&quot;</span>
<a href="#l12.25"></a><span id="l12.25">         });</span>
<a href="#l12.26"></a><span id="l12.26"> </span>
<a href="#l12.27"></a><span id="l12.27">         this.cleanup();</span>
<a href="#l12.28"></a><span id="l12.28">         cal.LOG(&quot;[calExtract] Email after processing for extraction: \n&quot; + this.email);</span>
<a href="#l12.29"></a><span id="l12.29"> </span>
<a href="#l12.30"></a><span id="l12.30">         this.overrides = JSON.parse(Preferences.get(&quot;calendar.patterns.override&quot;, &quot;{}&quot;));</span>
<a href="#l12.31"></a><span id="l12.31">         this.setLanguage();</span>
<a href="#l12.32"></a><span id="l12.32"> </span>
<a href="#l12.33"></a><span id="l12.33" class="difflineat">@@ -443,17 +444,17 @@ Extractor.prototype = {</span>
<a href="#l12.34"></a><span id="l12.34">                 if (!this.limitNums(res, this.email) &amp;&amp; !this.limitChars(res, this.email)) {</span>
<a href="#l12.35"></a><span id="l12.35">                     let day = this.parseNumber(res[positions[1]], this.numbers);</span>
<a href="#l12.36"></a><span id="l12.36">                     let month = res[positions[2]];</span>
<a href="#l12.37"></a><span id="l12.37"> </span>
<a href="#l12.38"></a><span id="l12.38">                     if (this.isValidDay(day)) {</span>
<a href="#l12.39"></a><span id="l12.39">                         for (let i = 0; i &lt; 12; i++) {</span>
<a href="#l12.40"></a><span id="l12.40">                             let ms = this.unescape(this.months[i]).split(&quot;|&quot;);</span>
<a href="#l12.41"></a><span id="l12.41">                             if (ms.includes(month.toLowerCase())) {</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-                                let date = {year: this.now.getFullYear(), month: i + 1, day: day};</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+                                let date = { year: this.now.getFullYear(), month: i + 1, day: day };</span>
<a href="#l12.44"></a><span id="l12.44">                                 if (this.isPastDate(date, this.now)) {</span>
<a href="#l12.45"></a><span id="l12.45">                                     // find next such date</span>
<a href="#l12.46"></a><span id="l12.46">                                     let item = new Date(this.now.getTime());</span>
<a href="#l12.47"></a><span id="l12.47">                                     while (true) {</span>
<a href="#l12.48"></a><span id="l12.48">                                         item.setDate(item.getDate() + 1);</span>
<a href="#l12.49"></a><span id="l12.49">                                         if (item.getMonth() == date.month - 1 &amp;&amp;</span>
<a href="#l12.50"></a><span id="l12.50">                                             item.getDate() == date.day) {</span>
<a href="#l12.51"></a><span id="l12.51">                                             date.year = item.getFullYear();</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineat">@@ -482,17 +483,17 @@ Extractor.prototype = {</span>
<a href="#l12.53"></a><span id="l12.53">             let positions = alts[alt].positions;</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55">             while ((res = re.exec(this.email)) != null) {</span>
<a href="#l12.56"></a><span id="l12.56">                 if (!this.limitNums(res, this.email) &amp;&amp; !this.limitChars(res, this.email)) {</span>
<a href="#l12.57"></a><span id="l12.57">                     let day = parseInt(res[positions[1]], 10);</span>
<a href="#l12.58"></a><span id="l12.58">                     let month = parseInt(res[positions[2]], 10);</span>
<a href="#l12.59"></a><span id="l12.59"> </span>
<a href="#l12.60"></a><span id="l12.60">                     if (this.isValidMonth(month) &amp;&amp; this.isValidDay(day)) {</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineminus">-                        let date = {year: this.now.getFullYear(), month: month, day: day};</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+                        let date = { year: this.now.getFullYear(), month: month, day: day };</span>
<a href="#l12.63"></a><span id="l12.63"> </span>
<a href="#l12.64"></a><span id="l12.64">                         if (this.isPastDate(date, this.now)) {</span>
<a href="#l12.65"></a><span id="l12.65">                             // find next such date</span>
<a href="#l12.66"></a><span id="l12.66">                             let item = new Date(this.now.getTime());</span>
<a href="#l12.67"></a><span id="l12.67">                             while (true) {</span>
<a href="#l12.68"></a><span id="l12.68">                                 item.setDate(item.getDate() + 1);</span>
<a href="#l12.69"></a><span id="l12.69">                                 if (item.getMonth() == date.month - 1 &amp;&amp;</span>
<a href="#l12.70"></a><span id="l12.70">                                     item.getDate() == date.day) {</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineat">@@ -1015,17 +1016,17 @@ Extractor.prototype = {</span>
<a href="#l12.72"></a><span id="l12.72">                     let idx = vals.indexOf(removals[pattern]);</span>
<a href="#l12.73"></a><span id="l12.73">                     if (idx != -1) {</span>
<a href="#l12.74"></a><span id="l12.74">                         vals.splice(idx, 1);</span>
<a href="#l12.75"></a><span id="l12.75">                         cal.LOG(&quot;[calExtract] Removed &quot; + removals[pattern] + &quot; from &quot; + name);</span>
<a href="#l12.76"></a><span id="l12.76">                     }</span>
<a href="#l12.77"></a><span id="l12.77">                 }</span>
<a href="#l12.78"></a><span id="l12.78">             }</span>
<a href="#l12.79"></a><span id="l12.79"> </span>
<a href="#l12.80"></a><span id="l12.80" class="difflineminus">-            vals.sort(function(one, two) {return two.length - one.length;});</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+            vals.sort((a, b) =&gt; b.length - a.length);</span>
<a href="#l12.82"></a><span id="l12.82">             return vals.join(&quot;|&quot;);</span>
<a href="#l12.83"></a><span id="l12.83">         } catch (ex) {</span>
<a href="#l12.84"></a><span id="l12.84">             cal.LOG(&quot;[calExtract] Pattern not found: &quot; + name);</span>
<a href="#l12.85"></a><span id="l12.85"> </span>
<a href="#l12.86"></a><span id="l12.86">             // fake a value to avoid empty regexes creating endless loops</span>
<a href="#l12.87"></a><span id="l12.87">             return this.defPattern;</span>
<a href="#l12.88"></a><span id="l12.88">         }</span>
<a href="#l12.89"></a><span id="l12.89">     },</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineat">@@ -1068,33 +1069,33 @@ Extractor.prototype = {</span>
<a href="#l12.91"></a><span id="l12.91">                     let idx = vals.indexOf(removals[pattern]);</span>
<a href="#l12.92"></a><span id="l12.92">                     if (idx != -1) {</span>
<a href="#l12.93"></a><span id="l12.93">                         vals.splice(idx, 1);</span>
<a href="#l12.94"></a><span id="l12.94">                         cal.LOG(&quot;[calExtract] Removed &quot; + removals[pattern] + &quot; from &quot; + name);</span>
<a href="#l12.95"></a><span id="l12.95">                     }</span>
<a href="#l12.96"></a><span id="l12.96">                 }</span>
<a href="#l12.97"></a><span id="l12.97">             }</span>
<a href="#l12.98"></a><span id="l12.98"> </span>
<a href="#l12.99"></a><span id="l12.99" class="difflineminus">-            vals.sort(function(one, two) {return two.length - one.length;});</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+            vals.sort((a, b) =&gt; b.length - a.length);</span>
<a href="#l12.101"></a><span id="l12.101">             for (let val in vals) {</span>
<a href="#l12.102"></a><span id="l12.102">                 let pattern = vals[val];</span>
<a href="#l12.103"></a><span id="l12.103">                 for (let cnt = 1; cnt &lt;= replaceables.length; cnt++) {</span>
<a href="#l12.104"></a><span id="l12.104">                     pattern = pattern.split(&quot;#&quot; + cnt).join(replaceables[cnt - 1]);</span>
<a href="#l12.105"></a><span id="l12.105">                 }</span>
<a href="#l12.106"></a><span id="l12.106">                 patterns.push(pattern);</span>
<a href="#l12.107"></a><span id="l12.107">             }</span>
<a href="#l12.108"></a><span id="l12.108"> </span>
<a href="#l12.109"></a><span id="l12.109">             for (let val in vals) {</span>
<a href="#l12.110"></a><span id="l12.110">                 let positions = [];</span>
<a href="#l12.111"></a><span id="l12.111">                 if (replaceables.length == 1) {</span>
<a href="#l12.112"></a><span id="l12.112">                     positions[1] = 1;</span>
<a href="#l12.113"></a><span id="l12.113">                 } else {</span>
<a href="#l12.114"></a><span id="l12.114">                     positions = this.getPositionsFor(vals[val], name, replaceables.length);</span>
<a href="#l12.115"></a><span id="l12.115">                 }</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineminus">-                alts[val] = {pattern: patterns[val], positions: positions};</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineplus">+                alts[val] = { pattern: patterns[val], positions: positions };</span>
<a href="#l12.118"></a><span id="l12.118">             }</span>
<a href="#l12.119"></a><span id="l12.119">         } catch (ex) {</span>
<a href="#l12.120"></a><span id="l12.120">             cal.LOG(&quot;[calExtract] Pattern not found: &quot; + name);</span>
<a href="#l12.121"></a><span id="l12.121">         }</span>
<a href="#l12.122"></a><span id="l12.122">         return alts;</span>
<a href="#l12.123"></a><span id="l12.123">     },</span>
<a href="#l12.124"></a><span id="l12.124"> </span>
<a href="#l12.125"></a><span id="l12.125">     getPositionsFor: function getPositionsFor(s, name, count) {</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineat">@@ -1194,18 +1195,18 @@ Extractor.prototype = {</span>
<a href="#l12.127"></a><span id="l12.127">                      (w.exec(pattern.charAt(pattern.length - 1)) &amp;&amp; w.exec(after));</span>
<a href="#l12.128"></a><span id="l12.128">         return result != null;</span>
<a href="#l12.129"></a><span id="l12.129">     },</span>
<a href="#l12.130"></a><span id="l12.130"> </span>
<a href="#l12.131"></a><span id="l12.131">     prefixSuffixStartEnd: function prefixSuffixStart(res, relation, email) {</span>
<a href="#l12.132"></a><span id="l12.132">         let pattern = email.substring(res.index, res.index + res[0].length);</span>
<a href="#l12.133"></a><span id="l12.133">         let prev = email.substring(0, res.index);</span>
<a href="#l12.134"></a><span id="l12.134">         let next = email.substring(res.index + res[0].length);</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineminus">-        let prefixSuffix = {start: res.index, end: res.index + res[0].length,</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineminus">-                            pattern: pattern, relation: relation};</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineplus">+        let prefixSuffix = { start: res.index, end: res.index + res[0].length,</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineplus">+                             pattern: pattern, relation: relation };</span>
<a href="#l12.139"></a><span id="l12.139">         let ch = &quot;\\s*&quot;;</span>
<a href="#l12.140"></a><span id="l12.140">         let psres;</span>
<a href="#l12.141"></a><span id="l12.141"> </span>
<a href="#l12.142"></a><span id="l12.142">         let re = new RegExp(&quot;(&quot; + this.getPatterns(&quot;end.prefix&quot;) + &quot;)&quot; + ch + &quot;$&quot;, &quot;ig&quot;);</span>
<a href="#l12.143"></a><span id="l12.143">         if ((psres = re.exec(prev)) != null) {</span>
<a href="#l12.144"></a><span id="l12.144">             prefixSuffix.relation = &quot;end&quot;;</span>
<a href="#l12.145"></a><span id="l12.145">             prefixSuffix.start = psres.index;</span>
<a href="#l12.146"></a><span id="l12.146">             prefixSuffix.pattern = psres[0] + pattern;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/src/calTimezoneService.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/src/calTimezoneService.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -154,32 +154,32 @@ calTimezoneService.prototype = {</span>
<a href="#l13.4"></a><span id="l13.4">             let utc;</span>
<a href="#l13.5"></a><span id="l13.5">             if (Preferences.get(&quot;calendar.icaljs&quot;, false)) {</span>
<a href="#l13.6"></a><span id="l13.6">                 utc = new calICALJSTimezone(ICAL.Timezone.utcTimezone);</span>
<a href="#l13.7"></a><span id="l13.7">             } else {</span>
<a href="#l13.8"></a><span id="l13.8">                 utc = new calLibicalTimezone(&quot;UTC&quot;, null, &quot;&quot;, &quot;&quot;);</span>
<a href="#l13.9"></a><span id="l13.9">                 utc.mUTC = true;</span>
<a href="#l13.10"></a><span id="l13.10">             }</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-            this.mZones.set(&quot;UTC&quot;, {zone: utc});</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+            this.mZones.set(&quot;UTC&quot;, { zone: utc });</span>
<a href="#l13.14"></a><span id="l13.14">         }</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16">         return this.mZones.get(&quot;UTC&quot;).zone;</span>
<a href="#l13.17"></a><span id="l13.17">     },</span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19">     get floating() {</span>
<a href="#l13.20"></a><span id="l13.20">         if (!this.mZones.has(&quot;floating&quot;)) {</span>
<a href="#l13.21"></a><span id="l13.21">             let floating;</span>
<a href="#l13.22"></a><span id="l13.22">             if (Preferences.get(&quot;calendar.icaljs&quot;, false)) {</span>
<a href="#l13.23"></a><span id="l13.23">                 floating = new calICALJSTimezone(ICAL.Timezone.localTimezone);</span>
<a href="#l13.24"></a><span id="l13.24">             } else {</span>
<a href="#l13.25"></a><span id="l13.25">                 floating = new calLibicalTimezone(&quot;floating&quot;, null, &quot;&quot;, &quot;&quot;);</span>
<a href="#l13.26"></a><span id="l13.26">                 floating.isFloating = true;</span>
<a href="#l13.27"></a><span id="l13.27">             }</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineminus">-            this.mZones.set(&quot;floating&quot;, {zone: floating});</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+            this.mZones.set(&quot;floating&quot;, { zone: floating });</span>
<a href="#l13.30"></a><span id="l13.30">         }</span>
<a href="#l13.31"></a><span id="l13.31"> </span>
<a href="#l13.32"></a><span id="l13.32">         return this.mZones.get(&quot;floating&quot;).zone;</span>
<a href="#l13.33"></a><span id="l13.33">     },</span>
<a href="#l13.34"></a><span id="l13.34"> </span>
<a href="#l13.35"></a><span id="l13.35">     // calITimezoneProvider:</span>
<a href="#l13.36"></a><span id="l13.36">     getTimezone: function calTimezoneService_getTimezone(tzid) {</span>
<a href="#l13.37"></a><span id="l13.37">         if (!tzid) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -375,17 +375,17 @@ function openCalendarWizard(aCallback) {</span>
<a href="#l14.4"></a><span id="l14.4"> function openCalendarProperties(aCalendar) {</span>
<a href="#l14.5"></a><span id="l14.5">     openDialog(&quot;chrome://calendar/content/calendar-properties-dialog.xul&quot;,</span>
<a href="#l14.6"></a><span id="l14.6">                &quot;CalendarPropertiesDialog&quot;,</span>
<a href="#l14.7"></a><span id="l14.7">                // Workaround for Bug 1151440 - the HTML color picker won't work</span>
<a href="#l14.8"></a><span id="l14.8">                // in linux when opened from modal dialog</span>
<a href="#l14.9"></a><span id="l14.9">                (AppConstants.platform == &quot;linux&quot;) ?</span>
<a href="#l14.10"></a><span id="l14.10">                  &quot;chrome,titlebar,resizable&quot; :</span>
<a href="#l14.11"></a><span id="l14.11">                  &quot;modal,chrome,titlebar,resizable&quot;,</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-               {calendar: aCalendar});</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+               { calendar: aCalendar });</span>
<a href="#l14.14"></a><span id="l14.14"> }</span>
<a href="#l14.15"></a><span id="l14.15"> </span>
<a href="#l14.16"></a><span id="l14.16"> /**</span>
<a href="#l14.17"></a><span id="l14.17">  * Opens the print dialog</span>
<a href="#l14.18"></a><span id="l14.18">  */</span>
<a href="#l14.19"></a><span id="l14.19"> function calPrint() {</span>
<a href="#l14.20"></a><span id="l14.20">     openDialog(&quot;chrome://calendar/content/calendar-print-dialog.xul&quot;, &quot;Print&quot;,</span>
<a href="#l14.21"></a><span id="l14.21">                &quot;centerscreen,chrome,resizable&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -11,17 +11,17 @@ var gTopComponent = null;</span>
<a href="#l15.4"></a><span id="l15.4"> var Tabstrip = React.createClass({</span>
<a href="#l15.5"></a><span id="l15.5">     handleChange: function(index) {</span>
<a href="#l15.6"></a><span id="l15.6">         // The click handler will update the state with</span>
<a href="#l15.7"></a><span id="l15.7">         // the index of the focused menu entry</span>
<a href="#l15.8"></a><span id="l15.8">         this.props.onInput(this.props.keyprop, index);</span>
<a href="#l15.9"></a><span id="l15.9">     },</span>
<a href="#l15.10"></a><span id="l15.10">     render: function() {</span>
<a href="#l15.11"></a><span id="l15.11">         return React.DOM.ul(</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-            {id: 'tabstrip'},</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+            { id: 'tabstrip' },</span>
<a href="#l15.14"></a><span id="l15.14">             this.props.tabs.map((tab, index) =&gt; {</span>
<a href="#l15.15"></a><span id="l15.15">                 let style = (this.props.activeTab == index) ? 'activeTab' : '';</span>
<a href="#l15.16"></a><span id="l15.16">                 // The bind() method makes the index</span>
<a href="#l15.17"></a><span id="l15.17">                 // available to the handleChange function:</span>
<a href="#l15.18"></a><span id="l15.18">                 return React.DOM.li({</span>
<a href="#l15.19"></a><span id="l15.19">                         className: style + ' tab',</span>
<a href="#l15.20"></a><span id="l15.20">                         key: 'tabkey' + index,</span>
<a href="#l15.21"></a><span id="l15.21">                         onClick: this.handleChange.bind(this, index)</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -128,17 +128,17 @@ var DatePicker = React.createClass({</span>
<a href="#l15.23"></a><span id="l15.23"> var Capsule = React.createClass({</span>
<a href="#l15.24"></a><span id="l15.24">     handleDelete: function() {</span>
<a href="#l15.25"></a><span id="l15.25">         this.props.onDelete(this.props.keyprop, this.props.value);</span>
<a href="#l15.26"></a><span id="l15.26">     },</span>
<a href="#l15.27"></a><span id="l15.27">     render: function() {</span>
<a href="#l15.28"></a><span id="l15.28">         return React.DOM.span(</span>
<a href="#l15.29"></a><span id="l15.29">             {</span>
<a href="#l15.30"></a><span id="l15.30">                 className: &quot;capsule&quot;,</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-                style: {background: &quot;ButtonHighlight&quot;},</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+                style: { background: &quot;ButtonHighlight&quot; },</span>
<a href="#l15.33"></a><span id="l15.33">             },</span>
<a href="#l15.34"></a><span id="l15.34">             this.props.value,</span>
<a href="#l15.35"></a><span id="l15.35">             React.DOM.span({</span>
<a href="#l15.36"></a><span id="l15.36">                 className: &quot;deleteCapsule&quot;,</span>
<a href="#l15.37"></a><span id="l15.37">                 onClick: this.handleDelete</span>
<a href="#l15.38"></a><span id="l15.38">             },</span>
<a href="#l15.39"></a><span id="l15.39">             &quot;x&quot;</span>
<a href="#l15.40"></a><span id="l15.40">             )</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineat">@@ -253,17 +253,17 @@ var TopComponent = React.createClass({</span>
<a href="#l15.42"></a><span id="l15.42"> </span>
<a href="#l15.43"></a><span id="l15.43">             isWideview: (window.innerWidth &gt; 750),</span>
<a href="#l15.44"></a><span id="l15.44">             activeTab: 0</span>
<a href="#l15.45"></a><span id="l15.45">         };</span>
<a href="#l15.46"></a><span id="l15.46">     },</span>
<a href="#l15.47"></a><span id="l15.47">     updateWideview: function() {</span>
<a href="#l15.48"></a><span id="l15.48">         let wv = (window.innerWidth &gt; 750);</span>
<a href="#l15.49"></a><span id="l15.49">         if (wv != this.state.isWideview) {</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineminus">-            this.setState({isWideview: wv});</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+            this.setState({ isWideview: wv });</span>
<a href="#l15.52"></a><span id="l15.52">         }</span>
<a href="#l15.53"></a><span id="l15.53">     },</span>
<a href="#l15.54"></a><span id="l15.54">     componentWillMount: function() {</span>
<a href="#l15.55"></a><span id="l15.55">         this.updateWideview();</span>
<a href="#l15.56"></a><span id="l15.56">     },</span>
<a href="#l15.57"></a><span id="l15.57">     componentDidMount: function() {</span>
<a href="#l15.58"></a><span id="l15.58">         window.addEventListener('resize', this.updateWideview);</span>
<a href="#l15.59"></a><span id="l15.59">     },</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineat">@@ -294,80 +294,80 @@ var TopComponent = React.createClass({</span>
<a href="#l15.61"></a><span id="l15.61">     },</span>
<a href="#l15.62"></a><span id="l15.62">     linkClicked: function(aValue) {</span>
<a href="#l15.63"></a><span id="l15.63"> </span>
<a href="#l15.64"></a><span id="l15.64">     },</span>
<a href="#l15.65"></a><span id="l15.65">     onDeleteCapsule: function(aKey, aValue) {</span>
<a href="#l15.66"></a><span id="l15.66">         let a = this.state[aKey];</span>
<a href="#l15.67"></a><span id="l15.67">         let index = a.indexOf(aValue);</span>
<a href="#l15.68"></a><span id="l15.68">         a.splice(index, 1);</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineminus">-        this.setState({aKey: a});</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+        this.setState({ aKey: a });</span>
<a href="#l15.71"></a><span id="l15.71">     },</span>
<a href="#l15.72"></a><span id="l15.72">     render: function() {</span>
<a href="#l15.73"></a><span id="l15.73">         // 'key' doesn't seem to work as a prop name (presumably because</span>
<a href="#l15.74"></a><span id="l15.74">         // already used by react?), so using 'keyprop' instead for now.</span>
<a href="#l15.75"></a><span id="l15.75">         let titleDiv = React.DOM.div(</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineminus">-            {id: 'titleDiv', className: 'box'},</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+            { id: 'titleDiv', className: 'box' },</span>
<a href="#l15.78"></a><span id="l15.78">             'Title ',</span>
<a href="#l15.79"></a><span id="l15.79">             React.createElement(TextField, {</span>
<a href="#l15.80"></a><span id="l15.80">                 keyprop: 'title',</span>
<a href="#l15.81"></a><span id="l15.81">                 value: this.state.title,</span>
<a href="#l15.82"></a><span id="l15.82">                 onInput: this.handleSimpleChange</span>
<a href="#l15.83"></a><span id="l15.83">             })</span>
<a href="#l15.84"></a><span id="l15.84">         );</span>
<a href="#l15.85"></a><span id="l15.85">         let locationDiv = React.DOM.div(</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineminus">-            {id: 'locationDiv', className: 'box'},</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineplus">+            { id: 'locationDiv', className: 'box' },</span>
<a href="#l15.88"></a><span id="l15.88">             'Location ',</span>
<a href="#l15.89"></a><span id="l15.89">             React.createElement(TextField, {</span>
<a href="#l15.90"></a><span id="l15.90">                 keyprop: 'location',</span>
<a href="#l15.91"></a><span id="l15.91">                 value: this.state.location,</span>
<a href="#l15.92"></a><span id="l15.92">                 onInput: this.handleSimpleChange</span>
<a href="#l15.93"></a><span id="l15.93">             })</span>
<a href="#l15.94"></a><span id="l15.94">         );</span>
<a href="#l15.95"></a><span id="l15.95">         let startDiv = React.DOM.div(</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineminus">-            {id: 'startDiv', className: 'box'},</span>
<a href="#l15.97"></a><span id="l15.97" class="difflineplus">+            { id: 'startDiv', className: 'box' },</span>
<a href="#l15.98"></a><span id="l15.98">             'Start ',</span>
<a href="#l15.99"></a><span id="l15.99">             // React.createElement(DatePicker, { }),</span>
<a href="#l15.100"></a><span id="l15.100">             React.createElement(TextField, {</span>
<a href="#l15.101"></a><span id="l15.101">                 keyprop: 'startDate',</span>
<a href="#l15.102"></a><span id="l15.102">                 value: this.state.startDate,</span>
<a href="#l15.103"></a><span id="l15.103">                 onInput: this.handleSimpleChange</span>
<a href="#l15.104"></a><span id="l15.104">             }),</span>
<a href="#l15.105"></a><span id="l15.105">             React.createElement(TextField, {</span>
<a href="#l15.106"></a><span id="l15.106">                 keyprop: 'startTime',</span>
<a href="#l15.107"></a><span id="l15.107">                 value: this.state.startTime,</span>
<a href="#l15.108"></a><span id="l15.108">                 onInput: this.handleSimpleChange</span>
<a href="#l15.109"></a><span id="l15.109">             })</span>
<a href="#l15.110"></a><span id="l15.110">         );</span>
<a href="#l15.111"></a><span id="l15.111">         let endDiv = React.DOM.div(</span>
<a href="#l15.112"></a><span id="l15.112" class="difflineminus">-            {id: 'endDiv', className: 'box'},</span>
<a href="#l15.113"></a><span id="l15.113" class="difflineplus">+            { id: 'endDiv', className: 'box' },</span>
<a href="#l15.114"></a><span id="l15.114">             'End ',</span>
<a href="#l15.115"></a><span id="l15.115">             React.createElement(TextField, {</span>
<a href="#l15.116"></a><span id="l15.116">                 keyprop: 'endDate',</span>
<a href="#l15.117"></a><span id="l15.117">                 value: this.state.endDate,</span>
<a href="#l15.118"></a><span id="l15.118">                 onInput: this.handleSimpleChange</span>
<a href="#l15.119"></a><span id="l15.119">             }),</span>
<a href="#l15.120"></a><span id="l15.120">             React.createElement(TextField, {</span>
<a href="#l15.121"></a><span id="l15.121">                 keyprop: 'endTime',</span>
<a href="#l15.122"></a><span id="l15.122">                 value: this.state.endTime,</span>
<a href="#l15.123"></a><span id="l15.123">                 onInput: this.handleSimpleChange</span>
<a href="#l15.124"></a><span id="l15.124">             })</span>
<a href="#l15.125"></a><span id="l15.125">             // React.createElement(DatePicker, { }),</span>
<a href="#l15.126"></a><span id="l15.126">         );</span>
<a href="#l15.127"></a><span id="l15.127">         let allDayDiv = React.DOM.div(</span>
<a href="#l15.128"></a><span id="l15.128" class="difflineminus">-            {id: 'allDayDiv', className: 'box'},</span>
<a href="#l15.129"></a><span id="l15.129" class="difflineplus">+            { id: 'allDayDiv', className: 'box' },</span>
<a href="#l15.130"></a><span id="l15.130">             React.createElement(Checkbox, {</span>
<a href="#l15.131"></a><span id="l15.131">                 keyprop: 'allDay',</span>
<a href="#l15.132"></a><span id="l15.132">                 checked: this.state.allDay,</span>
<a href="#l15.133"></a><span id="l15.133">                 onInput: this.handleSimpleChange</span>
<a href="#l15.134"></a><span id="l15.134">             }),</span>
<a href="#l15.135"></a><span id="l15.135">             'All day event'</span>
<a href="#l15.136"></a><span id="l15.136">         );</span>
<a href="#l15.137"></a><span id="l15.137">         let repeatDiv = React.DOM.div(</span>
<a href="#l15.138"></a><span id="l15.138" class="difflineminus">-            {id: 'repeatDiv', className: 'box'},</span>
<a href="#l15.139"></a><span id="l15.139" class="difflineplus">+            { id: 'repeatDiv', className: 'box' },</span>
<a href="#l15.140"></a><span id="l15.140">             'Repeat ',</span>
<a href="#l15.141"></a><span id="l15.141">             React.createElement(Dropdown, {</span>
<a href="#l15.142"></a><span id="l15.142">                 keyprop: 'repeat',</span>
<a href="#l15.143"></a><span id="l15.143">                 value: this.state.repeat,</span>
<a href="#l15.144"></a><span id="l15.144">                 options: this.props.repeatList,</span>
<a href="#l15.145"></a><span id="l15.145">                 onInput: this.handleSimpleChange</span>
<a href="#l15.146"></a><span id="l15.146">             }),</span>
<a href="#l15.147"></a><span id="l15.147">             (this.state.repeat != 'none' ?</span>
<a href="#l15.148"></a><span id="l15.148" class="difflineat">@@ -377,17 +377,17 @@ var TopComponent = React.createClass({</span>
<a href="#l15.149"></a><span id="l15.149">                 React.createElement(TextField, {</span>
<a href="#l15.150"></a><span id="l15.150">                     keyprop: 'repeatUntilDate',</span>
<a href="#l15.151"></a><span id="l15.151">                     value: this.state.repeatUntilDate,</span>
<a href="#l15.152"></a><span id="l15.152">                     onInput: this.handleSimpleChange</span>
<a href="#l15.153"></a><span id="l15.153">                 }) :</span>
<a href="#l15.154"></a><span id="l15.154">                 null)</span>
<a href="#l15.155"></a><span id="l15.155">         );</span>
<a href="#l15.156"></a><span id="l15.156">         let calendarDiv = React.DOM.div(</span>
<a href="#l15.157"></a><span id="l15.157" class="difflineminus">-            {id: 'calendarDiv', className: 'box'},</span>
<a href="#l15.158"></a><span id="l15.158" class="difflineplus">+            { id: 'calendarDiv', className: 'box' },</span>
<a href="#l15.159"></a><span id="l15.159">             'Calendar ',</span>
<a href="#l15.160"></a><span id="l15.160">             React.createElement(Dropdown, {</span>
<a href="#l15.161"></a><span id="l15.161">                 keyprop: 'calendarId',</span>
<a href="#l15.162"></a><span id="l15.162">                 value: this.state.calendarId,</span>
<a href="#l15.163"></a><span id="l15.163">                 options: this.props.calendarList,</span>
<a href="#l15.164"></a><span id="l15.164">                 onInput: this.handleSimpleChange</span>
<a href="#l15.165"></a><span id="l15.165">             })</span>
<a href="#l15.166"></a><span id="l15.166">         );</span>
<a href="#l15.167"></a><span id="l15.167" class="difflineat">@@ -402,149 +402,149 @@ var TopComponent = React.createClass({</span>
<a href="#l15.168"></a><span id="l15.168">                         keyprop: 'categories',</span>
<a href="#l15.169"></a><span id="l15.169">                         onDelete: this.onDeleteCapsule</span>
<a href="#l15.170"></a><span id="l15.170">                     });</span>
<a href="#l15.171"></a><span id="l15.171">                 });</span>
<a href="#l15.172"></a><span id="l15.172">         } else {</span>
<a href="#l15.173"></a><span id="l15.173">             categoriesCapsules = null;</span>
<a href="#l15.174"></a><span id="l15.174">         }</span>
<a href="#l15.175"></a><span id="l15.175">         let categoriesDiv = React.DOM.div(</span>
<a href="#l15.176"></a><span id="l15.176" class="difflineminus">-            {id: 'categoriesDiv', className: 'box'},</span>
<a href="#l15.177"></a><span id="l15.177" class="difflineplus">+            { id: 'categoriesDiv', className: 'box' },</span>
<a href="#l15.178"></a><span id="l15.178">             'Categories ',</span>
<a href="#l15.179"></a><span id="l15.179">             categoriesCapsules,</span>
<a href="#l15.180"></a><span id="l15.180">             React.createElement(Link, {</span>
<a href="#l15.181"></a><span id="l15.181">                 value: 'Add Categories',</span>
<a href="#l15.182"></a><span id="l15.182">                 onInput: this.linkClicked</span>
<a href="#l15.183"></a><span id="l15.183">             })</span>
<a href="#l15.184"></a><span id="l15.184">         );</span>
<a href="#l15.185"></a><span id="l15.185">         let attendeesDiv = React.DOM.div(</span>
<a href="#l15.186"></a><span id="l15.186" class="difflineminus">-            {id: 'attendeesDiv', className: 'box'},</span>
<a href="#l15.187"></a><span id="l15.187" class="difflineplus">+            { id: 'attendeesDiv', className: 'box' },</span>
<a href="#l15.188"></a><span id="l15.188">             'Attendees ',</span>
<a href="#l15.189"></a><span id="l15.189">             React.createElement(Link, {</span>
<a href="#l15.190"></a><span id="l15.190">                 value: 'Add Attendees',</span>
<a href="#l15.191"></a><span id="l15.191">                 onInput: this.linkClicked</span>
<a href="#l15.192"></a><span id="l15.192">             })</span>
<a href="#l15.193"></a><span id="l15.193">         );</span>
<a href="#l15.194"></a><span id="l15.194">         let remindersDiv = React.DOM.div(</span>
<a href="#l15.195"></a><span id="l15.195" class="difflineminus">-            {id: 'remindersDiv', className: 'box'},</span>
<a href="#l15.196"></a><span id="l15.196" class="difflineplus">+            { id: 'remindersDiv', className: 'box' },</span>
<a href="#l15.197"></a><span id="l15.197">             'Reminders ',</span>
<a href="#l15.198"></a><span id="l15.198">             React.createElement(Dropdown, {</span>
<a href="#l15.199"></a><span id="l15.199">                 keyprop: 'reminders',</span>
<a href="#l15.200"></a><span id="l15.200">                 value: this.state.reminders,</span>
<a href="#l15.201"></a><span id="l15.201">                 options: this.props.remindersList,</span>
<a href="#l15.202"></a><span id="l15.202">                 onInput: this.handleSimpleChange</span>
<a href="#l15.203"></a><span id="l15.203">             })</span>
<a href="#l15.204"></a><span id="l15.204">         );</span>
<a href="#l15.205"></a><span id="l15.205">         let attachmentsDiv = React.DOM.div(</span>
<a href="#l15.206"></a><span id="l15.206" class="difflineminus">-            {id: 'attachmentsDiv', className: 'box'},</span>
<a href="#l15.207"></a><span id="l15.207" class="difflineplus">+            { id: 'attachmentsDiv', className: 'box' },</span>
<a href="#l15.208"></a><span id="l15.208">             'Attachments ',</span>
<a href="#l15.209"></a><span id="l15.209">             React.createElement(Link, {</span>
<a href="#l15.210"></a><span id="l15.210">                 value: 'Add Attachments',</span>
<a href="#l15.211"></a><span id="l15.211">                 onInput: this.linkClicked</span>
<a href="#l15.212"></a><span id="l15.212">             })</span>
<a href="#l15.213"></a><span id="l15.213">         );</span>
<a href="#l15.214"></a><span id="l15.214">         let urlDiv = (this.state.showUrl ?</span>
<a href="#l15.215"></a><span id="l15.215">             React.DOM.div(</span>
<a href="#l15.216"></a><span id="l15.216" class="difflineminus">-            {id: 'urlDiv', className: 'box'},</span>
<a href="#l15.217"></a><span id="l15.217" class="difflineplus">+            { id: 'urlDiv', className: 'box' },</span>
<a href="#l15.218"></a><span id="l15.218">             'Event link ',</span>
<a href="#l15.219"></a><span id="l15.219">             React.createElement(Link, {</span>
<a href="#l15.220"></a><span id="l15.220">                 value: this.state.url,</span>
<a href="#l15.221"></a><span id="l15.221">                 onInput: this.linkClicked</span>
<a href="#l15.222"></a><span id="l15.222">             })) :</span>
<a href="#l15.223"></a><span id="l15.223">             null</span>
<a href="#l15.224"></a><span id="l15.224">         );</span>
<a href="#l15.225"></a><span id="l15.225"> </span>
<a href="#l15.226"></a><span id="l15.226">         let privacyDiv = React.DOM.div(</span>
<a href="#l15.227"></a><span id="l15.227" class="difflineminus">-            {id: 'privacyDiv', className: 'box'},</span>
<a href="#l15.228"></a><span id="l15.228" class="difflineplus">+            { id: 'privacyDiv', className: 'box' },</span>
<a href="#l15.229"></a><span id="l15.229">             'Privacy ',</span>
<a href="#l15.230"></a><span id="l15.230">             React.createElement(Dropdown, {</span>
<a href="#l15.231"></a><span id="l15.231">                 keyprop: 'privacy',</span>
<a href="#l15.232"></a><span id="l15.232">                 value: this.state.privacy,</span>
<a href="#l15.233"></a><span id="l15.233">                 options: this.props.privacyList,</span>
<a href="#l15.234"></a><span id="l15.234">                 onInput: this.handleSimpleChange</span>
<a href="#l15.235"></a><span id="l15.235">             })</span>
<a href="#l15.236"></a><span id="l15.236">         );</span>
<a href="#l15.237"></a><span id="l15.237">         let statusDiv = React.DOM.div(</span>
<a href="#l15.238"></a><span id="l15.238" class="difflineminus">-            {id: 'statusDiv', className: 'box'},</span>
<a href="#l15.239"></a><span id="l15.239" class="difflineplus">+            { id: 'statusDiv', className: 'box' },</span>
<a href="#l15.240"></a><span id="l15.240">             'Status ',</span>
<a href="#l15.241"></a><span id="l15.241">             React.createElement(Dropdown, {</span>
<a href="#l15.242"></a><span id="l15.242">                 keyprop: 'status',</span>
<a href="#l15.243"></a><span id="l15.243">                 value: this.state.status,</span>
<a href="#l15.244"></a><span id="l15.244">                 options: this.props.statusList,</span>
<a href="#l15.245"></a><span id="l15.245">                 onInput: this.handleSimpleChange</span>
<a href="#l15.246"></a><span id="l15.246">             })</span>
<a href="#l15.247"></a><span id="l15.247">         );</span>
<a href="#l15.248"></a><span id="l15.248">         let priorityDiv = React.DOM.div(</span>
<a href="#l15.249"></a><span id="l15.249" class="difflineminus">-            {id: 'priorityDiv', className: 'box'},</span>
<a href="#l15.250"></a><span id="l15.250" class="difflineplus">+            { id: 'priorityDiv', className: 'box' },</span>
<a href="#l15.251"></a><span id="l15.251">             'Priority ',</span>
<a href="#l15.252"></a><span id="l15.252">             React.createElement(Dropdown, {</span>
<a href="#l15.253"></a><span id="l15.253">                 keyprop: 'priority',</span>
<a href="#l15.254"></a><span id="l15.254">                 value: this.state.priority,</span>
<a href="#l15.255"></a><span id="l15.255">                 options: this.props.priorityList,</span>
<a href="#l15.256"></a><span id="l15.256">                 onInput: this.handleSimpleChange,</span>
<a href="#l15.257"></a><span id="l15.257">                 disabled: !this.props.supportsPriority</span>
<a href="#l15.258"></a><span id="l15.258">             })</span>
<a href="#l15.259"></a><span id="l15.259">         );</span>
<a href="#l15.260"></a><span id="l15.260"> </span>
<a href="#l15.261"></a><span id="l15.261">         let tIndex = this.props.showTimeAsList.findIndex(</span>
<a href="#l15.262"></a><span id="l15.262">             (t) =&gt; (t[0] == this.state.showTimeAs));</span>
<a href="#l15.263"></a><span id="l15.263">         let showTimeAsDiv = React.DOM.div(</span>
<a href="#l15.264"></a><span id="l15.264" class="difflineminus">-            {id: 'showTimeAsDiv', className: 'box'},</span>
<a href="#l15.265"></a><span id="l15.265" class="difflineplus">+            { id: 'showTimeAsDiv', className: 'box' },</span>
<a href="#l15.266"></a><span id="l15.266">             React.createElement(Checkbox, {</span>
<a href="#l15.267"></a><span id="l15.267">                 keyprop: 'showTimeAs',</span>
<a href="#l15.268"></a><span id="l15.268">                 checked: (tIndex == -1 ? false : this.props.showTimeAsList[tIndex][1]),</span>
<a href="#l15.269"></a><span id="l15.269">                 onInput: this.handleShowTimeAsChange,</span>
<a href="#l15.270"></a><span id="l15.270">                 options: this.props.showTimeAsList</span>
<a href="#l15.271"></a><span id="l15.271">             }),</span>
<a href="#l15.272"></a><span id="l15.272">             'Show Time As Busy'</span>
<a href="#l15.273"></a><span id="l15.273">         );</span>
<a href="#l15.274"></a><span id="l15.274">         let descriptionDiv = React.DOM.div(</span>
<a href="#l15.275"></a><span id="l15.275" class="difflineminus">-            {id: 'description', value: 'Description'},</span>
<a href="#l15.276"></a><span id="l15.276" class="difflineplus">+            { id: 'description', value: 'Description' },</span>
<a href="#l15.277"></a><span id="l15.277">             React.createElement(TextArea, {</span>
<a href="#l15.278"></a><span id="l15.278">                 keyprop: 'description',</span>
<a href="#l15.279"></a><span id="l15.279">                 value: this.state.description,</span>
<a href="#l15.280"></a><span id="l15.280">                 onInput: this.handleSimpleChange</span>
<a href="#l15.281"></a><span id="l15.281">             })</span>
<a href="#l15.282"></a><span id="l15.282">         );</span>
<a href="#l15.283"></a><span id="l15.283"> </span>
<a href="#l15.284"></a><span id="l15.284">         if (this.state.isWideview) {</span>
<a href="#l15.285"></a><span id="l15.285">             // wideview</span>
<a href="#l15.286"></a><span id="l15.286">             return React.DOM.div(</span>
<a href="#l15.287"></a><span id="l15.287" class="difflineminus">-                {id: 'topwrapper'},</span>
<a href="#l15.288"></a><span id="l15.288" class="difflineplus">+                { id: 'topwrapper' },</span>
<a href="#l15.289"></a><span id="l15.289">                 React.DOM.div(</span>
<a href="#l15.290"></a><span id="l15.290" class="difflineminus">-                    {className: 'wrapper'},</span>
<a href="#l15.291"></a><span id="l15.291" class="difflineplus">+                    { className: 'wrapper' },</span>
<a href="#l15.292"></a><span id="l15.292">                     titleDiv,</span>
<a href="#l15.293"></a><span id="l15.293">                     startDiv,</span>
<a href="#l15.294"></a><span id="l15.294">                     endDiv,</span>
<a href="#l15.295"></a><span id="l15.295">                     allDayDiv,</span>
<a href="#l15.296"></a><span id="l15.296">                     repeatDiv,</span>
<a href="#l15.297"></a><span id="l15.297">                     attendeesDiv,</span>
<a href="#l15.298"></a><span id="l15.298">                     locationDiv,</span>
<a href="#l15.299"></a><span id="l15.299">                     calendarDiv,</span>
<a href="#l15.300"></a><span id="l15.300">                     categoriesDiv,</span>
<a href="#l15.301"></a><span id="l15.301">                     remindersDiv,</span>
<a href="#l15.302"></a><span id="l15.302">                     attachmentsDiv,</span>
<a href="#l15.303"></a><span id="l15.303">                     urlDiv</span>
<a href="#l15.304"></a><span id="l15.304">                     ),</span>
<a href="#l15.305"></a><span id="l15.305">                 descriptionDiv,</span>
<a href="#l15.306"></a><span id="l15.306">                 React.DOM.div(</span>
<a href="#l15.307"></a><span id="l15.307" class="difflineminus">-                    {className: 'wrapper', id: 'wrapper2'},</span>
<a href="#l15.308"></a><span id="l15.308" class="difflineplus">+                    { className: 'wrapper', id: 'wrapper2' },</span>
<a href="#l15.309"></a><span id="l15.309">                     privacyDiv,</span>
<a href="#l15.310"></a><span id="l15.310">                     statusDiv,</span>
<a href="#l15.311"></a><span id="l15.311">                     priorityDiv,</span>
<a href="#l15.312"></a><span id="l15.312">                     showTimeAsDiv</span>
<a href="#l15.313"></a><span id="l15.313">                 )</span>
<a href="#l15.314"></a><span id="l15.314">             );</span>
<a href="#l15.315"></a><span id="l15.315">         } else {</span>
<a href="#l15.316"></a><span id="l15.316">             // narrowview</span>
<a href="#l15.317"></a><span id="l15.317">             let tabpanelChildren = [</span>
<a href="#l15.318"></a><span id="l15.318">                 descriptionDiv,</span>
<a href="#l15.319"></a><span id="l15.319">                 React.DOM.div({</span>
<a href="#l15.320"></a><span id="l15.320">                         className: 'wrapper',</span>
<a href="#l15.321"></a><span id="l15.321" class="difflineminus">-                        style: {flexDirection: 'column'},</span>
<a href="#l15.322"></a><span id="l15.322" class="difflineplus">+                        style: { flexDirection: 'column' },</span>
<a href="#l15.323"></a><span id="l15.323">                     },</span>
<a href="#l15.324"></a><span id="l15.324">                     statusDiv,</span>
<a href="#l15.325"></a><span id="l15.325">                     priorityDiv,</span>
<a href="#l15.326"></a><span id="l15.326">                     showTimeAsDiv</span>
<a href="#l15.327"></a><span id="l15.327">                 ),</span>
<a href="#l15.328"></a><span id="l15.328">                 remindersDiv,</span>
<a href="#l15.329"></a><span id="l15.329">                 attachmentsDiv,</span>
<a href="#l15.330"></a><span id="l15.330">                 attendeesDiv</span>
<a href="#l15.331"></a><span id="l15.331" class="difflineat">@@ -552,26 +552,26 @@ var TopComponent = React.createClass({</span>
<a href="#l15.332"></a><span id="l15.332">             let tabpanels = this.props.tabs.map((m, index) =&gt; {</span>
<a href="#l15.333"></a><span id="l15.333">                 return React.DOM.div({</span>
<a href="#l15.334"></a><span id="l15.334">                         className: 'box tabpanel ' + (this.state.activeTab == index ? '' : 'hidden'),</span>
<a href="#l15.335"></a><span id="l15.335">                         key: 'tabpanelkey ' + index</span>
<a href="#l15.336"></a><span id="l15.336">                     },</span>
<a href="#l15.337"></a><span id="l15.337">                     tabpanelChildren[index]</span>
<a href="#l15.338"></a><span id="l15.338">                 );</span>
<a href="#l15.339"></a><span id="l15.339">             });</span>
<a href="#l15.340"></a><span id="l15.340" class="difflineminus">-            return React.DOM.div({id: 'topwrapper'},</span>
<a href="#l15.341"></a><span id="l15.341" class="difflineminus">-                React.DOM.div({className: 'wrapper'},</span>
<a href="#l15.342"></a><span id="l15.342" class="difflineplus">+            return React.DOM.div({ id: 'topwrapper' },</span>
<a href="#l15.343"></a><span id="l15.343" class="difflineplus">+                React.DOM.div({ className: 'wrapper' },</span>
<a href="#l15.344"></a><span id="l15.344">                     titleDiv,</span>
<a href="#l15.345"></a><span id="l15.345">                     locationDiv,</span>
<a href="#l15.346"></a><span id="l15.346">                     startDiv,</span>
<a href="#l15.347"></a><span id="l15.347">                     endDiv,</span>
<a href="#l15.348"></a><span id="l15.348">                     allDayDiv,</span>
<a href="#l15.349"></a><span id="l15.349">                     repeatDiv,</span>
<a href="#l15.350"></a><span id="l15.350">                     React.DOM.div(</span>
<a href="#l15.351"></a><span id="l15.351" class="difflineminus">-                        {style: {flexDirection: 'row', display: 'flex'}},</span>
<a href="#l15.352"></a><span id="l15.352" class="difflineplus">+                        { style: { flexDirection: 'row', display: 'flex' } },</span>
<a href="#l15.353"></a><span id="l15.353">                         calendarDiv,</span>
<a href="#l15.354"></a><span id="l15.354">                         privacyDiv</span>
<a href="#l15.355"></a><span id="l15.355">                     ),</span>
<a href="#l15.356"></a><span id="l15.356">                     categoriesDiv,</span>
<a href="#l15.357"></a><span id="l15.357">                     React.createElement(</span>
<a href="#l15.358"></a><span id="l15.358">                         Tabstrip, {</span>
<a href="#l15.359"></a><span id="l15.359">                             tabs: this.props.tabs,</span>
<a href="#l15.360"></a><span id="l15.360">                             keyprop: 'activeTab',</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/lightning/content/imip-bar.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/lightning/content/imip-bar.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -225,18 +225,18 @@ var ltnImipBar = {</span>
<a href="#l16.4"></a><span id="l16.4">         };</span>
<a href="#l16.5"></a><span id="l16.5"> </span>
<a href="#l16.6"></a><span id="l16.6">         // We override the bar label for sent out invitations and in case the event does not exist</span>
<a href="#l16.7"></a><span id="l16.7">         // anymore, we also clear the buttons if any to avoid e.g. accept/decline buttons</span>
<a href="#l16.8"></a><span id="l16.8">         if (isOutgoing(gMessageDisplay.displayedMessage)) {</span>
<a href="#l16.9"></a><span id="l16.9">             if (ltnImipBar.foundItems &amp;&amp; ltnImipBar.foundItems[0]) {</span>
<a href="#l16.10"></a><span id="l16.10">                 data.label = ltn.getString(&quot;lightning&quot;, &quot;imipBarSentText&quot;);</span>
<a href="#l16.11"></a><span id="l16.11">             } else {</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-                data = {label: ltn.getString(&quot;lightning&quot;, &quot;imipBarSentButRemovedText&quot;),</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-                        buttons: [], hideMenuItems: []};</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+                data = { label: ltn.getString(&quot;lightning&quot;, &quot;imipBarSentButRemovedText&quot;),</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+                         buttons: [], hideMenuItems: [] };</span>
<a href="#l16.16"></a><span id="l16.16">             }</span>
<a href="#l16.17"></a><span id="l16.17">         }</span>
<a href="#l16.18"></a><span id="l16.18"> </span>
<a href="#l16.19"></a><span id="l16.19">         imipBar.setAttribute(&quot;label&quot;, data.label);</span>
<a href="#l16.20"></a><span id="l16.20">         // let's reset all buttons first</span>
<a href="#l16.21"></a><span id="l16.21">         ltnImipBar.resetButtons();</span>
<a href="#l16.22"></a><span id="l16.22">         // menu items are visible by default, let's hide what's not available</span>
<a href="#l16.23"></a><span id="l16.23">         data.hideMenuItems.forEach(aElementId =&gt; hideElement(document.getElementById(aElementId)));</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineat">@@ -359,18 +359,18 @@ var ltnImipBar = {</span>
<a href="#l16.25"></a><span id="l16.25">             }</span>
<a href="#l16.26"></a><span id="l16.26"> </span>
<a href="#l16.27"></a><span id="l16.27">             if (partStat == &quot;X-SAVECOPY&quot;) {</span>
<a href="#l16.28"></a><span id="l16.28">                 // we create and adopt copies of the respective events</span>
<a href="#l16.29"></a><span id="l16.29">                 let saveitems = ltnImipBar.itipItem.getItemList({}).map(cal.getPublishLikeItemCopy.bind(cal));</span>
<a href="#l16.30"></a><span id="l16.30">                 if (saveitems.length &gt; 0) {</span>
<a href="#l16.31"></a><span id="l16.31">                     let newItipItem = cal.itip.getModifiedItipItem(ltnImipBar.itipItem,</span>
<a href="#l16.32"></a><span id="l16.32">                                                                    saveitems,</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-                                                                   {receivedMethod: &quot;PUBLISH&quot;,</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineminus">-                                                                    responseMethod: &quot;PUBLISH&quot;});</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineplus">+                                                                   { receivedMethod: &quot;PUBLISH&quot;,</span>
<a href="#l16.36"></a><span id="l16.36" class="difflineplus">+                                                                     responseMethod: &quot;PUBLISH&quot; });</span>
<a href="#l16.37"></a><span id="l16.37">                     // control to avoid processing _execAction on later user changes on the item</span>
<a href="#l16.38"></a><span id="l16.38">                     let isFirstProcessing = true;</span>
<a href="#l16.39"></a><span id="l16.39">                     // setup callback and trigger re-processing</span>
<a href="#l16.40"></a><span id="l16.40">                     let storeCopy = function storeCopy(aItipItem, aRc, aActionFunc, aFoundItems) {</span>
<a href="#l16.41"></a><span id="l16.41">                         if (isFirstProcessing &amp;&amp; aActionFunc &amp;&amp; Components.isSuccessCode(aRc)) {</span>
<a href="#l16.42"></a><span id="l16.42">                             _execAction(aActionFunc, aItipItem, window, partStat);</span>
<a href="#l16.43"></a><span id="l16.43">                         }</span>
<a href="#l16.44"></a><span id="l16.44">                     };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -263,17 +263,17 @@ calDavCalendar.prototype = {</span>
<a href="#l17.4"></a><span id="l17.4">             onGetResult: function meta_onGetResult(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l17.5"></a><span id="l17.5">                 for (let item of aItems) {</span>
<a href="#l17.6"></a><span id="l17.6">                     if (!(item.id in self.mItemInfoCache)) {</span>
<a href="#l17.7"></a><span id="l17.7">                         let path = self.getItemLocationPath(item);</span>
<a href="#l17.8"></a><span id="l17.8">                         cal.LOG(&quot;Adding meta-data for cached item &quot; + item.id);</span>
<a href="#l17.9"></a><span id="l17.9">                         self.mItemInfoCache[item.id] = { etag: null,</span>
<a href="#l17.10"></a><span id="l17.10">                                                          isNew: false,</span>
<a href="#l17.11"></a><span id="l17.11">                                                          locationPath: path,</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-                                                         isInboxItem: false};</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+                                                         isInboxItem: false };</span>
<a href="#l17.14"></a><span id="l17.14">                         self.mHrefIndex[self.mLocationPath + path] = item.id;</span>
<a href="#l17.15"></a><span id="l17.15">                         refreshNeeded = true;</span>
<a href="#l17.16"></a><span id="l17.16">                     }</span>
<a href="#l17.17"></a><span id="l17.17">                 }</span>
<a href="#l17.18"></a><span id="l17.18">             },</span>
<a href="#l17.19"></a><span id="l17.19">             onOperationComplete: function meta_onOperationComplete(aCalendar, aStatus, aOpType, aId, aDetail) {</span>
<a href="#l17.20"></a><span id="l17.20">                 if (refreshNeeded) {</span>
<a href="#l17.21"></a><span id="l17.21">                     // reseting the cached ctag forces an item refresh when</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -318,17 +318,17 @@ calDavCalendar.prototype = {</span>
<a href="#l17.23"></a><span id="l17.23">                 let isInboxItem = itemDataArray[2];</span>
<a href="#l17.24"></a><span id="l17.24">                 if (itemDataArray.length == 3) {</span>
<a href="#l17.25"></a><span id="l17.25">                     this.mHrefIndex[resourcePath] = itemId;</span>
<a href="#l17.26"></a><span id="l17.26">                     let locationPath = resourcePath</span>
<a href="#l17.27"></a><span id="l17.27">                         .substr(this.mLocationPath.length);</span>
<a href="#l17.28"></a><span id="l17.28">                     let item = { etag: etag,</span>
<a href="#l17.29"></a><span id="l17.29">                                  isNew: false,</span>
<a href="#l17.30"></a><span id="l17.30">                                  locationPath: locationPath,</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-                                 isInboxItem: (isInboxItem == &quot;true&quot;)};</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+                                 isInboxItem: (isInboxItem == &quot;true&quot;) };</span>
<a href="#l17.33"></a><span id="l17.33">                     this.mItemInfoCache[itemId] = item;</span>
<a href="#l17.34"></a><span id="l17.34">                 }</span>
<a href="#l17.35"></a><span id="l17.35">             }</span>
<a href="#l17.36"></a><span id="l17.36">         }</span>
<a href="#l17.37"></a><span id="l17.37"> </span>
<a href="#l17.38"></a><span id="l17.38">         this.ensureMetaData();</span>
<a href="#l17.39"></a><span id="l17.39">     },</span>
<a href="#l17.40"></a><span id="l17.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -134,22 +134,22 @@ calICSCalendar.prototype = {</span>
<a href="#l18.4"></a><span id="l18.4">         switch (aName) {</span>
<a href="#l18.5"></a><span id="l18.5">             case &quot;requiresNetwork&quot;:</span>
<a href="#l18.6"></a><span id="l18.6">                 return (!this.uri.schemeIs(&quot;file&quot;));</span>
<a href="#l18.7"></a><span id="l18.7">         }</span>
<a href="#l18.8"></a><span id="l18.8">         return this.__proto__.__proto__.getProperty.apply(this, arguments);</span>
<a href="#l18.9"></a><span id="l18.9">     },</span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11">     refresh: function calICSCalendar_refresh() {</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-        this.queue.push({action: 'refresh', forceRefresh: false});</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+        this.queue.push({ action: 'refresh', forceRefresh: false });</span>
<a href="#l18.14"></a><span id="l18.14">         this.processQueue();</span>
<a href="#l18.15"></a><span id="l18.15">     },</span>
<a href="#l18.16"></a><span id="l18.16"> </span>
<a href="#l18.17"></a><span id="l18.17">     forceRefresh: function calICSCalendar_forceRefresh() {</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineminus">-        this.queue.push({action: 'refresh', forceRefresh: true});</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+        this.queue.push({ action: 'refresh', forceRefresh: true });</span>
<a href="#l18.20"></a><span id="l18.20">         this.processQueue();</span>
<a href="#l18.21"></a><span id="l18.21">     },</span>
<a href="#l18.22"></a><span id="l18.22"> </span>
<a href="#l18.23"></a><span id="l18.23">     prepareChannel: function calICSCalendar_prepareChannel(aChannel, aForceRefresh) {</span>
<a href="#l18.24"></a><span id="l18.24">         aChannel.loadFlags |= Components.interfaces.nsIRequest.LOAD_BYPASS_CACHE;</span>
<a href="#l18.25"></a><span id="l18.25">         aChannel.notificationCallbacks = this;</span>
<a href="#l18.26"></a><span id="l18.26"> </span>
<a href="#l18.27"></a><span id="l18.27">         // Allow the hook to do its work, like a performing a quick check to</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineat">@@ -467,38 +467,38 @@ calICSCalendar.prototype = {</span>
<a href="#l18.29"></a><span id="l18.29">         this.processQueue();</span>
<a href="#l18.30"></a><span id="l18.30">     },</span>
<a href="#l18.31"></a><span id="l18.31"> </span>
<a href="#l18.32"></a><span id="l18.32">     modifyItem: function(aNewItem, aOldItem, aListener) {</span>
<a href="#l18.33"></a><span id="l18.33">         if (this.readOnly) {</span>
<a href="#l18.34"></a><span id="l18.34">             throw calIErrors.CAL_IS_READONLY;</span>
<a href="#l18.35"></a><span id="l18.35">         }</span>
<a href="#l18.36"></a><span id="l18.36">         this.queue.push({ action: 'modify', oldItem: aOldItem,</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineminus">-                          newItem: aNewItem, listener: aListener});</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineplus">+                          newItem: aNewItem, listener: aListener });</span>
<a href="#l18.39"></a><span id="l18.39">         this.processQueue();</span>
<a href="#l18.40"></a><span id="l18.40">     },</span>
<a href="#l18.41"></a><span id="l18.41"> </span>
<a href="#l18.42"></a><span id="l18.42">     deleteItem: function(aItem, aListener) {</span>
<a href="#l18.43"></a><span id="l18.43">         if (this.readOnly) {</span>
<a href="#l18.44"></a><span id="l18.44">             throw calIErrors.CAL_IS_READONLY;</span>
<a href="#l18.45"></a><span id="l18.45">         }</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineminus">-        this.queue.push({action: 'delete', item: aItem, listener: aListener});</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+        this.queue.push({ action: 'delete', item: aItem, listener: aListener });</span>
<a href="#l18.48"></a><span id="l18.48">         this.processQueue();</span>
<a href="#l18.49"></a><span id="l18.49">     },</span>
<a href="#l18.50"></a><span id="l18.50"> </span>
<a href="#l18.51"></a><span id="l18.51">     getItem: function(aId, aListener) {</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineminus">-        this.queue.push({action: 'get_item', id: aId, listener: aListener});</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineplus">+        this.queue.push({ action: 'get_item', id: aId, listener: aListener });</span>
<a href="#l18.54"></a><span id="l18.54">         this.processQueue();</span>
<a href="#l18.55"></a><span id="l18.55">     },</span>
<a href="#l18.56"></a><span id="l18.56"> </span>
<a href="#l18.57"></a><span id="l18.57">     getItems: function(aItemFilter, aCount, aRangeStart, aRangeEnd, aListener) {</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineminus">-        this.queue.push({action: 'get_items',</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineminus">-                         itemFilter: aItemFilter, count: aCount,</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineminus">-                         rangeStart: aRangeStart, rangeEnd: aRangeEnd,</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineminus">-                         listener: aListener});</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+        this.queue.push({ action: 'get_items',</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineplus">+                          itemFilter: aItemFilter, count: aCount,</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineplus">+                          rangeStart: aRangeStart, rangeEnd: aRangeEnd,</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineplus">+                          listener: aListener });</span>
<a href="#l18.66"></a><span id="l18.66">         this.processQueue();</span>
<a href="#l18.67"></a><span id="l18.67">     },</span>
<a href="#l18.68"></a><span id="l18.68"> </span>
<a href="#l18.69"></a><span id="l18.69">     processQueue: function() {</span>
<a href="#l18.70"></a><span id="l18.70">         if (this.isLocked()) {</span>
<a href="#l18.71"></a><span id="l18.71">             return;</span>
<a href="#l18.72"></a><span id="l18.72">         }</span>
<a href="#l18.73"></a><span id="l18.73"> </span>
<a href="#l18.74"></a><span id="l18.74" class="difflineat">@@ -684,17 +684,17 @@ calICSCalendar.prototype = {</span>
<a href="#l18.75"></a><span id="l18.75"> </span>
<a href="#l18.76"></a><span id="l18.76">         function purgeOldBackups() {</span>
<a href="#l18.77"></a><span id="l18.77">             // Enumerate files in the backupdir for expiry of old backups</span>
<a href="#l18.78"></a><span id="l18.78">             let dirEnum = backupDir.directoryEntries;</span>
<a href="#l18.79"></a><span id="l18.79">             let files = [];</span>
<a href="#l18.80"></a><span id="l18.80">             while (dirEnum.hasMoreElements()) {</span>
<a href="#l18.81"></a><span id="l18.81">                 let file = dirEnum.getNext().QueryInterface(CI.nsIFile);</span>
<a href="#l18.82"></a><span id="l18.82">                 if (file.isFile()) {</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineminus">-                    files.push({name: file.leafName, lastmodified: file.lastModifiedTime});</span>
<a href="#l18.84"></a><span id="l18.84" class="difflineplus">+                    files.push({ name: file.leafName, lastmodified: file.lastModifiedTime });</span>
<a href="#l18.85"></a><span id="l18.85">                 }</span>
<a href="#l18.86"></a><span id="l18.86">             }</span>
<a href="#l18.87"></a><span id="l18.87"> </span>
<a href="#l18.88"></a><span id="l18.88">             if (doDailyBackup) {</span>
<a href="#l18.89"></a><span id="l18.89">                 purgeBackupsByType(files, 'day');</span>
<a href="#l18.90"></a><span id="l18.90">             } else {</span>
<a href="#l18.91"></a><span id="l18.91">                 purgeBackupsByType(files, 'edit');</span>
<a href="#l18.92"></a><span id="l18.92">             }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -45,35 +45,35 @@</span>
<a href="#l19.4"></a><span id="l19.4">       &lt;field name=&quot;mMonthShortNames&quot;&gt;[]&lt;/field&gt;</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l19.7"></a><span id="l19.7">         Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l19.8"></a><span id="l19.8">         let goButton = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;date-go-button&quot;);</span>
<a href="#l19.9"></a><span id="l19.9">         goButton.setAttribute(&quot;label&quot;, calGetString(&quot;calendar&quot;, &quot;go&quot;));</span>
<a href="#l19.10"></a><span id="l19.10">         // Load the stuff we're going to use to parse written dates</span>
<a href="#l19.11"></a><span id="l19.11">         this.mRelativeDates = [</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;today&quot;).toLowerCase(), offset: 0},</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;yesterday&quot;).toLowerCase(), offset: -1},</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;tomorrow&quot;).toLowerCase(), offset: 1}];</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;today&quot;).toLowerCase(), offset: 0 },</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;yesterday&quot;).toLowerCase(), offset: -1 },</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;tomorrow&quot;).toLowerCase(), offset: 1 }];</span>
<a href="#l19.18"></a><span id="l19.18">         for (let i = 1; i &lt;= 7; i++) {</span>
<a href="#l19.19"></a><span id="l19.19">           this.mDayNames.push(calGetString(&quot;dateFormat&quot;, &quot;day.&quot; + i + &quot;.name&quot;).toLowerCase());</span>
<a href="#l19.20"></a><span id="l19.20">         }</span>
<a href="#l19.21"></a><span id="l19.21"> </span>
<a href="#l19.22"></a><span id="l19.22">         for (let i = 1; i &lt;= 12; i++) {</span>
<a href="#l19.23"></a><span id="l19.23">           this.mMonthLongNames.push(calGetString(&quot;dateFormat&quot;, &quot;month.&quot; + i + &quot;.name&quot;).toLowerCase());</span>
<a href="#l19.24"></a><span id="l19.24">           this.mMonthShortNames.push(calGetString(&quot;dateFormat&quot;, &quot;month.&quot; + i + &quot;.Mmm&quot;).toLowerCase());</span>
<a href="#l19.25"></a><span id="l19.25">         }</span>
<a href="#l19.26"></a><span id="l19.26"> </span>
<a href="#l19.27"></a><span id="l19.27">         // note that some languages have different conjugations of</span>
<a href="#l19.28"></a><span id="l19.28">         // next/last depending on the day</span>
<a href="#l19.29"></a><span id="l19.29">         this.mRelationWords = [</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;last1&quot;), offset: -1},</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;last2&quot;), offset: -1},</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;next1&quot;), offset: 0},</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineminus">-            {word: cal.calGetString(&quot;calendar&quot;, &quot;next2&quot;), offset: 0}];</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;last1&quot;), offset: -1 },</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;last2&quot;), offset: -1 },</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;next1&quot;), offset: 0 },</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineplus">+            { word: cal.calGetString(&quot;calendar&quot;, &quot;next2&quot;), offset: 0 }];</span>
<a href="#l19.38"></a><span id="l19.38"> </span>
<a href="#l19.39"></a><span id="l19.39">         // Set the value to today</span>
<a href="#l19.40"></a><span id="l19.40">         let text = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;date-textbox&quot;);</span>
<a href="#l19.41"></a><span id="l19.41">         text.value = calGetString(&quot;calendar&quot;, &quot;today&quot;);</span>
<a href="#l19.42"></a><span id="l19.42">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l19.43"></a><span id="l19.43"> </span>
<a href="#l19.44"></a><span id="l19.44">       &lt;property name=&quot;value&quot;&gt;</span>
<a href="#l19.45"></a><span id="l19.45">         &lt;getter&gt;&lt;![CDATA[</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -7,29 +7,29 @@ var modalDialog = require(&quot;../shared-mod</span>
<a href="#l20.4"></a><span id="l20.4"> var prefs = require(&quot;../shared-modules/prefs&quot;);</span>
<a href="#l20.5"></a><span id="l20.5"> </span>
<a href="#l20.6"></a><span id="l20.6"> var sleep = 500;</span>
<a href="#l20.7"></a><span id="l20.7"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l20.8"></a><span id="l20.8"> var pass;</span>
<a href="#l20.9"></a><span id="l20.9"> var date1 = new Date(2009, 0, 1, 8, 0);</span>
<a href="#l20.10"></a><span id="l20.10"> var date2 = new Date(2009, 0, 2, 9, 0);</span>
<a href="#l20.11"></a><span id="l20.11"> var date3 = new Date(2009, 0, 3, 10, 0);</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-var data = [{title: &quot;title1&quot;, location: &quot;location1&quot;, description: &quot;description1&quot;, allday: false,</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-             startdate: date1, starttime: date1, enddate: date2, endtime: date2, repeat: &quot;none&quot;,</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-             reminder: 0, priority: &quot;normal&quot;, privacy: &quot;public&quot;, status: &quot;confirmed&quot;,</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-             freebusy: &quot;busy&quot;, timezone: true, attachment: {add: &quot;http://mozilla.org&quot;}},</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-            {title: &quot;title2&quot;, location: &quot;location2&quot;, description: &quot;description2&quot;, allday: true,</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineminus">-             startdate: date2, starttime: date2, enddate: date3, endtime: date3, repeat: &quot;daily&quot;,</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineminus">-             reminder: 2, priority: &quot;high&quot;, privacy: &quot;private&quot;, status: &quot;tentative&quot;,</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineminus">-             freebusy: &quot;free&quot;, timezone: true, attachment: {delete: &quot;mozilla.org&quot;}}];</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineminus">-var newlines = [{title: &quot;title&quot;, description: &quot;  test spaces  &quot;},</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineminus">-                {title: &quot;title&quot;, description: &quot;\ntest newline\n&quot;},</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineminus">-                {title: &quot;title&quot;, description: &quot;\rtest \\r\r&quot;},</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineminus">-                {title: &quot;title&quot;, description: &quot;\r\ntest \\r\\n\r\n&quot;},</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineminus">-                {title: &quot;title&quot;, description: &quot;\ttest \\t\t&quot;}];</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineplus">+var data = [{ title: &quot;title1&quot;, location: &quot;location1&quot;, description: &quot;description1&quot;, allday: false,</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+              startdate: date1, starttime: date1, enddate: date2, endtime: date2, repeat: &quot;none&quot;,</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineplus">+              reminder: 0, priority: &quot;normal&quot;, privacy: &quot;public&quot;, status: &quot;confirmed&quot;,</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineplus">+              freebusy: &quot;busy&quot;, timezone: true, attachment: { add: &quot;http://mozilla.org&quot; } },</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineplus">+            { title: &quot;title2&quot;, location: &quot;location2&quot;, description: &quot;description2&quot;, allday: true,</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineplus">+              startdate: date2, starttime: date2, enddate: date3, endtime: date3, repeat: &quot;daily&quot;,</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+              reminder: 2, priority: &quot;high&quot;, privacy: &quot;private&quot;, status: &quot;tentative&quot;,</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+              freebusy: &quot;free&quot;, timezone: true, attachment: { delete: &quot;mozilla.org&quot; } }];</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+var newlines = [{ title: &quot;title&quot;, description: &quot;  test spaces  &quot; },</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+                { title: &quot;title&quot;, description: &quot;\ntest newline\n&quot; },</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+                { title: &quot;title&quot;, description: &quot;\rtest \\r\r&quot; },</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineplus">+                { title: &quot;title&quot;, description: &quot;\r\ntest \\r\\n\r\n&quot; },</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineplus">+                { title: &quot;title&quot;, description: &quot;\ttest \\t\t&quot; }];</span>
<a href="#l20.38"></a><span id="l20.38"> </span>
<a href="#l20.39"></a><span id="l20.39"> var setupModule = function(module) {</span>
<a href="#l20.40"></a><span id="l20.40">   controller = mozmill.getMail3PaneController();</span>
<a href="#l20.41"></a><span id="l20.41">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l20.42"></a><span id="l20.42"> </span>
<a href="#l20.43"></a><span id="l20.43">   let categories = prefs.preferences.getPref(&quot;calendar.categories.names&quot;, &quot;string&quot;).split(',');</span>
<a href="#l20.44"></a><span id="l20.44">   data[0].category = categories[0];</span>
<a href="#l20.45"></a><span id="l20.45">   data[1].category = categories[1];</span>
<a href="#l20.46"></a><span id="l20.46" class="difflineat">@@ -39,50 +39,50 @@ var setupModule = function(module) {</span>
<a href="#l20.47"></a><span id="l20.47"> var testEventDialogModificationPrompt = function() {</span>
<a href="#l20.48"></a><span id="l20.48">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l20.49"></a><span id="l20.49">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l20.50"></a><span id="l20.50">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l20.51"></a><span id="l20.51"> </span>
<a href="#l20.52"></a><span id="l20.52">   // create new event</span>
<a href="#l20.53"></a><span id="l20.53">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l20.54"></a><span id="l20.54">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, 8)), 1, 1);</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l20.56"></a><span id="l20.56" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l20.57"></a><span id="l20.57">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l20.58"></a><span id="l20.58">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l20.59"></a><span id="l20.59"> </span>
<a href="#l20.60"></a><span id="l20.60">   // enter first set of data</span>
<a href="#l20.61"></a><span id="l20.61">   calUtils.setData(event, data[0]);</span>
<a href="#l20.62"></a><span id="l20.62"> </span>
<a href="#l20.63"></a><span id="l20.63">   // save</span>
<a href="#l20.64"></a><span id="l20.64">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l20.65"></a><span id="l20.65"> </span>
<a href="#l20.66"></a><span id="l20.66">   // open, but change nothing</span>
<a href="#l20.67"></a><span id="l20.67">   let eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l20.68"></a><span id="l20.68">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l20.69"></a><span id="l20.69">     + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l20.70"></a><span id="l20.70">   controller.waitForElement(eventBox);</span>
<a href="#l20.71"></a><span id="l20.71">   controller.doubleClick(eventBox);</span>
<a href="#l20.72"></a><span id="l20.72" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l20.73"></a><span id="l20.73" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l20.74"></a><span id="l20.74">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l20.75"></a><span id="l20.75">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l20.76"></a><span id="l20.76"> </span>
<a href="#l20.77"></a><span id="l20.77">   // modal dialog setup</span>
<a href="#l20.78"></a><span id="l20.78">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l20.79"></a><span id="l20.79">   md.start(handleSavePrompt);</span>
<a href="#l20.80"></a><span id="l20.80"> </span>
<a href="#l20.81"></a><span id="l20.81">   // escape the event window, there should be no prompt to save event</span>
<a href="#l20.82"></a><span id="l20.82">   event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l20.83"></a><span id="l20.83">   controller.sleep(sleep);</span>
<a href="#l20.84"></a><span id="l20.84">   md.stop();</span>
<a href="#l20.85"></a><span id="l20.85"> </span>
<a href="#l20.86"></a><span id="l20.86">   // open</span>
<a href="#l20.87"></a><span id="l20.87">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l20.88"></a><span id="l20.88">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l20.89"></a><span id="l20.89">     + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}'));</span>
<a href="#l20.90"></a><span id="l20.90" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l20.91"></a><span id="l20.91" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l20.92"></a><span id="l20.92">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l20.93"></a><span id="l20.93">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l20.94"></a><span id="l20.94"> </span>
<a href="#l20.95"></a><span id="l20.95">   // change all values</span>
<a href="#l20.96"></a><span id="l20.96">   calUtils.setData(event, data[1]);</span>
<a href="#l20.97"></a><span id="l20.97"> </span>
<a href="#l20.98"></a><span id="l20.98">   // edit all values back to original</span>
<a href="#l20.99"></a><span id="l20.99">   calUtils.setData(event, data[0]);</span>
<a href="#l20.100"></a><span id="l20.100" class="difflineat">@@ -103,29 +103,29 @@ var testEventDialogModificationPrompt = </span>
<a href="#l20.101"></a><span id="l20.101">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l20.102"></a><span id="l20.102">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document,</span>
<a href="#l20.103"></a><span id="l20.103">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)));</span>
<a href="#l20.104"></a><span id="l20.104"> </span>
<a href="#l20.105"></a><span id="l20.105">   for (let i = 0; i &lt; newlines.length; i++) {</span>
<a href="#l20.106"></a><span id="l20.106">     // test set i</span>
<a href="#l20.107"></a><span id="l20.107">     controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l20.108"></a><span id="l20.108">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, 8)), 1, 1);</span>
<a href="#l20.109"></a><span id="l20.109" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l20.110"></a><span id="l20.110" class="difflineplus">+    controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l20.111"></a><span id="l20.111">     event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l20.112"></a><span id="l20.112">       .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l20.113"></a><span id="l20.113">     calUtils.setData(event, newlines[i]);</span>
<a href="#l20.114"></a><span id="l20.114">     event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l20.115"></a><span id="l20.115"> </span>
<a href="#l20.116"></a><span id="l20.116">     // open and close</span>
<a href="#l20.117"></a><span id="l20.117">     eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l20.118"></a><span id="l20.118">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l20.119"></a><span id="l20.119">       + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l20.120"></a><span id="l20.120">     controller.waitForElement(eventBox);</span>
<a href="#l20.121"></a><span id="l20.121">     controller.doubleClick(eventBox);</span>
<a href="#l20.122"></a><span id="l20.122" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l20.123"></a><span id="l20.123" class="difflineplus">+    controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l20.124"></a><span id="l20.124">     event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l20.125"></a><span id="l20.125">       .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l20.126"></a><span id="l20.126">     md = new modalDialog.modalDialog(event.window);</span>
<a href="#l20.127"></a><span id="l20.127">     md.start(handleSavePrompt);</span>
<a href="#l20.128"></a><span id="l20.128">     event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l20.129"></a><span id="l20.129">     controller.sleep(sleep);</span>
<a href="#l20.130"></a><span id="l20.130">     md.stop();</span>
<a href="#l20.131"></a><span id="l20.131"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -19,17 +19,17 @@ var setupModule = function(module) {</span>
<a href="#l21.4"></a><span id="l21.4"> var testWeeklyNRecurrence = function() {</span>
<a href="#l21.5"></a><span id="l21.5">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l21.6"></a><span id="l21.6">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l21.7"></a><span id="l21.7">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9">   // create weekly recurring event</span>
<a href="#l21.10"></a><span id="l21.10">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l21.11"></a><span id="l21.11">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l21.14"></a><span id="l21.14">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l21.17"></a><span id="l21.17">   md.start(setRecurrence);</span>
<a href="#l21.18"></a><span id="l21.18">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l21.19"></a><span id="l21.19">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l21.20"></a><span id="l21.20"> </span>
<a href="#l21.21"></a><span id="l21.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineat">@@ -106,17 +106,17 @@ function setRecurrence(recurrence){</span>
<a href="#l21.23"></a><span id="l21.23">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + sat + '&quot;}'));</span>
<a href="#l21.24"></a><span id="l21.24"> </span>
<a href="#l21.25"></a><span id="l21.25">   // set number of occurrences</span>
<a href="#l21.26"></a><span id="l21.26">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-for&quot;));</span>
<a href="#l21.27"></a><span id="l21.27">   let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l21.28"></a><span id="l21.28">     + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-count-box&quot;)/id(&quot;repeat-ntimes-count&quot;)/'</span>
<a href="#l21.29"></a><span id="l21.29">     + 'anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l21.30"></a><span id="l21.30">   // replace previous number</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineminus">-  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, {ctrlKey: true});</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l21.33"></a><span id="l21.33">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), &quot;4&quot;);</span>
<a href="#l21.34"></a><span id="l21.34"> </span>
<a href="#l21.35"></a><span id="l21.35">   // close dialog</span>
<a href="#l21.36"></a><span id="l21.36">   recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l21.37"></a><span id="l21.37">     + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l21.38"></a><span id="l21.38"> }</span>
<a href="#l21.39"></a><span id="l21.39"> </span>
<a href="#l21.40"></a><span id="l21.40"> function checkMultiWeekView(view){</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -21,26 +21,26 @@ var setupModule = function(module) {</span>
<a href="#l22.4"></a><span id="l22.4"> var testWeeklyUntilRecurrence = function() {</span>
<a href="#l22.5"></a><span id="l22.5">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l22.6"></a><span id="l22.6">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l22.7"></a><span id="l22.7">   calUtils.goToDate(controller, 2009, 1, 5); // Monday</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9">   // create weekly recurring event</span>
<a href="#l22.10"></a><span id="l22.10">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l22.11"></a><span id="l22.11">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l22.14"></a><span id="l22.14">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l22.17"></a><span id="l22.17">   md.start(setRecurrence);</span>
<a href="#l22.18"></a><span id="l22.18">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l22.19"></a><span id="l22.19">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l22.20"></a><span id="l22.20"> </span>
<a href="#l22.21"></a><span id="l22.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l22.24"></a><span id="l22.24"> </span>
<a href="#l22.25"></a><span id="l22.25">   let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l22.26"></a><span id="l22.26">     + eventPath;</span>
<a href="#l22.27"></a><span id="l22.27"> </span>
<a href="#l22.28"></a><span id="l22.28">   // check day view</span>
<a href="#l22.29"></a><span id="l22.29">   for (let week = 0; week &lt; 3; week++){</span>
<a href="#l22.30"></a><span id="l22.30">     // Monday</span>
<a href="#l22.31"></a><span id="l22.31">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineat">@@ -131,17 +131,17 @@ function setRecurrence(recurrence){</span>
<a href="#l22.33"></a><span id="l22.33"> </span>
<a href="#l22.34"></a><span id="l22.34">   // set until date</span>
<a href="#l22.35"></a><span id="l22.35">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-until&quot;));</span>
<a href="#l22.36"></a><span id="l22.36">   let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l22.37"></a><span id="l22.37">     + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/'</span>
<a href="#l22.38"></a><span id="l22.38">     + 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/'</span>
<a href="#l22.39"></a><span id="l22.39">     + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l22.40"></a><span id="l22.40">   // delete previous date</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineminus">-  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, {ctrlKey: true});</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineplus">+  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l22.43"></a><span id="l22.43">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;VK_DELETE&quot;, {});</span>
<a href="#l22.44"></a><span id="l22.44"> </span>
<a href="#l22.45"></a><span id="l22.45">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l22.46"></a><span id="l22.46">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l22.47"></a><span id="l22.47">   let endDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l22.48"></a><span id="l22.48">                                              endDate.getFullYear(), endDate.getMonth() + 1, endDate.getDate());</span>
<a href="#l22.49"></a><span id="l22.49">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), endDateString);</span>
<a href="#l22.50"></a><span id="l22.50"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -20,77 +20,77 @@ var setupModule = function(module) {</span>
<a href="#l23.4"></a><span id="l23.4"> var testWeeklyWithExceptionRecurrence = function() {</span>
<a href="#l23.5"></a><span id="l23.5">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l23.6"></a><span id="l23.6">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l23.7"></a><span id="l23.7">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9">   // create weekly recurring event</span>
<a href="#l23.10"></a><span id="l23.10">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l23.11"></a><span id="l23.11">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l23.14"></a><span id="l23.14">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l23.15"></a><span id="l23.15"> </span>
<a href="#l23.16"></a><span id="l23.16">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l23.17"></a><span id="l23.17">   md.start(setRecurrence);</span>
<a href="#l23.18"></a><span id="l23.18">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l23.19"></a><span id="l23.19">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l23.20"></a><span id="l23.20"> </span>
<a href="#l23.21"></a><span id="l23.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l23.24"></a><span id="l23.24"> </span>
<a href="#l23.25"></a><span id="l23.25">   // move 5th January occurrence to 6th January</span>
<a href="#l23.26"></a><span id="l23.26">   calUtils.handleOccurrenceModification(controller, false);</span>
<a href="#l23.27"></a><span id="l23.27">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l23.28"></a><span id="l23.28">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l23.29"></a><span id="l23.29">       + eventPath));</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l23.32"></a><span id="l23.32">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l23.33"></a><span id="l23.33">   event.sleep(sleep);</span>
<a href="#l23.34"></a><span id="l23.34"> </span>
<a href="#l23.35"></a><span id="l23.35">   let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l23.36"></a><span id="l23.36">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/'</span>
<a href="#l23.37"></a><span id="l23.37">     + 'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l23.38"></a><span id="l23.38">     + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l23.39"></a><span id="l23.39">     + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l23.40"></a><span id="l23.40">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l23.41"></a><span id="l23.41">   let endDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l23.42"></a><span id="l23.42">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-enddate-row&quot;)/[1]/'</span>
<a href="#l23.43"></a><span id="l23.43">     + 'id(&quot;event-grid-enddate-picker-box&quot;)/id(&quot;event-endtime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l23.44"></a><span id="l23.44">     + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l23.45"></a><span id="l23.45">     + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l23.46"></a><span id="l23.46">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l23.47"></a><span id="l23.47"> </span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-  event.keypress(startDateInput, &quot;a&quot;, {ctrlKey: true});</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineplus">+  event.keypress(startDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l23.50"></a><span id="l23.50">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l23.51"></a><span id="l23.51">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l23.52"></a><span id="l23.52">   let startDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l23.53"></a><span id="l23.53">                                              startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());</span>
<a href="#l23.54"></a><span id="l23.54">   event.type(startDateInput, startDateString);</span>
<a href="#l23.55"></a><span id="l23.55">   // applies startdate change</span>
<a href="#l23.56"></a><span id="l23.56">   event.click(endDateInput);</span>
<a href="#l23.57"></a><span id="l23.57"> </span>
<a href="#l23.58"></a><span id="l23.58">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l23.61"></a><span id="l23.61"> </span>
<a href="#l23.62"></a><span id="l23.62">   // change recurrence rule</span>
<a href="#l23.63"></a><span id="l23.63">   calUtils.goToDate(controller, 2009, 1, 7);</span>
<a href="#l23.64"></a><span id="l23.64">   calUtils.handleParentModification(controller, false);</span>
<a href="#l23.65"></a><span id="l23.65">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l23.66"></a><span id="l23.66">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l23.67"></a><span id="l23.67">       + eventPath));</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l23.70"></a><span id="l23.70">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l23.71"></a><span id="l23.71"> </span>
<a href="#l23.72"></a><span id="l23.72">   md = new modalDialog.modalDialog(event.window);</span>
<a href="#l23.73"></a><span id="l23.73">   md.start(changeRecurrence);</span>
<a href="#l23.74"></a><span id="l23.74">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l23.75"></a><span id="l23.75">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l23.76"></a><span id="l23.76"> </span>
<a href="#l23.77"></a><span id="l23.77">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l23.79"></a><span id="l23.79" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l23.80"></a><span id="l23.80"> </span>
<a href="#l23.81"></a><span id="l23.81">   // check two weeks</span>
<a href="#l23.82"></a><span id="l23.82">   // day view</span>
<a href="#l23.83"></a><span id="l23.83">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l23.84"></a><span id="l23.84">   let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l23.85"></a><span id="l23.85">     + eventPath;</span>
<a href="#l23.86"></a><span id="l23.86"> </span>
<a href="#l23.87"></a><span id="l23.87">   calUtils.goToDate(controller, 2009, 1, 5);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -26,17 +26,17 @@ var testWeeklyNRecurrence = function() {</span>
<a href="#l24.4"></a><span id="l24.4">   controller.waitFor(function() {</span>
<a href="#l24.5"></a><span id="l24.5">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l24.6"></a><span id="l24.6">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l24.7"></a><span id="l24.7">   });</span>
<a href="#l24.8"></a><span id="l24.8"> </span>
<a href="#l24.9"></a><span id="l24.9">   // create weekly recurring event</span>
<a href="#l24.10"></a><span id="l24.10">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l24.11"></a><span id="l24.11">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l24.14"></a><span id="l24.14">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l24.15"></a><span id="l24.15"> </span>
<a href="#l24.16"></a><span id="l24.16">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l24.17"></a><span id="l24.17">   md.start(setRecurrence);</span>
<a href="#l24.18"></a><span id="l24.18">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l24.19"></a><span id="l24.19">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l24.20"></a><span id="l24.20"> </span>
<a href="#l24.21"></a><span id="l24.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineat">@@ -121,17 +121,17 @@ function setRecurrence(recurrence){</span>
<a href="#l24.23"></a><span id="l24.23">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + sat + '&quot;}'));</span>
<a href="#l24.24"></a><span id="l24.24"> </span>
<a href="#l24.25"></a><span id="l24.25">   // set number of occurrences</span>
<a href="#l24.26"></a><span id="l24.26">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-for&quot;));</span>
<a href="#l24.27"></a><span id="l24.27">   let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l24.28"></a><span id="l24.28">     + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-count-box&quot;)/id(&quot;repeat-ntimes-count&quot;)/'</span>
<a href="#l24.29"></a><span id="l24.29">     + 'anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l24.30"></a><span id="l24.30">   // replace previous number</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, {ctrlKey: true});</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l24.33"></a><span id="l24.33">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), &quot;4&quot;);</span>
<a href="#l24.34"></a><span id="l24.34"> </span>
<a href="#l24.35"></a><span id="l24.35">   // close dialog</span>
<a href="#l24.36"></a><span id="l24.36">   recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l24.37"></a><span id="l24.37">     + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l24.38"></a><span id="l24.38"> }</span>
<a href="#l24.39"></a><span id="l24.39"> </span>
<a href="#l24.40"></a><span id="l24.40"> function checkMultiWeekView(view){</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -27,26 +27,26 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l25.4"></a><span id="l25.4">   controller.waitFor(function() {</span>
<a href="#l25.5"></a><span id="l25.5">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l25.6"></a><span id="l25.6">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l25.7"></a><span id="l25.7">   });</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9">   // create weekly recurring event</span>
<a href="#l25.10"></a><span id="l25.10">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l25.11"></a><span id="l25.11">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l25.14"></a><span id="l25.14">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l25.17"></a><span id="l25.17">   md.start(setRecurrence);</span>
<a href="#l25.18"></a><span id="l25.18">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l25.19"></a><span id="l25.19">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l25.20"></a><span id="l25.20"> </span>
<a href="#l25.21"></a><span id="l25.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l25.24"></a><span id="l25.24"> </span>
<a href="#l25.25"></a><span id="l25.25">   let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l25.26"></a><span id="l25.26">     + eventPath;</span>
<a href="#l25.27"></a><span id="l25.27"> </span>
<a href="#l25.28"></a><span id="l25.28">   // check day view</span>
<a href="#l25.29"></a><span id="l25.29">   for (let week = 0; week &lt; 3; week++){</span>
<a href="#l25.30"></a><span id="l25.30">     // Monday</span>
<a href="#l25.31"></a><span id="l25.31">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineat">@@ -145,17 +145,17 @@ function setRecurrence(recurrence){</span>
<a href="#l25.33"></a><span id="l25.33"> </span>
<a href="#l25.34"></a><span id="l25.34">   // set until date</span>
<a href="#l25.35"></a><span id="l25.35">   recurrence.click(new elementslib.ID(recurrence.window.document, &quot;recurrence-range-until&quot;));</span>
<a href="#l25.36"></a><span id="l25.36">   let input = '/id(&quot;calendar-event-dialog-recurrence&quot;)/id(&quot;recurrence-range-groupbox&quot;)/[1]/'</span>
<a href="#l25.37"></a><span id="l25.37">     + 'id(&quot;recurrence-duration&quot;)/id(&quot;recurrence-range-until-box&quot;)/id(&quot;repeat-until-date&quot;)/'</span>
<a href="#l25.38"></a><span id="l25.38">     + 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/'</span>
<a href="#l25.39"></a><span id="l25.39">     + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l25.40"></a><span id="l25.40">   // delete previous date</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineminus">-  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, {ctrlKey: true});</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineplus">+  recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l25.43"></a><span id="l25.43">   recurrence.keypress(new elementslib.Lookup(recurrence.window.document, input), &quot;VK_DELETE&quot;, {});</span>
<a href="#l25.44"></a><span id="l25.44"> </span>
<a href="#l25.45"></a><span id="l25.45">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l25.46"></a><span id="l25.46">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l25.47"></a><span id="l25.47">   let endDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l25.48"></a><span id="l25.48">                                              endDate.getFullYear(), endDate.getMonth() + 1, endDate.getDate());</span>
<a href="#l25.49"></a><span id="l25.49"> </span>
<a href="#l25.50"></a><span id="l25.50">   recurrence.type(new elementslib.Lookup(recurrence.window.document, input), endDateString);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -27,76 +27,76 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l26.4"></a><span id="l26.4">   controller.waitFor(function() {</span>
<a href="#l26.5"></a><span id="l26.5">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l26.6"></a><span id="l26.6">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l26.7"></a><span id="l26.7">   });</span>
<a href="#l26.8"></a><span id="l26.8"> </span>
<a href="#l26.9"></a><span id="l26.9">   // create weekly recurring event</span>
<a href="#l26.10"></a><span id="l26.10">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l26.11"></a><span id="l26.11">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l26.14"></a><span id="l26.14">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l26.17"></a><span id="l26.17">   md.start(setRecurrence);</span>
<a href="#l26.18"></a><span id="l26.18">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l26.19"></a><span id="l26.19">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l26.20"></a><span id="l26.20"> </span>
<a href="#l26.21"></a><span id="l26.21">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l26.22"></a><span id="l26.22"> </span>
<a href="#l26.23"></a><span id="l26.23">   // move 5th January occurrence to 6th January</span>
<a href="#l26.24"></a><span id="l26.24">   calUtils.handleOccurrenceModification(controller, false);</span>
<a href="#l26.25"></a><span id="l26.25">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l26.26"></a><span id="l26.26">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l26.27"></a><span id="l26.27">       + eventPath));</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l26.30"></a><span id="l26.30">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l26.31"></a><span id="l26.31">   event.sleep(sleep);</span>
<a href="#l26.32"></a><span id="l26.32"> </span>
<a href="#l26.33"></a><span id="l26.33">   let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l26.34"></a><span id="l26.34">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/'</span>
<a href="#l26.35"></a><span id="l26.35">     + 'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l26.36"></a><span id="l26.36">     + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l26.37"></a><span id="l26.37">     + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l26.38"></a><span id="l26.38">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l26.39"></a><span id="l26.39">   let endDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l26.40"></a><span id="l26.40">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-enddate-row&quot;)/[1]/'</span>
<a href="#l26.41"></a><span id="l26.41">     + 'id(&quot;event-grid-enddate-picker-box&quot;)/id(&quot;event-endtime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l26.42"></a><span id="l26.42">     + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l26.43"></a><span id="l26.43">     + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l26.44"></a><span id="l26.44">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l26.45"></a><span id="l26.45"> </span>
<a href="#l26.46"></a><span id="l26.46" class="difflineminus">-  event.keypress(startDateInput, &quot;a&quot;, {ctrlKey: true});</span>
<a href="#l26.47"></a><span id="l26.47" class="difflineplus">+  event.keypress(startDateInput, &quot;a&quot;, { ctrlKey: true });</span>
<a href="#l26.48"></a><span id="l26.48">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l26.49"></a><span id="l26.49">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l26.50"></a><span id="l26.50">   let startDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l26.51"></a><span id="l26.51">                                              startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());</span>
<a href="#l26.52"></a><span id="l26.52">   event.type(startDateInput, startDateString);</span>
<a href="#l26.53"></a><span id="l26.53">   // applies startdate change</span>
<a href="#l26.54"></a><span id="l26.54">   event.click(endDateInput);</span>
<a href="#l26.55"></a><span id="l26.55"> </span>
<a href="#l26.56"></a><span id="l26.56">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l26.58"></a><span id="l26.58" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l26.59"></a><span id="l26.59"> </span>
<a href="#l26.60"></a><span id="l26.60">   // change recurrence rule</span>
<a href="#l26.61"></a><span id="l26.61">   calUtils.goToDate(controller, 2009, 1, 7);</span>
<a href="#l26.62"></a><span id="l26.62">   calUtils.handleParentModification(controller, false);</span>
<a href="#l26.63"></a><span id="l26.63">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l26.64"></a><span id="l26.64">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l26.65"></a><span id="l26.65">       + eventPath));</span>
<a href="#l26.66"></a><span id="l26.66" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l26.67"></a><span id="l26.67" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l26.68"></a><span id="l26.68">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l26.69"></a><span id="l26.69"> </span>
<a href="#l26.70"></a><span id="l26.70">   md = new modalDialog.modalDialog(event.window);</span>
<a href="#l26.71"></a><span id="l26.71">   md.start(changeRecurrence);</span>
<a href="#l26.72"></a><span id="l26.72">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l26.73"></a><span id="l26.73">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l26.74"></a><span id="l26.74"> </span>
<a href="#l26.75"></a><span id="l26.75">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l26.76"></a><span id="l26.76" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l26.77"></a><span id="l26.77" class="difflineplus">+  controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l26.78"></a><span id="l26.78"> </span>
<a href="#l26.79"></a><span id="l26.79">   // check two weeks</span>
<a href="#l26.80"></a><span id="l26.80">   // day view</span>
<a href="#l26.81"></a><span id="l26.81">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l26.82"></a><span id="l26.82">   let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l26.83"></a><span id="l26.83">     + eventPath;</span>
<a href="#l26.84"></a><span id="l26.84"> </span>
<a href="#l26.85"></a><span id="l26.85">   calUtils.goToDate(controller, 2009, 1, 5);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -430,34 +430,34 @@ function setData(controller, data) {</span>
<a href="#l27.4"></a><span id="l27.4">   controller.sleep(sleep);</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6">   // title</span>
<a href="#l27.7"></a><span id="l27.7">   if (data.title != undefined) {</span>
<a href="#l27.8"></a><span id="l27.8">     if (!mac) {</span>
<a href="#l27.9"></a><span id="l27.9">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.10"></a><span id="l27.10">         + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l27.11"></a><span id="l27.11">         + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-        'a', {ctrlKey: true});</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+        'a', { ctrlKey: true });</span>
<a href="#l27.14"></a><span id="l27.14">       controller.type(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.15"></a><span id="l27.15">         + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l27.16"></a><span id="l27.16">         + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l27.17"></a><span id="l27.17">         data.title);</span>
<a href="#l27.18"></a><span id="l27.18">     } else {</span>
<a href="#l27.19"></a><span id="l27.19">       let titleField = new elementslib.ID(controller.window.document, &quot;item-title&quot;);</span>
<a href="#l27.20"></a><span id="l27.20">       titleField.getNode().value = data.title;</span>
<a href="#l27.21"></a><span id="l27.21">     }</span>
<a href="#l27.22"></a><span id="l27.22">   }</span>
<a href="#l27.23"></a><span id="l27.23"> </span>
<a href="#l27.24"></a><span id="l27.24">   // location</span>
<a href="#l27.25"></a><span id="l27.25">   if (data.location != undefined) {</span>
<a href="#l27.26"></a><span id="l27.26">     if (!mac) {</span>
<a href="#l27.27"></a><span id="l27.27">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.28"></a><span id="l27.28">         + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l27.29"></a><span id="l27.29">         + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineminus">-        'a', {ctrlKey: true});</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineplus">+        'a', { ctrlKey: true });</span>
<a href="#l27.32"></a><span id="l27.32">       controller.type(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.33"></a><span id="l27.33">         + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l27.34"></a><span id="l27.34">         + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l27.35"></a><span id="l27.35">         data.location);</span>
<a href="#l27.36"></a><span id="l27.36">     } else {</span>
<a href="#l27.37"></a><span id="l27.37">       let locationField = new elementslib.ID(controller.window.document, &quot;item-location&quot;);</span>
<a href="#l27.38"></a><span id="l27.38">       locationField.getNode().value = data.location;</span>
<a href="#l27.39"></a><span id="l27.39">     }</span>
<a href="#l27.40"></a><span id="l27.40" class="difflineat">@@ -485,57 +485,57 @@ function setData(controller, data) {</span>
<a href="#l27.41"></a><span id="l27.41">   // startdate</span>
<a href="#l27.42"></a><span id="l27.42">   if (data.startdate != undefined &amp;&amp; data.startdate.constructor.name == 'Date') {</span>
<a href="#l27.43"></a><span id="l27.43">     let startdate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l27.44"></a><span id="l27.44">       data.startdate.getFullYear(), data.startdate.getMonth() + 1, data.startdate.getDate());</span>
<a href="#l27.45"></a><span id="l27.45">     if (!isEvent) {</span>
<a href="#l27.46"></a><span id="l27.46">       controller.check(new elementslib.ID(controller.window.document, &quot;todo-has-entrydate&quot;), true);</span>
<a href="#l27.47"></a><span id="l27.47">     }</span>
<a href="#l27.48"></a><span id="l27.48">     if (!mac) {</span>
<a href="#l27.49"></a><span id="l27.49" class="difflineminus">-      controller.keypress(startDateInput, 'a', {ctrlKey: true});</span>
<a href="#l27.50"></a><span id="l27.50" class="difflineplus">+      controller.keypress(startDateInput, 'a', { ctrlKey: true });</span>
<a href="#l27.51"></a><span id="l27.51">       controller.type(startDateInput, startdate);</span>
<a href="#l27.52"></a><span id="l27.52">     } else {</span>
<a href="#l27.53"></a><span id="l27.53">       startDateInput.getNode().value = startdate;</span>
<a href="#l27.54"></a><span id="l27.54">     }</span>
<a href="#l27.55"></a><span id="l27.55">   }</span>
<a href="#l27.56"></a><span id="l27.56"> </span>
<a href="#l27.57"></a><span id="l27.57">   // starttime</span>
<a href="#l27.58"></a><span id="l27.58">   if (data.starttime != undefined &amp;&amp; data.starttime.constructor.name == 'Date') {</span>
<a href="#l27.59"></a><span id="l27.59">     let starttime = dateService.FormatTime(&quot;&quot;, dateService.timeFormatNoSeconds,</span>
<a href="#l27.60"></a><span id="l27.60">       data.starttime.getHours(), data.starttime.getMinutes(), 0);</span>
<a href="#l27.61"></a><span id="l27.61">     if (!mac) {</span>
<a href="#l27.62"></a><span id="l27.62" class="difflineminus">-      controller.keypress(startTimeInput, 'a', {ctrlKey: true});</span>
<a href="#l27.63"></a><span id="l27.63" class="difflineplus">+      controller.keypress(startTimeInput, 'a', { ctrlKey: true });</span>
<a href="#l27.64"></a><span id="l27.64">       controller.type(startTimeInput, starttime);</span>
<a href="#l27.65"></a><span id="l27.65">     } else {</span>
<a href="#l27.66"></a><span id="l27.66">       startTimeInput.getNode().value = starttime;</span>
<a href="#l27.67"></a><span id="l27.67">       controller.sleep(sleep);</span>
<a href="#l27.68"></a><span id="l27.68">     }</span>
<a href="#l27.69"></a><span id="l27.69">   }</span>
<a href="#l27.70"></a><span id="l27.70"> </span>
<a href="#l27.71"></a><span id="l27.71">   // enddate</span>
<a href="#l27.72"></a><span id="l27.72">   if (data.enddate != undefined &amp;&amp; data.enddate.constructor.name == 'Date') {</span>
<a href="#l27.73"></a><span id="l27.73">     let enddate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l27.74"></a><span id="l27.74">       data.enddate.getFullYear(), data.enddate.getMonth() + 1, data.enddate.getDate());</span>
<a href="#l27.75"></a><span id="l27.75">     if (!isEvent) {</span>
<a href="#l27.76"></a><span id="l27.76">       controller.check(new elementslib.ID(controller.window.document, &quot;todo-has-duedate&quot;), true);</span>
<a href="#l27.77"></a><span id="l27.77">     }</span>
<a href="#l27.78"></a><span id="l27.78">     if (!mac) {</span>
<a href="#l27.79"></a><span id="l27.79" class="difflineminus">-      controller.keypress(endDateInput, 'a', {ctrlKey: true});</span>
<a href="#l27.80"></a><span id="l27.80" class="difflineplus">+      controller.keypress(endDateInput, 'a', { ctrlKey: true });</span>
<a href="#l27.81"></a><span id="l27.81">       controller.type(endDateInput, enddate);</span>
<a href="#l27.82"></a><span id="l27.82">     } else {</span>
<a href="#l27.83"></a><span id="l27.83">       endDateInput.getNode().value = enddate;</span>
<a href="#l27.84"></a><span id="l27.84">     }</span>
<a href="#l27.85"></a><span id="l27.85">   }</span>
<a href="#l27.86"></a><span id="l27.86"> </span>
<a href="#l27.87"></a><span id="l27.87">   // endttime</span>
<a href="#l27.88"></a><span id="l27.88">   if (data.endtime != undefined &amp;&amp; data.endtime.constructor.name == 'Date') {</span>
<a href="#l27.89"></a><span id="l27.89">     let endtime = dateService.FormatTime(&quot;&quot;, dateService.timeFormatNoSeconds,</span>
<a href="#l27.90"></a><span id="l27.90">       data.endtime.getHours(), data.endtime.getMinutes(), 0);</span>
<a href="#l27.91"></a><span id="l27.91">     if (!mac) {</span>
<a href="#l27.92"></a><span id="l27.92" class="difflineminus">-      controller.keypress(endTimeInput, 'a', {ctrlKey: true});</span>
<a href="#l27.93"></a><span id="l27.93" class="difflineplus">+      controller.keypress(endTimeInput, 'a', { ctrlKey: true });</span>
<a href="#l27.94"></a><span id="l27.94">       controller.type(endTimeInput, endtime);</span>
<a href="#l27.95"></a><span id="l27.95">     } else {</span>
<a href="#l27.96"></a><span id="l27.96">       endTimeInput.getNode().value = endtime;</span>
<a href="#l27.97"></a><span id="l27.97">       controller.sleep(sleep);</span>
<a href="#l27.98"></a><span id="l27.98">     }</span>
<a href="#l27.99"></a><span id="l27.99">   }</span>
<a href="#l27.100"></a><span id="l27.100"> </span>
<a href="#l27.101"></a><span id="l27.101">   // recurrence</span>
<a href="#l27.102"></a><span id="l27.102" class="difflineat">@@ -550,17 +550,17 @@ function setData(controller, data) {</span>
<a href="#l27.103"></a><span id="l27.103">   }</span>
<a href="#l27.104"></a><span id="l27.104"> </span>
<a href="#l27.105"></a><span id="l27.105">   // description</span>
<a href="#l27.106"></a><span id="l27.106">   if (data.description != undefined) {</span>
<a href="#l27.107"></a><span id="l27.107">     if (!mac) {</span>
<a href="#l27.108"></a><span id="l27.108">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.109"></a><span id="l27.109">         + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l27.110"></a><span id="l27.110">         + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l27.111"></a><span id="l27.111" class="difflineminus">-        'a', {ctrlKey: true});</span>
<a href="#l27.112"></a><span id="l27.112" class="difflineplus">+        'a', { ctrlKey: true });</span>
<a href="#l27.113"></a><span id="l27.113">       controller.type(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.114"></a><span id="l27.114">         + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l27.115"></a><span id="l27.115">         + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l27.116"></a><span id="l27.116">         data.description);</span>
<a href="#l27.117"></a><span id="l27.117">     } else {</span>
<a href="#l27.118"></a><span id="l27.118">       let descField = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l27.119"></a><span id="l27.119">         + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l27.120"></a><span id="l27.120">         + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l27.121"></a><span id="l27.121" class="difflineat">@@ -594,17 +594,17 @@ function setData(controller, data) {</span>
<a href="#l27.122"></a><span id="l27.122">   // completed on</span>
<a href="#l27.123"></a><span id="l27.123">   if (data.completed != undefined &amp;&amp; data.completed.constructor.name == 'Date' &amp;&amp; !isEvent) {</span>
<a href="#l27.124"></a><span id="l27.124">     let completeddate = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l27.125"></a><span id="l27.125">       data.completed.getFullYear(), data.completed.getMonth() + 1,</span>
<a href="#l27.126"></a><span id="l27.126">       data.completed.getDate());</span>
<a href="#l27.127"></a><span id="l27.127"> </span>
<a href="#l27.128"></a><span id="l27.128">     if (currentStatus == &quot;COMPLETED&quot;) {</span>
<a href="#l27.129"></a><span id="l27.129">       if (!mac) {</span>
<a href="#l27.130"></a><span id="l27.130" class="difflineminus">-        controller.keypress(completedDateInput, 'a', {ctrlKey: true});</span>
<a href="#l27.131"></a><span id="l27.131" class="difflineplus">+        controller.keypress(completedDateInput, 'a', { ctrlKey: true });</span>
<a href="#l27.132"></a><span id="l27.132">         controller.type(completedDateInput, completeddate);</span>
<a href="#l27.133"></a><span id="l27.133">       } else {</span>
<a href="#l27.134"></a><span id="l27.134">         completedDateInput.getNode().value = completeddate;</span>
<a href="#l27.135"></a><span id="l27.135">       }</span>
<a href="#l27.136"></a><span id="l27.136">     }</span>
<a href="#l27.137"></a><span id="l27.137">   }</span>
<a href="#l27.138"></a><span id="l27.138"> </span>
<a href="#l27.139"></a><span id="l27.139">   // percent complete</span>
<a href="#l27.140"></a><span id="l27.140" class="difflineat">@@ -640,25 +640,25 @@ function setData(controller, data) {</span>
<a href="#l27.141"></a><span id="l27.141"> function open_lightning_prefs(aCallback, aParentController, collector, windowTimeout) {</span>
<a href="#l27.142"></a><span id="l27.142">   function paneLoadedChecker() {</span>
<a href="#l27.143"></a><span id="l27.143">     let pane = prefsController.window.document.getElementById(&quot;paneLightning&quot;);</span>
<a href="#l27.144"></a><span id="l27.144">     return pane.loaded;</span>
<a href="#l27.145"></a><span id="l27.145">   }</span>
<a href="#l27.146"></a><span id="l27.146"> </span>
<a href="#l27.147"></a><span id="l27.147">   let timeout = windowTimeout || 30000;</span>
<a href="#l27.148"></a><span id="l27.148">   aParentController.window.openOptionsDialog(&quot;paneLightning&quot;);</span>
<a href="#l27.149"></a><span id="l27.149" class="difflineminus">-  aParentController.waitFor(function() {return mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 1;},</span>
<a href="#l27.150"></a><span id="l27.150" class="difflineplus">+  aParentController.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 1,</span>
<a href="#l27.151"></a><span id="l27.151">                             &quot;Error opening preferences window&quot;, timeout);</span>
<a href="#l27.152"></a><span id="l27.152">   let prefsController = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Mail:Preferences&quot;)[0]);</span>
<a href="#l27.153"></a><span id="l27.153">   prefsController.waitFor(paneLoadedChecker, &quot;Timed out waiting for lightning prefpane to load.&quot;);</span>
<a href="#l27.154"></a><span id="l27.154"> </span>
<a href="#l27.155"></a><span id="l27.155">   aCallback(prefsController);</span>
<a href="#l27.156"></a><span id="l27.156"> </span>
<a href="#l27.157"></a><span id="l27.157">   prefsController.window.close();</span>
<a href="#l27.158"></a><span id="l27.158" class="difflineminus">-  aParentController.waitFor(function() {return mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 0;},</span>
<a href="#l27.159"></a><span id="l27.159" class="difflineplus">+  aParentController.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 0,</span>
<a href="#l27.160"></a><span id="l27.160">                             &quot;Error closing preferences window&quot;, timeout);</span>
<a href="#l27.161"></a><span id="l27.161"> }</span>
<a href="#l27.162"></a><span id="l27.162"> </span>
<a href="#l27.163"></a><span id="l27.163"> // Export of constants</span>
<a href="#l27.164"></a><span id="l27.164"> exports.ALLDAY = ALLDAY;</span>
<a href="#l27.165"></a><span id="l27.165"> exports.CANVAS_BOX = CANVAS_BOX;</span>
<a href="#l27.166"></a><span id="l27.166"> exports.EVENT_BOX = EVENT_BOX;</span>
<a href="#l27.167"></a><span id="l27.167"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/test/mozmill/testAlarmDefaultValue.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/test/mozmill/testAlarmDefaultValue.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -40,52 +40,52 @@ function testDefaultAlarms() {</span>
<a href="#l28.4"></a><span id="l28.4"> </span>
<a href="#l28.5"></a><span id="l28.5">   // Configure the lightning preferences</span>
<a href="#l28.6"></a><span id="l28.6">   calUtils.open_lightning_prefs(handle_pref_dialog, calendarController, collector);</span>
<a href="#l28.7"></a><span id="l28.7"> </span>
<a href="#l28.8"></a><span id="l28.8">   // Create New Event</span>
<a href="#l28.9"></a><span id="l28.9">   calendarController.click(new elementslib.ID(calendarController.window.document, &quot;newMsgButton-calendar-menuitem&quot;));</span>
<a href="#l28.10"></a><span id="l28.10"> </span>
<a href="#l28.11"></a><span id="l28.11">   // Set up the event dialog controller</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;});</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+  calendarController.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0);</span>
<a href="#l28.14"></a><span id="l28.14">   let eventController = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l28.15"></a><span id="l28.15"> </span>
<a href="#l28.16"></a><span id="l28.16">   // Check if the &quot;custom&quot; item was selected</span>
<a href="#l28.17"></a><span id="l28.17">   eventController.assertDOMProperty(new elementslib.ID(eventController.window.document, &quot;item-alarm&quot;),</span>
<a href="#l28.18"></a><span id="l28.18">                                     &quot;value&quot;,</span>
<a href="#l28.19"></a><span id="l28.19">                                     &quot;custom&quot;);</span>
<a href="#l28.20"></a><span id="l28.20">   eventController.assertDOMProperty(new elementslib.XPath(eventController.window.document,</span>
<a href="#l28.21"></a><span id="l28.21">                                       '//*[@id=&quot;reminder-details&quot;]/*[local-name()=&quot;label&quot; ' +</span>
<a href="#l28.22"></a><span id="l28.22">                                       'and (not(@hidden) or @hidden=&quot;false&quot;)]'),</span>
<a href="#l28.23"></a><span id="l28.23">                                     &quot;value&quot;,</span>
<a href="#l28.24"></a><span id="l28.24">                                     expectedEventReminder);</span>
<a href="#l28.25"></a><span id="l28.25"> </span>
<a href="#l28.26"></a><span id="l28.26">   // Close the event dialog</span>
<a href="#l28.27"></a><span id="l28.27">   eventController.window.close();</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineplus">+  calendarController.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l28.30"></a><span id="l28.30"> </span>
<a href="#l28.31"></a><span id="l28.31">   // Create New Task</span>
<a href="#l28.32"></a><span id="l28.32">   calendarController.click(new elementslib.ID(calendarController.window.document, &quot;newMsgButton-task-menuitem&quot;));</span>
<a href="#l28.33"></a><span id="l28.33"> </span>
<a href="#l28.34"></a><span id="l28.34">   // Set up the task dialog controller</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;});</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+  calendarController.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0);</span>
<a href="#l28.37"></a><span id="l28.37">   let taskController = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l28.38"></a><span id="l28.38"> </span>
<a href="#l28.39"></a><span id="l28.39">   // Check if the &quot;custom&quot; item was selected</span>
<a href="#l28.40"></a><span id="l28.40">   taskController.assertDOMProperty(new elementslib.ID(taskController.window.document, &quot;item-alarm&quot;),</span>
<a href="#l28.41"></a><span id="l28.41">                                    &quot;value&quot;,</span>
<a href="#l28.42"></a><span id="l28.42">                                    &quot;custom&quot;);</span>
<a href="#l28.43"></a><span id="l28.43">   taskController.assertDOMProperty(new elementslib.XPath(taskController.window.document,</span>
<a href="#l28.44"></a><span id="l28.44">                                      '//*[@id=&quot;reminder-details&quot;]/*[local-name()=&quot;label&quot; ' +</span>
<a href="#l28.45"></a><span id="l28.45">                                       'and (not(@hidden) or @hidden=&quot;false&quot;)]'),</span>
<a href="#l28.46"></a><span id="l28.46">                                    &quot;value&quot;,</span>
<a href="#l28.47"></a><span id="l28.47">                                    expectedTaskReminder);</span>
<a href="#l28.48"></a><span id="l28.48">   // Close the task dialog</span>
<a href="#l28.49"></a><span id="l28.49">   taskController.window.close();</span>
<a href="#l28.50"></a><span id="l28.50" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l28.51"></a><span id="l28.51" class="difflineplus">+  calendarController.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l28.52"></a><span id="l28.52"> }</span>
<a href="#l28.53"></a><span id="l28.53"> </span>
<a href="#l28.54"></a><span id="l28.54"> function handle_pref_dialog(prefsController) {</span>
<a href="#l28.55"></a><span id="l28.55">   // Click on the alarms tab</span>
<a href="#l28.56"></a><span id="l28.56">   prefsController.click(new elementslib.ID(prefsController.window.document, &quot;calPreferencesTabAlarms&quot;));</span>
<a href="#l28.57"></a><span id="l28.57"> </span>
<a href="#l28.58"></a><span id="l28.58">   // Turn on alarms for events and tasks</span>
<a href="#l28.59"></a><span id="l28.59">   prefsController.waitThenClick(new elementslib.ID(prefsController.window.document, &quot;eventdefalarm&quot;));</span>
<a href="#l28.60"></a><span id="l28.60" class="difflineat">@@ -97,19 +97,19 @@ function handle_pref_dialog(prefsControl</span>
<a href="#l28.61"></a><span id="l28.61">   prefsController.select(new elementslib.ID(prefsController.window.document, &quot;tododefalarmunit&quot;),</span>
<a href="#l28.62"></a><span id="l28.62">                          null, null, &quot;days&quot;);</span>
<a href="#l28.63"></a><span id="l28.63">   prefsController.select(new elementslib.ID(prefsController.window.document, &quot;eventdefalarmunit&quot;),</span>
<a href="#l28.64"></a><span id="l28.64">                          null, null, &quot;days&quot;);</span>
<a href="#l28.65"></a><span id="l28.65"> </span>
<a href="#l28.66"></a><span id="l28.66">   // Sets default alarm length for events to &quot;50&quot;</span>
<a href="#l28.67"></a><span id="l28.67">   let eventdefalarmlen = new elementslib.ID(prefsController.window.document, &quot;eventdefalarmlen&quot;);</span>
<a href="#l28.68"></a><span id="l28.68">   let tododefalarmlen = new elementslib.ID(prefsController.window.document, &quot;tododefalarmlen&quot;);</span>
<a href="#l28.69"></a><span id="l28.69" class="difflineminus">-  prefsController.keypress(eventdefalarmlen, &quot;a&quot;, {accelKey: true});</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineplus">+  prefsController.keypress(eventdefalarmlen, &quot;a&quot;, { accelKey: true });</span>
<a href="#l28.71"></a><span id="l28.71">   prefsController.type(eventdefalarmlen, &quot;50&quot;);</span>
<a href="#l28.72"></a><span id="l28.72" class="difflineminus">-  prefsController.keypress(tododefalarmlen, &quot;a&quot;, {accelKey: true});</span>
<a href="#l28.73"></a><span id="l28.73" class="difflineplus">+  prefsController.keypress(tododefalarmlen, &quot;a&quot;, { accelKey: true });</span>
<a href="#l28.74"></a><span id="l28.74">   prefsController.type(tododefalarmlen, &quot;50&quot;);</span>
<a href="#l28.75"></a><span id="l28.75"> }</span>
<a href="#l28.76"></a><span id="l28.76"> </span>
<a href="#l28.77"></a><span id="l28.77"> function teardownTest(module) {</span>
<a href="#l28.78"></a><span id="l28.78">   Services.prefs.clearUserPref(&quot;calendar.alarms.eventalarmlen&quot;);</span>
<a href="#l28.79"></a><span id="l28.79">   Services.prefs.clearUserPref(&quot;calendar.alarms.eventalarmunit&quot;);</span>
<a href="#l28.80"></a><span id="l28.80">   Services.prefs.clearUserPref(&quot;calendar.alarms.onforevents&quot;);</span>
<a href="#l28.81"></a><span id="l28.81">   Services.prefs.clearUserPref(&quot;calendar.alarms.onfortodos&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test2.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test2.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -21,31 +21,31 @@ var testTimezones2_CreateEvents = functi</span>
<a href="#l29.4"></a><span id="l29.4">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l29.5"></a><span id="l29.5">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l29.6"></a><span id="l29.6"> </span>
<a href="#l29.7"></a><span id="l29.7">   // create daily recurring events in all timezones</span>
<a href="#l29.8"></a><span id="l29.8">   let time = new Date();</span>
<a href="#l29.9"></a><span id="l29.9">   for (let i = 0; i &lt; timezones.length; i++) {</span>
<a href="#l29.10"></a><span id="l29.10">     controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l29.11"></a><span id="l29.11">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, i + 8)), 1, 1);</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0, sleep);</span>
<a href="#l29.14"></a><span id="l29.14">     let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l29.15"></a><span id="l29.15"> </span>
<a href="#l29.16"></a><span id="l29.16">     time.setHours(times[i][0]);</span>
<a href="#l29.17"></a><span id="l29.17">     time.setMinutes(times[i][1]);</span>
<a href="#l29.18"></a><span id="l29.18"> </span>
<a href="#l29.19"></a><span id="l29.19">     // set timezone</span>
<a href="#l29.20"></a><span id="l29.20">     setTimezone(event, timezones[i]);</span>
<a href="#l29.21"></a><span id="l29.21"> </span>
<a href="#l29.22"></a><span id="l29.22">     // set title and repeat</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineminus">-    calUtils.setData(event, {title: timezones[i], repeat: &quot;weekly&quot;, starttime: time});</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineplus">+    calUtils.setData(event, { title: timezones[i], repeat: &quot;weekly&quot;, starttime: time });</span>
<a href="#l29.25"></a><span id="l29.25"> </span>
<a href="#l29.26"></a><span id="l29.26">     // save</span>
<a href="#l29.27"></a><span id="l29.27">     event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+    controller.waitFor(() =&gt; mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0);</span>
<a href="#l29.30"></a><span id="l29.30">   }</span>
<a href="#l29.31"></a><span id="l29.31"> };</span>
<a href="#l29.32"></a><span id="l29.32"> </span>
<a href="#l29.33"></a><span id="l29.33"> var teardownTest = function(module) {</span>
<a href="#l29.34"></a><span id="l29.34">   timezoneUtils.switchAppTimezone(timezones[0]);</span>
<a href="#l29.35"></a><span id="l29.35"> };</span>
<a href="#l29.36"></a><span id="l29.36"> </span>
<a href="#l29.37"></a><span id="l29.37"> function setTimezone(event, timezone) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/test/unit/head_consts.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/test/unit/head_consts.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -207,28 +207,28 @@ function readJSONFile(aFile) {</span>
<a href="#l30.4"></a><span id="l30.4">   } finally {</span>
<a href="#l30.5"></a><span id="l30.5">       stream.close();</span>
<a href="#l30.6"></a><span id="l30.6">   }</span>
<a href="#l30.7"></a><span id="l30.7">   return false;</span>
<a href="#l30.8"></a><span id="l30.8"> }</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10"> function do_load_timezoneservice(callback) {</span>
<a href="#l30.11"></a><span id="l30.11">     do_test_pending();</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-    cal.getTimezoneService().startup({onResult: function() {</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+    cal.getTimezoneService().startup({ onResult: function() {</span>
<a href="#l30.14"></a><span id="l30.14">         do_test_finished();</span>
<a href="#l30.15"></a><span id="l30.15">         callback();</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineminus">-    }});</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+    } });</span>
<a href="#l30.18"></a><span id="l30.18"> }</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20"> function do_load_calmgr(callback) {</span>
<a href="#l30.21"></a><span id="l30.21">     do_test_pending();</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineminus">-    cal.getCalendarManager().startup({onResult: function() {</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineplus">+    cal.getCalendarManager().startup({ onResult: function() {</span>
<a href="#l30.24"></a><span id="l30.24">         do_test_finished();</span>
<a href="#l30.25"></a><span id="l30.25">         callback();</span>
<a href="#l30.26"></a><span id="l30.26" class="difflineminus">-    }});</span>
<a href="#l30.27"></a><span id="l30.27" class="difflineplus">+    } });</span>
<a href="#l30.28"></a><span id="l30.28"> }</span>
<a href="#l30.29"></a><span id="l30.29"> </span>
<a href="#l30.30"></a><span id="l30.30"> function do_calendar_startup(callback) {</span>
<a href="#l30.31"></a><span id="l30.31">     let obs = {</span>
<a href="#l30.32"></a><span id="l30.32">       observe: function() {</span>
<a href="#l30.33"></a><span id="l30.33">         Services.obs.removeObserver(this, &quot;calendar-startup-done&quot;);</span>
<a href="#l30.34"></a><span id="l30.34">         do_test_finished();</span>
<a href="#l30.35"></a><span id="l30.35">         do_execute_soon(callback);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/test/unit/test_bug1199942.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/test/unit/test_bug1199942.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -6,20 +6,20 @@ Components.utils.import(&quot;resource://cale</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5"> function run_test() {</span>
<a href="#l31.6"></a><span id="l31.6">     // Test the graceful handling of attendee ids for bug 1199942</span>
<a href="#l31.7"></a><span id="l31.7">     createAttendee_test();</span>
<a href="#l31.8"></a><span id="l31.8">     serializeEvent_test();</span>
<a href="#l31.9"></a><span id="l31.9"> }</span>
<a href="#l31.10"></a><span id="l31.10"> </span>
<a href="#l31.11"></a><span id="l31.11"> function createAttendee_test() {</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-    let data = [{input: &quot;mailto:user1@example.net&quot;, expected: &quot;mailto:user1@example.net&quot;},</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-                {input: &quot;MAILTO:user2@example.net&quot;, expected: &quot;mailto:user2@example.net&quot;},</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineminus">-                {input: &quot;user3@example.net&quot;, expected: &quot;mailto:user3@example.net&quot;},</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineminus">-                {input: &quot;urn:uuid:user4&quot;, expected: &quot;urn:uuid:user4&quot;}];</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineplus">+    let data = [{ input: &quot;mailto:user1@example.net&quot;, expected: &quot;mailto:user1@example.net&quot; },</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineplus">+                { input: &quot;MAILTO:user2@example.net&quot;, expected: &quot;mailto:user2@example.net&quot; },</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+                { input: &quot;user3@example.net&quot;, expected: &quot;mailto:user3@example.net&quot; },</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineplus">+                { input: &quot;urn:uuid:user4&quot;, expected: &quot;urn:uuid:user4&quot; }];</span>
<a href="#l31.20"></a><span id="l31.20">     let event = cal.createEvent();</span>
<a href="#l31.21"></a><span id="l31.21">     for (let test of data) {</span>
<a href="#l31.22"></a><span id="l31.22">         let attendee = cal.createAttendee();</span>
<a href="#l31.23"></a><span id="l31.23">         attendee.id = test.input;</span>
<a href="#l31.24"></a><span id="l31.24">         event.addAttendee(attendee);</span>
<a href="#l31.25"></a><span id="l31.25">         let readAttendee = event.getAttendeeById(cal.prependMailTo(test.input));</span>
<a href="#l31.26"></a><span id="l31.26">         equal(readAttendee.id, test.expected);</span>
<a href="#l31.27"></a><span id="l31.27">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/test/unit/test_calutils.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/test/unit/test_calutils.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -12,44 +12,44 @@ function run_test() {</span>
<a href="#l32.4"></a><span id="l32.4">     resolveDelegation_test();</span>
<a href="#l32.5"></a><span id="l32.5">     validateRecipientList_test();</span>
<a href="#l32.6"></a><span id="l32.6"> }</span>
<a href="#l32.7"></a><span id="l32.7"> </span>
<a href="#l32.8"></a><span id="l32.8"> // tests for calUtils.jsm</span>
<a href="#l32.9"></a><span id="l32.9"> </span>
<a href="#l32.10"></a><span id="l32.10"> function getAttendeeEmail_test() {</span>
<a href="#l32.11"></a><span id="l32.11">     let data = [{</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-        input: {id: &quot;mailto:first.last@example.net&quot;, cn: &quot;Last, First&quot;, email: null, useCn: true},</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+        input: { id: &quot;mailto:first.last@example.net&quot;, cn: &quot;Last, First&quot;, email: null, useCn: true },</span>
<a href="#l32.14"></a><span id="l32.14">         expected: &quot;\&quot;Last, First\&quot; &lt;first.last@example.net&gt;&quot;</span>
<a href="#l32.15"></a><span id="l32.15">     }, {</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineminus">-        input: {id: &quot;mailto:first.last@example.net&quot;, cn: &quot;Last; First&quot;, email: null, useCn: true},</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+        input: { id: &quot;mailto:first.last@example.net&quot;, cn: &quot;Last; First&quot;, email: null, useCn: true },</span>
<a href="#l32.18"></a><span id="l32.18">         expected: &quot;\&quot;Last; First\&quot; &lt;first.last@example.net&gt;&quot;</span>
<a href="#l32.19"></a><span id="l32.19">     }, {</span>
<a href="#l32.20"></a><span id="l32.20" class="difflineminus">-        input: {id: &quot;mailto:first.last@example.net&quot;, cn: &quot;First Last&quot;, email: null, useCn: true},</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineplus">+        input: { id: &quot;mailto:first.last@example.net&quot;, cn: &quot;First Last&quot;, email: null, useCn: true },</span>
<a href="#l32.22"></a><span id="l32.22">         expected: &quot;First Last &lt;first.last@example.net&gt;&quot;</span>
<a href="#l32.23"></a><span id="l32.23">     }, {</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineminus">-        input: {id: &quot;mailto:first.last@example.net&quot;, cn: &quot;Last, First&quot;, email: null, useCn: false},</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineplus">+        input: { id: &quot;mailto:first.last@example.net&quot;, cn: &quot;Last, First&quot;, email: null, useCn: false },</span>
<a href="#l32.26"></a><span id="l32.26">         expected: &quot;first.last@example.net&quot;</span>
<a href="#l32.27"></a><span id="l32.27">     }, {</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineminus">-        input: {id: &quot;mailto:first.last@example.net&quot;, cn: null, email: null, useCn: true},</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineplus">+        input: { id: &quot;mailto:first.last@example.net&quot;, cn: null, email: null, useCn: true },</span>
<a href="#l32.30"></a><span id="l32.30">         expected: &quot;first.last@example.net&quot;</span>
<a href="#l32.31"></a><span id="l32.31">     }, {</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineminus">-        input: {id: &quot;urn:uuid:first.last.example.net&quot;, cn: null, email: &quot;first.last@example.net&quot;,</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineminus">-                useCn: false},</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineplus">+        input: { id: &quot;urn:uuid:first.last.example.net&quot;, cn: null, email: &quot;first.last@example.net&quot;,</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineplus">+                useCn: false },</span>
<a href="#l32.36"></a><span id="l32.36">         expected: &quot;first.last@example.net&quot;</span>
<a href="#l32.37"></a><span id="l32.37">     }, {</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineminus">-        input: {id: &quot;urn:uuid:first.last.example.net&quot;, cn: null, email: &quot;first.last@example.net&quot;,</span>
<a href="#l32.39"></a><span id="l32.39" class="difflineminus">-                useCn: true},</span>
<a href="#l32.40"></a><span id="l32.40" class="difflineplus">+        input: { id: &quot;urn:uuid:first.last.example.net&quot;, cn: null, email: &quot;first.last@example.net&quot;,</span>
<a href="#l32.41"></a><span id="l32.41" class="difflineplus">+                useCn: true },</span>
<a href="#l32.42"></a><span id="l32.42">         expected: &quot;first.last@example.net&quot;</span>
<a href="#l32.43"></a><span id="l32.43">     }, {</span>
<a href="#l32.44"></a><span id="l32.44" class="difflineminus">-        input: {id: &quot;urn:uuid:first.last.example.net&quot;, cn: &quot;First Last&quot;, email: &quot;first.last@example.net&quot;,</span>
<a href="#l32.45"></a><span id="l32.45" class="difflineminus">-                useCn: true},</span>
<a href="#l32.46"></a><span id="l32.46" class="difflineplus">+        input: { id: &quot;urn:uuid:first.last.example.net&quot;, cn: &quot;First Last&quot;, email: &quot;first.last@example.net&quot;,</span>
<a href="#l32.47"></a><span id="l32.47" class="difflineplus">+                useCn: true },</span>
<a href="#l32.48"></a><span id="l32.48">         expected: &quot;First Last &lt;first.last@example.net&gt;&quot;</span>
<a href="#l32.49"></a><span id="l32.49">     }, {</span>
<a href="#l32.50"></a><span id="l32.50" class="difflineminus">-        input: {id: &quot;urn:uuid:first.last.example.net&quot;, cn: null, email: null, useCn: false},</span>
<a href="#l32.51"></a><span id="l32.51" class="difflineplus">+        input: { id: &quot;urn:uuid:first.last.example.net&quot;, cn: null, email: null, useCn: false },</span>
<a href="#l32.52"></a><span id="l32.52">         expected: &quot;&quot;</span>
<a href="#l32.53"></a><span id="l32.53">     }];</span>
<a href="#l32.54"></a><span id="l32.54">     let i = 0;</span>
<a href="#l32.55"></a><span id="l32.55">     for (let test of data) {</span>
<a href="#l32.56"></a><span id="l32.56">         i++;</span>
<a href="#l32.57"></a><span id="l32.57">         let attendee = cal.createAttendee();</span>
<a href="#l32.58"></a><span id="l32.58">         attendee.id = test.input.id;</span>
<a href="#l32.59"></a><span id="l32.59">         if (test.input.cn) {</span>
<a href="#l32.60"></a><span id="l32.60" class="difflineat">@@ -59,41 +59,41 @@ function getAttendeeEmail_test() {</span>
<a href="#l32.61"></a><span id="l32.61">             attendee.setProperty(&quot;EMAIL&quot;, test.input.email);</span>
<a href="#l32.62"></a><span id="l32.62">         }</span>
<a href="#l32.63"></a><span id="l32.63">         equal(cal.getAttendeeEmail(attendee, test.input.useCn), test.expected, &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l32.64"></a><span id="l32.64">     }</span>
<a href="#l32.65"></a><span id="l32.65"> }</span>
<a href="#l32.66"></a><span id="l32.66"> </span>
<a href="#l32.67"></a><span id="l32.67"> function getRecipientList_test() {</span>
<a href="#l32.68"></a><span id="l32.68">     let data = [{</span>
<a href="#l32.69"></a><span id="l32.69" class="difflineminus">-        input: [{id: &quot;mailto:first@example.net&quot;, cn: null},</span>
<a href="#l32.70"></a><span id="l32.70" class="difflineminus">-                {id: &quot;mailto:second@example.net&quot;, cn: null},</span>
<a href="#l32.71"></a><span id="l32.71" class="difflineminus">-                {id: &quot;mailto:third@example.net&quot;, cn: null}],</span>
<a href="#l32.72"></a><span id="l32.72" class="difflineplus">+        input: [{ id: &quot;mailto:first@example.net&quot;, cn: null },</span>
<a href="#l32.73"></a><span id="l32.73" class="difflineplus">+                { id: &quot;mailto:second@example.net&quot;, cn: null },</span>
<a href="#l32.74"></a><span id="l32.74" class="difflineplus">+                { id: &quot;mailto:third@example.net&quot;, cn: null }],</span>
<a href="#l32.75"></a><span id="l32.75">         expected: &quot;first@example.net, second@example.net, third@example.net&quot;</span>
<a href="#l32.76"></a><span id="l32.76">     }, {</span>
<a href="#l32.77"></a><span id="l32.77" class="difflineminus">-        input: [{id: &quot;mailto:first@example.net&quot;, cn: &quot;first example&quot;},</span>
<a href="#l32.78"></a><span id="l32.78" class="difflineminus">-                {id: &quot;mailto:second@example.net&quot;, cn: &quot;second example&quot;},</span>
<a href="#l32.79"></a><span id="l32.79" class="difflineminus">-                {id: &quot;mailto:third@example.net&quot;, cn: &quot;third example&quot;}],</span>
<a href="#l32.80"></a><span id="l32.80" class="difflineplus">+        input: [{ id: &quot;mailto:first@example.net&quot;, cn: &quot;first example&quot; },</span>
<a href="#l32.81"></a><span id="l32.81" class="difflineplus">+                { id: &quot;mailto:second@example.net&quot;, cn: &quot;second example&quot; },</span>
<a href="#l32.82"></a><span id="l32.82" class="difflineplus">+                { id: &quot;mailto:third@example.net&quot;, cn: &quot;third example&quot; }],</span>
<a href="#l32.83"></a><span id="l32.83">         expected: &quot;first example &lt;first@example.net&gt;, second example &lt;second@example.net&gt;, &quot; +</span>
<a href="#l32.84"></a><span id="l32.84">                   &quot;third example &lt;third@example.net&gt;&quot;</span>
<a href="#l32.85"></a><span id="l32.85">     }, {</span>
<a href="#l32.86"></a><span id="l32.86" class="difflineminus">-        input: [{id: &quot;mailto:first@example.net&quot;, cn: &quot;example, first&quot;},</span>
<a href="#l32.87"></a><span id="l32.87" class="difflineminus">-                {id: &quot;mailto:second@example.net&quot;, cn: &quot;example, second&quot;},</span>
<a href="#l32.88"></a><span id="l32.88" class="difflineminus">-                {id: &quot;mailto:third@example.net&quot;, cn: &quot;example, third&quot;}],</span>
<a href="#l32.89"></a><span id="l32.89" class="difflineplus">+        input: [{ id: &quot;mailto:first@example.net&quot;, cn: &quot;example, first&quot; },</span>
<a href="#l32.90"></a><span id="l32.90" class="difflineplus">+                { id: &quot;mailto:second@example.net&quot;, cn: &quot;example, second&quot; },</span>
<a href="#l32.91"></a><span id="l32.91" class="difflineplus">+                { id: &quot;mailto:third@example.net&quot;, cn: &quot;example, third&quot; }],</span>
<a href="#l32.92"></a><span id="l32.92">         expected: &quot;\&quot;example, first\&quot; &lt;first@example.net&gt;, \&quot;example, second\&quot; &lt;second@example.net&gt;, &quot; +</span>
<a href="#l32.93"></a><span id="l32.93">                   &quot;\&quot;example, third\&quot; &lt;third@example.net&gt;&quot;</span>
<a href="#l32.94"></a><span id="l32.94">     }, {</span>
<a href="#l32.95"></a><span id="l32.95" class="difflineminus">-        input: [{id: &quot;mailto:first@example.net&quot;, cn: null},</span>
<a href="#l32.96"></a><span id="l32.96" class="difflineminus">-                {id: &quot;urn:uuid:second.example.net&quot;, cn: null},</span>
<a href="#l32.97"></a><span id="l32.97" class="difflineminus">-                {id: &quot;mailto:third@example.net&quot;, cn: null}],</span>
<a href="#l32.98"></a><span id="l32.98" class="difflineplus">+        input: [{ id: &quot;mailto:first@example.net&quot;, cn: null },</span>
<a href="#l32.99"></a><span id="l32.99" class="difflineplus">+                { id: &quot;urn:uuid:second.example.net&quot;, cn: null },</span>
<a href="#l32.100"></a><span id="l32.100" class="difflineplus">+                { id: &quot;mailto:third@example.net&quot;, cn: null }],</span>
<a href="#l32.101"></a><span id="l32.101">         expected: &quot;first@example.net, third@example.net&quot;</span>
<a href="#l32.102"></a><span id="l32.102">     }, {</span>
<a href="#l32.103"></a><span id="l32.103" class="difflineminus">-        input: [{id: &quot;mailto:first@example.net&quot;, cn: &quot;first&quot;},</span>
<a href="#l32.104"></a><span id="l32.104" class="difflineminus">-                {id: &quot;urn:uuid:second.example.net&quot;, cn: &quot;second&quot;},</span>
<a href="#l32.105"></a><span id="l32.105" class="difflineminus">-                {id: &quot;mailto:third@example.net&quot;, cn: &quot;third&quot;}],</span>
<a href="#l32.106"></a><span id="l32.106" class="difflineplus">+        input: [{ id: &quot;mailto:first@example.net&quot;, cn: &quot;first&quot; },</span>
<a href="#l32.107"></a><span id="l32.107" class="difflineplus">+                { id: &quot;urn:uuid:second.example.net&quot;, cn: &quot;second&quot; },</span>
<a href="#l32.108"></a><span id="l32.108" class="difflineplus">+                { id: &quot;mailto:third@example.net&quot;, cn: &quot;third&quot; }],</span>
<a href="#l32.109"></a><span id="l32.109">         expected: &quot;first &lt;first@example.net&gt;, third &lt;third@example.net&gt;&quot;</span>
<a href="#l32.110"></a><span id="l32.110">     }];</span>
<a href="#l32.111"></a><span id="l32.111"> </span>
<a href="#l32.112"></a><span id="l32.112">     let i = 0;</span>
<a href="#l32.113"></a><span id="l32.113">     for (let test of data) {</span>
<a href="#l32.114"></a><span id="l32.114">         i++;</span>
<a href="#l32.115"></a><span id="l32.115">         let attendees = [];</span>
<a href="#l32.116"></a><span id="l32.116">         for (let att of test.input) {</span>
<a href="#l32.117"></a><span id="l32.117" class="difflineat">@@ -104,32 +104,32 @@ function getRecipientList_test() {</span>
<a href="#l32.118"></a><span id="l32.118">             }</span>
<a href="#l32.119"></a><span id="l32.119">             attendees.push(attendee);</span>
<a href="#l32.120"></a><span id="l32.120">         }</span>
<a href="#l32.121"></a><span id="l32.121">         equal(cal.getRecipientList(attendees), test.expected, &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l32.122"></a><span id="l32.122">     }</span>
<a href="#l32.123"></a><span id="l32.123"> }</span>
<a href="#l32.124"></a><span id="l32.124"> </span>
<a href="#l32.125"></a><span id="l32.125"> function prependMailTo_test() {</span>
<a href="#l32.126"></a><span id="l32.126" class="difflineminus">-    let data = [{input: &quot;mailto:first.last@example.net&quot;, expected: &quot;mailto:first.last@example.net&quot;},</span>
<a href="#l32.127"></a><span id="l32.127" class="difflineminus">-                {input: &quot;MAILTO:first.last@example.net&quot;, expected: &quot;mailto:first.last@example.net&quot;},</span>
<a href="#l32.128"></a><span id="l32.128" class="difflineminus">-                {input: &quot;first.last@example.net&quot;, expected: &quot;mailto:first.last@example.net&quot;},</span>
<a href="#l32.129"></a><span id="l32.129" class="difflineminus">-                {input: &quot;first.last.example.net&quot;, expected: &quot;first.last.example.net&quot;}];</span>
<a href="#l32.130"></a><span id="l32.130" class="difflineplus">+    let data = [{ input: &quot;mailto:first.last@example.net&quot;, expected: &quot;mailto:first.last@example.net&quot; },</span>
<a href="#l32.131"></a><span id="l32.131" class="difflineplus">+                { input: &quot;MAILTO:first.last@example.net&quot;, expected: &quot;mailto:first.last@example.net&quot; },</span>
<a href="#l32.132"></a><span id="l32.132" class="difflineplus">+                { input: &quot;first.last@example.net&quot;, expected: &quot;mailto:first.last@example.net&quot; },</span>
<a href="#l32.133"></a><span id="l32.133" class="difflineplus">+                { input: &quot;first.last.example.net&quot;, expected: &quot;first.last.example.net&quot; }];</span>
<a href="#l32.134"></a><span id="l32.134">     let i = 0;</span>
<a href="#l32.135"></a><span id="l32.135">     for (let test of data) {</span>
<a href="#l32.136"></a><span id="l32.136">         i++;</span>
<a href="#l32.137"></a><span id="l32.137">         equal(cal.prependMailTo(test.input), test.expected, &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l32.138"></a><span id="l32.138">     }</span>
<a href="#l32.139"></a><span id="l32.139"> }</span>
<a href="#l32.140"></a><span id="l32.140"> </span>
<a href="#l32.141"></a><span id="l32.141"> function removeMailTo_test() {</span>
<a href="#l32.142"></a><span id="l32.142" class="difflineminus">-    let data = [{input: &quot;mailto:first.last@example.net&quot;, expected: &quot;first.last@example.net&quot;},</span>
<a href="#l32.143"></a><span id="l32.143" class="difflineminus">-                {input: &quot;MAILTO:first.last@example.net&quot;, expected: &quot;first.last@example.net&quot;},</span>
<a href="#l32.144"></a><span id="l32.144" class="difflineminus">-                {input: &quot;first.last@example.net&quot;, expected: &quot;first.last@example.net&quot;},</span>
<a href="#l32.145"></a><span id="l32.145" class="difflineminus">-                {input: &quot;first.last.example.net&quot;, expected: &quot;first.last.example.net&quot;}];</span>
<a href="#l32.146"></a><span id="l32.146" class="difflineplus">+    let data = [{ input: &quot;mailto:first.last@example.net&quot;, expected: &quot;first.last@example.net&quot; },</span>
<a href="#l32.147"></a><span id="l32.147" class="difflineplus">+                { input: &quot;MAILTO:first.last@example.net&quot;, expected: &quot;first.last@example.net&quot; },</span>
<a href="#l32.148"></a><span id="l32.148" class="difflineplus">+                { input: &quot;first.last@example.net&quot;, expected: &quot;first.last@example.net&quot; },</span>
<a href="#l32.149"></a><span id="l32.149" class="difflineplus">+                { input: &quot;first.last.example.net&quot;, expected: &quot;first.last.example.net&quot; }];</span>
<a href="#l32.150"></a><span id="l32.150">     let i = 0;</span>
<a href="#l32.151"></a><span id="l32.151">     for (let test of data) {</span>
<a href="#l32.152"></a><span id="l32.152">         i++;</span>
<a href="#l32.153"></a><span id="l32.153">         equal(cal.removeMailTo(test.input), test.expected, &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l32.154"></a><span id="l32.154">     }</span>
<a href="#l32.155"></a><span id="l32.155"> }</span>
<a href="#l32.156"></a><span id="l32.156"> </span>
<a href="#l32.157"></a><span id="l32.157"> function resolveDelegation_test() {</span>
<a href="#l32.158"></a><span id="l32.158" class="difflineat">@@ -138,83 +138,89 @@ function resolveDelegation_test() {</span>
<a href="#l32.159"></a><span id="l32.159">             attendee:</span>
<a href="#l32.160"></a><span id="l32.160">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:at' +</span>
<a href="#l32.161"></a><span id="l32.161">                 'tendee1@example.net',</span>
<a href="#l32.162"></a><span id="l32.162">             attendees: [</span>
<a href="#l32.163"></a><span id="l32.163">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:at' +</span>
<a href="#l32.164"></a><span id="l32.164">                 'tendee1@example.net',</span>
<a href="#l32.165"></a><span id="l32.165">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee1@example.net&quot;;CN=&quot;Attendee 2&quot;:mailto:atte' +</span>
<a href="#l32.166"></a><span id="l32.166">                 'ndee2@example.net'</span>
<a href="#l32.167"></a><span id="l32.167" class="difflineminus">-            ]},</span>
<a href="#l32.168"></a><span id="l32.168" class="difflineplus">+            ]</span>
<a href="#l32.169"></a><span id="l32.169" class="difflineplus">+        },</span>
<a href="#l32.170"></a><span id="l32.170">         expected: {</span>
<a href="#l32.171"></a><span id="l32.171">             delegatees: '',</span>
<a href="#l32.172"></a><span id="l32.172">             delegators: 'Attendee 2 &lt;attendee2@example.net&gt;'</span>
<a href="#l32.173"></a><span id="l32.173">         }</span>
<a href="#l32.174"></a><span id="l32.174">     }, {</span>
<a href="#l32.175"></a><span id="l32.175">         input: {</span>
<a href="#l32.176"></a><span id="l32.176">             attendee:</span>
<a href="#l32.177"></a><span id="l32.177">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l32.178"></a><span id="l32.178">             attendees: [</span>
<a href="#l32.179"></a><span id="l32.179">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l32.180"></a><span id="l32.180">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee1@example.net&quot;:mailto:attendee2@example.net'</span>
<a href="#l32.181"></a><span id="l32.181" class="difflineminus">-            ]},</span>
<a href="#l32.182"></a><span id="l32.182" class="difflineplus">+            ]</span>
<a href="#l32.183"></a><span id="l32.183" class="difflineplus">+        },</span>
<a href="#l32.184"></a><span id="l32.184">         expected: {</span>
<a href="#l32.185"></a><span id="l32.185">             delegatees: '',</span>
<a href="#l32.186"></a><span id="l32.186">             delegators: 'attendee2@example.net'</span>
<a href="#l32.187"></a><span id="l32.187">         }</span>
<a href="#l32.188"></a><span id="l32.188">     }, {</span>
<a href="#l32.189"></a><span id="l32.189">         input: {</span>
<a href="#l32.190"></a><span id="l32.190">             attendee:</span>
<a href="#l32.191"></a><span id="l32.191">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:atte' +</span>
<a href="#l32.192"></a><span id="l32.192">                 'ndee1@example.net',</span>
<a href="#l32.193"></a><span id="l32.193">             attendees: [</span>
<a href="#l32.194"></a><span id="l32.194">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;;CN=&quot;Attendee 1&quot;:mailto:atte' +</span>
<a href="#l32.195"></a><span id="l32.195">                 'ndee1@example.net',</span>
<a href="#l32.196"></a><span id="l32.196">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee1@example.net&quot;;CN=&quot;Attendee 2&quot;:mailto:at' +</span>
<a href="#l32.197"></a><span id="l32.197">                 'tendee2@example.net'</span>
<a href="#l32.198"></a><span id="l32.198" class="difflineminus">-            ]},</span>
<a href="#l32.199"></a><span id="l32.199" class="difflineplus">+            ]</span>
<a href="#l32.200"></a><span id="l32.200" class="difflineplus">+        },</span>
<a href="#l32.201"></a><span id="l32.201">         expected: {</span>
<a href="#l32.202"></a><span id="l32.202">             delegatees: 'Attendee 2 &lt;attendee2@example.net&gt;',</span>
<a href="#l32.203"></a><span id="l32.203">             delegators: ''</span>
<a href="#l32.204"></a><span id="l32.204">         }</span>
<a href="#l32.205"></a><span id="l32.205">     }, {</span>
<a href="#l32.206"></a><span id="l32.206">         input: {</span>
<a href="#l32.207"></a><span id="l32.207">             attendee:</span>
<a href="#l32.208"></a><span id="l32.208">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l32.209"></a><span id="l32.209">             attendees: [</span>
<a href="#l32.210"></a><span id="l32.210">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee2@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l32.211"></a><span id="l32.211">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee1@example.net&quot;:mailto:attendee2@example.net'</span>
<a href="#l32.212"></a><span id="l32.212" class="difflineminus">-            ]},</span>
<a href="#l32.213"></a><span id="l32.213" class="difflineplus">+            ]</span>
<a href="#l32.214"></a><span id="l32.214" class="difflineplus">+        },</span>
<a href="#l32.215"></a><span id="l32.215">         expected: {</span>
<a href="#l32.216"></a><span id="l32.216">             delegatees: 'attendee2@example.net',</span>
<a href="#l32.217"></a><span id="l32.217">             delegators: ''</span>
<a href="#l32.218"></a><span id="l32.218">         }</span>
<a href="#l32.219"></a><span id="l32.219">     }, {</span>
<a href="#l32.220"></a><span id="l32.220">         input: {</span>
<a href="#l32.221"></a><span id="l32.221">             attendee:</span>
<a href="#l32.222"></a><span id="l32.222">                 'ATTENDEE:mailto:attendee1@example.net',</span>
<a href="#l32.223"></a><span id="l32.223">             attendees: [</span>
<a href="#l32.224"></a><span id="l32.224">                 'ATTENDEE:mailto:attendee1@example.net',</span>
<a href="#l32.225"></a><span id="l32.225">                 'ATTENDEE:mailto:attendee2@example.net'</span>
<a href="#l32.226"></a><span id="l32.226" class="difflineminus">-            ]},</span>
<a href="#l32.227"></a><span id="l32.227" class="difflineplus">+            ]</span>
<a href="#l32.228"></a><span id="l32.228" class="difflineplus">+        },</span>
<a href="#l32.229"></a><span id="l32.229">         expected: {</span>
<a href="#l32.230"></a><span id="l32.230">             delegatees: '',</span>
<a href="#l32.231"></a><span id="l32.231">             delegators: ''</span>
<a href="#l32.232"></a><span id="l32.232">         }</span>
<a href="#l32.233"></a><span id="l32.233">     }, {</span>
<a href="#l32.234"></a><span id="l32.234">         input: {</span>
<a href="#l32.235"></a><span id="l32.235">             attendee:</span>
<a href="#l32.236"></a><span id="l32.236">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;DELEGATED-TO=&quot;mailto:atte' +</span>
<a href="#l32.237"></a><span id="l32.237">                 'ndee3@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l32.238"></a><span id="l32.238">             attendees: [</span>
<a href="#l32.239"></a><span id="l32.239">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee2@example.net&quot;;DELEGATED-TO=&quot;mailto:atte' +</span>
<a href="#l32.240"></a><span id="l32.240">                 'ndee3@example.net&quot;:mailto:attendee1@example.net',</span>
<a href="#l32.241"></a><span id="l32.241">                 'ATTENDEE;DELEGATED-TO=&quot;mailto:attendee1@example.net&quot;:mailto:attendee2@example.net',</span>
<a href="#l32.242"></a><span id="l32.242">                 'ATTENDEE;DELEGATED-FROM=&quot;mailto:attendee1@example.net&quot;:mailto:attendee3@example.net'</span>
<a href="#l32.243"></a><span id="l32.243" class="difflineminus">-            ]},</span>
<a href="#l32.244"></a><span id="l32.244" class="difflineplus">+            ]</span>
<a href="#l32.245"></a><span id="l32.245" class="difflineplus">+        },</span>
<a href="#l32.246"></a><span id="l32.246">         expected: {</span>
<a href="#l32.247"></a><span id="l32.247">             delegatees: 'attendee3@example.net',</span>
<a href="#l32.248"></a><span id="l32.248">             delegators: 'attendee2@example.net'</span>
<a href="#l32.249"></a><span id="l32.249">         }</span>
<a href="#l32.250"></a><span id="l32.250">     }];</span>
<a href="#l32.251"></a><span id="l32.251">     let i = 0;</span>
<a href="#l32.252"></a><span id="l32.252">     for (let test of data) {</span>
<a href="#l32.253"></a><span id="l32.253">         i++;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/test/unit/test_extract.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/test/unit/test_extract.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -171,20 +171,21 @@ function test_overrides() {</span>
<a href="#l33.4"></a><span id="l33.4"> </span>
<a href="#l33.5"></a><span id="l33.5">     equal(endGuess.year, undefined);</span>
<a href="#l33.6"></a><span id="l33.6">     equal(endGuess.month, undefined);</span>
<a href="#l33.7"></a><span id="l33.7">     equal(endGuess.day, undefined);</span>
<a href="#l33.8"></a><span id="l33.8">     equal(endGuess.hour, undefined);</span>
<a href="#l33.9"></a><span id="l33.9">     equal(endGuess.minute, undefined);</span>
<a href="#l33.10"></a><span id="l33.10"> </span>
<a href="#l33.11"></a><span id="l33.11">     // recognize a custom &quot;tomorrow&quot; and hour.minutes pattern</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-    let overrides = {&quot;from.hour.minutes&quot;:</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-                      {&quot;add&quot;: &quot;#2:#1&quot;, &quot;remove&quot;: &quot;#1:#2&quot;},</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-                     &quot;from.tomorrow&quot;:</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-                      {&quot;add&quot;: &quot;worromot&quot;}};</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+    let overrides = {</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineplus">+        &quot;from.hour.minutes&quot;: { &quot;add&quot;: &quot;#2:#1&quot;, &quot;remove&quot;: &quot;#1:#2&quot; },</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineplus">+        &quot;from.tomorrow&quot;: { &quot;add&quot;: &quot;worromot&quot; }</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineplus">+    };</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineplus">+</span>
<a href="#l33.21"></a><span id="l33.21">     Preferences.set(&quot;calendar.patterns.override&quot;, JSON.stringify(overrides));</span>
<a href="#l33.22"></a><span id="l33.22"> </span>
<a href="#l33.23"></a><span id="l33.23">     collected = extractor.extract(title, content, date, undefined);</span>
<a href="#l33.24"></a><span id="l33.24">     guessed = extractor.guessStart(false);</span>
<a href="#l33.25"></a><span id="l33.25">     endGuess = extractor.guessEnd(guessed, true);</span>
<a href="#l33.26"></a><span id="l33.26"> </span>
<a href="#l33.27"></a><span id="l33.27">     equal(guessed.year, 2012);</span>
<a href="#l33.28"></a><span id="l33.28">     equal(guessed.month, 10);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/test/unit/test_freebusy_service.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/test/unit/test_freebusy_service.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -106,20 +106,20 @@ function test_failure() {</span>
<a href="#l34.4"></a><span id="l34.4"> }</span>
<a href="#l34.5"></a><span id="l34.5"> </span>
<a href="#l34.6"></a><span id="l34.6"> function test_cancel() {</span>
<a href="#l34.7"></a><span id="l34.7">     _clearProviders();</span>
<a href="#l34.8"></a><span id="l34.8"> </span>
<a href="#l34.9"></a><span id="l34.9">     let provider = {</span>
<a href="#l34.10"></a><span id="l34.10">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIFreeBusyProvider, Components.interfaces.calIOperation]),</span>
<a href="#l34.11"></a><span id="l34.11">         getFreeBusyIntervals: function(aCalId, aStart, aEnd, aTypes, aListener) {</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-            Services.tm.currentThread.dispatch({run: function() {</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+            Services.tm.currentThread.dispatch({ run: function() {</span>
<a href="#l34.14"></a><span id="l34.14">                 dump(&quot;Cancelling freebusy query...&quot;);</span>
<a href="#l34.15"></a><span id="l34.15">                 op.cancel();</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineminus">-            }}, Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l34.17"></a><span id="l34.17" class="difflineplus">+            } }, Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l34.18"></a><span id="l34.18"> </span>
<a href="#l34.19"></a><span id="l34.19">             // No listener call, we emulate a long running search</span>
<a href="#l34.20"></a><span id="l34.20">             // Do return the operation though</span>
<a href="#l34.21"></a><span id="l34.21">             return this;</span>
<a href="#l34.22"></a><span id="l34.22">         },</span>
<a href="#l34.23"></a><span id="l34.23"> </span>
<a href="#l34.24"></a><span id="l34.24">         isPending: true,</span>
<a href="#l34.25"></a><span id="l34.25">         cancelCalled: false,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/test/unit/test_gdata_provider.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/test/unit/test_gdata_provider.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -490,24 +490,24 @@ function getAllMeta(calendar) {</span>
<a href="#l35.4"></a><span id="l35.4"> }</span>
<a href="#l35.5"></a><span id="l35.5"> </span>
<a href="#l35.6"></a><span id="l35.6"> function run_test() {</span>
<a href="#l35.7"></a><span id="l35.7">     replaceAlertsService();</span>
<a href="#l35.8"></a><span id="l35.8"> </span>
<a href="#l35.9"></a><span id="l35.9">     // TODO: make do_calendar_startup to work with this test and replace the startup code here</span>
<a href="#l35.10"></a><span id="l35.10">     do_get_profile();</span>
<a href="#l35.11"></a><span id="l35.11">     do_test_pending();</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-    cal.getCalendarManager().startup({onResult: function() {</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+    cal.getCalendarManager().startup({ onResult: function() {</span>
<a href="#l35.14"></a><span id="l35.14">         gServer = new GDataServer(&quot;xpcshell@example.com&quot;, &quot;tasksId&quot;);</span>
<a href="#l35.15"></a><span id="l35.15">         gServer.start();</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineminus">-        cal.getTimezoneService().startup({onResult: function() {</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineplus">+        cal.getTimezoneService().startup({ onResult: function() {</span>
<a href="#l35.18"></a><span id="l35.18">             run_next_test();</span>
<a href="#l35.19"></a><span id="l35.19">             do_test_finished();</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineminus">-        }});</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineminus">-    }});</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineplus">+        } });</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineplus">+    } });</span>
<a href="#l35.24"></a><span id="l35.24"> }</span>
<a href="#l35.25"></a><span id="l35.25"> </span>
<a href="#l35.26"></a><span id="l35.26"> add_task(function* test_migrate_cache() {</span>
<a href="#l35.27"></a><span id="l35.27">     let uriString = &quot;googleapi://xpcshell/?calendar=xpcshell%40example.com&quot;;</span>
<a href="#l35.28"></a><span id="l35.28">     let uri = Services.io.newURI(uriString, null, null);</span>
<a href="#l35.29"></a><span id="l35.29">     let client = cal.getCalendarManager().createCalendar(&quot;gdata&quot;, uri);</span>
<a href="#l35.30"></a><span id="l35.30">     let unwrapped = client.wrappedJSObject;</span>
<a href="#l35.31"></a><span id="l35.31">     let migrateStorageCache = unwrapped.migrateStorageCache.bind(unwrapped);</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineat">@@ -608,70 +608,70 @@ add_task(function* test_dateToJSON() {</span>
<a href="#l35.33"></a><span id="l35.33">     let dt;</span>
<a href="#l35.34"></a><span id="l35.34"> </span>
<a href="#l35.35"></a><span id="l35.35">     // no timezone</span>
<a href="#l35.36"></a><span id="l35.36">     dt = _createDateTime(cal.floating());</span>
<a href="#l35.37"></a><span id="l35.37">     deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.38"></a><span id="l35.38"> </span>
<a href="#l35.39"></a><span id="l35.39">     // valid non-Olson tz name</span>
<a href="#l35.40"></a><span id="l35.40">     dt = _createDateTime(&quot;Eastern Standard Time&quot;);</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineminus">-    deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;America/New_York&quot;});</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineplus">+    deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;America/New_York&quot; });</span>
<a href="#l35.43"></a><span id="l35.43"> </span>
<a href="#l35.44"></a><span id="l35.44">     // valid continent/city Olson tz</span>
<a href="#l35.45"></a><span id="l35.45">     dt = _createDateTime(&quot;America/New_York&quot;);</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineminus">-    deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;America/New_York&quot;});</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineplus">+    deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;America/New_York&quot; });</span>
<a href="#l35.48"></a><span id="l35.48"> </span>
<a href="#l35.49"></a><span id="l35.49">     // valid continent/region/city Olson tz</span>
<a href="#l35.50"></a><span id="l35.50">     dt = _createDateTime(&quot;America/Argentina/Buenos_Aires&quot;);</span>
<a href="#l35.51"></a><span id="l35.51" class="difflineminus">-    deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;America/Argentina/Buenos_Aires&quot;});</span>
<a href="#l35.52"></a><span id="l35.52" class="difflineplus">+    deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;America/Argentina/Buenos_Aires&quot; });</span>
<a href="#l35.53"></a><span id="l35.53"> </span>
<a href="#l35.54"></a><span id="l35.54">     // ical.js and libical currently have slightly different timezone handling.</span>
<a href="#l35.55"></a><span id="l35.55">     if (Preferences.get(&quot;calendar.icaljs&quot;, false)) {</span>
<a href="#l35.56"></a><span id="l35.56">         // unknown but formal valid Olson tz. ical.js assumes floating</span>
<a href="#l35.57"></a><span id="l35.57">         dt = _createDateTime(&quot;Unknown/Olson/Timezone&quot;);</span>
<a href="#l35.58"></a><span id="l35.58" class="difflineminus">-        deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.59"></a><span id="l35.59" class="difflineplus">+        deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.60"></a><span id="l35.60"> </span>
<a href="#l35.61"></a><span id="l35.61">         // Etc with offset. ical.js doesn't understand third party zones and uses floating</span>
<a href="#l35.62"></a><span id="l35.62">         dt = _createDateTime(&quot;ThirdPartyZone&quot;, 5);</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineminus">-        deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.64"></a><span id="l35.64" class="difflineplus">+        deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.65"></a><span id="l35.65"> </span>
<a href="#l35.66"></a><span id="l35.66">         // Etc with zero offset. ical.js doesn't understand third party zones and uses floating</span>
<a href="#l35.67"></a><span id="l35.67">         dt = _createDateTime(&quot;ThirdPartyZone&quot;, 0);</span>
<a href="#l35.68"></a><span id="l35.68" class="difflineminus">-        deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineplus">+        deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00-00:00&quot; });</span>
<a href="#l35.70"></a><span id="l35.70">     } else {</span>
<a href="#l35.71"></a><span id="l35.71">         // This causes an assertion failure.</span>
<a href="#l35.72"></a><span id="l35.72">         if (!mozinfo.debug) {</span>
<a href="#l35.73"></a><span id="l35.73">             // unknown but formal valid Olson tz</span>
<a href="#l35.74"></a><span id="l35.74">             dt = _createDateTime(&quot;Unknown/Olson/Timezone&quot;);</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineminus">-            deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;Unknown/Olson/Timezone&quot;});</span>
<a href="#l35.76"></a><span id="l35.76" class="difflineplus">+            deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;Unknown/Olson/Timezone&quot; });</span>
<a href="#l35.77"></a><span id="l35.77">         }</span>
<a href="#l35.78"></a><span id="l35.78"> </span>
<a href="#l35.79"></a><span id="l35.79">         // Etc with offset</span>
<a href="#l35.80"></a><span id="l35.80">         dt = _createDateTime(&quot;ThirdPartyZone&quot;, 5);</span>
<a href="#l35.81"></a><span id="l35.81" class="difflineminus">-        deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;Etc/GMT-5&quot;});</span>
<a href="#l35.82"></a><span id="l35.82" class="difflineplus">+        deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;Etc/GMT-5&quot; });</span>
<a href="#l35.83"></a><span id="l35.83"> </span>
<a href="#l35.84"></a><span id="l35.84">         // Etc with zero offset</span>
<a href="#l35.85"></a><span id="l35.85">         dt = _createDateTime(&quot;ThirdPartyZone&quot;, 0);</span>
<a href="#l35.86"></a><span id="l35.86" class="difflineminus">-        deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00Z&quot;, &quot;timeZone&quot;: &quot;UTC&quot;});</span>
<a href="#l35.87"></a><span id="l35.87" class="difflineplus">+        deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00Z&quot;, &quot;timeZone&quot;: &quot;UTC&quot; });</span>
<a href="#l35.88"></a><span id="l35.88">     }</span>
<a href="#l35.89"></a><span id="l35.89"> </span>
<a href="#l35.90"></a><span id="l35.90">     // This causes an assertion failure.</span>
<a href="#l35.91"></a><span id="l35.91">     if (!mozinfo.debug) {</span>
<a href="#l35.92"></a><span id="l35.92">         // invalid non-Olson tz</span>
<a href="#l35.93"></a><span id="l35.93">         dt = _createDateTime(&quot;InvalidTimeZone&quot;);</span>
<a href="#l35.94"></a><span id="l35.94" class="difflineminus">-        notEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;InvalidTimeZone&quot;});</span>
<a href="#l35.95"></a><span id="l35.95" class="difflineplus">+        notEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;InvalidTimeZone&quot; });</span>
<a href="#l35.96"></a><span id="l35.96">     }</span>
<a href="#l35.97"></a><span id="l35.97"> </span>
<a href="#l35.98"></a><span id="l35.98">     // Zone with 0 offset but not UTC</span>
<a href="#l35.99"></a><span id="l35.99">     dt = _createDateTime(&quot;Europe/London&quot;);</span>
<a href="#l35.100"></a><span id="l35.100" class="difflineminus">-    deepEqual(dateToJSON(dt), {&quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;Europe/London&quot;});</span>
<a href="#l35.101"></a><span id="l35.101" class="difflineplus">+    deepEqual(dateToJSON(dt), { &quot;dateTime&quot;: &quot;2015-01-30T12:00:00&quot;, &quot;timeZone&quot;: &quot;Europe/London&quot; });</span>
<a href="#l35.102"></a><span id="l35.102"> </span>
<a href="#l35.103"></a><span id="l35.103">     // date only</span>
<a href="#l35.104"></a><span id="l35.104">     dt.isDate = true;</span>
<a href="#l35.105"></a><span id="l35.105" class="difflineminus">-    deepEqual(dateToJSON(dt), {&quot;date&quot;: &quot;2015-01-30&quot;});</span>
<a href="#l35.106"></a><span id="l35.106" class="difflineplus">+    deepEqual(dateToJSON(dt), { &quot;date&quot;: &quot;2015-01-30&quot; });</span>
<a href="#l35.107"></a><span id="l35.107"> });</span>
<a href="#l35.108"></a><span id="l35.108"> </span>
<a href="#l35.109"></a><span id="l35.109"> add_task(function* test_JSONToDate() {</span>
<a href="#l35.110"></a><span id="l35.110">     function convert(aEntry, aTimezone=&quot;Europe/Berlin&quot;) {</span>
<a href="#l35.111"></a><span id="l35.111">         let tzs = cal.getTimezoneService();</span>
<a href="#l35.112"></a><span id="l35.112">         let calendarTz = tzs.getTimezone(aTimezone);</span>
<a href="#l35.113"></a><span id="l35.113">         let dt = JSONToDate(aEntry, calendarTz);</span>
<a href="#l35.114"></a><span id="l35.114">         return dt ? dt.icalString + &quot; in &quot; + dt.timezone.tzid : null;</span>
<a href="#l35.115"></a><span id="l35.115" class="difflineat">@@ -690,17 +690,17 @@ add_task(function* test_JSONToDate() {</span>
<a href="#l35.116"></a><span id="l35.116">     equal(convert({ &quot;dateTime&quot;: &quot;2015-01-02T03:04:05Z&quot;, &quot;timeZone&quot;: &quot;UTC&quot; }, &quot;Africa/Accra&quot;), &quot;20150102T030405Z in UTC&quot;);</span>
<a href="#l35.117"></a><span id="l35.117">     equal(convert({ &quot;dateTime&quot;: &quot;2015-01-02T03:04:05Z&quot; }, &quot;Africa/Accra&quot;), &quot;20150102T030405 in Africa/Accra&quot;);</span>
<a href="#l35.118"></a><span id="l35.118"> </span>
<a href="#l35.119"></a><span id="l35.119">     // An America/Los_Angeles date-time viewed in Europe/Berlin</span>
<a href="#l35.120"></a><span id="l35.120">     equal(convert({ &quot;dateTime&quot;: &quot;2015-12-01T21:13:14+01:00&quot;, &quot;timeZone&quot;: &quot;America/Los_Angeles&quot; }), &quot;20151201T121314 in America/Los_Angeles&quot;);</span>
<a href="#l35.121"></a><span id="l35.121">     equal(convert({ &quot;dateTime&quot;: &quot;2015-07-01T21:13:14+02:00&quot;, &quot;timeZone&quot;: &quot;America/Los_Angeles&quot; }), &quot;20150701T121314 in America/Los_Angeles&quot;);</span>
<a href="#l35.122"></a><span id="l35.122"> </span>
<a href="#l35.123"></a><span id="l35.123">     // A timezone that is sometimes in GMT, get ready for: Europe/London!</span>
<a href="#l35.124"></a><span id="l35.124" class="difflineminus">-    equal(convert({ &quot;dateTime&quot;: &quot;2015-12-01T12:13:14Z&quot;, &quot;timeZone&quot;: &quot;Europe/London&quot;}, &quot;Europe/London&quot;), &quot;20151201T121314 in Europe/London&quot;);</span>
<a href="#l35.125"></a><span id="l35.125" class="difflineplus">+    equal(convert({ &quot;dateTime&quot;: &quot;2015-12-01T12:13:14Z&quot;, &quot;timeZone&quot;: &quot;Europe/London&quot; }, &quot;Europe/London&quot;), &quot;20151201T121314 in Europe/London&quot;);</span>
<a href="#l35.126"></a><span id="l35.126">     equal(convert({ &quot;dateTime&quot;: &quot;2015-07-01T12:13:14+01:00&quot;, &quot;timeZone&quot;: &quot;Europe/London&quot; }, &quot;Europe/London&quot;), &quot;20150701T121314 in Europe/London&quot;);</span>
<a href="#l35.127"></a><span id="l35.127"> </span>
<a href="#l35.128"></a><span id="l35.128">     // An event in Los Angeles, with a calendar set to Asia/Baku</span>
<a href="#l35.129"></a><span id="l35.129">     equal(convert({ &quot;dateTime&quot;: &quot;2015-07-01T12:13:14+05:00&quot;, &quot;timeZone&quot;: &quot;America/Los_Angeles&quot; }, &quot;Asia/Baku&quot;), &quot;20150701T001314 in America/Los_Angeles&quot;);</span>
<a href="#l35.130"></a><span id="l35.130">     equal(convert({ &quot;dateTime&quot;: &quot;2015-12-01T12:13:14+04:00&quot;, &quot;timeZone&quot;: &quot;America/Los_Angeles&quot; }, &quot;Asia/Baku&quot;), &quot;20151201T001314 in America/Los_Angeles&quot;);</span>
<a href="#l35.131"></a><span id="l35.131"> </span>
<a href="#l35.132"></a><span id="l35.132">     // An event without specified timezone, with a calendar set to Asia/Baku</span>
<a href="#l35.133"></a><span id="l35.133">     equal(convert({ &quot;dateTime&quot;: &quot;2015-07-01T12:13:14+04:00&quot; }, &quot;Asia/Baku&quot;), &quot;20150701T121314 in Asia/Baku&quot;);</span>
<a href="#l35.134"></a><span id="l35.134" class="difflineat">@@ -724,17 +724,17 @@ add_task(function* test_organizerCN() {</span>
<a href="#l35.135"></a><span id="l35.135">        &quot;etag&quot;: &quot;\&quot;2299601498276000\&quot;&quot;,</span>
<a href="#l35.136"></a><span id="l35.136">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.137"></a><span id="l35.137">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.138"></a><span id="l35.138">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.139"></a><span id="l35.139">        &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.140"></a><span id="l35.140">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.141"></a><span id="l35.141">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.142"></a><span id="l35.142">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.143"></a><span id="l35.143" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.144"></a><span id="l35.144" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.145"></a><span id="l35.145">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.146"></a><span id="l35.146">     }];</span>
<a href="#l35.147"></a><span id="l35.147">     client = yield gServer.getClient();</span>
<a href="#l35.148"></a><span id="l35.148">     equal(client.getProperty(&quot;organizerCN&quot;), gServer.creator.displayName);</span>
<a href="#l35.149"></a><span id="l35.149">     gServer.resetClient(client);</span>
<a href="#l35.150"></a><span id="l35.150"> });</span>
<a href="#l35.151"></a><span id="l35.151"> </span>
<a href="#l35.152"></a><span id="l35.152"> add_task(function* test_always_readOnly() {</span>
<a href="#l35.153"></a><span id="l35.153" class="difflineat">@@ -743,17 +743,17 @@ add_task(function* test_always_readOnly(</span>
<a href="#l35.154"></a><span id="l35.154">        &quot;etag&quot;: &quot;\&quot;2299601498276000\&quot;&quot;,</span>
<a href="#l35.155"></a><span id="l35.155">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.156"></a><span id="l35.156">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.157"></a><span id="l35.157">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.158"></a><span id="l35.158">        &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.159"></a><span id="l35.159">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.160"></a><span id="l35.160">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.161"></a><span id="l35.161">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.162"></a><span id="l35.162" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.163"></a><span id="l35.163" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.164"></a><span id="l35.164">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.165"></a><span id="l35.165">     }];</span>
<a href="#l35.166"></a><span id="l35.166">     gServer.calendarListData.accessRole = &quot;freeBusyReader&quot;;</span>
<a href="#l35.167"></a><span id="l35.167">     let client = yield gServer.getClient();</span>
<a href="#l35.168"></a><span id="l35.168">     let pclient = cal.async.promisifyCalendar(client);</span>
<a href="#l35.169"></a><span id="l35.169">     ok(client.readOnly);</span>
<a href="#l35.170"></a><span id="l35.170">     client.readOnly = false;</span>
<a href="#l35.171"></a><span id="l35.171">     ok(client.readOnly);</span>
<a href="#l35.172"></a><span id="l35.172" class="difflineat">@@ -798,29 +798,29 @@ add_task(function* test_reset_sync() {</span>
<a href="#l35.173"></a><span id="l35.173">        &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.174"></a><span id="l35.174">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.175"></a><span id="l35.175">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.176"></a><span id="l35.176">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.177"></a><span id="l35.177">        &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.178"></a><span id="l35.178">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.179"></a><span id="l35.179">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.180"></a><span id="l35.180">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.181"></a><span id="l35.181" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.182"></a><span id="l35.182" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.183"></a><span id="l35.183">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.184"></a><span id="l35.184">     }, {</span>
<a href="#l35.185"></a><span id="l35.185">        &quot;kind&quot;: &quot;calendar#event&quot;,</span>
<a href="#l35.186"></a><span id="l35.186">        &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.187"></a><span id="l35.187">        &quot;id&quot;: &quot;fepf8uf6n7n04w7feukucs9n8e&quot;,</span>
<a href="#l35.188"></a><span id="l35.188">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.189"></a><span id="l35.189">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.190"></a><span id="l35.190">        &quot;summary&quot;: &quot;New Event 2&quot;,</span>
<a href="#l35.191"></a><span id="l35.191">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.192"></a><span id="l35.192">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.193"></a><span id="l35.193">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.194"></a><span id="l35.194" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.195"></a><span id="l35.195" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.196"></a><span id="l35.196">        &quot;iCalUID&quot;: &quot;fepf8uf6n7n04w7feukucs9n8e@google.com&quot;</span>
<a href="#l35.197"></a><span id="l35.197">     }];</span>
<a href="#l35.198"></a><span id="l35.198">     let client = yield gServer.getClient();</span>
<a href="#l35.199"></a><span id="l35.199">     let uncached = client.wrappedJSObject.mUncachedCalendar.wrappedJSObject;</span>
<a href="#l35.200"></a><span id="l35.200">     let pclient = cal.async.promisifyCalendar(client);</span>
<a href="#l35.201"></a><span id="l35.201"> </span>
<a href="#l35.202"></a><span id="l35.202">     let items = yield pclient.getAllItems();</span>
<a href="#l35.203"></a><span id="l35.203">     equal(items.length, 4);</span>
<a href="#l35.204"></a><span id="l35.204" class="difflineat">@@ -850,17 +850,17 @@ add_task(function* test_basicItems() {</span>
<a href="#l35.205"></a><span id="l35.205">          &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.206"></a><span id="l35.206">          &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.207"></a><span id="l35.207">          &quot;description&quot;: &quot;description&quot;,</span>
<a href="#l35.208"></a><span id="l35.208">          &quot;location&quot;: &quot;Hard Drive&quot;,</span>
<a href="#l35.209"></a><span id="l35.209">          &quot;colorId&quot;: 17,</span>
<a href="#l35.210"></a><span id="l35.210">          &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.211"></a><span id="l35.211">          &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.212"></a><span id="l35.212">          &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.213"></a><span id="l35.213" class="difflineminus">-         &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.214"></a><span id="l35.214" class="difflineplus">+         &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.215"></a><span id="l35.215">          &quot;transparency&quot;: &quot;transparent&quot;,</span>
<a href="#l35.216"></a><span id="l35.216">          &quot;visibility&quot;: &quot;private&quot;,</span>
<a href="#l35.217"></a><span id="l35.217">          &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;,</span>
<a href="#l35.218"></a><span id="l35.218">          &quot;sequence&quot;: 1,</span>
<a href="#l35.219"></a><span id="l35.219">          &quot;reminders&quot;: {</span>
<a href="#l35.220"></a><span id="l35.220">             &quot;useDefault&quot;: false,</span>
<a href="#l35.221"></a><span id="l35.221">             &quot;overrides&quot;: [{</span>
<a href="#l35.222"></a><span id="l35.222">                 &quot;method&quot;: &quot;email&quot;,</span>
<a href="#l35.223"></a><span id="l35.223" class="difflineat">@@ -1130,42 +1130,42 @@ add_task(function* test_recurring_except</span>
<a href="#l35.224"></a><span id="l35.224">             &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.225"></a><span id="l35.225">             &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.226"></a><span id="l35.226">             &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.227"></a><span id="l35.227">             &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.228"></a><span id="l35.228">             &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.229"></a><span id="l35.229">             &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.230"></a><span id="l35.230">             &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.231"></a><span id="l35.231">             &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.232"></a><span id="l35.232" class="difflineminus">-            &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.233"></a><span id="l35.233" class="difflineplus">+            &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.234"></a><span id="l35.234">             &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;,</span>
<a href="#l35.235"></a><span id="l35.235">             &quot;recurrence&quot;: [</span>
<a href="#l35.236"></a><span id="l35.236">                 &quot;RRULE:FREQ=WEEKLY&quot;</span>
<a href="#l35.237"></a><span id="l35.237">             ]</span>
<a href="#l35.238"></a><span id="l35.238">         }, {</span>
<a href="#l35.239"></a><span id="l35.239">             &quot;kind&quot;: &quot;calendar#event&quot;,</span>
<a href="#l35.240"></a><span id="l35.240">             &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.241"></a><span id="l35.241">             &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo_20060617T160000Z&quot;,</span>
<a href="#l35.242"></a><span id="l35.242">             &quot;summary&quot;: &quot;New Event changed&quot;,</span>
<a href="#l35.243"></a><span id="l35.243">             &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T18:00:00+02:00&quot; },</span>
<a href="#l35.244"></a><span id="l35.244" class="difflineminus">-            &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-17T20:00:00+02:00&quot; },</span>
<a href="#l35.245"></a><span id="l35.245" class="difflineplus">+            &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T20:00:00+02:00&quot; },</span>
<a href="#l35.246"></a><span id="l35.246">             &quot;recurringEventId&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.247"></a><span id="l35.247">             &quot;originalStartTime&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T18:00:00+02:00&quot; }</span>
<a href="#l35.248"></a><span id="l35.248">         }]</span>
<a href="#l35.249"></a><span id="l35.249">     }, {</span>
<a href="#l35.250"></a><span id="l35.250">         // This sync run tests an exception where the master item is not part</span>
<a href="#l35.251"></a><span id="l35.251">         // of the item stream.</span>
<a href="#l35.252"></a><span id="l35.252">         token: &quot;2&quot;,</span>
<a href="#l35.253"></a><span id="l35.253">         events: [{</span>
<a href="#l35.254"></a><span id="l35.254">             &quot;kind&quot;: &quot;calendar#event&quot;,</span>
<a href="#l35.255"></a><span id="l35.255">             &quot;etag&quot;: &quot;\&quot;3\&quot;&quot;,</span>
<a href="#l35.256"></a><span id="l35.256">             &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo_20060617T160000Z&quot;,</span>
<a href="#l35.257"></a><span id="l35.257">             &quot;summary&quot;: &quot;New Event changed&quot;,</span>
<a href="#l35.258"></a><span id="l35.258">             &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T18:00:00+02:00&quot; },</span>
<a href="#l35.259"></a><span id="l35.259" class="difflineminus">-            &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-17T20:00:00+02:00&quot; },</span>
<a href="#l35.260"></a><span id="l35.260" class="difflineplus">+            &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T20:00:00+02:00&quot; },</span>
<a href="#l35.261"></a><span id="l35.261">             &quot;status&quot;: &quot;cancelled&quot;,</span>
<a href="#l35.262"></a><span id="l35.262">             &quot;recurringEventId&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.263"></a><span id="l35.263">             &quot;originalStartTime&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T18:00:00+02:00&quot; }</span>
<a href="#l35.264"></a><span id="l35.264">         }]</span>
<a href="#l35.265"></a><span id="l35.265">     }];</span>
<a href="#l35.266"></a><span id="l35.266"> </span>
<a href="#l35.267"></a><span id="l35.267">     let client = yield gServer.getClient();</span>
<a href="#l35.268"></a><span id="l35.268">     let pclient = cal.async.promisifyCalendar(client.wrappedJSObject);</span>
<a href="#l35.269"></a><span id="l35.269" class="difflineat">@@ -1270,17 +1270,17 @@ add_task(function* test_modify_invitatio</span>
<a href="#l35.270"></a><span id="l35.270">          &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.271"></a><span id="l35.271">          &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.272"></a><span id="l35.272">          &quot;description&quot;: &quot;description&quot;,</span>
<a href="#l35.273"></a><span id="l35.273">          &quot;location&quot;: &quot;Hard Drive&quot;,</span>
<a href="#l35.274"></a><span id="l35.274">          &quot;colorId&quot;: 17,</span>
<a href="#l35.275"></a><span id="l35.275">          &quot;creator&quot;: organizer,</span>
<a href="#l35.276"></a><span id="l35.276">          &quot;organizer&quot;: organizer,</span>
<a href="#l35.277"></a><span id="l35.277">          &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.278"></a><span id="l35.278" class="difflineminus">-         &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.279"></a><span id="l35.279" class="difflineplus">+         &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.280"></a><span id="l35.280">          &quot;transparency&quot;: &quot;transparent&quot;,</span>
<a href="#l35.281"></a><span id="l35.281">          &quot;visibility&quot;: &quot;private&quot;,</span>
<a href="#l35.282"></a><span id="l35.282">          &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;,</span>
<a href="#l35.283"></a><span id="l35.283">          &quot;sequence&quot;: 1,</span>
<a href="#l35.284"></a><span id="l35.284">          &quot;attendees&quot;: [organizer, attendee],</span>
<a href="#l35.285"></a><span id="l35.285">       }</span>
<a href="#l35.286"></a><span id="l35.286">     ];</span>
<a href="#l35.287"></a><span id="l35.287"> </span>
<a href="#l35.288"></a><span id="l35.288" class="difflineat">@@ -1356,17 +1356,17 @@ add_task(function* test_metadata() {</span>
<a href="#l35.289"></a><span id="l35.289">         &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.290"></a><span id="l35.290">         &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.291"></a><span id="l35.291">         &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.292"></a><span id="l35.292">         &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.293"></a><span id="l35.293">         &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.294"></a><span id="l35.294">         &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.295"></a><span id="l35.295">         &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.296"></a><span id="l35.296">         &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.297"></a><span id="l35.297" class="difflineminus">-        &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.298"></a><span id="l35.298" class="difflineplus">+        &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.299"></a><span id="l35.299">         &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.300"></a><span id="l35.300">     }];</span>
<a href="#l35.301"></a><span id="l35.301">     gServer.tasks = [{</span>
<a href="#l35.302"></a><span id="l35.302">         &quot;kind&quot;: &quot;tasks#task&quot;,</span>
<a href="#l35.303"></a><span id="l35.303">         &quot;id&quot;: &quot;MTEyMDE2MDE5NzE0NjYzMDk4ODI6MDo0MDI1NDg2NjU&quot;,</span>
<a href="#l35.304"></a><span id="l35.304">         &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.305"></a><span id="l35.305">         &quot;title&quot;: &quot;New Task&quot;,</span>
<a href="#l35.306"></a><span id="l35.306">         &quot;updated&quot;: &quot;2014-09-08T16:30:27.000Z&quot;,</span>
<a href="#l35.307"></a><span id="l35.307" class="difflineat">@@ -1454,37 +1454,37 @@ add_task(function* test_metadata_recurri</span>
<a href="#l35.308"></a><span id="l35.308">         &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.309"></a><span id="l35.309">         &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.310"></a><span id="l35.310">         &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.311"></a><span id="l35.311">         &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.312"></a><span id="l35.312">         &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.313"></a><span id="l35.313">         &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.314"></a><span id="l35.314">         &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.315"></a><span id="l35.315">         &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.316"></a><span id="l35.316" class="difflineminus">-        &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.317"></a><span id="l35.317" class="difflineplus">+        &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.318"></a><span id="l35.318">         &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;,</span>
<a href="#l35.319"></a><span id="l35.319">         &quot;recurrence&quot;: [</span>
<a href="#l35.320"></a><span id="l35.320">             &quot;RRULE:FREQ=WEEKLY&quot;</span>
<a href="#l35.321"></a><span id="l35.321">         ]</span>
<a href="#l35.322"></a><span id="l35.322">     }, {</span>
<a href="#l35.323"></a><span id="l35.323">         &quot;kind&quot;: &quot;calendar#event&quot;,</span>
<a href="#l35.324"></a><span id="l35.324">         &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.325"></a><span id="l35.325">         &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo_20060610T160000Z&quot;,</span>
<a href="#l35.326"></a><span id="l35.326">         &quot;summary&quot;: &quot;New Event changed&quot;,</span>
<a href="#l35.327"></a><span id="l35.327">         &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.328"></a><span id="l35.328" class="difflineminus">-        &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.329"></a><span id="l35.329" class="difflineplus">+        &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.330"></a><span id="l35.330">         &quot;recurringEventId&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.331"></a><span id="l35.331">         &quot;originalStartTime&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; }</span>
<a href="#l35.332"></a><span id="l35.332">     }, {</span>
<a href="#l35.333"></a><span id="l35.333">         &quot;kind&quot;: &quot;calendar#event&quot;,</span>
<a href="#l35.334"></a><span id="l35.334">         &quot;etag&quot;: &quot;\&quot;3\&quot;&quot;,</span>
<a href="#l35.335"></a><span id="l35.335">         &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo_20060617T160000Z&quot;,</span>
<a href="#l35.336"></a><span id="l35.336">         &quot;summary&quot;: &quot;New Event next week&quot;,</span>
<a href="#l35.337"></a><span id="l35.337">         &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T18:00:00+02:00&quot; },</span>
<a href="#l35.338"></a><span id="l35.338" class="difflineminus">-        &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-17T20:00:00+02:00&quot; },</span>
<a href="#l35.339"></a><span id="l35.339" class="difflineplus">+        &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T20:00:00+02:00&quot; },</span>
<a href="#l35.340"></a><span id="l35.340">         &quot;recurringEventId&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.341"></a><span id="l35.341">         &quot;originalStartTime&quot;: { &quot;dateTime&quot;: &quot;2006-06-17T18:00:00+02:00&quot; }</span>
<a href="#l35.342"></a><span id="l35.342">     }];</span>
<a href="#l35.343"></a><span id="l35.343"> </span>
<a href="#l35.344"></a><span id="l35.344">     let client = yield gServer.getClient();</span>
<a href="#l35.345"></a><span id="l35.345">     let offline = client.wrappedJSObject.mCachedCalendar;</span>
<a href="#l35.346"></a><span id="l35.346">     let pclient = cal.async.promisifyCalendar(client.wrappedJSObject);</span>
<a href="#l35.347"></a><span id="l35.347">     let items = yield pclient.getAllItems();</span>
<a href="#l35.348"></a><span id="l35.348" class="difflineat">@@ -1533,17 +1533,17 @@ add_task(function* test_conflict_modify(</span>
<a href="#l35.349"></a><span id="l35.349">        &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.350"></a><span id="l35.350">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.351"></a><span id="l35.351">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.352"></a><span id="l35.352">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.353"></a><span id="l35.353">        &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.354"></a><span id="l35.354">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.355"></a><span id="l35.355">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.356"></a><span id="l35.356">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.357"></a><span id="l35.357" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.358"></a><span id="l35.358" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.359"></a><span id="l35.359">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.360"></a><span id="l35.360">     }];</span>
<a href="#l35.361"></a><span id="l35.361">     let client = yield gServer.getClient();</span>
<a href="#l35.362"></a><span id="l35.362">     let pclient = cal.async.promisifyCalendar(client.wrappedJSObject);</span>
<a href="#l35.363"></a><span id="l35.363">     let item = (yield pclient.getAllItems())[0];</span>
<a href="#l35.364"></a><span id="l35.364"> </span>
<a href="#l35.365"></a><span id="l35.365">     // Case #1: Modified on server, modify locally, overwrite conflict</span>
<a href="#l35.366"></a><span id="l35.366">     MockConflictPrompt.overwrite = true;</span>
<a href="#l35.367"></a><span id="l35.367" class="difflineat">@@ -1621,17 +1621,17 @@ add_task(function* test_conflict_delete(</span>
<a href="#l35.368"></a><span id="l35.368">        &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.369"></a><span id="l35.369">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.370"></a><span id="l35.370">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.371"></a><span id="l35.371">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.372"></a><span id="l35.372">        &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.373"></a><span id="l35.373">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.374"></a><span id="l35.374">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.375"></a><span id="l35.375">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.376"></a><span id="l35.376" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.377"></a><span id="l35.377" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.378"></a><span id="l35.378">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.379"></a><span id="l35.379">     };</span>
<a href="#l35.380"></a><span id="l35.380"> </span>
<a href="#l35.381"></a><span id="l35.381">     // Load intial event to server</span>
<a href="#l35.382"></a><span id="l35.382">     gServer.events = [coreEvent];</span>
<a href="#l35.383"></a><span id="l35.383">     let client = yield gServer.getClient();</span>
<a href="#l35.384"></a><span id="l35.384">     let pclient = cal.async.promisifyCalendar(client.wrappedJSObject);</span>
<a href="#l35.385"></a><span id="l35.385">     let item = (yield pclient.getAllItems())[0];</span>
<a href="#l35.386"></a><span id="l35.386" class="difflineat">@@ -1727,17 +1727,17 @@ add_task(function* test_default_alarms()</span>
<a href="#l35.387"></a><span id="l35.387">        &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.388"></a><span id="l35.388">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.389"></a><span id="l35.389">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.390"></a><span id="l35.390">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.391"></a><span id="l35.391">        &quot;summary&quot;: &quot;Default Reminder&quot;,</span>
<a href="#l35.392"></a><span id="l35.392">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.393"></a><span id="l35.393">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.394"></a><span id="l35.394">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.395"></a><span id="l35.395" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.396"></a><span id="l35.396" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.397"></a><span id="l35.397">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;,</span>
<a href="#l35.398"></a><span id="l35.398">        &quot;reminders&quot;: { &quot;useDefault&quot;: true }</span>
<a href="#l35.399"></a><span id="l35.399">     }];</span>
<a href="#l35.400"></a><span id="l35.400"> </span>
<a href="#l35.401"></a><span id="l35.401">     // Case #1: read default alarms from event stream</span>
<a href="#l35.402"></a><span id="l35.402">     let client = yield gServer.getClient();</span>
<a href="#l35.403"></a><span id="l35.403">     let pclient = cal.async.promisifyCalendar(client.wrappedJSObject);</span>
<a href="#l35.404"></a><span id="l35.404">     equal(client.getProperty(&quot;settings.defaultReminders&quot;), JSON.stringify(defaultReminders));</span>
<a href="#l35.405"></a><span id="l35.405" class="difflineat">@@ -1837,29 +1837,29 @@ add_task(function* test_paginate() {</span>
<a href="#l35.406"></a><span id="l35.406">        &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.407"></a><span id="l35.407">        &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.408"></a><span id="l35.408">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.409"></a><span id="l35.409">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.410"></a><span id="l35.410">        &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.411"></a><span id="l35.411">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.412"></a><span id="l35.412">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.413"></a><span id="l35.413">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.414"></a><span id="l35.414" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.415"></a><span id="l35.415" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.416"></a><span id="l35.416">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.417"></a><span id="l35.417">     }, {</span>
<a href="#l35.418"></a><span id="l35.418">        &quot;kind&quot;: &quot;calendar#event&quot;,</span>
<a href="#l35.419"></a><span id="l35.419">        &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.420"></a><span id="l35.420">        &quot;id&quot;: &quot;fepf8uf6n7n04w7feukucs9n8e&quot;,</span>
<a href="#l35.421"></a><span id="l35.421">        &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.422"></a><span id="l35.422">        &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.423"></a><span id="l35.423">        &quot;summary&quot;: &quot;New Event 2&quot;,</span>
<a href="#l35.424"></a><span id="l35.424">        &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.425"></a><span id="l35.425">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.426"></a><span id="l35.426">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.427"></a><span id="l35.427" class="difflineminus">-       &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.428"></a><span id="l35.428" class="difflineplus">+       &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.429"></a><span id="l35.429">        &quot;iCalUID&quot;: &quot;fepf8uf6n7n04w7feukucs9n8e@google.com&quot;</span>
<a href="#l35.430"></a><span id="l35.430">     }];</span>
<a href="#l35.431"></a><span id="l35.431"> </span>
<a href="#l35.432"></a><span id="l35.432">     gServer.tasks = [</span>
<a href="#l35.433"></a><span id="l35.433">        {</span>
<a href="#l35.434"></a><span id="l35.434">         &quot;kind&quot;: &quot;tasks#task&quot;,</span>
<a href="#l35.435"></a><span id="l35.435">         &quot;id&quot;: &quot;MTEyMDE2MDE5NzE0NjYzMDk4ODI6MDo0MDI1NDg2NjU&quot;,</span>
<a href="#l35.436"></a><span id="l35.436">         &quot;etag&quot;: &quot;\&quot;Lck7VNWFJuXdzMtOmrYPx0KFV2s/LTIwNjA4MDcyNDM\&quot;&quot;,</span>
<a href="#l35.437"></a><span id="l35.437" class="difflineat">@@ -1908,17 +1908,17 @@ add_task(function* test_incremental_rese</span>
<a href="#l35.438"></a><span id="l35.438">             &quot;etag&quot;: &quot;\&quot;1\&quot;&quot;,</span>
<a href="#l35.439"></a><span id="l35.439">             &quot;id&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo&quot;,</span>
<a href="#l35.440"></a><span id="l35.440">             &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.441"></a><span id="l35.441">             &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.442"></a><span id="l35.442">             &quot;summary&quot;: &quot;New Event&quot;,</span>
<a href="#l35.443"></a><span id="l35.443">             &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.444"></a><span id="l35.444">             &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.445"></a><span id="l35.445">             &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.446"></a><span id="l35.446" class="difflineminus">-            &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.447"></a><span id="l35.447" class="difflineplus">+            &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.448"></a><span id="l35.448">             &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l35.449"></a><span id="l35.449">         }]</span>
<a href="#l35.450"></a><span id="l35.450">     }, {</span>
<a href="#l35.451"></a><span id="l35.451">         token: &quot;2&quot;,</span>
<a href="#l35.452"></a><span id="l35.452">         reset: true</span>
<a href="#l35.453"></a><span id="l35.453">     }, {</span>
<a href="#l35.454"></a><span id="l35.454">         token: &quot;3&quot;,</span>
<a href="#l35.455"></a><span id="l35.455">         events: [{</span>
<a href="#l35.456"></a><span id="l35.456" class="difflineat">@@ -1926,17 +1926,17 @@ add_task(function* test_incremental_rese</span>
<a href="#l35.457"></a><span id="l35.457">             &quot;etag&quot;: &quot;\&quot;2\&quot;&quot;,</span>
<a href="#l35.458"></a><span id="l35.458">             &quot;id&quot;: &quot;fepf8uf6n7n04w7feukucs9n8e&quot;,</span>
<a href="#l35.459"></a><span id="l35.459">             &quot;created&quot;: &quot;2006-06-08T21:04:52.000Z&quot;,</span>
<a href="#l35.460"></a><span id="l35.460">             &quot;updated&quot;: &quot;2006-06-08T21:05:49.138Z&quot;,</span>
<a href="#l35.461"></a><span id="l35.461">             &quot;summary&quot;: &quot;New Event 2&quot;,</span>
<a href="#l35.462"></a><span id="l35.462">             &quot;creator&quot;: gServer.creator,</span>
<a href="#l35.463"></a><span id="l35.463">             &quot;organizer&quot;: gServer.creator,</span>
<a href="#l35.464"></a><span id="l35.464">             &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l35.465"></a><span id="l35.465" class="difflineminus">-            &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.466"></a><span id="l35.466" class="difflineplus">+            &quot;end&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l35.467"></a><span id="l35.467">             &quot;iCalUID&quot;: &quot;fepf8uf6n7n04w7feukucs9n8e@google.com&quot;</span>
<a href="#l35.468"></a><span id="l35.468">         }]</span>
<a href="#l35.469"></a><span id="l35.469">     }];</span>
<a href="#l35.470"></a><span id="l35.470">     let client = yield gServer.getClient();</span>
<a href="#l35.471"></a><span id="l35.471">     let pclient = cal.async.promisifyCalendar(client);</span>
<a href="#l35.472"></a><span id="l35.472"> </span>
<a href="#l35.473"></a><span id="l35.473">     let items = yield pclient.getAllItems();</span>
<a href="#l35.474"></a><span id="l35.474">     equal(items.length, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/test/unit/test_ltninvitationutils.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/test/unit/test_ltninvitationutils.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -56,58 +56,66 @@ function getIcs() {</span>
<a href="#l36.4"></a><span id="l36.4">         &quot;END:VEVENT&quot;,</span>
<a href="#l36.5"></a><span id="l36.5">         &quot;END:VCALENDAR&quot;].join(&quot;\r\n&quot;);</span>
<a href="#l36.6"></a><span id="l36.6"> }</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8"> add_task(function* getItipHeader_test() {</span>
<a href="#l36.9"></a><span id="l36.9">     let data = [{</span>
<a href="#l36.10"></a><span id="l36.10">         input: {</span>
<a href="#l36.11"></a><span id="l36.11">             method: &quot;METHOD:REQUEST\r\n&quot;,</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-            attendee: null},</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+            attendee: null</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineplus">+        },</span>
<a href="#l36.15"></a><span id="l36.15">         expected: &quot;Organizer has invited you to Test Event&quot;</span>
<a href="#l36.16"></a><span id="l36.16">     }, {</span>
<a href="#l36.17"></a><span id="l36.17">         input: {</span>
<a href="#l36.18"></a><span id="l36.18">             method: &quot;METHOD:CANCEL\r\n&quot;,</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineminus">-            attendee: null},</span>
<a href="#l36.20"></a><span id="l36.20" class="difflineplus">+            attendee: null</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineplus">+        },</span>
<a href="#l36.22"></a><span id="l36.22">         expected: &quot;Organizer has canceled this event: Test Event&quot;</span>
<a href="#l36.23"></a><span id="l36.23">     }, {</span>
<a href="#l36.24"></a><span id="l36.24">         input: {</span>
<a href="#l36.25"></a><span id="l36.25">             method: &quot;METHOD:REPLY\r\n&quot;,</span>
<a href="#l36.26"></a><span id="l36.26">             attendee: &quot;ATTENDEE;RSVP=TRUE;CN=Attendee1;PARTSTAT=ACCEPTED;&quot; +</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineminus">-                      &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;},</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineplus">+                      &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineplus">+        },</span>
<a href="#l36.30"></a><span id="l36.30">         expected: &quot;Attendee1 &lt;attendee1@example.net&gt; has accepted your event invitation.&quot;</span>
<a href="#l36.31"></a><span id="l36.31">     }, {</span>
<a href="#l36.32"></a><span id="l36.32">         input: {</span>
<a href="#l36.33"></a><span id="l36.33">             method: &quot;METHOD:REPLY\r\n&quot;,</span>
<a href="#l36.34"></a><span id="l36.34">             attendee: &quot;ATTENDEE;RSVP=TRUE;CN=Attendee1;PARTSTAT=TENTATIVE;&quot; +</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineminus">-                      &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;},</span>
<a href="#l36.36"></a><span id="l36.36" class="difflineplus">+                      &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;</span>
<a href="#l36.37"></a><span id="l36.37" class="difflineplus">+        },</span>
<a href="#l36.38"></a><span id="l36.38">         expected: &quot;Attendee1 &lt;attendee1@example.net&gt; has accepted your event invitation.&quot;</span>
<a href="#l36.39"></a><span id="l36.39">     }, {</span>
<a href="#l36.40"></a><span id="l36.40">         input: {</span>
<a href="#l36.41"></a><span id="l36.41">             method: &quot;METHOD:REPLY\r\n&quot;,</span>
<a href="#l36.42"></a><span id="l36.42">             attendee: &quot;ATTENDEE;RSVP=TRUE;CN=Attendee1;PARTSTAT=DECLINED;&quot; +</span>
<a href="#l36.43"></a><span id="l36.43" class="difflineminus">-                      &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;},</span>
<a href="#l36.44"></a><span id="l36.44" class="difflineplus">+                      &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;</span>
<a href="#l36.45"></a><span id="l36.45" class="difflineplus">+        },</span>
<a href="#l36.46"></a><span id="l36.46">         expected: &quot;Attendee1 &lt;attendee1@example.net&gt; has declined your event invitation.&quot;</span>
<a href="#l36.47"></a><span id="l36.47">     }, {</span>
<a href="#l36.48"></a><span id="l36.48">         input: {</span>
<a href="#l36.49"></a><span id="l36.49">             method: &quot;METHOD:REPLY\r\n&quot;,</span>
<a href="#l36.50"></a><span id="l36.50">             attendee: [&quot;ATTENDEE;RSVP=TRUE;CN=Attendee1;PARTSTAT=ACCEPTED;&quot; +</span>
<a href="#l36.51"></a><span id="l36.51">                        &quot;ROLE=REQ-PARTICIPANT:mailto:attendee1@example.net&quot;,</span>
<a href="#l36.52"></a><span id="l36.52">                        &quot;ATTENDEE;RSVP=TRUE;CN=Attendee2;PARTSTAT=DECLINED;&quot; +</span>
<a href="#l36.53"></a><span id="l36.53" class="difflineminus">-                       &quot;ROLE=REQ-PARTICIPANT:mailto:attendee2@example.net&quot;].join(&quot;\r\n&quot;)},</span>
<a href="#l36.54"></a><span id="l36.54" class="difflineplus">+                       &quot;ROLE=REQ-PARTICIPANT:mailto:attendee2@example.net&quot;].join(&quot;\r\n&quot;)</span>
<a href="#l36.55"></a><span id="l36.55" class="difflineplus">+        },</span>
<a href="#l36.56"></a><span id="l36.56">         expected: &quot;Attendee1 &lt;attendee1@example.net&gt; has accepted your event invitation.&quot;</span>
<a href="#l36.57"></a><span id="l36.57">     }, {</span>
<a href="#l36.58"></a><span id="l36.58">         input: {</span>
<a href="#l36.59"></a><span id="l36.59">             method: &quot;METHOD:UNSUPPORTED\r\n&quot;,</span>
<a href="#l36.60"></a><span id="l36.60" class="difflineminus">-            attendee: null},</span>
<a href="#l36.61"></a><span id="l36.61" class="difflineplus">+            attendee: null</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineplus">+        },</span>
<a href="#l36.63"></a><span id="l36.63">         expected: &quot;Event Invitation&quot;</span>
<a href="#l36.64"></a><span id="l36.64">     }, {</span>
<a href="#l36.65"></a><span id="l36.65">         input: {</span>
<a href="#l36.66"></a><span id="l36.66">             method: &quot;&quot;,</span>
<a href="#l36.67"></a><span id="l36.67" class="difflineminus">-            attendee: &quot;&quot;},</span>
<a href="#l36.68"></a><span id="l36.68" class="difflineplus">+            attendee: &quot;&quot;</span>
<a href="#l36.69"></a><span id="l36.69" class="difflineplus">+        },</span>
<a href="#l36.70"></a><span id="l36.70">         expected: &quot;Event Invitation&quot;</span>
<a href="#l36.71"></a><span id="l36.71">     }];</span>
<a href="#l36.72"></a><span id="l36.72">     let i = 0;</span>
<a href="#l36.73"></a><span id="l36.73">     for (let test of data) {</span>
<a href="#l36.74"></a><span id="l36.74">         i++;</span>
<a href="#l36.75"></a><span id="l36.75">         let itipItem = Components.classes[&quot;@mozilla.org/calendar/itip-item;1&quot;]</span>
<a href="#l36.76"></a><span id="l36.76">                                  .createInstance(Components.interfaces.calIItipItem);</span>
<a href="#l36.77"></a><span id="l36.77">         let item = getIcs();</span>
<a href="#l36.78"></a><span id="l36.78" class="difflineat">@@ -121,83 +129,101 @@ add_task(function* getItipHeader_test() </span>
<a href="#l36.79"></a><span id="l36.79">         equal(ltn.invitation.getItipHeader(itipItem), test.expected,</span>
<a href="#l36.80"></a><span id="l36.80">               &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l36.81"></a><span id="l36.81">     }</span>
<a href="#l36.82"></a><span id="l36.82"> });</span>
<a href="#l36.83"></a><span id="l36.83"> </span>
<a href="#l36.84"></a><span id="l36.84"> add_task(function* createInvitationOverlay_test() {</span>
<a href="#l36.85"></a><span id="l36.85">     let data = [{</span>
<a href="#l36.86"></a><span id="l36.86">         input: {</span>
<a href="#l36.87"></a><span id="l36.87" class="difflineminus">-            description: &quot;DESCRIPTION:Go to https://www.example.net if you can.\r\n&quot;},</span>
<a href="#l36.88"></a><span id="l36.88" class="difflineplus">+            description: &quot;DESCRIPTION:Go to https://www.example.net if you can.\r\n&quot;</span>
<a href="#l36.89"></a><span id="l36.89" class="difflineplus">+        },</span>
<a href="#l36.90"></a><span id="l36.90">         expected: {</span>
<a href="#l36.91"></a><span id="l36.91">             node: &quot;imipHtml-description-content&quot;,</span>
<a href="#l36.92"></a><span id="l36.92">             value: &quot;Go to &lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext&quot; +</span>
<a href="#l36.93"></a><span id="l36.93" class="difflineminus">-                   &quot;\&quot; href=\&quot;https://www.example.net\&quot;&gt;https://www.example.net&lt;/a&gt; if you can.&quot;}</span>
<a href="#l36.94"></a><span id="l36.94" class="difflineplus">+                   &quot;\&quot; href=\&quot;https://www.example.net\&quot;&gt;https://www.example.net&lt;/a&gt; if you can.&quot;</span>
<a href="#l36.95"></a><span id="l36.95" class="difflineplus">+        }</span>
<a href="#l36.96"></a><span id="l36.96">     }, {</span>
<a href="#l36.97"></a><span id="l36.97">         input: {</span>
<a href="#l36.98"></a><span id="l36.98" class="difflineminus">-            description: &quot;DESCRIPTION:Go to www.example.net if you can.\r\n&quot;},</span>
<a href="#l36.99"></a><span id="l36.99" class="difflineplus">+            description: &quot;DESCRIPTION:Go to www.example.net if you can.\r\n&quot;</span>
<a href="#l36.100"></a><span id="l36.100" class="difflineplus">+        },</span>
<a href="#l36.101"></a><span id="l36.101">         expected: {</span>
<a href="#l36.102"></a><span id="l36.102">             node: &quot;imipHtml-description-content&quot;,</span>
<a href="#l36.103"></a><span id="l36.103">             value: &quot;Go to &lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-abbrevia&quot; +</span>
<a href="#l36.104"></a><span id="l36.104" class="difflineminus">-                   &quot;ted\&quot; href=\&quot;http://www.example.net\&quot;&gt;www.example.net&lt;/a&gt; if you can.&quot;}</span>
<a href="#l36.105"></a><span id="l36.105" class="difflineplus">+                   &quot;ted\&quot; href=\&quot;http://www.example.net\&quot;&gt;www.example.net&lt;/a&gt; if you can.&quot;</span>
<a href="#l36.106"></a><span id="l36.106" class="difflineplus">+        }</span>
<a href="#l36.107"></a><span id="l36.107">     }, {</span>
<a href="#l36.108"></a><span id="l36.108">         input: {</span>
<a href="#l36.109"></a><span id="l36.109" class="difflineminus">-            description: &quot;DESCRIPTION:Or write to mailto:faq@example.net instead.\r\n&quot;},</span>
<a href="#l36.110"></a><span id="l36.110" class="difflineplus">+            description: &quot;DESCRIPTION:Or write to mailto:faq@example.net instead.\r\n&quot;</span>
<a href="#l36.111"></a><span id="l36.111" class="difflineplus">+        },</span>
<a href="#l36.112"></a><span id="l36.112">         expected: {</span>
<a href="#l36.113"></a><span id="l36.113">             node: &quot;imipHtml-description-content&quot;,</span>
<a href="#l36.114"></a><span id="l36.114">             value: &quot;Or write to &lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-fr&quot; +</span>
<a href="#l36.115"></a><span id="l36.115" class="difflineminus">-                   &quot;eetext\&quot; href=\&quot;mailto:faq@example.net\&quot;&gt;mailto:faq@example.net&lt;/a&gt; instead.&quot;}</span>
<a href="#l36.116"></a><span id="l36.116" class="difflineplus">+                   &quot;eetext\&quot; href=\&quot;mailto:faq@example.net\&quot;&gt;mailto:faq@example.net&lt;/a&gt; instead.&quot;</span>
<a href="#l36.117"></a><span id="l36.117" class="difflineplus">+        }</span>
<a href="#l36.118"></a><span id="l36.118">     }, {</span>
<a href="#l36.119"></a><span id="l36.119">         input: {</span>
<a href="#l36.120"></a><span id="l36.120" class="difflineminus">-            description: &quot;DESCRIPTION:Or write to faq@example.net instead.\r\n&quot;},</span>
<a href="#l36.121"></a><span id="l36.121" class="difflineplus">+            description: &quot;DESCRIPTION:Or write to faq@example.net instead.\r\n&quot;</span>
<a href="#l36.122"></a><span id="l36.122" class="difflineplus">+        },</span>
<a href="#l36.123"></a><span id="l36.123">         expected: {</span>
<a href="#l36.124"></a><span id="l36.124">             node: &quot;imipHtml-description-content&quot;,</span>
<a href="#l36.125"></a><span id="l36.125">             value: &quot;Or write to &lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-ab&quot; +</span>
<a href="#l36.126"></a><span id="l36.126" class="difflineminus">-                   &quot;breviated\&quot; href=\&quot;mailto:faq@example.net\&quot;&gt;faq@example.net&lt;/a&gt; instead.&quot;}</span>
<a href="#l36.127"></a><span id="l36.127" class="difflineplus">+                   &quot;breviated\&quot; href=\&quot;mailto:faq@example.net\&quot;&gt;faq@example.net&lt;/a&gt; instead.&quot;</span>
<a href="#l36.128"></a><span id="l36.128" class="difflineplus">+        }</span>
<a href="#l36.129"></a><span id="l36.129">     }, {</span>
<a href="#l36.130"></a><span id="l36.130">         input: {</span>
<a href="#l36.131"></a><span id="l36.131" class="difflineminus">-            description: &quot;DESCRIPTION:It's up to you ;-)\r\n&quot;},</span>
<a href="#l36.132"></a><span id="l36.132" class="difflineplus">+            description: &quot;DESCRIPTION:It's up to you ;-)\r\n&quot;</span>
<a href="#l36.133"></a><span id="l36.133" class="difflineplus">+        },</span>
<a href="#l36.134"></a><span id="l36.134">         expected: {</span>
<a href="#l36.135"></a><span id="l36.135">             node: &quot;imipHtml-description-content&quot;,</span>
<a href="#l36.136"></a><span id="l36.136">             value: &quot;It's up to you &lt;span xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-smile&quot; +</span>
<a href="#l36.137"></a><span id="l36.137" class="difflineminus">-                   &quot;y-s3\&quot; title=\&quot;;-)\&quot;&gt;&lt;span&gt;;-)&lt;/span&gt;&lt;/span&gt;&quot;}</span>
<a href="#l36.138"></a><span id="l36.138" class="difflineplus">+                   &quot;y-s3\&quot; title=\&quot;;-)\&quot;&gt;&lt;span&gt;;-)&lt;/span&gt;&lt;/span&gt;&quot;</span>
<a href="#l36.139"></a><span id="l36.139" class="difflineplus">+        }</span>
<a href="#l36.140"></a><span id="l36.140">     }, {</span>
<a href="#l36.141"></a><span id="l36.141">         input: {</span>
<a href="#l36.142"></a><span id="l36.142" class="difflineminus">-            url: &quot;URL:http://www.example.org/event.ics\r\n&quot;},</span>
<a href="#l36.143"></a><span id="l36.143" class="difflineplus">+            url: &quot;URL:http://www.example.org/event.ics\r\n&quot;</span>
<a href="#l36.144"></a><span id="l36.144" class="difflineplus">+        },</span>
<a href="#l36.145"></a><span id="l36.145">         expected: {</span>
<a href="#l36.146"></a><span id="l36.146">             node: &quot;imipHtml-url-content&quot;,</span>
<a href="#l36.147"></a><span id="l36.147">             value: &quot;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; hre&quot; +</span>
<a href="#l36.148"></a><span id="l36.148" class="difflineminus">-                   &quot;f=\&quot;http://www.example.org/event.ics\&quot;&gt;http://www.example.org/event.ics&lt;/a&gt;&quot;}</span>
<a href="#l36.149"></a><span id="l36.149" class="difflineplus">+                   &quot;f=\&quot;http://www.example.org/event.ics\&quot;&gt;http://www.example.org/event.ics&lt;/a&gt;&quot;</span>
<a href="#l36.150"></a><span id="l36.150" class="difflineplus">+        }</span>
<a href="#l36.151"></a><span id="l36.151">     }, {</span>
<a href="#l36.152"></a><span id="l36.152">         input: {</span>
<a href="#l36.153"></a><span id="l36.153" class="difflineminus">-            attach: &quot;ATTACH:http://www.example.org\r\n&quot;},</span>
<a href="#l36.154"></a><span id="l36.154" class="difflineplus">+            attach: &quot;ATTACH:http://www.example.org\r\n&quot;</span>
<a href="#l36.155"></a><span id="l36.155" class="difflineplus">+        },</span>
<a href="#l36.156"></a><span id="l36.156">         expected: {</span>
<a href="#l36.157"></a><span id="l36.157">             node: &quot;imipHtml-attachments-content&quot;,</span>
<a href="#l36.158"></a><span id="l36.158">             value: &quot;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; hre&quot; +</span>
<a href="#l36.159"></a><span id="l36.159" class="difflineminus">-                   &quot;f=\&quot;http://www.example.org/\&quot;&gt;http://www.example.org/&lt;/a&gt;&quot;}</span>
<a href="#l36.160"></a><span id="l36.160" class="difflineplus">+                   &quot;f=\&quot;http://www.example.org/\&quot;&gt;http://www.example.org/&lt;/a&gt;&quot;</span>
<a href="#l36.161"></a><span id="l36.161" class="difflineplus">+        }</span>
<a href="#l36.162"></a><span id="l36.162">     }, {</span>
<a href="#l36.163"></a><span id="l36.163">         input: {</span>
<a href="#l36.164"></a><span id="l36.164">             attach: &quot;ATTACH;FMTTYPE=text/plain;ENCODING=BASE64;VALUE=BINARY:VGhlIHF1aWNrIGJyb3duI&quot; +</span>
<a href="#l36.165"></a><span id="l36.165" class="difflineminus">-                    &quot;GZveCBqdW1wcyBvdmVyIHRoZSBsYXp5IGRvZy4\r\n&quot;},</span>
<a href="#l36.166"></a><span id="l36.166" class="difflineplus">+                    &quot;GZveCBqdW1wcyBvdmVyIHRoZSBsYXp5IGRvZy4\r\n&quot;</span>
<a href="#l36.167"></a><span id="l36.167" class="difflineplus">+        },</span>
<a href="#l36.168"></a><span id="l36.168">         expected: {</span>
<a href="#l36.169"></a><span id="l36.169">             node: &quot;imipHtml-attachments-content&quot;,</span>
<a href="#l36.170"></a><span id="l36.170" class="difflineminus">-            value: &quot;&quot;}</span>
<a href="#l36.171"></a><span id="l36.171" class="difflineplus">+            value: &quot;&quot;</span>
<a href="#l36.172"></a><span id="l36.172" class="difflineplus">+        }</span>
<a href="#l36.173"></a><span id="l36.173">     }, {</span>
<a href="#l36.174"></a><span id="l36.174">         input: {</span>
<a href="#l36.175"></a><span id="l36.175">             attach: &quot;ATTACH:http://www.example.org/first/\r\n&quot; +</span>
<a href="#l36.176"></a><span id="l36.176">                     &quot;ATTACH:http://www.example.org/second\r\n&quot; +</span>
<a href="#l36.177"></a><span id="l36.177" class="difflineminus">-                    &quot;ATTACH:file:///N:/folder/third.file\r\n&quot;},</span>
<a href="#l36.178"></a><span id="l36.178" class="difflineplus">+                    &quot;ATTACH:file:///N:/folder/third.file\r\n&quot;</span>
<a href="#l36.179"></a><span id="l36.179" class="difflineplus">+        },</span>
<a href="#l36.180"></a><span id="l36.180">         expected: {</span>
<a href="#l36.181"></a><span id="l36.181">             node: &quot;imipHtml-attachments-content&quot;,</span>
<a href="#l36.182"></a><span id="l36.182">             value: &quot;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; hre&quot; +</span>
<a href="#l36.183"></a><span id="l36.183">                    &quot;f=\&quot;http://www.example.org/first/\&quot;&gt;http://www.example.org/first/&lt;/a&gt;&amp;lt;br&amp;g&quot; +</span>
<a href="#l36.184"></a><span id="l36.184">                    &quot;t;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; h&quot; +</span>
<a href="#l36.185"></a><span id="l36.185">                    &quot;ref=\&quot;http://www.example.org/second\&quot;&gt;http://www.example.org/second&lt;/a&gt;&amp;lt;br&quot; +</span>
<a href="#l36.186"></a><span id="l36.186">                    &quot;&amp;gt;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot;&quot; +</span>
<a href="#l36.187"></a><span id="l36.187" class="difflineminus">-                   &quot; href=\&quot;file:///N:/folder/third.file\&quot;&gt;file:///N:/folder/third.file&lt;/a&gt;&quot;}</span>
<a href="#l36.188"></a><span id="l36.188" class="difflineplus">+                   &quot; href=\&quot;file:///N:/folder/third.file\&quot;&gt;file:///N:/folder/third.file&lt;/a&gt;&quot;</span>
<a href="#l36.189"></a><span id="l36.189" class="difflineplus">+        }</span>
<a href="#l36.190"></a><span id="l36.190">     }, {</span>
<a href="#l36.191"></a><span id="l36.191">         input: {</span>
<a href="#l36.192"></a><span id="l36.192">             attendee: &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;ROLE=OPT-PARTICIPANT;CUTYPE=INDIV&quot; +</span>
<a href="#l36.193"></a><span id="l36.193">                       &quot;IDUAL;CN=\&quot;Attendee 1\&quot;:mailto:attendee1@example.net\r\n&quot; +</span>
<a href="#l36.194"></a><span id="l36.194"> </span>
<a href="#l36.195"></a><span id="l36.195">                       &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=ACCEPTED;ROLE=NON-PARTICIPANT;CUTYPE=GROUP:mai&quot; +</span>
<a href="#l36.196"></a><span id="l36.196">                       &quot;lto:attendee2@example.net\r\n&quot; +</span>
<a href="#l36.197"></a><span id="l36.197"> </span>
<a href="#l36.198"></a><span id="l36.198" class="difflineat">@@ -209,17 +235,18 @@ add_task(function* createInvitationOverl</span>
<a href="#l36.199"></a><span id="l36.199">                       &quot;net\r\n&quot; +</span>
<a href="#l36.200"></a><span id="l36.200"> </span>
<a href="#l36.201"></a><span id="l36.201">                       &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=DELEGATED;ROLE=OPT-PARTICIPANT;DELEGATED-TO=\&quot;&quot; +</span>
<a href="#l36.202"></a><span id="l36.202">                       &quot;mailto:attendee4@example.net\&quot;;CUTYPE=UNKNOWN:mailto:attendee5@example.net&quot; +</span>
<a href="#l36.203"></a><span id="l36.203">                       &quot;\r\n&quot; +</span>
<a href="#l36.204"></a><span id="l36.204"> </span>
<a href="#l36.205"></a><span id="l36.205">                       &quot;ATTENDEE;RSVP=TRUE:mailto:attendee6@example.net\r\n&quot; +</span>
<a href="#l36.206"></a><span id="l36.206"> </span>
<a href="#l36.207"></a><span id="l36.207" class="difflineminus">-                      &quot;ATTENDEE:mailto:attendee7@example.net\r\n&quot;},</span>
<a href="#l36.208"></a><span id="l36.208" class="difflineplus">+                      &quot;ATTENDEE:mailto:attendee7@example.net\r\n&quot;</span>
<a href="#l36.209"></a><span id="l36.209" class="difflineplus">+        },</span>
<a href="#l36.210"></a><span id="l36.210">         expected: {</span>
<a href="#l36.211"></a><span id="l36.211">             node: &quot;attendee-table&quot;,</span>
<a href="#l36.212"></a><span id="l36.212">             value: &quot;&lt;tr xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; id=\&quot;attendee-template\&quot; hidden=\&quot;&quot; +</span>
<a href="#l36.213"></a><span id="l36.213">                    &quot;true\&quot;&gt;&lt;td&gt;&lt;p class=\&quot;itip-icon\&quot;&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=\&quot;attendee-name\&quot;&gt;&lt;/td&gt;&lt;&quot; +</span>
<a href="#l36.214"></a><span id="l36.214">                    &quot;/tr&gt;&quot; +</span>
<a href="#l36.215"></a><span id="l36.215"> </span>
<a href="#l36.216"></a><span id="l36.216">                    &quot;&lt;tr xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; title=\&quot;Attendee 1 &amp;lt;attendee1@e&quot; +</span>
<a href="#l36.217"></a><span id="l36.217">                    &quot;xample.net&amp;gt; is an optional participant. Attendee 1 still needs to reply.\&quot;&quot; +</span>
<a href="#l36.218"></a><span id="l36.218" class="difflineat">@@ -256,28 +283,31 @@ add_task(function* createInvitationOverl</span>
<a href="#l36.219"></a><span id="l36.219">                    &quot;lass=\&quot;itip-icon\&quot; role=\&quot;REQ-PARTICIPANT\&quot; usertype=\&quot;INDIVIDUAL\&quot; partstat=&quot; +</span>
<a href="#l36.220"></a><span id="l36.220">                    &quot;\&quot;NEEDS-ACTION\&quot;&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=\&quot;attendee-name\&quot;&gt;attendee6@example.net&lt;/&quot; +</span>
<a href="#l36.221"></a><span id="l36.221">                    &quot;td&gt;&lt;/tr&gt;&quot; +</span>
<a href="#l36.222"></a><span id="l36.222"> </span>
<a href="#l36.223"></a><span id="l36.223">                    &quot;&lt;tr xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; title=\&quot;attendee7@example.net is a&quot; +</span>
<a href="#l36.224"></a><span id="l36.224">                    &quot; required participant. attendee7@example.net still needs to reply.\&quot;&gt;&lt;td&gt;&lt;p c&quot; +</span>
<a href="#l36.225"></a><span id="l36.225">                    &quot;lass=\&quot;itip-icon\&quot; role=\&quot;REQ-PARTICIPANT\&quot; usertype=\&quot;INDIVIDUAL\&quot; partstat=&quot; +</span>
<a href="#l36.226"></a><span id="l36.226">                    &quot;\&quot;NEEDS-ACTION\&quot;&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=\&quot;attendee-name\&quot;&gt;attendee7@example.net&lt;/&quot; +</span>
<a href="#l36.227"></a><span id="l36.227" class="difflineminus">-                   &quot;td&gt;&lt;/tr&gt;&quot;}</span>
<a href="#l36.228"></a><span id="l36.228" class="difflineplus">+                   &quot;td&gt;&lt;/tr&gt;&quot;</span>
<a href="#l36.229"></a><span id="l36.229" class="difflineplus">+        }</span>
<a href="#l36.230"></a><span id="l36.230">     }, {</span>
<a href="#l36.231"></a><span id="l36.231">         input: {</span>
<a href="#l36.232"></a><span id="l36.232">             organizer: &quot;ORGANIZER;PARTSTAT=ACCEPTED;ROLE=CHAIR;CUTYPE=\&quot;INDIVIDUAL\&quot;;CN=\&quot;The Org&quot; +</span>
<a href="#l36.233"></a><span id="l36.233" class="difflineminus">-                       &quot;anizer\&quot;:mailto:organizer@example.net\r\n&quot;},</span>
<a href="#l36.234"></a><span id="l36.234" class="difflineplus">+                       &quot;anizer\&quot;:mailto:organizer@example.net\r\n&quot;</span>
<a href="#l36.235"></a><span id="l36.235" class="difflineplus">+        },</span>
<a href="#l36.236"></a><span id="l36.236">         expected: {</span>
<a href="#l36.237"></a><span id="l36.237">             node: &quot;organizer-table&quot;,</span>
<a href="#l36.238"></a><span id="l36.238">             value: &quot;&lt;tr xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; title=\&quot;The Organizer &amp;lt;organize&quot; +</span>
<a href="#l36.239"></a><span id="l36.239">                    &quot;r@example.net&amp;gt; chairs the event. The Organizer has confirmed attendance.\&quot;&quot; +</span>
<a href="#l36.240"></a><span id="l36.240">                    &quot;&gt;&lt;td&gt;&lt;p class=\&quot;itip-icon\&quot; role=\&quot;CHAIR\&quot; usertype=\&quot;INDIVIDUAL\&quot; partstat=\&quot;&quot; +</span>
<a href="#l36.241"></a><span id="l36.241">                    &quot;ACCEPTED\&quot;&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class=\&quot;attendee-name\&quot;&gt;The Organizer &amp;lt;organizer@e&quot; +</span>
<a href="#l36.242"></a><span id="l36.242" class="difflineminus">-                   &quot;xample.net&amp;gt;&lt;/td&gt;&lt;/tr&gt;&quot;}</span>
<a href="#l36.243"></a><span id="l36.243" class="difflineplus">+                   &quot;xample.net&amp;gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>
<a href="#l36.244"></a><span id="l36.244" class="difflineplus">+        }</span>
<a href="#l36.245"></a><span id="l36.245">     }];</span>
<a href="#l36.246"></a><span id="l36.246">     let i = 0;</span>
<a href="#l36.247"></a><span id="l36.247">     for (let test of data) {</span>
<a href="#l36.248"></a><span id="l36.248">         i++;</span>
<a href="#l36.249"></a><span id="l36.249">         let item = getIcs();</span>
<a href="#l36.250"></a><span id="l36.250">         for (let attribute of Object.keys(test.input)) {</span>
<a href="#l36.251"></a><span id="l36.251">             switch (attribute) {</span>
<a href="#l36.252"></a><span id="l36.252">                 case &quot;description&quot;:</span>
<a href="#l36.253"></a><span id="l36.253" class="difflineat">@@ -335,44 +365,55 @@ add_task(function* compareInvitationOver</span>
<a href="#l36.254"></a><span id="l36.254">                                .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l36.255"></a><span id="l36.255">         parser.parseString(item);</span>
<a href="#l36.256"></a><span id="l36.256">         let dom = ltn.invitation.createInvitationOverlay(parser.getItems({})[0], itipItem);</span>
<a href="#l36.257"></a><span id="l36.257">         return cal.xml.serializeDOM(dom);</span>
<a href="#l36.258"></a><span id="l36.258">     }</span>
<a href="#l36.259"></a><span id="l36.259">     let data = [{</span>
<a href="#l36.260"></a><span id="l36.260">         input: {</span>
<a href="#l36.261"></a><span id="l36.261">             previous: {</span>
<a href="#l36.262"></a><span id="l36.262" class="difflineminus">-                location: &quot;LOCATION:This place\r\n&quot;},</span>
<a href="#l36.263"></a><span id="l36.263" class="difflineplus">+                location: &quot;LOCATION:This place\r\n&quot;</span>
<a href="#l36.264"></a><span id="l36.264" class="difflineplus">+            },</span>
<a href="#l36.265"></a><span id="l36.265">             current: {</span>
<a href="#l36.266"></a><span id="l36.266" class="difflineminus">-                location: &quot;LOCATION:Another location\r\n&quot;},</span>
<a href="#l36.267"></a><span id="l36.267" class="difflineminus">-            ignore: &quot;&quot;},</span>
<a href="#l36.268"></a><span id="l36.268" class="difflineplus">+                location: &quot;LOCATION:Another location\r\n&quot;</span>
<a href="#l36.269"></a><span id="l36.269" class="difflineplus">+            },</span>
<a href="#l36.270"></a><span id="l36.270" class="difflineplus">+            ignore: &quot;&quot;</span>
<a href="#l36.271"></a><span id="l36.271" class="difflineplus">+        },</span>
<a href="#l36.272"></a><span id="l36.272">         expected: {</span>
<a href="#l36.273"></a><span id="l36.273">             node: &quot;imipHtml-location-content&quot;,</span>
<a href="#l36.274"></a><span id="l36.274">             value: &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;Another location&lt;/span&gt;&lt;br xmlns=\&quot;\&quot;/&gt;&quot; +</span>
<a href="#l36.275"></a><span id="l36.275" class="difflineminus">-                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;This place&lt;/span&gt;&quot;}</span>
<a href="#l36.276"></a><span id="l36.276" class="difflineplus">+                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;This place&lt;/span&gt;&quot;</span>
<a href="#l36.277"></a><span id="l36.277" class="difflineplus">+        }</span>
<a href="#l36.278"></a><span id="l36.278">     }, {</span>
<a href="#l36.279"></a><span id="l36.279">         input: {</span>
<a href="#l36.280"></a><span id="l36.280">             previous: {</span>
<a href="#l36.281"></a><span id="l36.281" class="difflineminus">-                summary: &quot;SUMMARY:My invitation\r\n&quot;},</span>
<a href="#l36.282"></a><span id="l36.282" class="difflineplus">+                summary: &quot;SUMMARY:My invitation\r\n&quot;</span>
<a href="#l36.283"></a><span id="l36.283" class="difflineplus">+            },</span>
<a href="#l36.284"></a><span id="l36.284">             current: {</span>
<a href="#l36.285"></a><span id="l36.285" class="difflineminus">-                summary: &quot;SUMMARY:My new invitation\r\n&quot;},</span>
<a href="#l36.286"></a><span id="l36.286" class="difflineminus">-            ignore: &quot;&quot;},</span>
<a href="#l36.287"></a><span id="l36.287" class="difflineplus">+                summary: &quot;SUMMARY:My new invitation\r\n&quot;</span>
<a href="#l36.288"></a><span id="l36.288" class="difflineplus">+            },</span>
<a href="#l36.289"></a><span id="l36.289" class="difflineplus">+            ignore: &quot;&quot;</span>
<a href="#l36.290"></a><span id="l36.290" class="difflineplus">+        },</span>
<a href="#l36.291"></a><span id="l36.291">         expected: {</span>
<a href="#l36.292"></a><span id="l36.292">             node: &quot;imipHtml-summary-content&quot;,</span>
<a href="#l36.293"></a><span id="l36.293">             value: &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;My new invitation&lt;/span&gt;&lt;br xmlns=\&quot;\&quot;/&gt;&quot; +</span>
<a href="#l36.294"></a><span id="l36.294" class="difflineminus">-                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;My invitation&lt;/span&gt;&quot;}</span>
<a href="#l36.295"></a><span id="l36.295" class="difflineplus">+                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;My invitation&lt;/span&gt;&quot;</span>
<a href="#l36.296"></a><span id="l36.296" class="difflineplus">+        }</span>
<a href="#l36.297"></a><span id="l36.297">     }, {</span>
<a href="#l36.298"></a><span id="l36.298">         input: {</span>
<a href="#l36.299"></a><span id="l36.299">             previous: {</span>
<a href="#l36.300"></a><span id="l36.300">                 dtstart: &quot;DTSTART;TZID=Europe/Berlin:20150909T130000\r\n&quot;,</span>
<a href="#l36.301"></a><span id="l36.301" class="difflineminus">-                dtend: &quot;DTEND;TZID=Europe/Berlin:20150909T140000\r\n&quot;},</span>
<a href="#l36.302"></a><span id="l36.302" class="difflineplus">+                dtend: &quot;DTEND;TZID=Europe/Berlin:20150909T140000\r\n&quot;</span>
<a href="#l36.303"></a><span id="l36.303" class="difflineplus">+            },</span>
<a href="#l36.304"></a><span id="l36.304">             current: {</span>
<a href="#l36.305"></a><span id="l36.305">                 dtstart: &quot;DTSTART;TZID=Europe/Berlin:20150909T140000\r\n&quot;,</span>
<a href="#l36.306"></a><span id="l36.306" class="difflineminus">-                dtend: &quot;DTEND;TZID=Europe/Berlin:20150909T150000\r\n&quot;},</span>
<a href="#l36.307"></a><span id="l36.307" class="difflineminus">-            ignore: &quot;&quot;},</span>
<a href="#l36.308"></a><span id="l36.308" class="difflineplus">+                dtend: &quot;DTEND;TZID=Europe/Berlin:20150909T150000\r\n&quot;</span>
<a href="#l36.309"></a><span id="l36.309" class="difflineplus">+            },</span>
<a href="#l36.310"></a><span id="l36.310" class="difflineplus">+            ignore: &quot;&quot;</span>
<a href="#l36.311"></a><span id="l36.311" class="difflineplus">+        },</span>
<a href="#l36.312"></a><span id="l36.312">         expected: {</span>
<a href="#l36.313"></a><span id="l36.313">             // time format is platform dependent, so we use alternative result sets here</span>
<a href="#l36.314"></a><span id="l36.314">             // the first three are to meet configurations running for automated tests, the</span>
<a href="#l36.315"></a><span id="l36.315">             // following are some flavours that may occur - if you get a failure for this test,</span>
<a href="#l36.316"></a><span id="l36.316">             // add your pattern here</span>
<a href="#l36.317"></a><span id="l36.317">             node: &quot;imipHtml-when-content&quot;,</span>
<a href="#l36.318"></a><span id="l36.318">             some: [&quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;Wed 9 Sep 2015 02:00 PM  03:00 PM&lt;/span&gt;&quot; +</span>
<a href="#l36.319"></a><span id="l36.319">                    &quot;&lt;br xmlns=\&quot;\&quot;/&gt;&quot; +</span>
<a href="#l36.320"></a><span id="l36.320" class="difflineat">@@ -397,51 +438,60 @@ add_task(function* compareInvitationOver</span>
<a href="#l36.321"></a><span id="l36.321">                    &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;Wednesday, 09 September, 2015 1:00 PM  2:00 PM&lt;/span&gt;&quot;,</span>
<a href="#l36.322"></a><span id="l36.322"> </span>
<a href="#l36.323"></a><span id="l36.323">                    &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;Wed 9 Sep 2015 14:00  15:00&lt;/span&gt;&quot; +</span>
<a href="#l36.324"></a><span id="l36.324">                    &quot;&lt;br xmlns=\&quot;\&quot;/&gt;&quot; +</span>
<a href="#l36.325"></a><span id="l36.325">                    &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;Wed 9 Sep 2015 13:00  14:00&lt;/span&gt;&quot;,</span>
<a href="#l36.326"></a><span id="l36.326"> </span>
<a href="#l36.327"></a><span id="l36.327">                    &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;Wed 09 Sep 2015 14:00  15:00&lt;/span&gt;&quot; +</span>
<a href="#l36.328"></a><span id="l36.328">                    &quot;&lt;br xmlns=\&quot;\&quot;/&gt;&quot; +</span>
<a href="#l36.329"></a><span id="l36.329" class="difflineminus">-                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;Wed 09 Sep 2015 13:00  14:00&lt;/span&gt;&quot;]}</span>
<a href="#l36.330"></a><span id="l36.330" class="difflineplus">+                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;Wed 09 Sep 2015 13:00  14:00&lt;/span&gt;&quot;]</span>
<a href="#l36.331"></a><span id="l36.331" class="difflineplus">+        }</span>
<a href="#l36.332"></a><span id="l36.332">     }, {</span>
<a href="#l36.333"></a><span id="l36.333">         input: {</span>
<a href="#l36.334"></a><span id="l36.334">             previous: {</span>
<a href="#l36.335"></a><span id="l36.335" class="difflineminus">-                organizer: &quot;ORGANIZER:mailto:organizer1@example.net\r\n&quot;},</span>
<a href="#l36.336"></a><span id="l36.336" class="difflineplus">+                organizer: &quot;ORGANIZER:mailto:organizer1@example.net\r\n&quot;</span>
<a href="#l36.337"></a><span id="l36.337" class="difflineplus">+            },</span>
<a href="#l36.338"></a><span id="l36.338">             current: {</span>
<a href="#l36.339"></a><span id="l36.339" class="difflineminus">-                organizer: &quot;ORGANIZER:mailto:organizer2@example.net\r\n&quot;},</span>
<a href="#l36.340"></a><span id="l36.340" class="difflineminus">-            ignore: &quot;&quot;},</span>
<a href="#l36.341"></a><span id="l36.341" class="difflineplus">+                organizer: &quot;ORGANIZER:mailto:organizer2@example.net\r\n&quot;</span>
<a href="#l36.342"></a><span id="l36.342" class="difflineplus">+            },</span>
<a href="#l36.343"></a><span id="l36.343" class="difflineplus">+            ignore: &quot;&quot;</span>
<a href="#l36.344"></a><span id="l36.344" class="difflineplus">+        },</span>
<a href="#l36.345"></a><span id="l36.345">         expected: {</span>
<a href="#l36.346"></a><span id="l36.346">             node: &quot;organizer-table&quot;,</span>
<a href="#l36.347"></a><span id="l36.347">             each: [&quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;organizer2@example.net&lt;/span&gt;&quot;,</span>
<a href="#l36.348"></a><span id="l36.348" class="difflineminus">-                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;organizer1@example.net&lt;/span&gt;&quot;]}</span>
<a href="#l36.349"></a><span id="l36.349" class="difflineplus">+                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;organizer1@example.net&lt;/span&gt;&quot;]</span>
<a href="#l36.350"></a><span id="l36.350" class="difflineplus">+        }</span>
<a href="#l36.351"></a><span id="l36.351">     }, {</span>
<a href="#l36.352"></a><span id="l36.352">         input: {</span>
<a href="#l36.353"></a><span id="l36.353">             previous: {</span>
<a href="#l36.354"></a><span id="l36.354">                 attendee: &quot;ATTENDEE;RSVP=TRUE;CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-ACTION:&quot; +</span>
<a href="#l36.355"></a><span id="l36.355">                           &quot;mailto:attendee1@example.net\r\n&quot; +</span>
<a href="#l36.356"></a><span id="l36.356">                           &quot;ATTENDEE;RSVP=TRUE;CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-ACTION:&quot; +</span>
<a href="#l36.357"></a><span id="l36.357">                           &quot;mailto:attendee2@example.net\r\n&quot; +</span>
<a href="#l36.358"></a><span id="l36.358">                           &quot;ATTENDEE;RSVP=TRUE;CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-ACTION:&quot; +</span>
<a href="#l36.359"></a><span id="l36.359" class="difflineminus">-                          &quot;mailto:attendee3@example.net\r\n&quot;},</span>
<a href="#l36.360"></a><span id="l36.360" class="difflineplus">+                          &quot;mailto:attendee3@example.net\r\n&quot;</span>
<a href="#l36.361"></a><span id="l36.361" class="difflineplus">+            },</span>
<a href="#l36.362"></a><span id="l36.362">             current: {</span>
<a href="#l36.363"></a><span id="l36.363">                 attendee: &quot;ATTENDEE;RSVP=TRUE;CUTYPE=INDIVIDUAL;PARTSTAT=ACCEPTED:mail&quot; +</span>
<a href="#l36.364"></a><span id="l36.364">                           &quot;to:attendee2@example.net\r\n&quot; +</span>
<a href="#l36.365"></a><span id="l36.365">                           &quot;ATTENDEE;RSVP=TRUE;CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-ACTION:&quot; +</span>
<a href="#l36.366"></a><span id="l36.366">                           &quot;mailto:attendee3@example.net\r\n&quot; +</span>
<a href="#l36.367"></a><span id="l36.367">                           &quot;ATTENDEE;RSVP=TRUE;CUTYPE=INDIVIDUAL;PARTSTAT=NEEDS-ACTION:&quot; +</span>
<a href="#l36.368"></a><span id="l36.368" class="difflineminus">-                          &quot;mailto:attendee4@example.net\r\n&quot;},</span>
<a href="#l36.369"></a><span id="l36.369" class="difflineminus">-            ignore: &quot;&quot;},</span>
<a href="#l36.370"></a><span id="l36.370" class="difflineplus">+                          &quot;mailto:attendee4@example.net\r\n&quot;</span>
<a href="#l36.371"></a><span id="l36.371" class="difflineplus">+            },</span>
<a href="#l36.372"></a><span id="l36.372" class="difflineplus">+            ignore: &quot;&quot;</span>
<a href="#l36.373"></a><span id="l36.373" class="difflineplus">+        },</span>
<a href="#l36.374"></a><span id="l36.374">         expected: {</span>
<a href="#l36.375"></a><span id="l36.375">             node: &quot;attendee-table&quot;,</span>
<a href="#l36.376"></a><span id="l36.376">             each: [&quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;modified\&quot;&gt;attendee2@example.net&lt;/span&gt;&quot;,</span>
<a href="#l36.377"></a><span id="l36.377">                    &quot;attendee3@example.net&quot;,</span>
<a href="#l36.378"></a><span id="l36.378">                    &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;added\&quot;&gt;attendee4@example.net&lt;/span&gt;&quot;,</span>
<a href="#l36.379"></a><span id="l36.379" class="difflineminus">-                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;attendee1@example.net&lt;/span&gt;&quot;]}</span>
<a href="#l36.380"></a><span id="l36.380" class="difflineplus">+                   &quot;&lt;span xmlns=\&quot;\&quot; class=\&quot;removed\&quot;&gt;attendee1@example.net&lt;/span&gt;&quot;]</span>
<a href="#l36.381"></a><span id="l36.381" class="difflineplus">+        }</span>
<a href="#l36.382"></a><span id="l36.382">     }];</span>
<a href="#l36.383"></a><span id="l36.383">     // we make sure that the Europe/Berlin timezone and long datetime format is set</span>
<a href="#l36.384"></a><span id="l36.384">     let dateformat = Preferences.get(&quot;calendar.date.format&quot;, 0);</span>
<a href="#l36.385"></a><span id="l36.385">     let tzlocal = Preferences.get(&quot;calendar.timezone.local&quot;, &quot;Europe/Berlin&quot;);</span>
<a href="#l36.386"></a><span id="l36.386">     Preferences.set(&quot;calendar.date.format&quot;, 0);</span>
<a href="#l36.387"></a><span id="l36.387">     Preferences.set(&quot;calendar.timezone.local&quot;, &quot;Europe/Berlin&quot;);</span>
<a href="#l36.388"></a><span id="l36.388">     let i = 0;</span>
<a href="#l36.389"></a><span id="l36.389">     for (let test of data) {</span>
<a href="#l36.390"></a><span id="l36.390" class="difflineat">@@ -485,17 +535,19 @@ add_task(function* getHeaderSection_test</span>
<a href="#l36.391"></a><span id="l36.391">             toList: &quot;recipient@example.net&quot;,</span>
<a href="#l36.392"></a><span id="l36.392">             subject: &quot;Invitation: test subject&quot;,</span>
<a href="#l36.393"></a><span id="l36.393">             identity: {</span>
<a href="#l36.394"></a><span id="l36.394">                 fullName: &quot;Invitation sender&quot;,</span>
<a href="#l36.395"></a><span id="l36.395">                 email: &quot;sender@example.net&quot;,</span>
<a href="#l36.396"></a><span id="l36.396">                 replyTo: &quot;no-reply@example.net&quot;,</span>
<a href="#l36.397"></a><span id="l36.397">                 organization: &quot;Example Net&quot;,</span>
<a href="#l36.398"></a><span id="l36.398">                 cc: &quot;cc@example.net&quot;,</span>
<a href="#l36.399"></a><span id="l36.399" class="difflineminus">-                bcc: &quot;bcc@example.net&quot;}},</span>
<a href="#l36.400"></a><span id="l36.400" class="difflineplus">+                bcc: &quot;bcc@example.net&quot;</span>
<a href="#l36.401"></a><span id="l36.401" class="difflineplus">+            }</span>
<a href="#l36.402"></a><span id="l36.402" class="difflineplus">+        },</span>
<a href="#l36.403"></a><span id="l36.403">         expected: &quot;MIME-version: 1.0\r\n&quot; +</span>
<a href="#l36.404"></a><span id="l36.404">                   &quot;Return-path: no-reply@example.net\r\n&quot; +</span>
<a href="#l36.405"></a><span id="l36.405">                   &quot;From: Invitation sender &lt;sender@example.net&gt;\r\n&quot; +</span>
<a href="#l36.406"></a><span id="l36.406">                   &quot;Organization: Example Net\r\n&quot; +</span>
<a href="#l36.407"></a><span id="l36.407">                   &quot;To: recipient@example.net\r\n&quot; +</span>
<a href="#l36.408"></a><span id="l36.408">                   &quot;Subject: Invitation: test subject\r\n&quot; +</span>
<a href="#l36.409"></a><span id="l36.409">                   &quot;Cc: cc@example.net\r\n&quot; +</span>
<a href="#l36.410"></a><span id="l36.410">                   &quot;Bcc: bcc@example.net\r\n&quot;</span>
<a href="#l36.411"></a><span id="l36.411" class="difflineat">@@ -504,46 +556,52 @@ add_task(function* getHeaderSection_test</span>
<a href="#l36.412"></a><span id="l36.412">             toList: &quot;rec1@example.net, Recipient 2 &lt;rec2@example.net&gt;, \&quot;Rec, 3\&quot; &lt;rec3@example.net&gt;&quot;,</span>
<a href="#l36.413"></a><span id="l36.413">             subject: &quot;Invitation: test subject&quot;,</span>
<a href="#l36.414"></a><span id="l36.414">             identity: {</span>
<a href="#l36.415"></a><span id="l36.415">                 fullName: &quot;\&quot;invitation, sender\&quot;&quot;,</span>
<a href="#l36.416"></a><span id="l36.416">                 email: &quot;sender@example.net&quot;,</span>
<a href="#l36.417"></a><span id="l36.417">                 replyTo: &quot;no-reply@example.net&quot;,</span>
<a href="#l36.418"></a><span id="l36.418">                 organization: &quot;Example Net&quot;,</span>
<a href="#l36.419"></a><span id="l36.419">                 cc: &quot;cc1@example.net, Cc 2 &lt;cc2@example.net&gt;, \&quot;Cc, 3\&quot; &lt;cc3@example.net&gt;&quot;,</span>
<a href="#l36.420"></a><span id="l36.420" class="difflineminus">-                bcc: &quot;bcc1@example.net, BCc 2 &lt;bcc2@example.net&gt;, \&quot;Bcc, 3\&quot; &lt;bcc3@example.net&gt;&quot;}},</span>
<a href="#l36.421"></a><span id="l36.421" class="difflineplus">+                bcc: &quot;bcc1@example.net, BCc 2 &lt;bcc2@example.net&gt;, \&quot;Bcc, 3\&quot; &lt;bcc3@example.net&gt;&quot;</span>
<a href="#l36.422"></a><span id="l36.422" class="difflineplus">+            }</span>
<a href="#l36.423"></a><span id="l36.423" class="difflineplus">+        },</span>
<a href="#l36.424"></a><span id="l36.424">         expected: &quot;MIME-version: 1.0\r\n&quot; +</span>
<a href="#l36.425"></a><span id="l36.425">                   &quot;Return-path: no-reply@example.net\r\n&quot; +</span>
<a href="#l36.426"></a><span id="l36.426">                   &quot;From: \&quot;invitation, sender\&quot; &lt;sender@example.net&gt;\r\n&quot; +</span>
<a href="#l36.427"></a><span id="l36.427">                   &quot;Organization: Example Net\r\n&quot; +</span>
<a href="#l36.428"></a><span id="l36.428">                   &quot;To: rec1@example.net, Recipient 2 &lt;rec2@example.net&gt;,\r\n \&quot;Rec, 3\&quot; &lt;rec3@example.net&gt;\r\n&quot; +</span>
<a href="#l36.429"></a><span id="l36.429">                   &quot;Subject: Invitation: test subject\r\n&quot; +</span>
<a href="#l36.430"></a><span id="l36.430">                   &quot;Cc: cc1@example.net, Cc 2 &lt;cc2@example.net&gt;, \&quot;Cc, 3\&quot; &lt;cc3@example.net&gt;\r\n&quot; +</span>
<a href="#l36.431"></a><span id="l36.431">                   &quot;Bcc: bcc1@example.net, BCc 2 &lt;bcc2@example.net&gt;, \&quot;Bcc, 3\&quot;\r\n &lt;bcc3@example.net&gt;\r\n&quot;</span>
<a href="#l36.432"></a><span id="l36.432">     }, {</span>
<a href="#l36.433"></a><span id="l36.433">         input: {</span>
<a href="#l36.434"></a><span id="l36.434">             toList: &quot;recipient@example.net&quot;,</span>
<a href="#l36.435"></a><span id="l36.435">             subject: &quot;Invitation: test subject&quot;,</span>
<a href="#l36.436"></a><span id="l36.436">             identity: {</span>
<a href="#l36.437"></a><span id="l36.437" class="difflineminus">-                email: &quot;sender@example.net&quot;}},</span>
<a href="#l36.438"></a><span id="l36.438" class="difflineplus">+                email: &quot;sender@example.net&quot;</span>
<a href="#l36.439"></a><span id="l36.439" class="difflineplus">+            }</span>
<a href="#l36.440"></a><span id="l36.440" class="difflineplus">+        },</span>
<a href="#l36.441"></a><span id="l36.441">         expected: &quot;MIME-version: 1.0\r\n&quot; +</span>
<a href="#l36.442"></a><span id="l36.442">                   &quot;From: sender@example.net\r\n&quot; +</span>
<a href="#l36.443"></a><span id="l36.443">                   &quot;To: recipient@example.net\r\n&quot; +</span>
<a href="#l36.444"></a><span id="l36.444">                   &quot;Subject: Invitation: test subject\r\n&quot;</span>
<a href="#l36.445"></a><span id="l36.445">     }, {</span>
<a href="#l36.446"></a><span id="l36.446">         input: {</span>
<a href="#l36.447"></a><span id="l36.447">             toList: &quot;Max Mller &lt;mueller@example.net&gt;&quot;,</span>
<a href="#l36.448"></a><span id="l36.448">             subject: &quot;Invitation: Diacritis check ()&quot;,</span>
<a href="#l36.449"></a><span id="l36.449">             identity: {</span>
<a href="#l36.450"></a><span id="l36.450">                 fullName: &quot;Ren&quot;,</span>
<a href="#l36.451"></a><span id="l36.451">                 email: &quot;sender@example.net&quot;,</span>
<a href="#l36.452"></a><span id="l36.452">                 replyTo: &quot;Max &amp; Ren &lt;no-reply@example.net&gt;&quot;,</span>
<a href="#l36.453"></a><span id="l36.453">                 organization: &quot;Max &amp; Ren&quot;,</span>
<a href="#l36.454"></a><span id="l36.454">                 cc: &quot;Ren &lt;cc@example.net&gt;&quot;,</span>
<a href="#l36.455"></a><span id="l36.455" class="difflineminus">-                bcc: &quot;Ren &lt;bcc@example.net&gt;&quot;}},</span>
<a href="#l36.456"></a><span id="l36.456" class="difflineplus">+                bcc: &quot;Ren &lt;bcc@example.net&gt;&quot;</span>
<a href="#l36.457"></a><span id="l36.457" class="difflineplus">+            }</span>
<a href="#l36.458"></a><span id="l36.458" class="difflineplus">+        },</span>
<a href="#l36.459"></a><span id="l36.459">         expected: &quot;MIME-version: 1.0\r\n&quot; +</span>
<a href="#l36.460"></a><span id="l36.460">                   &quot;Return-path: =?UTF-8?Q?Max_&amp;_Ren=c3=a9?= &lt;no-reply@example.net&gt;\r\n&quot; +</span>
<a href="#l36.461"></a><span id="l36.461">                   &quot;From: =?UTF-8?B?UmVuw6k=?= &lt;sender@example.net&gt;\r\n&quot; +</span>
<a href="#l36.462"></a><span id="l36.462">                   &quot;Organization: =?UTF-8?Q?Max_&amp;_Ren=c3=a9?=\r\n&quot; +</span>
<a href="#l36.463"></a><span id="l36.463">                   &quot;To: =?UTF-8?Q?Max_M=c3=bcller?= &lt;mueller@example.net&gt;\r\n&quot; +</span>
<a href="#l36.464"></a><span id="l36.464">                   &quot;Subject: =?UTF-8?Q?Invitation:_Diacritis_check_=28=c3=bc=c3=a4?=\r\n =?UTF-8?B&quot; +</span>
<a href="#l36.465"></a><span id="l36.465">                   &quot;?w6kp?=\r\n&quot; +</span>
<a href="#l36.466"></a><span id="l36.466">                   &quot;Cc: =?UTF-8?B?UmVuw6k=?= &lt;cc@example.net&gt;\r\n&quot; +</span>
<a href="#l36.467"></a><span id="l36.467" class="difflineat">@@ -580,32 +638,36 @@ add_task(function* getHeaderSection_test</span>
<a href="#l36.468"></a><span id="l36.468">               &quot;(test #&quot; + i + &quot;): all headers&quot;);</span>
<a href="#l36.469"></a><span id="l36.469">     }</span>
<a href="#l36.470"></a><span id="l36.470"> });</span>
<a href="#l36.471"></a><span id="l36.471"> </span>
<a href="#l36.472"></a><span id="l36.472"> add_task(function* convertFromUnicode_test() {</span>
<a href="#l36.473"></a><span id="l36.473">     let data = [{</span>
<a href="#l36.474"></a><span id="l36.474">         input: {</span>
<a href="#l36.475"></a><span id="l36.475">             charset: &quot;UTF-8&quot;,</span>
<a href="#l36.476"></a><span id="l36.476" class="difflineminus">-            text: &quot;mller&quot;},</span>
<a href="#l36.477"></a><span id="l36.477" class="difflineplus">+            text: &quot;mller&quot;</span>
<a href="#l36.478"></a><span id="l36.478" class="difflineplus">+        },</span>
<a href="#l36.479"></a><span id="l36.479">         expected: &quot;mller&quot;</span>
<a href="#l36.480"></a><span id="l36.480">     }, {</span>
<a href="#l36.481"></a><span id="l36.481">         input: {</span>
<a href="#l36.482"></a><span id="l36.482">             charset: &quot;UTF-8&quot;,</span>
<a href="#l36.483"></a><span id="l36.483" class="difflineminus">-            text: &quot;muller&quot;},</span>
<a href="#l36.484"></a><span id="l36.484" class="difflineplus">+            text: &quot;muller&quot;</span>
<a href="#l36.485"></a><span id="l36.485" class="difflineplus">+        },</span>
<a href="#l36.486"></a><span id="l36.486">         expected: &quot;muller&quot;</span>
<a href="#l36.487"></a><span id="l36.487">     }, {</span>
<a href="#l36.488"></a><span id="l36.488">         input: {</span>
<a href="#l36.489"></a><span id="l36.489">             charset: &quot;UTF-8&quot;,</span>
<a href="#l36.490"></a><span id="l36.490" class="difflineminus">-            text: &quot;mller\nmller&quot;},</span>
<a href="#l36.491"></a><span id="l36.491" class="difflineplus">+            text: &quot;mller\nmller&quot;</span>
<a href="#l36.492"></a><span id="l36.492" class="difflineplus">+        },</span>
<a href="#l36.493"></a><span id="l36.493">         expected: &quot;mller\nmller&quot;</span>
<a href="#l36.494"></a><span id="l36.494">     }, {</span>
<a href="#l36.495"></a><span id="l36.495">         input: {</span>
<a href="#l36.496"></a><span id="l36.496">             charset: &quot;UTF-8&quot;,</span>
<a href="#l36.497"></a><span id="l36.497" class="difflineminus">-            text: &quot;mller\r\nmller&quot;},</span>
<a href="#l36.498"></a><span id="l36.498" class="difflineplus">+            text: &quot;mller\r\nmller&quot;</span>
<a href="#l36.499"></a><span id="l36.499" class="difflineplus">+        },</span>
<a href="#l36.500"></a><span id="l36.500">         expected: &quot;mller\r\nmller&quot;</span>
<a href="#l36.501"></a><span id="l36.501">     }];</span>
<a href="#l36.502"></a><span id="l36.502">     let i = 0;</span>
<a href="#l36.503"></a><span id="l36.503">     for (let test of data) {</span>
<a href="#l36.504"></a><span id="l36.504">         i++;</span>
<a href="#l36.505"></a><span id="l36.505">         equal(ltn.invitation.convertFromUnicode(test.input.charset, test.input.text), test.expected,</span>
<a href="#l36.506"></a><span id="l36.506">               &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l36.507"></a><span id="l36.507">     }</span>
<a href="#l36.508"></a><span id="l36.508" class="difflineat">@@ -635,27 +697,30 @@ add_task(function* encodeUTF8_test() {</span>
<a href="#l36.509"></a><span id="l36.509">               &quot;(test #&quot; + i + &quot;)&quot;);</span>
<a href="#l36.510"></a><span id="l36.510">     }</span>
<a href="#l36.511"></a><span id="l36.511"> });</span>
<a href="#l36.512"></a><span id="l36.512"> </span>
<a href="#l36.513"></a><span id="l36.513"> add_task(function* encodeMimeHeader_test() {</span>
<a href="#l36.514"></a><span id="l36.514">     let data = [{</span>
<a href="#l36.515"></a><span id="l36.515">         input: {</span>
<a href="#l36.516"></a><span id="l36.516">             header: &quot;Max Mller &lt;m.mueller@example.net&gt;&quot;,</span>
<a href="#l36.517"></a><span id="l36.517" class="difflineminus">-            isEmail: true},</span>
<a href="#l36.518"></a><span id="l36.518" class="difflineplus">+            isEmail: true</span>
<a href="#l36.519"></a><span id="l36.519" class="difflineplus">+        },</span>
<a href="#l36.520"></a><span id="l36.520">         expected: &quot;=?UTF-8?Q?Max_M=c3=bcller?= &lt;m.mueller@example.net&gt;&quot;</span>
<a href="#l36.521"></a><span id="l36.521">     }, {</span>
<a href="#l36.522"></a><span id="l36.522">         input: {</span>
<a href="#l36.523"></a><span id="l36.523">             header: &quot;Max Mueller &lt;m.mueller@example.net&gt;&quot;,</span>
<a href="#l36.524"></a><span id="l36.524" class="difflineminus">-            isEmail: true},</span>
<a href="#l36.525"></a><span id="l36.525" class="difflineplus">+            isEmail: true</span>
<a href="#l36.526"></a><span id="l36.526" class="difflineplus">+        },</span>
<a href="#l36.527"></a><span id="l36.527">         expected: &quot;Max Mueller &lt;m.mueller@example.net&gt;&quot;</span>
<a href="#l36.528"></a><span id="l36.528">     }, {</span>
<a href="#l36.529"></a><span id="l36.529">         input: {</span>
<a href="#l36.530"></a><span id="l36.530">             header: &quot;Mller &amp; Mller&quot;,</span>
<a href="#l36.531"></a><span id="l36.531" class="difflineminus">-            isEmail: false},</span>
<a href="#l36.532"></a><span id="l36.532" class="difflineplus">+            isEmail: false</span>
<a href="#l36.533"></a><span id="l36.533" class="difflineplus">+        },</span>
<a href="#l36.534"></a><span id="l36.534">         expected: &quot;=?UTF-8?B?TcO8bGxlciAmIE3DvGxsZXI=?=&quot;</span>
<a href="#l36.535"></a><span id="l36.535">     }];</span>
<a href="#l36.536"></a><span id="l36.536"> </span>
<a href="#l36.537"></a><span id="l36.537">     let i = 0;</span>
<a href="#l36.538"></a><span id="l36.538">     for (let test of data) {</span>
<a href="#l36.539"></a><span id="l36.539">         i++;</span>
<a href="#l36.540"></a><span id="l36.540">         equal(ltn.invitation.encodeMimeHeader(test.input.header, test.input.isEmail), test.expected,</span>
<a href="#l36.541"></a><span id="l36.541">               &quot;(test #&quot; + i + &quot;)&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/test/unit/test_search_service.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/test/unit/test_search_service.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -93,20 +93,20 @@ function test_failure() {</span>
<a href="#l37.4"></a><span id="l37.4"> }</span>
<a href="#l37.5"></a><span id="l37.5"> </span>
<a href="#l37.6"></a><span id="l37.6"> function test_cancel() {</span>
<a href="#l37.7"></a><span id="l37.7">     search.getProviders({}).forEach(search.removeProvider, search);</span>
<a href="#l37.8"></a><span id="l37.8"> </span>
<a href="#l37.9"></a><span id="l37.9">     let provider = {</span>
<a href="#l37.10"></a><span id="l37.10">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calICalendarSearchProvider, Components.interfaces.calIOperation]),</span>
<a href="#l37.11"></a><span id="l37.11">         searchForCalendars: function(aStr, aHint, aMax, aListener) {</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-            Services.tm.currentThread.dispatch({run: function() {</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+            Services.tm.currentThread.dispatch({ run: function() {</span>
<a href="#l37.14"></a><span id="l37.14">                 dump(&quot;Cancelling search...&quot;);</span>
<a href="#l37.15"></a><span id="l37.15">                 op.cancel();</span>
<a href="#l37.16"></a><span id="l37.16" class="difflineminus">-            }}, Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l37.17"></a><span id="l37.17" class="difflineplus">+            } }, Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l37.18"></a><span id="l37.18"> </span>
<a href="#l37.19"></a><span id="l37.19">             // No listener call, we emulate a long running search</span>
<a href="#l37.20"></a><span id="l37.20">             // Do return the operation though</span>
<a href="#l37.21"></a><span id="l37.21">             return this;</span>
<a href="#l37.22"></a><span id="l37.22">         },</span>
<a href="#l37.23"></a><span id="l37.23"> </span>
<a href="#l37.24"></a><span id="l37.24">         isPending: true,</span>
<a href="#l37.25"></a><span id="l37.25">         cancelCalled: false,</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

