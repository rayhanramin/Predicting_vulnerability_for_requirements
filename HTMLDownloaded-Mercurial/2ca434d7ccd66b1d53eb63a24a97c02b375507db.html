<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 11359:2ca434d7ccd66b1d53eb63a24a97c02b375507db</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 2ca434d7ccd66b1d53eb63a24a97c02b375507db" />
<meta property="og:url" content="/comm-central/rev/2ca434d7ccd66b1d53eb63a24a97c02b375507db" />
<meta property="og:description" content="Bug 792735 Remove calls to nsICacheSession::openCacheEntry r=IanN" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 2ca434d7ccd66b1d53eb63a24a97c02b375507db 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/2ca434d7ccd66b1d53eb63a24a97c02b375507db">shortlog</a> |
<a href="/comm-central/log/2ca434d7ccd66b1d53eb63a24a97c02b375507db">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/2ca434d7ccd66b1d53eb63a24a97c02b375507db">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/2ca434d7ccd66b1d53eb63a24a97c02b375507db">files</a> |
changeset |
<a href="/comm-central/raw-rev/2ca434d7ccd66b1d53eb63a24a97c02b375507db">raw</a>  | <a href="/comm-central/archive/2ca434d7ccd66b1d53eb63a24a97c02b375507db.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=792735">Bug 792735</a> Remove calls to nsICacheSession::openCacheEntry r=IanN
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#78;&#101;&#105;&#108;&#32;&#82;&#97;&#115;&#104;&#98;&#114;&#111;&#111;&#107;&#32;&#60;&#110;&#101;&#105;&#108;&#64;&#112;&#97;&#114;&#107;&#119;&#97;&#121;&#99;&#99;&#46;&#99;&#111;&#46;&#117;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 23 Oct 2012 22:20:55 +0100</td></tr>

<tr>
 <td>changeset 11359</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/2ca434d7ccd66b1d53eb63a24a97c02b375507db">2ca434d7ccd66b1d53eb63a24a97c02b375507db</a></td>
</tr>



<tr>
<td>parent 11358</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b34e0bc265fcd5ad92b7141cc2d1dbc4039c323d">b34e0bc265fcd5ad92b7141cc2d1dbc4039c323d</a>
</td>
</tr>

<tr>
<td>child 11360</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e">cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=2ca434d7ccd66b1d53eb63a24a97c02b375507db">8496</a></td></tr>
<tr><td>push user</td><td>neil@parkwaycc.co.uk</td></tr>
<tr><td>push date</td><td class="date age">Tue, 23 Oct 2012 21:22:38 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@cb0c2eab4492 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e&newProject=comm-central&newRevision=2ca434d7ccd66b1d53eb63a24a97c02b375507db&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e&newProject=comm-central&newRevision=2ca434d7ccd66b1d53eb63a24a97c02b375507db&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb0c2eab4492457d49c02d2bfd8f1ed3c40b720e&newProject=comm-central&newRevision=2ca434d7ccd66b1d53eb63a24a97c02b375507db&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28IanN%29&revcount=50">IanN</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=792735">792735</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=792735">Bug 792735</a> Remove calls to nsICacheSession::openCacheEntry r=IanN</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.js">suite/browser/metadata.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.js">file</a> |
<a href="/comm-central/annotate/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.js">annotate</a> |
<a href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.js">diff</a> |
<a href="/comm-central/comparison/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.js">comparison</a> |
<a href="/comm-central/log/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.xul">suite/browser/metadata.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.xul">file</a> |
<a href="/comm-central/annotate/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.xul">annotate</a> |
<a href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.xul">diff</a> |
<a href="/comm-central/comparison/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.xul">comparison</a> |
<a href="/comm-central/log/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/metadata.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/pageinfo/pageInfo.js">suite/browser/pageinfo/pageInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/pageinfo/pageInfo.js">file</a> |
<a href="/comm-central/annotate/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/pageinfo/pageInfo.js">annotate</a> |
<a href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/pageinfo/pageInfo.js">diff</a> |
<a href="/comm-central/comparison/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/pageinfo/pageInfo.js">comparison</a> |
<a href="/comm-central/log/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/pageinfo/pageInfo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/tabbrowser.xml">suite/browser/tabbrowser.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/tabbrowser.xml">file</a> |
<a href="/comm-central/annotate/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/tabbrowser.xml">annotate</a> |
<a href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/tabbrowser.xml">diff</a> |
<a href="/comm-central/comparison/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/tabbrowser.xml">comparison</a> |
<a href="/comm-central/log/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/browser/tabbrowser.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/locales/en-US/chrome/browser/metadata.dtd">suite/locales/en-US/chrome/browser/metadata.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/locales/en-US/chrome/browser/metadata.dtd">file</a> |
<a href="/comm-central/annotate/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/locales/en-US/chrome/browser/metadata.dtd">annotate</a> |
<a href="/comm-central/diff/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/locales/en-US/chrome/browser/metadata.dtd">diff</a> |
<a href="/comm-central/comparison/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/locales/en-US/chrome/browser/metadata.dtd">comparison</a> |
<a href="/comm-central/log/2ca434d7ccd66b1d53eb63a24a97c02b375507db/suite/locales/en-US/chrome/browser/metadata.dtd">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/browser/metadata.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/browser/metadata.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -19,24 +19,18 @@ var onLink   = false;</span>
<a href="#l1.4"></a><span id="l1.4"> var onImage  = false;</span>
<a href="#l1.5"></a><span id="l1.5"> var onInsDel = false;</span>
<a href="#l1.6"></a><span id="l1.6"> var onQuote  = false;</span>
<a href="#l1.7"></a><span id="l1.7"> var onMisc   = false;</span>
<a href="#l1.8"></a><span id="l1.8"> var onTable  = false;</span>
<a href="#l1.9"></a><span id="l1.9"> var onTitle  = false;</span>
<a href="#l1.10"></a><span id="l1.10"> var onLang   = false;</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+const nsICache = Components.interfaces.nsICache;</span>
<a href="#l1.13"></a><span id="l1.13"> const nsICacheService = Components.interfaces.nsICacheService;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-const cacheService = Components.classes[&quot;@mozilla.org/network/cache-service;1&quot;]</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-                     .getService(nsICacheService);</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-var httpCacheSession = cacheService.createSession(&quot;HTTP&quot;, 0, true);</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-httpCacheSession.doomEntriesIfExpired = false;</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-var ftpCacheSession = cacheService.createSession(&quot;FTP&quot;, 0, true);</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-ftpCacheSession.doomEntriesIfExpired = false;</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22"> function onLoad()</span>
<a href="#l1.23"></a><span id="l1.23"> {</span>
<a href="#l1.24"></a><span id="l1.24">     gMetadataBundle = document.getElementById(&quot;bundle_metadata&quot;);</span>
<a href="#l1.25"></a><span id="l1.25">     gLangBundle = document.getElementById(&quot;bundle_languages&quot;);</span>
<a href="#l1.26"></a><span id="l1.26">     gRegionBundle = document.getElementById(&quot;bundle_regions&quot;);</span>
<a href="#l1.27"></a><span id="l1.27">     </span>
<a href="#l1.28"></a><span id="l1.28">     showMetadataFor(window.arguments[0]);</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineat">@@ -103,16 +97,29 @@ function showMetadataFor(elem)</span>
<a href="#l1.30"></a><span id="l1.30"> </span>
<a href="#l1.31"></a><span id="l1.31">     // Get rid of the &quot;No properties&quot; message. This is a backstop -</span>
<a href="#l1.32"></a><span id="l1.32">     // it should really never show, as long as nsContextMenu.js's</span>
<a href="#l1.33"></a><span id="l1.33">     // checking doesn't get broken.</span>
<a href="#l1.34"></a><span id="l1.34">     if (onLink || onImage || onInsDel || onQuote || onMisc)</span>
<a href="#l1.35"></a><span id="l1.35">         hideNode(&quot;no-properties&quot;)</span>
<a href="#l1.36"></a><span id="l1.36"> }</span>
<a href="#l1.37"></a><span id="l1.37"> </span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+var cacheListener = {</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+    onCacheEntryAvailable: function onCacheEntryAvailable(descriptor) {</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+        if (descriptor) {</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineplus">+            var kbSize = descriptor.dataSize / 1024;</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineplus">+            kbSize = Math.round(kbSize * 100) / 100;</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineplus">+            setInfo(&quot;image-filesize&quot;, gMetadataBundle.getFormattedString(&quot;imageSize&quot;,</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineplus">+                                                                         [formatNumber(kbSize),</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+                                                                          formatNumber(descriptor.dataSize)]));</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineplus">+        } else {</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineplus">+            setInfo(&quot;image-filesize&quot;, gMetadataBundle.getString(&quot;imageSizeUnknown&quot;));</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineplus">+        }</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineplus">+    }</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineplus">+};</span>
<a href="#l1.51"></a><span id="l1.51"> </span>
<a href="#l1.52"></a><span id="l1.52"> function checkForImage(elem, htmllocalname)</span>
<a href="#l1.53"></a><span id="l1.53"> {</span>
<a href="#l1.54"></a><span id="l1.54">     var img;</span>
<a href="#l1.55"></a><span id="l1.55">     var imgType;   // &quot;img&quot; = &lt;img&gt;</span>
<a href="#l1.56"></a><span id="l1.56">                    // &quot;object&quot; = &lt;object&gt;</span>
<a href="#l1.57"></a><span id="l1.57">                    // &quot;input&quot; = &lt;input type=image&gt;</span>
<a href="#l1.58"></a><span id="l1.58">                    // &quot;background&quot; = css background (to be added later)</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineat">@@ -152,27 +159,23 @@ function checkForImage(elem, htmllocalna</span>
<a href="#l1.60"></a><span id="l1.60">         }</span>
<a href="#l1.61"></a><span id="l1.61"> </span>
<a href="#l1.62"></a><span id="l1.62">     }</span>
<a href="#l1.63"></a><span id="l1.63"> </span>
<a href="#l1.64"></a><span id="l1.64">     if (img) {</span>
<a href="#l1.65"></a><span id="l1.65"> </span>
<a href="#l1.66"></a><span id="l1.66">         var imgURL = imgType == &quot;object&quot; ? img.data : img.src;</span>
<a href="#l1.67"></a><span id="l1.67">         setInfo(&quot;image-url&quot;, imgURL);</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineminus">-        var size = getSize(imgURL);</span>
<a href="#l1.69"></a><span id="l1.69"> </span>
<a href="#l1.70"></a><span id="l1.70" class="difflineminus">-        if (size != -1) {</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineminus">-            var kbSize = size / 1024;</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineminus">-            kbSize = Math.round(kbSize*100)/100;</span>
<a href="#l1.73"></a><span id="l1.73" class="difflineminus">-            setInfo(&quot;image-filesize&quot;, gMetadataBundle.getFormattedString(&quot;imageSize&quot;,</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineminus">-                                                                         [formatNumber(kbSize),</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineminus">-                                                                          formatNumber(size)]));</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineminus">-        } else {</span>
<a href="#l1.77"></a><span id="l1.77" class="difflineminus">-            setInfo(&quot;image-filesize&quot;, gMetadataBundle.getString(&quot;imageSizeUnknown&quot;));</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineminus">-        }</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineplus">+        const cacheService = Components.classes[&quot;@mozilla.org/network/cache-service;1&quot;]</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+                                       .getService(nsICacheService);</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineplus">+        var httpCacheSession = cacheService.createSession(&quot;HTTP&quot;, nsICache.STORE_ANYWHERE, true);</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+        httpCacheSession.doomEntriesIfExpired = false;</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineplus">+        httpCacheSession.asyncOpenCacheEntry(imgURL, nsICache.ACCESS_READ, cacheListener);</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineplus">+</span>
<a href="#l1.85"></a><span id="l1.85">         if (&quot;width&quot; in img &amp;&amp; img.width != &quot;&quot;) {</span>
<a href="#l1.86"></a><span id="l1.86">             setInfo(&quot;image-width&quot;, gMetadataBundle.getFormattedString(&quot;imageWidth&quot;, [formatNumber(img.width)]));</span>
<a href="#l1.87"></a><span id="l1.87">             setInfo(&quot;image-height&quot;, gMetadataBundle.getFormattedString(&quot;imageHeight&quot;, [formatNumber(img.height)]));</span>
<a href="#l1.88"></a><span id="l1.88">         }</span>
<a href="#l1.89"></a><span id="l1.89">         else {</span>
<a href="#l1.90"></a><span id="l1.90">             setInfo(&quot;image-width&quot;, &quot;&quot;);</span>
<a href="#l1.91"></a><span id="l1.91">             setInfo(&quot;image-height&quot;, &quot;&quot;);</span>
<a href="#l1.92"></a><span id="l1.92">         }        </span>
<a href="#l1.93"></a><span id="l1.93" class="difflineat">@@ -481,35 +484,16 @@ function convertLanguageCode(abbr)</span>
<a href="#l1.94"></a><span id="l1.94">         result = gMetadataBundle.getFormattedString(&quot;languageRegionFormat&quot;,</span>
<a href="#l1.95"></a><span id="l1.95">                                                     [language, region]);</span>
<a href="#l1.96"></a><span id="l1.96">     } else {</span>
<a href="#l1.97"></a><span id="l1.97">         result = language;</span>
<a href="#l1.98"></a><span id="l1.98">     }</span>
<a href="#l1.99"></a><span id="l1.99">     return result;</span>
<a href="#l1.100"></a><span id="l1.100"> }</span>
<a href="#l1.101"></a><span id="l1.101"> </span>
<a href="#l1.102"></a><span id="l1.102" class="difflineminus">-// Returns the size of the URL in bytes; must be cached and therefore an HTTP or FTP URL</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineminus">-function getSize(url) {</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineminus">-    try</span>
<a href="#l1.105"></a><span id="l1.105" class="difflineminus">-    {</span>
<a href="#l1.106"></a><span id="l1.106" class="difflineminus">-        var cacheEntryDescriptor = httpCacheSession.openCacheEntry(url, Components.interfaces.nsICache.ACCESS_READ, false);</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineminus">-        if(cacheEntryDescriptor)</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineminus">-          return cacheEntryDescriptor.dataSize;</span>
<a href="#l1.109"></a><span id="l1.109" class="difflineminus">-    }</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineminus">-    catch(ex) {}</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineminus">-    try</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineminus">-    {</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineminus">-        cacheEntryDescriptor = ftpCacheSession.openCacheEntry(url, Components.interfaces.nsICache.ACCESS_READ, false);</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineminus">-        if (cacheEntryDescriptor)</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineminus">-            return cacheEntryDescriptor.dataSize;</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineminus">-    }</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-    catch(ex) {}</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineminus">-    return -1;</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineminus">-}</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineminus">-</span>
<a href="#l1.121"></a><span id="l1.121"> function setAlt(elem) {</span>
<a href="#l1.122"></a><span id="l1.122">     var altText = document.getElementById(&quot;image-alt-text&quot;);</span>
<a href="#l1.123"></a><span id="l1.123">     if (elem.hasAttribute(&quot;alt&quot;)) {</span>
<a href="#l1.124"></a><span id="l1.124">         if (elem.alt != &quot;&quot;) {</span>
<a href="#l1.125"></a><span id="l1.125">             altText.value = elem.alt;</span>
<a href="#l1.126"></a><span id="l1.126">             altText.setAttribute(&quot;style&quot;,&quot;font-style:inherit&quot;);</span>
<a href="#l1.127"></a><span id="l1.127">         } else {</span>
<a href="#l1.128"></a><span id="l1.128">             altText.value = gMetadataBundle.getString(&quot;altTextBlank&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/browser/metadata.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/browser/metadata.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -100,17 +100,17 @@</span>
<a href="#l2.4"></a><span id="l2.4">         &lt;row id=&quot;image-height&quot;&gt;</span>
<a href="#l2.5"></a><span id="l2.5">           &lt;separator orient=&quot;vertical&quot;/&gt;</span>
<a href="#l2.6"></a><span id="l2.6">           &lt;label value=&quot;&amp;image-height.label; &quot; control=&quot;image-height-text&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7">           &lt;textbox readonly=&quot;true&quot; id=&quot;image-height-text&quot;/&gt;</span>
<a href="#l2.8"></a><span id="l2.8">         &lt;/row&gt;</span>
<a href="#l2.9"></a><span id="l2.9"> 	&lt;row id=&quot;image-filesize&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10">           &lt;separator orient=&quot;vertical&quot;/&gt;</span>
<a href="#l2.11"></a><span id="l2.11">           &lt;label value=&quot;&amp;image-filesize.label; &quot; control=&quot;image-filesize-text&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-          &lt;textbox readonly=&quot;true&quot; id=&quot;image-filesize-text&quot;/&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+          &lt;textbox readonly=&quot;true&quot; id=&quot;image-filesize-text&quot; value=&quot;&amp;image-filesize.value;&quot;/&gt;</span>
<a href="#l2.14"></a><span id="l2.14"> 	&lt;/row&gt;</span>
<a href="#l2.15"></a><span id="l2.15">         &lt;row id=&quot;image-alt&quot;&gt;</span>
<a href="#l2.16"></a><span id="l2.16">           &lt;separator orient=&quot;vertical&quot;/&gt;</span>
<a href="#l2.17"></a><span id="l2.17">           &lt;label value=&quot;&amp;image-alt.label; &quot; control=&quot;image-alt-text&quot;/&gt;</span>
<a href="#l2.18"></a><span id="l2.18">           &lt;textbox readonly=&quot;true&quot; id=&quot;image-alt-text&quot;/&gt;</span>
<a href="#l2.19"></a><span id="l2.19">         &lt;/row&gt;</span>
<a href="#l2.20"></a><span id="l2.20">         &lt;row id=&quot;image-desc&quot;&gt;</span>
<a href="#l2.21"></a><span id="l2.21">           &lt;separator orient=&quot;vertical&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/browser/pageinfo/pageInfo.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/browser/pageinfo/pageInfo.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -152,16 +152,18 @@ var gDocument = null;</span>
<a href="#l3.4"></a><span id="l3.4"> const COL_IMAGE_ADDRESS = 0;</span>
<a href="#l3.5"></a><span id="l3.5"> const COL_IMAGE_TYPE    = 1;</span>
<a href="#l3.6"></a><span id="l3.6"> const COL_IMAGE_SIZE    = 2;</span>
<a href="#l3.7"></a><span id="l3.7"> const COL_IMAGE_ALT     = 3;</span>
<a href="#l3.8"></a><span id="l3.8"> const COL_IMAGE_COUNT   = 4;</span>
<a href="#l3.9"></a><span id="l3.9"> const COL_IMAGE_NODE    = 5;</span>
<a href="#l3.10"></a><span id="l3.10"> const COL_IMAGE_BG      = 6;</span>
<a href="#l3.11"></a><span id="l3.11"> const COL_IMAGE_SIZENUM = 7;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+const COL_IMAGE_DEVICE  = 8;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+const COL_IMAGE_MIME    = 9;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> // column number to copy from, second argument to pageInfoTreeView's constructor</span>
<a href="#l3.16"></a><span id="l3.16"> const COPYCOL_NONE = -1;</span>
<a href="#l3.17"></a><span id="l3.17"> const COPYCOL_META_CONTENT = 1;</span>
<a href="#l3.18"></a><span id="l3.18"> const COPYCOL_FORM_ACTION = 2;</span>
<a href="#l3.19"></a><span id="l3.19"> const COPYCOL_FIELD_VALUE = 3;</span>
<a href="#l3.20"></a><span id="l3.20"> const COPYCOL_LINK_ADDRESS = 1;</span>
<a href="#l3.21"></a><span id="l3.21"> const COPYCOL_IMAGE = COL_IMAGE_ADDRESS;</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -449,16 +451,29 @@ function showTab(id)</span>
<a href="#l3.23"></a><span id="l3.23">   selectedTab.focus();</span>
<a href="#l3.24"></a><span id="l3.24"> }</span>
<a href="#l3.25"></a><span id="l3.25"> </span>
<a href="#l3.26"></a><span id="l3.26"> function onClickMore()</span>
<a href="#l3.27"></a><span id="l3.27"> {</span>
<a href="#l3.28"></a><span id="l3.28">   showTab(&quot;securityTab&quot;);</span>
<a href="#l3.29"></a><span id="l3.29"> }</span>
<a href="#l3.30"></a><span id="l3.30"> </span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+var cacheListener = {</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+  onCacheEntryAvailable: function onCacheEntryAvailable(descriptor) {</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+    if (descriptor) {</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+      var pageSize = descriptor.dataSize;</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+      var kbSize = Math.round(pageSize / 1024 * 100) / 100;</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+      var sizeText = gBundle.getFormattedString(&quot;generalSize&quot;,</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+                                                [formatNumber(kbSize),</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+                                                 formatNumber(pageSize)]);</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineplus">+      setItemValue(&quot;sizetext&quot;, sizeText);</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+    }</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineplus">+  }</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+};</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineplus">+</span>
<a href="#l3.44"></a><span id="l3.44"> function makeGeneralTab()</span>
<a href="#l3.45"></a><span id="l3.45"> {</span>
<a href="#l3.46"></a><span id="l3.46">   var title = (gDocument.title) ? gBundle.getFormattedString(&quot;pageTitle&quot;, [gDocument.title]) : gBundle.getString(&quot;noPageTitle&quot;);</span>
<a href="#l3.47"></a><span id="l3.47">   document.getElementById(&quot;titletext&quot;).value = title;</span>
<a href="#l3.48"></a><span id="l3.48"> </span>
<a href="#l3.49"></a><span id="l3.49">   var url = gDocument.location.toString();</span>
<a href="#l3.50"></a><span id="l3.50">   setItemValue(&quot;urltext&quot;, url);</span>
<a href="#l3.51"></a><span id="l3.51"> </span>
<a href="#l3.52"></a><span id="l3.52" class="difflineat">@@ -491,36 +506,26 @@ function makeGeneralTab()</span>
<a href="#l3.53"></a><span id="l3.53">   for (var i = 0; i &lt; length; i++)</span>
<a href="#l3.54"></a><span id="l3.54">     gMetaView.addRow([metaNodes[i].name || metaNodes[i].httpEquiv, metaNodes[i].content]);</span>
<a href="#l3.55"></a><span id="l3.55"> </span>
<a href="#l3.56"></a><span id="l3.56">   // get the date of last modification</span>
<a href="#l3.57"></a><span id="l3.57">   var modifiedText = formatDate(gDocument.lastModified, gStrings.notSet);</span>
<a href="#l3.58"></a><span id="l3.58">   document.getElementById(&quot;modifiedtext&quot;).value = modifiedText;</span>
<a href="#l3.59"></a><span id="l3.59"> </span>
<a href="#l3.60"></a><span id="l3.60">   // get cache info</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineplus">+  setItemValue(&quot;sizetext&quot;, null);</span>
<a href="#l3.62"></a><span id="l3.62">   var cacheKey = url.replace(/#.*$/, &quot;&quot;);</span>
<a href="#l3.63"></a><span id="l3.63">   try {</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-    var cacheEntryDescriptor = httpCacheSession.openCacheEntry(cacheKey, ACCESS_READ, false);</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-  }</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineminus">-  catch(ex) {</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineminus">-    try {</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineminus">-      cacheEntryDescriptor = ftpCacheSession.openCacheEntry(cacheKey, ACCESS_READ, false);</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineminus">-    }</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineminus">-    catch(ex2) { }</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+    httpCacheSession.asyncOpenCacheEntry(cacheKey, ACCESS_READ, cacheListener);</span>
<a href="#l3.72"></a><span id="l3.72">   }</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineminus">-</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineminus">-  var sizeText;</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineminus">-  if (cacheEntryDescriptor) {</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineminus">-    var pageSize = cacheEntryDescriptor.dataSize;</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineminus">-    var kbSize = Math.round(pageSize / 1024 * 100) / 100;</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineminus">-    sizeText = gBundle.getFormattedString(&quot;generalSize&quot;,</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineminus">-                                          [formatNumber(kbSize),</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-                                           formatNumber(pageSize)]);</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+  catch(ex) { }</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+  try {</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+    ftpCacheSession.asyncOpenCacheEntry(cacheKey, ACCESS_READ, cacheListener);</span>
<a href="#l3.84"></a><span id="l3.84">   }</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineminus">-  setItemValue(&quot;sizetext&quot;, sizeText);</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+  catch(ex) { }</span>
<a href="#l3.87"></a><span id="l3.87"> </span>
<a href="#l3.88"></a><span id="l3.88">   securityOnLoad();</span>
<a href="#l3.89"></a><span id="l3.89"> }</span>
<a href="#l3.90"></a><span id="l3.90"> </span>
<a href="#l3.91"></a><span id="l3.91"> //******** Generic Build-a-tab</span>
<a href="#l3.92"></a><span id="l3.92"> // Assumes the views are empty. Only called once to build the tabs, and</span>
<a href="#l3.93"></a><span id="l3.93"> // does so by farming the task off to another thread via setTimeout().</span>
<a href="#l3.94"></a><span id="l3.94"> // The actual work is done with a TreeWalker that calls doGrab() once for</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineat">@@ -571,61 +576,75 @@ function doGrab(iterator)</span>
<a href="#l3.96"></a><span id="l3.96"> function ensureSelection(view)</span>
<a href="#l3.97"></a><span id="l3.97"> {</span>
<a href="#l3.98"></a><span id="l3.98">   // only select something if nothing is currently selected</span>
<a href="#l3.99"></a><span id="l3.99">   // and if there's anything to select</span>
<a href="#l3.100"></a><span id="l3.100">   if (view.selection &amp;&amp; view.selection.count == 0 &amp;&amp; view.rowCount)</span>
<a href="#l3.101"></a><span id="l3.101">     view.selection.select(0);</span>
<a href="#l3.102"></a><span id="l3.102"> }</span>
<a href="#l3.103"></a><span id="l3.103"> </span>
<a href="#l3.104"></a><span id="l3.104" class="difflineminus">-function addImage(url, type, alt, elem, isBg)</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineplus">+function imgCacheListener(url, type, alt, elem, isBg)</span>
<a href="#l3.106"></a><span id="l3.106"> {</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineminus">-  if (!url)</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineminus">-    return;</span>
<a href="#l3.109"></a><span id="l3.109" class="difflineplus">+  this.url = url;</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineplus">+  this.type = type;</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineplus">+  this.alt = alt;</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineplus">+  this.elem = elem;</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineplus">+  this.isBg = isBg;</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineplus">+}</span>
<a href="#l3.115"></a><span id="l3.115" class="difflineplus">+</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineplus">+imgCacheListener.prototype.onCacheEntryAvailable =</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineplus">+function onCacheEntryAvailable(cacheEntryDescriptor) {</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineplus">+  var url = this.url;</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineplus">+  var type = this.type;</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineplus">+  var alt = this.alt;</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineplus">+  var elem = this.elem;</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineplus">+  var isBg = this.isBg;</span>
<a href="#l3.123"></a><span id="l3.123"> </span>
<a href="#l3.124"></a><span id="l3.124">   if (!gImageHash.hasOwnProperty(url))</span>
<a href="#l3.125"></a><span id="l3.125">     gImageHash[url] = { };</span>
<a href="#l3.126"></a><span id="l3.126">   if (!gImageHash[url].hasOwnProperty(type))</span>
<a href="#l3.127"></a><span id="l3.127">     gImageHash[url][type] = { };</span>
<a href="#l3.128"></a><span id="l3.128">   if (!gImageHash[url][type].hasOwnProperty(alt)) {</span>
<a href="#l3.129"></a><span id="l3.129">     gImageHash[url][type][alt] = gImageView.data.length;</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineminus">-    try {</span>
<a href="#l3.131"></a><span id="l3.131" class="difflineminus">-      // open for READ, in non-blocking mode</span>
<a href="#l3.132"></a><span id="l3.132" class="difflineminus">-      var cacheEntryDescriptor = httpCacheSession.openCacheEntry(url, ACCESS_READ, false);</span>
<a href="#l3.133"></a><span id="l3.133" class="difflineminus">-    }</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineminus">-    catch(ex) {</span>
<a href="#l3.135"></a><span id="l3.135" class="difflineminus">-      try {</span>
<a href="#l3.136"></a><span id="l3.136" class="difflineminus">-        // open for READ, in non-blocking mode</span>
<a href="#l3.137"></a><span id="l3.137" class="difflineminus">-        cacheEntryDescriptor = ftpCacheSession.openCacheEntry(url, ACCESS_READ, false);</span>
<a href="#l3.138"></a><span id="l3.138" class="difflineminus">-      }</span>
<a href="#l3.139"></a><span id="l3.139" class="difflineminus">-      catch(ex2) { }</span>
<a href="#l3.140"></a><span id="l3.140" class="difflineminus">-    }</span>
<a href="#l3.141"></a><span id="l3.141"> </span>
<a href="#l3.142"></a><span id="l3.142">     var sizeText;</span>
<a href="#l3.143"></a><span id="l3.143">     var pageSize;</span>
<a href="#l3.144"></a><span id="l3.144" class="difflineplus">+    var deviceID;</span>
<a href="#l3.145"></a><span id="l3.145" class="difflineplus">+    var mimeType;</span>
<a href="#l3.146"></a><span id="l3.146">     if (cacheEntryDescriptor) {</span>
<a href="#l3.147"></a><span id="l3.147" class="difflineplus">+      mimeType = getContentTypeFromHeaders(cacheEntryDescriptor);</span>
<a href="#l3.148"></a><span id="l3.148" class="difflineplus">+      deviceID = cacheEntryDescriptor.deviceID;</span>
<a href="#l3.149"></a><span id="l3.149">       pageSize = cacheEntryDescriptor.dataSize;</span>
<a href="#l3.150"></a><span id="l3.150">       var kbSize = Math.round(pageSize / 1024 * 100) / 100;</span>
<a href="#l3.151"></a><span id="l3.151">       sizeText = gBundle.getFormattedString(&quot;mediaFileSize&quot;, [formatNumber(kbSize)]);</span>
<a href="#l3.152"></a><span id="l3.152">     }</span>
<a href="#l3.153"></a><span id="l3.153">     else</span>
<a href="#l3.154"></a><span id="l3.154">       sizeText = gStrings.unknown;</span>
<a href="#l3.155"></a><span id="l3.155" class="difflineminus">-    gImageView.addRow([url, type, sizeText, alt, 1, elem, isBg, pageSize]);</span>
<a href="#l3.156"></a><span id="l3.156" class="difflineplus">+    gImageView.addRow([url, type, sizeText, alt, 1, elem, isBg, pageSize, deviceID, mimeType]);</span>
<a href="#l3.157"></a><span id="l3.157"> </span>
<a href="#l3.158"></a><span id="l3.158">     // Add the observer, only once.</span>
<a href="#l3.159"></a><span id="l3.159">     if (gImageView.data.length == 1) {</span>
<a href="#l3.160"></a><span id="l3.160">       Services.obs.addObserver(imagePermissionObserver, &quot;perm-changed&quot;, false);</span>
<a href="#l3.161"></a><span id="l3.161">     }</span>
<a href="#l3.162"></a><span id="l3.162">   }</span>
<a href="#l3.163"></a><span id="l3.163">   else {</span>
<a href="#l3.164"></a><span id="l3.164">     var i = gImageHash[url][type][alt];</span>
<a href="#l3.165"></a><span id="l3.165">     gImageView.data[i][COL_IMAGE_COUNT]++;</span>
<a href="#l3.166"></a><span id="l3.166">   }</span>
<a href="#l3.167"></a><span id="l3.167"> }</span>
<a href="#l3.168"></a><span id="l3.168"> </span>
<a href="#l3.169"></a><span id="l3.169" class="difflineplus">+function addImage(url, type, alt, elem, isBg)</span>
<a href="#l3.170"></a><span id="l3.170" class="difflineplus">+{</span>
<a href="#l3.171"></a><span id="l3.171" class="difflineplus">+  if (url) try {</span>
<a href="#l3.172"></a><span id="l3.172" class="difflineplus">+    var listener = new imgCacheListener(url, type, alt, elem, isBg);</span>
<a href="#l3.173"></a><span id="l3.173" class="difflineplus">+    httpCacheSession.asyncOpenCacheEntry(url, ACCESS_READ, listener);</span>
<a href="#l3.174"></a><span id="l3.174" class="difflineplus">+  }</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineplus">+  catch (ex) { }</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineplus">+}</span>
<a href="#l3.177"></a><span id="l3.177" class="difflineplus">+</span>
<a href="#l3.178"></a><span id="l3.178"> function grabAll(elem)</span>
<a href="#l3.179"></a><span id="l3.179"> {</span>
<a href="#l3.180"></a><span id="l3.180">   // check for background images, any node may have multiple</span>
<a href="#l3.181"></a><span id="l3.181">   var computedStyle = elem.ownerDocument.defaultView.getComputedStyle(elem, &quot;&quot;);</span>
<a href="#l3.182"></a><span id="l3.182">   if (computedStyle) {</span>
<a href="#l3.183"></a><span id="l3.183">     Array.forEach(computedStyle.getPropertyCSSValue(&quot;background-image&quot;), function (url) {</span>
<a href="#l3.184"></a><span id="l3.184">       if (url.primitiveType == CSSPrimitiveValue.CSS_URI)</span>
<a href="#l3.185"></a><span id="l3.185">         addImage(url.getStringValue(), gStrings.mediaBGImg, gStrings.notSet, elem, true);</span>
<a href="#l3.186"></a><span id="l3.186" class="difflineat">@@ -969,22 +988,17 @@ function onImageSelect()</span>
<a href="#l3.187"></a><span id="l3.187">     splitter.collapsed       = false;</span>
<a href="#l3.188"></a><span id="l3.188">     tree.flex = 0;</span>
<a href="#l3.189"></a><span id="l3.189">     makePreview(tree.view.selection.currentIndex);</span>
<a href="#l3.190"></a><span id="l3.190">   }</span>
<a href="#l3.191"></a><span id="l3.191"> }</span>
<a href="#l3.192"></a><span id="l3.192"> </span>
<a href="#l3.193"></a><span id="l3.193"> function makePreview(row)</span>
<a href="#l3.194"></a><span id="l3.194"> {</span>
<a href="#l3.195"></a><span id="l3.195" class="difflineminus">-  var imageTree = document.getElementById(&quot;imagetree&quot;);</span>
<a href="#l3.196"></a><span id="l3.196" class="difflineminus">-  var item = getSelectedImage(imageTree);</span>
<a href="#l3.197"></a><span id="l3.197" class="difflineminus">-  var col = imageTree.columns[&quot;image-address&quot;];</span>
<a href="#l3.198"></a><span id="l3.198" class="difflineminus">-  var url = gImageView.getCellText(row, col);</span>
<a href="#l3.199"></a><span id="l3.199" class="difflineminus">-  // image-bg</span>
<a href="#l3.200"></a><span id="l3.200" class="difflineminus">-  var isBG = gImageView.data[row][COL_IMAGE_BG];</span>
<a href="#l3.201"></a><span id="l3.201" class="difflineplus">+  var [url, type, sizeText, alt, count, item, isBG, pageSize, deviceID, cachedType] = gImageView.data[row];</span>
<a href="#l3.202"></a><span id="l3.202">   var isAudio = false;</span>
<a href="#l3.203"></a><span id="l3.203"> </span>
<a href="#l3.204"></a><span id="l3.204">   setItemValue(&quot;imageurltext&quot;, url);</span>
<a href="#l3.205"></a><span id="l3.205"> </span>
<a href="#l3.206"></a><span id="l3.206">   if (item.hasAttribute(&quot;title&quot;) &amp;&amp;</span>
<a href="#l3.207"></a><span id="l3.207">       !(item instanceof SVGImageElement))</span>
<a href="#l3.208"></a><span id="l3.208">     setItemValue(&quot;imagetitletext&quot;, item.title);</span>
<a href="#l3.209"></a><span id="l3.209">   else</span>
<a href="#l3.210"></a><span id="l3.210" class="difflineat">@@ -1002,75 +1016,50 @@ function makePreview(row)</span>
<a href="#l3.211"></a><span id="l3.211">     setItemValue(&quot;imagealttext&quot;, item.alt);</span>
<a href="#l3.212"></a><span id="l3.212">   else if (item instanceof HTMLImageElement || isBG)</span>
<a href="#l3.213"></a><span id="l3.213">     setItemValue(&quot;imagealttext&quot;, null);</span>
<a href="#l3.214"></a><span id="l3.214">   else</span>
<a href="#l3.215"></a><span id="l3.215">     setItemValue(&quot;imagealttext&quot;, getValueText(item));</span>
<a href="#l3.216"></a><span id="l3.216"> </span>
<a href="#l3.217"></a><span id="l3.217">   // get cache info</span>
<a href="#l3.218"></a><span id="l3.218">   var sourceText = gBundle.getString(&quot;generalNotCached&quot;);</span>
<a href="#l3.219"></a><span id="l3.219" class="difflineminus">-  var cacheKey = url.replace(/#.*$/, &quot;&quot;);</span>
<a href="#l3.220"></a><span id="l3.220" class="difflineminus">-  try {</span>
<a href="#l3.221"></a><span id="l3.221" class="difflineminus">-    // open for READ, in non-blocking mode</span>
<a href="#l3.222"></a><span id="l3.222" class="difflineminus">-    var cacheEntryDescriptor = httpCacheSession.openCacheEntry(cacheKey, ACCESS_READ, false);</span>
<a href="#l3.223"></a><span id="l3.223" class="difflineminus">-    if (cacheEntryDescriptor)</span>
<a href="#l3.224"></a><span id="l3.224" class="difflineminus">-      switch (cacheEntryDescriptor.deviceID) {</span>
<a href="#l3.225"></a><span id="l3.225" class="difflineminus">-        case &quot;disk&quot;:</span>
<a href="#l3.226"></a><span id="l3.226" class="difflineminus">-          sourceText = gBundle.getString(&quot;generalDiskCache&quot;);</span>
<a href="#l3.227"></a><span id="l3.227" class="difflineminus">-          break;</span>
<a href="#l3.228"></a><span id="l3.228" class="difflineminus">-        case &quot;memory&quot;:</span>
<a href="#l3.229"></a><span id="l3.229" class="difflineminus">-          sourceText = gBundle.getString(&quot;generalMemoryCache&quot;);</span>
<a href="#l3.230"></a><span id="l3.230" class="difflineminus">-          break;</span>
<a href="#l3.231"></a><span id="l3.231" class="difflineminus">-        default:</span>
<a href="#l3.232"></a><span id="l3.232" class="difflineminus">-          sourceText = cacheEntryDescriptor.deviceID;</span>
<a href="#l3.233"></a><span id="l3.233" class="difflineminus">-          break;</span>
<a href="#l3.234"></a><span id="l3.234" class="difflineminus">-      }</span>
<a href="#l3.235"></a><span id="l3.235" class="difflineminus">-  }</span>
<a href="#l3.236"></a><span id="l3.236" class="difflineminus">-  catch(ex) {</span>
<a href="#l3.237"></a><span id="l3.237" class="difflineminus">-    try {</span>
<a href="#l3.238"></a><span id="l3.238" class="difflineminus">-      // open for READ, in non-blocking mode</span>
<a href="#l3.239"></a><span id="l3.239" class="difflineminus">-      cacheEntryDescriptor = ftpCacheSession.openCacheEntry(cacheKey, ACCESS_READ, false);</span>
<a href="#l3.240"></a><span id="l3.240" class="difflineminus">-      if (cacheEntryDescriptor)</span>
<a href="#l3.241"></a><span id="l3.241" class="difflineminus">-        switch (cacheEntryDescriptor.deviceID) {</span>
<a href="#l3.242"></a><span id="l3.242" class="difflineminus">-          case &quot;disk&quot;:</span>
<a href="#l3.243"></a><span id="l3.243" class="difflineminus">-            sourceText = gBundle.getString(&quot;generalDiskCache&quot;);</span>
<a href="#l3.244"></a><span id="l3.244" class="difflineminus">-            break;</span>
<a href="#l3.245"></a><span id="l3.245" class="difflineminus">-          case &quot;memory&quot;:</span>
<a href="#l3.246"></a><span id="l3.246" class="difflineminus">-            sourceText = gBundle.getString(&quot;generalMemoryCache&quot;);</span>
<a href="#l3.247"></a><span id="l3.247" class="difflineminus">-            break;</span>
<a href="#l3.248"></a><span id="l3.248" class="difflineminus">-          default:</span>
<a href="#l3.249"></a><span id="l3.249" class="difflineminus">-            sourceText = cacheEntryDescriptor.deviceID;</span>
<a href="#l3.250"></a><span id="l3.250" class="difflineminus">-            break;</span>
<a href="#l3.251"></a><span id="l3.251" class="difflineminus">-        }</span>
<a href="#l3.252"></a><span id="l3.252" class="difflineplus">+  if (deviceID) {</span>
<a href="#l3.253"></a><span id="l3.253" class="difflineplus">+    switch (deviceID) {</span>
<a href="#l3.254"></a><span id="l3.254" class="difflineplus">+      case &quot;disk&quot;:</span>
<a href="#l3.255"></a><span id="l3.255" class="difflineplus">+        sourceText = gBundle.getString(&quot;generalDiskCache&quot;);</span>
<a href="#l3.256"></a><span id="l3.256" class="difflineplus">+        break;</span>
<a href="#l3.257"></a><span id="l3.257" class="difflineplus">+      case &quot;memory&quot;:</span>
<a href="#l3.258"></a><span id="l3.258" class="difflineplus">+        sourceText = gBundle.getString(&quot;generalMemoryCache&quot;);</span>
<a href="#l3.259"></a><span id="l3.259" class="difflineplus">+        break;</span>
<a href="#l3.260"></a><span id="l3.260" class="difflineplus">+      default:</span>
<a href="#l3.261"></a><span id="l3.261" class="difflineplus">+        sourceText = cacheEntryDescriptor.deviceID;</span>
<a href="#l3.262"></a><span id="l3.262" class="difflineplus">+        break;</span>
<a href="#l3.263"></a><span id="l3.263">     }</span>
<a href="#l3.264"></a><span id="l3.264" class="difflineminus">-    catch(ex2) { }</span>
<a href="#l3.265"></a><span id="l3.265">   }</span>
<a href="#l3.266"></a><span id="l3.266">   setItemValue(&quot;imagesourcetext&quot;, sourceText);</span>
<a href="#l3.267"></a><span id="l3.267"> </span>
<a href="#l3.268"></a><span id="l3.268">   // find out the file size</span>
<a href="#l3.269"></a><span id="l3.269" class="difflineminus">-  var sizeText;</span>
<a href="#l3.270"></a><span id="l3.270" class="difflineminus">-  if (cacheEntryDescriptor) {</span>
<a href="#l3.271"></a><span id="l3.271" class="difflineminus">-    var pageSize = cacheEntryDescriptor.dataSize;</span>
<a href="#l3.272"></a><span id="l3.272" class="difflineplus">+  if (pageSize) {</span>
<a href="#l3.273"></a><span id="l3.273">     var kbSize = Math.round(pageSize / 1024 * 100) / 100;</span>
<a href="#l3.274"></a><span id="l3.274">     sizeText = gBundle.getFormattedString(&quot;generalSize&quot;,</span>
<a href="#l3.275"></a><span id="l3.275">                                           [formatNumber(kbSize),</span>
<a href="#l3.276"></a><span id="l3.276">                                            formatNumber(pageSize)]);</span>
<a href="#l3.277"></a><span id="l3.277">   }</span>
<a href="#l3.278"></a><span id="l3.278">   setItemValue(&quot;imagesizetext&quot;, sizeText);</span>
<a href="#l3.279"></a><span id="l3.279"> </span>
<a href="#l3.280"></a><span id="l3.280">   var mimeType;</span>
<a href="#l3.281"></a><span id="l3.281">   var numFrames = 0;</span>
<a href="#l3.282"></a><span id="l3.282">   if (item instanceof HTMLObjectElement ||</span>
<a href="#l3.283"></a><span id="l3.283">       item instanceof HTMLEmbedElement ||</span>
<a href="#l3.284"></a><span id="l3.284">       item instanceof HTMLLinkElement)</span>
<a href="#l3.285"></a><span id="l3.285">     mimeType = item.type;</span>
<a href="#l3.286"></a><span id="l3.286">   if (!mimeType &amp;&amp; item instanceof nsIImageLoadingContent)</span>
<a href="#l3.287"></a><span id="l3.287">     [mimeType, numFrames] = getContentTypeFromImgRequest(item);</span>
<a href="#l3.288"></a><span id="l3.288">   if (!mimeType)</span>
<a href="#l3.289"></a><span id="l3.289" class="difflineminus">-    mimeType = getContentTypeFromHeaders(cacheEntryDescriptor);</span>
<a href="#l3.290"></a><span id="l3.290" class="difflineplus">+    mimeType = cachedType;</span>
<a href="#l3.291"></a><span id="l3.291"> </span>
<a href="#l3.292"></a><span id="l3.292">   // if we have a data url, get the MIME type from the url</span>
<a href="#l3.293"></a><span id="l3.293">   if (!mimeType) {</span>
<a href="#l3.294"></a><span id="l3.294">     var dataMimeType = /^data:(image\/.*?)[;,]/i.exec(url);</span>
<a href="#l3.295"></a><span id="l3.295">     if (dataMimeType)</span>
<a href="#l3.296"></a><span id="l3.296">       mimeType = dataMimeType[1].toLowerCase();</span>
<a href="#l3.297"></a><span id="l3.297">   }</span>
<a href="#l3.298"></a><span id="l3.298"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/suite/browser/tabbrowser.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/suite/browser/tabbrowser.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -102,17 +102,18 @@</span>
<a href="#l4.4"></a><span id="l4.4">                   .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l4.5"></a><span id="l4.5">       &lt;/field&gt;</span>
<a href="#l4.6"></a><span id="l4.6">       &lt;field name=&quot;mURIFixup&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l4.7"></a><span id="l4.7">         Components.classes[&quot;@mozilla.org/docshell/urifixup;1&quot;]</span>
<a href="#l4.8"></a><span id="l4.8">                   .getService(Components.interfaces.nsIURIFixup);</span>
<a href="#l4.9"></a><span id="l4.9">       &lt;/field&gt;</span>
<a href="#l4.10"></a><span id="l4.10">       &lt;field name=&quot;mFaviconService&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l4.11"></a><span id="l4.11">         Components.classes[&quot;@mozilla.org/browser/favicon-service;1&quot;]</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-                  .getService(Components.interfaces.nsIFaviconService);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+                  .getService(Components.interfaces.nsIFaviconService)</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+                  .QueryInterface(Components.interfaces.mozIAsyncFavicons);</span>
<a href="#l4.15"></a><span id="l4.15">       &lt;/field&gt;</span>
<a href="#l4.16"></a><span id="l4.16">       &lt;field name=&quot;mIOService&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l4.17"></a><span id="l4.17">         Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l4.18"></a><span id="l4.18">                   .getService(Components.interfaces.nsIIOService);</span>
<a href="#l4.19"></a><span id="l4.19">       &lt;/field&gt;</span>
<a href="#l4.20"></a><span id="l4.20">       &lt;field name=&quot;mTabBox&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l4.21"></a><span id="l4.21">         document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;tabbox&quot;);</span>
<a href="#l4.22"></a><span id="l4.22">       &lt;/field&gt;</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineat">@@ -771,62 +772,30 @@</span>
<a href="#l4.24"></a><span id="l4.24">         &lt;parameter name=&quot;aAttr&quot;/&gt;</span>
<a href="#l4.25"></a><span id="l4.25">         &lt;parameter name=&quot;aElt&quot;/&gt;</span>
<a href="#l4.26"></a><span id="l4.26">         &lt;body&gt;</span>
<a href="#l4.27"></a><span id="l4.27">           &lt;![CDATA[</span>
<a href="#l4.28"></a><span id="l4.28">             var iconURL = this.buildFavIconString(aURI);</span>
<a href="#l4.29"></a><span id="l4.29">             if (this.mFaviconService) {</span>
<a href="#l4.30"></a><span id="l4.30">               let uri = this.mIOService.newURI(iconURL, null, null);</span>
<a href="#l4.31"></a><span id="l4.31">               this.mFaviconService.setAndFetchFaviconForPage(aURI, uri, false, this.mFaviconService.FAVICON_LOAD_NON_PRIVATE);</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+              if (this.mFaviconService.isFailedFavicon(uri))</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+                return;</span>
<a href="#l4.34"></a><span id="l4.34">             }</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-            var entry = this.openCacheEntry(iconURL, Components.interfaces.nsICache.ACCESS_READ);</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineminus">-            if (!entry)</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineminus">-              aElt.setAttribute(aAttr, iconURL);</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-            else {</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-              entry.close();</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-              entry = null;</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-            }</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+            aElt.setAttribute(aAttr, iconURL);</span>
<a href="#l4.43"></a><span id="l4.43">           ]]&gt;</span>
<a href="#l4.44"></a><span id="l4.44">         &lt;/body&gt;</span>
<a href="#l4.45"></a><span id="l4.45">       &lt;/method&gt;</span>
<a href="#l4.46"></a><span id="l4.46"> </span>
<a href="#l4.47"></a><span id="l4.47">       &lt;method name=&quot;addToMissedIconCache&quot;&gt;</span>
<a href="#l4.48"></a><span id="l4.48">         &lt;parameter name=&quot;aURI&quot;/&gt;</span>
<a href="#l4.49"></a><span id="l4.49">         &lt;body&gt;</span>
<a href="#l4.50"></a><span id="l4.50">           &lt;![CDATA[</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-            var entry = this.openCacheEntry(aURI, Components.interfaces.nsICache.ACCESS_READ_WRITE);</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-            if (!entry)</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineminus">-              return;</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-            if (entry.accessGranted == Components.interfaces.nsICache.ACCESS_WRITE)</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineminus">-              // It's a new entry.  Just write a bit of metadata in to the entry.</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineminus">-              entry.setMetaDataElement(&quot;Icon&quot;, &quot;Missed&quot;);</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineminus">-            entry.markValid();</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineminus">-            entry.close();</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineminus">-          ]]&gt;</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineminus">-</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineminus">-      &lt;method name=&quot;openCacheEntry&quot;&gt;</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineminus">-        &lt;parameter name=&quot;key&quot;/&gt;</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineminus">-        &lt;parameter name=&quot;access&quot;/&gt;</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-            try {</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-              if (!this.mMissedIconCache) {</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-                var cacheService = Components.classes['@mozilla.org/network/cache-service;1'].getService(Components.interfaces.nsICacheService);</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-                this.mMissedIconCache = cacheService.createSession(&quot;MissedIconCache&quot;, Components.interfaces.nsICache.STORE_ANYWHERE, true);</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-                if (!this.mMissedIconCache)</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineminus">-                  return null;</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineminus">-              }</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-              return this.mMissedIconCache.openCacheEntry(key, access, true);</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineminus">-            }</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineminus">-            catch (e) {</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineminus">-              return null;</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineminus">-            }</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+            if (this.mFaviconService)</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+              this.mFaviconService.addFailedFavicon(aURI);</span>
<a href="#l4.83"></a><span id="l4.83">           ]]&gt;</span>
<a href="#l4.84"></a><span id="l4.84">         &lt;/body&gt;</span>
<a href="#l4.85"></a><span id="l4.85">       &lt;/method&gt;</span>
<a href="#l4.86"></a><span id="l4.86"> </span>
<a href="#l4.87"></a><span id="l4.87">       &lt;method name=&quot;getTitleForURI&quot;&gt;</span>
<a href="#l4.88"></a><span id="l4.88">         &lt;parameter name=&quot;aURI&quot;/&gt;</span>
<a href="#l4.89"></a><span id="l4.89">         &lt;body&gt;</span>
<a href="#l4.90"></a><span id="l4.90">           &lt;![CDATA[</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/suite/locales/en-US/chrome/browser/metadata.dtd</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/browser/metadata.dtd</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -7,16 +7,17 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;!ENTITY caption.label         &quot;Element Properties&quot;&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> &lt;!ENTITY image-sec.label       &quot;Image Properties&quot;&gt;</span>
<a href="#l5.6"></a><span id="l5.6"> &lt;!ENTITY image-url.label       &quot;Location:&quot;&gt;</span>
<a href="#l5.7"></a><span id="l5.7"> &lt;!ENTITY image-desc.label      &quot;Description:&quot;&gt;</span>
<a href="#l5.8"></a><span id="l5.8"> &lt;!ENTITY image-alt.label       &quot;Alternate text:&quot;&gt;</span>
<a href="#l5.9"></a><span id="l5.9"> &lt;!ENTITY image-width.label     &quot;Width:&quot;&gt;</span>
<a href="#l5.10"></a><span id="l5.10"> &lt;!ENTITY image-height.label    &quot;Height:&quot;&gt;</span>
<a href="#l5.11"></a><span id="l5.11"> &lt;!ENTITY image-filesize.label  &quot;Size of File:&quot;&gt;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+&lt;!ENTITY image-filesize.value  &quot;Unknown&quot;&gt;</span>
<a href="#l5.13"></a><span id="l5.13"> &lt;!ENTITY insdel-sec.label      &quot;Insert/Delete Properties&quot;&gt;</span>
<a href="#l5.14"></a><span id="l5.14"> &lt;!ENTITY insdel-cite.label     &quot;Info:&quot;&gt;</span>
<a href="#l5.15"></a><span id="l5.15"> &lt;!ENTITY insdel-date.label     &quot;Date:&quot;&gt;</span>
<a href="#l5.16"></a><span id="l5.16"> &lt;!ENTITY link-sec.label        &quot;Link Properties&quot;&gt;</span>
<a href="#l5.17"></a><span id="l5.17"> &lt;!ENTITY link-url.label        &quot;Address:&quot;&gt;</span>
<a href="#l5.18"></a><span id="l5.18"> &lt;!ENTITY link-target.label     &quot;Will open in:&quot;&gt;</span>
<a href="#l5.19"></a><span id="l5.19"> &lt;!ENTITY link-type.label       &quot;Target type:&quot;&gt;</span>
<a href="#l5.20"></a><span id="l5.20"> &lt;!ENTITY link-lang.label       &quot;Target language:&quot;&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

