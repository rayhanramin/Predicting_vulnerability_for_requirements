<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 26675:ae087d73b3ce70604c356f6043cc8998243bf87f</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ ae087d73b3ce70604c356f6043cc8998243bf87f" />
<meta property="og:url" content="/comm-central/rev/ae087d73b3ce70604c356f6043cc8998243bf87f" />
<meta property="og:description" content="Bug 1550488 - Change the OTR localization to use Fluent. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / ae087d73b3ce70604c356f6043cc8998243bf87f 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/ae087d73b3ce70604c356f6043cc8998243bf87f">shortlog</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/ae087d73b3ce70604c356f6043cc8998243bf87f">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f">files</a> |
changeset |
<a href="/comm-central/raw-rev/ae087d73b3ce70604c356f6043cc8998243bf87f">raw</a>  | <a href="/comm-central/archive/ae087d73b3ce70604c356f6043cc8998243bf87f.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550488">Bug 1550488</a> - Change the OTR localization to use Fluent. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#75;&#97;&#105;&#32;&#69;&#110;&#103;&#101;&#114;&#116;&#32;&#60;&#107;&#97;&#105;&#101;&#64;&#107;&#117;&#105;&#120;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 20 May 2019 11:33:11 +0200</td></tr>

<tr>
 <td>changeset 26675</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/ae087d73b3ce70604c356f6043cc8998243bf87f">ae087d73b3ce70604c356f6043cc8998243bf87f</a></td>
</tr>



<tr>
<td>parent 26674</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/38204c5426e09d5ac3f6b431cb19d38538485ccb">38204c5426e09d5ac3f6b431cb19d38538485ccb</a>
</td>
</tr>

<tr>
<td>child 26676</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/551822c41355acc5402e2bc242c2903b37810844">551822c41355acc5402e2bc242c2903b37810844</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=ae087d73b3ce70604c356f6043cc8998243bf87f">15940</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 20 May 2019 09:45:05 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@ae087d73b3ce [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=ae087d73b3ce70604c356f6043cc8998243bf87f">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=ae087d73b3ce70604c356f6043cc8998243bf87f&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=ae087d73b3ce70604c356f6043cc8998243bf87f&newProject=comm-central&newRevision=ed4e2f86397602bcd79b8b1c6475df0606cf0fbb&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=ae087d73b3ce70604c356f6043cc8998243bf87f&newProject=comm-central&newRevision=ed4e2f86397602bcd79b8b1c6475df0606cf0fbb&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=ae087d73b3ce70604c356f6043cc8998243bf87f&newProject=comm-central&newRevision=ed4e2f86397602bcd79b8b1c6475df0606cf0fbb&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550488">1550488</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1550488">Bug 1550488</a> - Change the OTR localization to use Fluent. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/jar.mn">chat/content/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/jar.mn">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/jar.mn">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/jar.mn">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/jar.mn">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.dtd">chat/content/otr-add-finger.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.dtd">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.dtd">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.properties">chat/content/otr-add-finger.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.properties">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.properties">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-finger.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.js">chat/content/otr-add-fingerprint.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.js">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.js">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.js">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.js">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.xul">chat/content/otr-add-fingerprint.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.xul">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.xul">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.xul">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.xul">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-add-fingerprint.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.dtd">chat/content/otr-auth.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.dtd">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.dtd">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.js">chat/content/otr-auth.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.js">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.js">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.js">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.js">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.properties">chat/content/otr-auth.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.properties">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.properties">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.xul">chat/content/otr-auth.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.xul">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.xul">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.xul">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.xul">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-auth.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-chat.dtd">chat/content/otr-chat.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-chat.dtd">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-chat.dtd">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-chat.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.dtd">chat/content/otr-generate-key.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.dtd">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.dtd">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.js">chat/content/otr-generate-key.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.js">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.js">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.js">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.js">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.properties">chat/content/otr-generate-key.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.properties">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.properties">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.xul">chat/content/otr-generate-key.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.xul">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.xul">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.xul">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.xul">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr-generate-key.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr.properties">chat/content/otr.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr.properties">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr.properties">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/add-finger.ftl">chat/content/otr/add-finger.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/add-finger.ftl">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/add-finger.ftl">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/add-finger.ftl">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/add-finger.ftl">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/add-finger.ftl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/auth.ftl">chat/content/otr/auth.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/auth.ftl">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/auth.ftl">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/auth.ftl">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/auth.ftl">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/auth.ftl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/chat.ftl">chat/content/otr/chat.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/chat.ftl">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/chat.ftl">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/chat.ftl">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/chat.ftl">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/chat.ftl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/generate-key.ftl">chat/content/otr/generate-key.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/generate-key.ftl">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/generate-key.ftl">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/generate-key.ftl">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/generate-key.ftl">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/generate-key.ftl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otr.ftl">chat/content/otr/otr.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otr.ftl">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otr.ftl">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otr.ftl">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otr.ftl">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otr.ftl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otrUI.ftl">chat/content/otr/otrUI.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otrUI.ftl">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otrUI.ftl">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otrUI.ftl">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otrUI.ftl">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otr/otrUI.ftl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otrUI.properties">chat/content/otrUI.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otrUI.properties">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otrUI.properties">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/content/otrUI.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTR.jsm">chat/modules/OTR.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTR.jsm">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTR.jsm">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTR.jsm">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTR.jsm">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTR.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTRUI.jsm">chat/modules/OTRUI.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTRUI.jsm">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTRUI.jsm">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTRUI.jsm">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTRUI.jsm">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/chat/modules/OTRUI.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-conversation-info.js">mail/components/im/content/chat-conversation-info.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-conversation-info.js">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-conversation-info.js">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-conversation-info.js">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-conversation-info.js">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-conversation-info.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-messenger.js">mail/components/im/content/chat-messenger.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-messenger.js">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-messenger.js">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-messenger.js">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-messenger.js">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/components/im/content/chat-messenger.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/ae087d73b3ce70604c356f6043cc8998243bf87f/mail/locales/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/chat/content/jar.mn</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/chat/content/jar.mn</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -14,17 +14,8 @@ chat.jar:</span>
<a href="#l1.4"></a><span id="l1.4"> 	content/chat/conv.html</span>
<a href="#l1.5"></a><span id="l1.5"> 	content/chat/otr-add-fingerprint.js</span>
<a href="#l1.6"></a><span id="l1.6"> 	content/chat/otr-add-fingerprint.xul</span>
<a href="#l1.7"></a><span id="l1.7"> 	content/chat/otr-auth.js</span>
<a href="#l1.8"></a><span id="l1.8"> 	content/chat/otr-auth.xul</span>
<a href="#l1.9"></a><span id="l1.9"> 	content/chat/otr-generate-key.js</span>
<a href="#l1.10"></a><span id="l1.10"> 	content/chat/otr-generate-key.xul</span>
<a href="#l1.11"></a><span id="l1.11"> 	content/chat/otrWorker.js</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-	content/chat/otr-auth.dtd</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-	content/chat/otr-auth.properties</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-	content/chat/otr-add-finger.dtd</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-	content/chat/otr-add-finger.properties</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-	content/chat/otr.properties</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-	content/chat/otr-generate-key.dtd</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-	content/chat/otr-generate-key.properties</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-	content/chat/otrUI.properties</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-	content/chat/otr-chat.dtd</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">deleted file mode 100644</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineminus">--- a/chat/content/otr-add-finger.dtd</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineplus">+++ /dev/null</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineat">@@ -1,9 +0,0 @@</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineminus">-&lt;!ENTITY addFingerDialog.title &quot;Add Fingerprint&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineminus">-&lt;!ENTITY addFingerDialog.finger &quot;Fingerprint&quot;&gt;</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineminus">-&lt;!ENTITY addFingerDialog.cancel &quot;Skip&quot;&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-&lt;!-- LOCALIZATION NOTE (addFingerDialog.tooltip): do not translate OTR which is the name of an encryption protocol --&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-&lt;!ENTITY addFingerDialog.tooltip &quot;If you know the 40 hex char fingerprint of your contact's OTR private key, enter it now.&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">deleted file mode 100644</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineminus">--- a/chat/content/otr-add-finger.properties</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineplus">+++ /dev/null</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineat">@@ -1,6 +0,0 @@</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">-</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">-# LOCALIZATION NOTE (addfinger.title): %S is the name of a chat contact person</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-addfinger.title=Enter the fingerprint of the OTR key used by %S</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/chat/content/otr-add-fingerprint.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/chat/content/otr-add-fingerprint.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -3,26 +3,23 @@</span>
<a href="#l4.4"></a><span id="l4.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6"> const {</span>
<a href="#l4.7"></a><span id="l4.7">   XPCOMUtils,</span>
<a href="#l4.8"></a><span id="l4.8">   l10nHelper,</span>
<a href="#l4.9"></a><span id="l4.9"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l4.10"></a><span id="l4.10"> const {OTR} = ChromeUtils.import(&quot;resource:///modules/OTR.jsm&quot;);</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-  l10nHelper(&quot;chrome://chat/content/otr-add-finger.properties&quot;)</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-);</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-</span>
<a href="#l4.16"></a><span id="l4.16"> var args = window.arguments[0].wrappedJSObject;</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18"> var otrAddFinger = {</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-  onload() {</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-    document.title = _(&quot;addfinger.title&quot;, args.screenname);</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+  async onload() {</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+    let title = await document.l10n.formatValue(</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+      &quot;otr-add-finger-name-title&quot;, {name: args.screenname});</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+    document.title = title;</span>
<a href="#l4.26"></a><span id="l4.26">     document.addEventListener(&quot;dialogaccept&quot;, () =&gt; {</span>
<a href="#l4.27"></a><span id="l4.27">       return this.add();</span>
<a href="#l4.28"></a><span id="l4.28">     });</span>
<a href="#l4.29"></a><span id="l4.29">   },</span>
<a href="#l4.30"></a><span id="l4.30"> </span>
<a href="#l4.31"></a><span id="l4.31">   oninput(e) {</span>
<a href="#l4.32"></a><span id="l4.32">     e.value = e.value.replace(/[^0-9a-fA-F]/gi, &quot;&quot;);</span>
<a href="#l4.33"></a><span id="l4.33">     document.documentElement.getButton(&quot;accept&quot;).disabled = (e.value.length != 40);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/chat/content/otr-add-fingerprint.xul</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/chat/content/otr-add-fingerprint.xul</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,27 +1,32 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.6"></a><span id="l5.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.7"></a><span id="l5.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot; ?&gt;</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11" class="difflineminus">-&lt;!DOCTYPE window SYSTEM &quot;chrome://chat/content/otr-add-finger.dtd&quot;&gt;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+&lt;!DOCTYPE dialog&gt;</span>
<a href="#l5.13"></a><span id="l5.13"> </span>
<a href="#l5.14"></a><span id="l5.14"> &lt;dialog id=&quot;otrAddFingerDialog&quot;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+        data-l10n-id=&quot;otr-add-finger&quot;</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+        data-l10n-attrs=&quot;buttonlabelcancel&quot;</span>
<a href="#l5.17"></a><span id="l5.17">         windowtype=&quot;OTR:AddFinger&quot;</span>
<a href="#l5.18"></a><span id="l5.18">         onload=&quot;otrAddFinger.onload()&quot;</span>
<a href="#l5.19"></a><span id="l5.19">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-        title=&quot;&amp;addFingerDialog.title;&quot;</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l5.22"></a><span id="l5.22">         buttons=&quot;accept,cancel&quot;</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineminus">-        buttonlabelcancel=&quot;&amp;addFingerDialog.cancel;&quot;</span>
<a href="#l5.24"></a><span id="l5.24">         buttondisabledaccept=&quot;true&quot;&gt;</span>
<a href="#l5.25"></a><span id="l5.25"> </span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+  &lt;linkset&gt;</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+    &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/otr/add-finger.ftl&quot;/&gt;</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+  &lt;/linkset&gt;</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+</span>
<a href="#l5.30"></a><span id="l5.30">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://chat/content/otr-add-fingerprint.js&quot;/&gt;</span>
<a href="#l5.31"></a><span id="l5.31">   &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-    &lt;label value=&quot;&amp;addFingerDialog.tooltip;&quot; control=&quot;name&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+    &lt;label data-l10n-id=&quot;otr-add-finger-tooltip&quot; control=&quot;name&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l5.34"></a><span id="l5.34">     &lt;hbox id=&quot;fingerBox&quot; align=&quot;baseline&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-      &lt;label value=&quot;&amp;addFingerDialog.finger;&quot; control=&quot;name&quot;/&gt;</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+      &lt;label data-l10n-id=&quot;otr-add-finger-fingerprint&quot; control=&quot;name&quot;/&gt;</span>
<a href="#l5.37"></a><span id="l5.37">       &lt;textbox id=&quot;finger&quot; oninput=&quot;otrAddFinger.oninput(this)&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l5.38"></a><span id="l5.38">     &lt;/hbox&gt;</span>
<a href="#l5.39"></a><span id="l5.39">   &lt;/vbox&gt;</span>
<a href="#l5.40"></a><span id="l5.40"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">deleted file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- a/chat/content/otr-auth.dtd</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ /dev/null</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -1,20 +0,0 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineminus">-</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineminus">-&lt;!ENTITY authDialog.title &quot;Verify contact's identity&quot;&gt;</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-&lt;!ENTITY authDialog.authenticate &quot;Verify&quot;&gt;</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineminus">-&lt;!ENTITY authDialog.help &quot;Help&quot;&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-&lt;!ENTITY authDialog.yes &quot;Yes&quot;&gt;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-&lt;!ENTITY authDialog.no &quot;No&quot;&gt;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-&lt;!ENTITY authDialog.verified &quot;I have verified that this is in fact the correct fingerprint.&quot;&gt;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-&lt;!ENTITY authDialog.manualVerification &quot;Manual fingerprint verification&quot;&gt;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-&lt;!ENTITY authDialog.questionAndAnswer &quot;Question and answer&quot;&gt;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-&lt;!ENTITY authDialog.sharedSecret &quot;Shared secret&quot;&gt;</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-&lt;!ENTITY authDialog.manualInstruction &quot;To verify the fingerprint, contact your intended chat partner via some other authenticated channel, such as the telephone or GPG-signed email. Each of you should tell your fingerprint to the other. If everything matches up, you should indicate in the dialog below that you have verified the fingerprint.&quot;&gt;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-&lt;!ENTITY authDialog.how &quot;How would you like to verify your contact's identity?&quot;&gt;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-&lt;!ENTITY authDialog.qaInstruction &quot;To verify their identity, pick a question whose answer is known only to you and your contact. Enter this question and answer, then wait for your contact to enter the answer as well. If the answers do not match, then you may be talking to an imposter.&quot;&gt;</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-&lt;!ENTITY authDialog.secretInstruction &quot;To verify their identity, pick a secret known only to you and your contact. Enter this secret, then wait for your contact to enter it as well. If the secrets do not match, then you may be talking to an imposter.&quot;&gt;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-&lt;!ENTITY authDialog.question &quot;Enter question here:&quot;&gt;</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-&lt;!ENTITY authDialog.answer &quot;Enter secret answer here (case sensitive):&quot;&gt;</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-&lt;!ENTITY authDialog.secret &quot;Enter secret here:&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/chat/content/otr-auth.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/chat/content/otr-auth.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -4,32 +4,18 @@</span>
<a href="#l7.4"></a><span id="l7.4"> </span>
<a href="#l7.5"></a><span id="l7.5"> const {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l7.6"></a><span id="l7.6"> const {</span>
<a href="#l7.7"></a><span id="l7.7">   XPCOMUtils,</span>
<a href="#l7.8"></a><span id="l7.8">   l10nHelper,</span>
<a href="#l7.9"></a><span id="l7.9"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l7.10"></a><span id="l7.10"> const {OTR} = ChromeUtils.import(&quot;resource:///modules/OTR.jsm&quot;);</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-  l10nHelper(&quot;chrome://chat/content/otr-auth.properties&quot;)</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-);</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-</span>
<a href="#l7.16"></a><span id="l7.16"> var [mode, uiConv, contactInfo] = window.arguments;</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18" class="difflineminus">-// This window implements the interactive authentication of a buddy's</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineminus">-// key. At open time, we're given several parameters, and the &quot;mode&quot;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">-// parameter tells us, from where we've been called.</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-// mode == &quot;pref&quot; means that we have been opened from the preferences,</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-// and it means we cannot rely on the other user being online, and</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-// we there might be no uiConv active currently, so we fall back.</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-document.title = _(&quot;auth.title&quot;,</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-  (mode === &quot;pref&quot;) ? contactInfo.screenname : uiConv.normalizedName);</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-</span>
<a href="#l7.28"></a><span id="l7.28"> function showSection(selected, hideMenu) {</span>
<a href="#l7.29"></a><span id="l7.29">   document.getElementById(&quot;how&quot;).hidden = !!hideMenu;</span>
<a href="#l7.30"></a><span id="l7.30">   [ &quot;questionAndAnswer&quot;,</span>
<a href="#l7.31"></a><span id="l7.31">     &quot;sharedSecret&quot;,</span>
<a href="#l7.32"></a><span id="l7.32">     &quot;manualVerification&quot;,</span>
<a href="#l7.33"></a><span id="l7.33">     &quot;ask&quot;,</span>
<a href="#l7.34"></a><span id="l7.34">   ].forEach(function(key) {</span>
<a href="#l7.35"></a><span id="l7.35">     document.getElementById(key).hidden = (key !== selected);</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineat">@@ -43,36 +29,55 @@ function startSMP(context, answer, quest</span>
<a href="#l7.37"></a><span id="l7.37"> }</span>
<a href="#l7.38"></a><span id="l7.38"> </span>
<a href="#l7.39"></a><span id="l7.39"> function manualVerification(fingerprint, context) {</span>
<a href="#l7.40"></a><span id="l7.40">   let opts = document.getElementById(&quot;verifiedOption&quot;);</span>
<a href="#l7.41"></a><span id="l7.41">   let trust = (opts.selectedItem.value === &quot;yes&quot;);</span>
<a href="#l7.42"></a><span id="l7.42">   OTR.setTrust(fingerprint, trust, context);</span>
<a href="#l7.43"></a><span id="l7.43"> }</span>
<a href="#l7.44"></a><span id="l7.44"> </span>
<a href="#l7.45"></a><span id="l7.45" class="difflineminus">-function populateFingers(context, theirs, trust) {</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineminus">-  let fingers = document.getElementById(&quot;fingerprints&quot;);</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+async function populateFingers(context, theirs, trust) {</span>
<a href="#l7.48"></a><span id="l7.48">   let yours = OTR.privateKeyFingerprint(context.account, context.protocol);</span>
<a href="#l7.49"></a><span id="l7.49">   if (!yours)</span>
<a href="#l7.50"></a><span id="l7.50">     throw new Error(&quot;Fingerprint should already be generated.&quot;);</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-  fingers.value =</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-    _(&quot;auth.yourFingerprint&quot;, context.account, yours) + &quot;\n\n&quot; +</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineminus">-    _(&quot;auth.theirFingerprint&quot;, context.username, theirs);</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+  document.getElementById(&quot;yourFPLabel&quot;).value =</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+    await document.l10n.formatValue(&quot;auth-your-fp-value&quot;, {own_name: context.account});</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineplus">+</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineplus">+  document.getElementById(&quot;theirFPLabel&quot;).value =</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineplus">+    await document.l10n.formatValue(&quot;auth-their-fp-value&quot;, {their_name: context.username});</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineplus">+  document.getElementById(&quot;yourFPValue&quot;).value = yours;</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+  document.getElementById(&quot;theirFPValue&quot;).value = theirs;</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+</span>
<a href="#l7.64"></a><span id="l7.64">   let opts = document.getElementById(&quot;verifiedOption&quot;);</span>
<a href="#l7.65"></a><span id="l7.65">   let verified = trust ? &quot;yes&quot; : &quot;no&quot;;</span>
<a href="#l7.66"></a><span id="l7.66">   for (let item of opts.menupopup.childNodes) {</span>
<a href="#l7.67"></a><span id="l7.67">     if (verified === item.value) {</span>
<a href="#l7.68"></a><span id="l7.68">       opts.selectedItem = item;</span>
<a href="#l7.69"></a><span id="l7.69">       break;</span>
<a href="#l7.70"></a><span id="l7.70">     }</span>
<a href="#l7.71"></a><span id="l7.71">   }</span>
<a href="#l7.72"></a><span id="l7.72"> }</span>
<a href="#l7.73"></a><span id="l7.73"> </span>
<a href="#l7.74"></a><span id="l7.74"> var otrAuth = {</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineminus">-  onload() {</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineplus">+  async onload() {</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+    // This window implements the interactive authentication of a buddy's</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineplus">+    // key. At open time, we're given several parameters, and the &quot;mode&quot;</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineplus">+    // parameter tells us from where we've been called.</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineplus">+    // mode == &quot;pref&quot; means that we have been opened from the preferences,</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineplus">+    // and it means we cannot rely on the other user being online, and</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+    // we there might be no uiConv active currently, so we fall back.</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineplus">+</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineplus">+    let nameSource =</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineplus">+      (mode === &quot;pref&quot;) ? contactInfo.screenname : uiConv.normalizedName;</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineplus">+    let title = await document.l10n.formatValue(</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineplus">+      &quot;auth-title&quot;, {name: nameSource});</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+    document.title = title;</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineplus">+</span>
<a href="#l7.90"></a><span id="l7.90">     document.addEventListener(&quot;dialogaccept&quot;, () =&gt; {</span>
<a href="#l7.91"></a><span id="l7.91">       return this.accept();</span>
<a href="#l7.92"></a><span id="l7.92">     });</span>
<a href="#l7.93"></a><span id="l7.93"> </span>
<a href="#l7.94"></a><span id="l7.94">     document.addEventListener(&quot;dialogcancel&quot;, () =&gt; {</span>
<a href="#l7.95"></a><span id="l7.95">       return this.cancel();</span>
<a href="#l7.96"></a><span id="l7.96">     });</span>
<a href="#l7.97"></a><span id="l7.97"> </span>
<a href="#l7.98"></a><span id="l7.98" class="difflineat">@@ -95,46 +100,61 @@ var otrAuth = {</span>
<a href="#l7.99"></a><span id="l7.99">           contactInfo.screenname</span>
<a href="#l7.100"></a><span id="l7.100">         );</span>
<a href="#l7.101"></a><span id="l7.101">         theirs = contactInfo.fingerprint;</span>
<a href="#l7.102"></a><span id="l7.102">         populateFingers(context, theirs, contactInfo.trust);</span>
<a href="#l7.103"></a><span id="l7.103">         showSection(&quot;manualVerification&quot;, true);</span>
<a href="#l7.104"></a><span id="l7.104">         this.oninput({ value: true });</span>
<a href="#l7.105"></a><span id="l7.105">         break;</span>
<a href="#l7.106"></a><span id="l7.106">       case &quot;ask&quot;:</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineminus">-        document.getElementById(&quot;askLabel&quot;).textContent = contactInfo.question ?</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineminus">-          _(&quot;auth.question&quot;, contactInfo.question)</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineminus">-          : _(&quot;auth.secret&quot;);</span>
<a href="#l7.110"></a><span id="l7.110" class="difflineplus">+        let receivedQuestionLabel =</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineplus">+          document.getElementById(&quot;receivedQuestionLabel&quot;);</span>
<a href="#l7.112"></a><span id="l7.112" class="difflineplus">+        let receivedQuestionDisplay =</span>
<a href="#l7.113"></a><span id="l7.113" class="difflineplus">+          document.getElementById(&quot;receivedQuestion&quot;);</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineplus">+        let responseLabel =</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineplus">+          document.getElementById(&quot;responseLabel&quot;);</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineplus">+        if (contactInfo.question) {</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineplus">+          receivedQuestionLabel.hidden = false;</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineplus">+          receivedQuestionDisplay.hidden = false;</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineplus">+          receivedQuestionDisplay.value = contactInfo.question;</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineplus">+          responseLabel.value =</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineplus">+            await document.l10n.formatValue(&quot;auth-answer&quot;);</span>
<a href="#l7.122"></a><span id="l7.122" class="difflineplus">+        } else {</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineplus">+          receivedQuestionLabel.hidden = true;</span>
<a href="#l7.124"></a><span id="l7.124" class="difflineplus">+          receivedQuestionDisplay.hidden = true;</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineplus">+          responseLabel.value =</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineplus">+            await document.l10n.formatValue(&quot;auth-secret&quot;);</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineplus">+        }</span>
<a href="#l7.128"></a><span id="l7.128">         showSection(&quot;ask&quot;, true);</span>
<a href="#l7.129"></a><span id="l7.129">         break;</span>
<a href="#l7.130"></a><span id="l7.130">     }</span>
<a href="#l7.131"></a><span id="l7.131">   },</span>
<a href="#l7.132"></a><span id="l7.132"> </span>
<a href="#l7.133"></a><span id="l7.133">   accept() {</span>
<a href="#l7.134"></a><span id="l7.134">     // uiConv may not be present in pref mode</span>
<a href="#l7.135"></a><span id="l7.135">     let context = uiConv ? OTR.getContext(uiConv.target) : null;</span>
<a href="#l7.136"></a><span id="l7.136">     if (mode === &quot;pref&quot;) {</span>
<a href="#l7.137"></a><span id="l7.137">       manualVerification(contactInfo.fpointer, context);</span>
<a href="#l7.138"></a><span id="l7.138">     } else if (mode === &quot;start&quot;) {</span>
<a href="#l7.139"></a><span id="l7.139">       let how = document.getElementById(&quot;howOption&quot;);</span>
<a href="#l7.140"></a><span id="l7.140">       switch (how.selectedItem.value) {</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineminus">-      case &quot;questionAndAnswer&quot;:</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineminus">-        let question = document.getElementById(&quot;question&quot;).value;</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineminus">-        let answer = document.getElementById(&quot;answer&quot;).value;</span>
<a href="#l7.144"></a><span id="l7.144" class="difflineminus">-        startSMP(context, answer, question);</span>
<a href="#l7.145"></a><span id="l7.145" class="difflineminus">-        break;</span>
<a href="#l7.146"></a><span id="l7.146" class="difflineminus">-      case &quot;sharedSecret&quot;:</span>
<a href="#l7.147"></a><span id="l7.147" class="difflineminus">-        let secret = document.getElementById(&quot;secret&quot;).value;</span>
<a href="#l7.148"></a><span id="l7.148" class="difflineminus">-        startSMP(context, secret);</span>
<a href="#l7.149"></a><span id="l7.149" class="difflineminus">-        break;</span>
<a href="#l7.150"></a><span id="l7.150" class="difflineminus">-      case &quot;manualVerification&quot;:</span>
<a href="#l7.151"></a><span id="l7.151" class="difflineminus">-        manualVerification(context.fingerprint, context);</span>
<a href="#l7.152"></a><span id="l7.152" class="difflineminus">-        break;</span>
<a href="#l7.153"></a><span id="l7.153" class="difflineminus">-      default:</span>
<a href="#l7.154"></a><span id="l7.154" class="difflineminus">-        throw new Error(&quot;Unreachable!&quot;);</span>
<a href="#l7.155"></a><span id="l7.155" class="difflineplus">+        case &quot;questionAndAnswer&quot;:</span>
<a href="#l7.156"></a><span id="l7.156" class="difflineplus">+          let question = document.getElementById(&quot;question&quot;).value;</span>
<a href="#l7.157"></a><span id="l7.157" class="difflineplus">+          let answer = document.getElementById(&quot;answer&quot;).value;</span>
<a href="#l7.158"></a><span id="l7.158" class="difflineplus">+          startSMP(context, answer, question);</span>
<a href="#l7.159"></a><span id="l7.159" class="difflineplus">+          break;</span>
<a href="#l7.160"></a><span id="l7.160" class="difflineplus">+        case &quot;sharedSecret&quot;:</span>
<a href="#l7.161"></a><span id="l7.161" class="difflineplus">+          let secret = document.getElementById(&quot;secret&quot;).value;</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineplus">+          startSMP(context, secret);</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineplus">+          break;</span>
<a href="#l7.164"></a><span id="l7.164" class="difflineplus">+        case &quot;manualVerification&quot;:</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineplus">+          manualVerification(context.fingerprint, context);</span>
<a href="#l7.166"></a><span id="l7.166" class="difflineplus">+          break;</span>
<a href="#l7.167"></a><span id="l7.167" class="difflineplus">+        default:</span>
<a href="#l7.168"></a><span id="l7.168" class="difflineplus">+          throw new Error(&quot;Unreachable!&quot;);</span>
<a href="#l7.169"></a><span id="l7.169">       }</span>
<a href="#l7.170"></a><span id="l7.170">     } else if (mode === &quot;ask&quot;) {</span>
<a href="#l7.171"></a><span id="l7.171">       let response = document.getElementById(&quot;response&quot;).value;</span>
<a href="#l7.172"></a><span id="l7.172">       OTR.sendResponse(context, response);</span>
<a href="#l7.173"></a><span id="l7.173">       OTR.authUpdate(context, contactInfo.progress);</span>
<a href="#l7.174"></a><span id="l7.174">     } else {</span>
<a href="#l7.175"></a><span id="l7.175">       throw new Error(&quot;Unreachable!&quot;);</span>
<a href="#l7.176"></a><span id="l7.176">     }</span>
<a href="#l7.177"></a><span id="l7.177" class="difflineat">@@ -163,13 +183,14 @@ var otrAuth = {</span>
<a href="#l7.178"></a><span id="l7.178">       break;</span>
<a href="#l7.179"></a><span id="l7.179">     case &quot;manualVerification&quot;:</span>
<a href="#l7.180"></a><span id="l7.180">       this.oninput({ value: true });</span>
<a href="#l7.181"></a><span id="l7.181">       break;</span>
<a href="#l7.182"></a><span id="l7.182">     }</span>
<a href="#l7.183"></a><span id="l7.183">     showSection(how);</span>
<a href="#l7.184"></a><span id="l7.184">   },</span>
<a href="#l7.185"></a><span id="l7.185"> </span>
<a href="#l7.186"></a><span id="l7.186" class="difflineminus">-  help() {</span>
<a href="#l7.187"></a><span id="l7.187" class="difflineminus">-    Services.prompt.alert(window, _(&quot;auth.helpTitle&quot;), _(&quot;auth.help&quot;));</span>
<a href="#l7.188"></a><span id="l7.188" class="difflineplus">+  async help() {</span>
<a href="#l7.189"></a><span id="l7.189" class="difflineplus">+    let helpTitle = await document.l10n.formatValue(&quot;auth-helpTitle&quot;);</span>
<a href="#l7.190"></a><span id="l7.190" class="difflineplus">+    let helpText = await document.l10n.formatValue(&quot;auth-help&quot;);</span>
<a href="#l7.191"></a><span id="l7.191" class="difflineplus">+    Services.prompt.alert(window, helpTitle, helpText);</span>
<a href="#l7.192"></a><span id="l7.192">   },</span>
<a href="#l7.193"></a><span id="l7.193" class="difflineminus">-</span>
<a href="#l7.194"></a><span id="l7.194"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">deleted file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- a/chat/content/otr-auth.properties</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ /dev/null</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -1,15 +0,0 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineminus">-</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineminus">-# LOCALIZATION NOTE (auth.title): %S is the screen name of a chat contact person</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineminus">-auth.title=Verify the identity of %S</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineminus">-# LOCALIZATION NOTE (auth.yourFingerprint): 1st %S is the user's own screen name. 2nd %S is the fingerprint (a checksum) of the user's own encryption key.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-auth.yourFingerprint=Fingerprint for you, %S:\n%S</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-# LOCALIZATION NOTE (auth.theirFingerprint): 1st %S is the screen name of a chat contact. 2nd %S is the fingerprint (a checksum) of the chat contact's encryption key.</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-auth.theirFingerprint=Purported fingerprint for %S:\n%S</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-auth.help=Verifying a contact's identity helps ensure that the person you are talking to is who they claim to be.</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-auth.helpTitle=Verification help</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-# LOCALIZATION NOTE (auth.question): %S is a question (any text is possible) that was received from a chat contact</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-auth.question=This is the question asked by your contact:\n\n%S\n\nEnter secret answer here (case sensitive):</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-auth.secret=Enter secret here:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/chat/content/otr-auth.xul</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/chat/content/otr-auth.xul</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,71 +1,81 @@</span>
<a href="#l9.4"></a><span id="l9.4"> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a href="#l9.5"></a><span id="l9.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.6"></a><span id="l9.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.7"></a><span id="l9.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot; ?&gt;</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11" class="difflineminus">-&lt;!DOCTYPE window SYSTEM &quot;chrome://chat/content/otr-auth.dtd&quot;&gt;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+&lt;!DOCTYPE dialog&gt;</span>
<a href="#l9.13"></a><span id="l9.13"> </span>
<a href="#l9.14"></a><span id="l9.14"> &lt;dialog</span>
<a href="#l9.15"></a><span id="l9.15">   xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l9.16"></a><span id="l9.16">   xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l9.17"></a><span id="l9.17">   id=&quot;otrAuthDialog&quot;</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+  data-l10n-id=&quot;otr-auth&quot;</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+  data-l10n-attrs=&quot;buttonlabelaccept&quot;</span>
<a href="#l9.20"></a><span id="l9.20">   windowtype=&quot;OTR:Auth&quot;</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineminus">-  title=&quot;&amp;authDialog.title;&quot;</span>
<a href="#l9.22"></a><span id="l9.22">   onload=&quot;otrAuth.onload()&quot;</span>
<a href="#l9.23"></a><span id="l9.23">   buttons=&quot;accept,cancel,help&quot;</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineminus">-  buttonlabelaccept=&quot;&amp;authDialog.authenticate;&quot;</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineminus">-  buttonlabelhelp=&quot;&amp;authDialog.help;&quot;</span>
<a href="#l9.26"></a><span id="l9.26">   buttondisabledaccept=&quot;true&quot;&gt;</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+  &lt;linkset&gt;</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+    &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/otr/auth.ftl&quot;/&gt;</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+  &lt;/linkset&gt;</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+</span>
<a href="#l9.32"></a><span id="l9.32">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://chat/content/otr-auth.js&quot; /&gt;</span>
<a href="#l9.33"></a><span id="l9.33"> </span>
<a href="#l9.34"></a><span id="l9.34">   &lt;groupbox id=&quot;how&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-    &lt;caption label=&quot;&amp;authDialog.how;&quot;/&gt;</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+    &lt;label&gt;&lt;html:h4 data-l10n-id=&quot;auth-how&quot;/&gt;&lt;/label&gt;</span>
<a href="#l9.37"></a><span id="l9.37">     &lt;menulist id=&quot;howOption&quot; oncommand=&quot;otrAuth.how();&quot;&gt;</span>
<a href="#l9.38"></a><span id="l9.38">       &lt;menupopup&gt;</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-        &lt;menuitem label=&quot;&amp;authDialog.questionAndAnswer;&quot; value=&quot;questionAndAnswer&quot; /&gt;</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineminus">-        &lt;menuitem label=&quot;&amp;authDialog.sharedSecret;&quot; value=&quot;sharedSecret&quot; /&gt;</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineminus">-        &lt;menuitem label=&quot;&amp;authDialog.manualVerification;&quot; value=&quot;manualVerification&quot; /&gt;</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineplus">+        &lt;menuitem data-l10n-id=&quot;auth-questionAndAnswer-label&quot; value=&quot;questionAndAnswer&quot; /&gt;</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineplus">+        &lt;menuitem data-l10n-id=&quot;auth-sharedSecret-label&quot; value=&quot;sharedSecret&quot; /&gt;</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineplus">+        &lt;menuitem data-l10n-id=&quot;auth-manualVerification-label&quot; value=&quot;manualVerification&quot; /&gt;</span>
<a href="#l9.45"></a><span id="l9.45">       &lt;/menupopup&gt;</span>
<a href="#l9.46"></a><span id="l9.46">     &lt;/menulist&gt;</span>
<a href="#l9.47"></a><span id="l9.47">   &lt;/groupbox&gt;</span>
<a href="#l9.48"></a><span id="l9.48"> </span>
<a href="#l9.49"></a><span id="l9.49">   &lt;groupbox id=&quot;questionAndAnswer&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineminus">-    &lt;caption label=&quot;&amp;authDialog.questionAndAnswer;&quot; /&gt;</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineminus">-    &lt;description style=&quot;width: 300px; white-space: pre-wrap;&quot;&gt;&amp;authDialog.qaInstruction;&lt;/description&gt;</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineminus">-    &lt;label value=&quot;&amp;authDialog.question;&quot; control=&quot;question&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineplus">+    &lt;label&gt;&lt;html:h4 data-l10n-id=&quot;auth-questionAndAnswer&quot; /&gt;&lt;/label&gt;</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineplus">+    &lt;description style=&quot;width: 300px; white-space: pre-wrap;&quot; data-l10n-id=&quot;auth-qaInstruction&quot;&gt;&lt;/description&gt;</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineplus">+    &lt;label data-l10n-id=&quot;auth-question&quot; control=&quot;question&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.56"></a><span id="l9.56">     &lt;textbox id=&quot;question&quot; /&gt;</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-    &lt;label value=&quot;&amp;authDialog.answer;&quot; control=&quot;answer&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineplus">+    &lt;label data-l10n-id=&quot;auth-answer&quot; control=&quot;answer&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.59"></a><span id="l9.59">     &lt;textbox id=&quot;answer&quot; oninput=&quot;otrAuth.oninput(this)&quot; /&gt;</span>
<a href="#l9.60"></a><span id="l9.60">   &lt;/groupbox&gt;</span>
<a href="#l9.61"></a><span id="l9.61"> </span>
<a href="#l9.62"></a><span id="l9.62">   &lt;groupbox id=&quot;sharedSecret&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineminus">-    &lt;caption label=&quot;&amp;authDialog.sharedSecret;&quot; /&gt;</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineminus">-    &lt;description style=&quot;width: 300px; white-space: pre-wrap;&quot;&gt;&amp;authDialog.secretInstruction;&lt;/description&gt;</span>
<a href="#l9.65"></a><span id="l9.65" class="difflineminus">-    &lt;label value=&quot;&amp;authDialog.secret;&quot; control=&quot;secret&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineplus">+    &lt;label&gt;&lt;html:h4 data-l10n-id=&quot;auth-sharedSecret&quot; /&gt;&lt;/label&gt;</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineplus">+    &lt;description style=&quot;width: 300px; white-space: pre-wrap;&quot; data-l10n-id=&quot;auth-secretInstruction&quot;&gt;&lt;/description&gt;</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineplus">+    &lt;label data-l10n-id=&quot;auth-secret&quot; control=&quot;secret&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.69"></a><span id="l9.69">     &lt;textbox id=&quot;secret&quot; oninput=&quot;otrAuth.oninput(this)&quot; /&gt;</span>
<a href="#l9.70"></a><span id="l9.70">   &lt;/groupbox&gt;</span>
<a href="#l9.71"></a><span id="l9.71"> </span>
<a href="#l9.72"></a><span id="l9.72">   &lt;groupbox id=&quot;manualVerification&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineminus">-    &lt;caption label=&quot;&amp;authDialog.manualVerification;&quot; /&gt;</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineminus">-    &lt;description style=&quot;width: 300px; white-space: pre-wrap;&quot;&gt;&amp;authDialog.manualInstruction;&lt;/description&gt;</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-    &lt;html:textarea id=&quot;fingerprints&quot; rows=&quot;5&quot; readonly=&quot;true&quot; /&gt;</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineplus">+    &lt;label&gt;&lt;html:h4 data-l10n-id=&quot;auth-manualVerification&quot; /&gt;&lt;/label&gt;</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineplus">+    &lt;description style=&quot;width: 300px; white-space: pre-wrap;&quot; data-l10n-id=&quot;auth-manualInstruction&quot;&gt;&lt;/description&gt;</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineplus">+</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineplus">+    &lt;label id=&quot;yourFPLabel&quot; /&gt;</span>
<a href="#l9.80"></a><span id="l9.80" class="difflineplus">+    &lt;html:textarea id=&quot;yourFPValue&quot; rows=&quot;1&quot; readonly=&quot;true&quot; /&gt;</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineplus">+    &lt;label id=&quot;theirFPLabel&quot; /&gt;</span>
<a href="#l9.82"></a><span id="l9.82" class="difflineplus">+    &lt;html:textarea id=&quot;theirFPValue&quot; rows=&quot;1&quot; readonly=&quot;true&quot; /&gt;</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineplus">+</span>
<a href="#l9.84"></a><span id="l9.84">     &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineminus">-      &lt;label value=&quot;&amp;authDialog.verified;&quot; /&gt;</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineplus">+      &lt;label data-l10n-id=&quot;auth-verified&quot; /&gt;</span>
<a href="#l9.87"></a><span id="l9.87">       &lt;menulist id=&quot;verifiedOption&quot;&gt;</span>
<a href="#l9.88"></a><span id="l9.88">         &lt;menupopup&gt;</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineminus">-          &lt;menuitem label=&quot;&amp;authDialog.yes;&quot; value=&quot;yes&quot; /&gt;</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineminus">-          &lt;menuitem label=&quot;&amp;authDialog.no;&quot; value=&quot;no&quot; /&gt;</span>
<a href="#l9.91"></a><span id="l9.91" class="difflineplus">+          &lt;menuitem data-l10n-id=&quot;auth-yes&quot; value=&quot;yes&quot; /&gt;</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineplus">+          &lt;menuitem data-l10n-id=&quot;auth-no&quot; value=&quot;no&quot; /&gt;</span>
<a href="#l9.93"></a><span id="l9.93">         &lt;/menupopup&gt;</span>
<a href="#l9.94"></a><span id="l9.94">       &lt;/menulist&gt;</span>
<a href="#l9.95"></a><span id="l9.95">     &lt;/hbox&gt;</span>
<a href="#l9.96"></a><span id="l9.96">   &lt;/groupbox&gt;</span>
<a href="#l9.97"></a><span id="l9.97"> </span>
<a href="#l9.98"></a><span id="l9.98">   &lt;groupbox id=&quot;ask&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineminus">-    &lt;description id=&quot;askLabel&quot; style=&quot;width: 300px; white-space: pre-wrap;&quot; /&gt;</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineplus">+    &lt;label id=&quot;receivedQuestionLabel&quot; data-l10n-id=&quot;auth-questionReceived&quot; /&gt;</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineplus">+    &lt;description id=&quot;receivedQuestion&quot; style=&quot;width: 300px; white-space: pre-wrap;&quot; /&gt;</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineplus">+    &lt;label id=&quot;responseLabel&quot; control=&quot;response&quot; flex=&quot;1&quot; /&gt;</span>
<a href="#l9.103"></a><span id="l9.103">     &lt;textbox id=&quot;response&quot; oninput=&quot;otrAuth.oninput(this)&quot; /&gt;</span>
<a href="#l9.104"></a><span id="l9.104">   &lt;/groupbox&gt;</span>
<a href="#l9.105"></a><span id="l9.105"> </span>
<a href="#l9.106"></a><span id="l9.106"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">deleted file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- a/chat/content/otr-chat.dtd</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ /dev/null</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -1,8 +0,0 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineminus">-</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineminus">-&lt;!ENTITY state.label        &quot;Encryption Status:&quot;&gt;</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineminus">-&lt;!ENTITY start.label        &quot;Start private conversation&quot;&gt;</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineminus">-&lt;!ENTITY end.label          &quot;End private conversation&quot;&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-&lt;!ENTITY auth.label         &quot;Verify your contact's identity&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">deleted file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- a/chat/content/otr-generate-key.dtd</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ /dev/null</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -1,6 +0,0 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineminus">-</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-&lt;!ENTITY privDialog.title &quot;Generating private key&quot;&gt;</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">-&lt;!ENTITY privDialog.done &quot;Done&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/chat/content/otr-generate-key.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/chat/content/otr-generate-key.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -3,27 +3,29 @@</span>
<a href="#l12.4"></a><span id="l12.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.5"></a><span id="l12.5"> </span>
<a href="#l12.6"></a><span id="l12.6"> const {</span>
<a href="#l12.7"></a><span id="l12.7">   XPCOMUtils,</span>
<a href="#l12.8"></a><span id="l12.8">   l10nHelper,</span>
<a href="#l12.9"></a><span id="l12.9"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l12.10"></a><span id="l12.10"> const {OTR} = ChromeUtils.import(&quot;resource:///modules/OTR.jsm&quot;);</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-  l10nHelper(&quot;chrome://chat/content/otr-generate-key.properties&quot;)</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-);</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-</span>
<a href="#l12.16"></a><span id="l12.16"> var otrPriv = {</span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  onload() {</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  async onload() {</span>
<a href="#l12.20"></a><span id="l12.20">     let args = window.arguments[0].wrappedJSObject;</span>
<a href="#l12.21"></a><span id="l12.21">     let priv = document.getElementById(&quot;priv&quot;);</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineminus">-    priv.textContent = _(&quot;priv.account&quot;, args.account, OTR.protocolName(args.protocol));</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+    let text = await document.l10n.formatValue(</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+      &quot;otr-genkey-account&quot;, {name: args.account, protocol: OTR.protocolName(args.protocol)});</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+    priv.textContent = text;</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+console.log(&quot;genkey: &quot; + text);</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+</span>
<a href="#l12.29"></a><span id="l12.29">     OTR.generatePrivateKey(args.account, args.protocol).then(function() {</span>
<a href="#l12.30"></a><span id="l12.30">       document.documentElement.getButton(&quot;accept&quot;).disabled = false;</span>
<a href="#l12.31"></a><span id="l12.31">       document.documentElement.acceptDialog();</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-    }).catch(function(err) {</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+    }).catch(async function(err) {</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+      priv.textContent = await document.l10n.formatValue(</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+          &quot;otr-genkey-failed&quot;, {error: String(err)});</span>
<a href="#l12.36"></a><span id="l12.36">       document.documentElement.getButton(&quot;accept&quot;).disabled = false;</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineminus">-      priv.textContent = _(&quot;priv.failed&quot;, String(err));</span>
<a href="#l12.38"></a><span id="l12.38">     });</span>
<a href="#l12.39"></a><span id="l12.39">   },</span>
<a href="#l12.40"></a><span id="l12.40"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">deleted file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- a/chat/content/otr-generate-key.properties</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ /dev/null</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -1,8 +0,0 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineminus">-</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineminus">-# LOCALIZATION NOTE (priv.account): 1st %S is the name of the user's own chat account. 2nd %S is the chat communication protocol used by that account.</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineminus">-priv.account=Generating private key for %S (%S) </span>
<a href="#l13.11"></a><span id="l13.11" class="difflineminus">-# LOCALIZATION NOTE (priv.failed): %S contains an error message that describes the cause of the failure</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-priv.failed=Generating key failed: %S</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/chat/content/otr-generate-key.xul</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/chat/content/otr-generate-key.xul</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,26 +1,28 @@</span>
<a href="#l14.4"></a><span id="l14.4"> &lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<a href="#l14.5"></a><span id="l14.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.6"></a><span id="l14.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.7"></a><span id="l14.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot; ?&gt;</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11" class="difflineminus">-&lt;!DOCTYPE dialog [</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  &lt;!ENTITY % chatPrivDTD SYSTEM &quot;chrome://chat/content/otr-generate-key.dtd&quot;&gt;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-  %chatPrivDTD;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-]&gt;</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+&lt;!DOCTYPE dialog&gt;</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17"> &lt;dialog</span>
<a href="#l14.18"></a><span id="l14.18">   xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+  xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l14.20"></a><span id="l14.20">   id=&quot;otrPrivDialog&quot;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+  data-l10n-id=&quot;otr-generate-key&quot;</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineplus">+  data-l10n-attrs=&quot;buttonlabelaccept&quot;</span>
<a href="#l14.23"></a><span id="l14.23">   windowtype=&quot;OTR:Priv&quot;</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineminus">-  title=&quot;&amp;privDialog.title;&quot;</span>
<a href="#l14.25"></a><span id="l14.25">   buttons=&quot;accept&quot;</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-  buttonlabelaccept=&quot;&amp;privDialog.done;&quot;</span>
<a href="#l14.27"></a><span id="l14.27">   onload=&quot;otrPriv.onload()&quot;</span>
<a href="#l14.28"></a><span id="l14.28">   buttondisabledaccept=&quot;true&quot;&gt;</span>
<a href="#l14.29"></a><span id="l14.29"> </span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+  &lt;linkset&gt;</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+    &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/otr/generate-key.ftl&quot;/&gt;</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+  &lt;/linkset&gt;</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+</span>
<a href="#l14.34"></a><span id="l14.34">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://chat/content/otr-generate-key.js&quot; /&gt;</span>
<a href="#l14.35"></a><span id="l14.35">   &lt;description id=&quot;priv&quot; style=&quot;width: 300px; white-space: pre-wrap;&quot;&gt;&lt;/description&gt;</span>
<a href="#l14.36"></a><span id="l14.36"> </span>
<a href="#l14.37"></a><span id="l14.37"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">deleted file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- a/chat/content/otr.properties</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ /dev/null</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -1,72 +0,0 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineminus">-</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineminus">-# LOCALIZATION NOTE (msgevent.encryption_required_part1): %S is the name of a chat contact</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineminus">-msgevent.encryption_required_part1=You attempted to send an unencrypted message to %S. As a policy, unencrypted messages are not allowed.</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineminus">-msgevent.encryption_required_part2=Attempting to start a private conversation. Your message will be retransmitted when the private conversation starts.</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-msgevent.encryption_error=An error occurred when encrypting your message. The message was not sent.</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-# LOCALIZATION NOTE (msgevent.connection_ended): %S is the name of a chat contact</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-msgevent.connection_ended=%S has already closed their private connection to you. Your message was not sent. Either end your private conversation, or restart it.</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-# LOCALIZATION NOTE (msgevent.setup_error): %S is the name of a chat contact</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-msgevent.setup_error=An error occured while setting up a private conversation with %S.</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">-# LOCALIZATION NOTE (msgevent.msg_reflected): do not translate OTR which is the name of an encryption protocol</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">-msgevent.msg_reflected=You are receiving your own OTR messages. You are either trying to talk to yourself, or someone is reflecting your messages back at you.</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineminus">-</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-# LOCALIZATION NOTE (msgevent.msg_resent): %S is the name of a chat contact</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-msgevent.msg_resent=The last message to %S was resent.</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_not_private): %S is the name of a chat contact</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineminus">-msgevent.rcvdmsg_not_private=The encrypted message received from %S is unreadable, as you are not currently communicating privately.</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineminus">-</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_unreadable): %S is the name of a chat contact</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineminus">-msgevent.rcvdmsg_unreadable=We received an unreadable encrypted message from %S.</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineminus">-</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_malformed): %S is the name of a chat contact</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineminus">-msgevent.rcvdmsg_malformed=We received a malformed data message from %S.</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineminus">-# LOCALIZATION NOTE (msgevent.log_heartbeat_rcvd): %S is the name of a chat contact. A Heartbeat is a technical message used to keep a connection alive.</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineminus">-msgevent.log_heartbeat_rcvd=Heartbeat received from %S.</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineminus">-# LOCALIZATION NOTE (msgevent.log_heartbeat_sent): %S is the name of a chat contact. A Heartbeat is a technical message used to keep a connection alive.</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineminus">-msgevent.log_heartbeat_sent=Heartbeat sent to %S.</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineminus">-</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_general_err): do not translate OTR which is the name of an encryption protocol</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineminus">-msgevent.rcvdmsg_general_err=An OTR error occured.</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineminus">-</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_unencrypted): 1st %S is the name of a chat contact. 2nd %S is the message that was received.</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineminus">-msgevent.rcvdmsg_unencrypted=The following message received from %S was not encrypted: %S</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineminus">-</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_unrecognized): do not translate OTR which is the name of an encryption protocol. %S is the name of a chat contact.</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineminus">-msgevent.rcvdmsg_unrecognized=We received an unrecognized OTR message from %S.</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineminus">-</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineminus">-# LOCALIZATION NOTE (msgevent.rcvdmsg_for_other_instance): %S is the name of a chat contact</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineminus">-msgevent.rcvdmsg_for_other_instance=%S has sent a message intended for a different session. If you are logged in multiple times, another session may have received the message.</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineminus">-</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineminus">-# LOCALIZATION NOTE (context.gone_secure_private): %S is the name of a chat contact</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineminus">-context.gone_secure_private=Private conversation with %S started.</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineminus">-</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineminus">-# LOCALIZATION NOTE (context.gone_secure_unverified): %S is the name of a chat contact</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineminus">-context.gone_secure_unverified=Private conversation with %S started. However, their identity has not been verified.</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineminus">-</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineminus">-# LOCALIZATION NOTE (context.still_secure): %S is the name of a chat contact</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineminus">-context.still_secure=Successfully refreshed the private conversation with %S.</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineminus">-</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineminus">-error.enc=Error occurred encrypting message.</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineminus">-</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineminus">-# LOCALIZATION NOTE (error.not_priv): %S is the name of a chat contact</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineminus">-error.not_priv=You sent encrypted data to %S, who wasn't expecting it.</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineminus">-error.unreadable=You transmitted an unreadable encrypted message.</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineminus">-error.malformed=You transmitted a malformed data message.</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineminus">-resent=[resent]</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineminus">-# LOCALIZATION NOTE (tlv.disconnected): %S is the name of a chat contact</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineminus">-tlv.disconnected=%S has ended their private conversation with you; you should do the same.</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineminus">-# LOCALIZATION NOTE (query.msg): %S is the name of a chat contact. Do not translate &quot;Off-the-Record&quot; and &quot;OTR&quot; which is the name of an encryption protocol</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineminus">-query.msg=%S has requested an Off-the-Record (OTR) private conversation. However, you do not have a plugin to support that. See https://en.wikipedia.org/wiki/Off-the-Record_Messaging for more information.</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineminus">-trust.unused=Unused</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineminus">-trust.not_private=Not Private</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineminus">-trust.unverified=Unverified</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineminus">-trust.private=Private</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineminus">-trust.finished=Finished</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">new file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- /dev/null</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ b/chat/content/otr/add-finger.ftl</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -0,0 +1,16 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineplus">+</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+otr-add-finger =</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineplus">+    .title = Add Fingerprint</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineplus">+    .buttonlabelcancel = Skip</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+# Variables:</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+#   $name (String) - name of a chat contact person</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+otr-add-finger-name-title = Enter the fingerprint of the OTR key used by { $name }</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+otr-add-finger-fingerprint = Fingerprint</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+# Do not translate 'OTR' (name of an encryption protocol)</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+otr-add-finger-tooltip = If you know the 40 character long HEX fingerprint of your contact's OTR private key, enter it now.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">new file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- /dev/null</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ b/chat/content/otr/auth.ftl</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -0,0 +1,59 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+otr-auth =</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+    .title = Verify contact's identity</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+    .buttonlabelaccept = Verify</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+# Variables:</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+auth-title = Verify the identity of { $name }</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+# Variables:</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+#   $own_name (String) - the user's own screen name</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+auth-your-fp-value = Fingerprint for you, { $own_name }:</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+# Variables:</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+#   $their_name (String) - the screen name of a chat contact</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+auth-their-fp-value = Purported fingerprint for { $their_name }:</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+auth-help = Verifying a contact's identity helps ensure that the person you are talking to is who they claim to be.</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineplus">+auth-helpTitle = Verification help</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineplus">+auth-questionReceived = This is the question asked by your contact:</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineplus">+</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineplus">+auth-yes =</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+    .label = Yes</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+auth-no =</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+    .label = No</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineplus">+</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineplus">+auth-verified = I have verified that this is in fact the correct fingerprint.</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineplus">+</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineplus">+auth-manualVerification = Manual fingerprint verification</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineplus">+auth-questionAndAnswer = Question and answer</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineplus">+auth-sharedSecret = Shared secret</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineplus">+</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineplus">+auth-manualVerification-label =</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineplus">+    .label = { auth-manualVerification }</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineplus">+</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineplus">+auth-questionAndAnswer-label =</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineplus">+    .label = { auth-questionAndAnswer }</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineplus">+</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineplus">+auth-sharedSecret-label =</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineplus">+    .label = { auth-sharedSecret }</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineplus">+</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineplus">+auth-manualInstruction = To verify the fingerprint, contact your conversation partner via some other authenticated channel, such as the telephone or GPG-signed email. Both conversation partners should tell the other person their fingerprint. If the fingerprint matches, you should indicate in the dialog below that you have verified the fingerprint.</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineplus">+</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineplus">+auth-how = How would you like to verify your contact's identity?</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineplus">+</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+auth-qaInstruction = To verify their identity, pick a question whose answer is known only to you and your contact. Enter this question and answer, then wait for your contact to enter the answer as well. If the answers do not match, then you may be talking to an imposter.</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineplus">+</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineplus">+auth-secretInstruction = To verify their identity, pick a secret known only to you and your contact. Enter this secret, then wait for your contact to enter it as well. If the secrets do not match, then you may be talking to an imposter.</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineplus">+</span>
<a href="#l17.59"></a><span id="l17.59" class="difflineplus">+auth-question = Enter question here:</span>
<a href="#l17.60"></a><span id="l17.60" class="difflineplus">+</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineplus">+auth-answer = Enter secret answer here (case sensitive):</span>
<a href="#l17.62"></a><span id="l17.62" class="difflineplus">+</span>
<a href="#l17.63"></a><span id="l17.63" class="difflineplus">+auth-secret = Enter secret here:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">new file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- /dev/null</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ b/chat/content/otr/chat.ftl</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -0,0 +1,19 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+state-label = Encryption Status:</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+start-text = Start private conversation</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+start-label =</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+    .label = { start-text }</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+start-tooltip =</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+    .tooltiptext = { start-text }</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineplus">+</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+end-label =</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineplus">+    .label = End private conversation</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineplus">+</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+auth-label =</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+    .label = Verify your contact's identity</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">new file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- /dev/null</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ b/chat/content/otr/generate-key.ftl</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -0,0 +1,16 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineplus">+</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+otr-generate-key =</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+    .title = Generating private key</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineplus">+    .buttonlabelaccept = Done</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+# Variables:</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+#   $name (String) - the name of the user's own chat account</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+#   $protocol (String) - the chat communication protocol used by that account</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+otr-genkey-account = Generating private key for { $name }({ $protocol }) </span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+# Variables:</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+#   $error (String) - contains an error message that describes the cause of the failure</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+otr-genkey-failed = Generating key failed: { $error }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">new file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineminus">--- /dev/null</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineplus">+++ b/chat/content/otr/otr.ftl</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineat">@@ -0,0 +1,102 @@</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.6"></a><span id="l20.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l20.8"></a><span id="l20.8" class="difflineplus">+</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineplus">+# Variables:</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+msgevent-encryption_required_part1 = You attempted to send an unencrypted message to { $name }. As a policy, unencrypted messages are not allowed.</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+msgevent-encryption_required_part2 = Attempting to start a private conversation. Your message will be retransmitted when the private conversation starts.</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+msgevent-encryption_error = An error occurred when encrypting your message. The message was not sent.</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+# Variables:</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+msgevent-connection_ended = { $name } has already closed their private connection to you. Your message was not sent. Either end your private conversation, or restart it.</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineplus">+</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+# Variables:</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+msgevent-setup_error = An error occured while setting up a private conversation with { $name }.</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+# Do not translate 'OTR' (name of an encryption protocol)</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineplus">+msgevent-msg_reflected = You are receiving your own OTR messages. You are either trying to talk to yourself, or someone is reflecting your messages back at you.</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineplus">+# Variables:</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineplus">+msgevent-msg_resent = The last message to { $name } was resent.</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineplus">+</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+# Variables:</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+msgevent-rcvdmsg_not_private = The encrypted message received from { $name } is unreadable, as you are not currently communicating privately.</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+# Variables:</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineplus">+msgevent-rcvdmsg_unreadable = We received an unreadable encrypted message from { $name }.</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineplus">+</span>
<a href="#l20.39"></a><span id="l20.39" class="difflineplus">+# Variables:</span>
<a href="#l20.40"></a><span id="l20.40" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineplus">+msgevent-rcvdmsg_malformed = We received a malformed data message from { $name }.</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineplus">+</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineplus">+# A Heartbeat is a technical message used to keep a connection alive.</span>
<a href="#l20.44"></a><span id="l20.44" class="difflineplus">+# Variables:</span>
<a href="#l20.45"></a><span id="l20.45" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.46"></a><span id="l20.46" class="difflineplus">+msgevent-log_heartbeat_rcvd = Heartbeat received from { $name }.</span>
<a href="#l20.47"></a><span id="l20.47" class="difflineplus">+</span>
<a href="#l20.48"></a><span id="l20.48" class="difflineplus">+# A Heartbeat is a technical message used to keep a connection alive.</span>
<a href="#l20.49"></a><span id="l20.49" class="difflineplus">+# Variables:</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.51"></a><span id="l20.51" class="difflineplus">+msgevent-log_heartbeat_sent = Heartbeat sent to { $name }.</span>
<a href="#l20.52"></a><span id="l20.52" class="difflineplus">+</span>
<a href="#l20.53"></a><span id="l20.53" class="difflineplus">+# Do not translate 'OTR' (name of an encryption protocol)</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineplus">+msgevent-rcvdmsg_general_err = An OTR error occured.</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineplus">+</span>
<a href="#l20.56"></a><span id="l20.56" class="difflineplus">+# Variables:</span>
<a href="#l20.57"></a><span id="l20.57" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.58"></a><span id="l20.58" class="difflineplus">+#   $msg (string) - the message that was received.</span>
<a href="#l20.59"></a><span id="l20.59" class="difflineplus">+msgevent-rcvdmsg_unencrypted = The following message received from { $name } was not encrypted: { $msg }</span>
<a href="#l20.60"></a><span id="l20.60" class="difflineplus">+</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineplus">+# Do not translate 'OTR' (name of an encryption protocol)</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineplus">+# Variables:</span>
<a href="#l20.63"></a><span id="l20.63" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.64"></a><span id="l20.64" class="difflineplus">+msgevent-rcvdmsg_unrecognized = We received an unrecognized OTR message from { $name }.</span>
<a href="#l20.65"></a><span id="l20.65" class="difflineplus">+</span>
<a href="#l20.66"></a><span id="l20.66" class="difflineplus">+# Variables:</span>
<a href="#l20.67"></a><span id="l20.67" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.68"></a><span id="l20.68" class="difflineplus">+msgevent-rcvdmsg_for_other_instance = { $name } has sent a message intended for a different session. If you are logged in multiple times, another session may have received the message.</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineplus">+</span>
<a href="#l20.70"></a><span id="l20.70" class="difflineplus">+# Variables:</span>
<a href="#l20.71"></a><span id="l20.71" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.72"></a><span id="l20.72" class="difflineplus">+context-gone_secure_private = Private conversation with { $name } started.</span>
<a href="#l20.73"></a><span id="l20.73" class="difflineplus">+</span>
<a href="#l20.74"></a><span id="l20.74" class="difflineplus">+# Variables:</span>
<a href="#l20.75"></a><span id="l20.75" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.76"></a><span id="l20.76" class="difflineplus">+context-gone_secure_unverified = Private conversation with { $name } started. However, their identity has not been verified.</span>
<a href="#l20.77"></a><span id="l20.77" class="difflineplus">+</span>
<a href="#l20.78"></a><span id="l20.78" class="difflineplus">+# Variables:</span>
<a href="#l20.79"></a><span id="l20.79" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.80"></a><span id="l20.80" class="difflineplus">+context-still_secure = Successfully refreshed the private conversation with { $name }.</span>
<a href="#l20.81"></a><span id="l20.81" class="difflineplus">+</span>
<a href="#l20.82"></a><span id="l20.82" class="difflineplus">+error-enc = Error occurred encrypting message.</span>
<a href="#l20.83"></a><span id="l20.83" class="difflineplus">+</span>
<a href="#l20.84"></a><span id="l20.84" class="difflineplus">+# Variables:</span>
<a href="#l20.85"></a><span id="l20.85" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.86"></a><span id="l20.86" class="difflineplus">+error-not_priv = You sent encrypted data to { $name }, who wasn't expecting it.</span>
<a href="#l20.87"></a><span id="l20.87" class="difflineplus">+</span>
<a href="#l20.88"></a><span id="l20.88" class="difflineplus">+error-unreadable = You transmitted an unreadable encrypted message.</span>
<a href="#l20.89"></a><span id="l20.89" class="difflineplus">+error-malformed = You transmitted a malformed data message.</span>
<a href="#l20.90"></a><span id="l20.90" class="difflineplus">+</span>
<a href="#l20.91"></a><span id="l20.91" class="difflineplus">+resent = [resent]</span>
<a href="#l20.92"></a><span id="l20.92" class="difflineplus">+</span>
<a href="#l20.93"></a><span id="l20.93" class="difflineplus">+# Variables:</span>
<a href="#l20.94"></a><span id="l20.94" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.95"></a><span id="l20.95" class="difflineplus">+tlv-disconnected = { $name } has ended their private conversation with you; you should do the same.</span>
<a href="#l20.96"></a><span id="l20.96" class="difflineplus">+</span>
<a href="#l20.97"></a><span id="l20.97" class="difflineplus">+# Do not translate &quot;Off-the-Record&quot; and &quot;OTR&quot; which is the name of an encryption protocol</span>
<a href="#l20.98"></a><span id="l20.98" class="difflineplus">+# Variables:</span>
<a href="#l20.99"></a><span id="l20.99" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l20.100"></a><span id="l20.100" class="difflineplus">+query-msg = { $name } has requested an Off-the-Record (OTR) private conversation. However, you do not have a plugin to support that. See https://en.wikipedia.org/wiki/Off-the-Record_Messaging for more information.</span>
<a href="#l20.101"></a><span id="l20.101" class="difflineplus">+</span>
<a href="#l20.102"></a><span id="l20.102" class="difflineplus">+trust-unused = Unused</span>
<a href="#l20.103"></a><span id="l20.103" class="difflineplus">+trust-not_private = Not Private</span>
<a href="#l20.104"></a><span id="l20.104" class="difflineplus">+trust-unverified = Unverified</span>
<a href="#l20.105"></a><span id="l20.105" class="difflineplus">+trust-private = Private</span>
<a href="#l20.106"></a><span id="l20.106" class="difflineplus">+trust-finished = Finished</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">new file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- /dev/null</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ b/chat/content/otr/otrUI.ftl</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -0,0 +1,73 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineplus">+</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineplus">+start-label = Start private conversation</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+refresh-label = Refresh private conversation</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineplus">+auth-label = Verify your contact's identity</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+reauth-label = Reverify your contact's identity</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+auth-cancel = Cancel</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+auth-cancelAccessKey = C</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+auth-error = An error occurred while verifying your contact's identity.</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+auth-success = Verifying your contact's identity completed successfully.</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+auth-successThem = Your contact has successfully verified your identity. You may want to verify their identity as well by asking your own question.</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineplus">+auth-fail = Failed to verify your contact's identity.</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineplus">+auth-waiting = Waiting for contact to complete verification </span>
<a href="#l21.22"></a><span id="l21.22" class="difflineplus">+</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineplus">+finger-verify = Verify</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineplus">+finger-verify-accessKey = V</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineplus">+</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineplus">+# Do not translate 'OTR' (name of an encryption protocol)</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineplus">+buddycontextmenu-label = Add Contact's OTR Fingerprint</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineplus">+</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineplus">+# Variables:</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineplus">+alert-start = Attempting to start a private conversation with { $name }.</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineplus">+# Variables:</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+alert-refresh = Attempting to refresh the private conversation with { $name }.</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineplus">+</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+# Variables:</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineplus">+alert-gone_insecure = Private conversation with { $name } ended.</span>
<a href="#l21.40"></a><span id="l21.40" class="difflineplus">+</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineplus">+# Variables:</span>
<a href="#l21.42"></a><span id="l21.42" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineplus">+finger-unseen = The identity of { $name } has not been verified yet. Casual eavesdropping is not possible, but with some effort someone could be listening in. You should verify this contact's identity.</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineplus">+</span>
<a href="#l21.45"></a><span id="l21.45" class="difflineplus">+state-not_private = The current conversation is not private.</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineplus">+</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineplus">+# Variables:</span>
<a href="#l21.48"></a><span id="l21.48" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineplus">+state-unverified = The current conversation is private but the identity of { $name } has not been verified.</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineplus">+</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineplus">+# Variables:</span>
<a href="#l21.52"></a><span id="l21.52" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineplus">+state-private = The current conversation is private and the identity of { $name } has been verified.</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineplus">+</span>
<a href="#l21.55"></a><span id="l21.55" class="difflineplus">+# Variables:</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineplus">+state-finished = { $name } has ended their private conversation with you; you should do the same.</span>
<a href="#l21.58"></a><span id="l21.58" class="difflineplus">+</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineplus">+state-not_private-label = Insecure</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineplus">+state-unverified-label = Unverified</span>
<a href="#l21.61"></a><span id="l21.61" class="difflineplus">+state-private-label = Private</span>
<a href="#l21.62"></a><span id="l21.62" class="difflineplus">+state-finished-label = Finished</span>
<a href="#l21.63"></a><span id="l21.63" class="difflineplus">+</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineplus">+# Variables:</span>
<a href="#l21.65"></a><span id="l21.65" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineplus">+afterauth-private = You have verified the identity of { $name }.</span>
<a href="#l21.67"></a><span id="l21.67" class="difflineplus">+</span>
<a href="#l21.68"></a><span id="l21.68" class="difflineplus">+# Variables:</span>
<a href="#l21.69"></a><span id="l21.69" class="difflineplus">+#   $name (String) - the screen name of a chat contact person</span>
<a href="#l21.70"></a><span id="l21.70" class="difflineplus">+afterauth-unverified = The identity of { $name } has not been verified.</span>
<a href="#l21.71"></a><span id="l21.71" class="difflineplus">+</span>
<a href="#l21.72"></a><span id="l21.72" class="difflineplus">+verify-title = Verify your contact's identity</span>
<a href="#l21.73"></a><span id="l21.73" class="difflineplus">+error-title = Error</span>
<a href="#l21.74"></a><span id="l21.74" class="difflineplus">+success-title = End to End Encryption</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineplus">+successThem-title = Verify your contact's identity</span>
<a href="#l21.76"></a><span id="l21.76" class="difflineplus">+fail-title = Unable to verify</span>
<a href="#l21.77"></a><span id="l21.77" class="difflineplus">+waiting-title = Verification request sent</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1">deleted file mode 100644</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineminus">--- a/chat/content/otrUI.properties</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineplus">+++ /dev/null</span>
<a href="#l22.4"></a><span id="l22.4" class="difflineat">@@ -1,59 +0,0 @@</span>
<a href="#l22.5"></a><span id="l22.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.6"></a><span id="l22.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.7"></a><span id="l22.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l22.8"></a><span id="l22.8" class="difflineminus">-</span>
<a href="#l22.9"></a><span id="l22.9" class="difflineminus">-start.label=Start private conversation</span>
<a href="#l22.10"></a><span id="l22.10" class="difflineminus">-refresh.label=Refresh private conversation</span>
<a href="#l22.11"></a><span id="l22.11" class="difflineminus">-auth.label=Verify your contact's identity</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-auth.cancel=Cancel</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-auth.cancelAccessKey=C</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-auth.error=An error occurred while verifying your contact's identity.</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-auth.success=Verifying your contact's identity completed successfully.</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineminus">-auth.successThem=Your contact has successfully verified your identity. You may want to verify their identity as well by asking your own question.</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineminus">-auth.fail=Failed to verify your contact's identity.</span>
<a href="#l22.18"></a><span id="l22.18" class="difflineminus">-auth.waiting=Waiting for contact to complete verification </span>
<a href="#l22.19"></a><span id="l22.19" class="difflineminus">-reauth.label=Reverify your contact's identity</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineminus">-finger.verify=Verify</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineminus">-verify.accessKey=V</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineminus">-</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineminus">-# LOCALIZATION NOTE (buddycontextmenu.label): do not translate OTR which is the name of an encryption protocol</span>
<a href="#l22.24"></a><span id="l22.24" class="difflineminus">-buddycontextmenu.label=Add Contact's OTR Fingerprint</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineminus">-</span>
<a href="#l22.26"></a><span id="l22.26" class="difflineminus">-# LOCALIZATION NOTE (alert.start): %S is the name of a chat contact</span>
<a href="#l22.27"></a><span id="l22.27" class="difflineminus">-alert.start=Attempting to start a private conversation with %S.</span>
<a href="#l22.28"></a><span id="l22.28" class="difflineminus">-# LOCALIZATION NOTE (alert.refresh): %S is the name of a chat contact</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-alert.refresh=Attempting to refresh the private conversation with %S.</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-# LOCALIZATION NOTE (alert.gone_insecure): %S is the name of a chat contact</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-alert.gone_insecure=Private conversation with %S ended.</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineminus">-</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">-# LOCALIZATION NOTE (finger.unseen): %S is the name of a chat contact</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-finger.unseen=The identity of %S has not been verified yet. Casual eavesdropping is not possible, but with some effort someone could be listening in. You should verify this contact's identity.</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">-</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineminus">-state.not_private=The current conversation is not private.</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineminus">-</span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">-# LOCALIZATION NOTE (state.unverified): %S is the name of a chat contact</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-state.unverified=The current conversation is private but the identity of %S has not been verified.</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineminus">-</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineminus">-# LOCALIZATION NOTE (state.private): %S is the name of a chat contact</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineminus">-state.private=The current conversation is private and the identity of %S has been verified.</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineminus">-</span>
<a href="#l22.44"></a><span id="l22.44" class="difflineminus">-# LOCALIZATION NOTE (state.finished): %S is the name of a chat contact</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineminus">-state.finished=%S has ended their private conversation with you; you should do the same.</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineminus">-</span>
<a href="#l22.47"></a><span id="l22.47" class="difflineminus">-state.not_private.label=Insecure</span>
<a href="#l22.48"></a><span id="l22.48" class="difflineminus">-state.unverified.label=Unverified</span>
<a href="#l22.49"></a><span id="l22.49" class="difflineminus">-state.private.label=Private</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-state.finished.label=Finished</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineminus">-# LOCALIZATION NOTE (afterauth.private): %S is the name of a chat contact</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineminus">-afterauth.private=You have verified the identity of %S.</span>
<a href="#l22.54"></a><span id="l22.54" class="difflineminus">-</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineminus">-# LOCALIZATION NOTE (afterauth.unverified): %S is the name of a chat contact</span>
<a href="#l22.56"></a><span id="l22.56" class="difflineminus">-afterauth.unverified=The identity of %S has not been verified.</span>
<a href="#l22.57"></a><span id="l22.57" class="difflineminus">-</span>
<a href="#l22.58"></a><span id="l22.58" class="difflineminus">-verify.title=Verify your contact's identity</span>
<a href="#l22.59"></a><span id="l22.59" class="difflineminus">-error.title=Error</span>
<a href="#l22.60"></a><span id="l22.60" class="difflineminus">-success.title=End to End Encryption</span>
<a href="#l22.61"></a><span id="l22.61" class="difflineminus">-successThem.title=Verify your contact's identity</span>
<a href="#l22.62"></a><span id="l22.62" class="difflineminus">-fail.title=Unable to verify</span>
<a href="#l22.63"></a><span id="l22.63" class="difflineminus">-waiting.title=Verification request sent</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/chat/modules/OTR.jsm</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/chat/modules/OTR.jsm</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,28 +1,34 @@</span>
<a href="#l23.4"></a><span id="l23.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.5"></a><span id="l23.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.6"></a><span id="l23.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8" class="difflineplus">+const { LocalizationSync } =</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineplus">+  ChromeUtils.import(&quot;resource://gre/modules/Localization.jsm&quot;, {});</span>
<a href="#l23.10"></a><span id="l23.10"> const {BasePromiseWorker} = ChromeUtils.import(&quot;resource://gre/modules/PromiseWorker.jsm&quot;);</span>
<a href="#l23.11"></a><span id="l23.11"> const {OS} = ChromeUtils.import(&quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l23.12"></a><span id="l23.12"> const {ctypes} = ChromeUtils.import(&quot;resource://gre/modules/ctypes.jsm&quot;);</span>
<a href="#l23.13"></a><span id="l23.13"> const {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">-const {</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-  l10nHelper,</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l23.18"></a><span id="l23.18"> const {CLib} = ChromeUtils.import(&quot;resource:///modules/CLib.jsm&quot;);</span>
<a href="#l23.19"></a><span id="l23.19"> const {OTRLib} = ChromeUtils.import(&quot;resource:///modules/OTRLib.jsm&quot;);</span>
<a href="#l23.20"></a><span id="l23.20"> var workerPath = &quot;chrome://chat/content/otrWorker.js&quot;;</span>
<a href="#l23.21"></a><span id="l23.21"> const {OTRHelpers} = ChromeUtils.import(&quot;resource:///modules/OTRHelpers.jsm&quot;);</span>
<a href="#l23.22"></a><span id="l23.22"> </span>
<a href="#l23.23"></a><span id="l23.23" class="difflineminus">-XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineminus">-  l10nHelper(&quot;chrome://chat/content/otr.properties&quot;)</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineminus">-);</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineplus">+const syncL10n = new LocalizationSync([</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineplus">+  &quot;messenger/otr/otr.ftl&quot;,</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineplus">+]);</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineplus">+</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineplus">+function _str(id) {</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineplus">+  return syncL10n.formatValue(id);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+}</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineplus">+</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineplus">+function _strArgs(id, args) {</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineplus">+  return syncL10n.formatValue(id, args);</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineplus">+}</span>
<a href="#l23.37"></a><span id="l23.37"> </span>
<a href="#l23.38"></a><span id="l23.38"> // some helpers</span>
<a href="#l23.39"></a><span id="l23.39"> </span>
<a href="#l23.40"></a><span id="l23.40"> function setInterval(fn, delay) {</span>
<a href="#l23.41"></a><span id="l23.41">   let timer = Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l23.42"></a><span id="l23.42">   timer.init(fn, delay, Ci.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l23.43"></a><span id="l23.43">   return timer;</span>
<a href="#l23.44"></a><span id="l23.44"> }</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineat">@@ -273,23 +279,23 @@ var OTR = {</span>
<a href="#l23.46"></a><span id="l23.46">       return OTR.trustState.TRUST_FINISHED;</span>
<a href="#l23.47"></a><span id="l23.47">     }</span>
<a href="#l23.48"></a><span id="l23.48">     return OTR.trustState.TRUST_NOT_PRIVATE;</span>
<a href="#l23.49"></a><span id="l23.49">   },</span>
<a href="#l23.50"></a><span id="l23.50"> </span>
<a href="#l23.51"></a><span id="l23.51">   getStatus(level) {</span>
<a href="#l23.52"></a><span id="l23.52">     switch (level) {</span>
<a href="#l23.53"></a><span id="l23.53">     case OTR.trustState.TRUST_NOT_PRIVATE:</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineminus">-      return _(&quot;trust.not_private&quot;);</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineplus">+      return _str(&quot;trust-not_private&quot;);</span>
<a href="#l23.56"></a><span id="l23.56">     case OTR.trustState.TRUST_UNVERIFIED:</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineminus">-      return _(&quot;trust.unverified&quot;);</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineplus">+      return _str(&quot;trust-unverified&quot;);</span>
<a href="#l23.59"></a><span id="l23.59">     case OTR.trustState.TRUST_PRIVATE:</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineminus">-      return _(&quot;trust.private&quot;);</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineplus">+      return _str(&quot;trust-private&quot;);</span>
<a href="#l23.62"></a><span id="l23.62">     case OTR.trustState.TRUST_FINISHED:</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineminus">-      return _(&quot;trust.finished&quot;);</span>
<a href="#l23.64"></a><span id="l23.64" class="difflineplus">+      return _str(&quot;trust-finished&quot;);</span>
<a href="#l23.65"></a><span id="l23.65">     }</span>
<a href="#l23.66"></a><span id="l23.66">     throw new Error(&quot;unknown level&quot;);</span>
<a href="#l23.67"></a><span id="l23.67">   },</span>
<a href="#l23.68"></a><span id="l23.68"> </span>
<a href="#l23.69"></a><span id="l23.69">   // get list of known fingerprints</span>
<a href="#l23.70"></a><span id="l23.70">   knownFingerprints() {</span>
<a href="#l23.71"></a><span id="l23.71">     let fps = [];</span>
<a href="#l23.72"></a><span id="l23.72">     for (</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineat">@@ -324,17 +330,17 @@ var OTR = {</span>
<a href="#l23.74"></a><span id="l23.74">         }</span>
<a href="#l23.75"></a><span id="l23.75">         fps.push({</span>
<a href="#l23.76"></a><span id="l23.76">           fpointer: fingerprint.contents.address(),</span>
<a href="#l23.77"></a><span id="l23.77">           fingerprint: OTR.hashToHuman(fingerprint),</span>
<a href="#l23.78"></a><span id="l23.78">           screenname: wContext.username,</span>
<a href="#l23.79"></a><span id="l23.79">           account: wContext.account,</span>
<a href="#l23.80"></a><span id="l23.80">           protocol: wContext.protocol,</span>
<a href="#l23.81"></a><span id="l23.81">           trust,</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineminus">-          status: used ? OTR.getStatus(best_level) : _(&quot;trust.unused&quot;),</span>
<a href="#l23.83"></a><span id="l23.83" class="difflineplus">+          status: used ? OTR.getStatus(best_level) : _str(&quot;trust-unused&quot;),</span>
<a href="#l23.84"></a><span id="l23.84">           purge: false,</span>
<a href="#l23.85"></a><span id="l23.85">         });</span>
<a href="#l23.86"></a><span id="l23.86">       }</span>
<a href="#l23.87"></a><span id="l23.87">     }</span>
<a href="#l23.88"></a><span id="l23.88">     return fps;</span>
<a href="#l23.89"></a><span id="l23.89">   },</span>
<a href="#l23.90"></a><span id="l23.90"> </span>
<a href="#l23.91"></a><span id="l23.91">   forgetFingerprints(fps) {</span>
<a href="#l23.92"></a><span id="l23.92" class="difflineat">@@ -492,17 +498,17 @@ var OTR = {</span>
<a href="#l23.93"></a><span id="l23.93">     );</span>
<a href="#l23.94"></a><span id="l23.94">     if (query.isNull()) {</span>
<a href="#l23.95"></a><span id="l23.95">       Cu.reportError(new Error(&quot;Sending query message failed.&quot;));</span>
<a href="#l23.96"></a><span id="l23.96">       return;</span>
<a href="#l23.97"></a><span id="l23.97">     }</span>
<a href="#l23.98"></a><span id="l23.98">     // Use the default msg to format the version.</span>
<a href="#l23.99"></a><span id="l23.99">     // We don't supprt v1 of the protocol so this should be fine.</span>
<a href="#l23.100"></a><span id="l23.100">     let queryMsg = /^\?OTR.*?\?/.exec(query.readString())[0] + &quot;\n&quot;;</span>
<a href="#l23.101"></a><span id="l23.101" class="difflineminus">-    queryMsg += _(&quot;query.msg&quot;, conv.account.normalizedName);</span>
<a href="#l23.102"></a><span id="l23.102" class="difflineplus">+    queryMsg += _strArgs(&quot;query-msg&quot;, {name: conv.account.normalizedName});</span>
<a href="#l23.103"></a><span id="l23.103">     conv.sendMsg(queryMsg);</span>
<a href="#l23.104"></a><span id="l23.104">     OTRLib.otrl_message_free(query);</span>
<a href="#l23.105"></a><span id="l23.105">   },</span>
<a href="#l23.106"></a><span id="l23.106"> </span>
<a href="#l23.107"></a><span id="l23.107">   trustState: {</span>
<a href="#l23.108"></a><span id="l23.108">     TRUST_NOT_PRIVATE: 0,</span>
<a href="#l23.109"></a><span id="l23.109">     TRUST_UNVERIFIED: 1,</span>
<a href="#l23.110"></a><span id="l23.110">     TRUST_PRIVATE: 2,</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineat">@@ -593,36 +599,36 @@ var OTR = {</span>
<a href="#l23.112"></a><span id="l23.112">   // The list of known fingerprints has changed.  Write them to disk.</span>
<a href="#l23.113"></a><span id="l23.113">   write_fingerprint_cb(opdata) {</span>
<a href="#l23.114"></a><span id="l23.114">     this.writeFingerprints();</span>
<a href="#l23.115"></a><span id="l23.115">   },</span>
<a href="#l23.116"></a><span id="l23.116"> </span>
<a href="#l23.117"></a><span id="l23.117">   // A ConnContext has entered a secure state.</span>
<a href="#l23.118"></a><span id="l23.118">   gone_secure_cb(opdata, context) {</span>
<a href="#l23.119"></a><span id="l23.119">     context = new Context(context);</span>
<a href="#l23.120"></a><span id="l23.120" class="difflineminus">-    let str = &quot;context.gone_secure_&quot; + (context.trust ? &quot;private&quot; : &quot;unverified&quot;);</span>
<a href="#l23.121"></a><span id="l23.121" class="difflineplus">+    let strid = &quot;context-gone_secure_&quot; + (context.trust ? &quot;private&quot; : &quot;unverified&quot;);</span>
<a href="#l23.122"></a><span id="l23.122">     this.notifyObservers(context, &quot;otr:msg-state&quot;);</span>
<a href="#l23.123"></a><span id="l23.123" class="difflineminus">-    this.sendAlert(context, _(str, context.username));</span>
<a href="#l23.124"></a><span id="l23.124" class="difflineplus">+    this.sendAlert(context, _strArgs(strid, {name: context.username}));</span>
<a href="#l23.125"></a><span id="l23.125">     if (this.verifyNudge &amp;&amp; !context.trust)</span>
<a href="#l23.126"></a><span id="l23.126">       this.notifyObservers(context, &quot;otr:unverified&quot;, &quot;unseen&quot;);</span>
<a href="#l23.127"></a><span id="l23.127">   },</span>
<a href="#l23.128"></a><span id="l23.128"> </span>
<a href="#l23.129"></a><span id="l23.129">   // A ConnContext has left a secure state.</span>
<a href="#l23.130"></a><span id="l23.130">   gone_insecure_cb(opdata, context) {</span>
<a href="#l23.131"></a><span id="l23.131">     // This isn't used. See: https://bugs.otr.im/lib/libotr/issues/48</span>
<a href="#l23.132"></a><span id="l23.132">   },</span>
<a href="#l23.133"></a><span id="l23.133"> </span>
<a href="#l23.134"></a><span id="l23.134">   // We have completed an authentication, using the D-H keys we already knew.</span>
<a href="#l23.135"></a><span id="l23.135">   // is_reply indicates whether we initiated the AKE.</span>
<a href="#l23.136"></a><span id="l23.136">   still_secure_cb(opdata, context, is_reply) {</span>
<a href="#l23.137"></a><span id="l23.137">     // Indicate the private conversation was refreshed.</span>
<a href="#l23.138"></a><span id="l23.138">     if (!is_reply) {</span>
<a href="#l23.139"></a><span id="l23.139">       context = new Context(context);</span>
<a href="#l23.140"></a><span id="l23.140">       this.notifyObservers(context, &quot;otr:msg-state&quot;);</span>
<a href="#l23.141"></a><span id="l23.141" class="difflineminus">-      this.sendAlert(context, _(&quot;context.still_secure&quot;, context.username));</span>
<a href="#l23.142"></a><span id="l23.142" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;context-still_secure&quot;, {name: context.username}));</span>
<a href="#l23.143"></a><span id="l23.143">     }</span>
<a href="#l23.144"></a><span id="l23.144">   },</span>
<a href="#l23.145"></a><span id="l23.145"> </span>
<a href="#l23.146"></a><span id="l23.146">   // Find the maximum message size supported by this protocol.</span>
<a href="#l23.147"></a><span id="l23.147">   max_message_size_cb(opdata, context) {</span>
<a href="#l23.148"></a><span id="l23.148">     context = new Context(context);</span>
<a href="#l23.149"></a><span id="l23.149">     // These values are, for the most part, from pidgin-otr's mms_table.</span>
<a href="#l23.150"></a><span id="l23.150">     switch (context.protocol) {</span>
<a href="#l23.151"></a><span id="l23.151" class="difflineat">@@ -660,42 +666,42 @@ var OTR = {</span>
<a href="#l23.152"></a><span id="l23.152">   },</span>
<a href="#l23.153"></a><span id="l23.153"> </span>
<a href="#l23.154"></a><span id="l23.154">   // Return a string according to the error event.</span>
<a href="#l23.155"></a><span id="l23.155">   otr_error_message_cb(opdata, context, err_code) {</span>
<a href="#l23.156"></a><span id="l23.156">     context = new Context(context);</span>
<a href="#l23.157"></a><span id="l23.157">     let msg;</span>
<a href="#l23.158"></a><span id="l23.158">     switch (err_code) {</span>
<a href="#l23.159"></a><span id="l23.159">     case OTRLib.errorCode.OTRL_ERRCODE_ENCRYPTION_ERROR:</span>
<a href="#l23.160"></a><span id="l23.160" class="difflineminus">-      msg = _(&quot;error.enc&quot;);</span>
<a href="#l23.161"></a><span id="l23.161" class="difflineplus">+      msg = _str(&quot;error-enc&quot;);</span>
<a href="#l23.162"></a><span id="l23.162">       break;</span>
<a href="#l23.163"></a><span id="l23.163">     case OTRLib.errorCode.OTRL_ERRCODE_MSG_NOT_IN_PRIVATE:</span>
<a href="#l23.164"></a><span id="l23.164" class="difflineminus">-      msg = _(&quot;error.not_priv&quot;, context.username);</span>
<a href="#l23.165"></a><span id="l23.165" class="difflineplus">+      msg = _strArgs(&quot;error-not_priv&quot;, context.username);</span>
<a href="#l23.166"></a><span id="l23.166">       break;</span>
<a href="#l23.167"></a><span id="l23.167">     case OTRLib.errorCode.OTRL_ERRCODE_MSG_UNREADABLE:</span>
<a href="#l23.168"></a><span id="l23.168" class="difflineminus">-      msg = _(&quot;error.unreadable&quot;);</span>
<a href="#l23.169"></a><span id="l23.169" class="difflineplus">+      msg = _str(&quot;error-unreadable&quot;);</span>
<a href="#l23.170"></a><span id="l23.170">       break;</span>
<a href="#l23.171"></a><span id="l23.171">     case OTRLib.errorCode.OTRL_ERRCODE_MSG_MALFORMED:</span>
<a href="#l23.172"></a><span id="l23.172" class="difflineminus">-      msg = _(&quot;error.malformed&quot;);</span>
<a href="#l23.173"></a><span id="l23.173" class="difflineplus">+      msg = _str(&quot;error-malformed&quot;);</span>
<a href="#l23.174"></a><span id="l23.174">       break;</span>
<a href="#l23.175"></a><span id="l23.175">     default:</span>
<a href="#l23.176"></a><span id="l23.176">       return null;</span>
<a href="#l23.177"></a><span id="l23.177">     }</span>
<a href="#l23.178"></a><span id="l23.178">     return CLib.strdup(msg);</span>
<a href="#l23.179"></a><span id="l23.179">   },</span>
<a href="#l23.180"></a><span id="l23.180"> </span>
<a href="#l23.181"></a><span id="l23.181">   // Deallocate a string returned by otr_error_message_cb.</span>
<a href="#l23.182"></a><span id="l23.182">   otr_error_message_free_cb(opdata, err_msg) {</span>
<a href="#l23.183"></a><span id="l23.183">     if (!err_msg.isNull())</span>
<a href="#l23.184"></a><span id="l23.184">       CLib.free(err_msg);</span>
<a href="#l23.185"></a><span id="l23.185">   },</span>
<a href="#l23.186"></a><span id="l23.186"> </span>
<a href="#l23.187"></a><span id="l23.187">   // Return a string that will be prefixed to any resent message.</span>
<a href="#l23.188"></a><span id="l23.188">   resent_msg_prefix_cb(opdata, context) {</span>
<a href="#l23.189"></a><span id="l23.189" class="difflineminus">-    return CLib.strdup(_(&quot;resent&quot;));</span>
<a href="#l23.190"></a><span id="l23.190" class="difflineplus">+    return CLib.strdup(_str(&quot;resent&quot;));</span>
<a href="#l23.191"></a><span id="l23.191">   },</span>
<a href="#l23.192"></a><span id="l23.192"> </span>
<a href="#l23.193"></a><span id="l23.193">   // Deallocate a string returned by resent_msg_prefix.</span>
<a href="#l23.194"></a><span id="l23.194">   resent_msg_prefix_free_cb(opdata, prefix) {</span>
<a href="#l23.195"></a><span id="l23.195">     if (!prefix.isNull())</span>
<a href="#l23.196"></a><span id="l23.196">       CLib.free(prefix);</span>
<a href="#l23.197"></a><span id="l23.197">   },</span>
<a href="#l23.198"></a><span id="l23.198"> </span>
<a href="#l23.199"></a><span id="l23.199" class="difflineat">@@ -734,60 +740,61 @@ var OTR = {</span>
<a href="#l23.200"></a><span id="l23.200">   // Handle and send the appropriate message(s) to the sender/recipient</span>
<a href="#l23.201"></a><span id="l23.201">   // depending on the message events.</span>
<a href="#l23.202"></a><span id="l23.202">   handle_msg_event_cb(opdata, msg_event, context, message, err) {</span>
<a href="#l23.203"></a><span id="l23.203">     context = new Context(context);</span>
<a href="#l23.204"></a><span id="l23.204">     switch (msg_event) {</span>
<a href="#l23.205"></a><span id="l23.205">     case OTRLib.messageEvent.OTRL_MSGEVENT_NONE:</span>
<a href="#l23.206"></a><span id="l23.206">       break;</span>
<a href="#l23.207"></a><span id="l23.207">     case OTRLib.messageEvent.OTRL_MSGEVENT_ENCRYPTION_REQUIRED:</span>
<a href="#l23.208"></a><span id="l23.208" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.encryption_required_part1&quot;, context.username));</span>
<a href="#l23.209"></a><span id="l23.209" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.encryption_required_part2&quot;));</span>
<a href="#l23.210"></a><span id="l23.210" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-encryption_required_part1&quot;, {name: context.username}));</span>
<a href="#l23.211"></a><span id="l23.211" class="difflineplus">+      this.sendAlert(context, _str(&quot;msgevent-encryption_required_part2&quot;));</span>
<a href="#l23.212"></a><span id="l23.212">       break;</span>
<a href="#l23.213"></a><span id="l23.213">     case OTRLib.messageEvent.OTRL_MSGEVENT_ENCRYPTION_ERROR:</span>
<a href="#l23.214"></a><span id="l23.214" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.encryption_error&quot;));</span>
<a href="#l23.215"></a><span id="l23.215" class="difflineplus">+      this.sendAlert(context, _str(&quot;msgevent-encryption_error&quot;));</span>
<a href="#l23.216"></a><span id="l23.216">       break;</span>
<a href="#l23.217"></a><span id="l23.217">     case OTRLib.messageEvent.OTRL_MSGEVENT_CONNECTION_ENDED:</span>
<a href="#l23.218"></a><span id="l23.218" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.connection_ended&quot;, context.username));</span>
<a href="#l23.219"></a><span id="l23.219" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-connection_ended&quot;, {name: context.username}));</span>
<a href="#l23.220"></a><span id="l23.220">       break;</span>
<a href="#l23.221"></a><span id="l23.221">     case OTRLib.messageEvent.OTRL_MSGEVENT_SETUP_ERROR:</span>
<a href="#l23.222"></a><span id="l23.222" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.setup_error&quot;, context.username));</span>
<a href="#l23.223"></a><span id="l23.223" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-setup_error&quot;, {name: context.username}));</span>
<a href="#l23.224"></a><span id="l23.224">       break;</span>
<a href="#l23.225"></a><span id="l23.225">     case OTRLib.messageEvent.OTRL_MSGEVENT_MSG_REFLECTED:</span>
<a href="#l23.226"></a><span id="l23.226" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.msg_reflected&quot;));</span>
<a href="#l23.227"></a><span id="l23.227" class="difflineplus">+      this.sendAlert(context, _str(&quot;msgevent-msg_reflected&quot;));</span>
<a href="#l23.228"></a><span id="l23.228">       break;</span>
<a href="#l23.229"></a><span id="l23.229">     case OTRLib.messageEvent.OTRL_MSGEVENT_MSG_RESENT:</span>
<a href="#l23.230"></a><span id="l23.230" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.msg_resent&quot;, context.username));</span>
<a href="#l23.231"></a><span id="l23.231" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-msg_resent&quot;, {name: context.username}));</span>
<a href="#l23.232"></a><span id="l23.232">       break;</span>
<a href="#l23.233"></a><span id="l23.233">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_NOT_IN_PRIVATE:</span>
<a href="#l23.234"></a><span id="l23.234" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.rcvdmsg_not_private&quot;, context.username));</span>
<a href="#l23.235"></a><span id="l23.235" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-rcvdmsg_not_private&quot;, {name: context.username}));</span>
<a href="#l23.236"></a><span id="l23.236">       break;</span>
<a href="#l23.237"></a><span id="l23.237">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_UNREADABLE:</span>
<a href="#l23.238"></a><span id="l23.238" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.rcvdmsg_unreadable&quot;, context.username));</span>
<a href="#l23.239"></a><span id="l23.239" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-rcvdmsg_unreadable&quot;, {name: context.username}));</span>
<a href="#l23.240"></a><span id="l23.240">       break;</span>
<a href="#l23.241"></a><span id="l23.241">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_MALFORMED:</span>
<a href="#l23.242"></a><span id="l23.242" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.rcvdmsg_malformed&quot;, context.username));</span>
<a href="#l23.243"></a><span id="l23.243" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-rcvdmsg_malformed&quot;, {name: context.username}));</span>
<a href="#l23.244"></a><span id="l23.244">       break;</span>
<a href="#l23.245"></a><span id="l23.245">     case OTRLib.messageEvent.OTRL_MSGEVENT_LOG_HEARTBEAT_RCVD:</span>
<a href="#l23.246"></a><span id="l23.246" class="difflineminus">-      this.log(_(&quot;msgevent.log_heartbeat_rcvd&quot;, context.username));</span>
<a href="#l23.247"></a><span id="l23.247" class="difflineplus">+      this.log(_strArgs(&quot;msgevent-log_heartbeat_rcvd&quot;, {name: context.username}));</span>
<a href="#l23.248"></a><span id="l23.248">       break;</span>
<a href="#l23.249"></a><span id="l23.249">     case OTRLib.messageEvent.OTRL_MSGEVENT_LOG_HEARTBEAT_SENT:</span>
<a href="#l23.250"></a><span id="l23.250" class="difflineminus">-      this.log(_(&quot;msgevent.log_heartbeat_sent&quot;, context.username));</span>
<a href="#l23.251"></a><span id="l23.251" class="difflineplus">+      this.log(_strArgs(&quot;msgevent-log_heartbeat_sent&quot;, {name: context.username}));</span>
<a href="#l23.252"></a><span id="l23.252">       break;</span>
<a href="#l23.253"></a><span id="l23.253">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_GENERAL_ERR:</span>
<a href="#l23.254"></a><span id="l23.254" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.rcvdmsg_general_err&quot;));</span>
<a href="#l23.255"></a><span id="l23.255" class="difflineplus">+      this.sendAlert(context, _str(&quot;msgevent-rcvdmsg_general_err&quot;));</span>
<a href="#l23.256"></a><span id="l23.256">       break;</span>
<a href="#l23.257"></a><span id="l23.257">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_UNENCRYPTED:</span>
<a href="#l23.258"></a><span id="l23.258" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.rcvdmsg_unencrypted&quot;, context.username, message.isNull() ? &quot;&quot; : message.readString()));</span>
<a href="#l23.259"></a><span id="l23.259" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-rcvdmsg_unencrypted&quot;,</span>
<a href="#l23.260"></a><span id="l23.260" class="difflineplus">+        {name: context.username, msg: message.isNull() ? &quot;&quot; : message.readString()}));</span>
<a href="#l23.261"></a><span id="l23.261">       break;</span>
<a href="#l23.262"></a><span id="l23.262">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_UNRECOGNIZED:</span>
<a href="#l23.263"></a><span id="l23.263" class="difflineminus">-      this.sendAlert(context, _(&quot;msgevent.rcvdmsg_unrecognized&quot;, context.username));</span>
<a href="#l23.264"></a><span id="l23.264" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;msgevent-rcvdmsg_unrecognized&quot;, {name: context.username}));</span>
<a href="#l23.265"></a><span id="l23.265">       break;</span>
<a href="#l23.266"></a><span id="l23.266">     case OTRLib.messageEvent.OTRL_MSGEVENT_RCVDMSG_FOR_OTHER_INSTANCE:</span>
<a href="#l23.267"></a><span id="l23.267" class="difflineminus">-      this.log(_(&quot;msgevent.rcvdmsg_for_other_instance&quot;, context.username));</span>
<a href="#l23.268"></a><span id="l23.268" class="difflineplus">+      this.log(_strArgs(&quot;msgevent-rcvdmsg_for_other_instance&quot;, {name: context.username}));</span>
<a href="#l23.269"></a><span id="l23.269">       break;</span>
<a href="#l23.270"></a><span id="l23.270">     default:</span>
<a href="#l23.271"></a><span id="l23.271">       this.log(&quot;msg event: &quot; + msg_event);</span>
<a href="#l23.272"></a><span id="l23.272">     }</span>
<a href="#l23.273"></a><span id="l23.273">   },</span>
<a href="#l23.274"></a><span id="l23.274"> </span>
<a href="#l23.275"></a><span id="l23.275">   // Create an instance tag for the given accountname/protocol if desired.</span>
<a href="#l23.276"></a><span id="l23.276">   create_instag_cb(opdata, accountname, protocol) {</span>
<a href="#l23.277"></a><span id="l23.277" class="difflineat">@@ -1036,17 +1043,17 @@ var OTR = {</span>
<a href="#l23.278"></a><span id="l23.278">     }</span>
<a href="#l23.279"></a><span id="l23.279"> </span>
<a href="#l23.280"></a><span id="l23.280">     // search tlvs for a disconnect msg</span>
<a href="#l23.281"></a><span id="l23.281">     // https://bugs.otr.im/lib/libotr/issues/54</span>
<a href="#l23.282"></a><span id="l23.282">     let tlv = OTRLib.otrl_tlv_find(tlvs, OTRLib.tlvs.OTRL_TLV_DISCONNECTED);</span>
<a href="#l23.283"></a><span id="l23.283">     if (!tlv.isNull()) {</span>
<a href="#l23.284"></a><span id="l23.284">       let context = this.getContext(conv);</span>
<a href="#l23.285"></a><span id="l23.285">       this.notifyObservers(context, &quot;otr:disconnected&quot;);</span>
<a href="#l23.286"></a><span id="l23.286" class="difflineminus">-      this.sendAlert(context, _(&quot;tlv.disconnected&quot;, conv.normalizedName));</span>
<a href="#l23.287"></a><span id="l23.287" class="difflineplus">+      this.sendAlert(context, _strArgs(&quot;tlv-disconnected&quot;, {name: conv.normalizedName}));</span>
<a href="#l23.288"></a><span id="l23.288">     }</span>
<a href="#l23.289"></a><span id="l23.289"> </span>
<a href="#l23.290"></a><span id="l23.290">     if (err) {</span>
<a href="#l23.291"></a><span id="l23.291">       this.log(&quot;error (&quot; + err + &quot;) ignoring: &quot; + im.displayMessage);</span>
<a href="#l23.292"></a><span id="l23.292">       im.cancelled = true;  // ignore</span>
<a href="#l23.293"></a><span id="l23.293">     } else {</span>
<a href="#l23.294"></a><span id="l23.294">       this.log(&quot;post receiving: &quot; + im.displayMessage);</span>
<a href="#l23.295"></a><span id="l23.295">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/chat/modules/OTRUI.jsm</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/chat/modules/OTRUI.jsm</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -1,86 +1,102 @@</span>
<a href="#l24.4"></a><span id="l24.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.5"></a><span id="l24.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.6"></a><span id="l24.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.7"></a><span id="l24.7"> </span>
<a href="#l24.8"></a><span id="l24.8"> this.EXPORTED_SYMBOLS = [&quot;OTRUI&quot;];</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10" class="difflineplus">+const { LocalizationSync } =</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+  ChromeUtils.import(&quot;resource://gre/modules/Localization.jsm&quot;, {});</span>
<a href="#l24.12"></a><span id="l24.12"> const {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-const {</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineminus">-  XPCOMUtils,</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-  l10nHelper,</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineminus">-} = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+const {OTR}  = ChromeUtils.import(&quot;resource:///modules/OTR.jsm&quot;);</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+const syncL10n = new LocalizationSync([</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+  &quot;messenger/otr/otrUI.ftl&quot;,</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+]);</span>
<a href="#l24.22"></a><span id="l24.22"> </span>
<a href="#l24.23"></a><span id="l24.23" class="difflineminus">-const {OTR}  = ChromeUtils.import(&quot;resource:///modules/OTR.jsm&quot;);</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+function _str(id) {</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+  return syncL10n.formatValue(id);</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+}</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineplus">+function _strArgs(id, args) {</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineplus">+  return syncL10n.formatValue(id, args);</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineplus">+}</span>
<a href="#l24.31"></a><span id="l24.31"> </span>
<a href="#l24.32"></a><span id="l24.32"> const privDialog = &quot;chrome://chat/content/otr-generate-key.xul&quot;;</span>
<a href="#l24.33"></a><span id="l24.33"> const authDialog = &quot;chrome://chat/content/otr-auth.xul&quot;;</span>
<a href="#l24.34"></a><span id="l24.34"> const addFingerDialog = &quot;chrome://chat/content/otr-add-fingerprint.xul&quot;;</span>
<a href="#l24.35"></a><span id="l24.35"> </span>
<a href="#l24.36"></a><span id="l24.36" class="difflineminus">-XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineminus">-  l10nHelper(&quot;chrome://chat/content/otrUI.properties&quot;)</span>
<a href="#l24.38"></a><span id="l24.38" class="difflineminus">-);</span>
<a href="#l24.39"></a><span id="l24.39" class="difflineminus">-</span>
<a href="#l24.40"></a><span id="l24.40"> const authVerify = &quot;otr-auth-unverified&quot;;</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineplus">+var authLabelMap;</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineplus">+var authTitleMap;</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineplus">+var trustMap;</span>
<a href="#l24.44"></a><span id="l24.44"> </span>
<a href="#l24.45"></a><span id="l24.45" class="difflineminus">-var authLabelMap = new Map([</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineminus">-  [&quot;otr:auth-error&quot;, _(&quot;auth.error&quot;)],</span>
<a href="#l24.47"></a><span id="l24.47" class="difflineminus">-  [&quot;otr:auth-success&quot;, _(&quot;auth.success&quot;)],</span>
<a href="#l24.48"></a><span id="l24.48" class="difflineminus">-  [&quot;otr:auth-successThem&quot;, _(&quot;auth.successThem&quot;)],</span>
<a href="#l24.49"></a><span id="l24.49" class="difflineminus">-  [&quot;otr:auth-fail&quot;, _(&quot;auth.fail&quot;)],</span>
<a href="#l24.50"></a><span id="l24.50" class="difflineminus">-  [&quot;otr:auth-waiting&quot;, _(&quot;auth.waiting&quot;)],</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineminus">-]);</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineplus">+function initStrings() {</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineplus">+  authLabelMap = new Map([</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineplus">+    [&quot;otr:auth-error&quot;, _str(&quot;auth-error&quot;)],</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineplus">+    [&quot;otr:auth-success&quot;, _str(&quot;auth-success&quot;)],</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineplus">+    [&quot;otr:auth-successThem&quot;, _str(&quot;auth-successThem&quot;)],</span>
<a href="#l24.57"></a><span id="l24.57" class="difflineplus">+    [&quot;otr:auth-fail&quot;, _str(&quot;auth-fail&quot;)],</span>
<a href="#l24.58"></a><span id="l24.58" class="difflineplus">+    [&quot;otr:auth-waiting&quot;, _str(&quot;auth-waiting&quot;)],</span>
<a href="#l24.59"></a><span id="l24.59" class="difflineplus">+  ]);</span>
<a href="#l24.60"></a><span id="l24.60"> </span>
<a href="#l24.61"></a><span id="l24.61" class="difflineminus">-var authTitleMap = new Map([</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineminus">-  [&quot;otr:auth-error&quot;, &quot;error&quot;],</span>
<a href="#l24.63"></a><span id="l24.63" class="difflineminus">-  [&quot;otr:auth-success&quot;, &quot;success&quot;],</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineminus">-  [&quot;otr:auth-successThem&quot;, &quot;successThem&quot;],</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineminus">-  [&quot;otr:auth-fail&quot;, &quot;fail&quot;],</span>
<a href="#l24.66"></a><span id="l24.66" class="difflineminus">-  [&quot;otr:auth-waiting&quot;, &quot;waiting&quot;],</span>
<a href="#l24.67"></a><span id="l24.67" class="difflineminus">-]);</span>
<a href="#l24.68"></a><span id="l24.68" class="difflineplus">+  authTitleMap = new Map([</span>
<a href="#l24.69"></a><span id="l24.69" class="difflineplus">+    [&quot;otr:auth-error&quot;, _str(&quot;error-title&quot;)],</span>
<a href="#l24.70"></a><span id="l24.70" class="difflineplus">+    [&quot;otr:auth-success&quot;, _str(&quot;success-title&quot;)],</span>
<a href="#l24.71"></a><span id="l24.71" class="difflineplus">+    [&quot;otr:auth-successThem&quot;, _str(&quot;successThem-title&quot;)],</span>
<a href="#l24.72"></a><span id="l24.72" class="difflineplus">+    [&quot;otr:auth-fail&quot;, _str(&quot;fail-title&quot;)],</span>
<a href="#l24.73"></a><span id="l24.73" class="difflineplus">+    [&quot;otr:auth-waiting&quot;, _str(&quot;waiting-title&quot;)],</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineplus">+  ]);</span>
<a href="#l24.75"></a><span id="l24.75" class="difflineplus">+</span>
<a href="#l24.76"></a><span id="l24.76" class="difflineplus">+  let sl = _str(&quot;start-label&quot;);</span>
<a href="#l24.77"></a><span id="l24.77" class="difflineplus">+  let al = _str(&quot;auth-label&quot;);</span>
<a href="#l24.78"></a><span id="l24.78" class="difflineplus">+  let rfl = _str(&quot;refresh-label&quot;);</span>
<a href="#l24.79"></a><span id="l24.79" class="difflineplus">+  let ral = _str(&quot;reauth-label&quot;);</span>
<a href="#l24.80"></a><span id="l24.80"> </span>
<a href="#l24.81"></a><span id="l24.81" class="difflineminus">-var trustMap = new Map([</span>
<a href="#l24.82"></a><span id="l24.82" class="difflineminus">-  [OTR.trustState.TRUST_NOT_PRIVATE, {</span>
<a href="#l24.83"></a><span id="l24.83" class="difflineminus">-    startLabel: _(&quot;start.label&quot;),</span>
<a href="#l24.84"></a><span id="l24.84" class="difflineminus">-    authLabel: _(&quot;auth.label&quot;),</span>
<a href="#l24.85"></a><span id="l24.85" class="difflineminus">-    disableStart: false,</span>
<a href="#l24.86"></a><span id="l24.86" class="difflineminus">-    disableEnd: true,</span>
<a href="#l24.87"></a><span id="l24.87" class="difflineminus">-    disableAuth: true,</span>
<a href="#l24.88"></a><span id="l24.88" class="difflineminus">-    class: &quot;not_private&quot;,</span>
<a href="#l24.89"></a><span id="l24.89" class="difflineminus">-  }],</span>
<a href="#l24.90"></a><span id="l24.90" class="difflineminus">-  [OTR.trustState.TRUST_UNVERIFIED, {</span>
<a href="#l24.91"></a><span id="l24.91" class="difflineminus">-    startLabel: _(&quot;refresh.label&quot;),</span>
<a href="#l24.92"></a><span id="l24.92" class="difflineminus">-    authLabel: _(&quot;auth.label&quot;),</span>
<a href="#l24.93"></a><span id="l24.93" class="difflineminus">-    disableStart: false,</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineminus">-    disableEnd: false,</span>
<a href="#l24.95"></a><span id="l24.95" class="difflineminus">-    disableAuth: false,</span>
<a href="#l24.96"></a><span id="l24.96" class="difflineminus">-    class: &quot;unverified&quot;,</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineminus">-  }],</span>
<a href="#l24.98"></a><span id="l24.98" class="difflineminus">-  [OTR.trustState.TRUST_PRIVATE, {</span>
<a href="#l24.99"></a><span id="l24.99" class="difflineminus">-    startLabel: _(&quot;refresh.label&quot;),</span>
<a href="#l24.100"></a><span id="l24.100" class="difflineminus">-    authLabel: _(&quot;reauth.label&quot;),</span>
<a href="#l24.101"></a><span id="l24.101" class="difflineminus">-    disableStart: false,</span>
<a href="#l24.102"></a><span id="l24.102" class="difflineminus">-    disableEnd: false,</span>
<a href="#l24.103"></a><span id="l24.103" class="difflineminus">-    disableAuth: false,</span>
<a href="#l24.104"></a><span id="l24.104" class="difflineminus">-    class: &quot;private&quot;,</span>
<a href="#l24.105"></a><span id="l24.105" class="difflineminus">-  }],</span>
<a href="#l24.106"></a><span id="l24.106" class="difflineminus">-  [OTR.trustState.TRUST_FINISHED, {</span>
<a href="#l24.107"></a><span id="l24.107" class="difflineminus">-    startLabel: _(&quot;start.label&quot;),</span>
<a href="#l24.108"></a><span id="l24.108" class="difflineminus">-    authLabel: _(&quot;auth.label&quot;),</span>
<a href="#l24.109"></a><span id="l24.109" class="difflineminus">-    disableStart: false,</span>
<a href="#l24.110"></a><span id="l24.110" class="difflineminus">-    disableEnd: false,</span>
<a href="#l24.111"></a><span id="l24.111" class="difflineminus">-    disableAuth: true,</span>
<a href="#l24.112"></a><span id="l24.112" class="difflineminus">-    class: &quot;finished&quot;,</span>
<a href="#l24.113"></a><span id="l24.113" class="difflineminus">-  }],</span>
<a href="#l24.114"></a><span id="l24.114" class="difflineminus">-]);</span>
<a href="#l24.115"></a><span id="l24.115" class="difflineplus">+  trustMap = new Map([</span>
<a href="#l24.116"></a><span id="l24.116" class="difflineplus">+    [OTR.trustState.TRUST_NOT_PRIVATE, {</span>
<a href="#l24.117"></a><span id="l24.117" class="difflineplus">+      startLabel: sl,</span>
<a href="#l24.118"></a><span id="l24.118" class="difflineplus">+      authLabel: al,</span>
<a href="#l24.119"></a><span id="l24.119" class="difflineplus">+      disableStart: false,</span>
<a href="#l24.120"></a><span id="l24.120" class="difflineplus">+      disableEnd: true,</span>
<a href="#l24.121"></a><span id="l24.121" class="difflineplus">+      disableAuth: true,</span>
<a href="#l24.122"></a><span id="l24.122" class="difflineplus">+      class: &quot;not_private&quot;,</span>
<a href="#l24.123"></a><span id="l24.123" class="difflineplus">+    }],</span>
<a href="#l24.124"></a><span id="l24.124" class="difflineplus">+    [OTR.trustState.TRUST_UNVERIFIED, {</span>
<a href="#l24.125"></a><span id="l24.125" class="difflineplus">+      startLabel: rfl,</span>
<a href="#l24.126"></a><span id="l24.126" class="difflineplus">+      authLabel: al,</span>
<a href="#l24.127"></a><span id="l24.127" class="difflineplus">+      disableStart: false,</span>
<a href="#l24.128"></a><span id="l24.128" class="difflineplus">+      disableEnd: false,</span>
<a href="#l24.129"></a><span id="l24.129" class="difflineplus">+      disableAuth: false,</span>
<a href="#l24.130"></a><span id="l24.130" class="difflineplus">+      class: &quot;unverified&quot;,</span>
<a href="#l24.131"></a><span id="l24.131" class="difflineplus">+    }],</span>
<a href="#l24.132"></a><span id="l24.132" class="difflineplus">+    [OTR.trustState.TRUST_PRIVATE, {</span>
<a href="#l24.133"></a><span id="l24.133" class="difflineplus">+      startLabel: rfl,</span>
<a href="#l24.134"></a><span id="l24.134" class="difflineplus">+      authLabel: ral,</span>
<a href="#l24.135"></a><span id="l24.135" class="difflineplus">+      disableStart: false,</span>
<a href="#l24.136"></a><span id="l24.136" class="difflineplus">+      disableEnd: false,</span>
<a href="#l24.137"></a><span id="l24.137" class="difflineplus">+      disableAuth: false,</span>
<a href="#l24.138"></a><span id="l24.138" class="difflineplus">+      class: &quot;private&quot;,</span>
<a href="#l24.139"></a><span id="l24.139" class="difflineplus">+    }],</span>
<a href="#l24.140"></a><span id="l24.140" class="difflineplus">+    [OTR.trustState.TRUST_FINISHED, {</span>
<a href="#l24.141"></a><span id="l24.141" class="difflineplus">+      startLabel: sl,</span>
<a href="#l24.142"></a><span id="l24.142" class="difflineplus">+      authLabel: al,</span>
<a href="#l24.143"></a><span id="l24.143" class="difflineplus">+      disableStart: false,</span>
<a href="#l24.144"></a><span id="l24.144" class="difflineplus">+      disableEnd: false,</span>
<a href="#l24.145"></a><span id="l24.145" class="difflineplus">+      disableAuth: true,</span>
<a href="#l24.146"></a><span id="l24.146" class="difflineplus">+      class: &quot;finished&quot;,</span>
<a href="#l24.147"></a><span id="l24.147" class="difflineplus">+    }],</span>
<a href="#l24.148"></a><span id="l24.148" class="difflineplus">+  ]);</span>
<a href="#l24.149"></a><span id="l24.149" class="difflineplus">+}</span>
<a href="#l24.150"></a><span id="l24.150"> </span>
<a href="#l24.151"></a><span id="l24.151"> var windowRefs = new Map();</span>
<a href="#l24.152"></a><span id="l24.152"> </span>
<a href="#l24.153"></a><span id="l24.153"> var OTRUI = {</span>
<a href="#l24.154"></a><span id="l24.154" class="difflineplus">+  stringsLoaded: false,</span>
<a href="#l24.155"></a><span id="l24.155">   globalDoc: null,</span>
<a href="#l24.156"></a><span id="l24.156">   visibleConv: null,</span>
<a href="#l24.157"></a><span id="l24.157"> </span>
<a href="#l24.158"></a><span id="l24.158">   debug: true,</span>
<a href="#l24.159"></a><span id="l24.159">   logMsg(msg) {</span>
<a href="#l24.160"></a><span id="l24.160">     if (!OTRUI.debug)</span>
<a href="#l24.161"></a><span id="l24.161">       return;</span>
<a href="#l24.162"></a><span id="l24.162">     Services.console.logStringMessage(msg);</span>
<a href="#l24.163"></a><span id="l24.163" class="difflineat">@@ -135,17 +151,17 @@ var OTRUI = {</span>
<a href="#l24.164"></a><span id="l24.164">     if (!buddyContextMenu || !OTR.libLoaded) {</span>
<a href="#l24.165"></a><span id="l24.165">       return;  // Not the buddy list context menu</span>
<a href="#l24.166"></a><span id="l24.166">     }</span>
<a href="#l24.167"></a><span id="l24.167">     OTRUI.removeBuddyContextMenu(doc);</span>
<a href="#l24.168"></a><span id="l24.168"> </span>
<a href="#l24.169"></a><span id="l24.169">     let sep = doc.createXULElement(&quot;menuseparator&quot;);</span>
<a href="#l24.170"></a><span id="l24.170">     sep.setAttribute(&quot;id&quot;, &quot;otrsep&quot;);</span>
<a href="#l24.171"></a><span id="l24.171">     let menuitem = doc.createXULElement(&quot;menuitem&quot;);</span>
<a href="#l24.172"></a><span id="l24.172" class="difflineminus">-    menuitem.setAttribute(&quot;label&quot;, _(&quot;buddycontextmenu.label&quot;));</span>
<a href="#l24.173"></a><span id="l24.173" class="difflineplus">+    menuitem.setAttribute(&quot;label&quot;, _str(&quot;buddycontextmenu.label&quot;));</span>
<a href="#l24.174"></a><span id="l24.174">     menuitem.setAttribute(&quot;id&quot;, &quot;otrcont&quot;);</span>
<a href="#l24.175"></a><span id="l24.175">     menuitem.addEventListener(&quot;command&quot;, () =&gt; {</span>
<a href="#l24.176"></a><span id="l24.176">       let target = buddyContextMenu.triggerNode;</span>
<a href="#l24.177"></a><span id="l24.177">       if (target.localName == &quot;richlistitem&quot;) {</span>
<a href="#l24.178"></a><span id="l24.178">         let contact = target.contact;</span>
<a href="#l24.179"></a><span id="l24.179">         let args = OTRUI.contactWrapper(contact);</span>
<a href="#l24.180"></a><span id="l24.180">         args.wrappedJSObject = args;</span>
<a href="#l24.181"></a><span id="l24.181">         let features = &quot;chrome,modal,centerscreen,resizable=no,minimizable=no&quot;;</span>
<a href="#l24.182"></a><span id="l24.182" class="difflineat">@@ -174,17 +190,22 @@ var OTRUI = {</span>
<a href="#l24.183"></a><span id="l24.183">       s.remove();</span>
<a href="#l24.184"></a><span id="l24.184">     }</span>
<a href="#l24.185"></a><span id="l24.185">     let p = doc.getElementById(&quot;otrcont&quot;);</span>
<a href="#l24.186"></a><span id="l24.186">     if (p) {</span>
<a href="#l24.187"></a><span id="l24.187">       p.remove();</span>
<a href="#l24.188"></a><span id="l24.188">     }</span>
<a href="#l24.189"></a><span id="l24.189">   },</span>
<a href="#l24.190"></a><span id="l24.190"> </span>
<a href="#l24.191"></a><span id="l24.191" class="difflineminus">-  init() {</span>
<a href="#l24.192"></a><span id="l24.192" class="difflineplus">+  async init() {</span>
<a href="#l24.193"></a><span id="l24.193" class="difflineplus">+    if (!OTRUI.stringsLoaded) {</span>
<a href="#l24.194"></a><span id="l24.194" class="difflineplus">+      initStrings();</span>
<a href="#l24.195"></a><span id="l24.195" class="difflineplus">+      OTRUI.stringsLoaded = true;</span>
<a href="#l24.196"></a><span id="l24.196" class="difflineplus">+    }</span>
<a href="#l24.197"></a><span id="l24.197" class="difflineplus">+</span>
<a href="#l24.198"></a><span id="l24.198">     // console.log(&quot;====&gt; OTRUI init\n&quot;);</span>
<a href="#l24.199"></a><span id="l24.199">     OTRUI.setPrefs();</span>
<a href="#l24.200"></a><span id="l24.200">     OTR.init({</span>
<a href="#l24.201"></a><span id="l24.201">       requireEncryption: OTRUI.prefs.getBoolPref(&quot;requireEncryption&quot;),</span>
<a href="#l24.202"></a><span id="l24.202">       verifyNudge: OTRUI.prefs.getBoolPref(&quot;verifyNudge&quot;),</span>
<a href="#l24.203"></a><span id="l24.203">     });</span>
<a href="#l24.204"></a><span id="l24.204">     if (!OTR.libLoaded) {</span>
<a href="#l24.205"></a><span id="l24.205">       return;</span>
<a href="#l24.206"></a><span id="l24.206" class="difflineat">@@ -272,17 +293,17 @@ var OTRUI = {</span>
<a href="#l24.207"></a><span id="l24.207">     if (context) {</span>
<a href="#l24.208"></a><span id="l24.208">       OTRUI.hideUserNotifications(context);</span>
<a href="#l24.209"></a><span id="l24.209">     } else {</span>
<a href="#l24.210"></a><span id="l24.210">       OTRUI.hideAllNotifications();</span>
<a href="#l24.211"></a><span id="l24.211">     }</span>
<a href="#l24.212"></a><span id="l24.212">   },</span>
<a href="#l24.213"></a><span id="l24.213"> </span>
<a href="#l24.214"></a><span id="l24.214">   sendSystemAlert(uiConv, conv, bundleId) {</span>
<a href="#l24.215"></a><span id="l24.215" class="difflineminus">-    uiConv.systemMessage(_(bundleId, conv.normalizedName));</span>
<a href="#l24.216"></a><span id="l24.216" class="difflineplus">+    uiConv.systemMessage(_strArgs(bundleId, {name: conv.normalizedName}));</span>
<a href="#l24.217"></a><span id="l24.217">   },</span>
<a href="#l24.218"></a><span id="l24.218"> </span>
<a href="#l24.219"></a><span id="l24.219">   setNotificationBox(notificationbox) {</span>
<a href="#l24.220"></a><span id="l24.220">     this.globalBox = notificationbox;</span>
<a href="#l24.221"></a><span id="l24.221">   },</span>
<a href="#l24.222"></a><span id="l24.222"> </span>
<a href="#l24.223"></a><span id="l24.223"> /*</span>
<a href="#l24.224"></a><span id="l24.224">  *  possible states:</span>
<a href="#l24.225"></a><span id="l24.225" class="difflineat">@@ -358,44 +379,54 @@ var OTRUI = {</span>
<a href="#l24.226"></a><span id="l24.226">       }</span>
<a href="#l24.227"></a><span id="l24.227"> </span>
<a href="#l24.228"></a><span id="l24.228">       if (uiConv.isChat) {</span>
<a href="#l24.229"></a><span id="l24.229">         OTRUI.noOtrPossible(otrContainer, context);</span>
<a href="#l24.230"></a><span id="l24.230">         return;</span>
<a href="#l24.231"></a><span id="l24.231">       }</span>
<a href="#l24.232"></a><span id="l24.232">       if (addSystemMessage) {</span>
<a href="#l24.233"></a><span id="l24.233">         let trust = OTRUI.getTrustSettings(context);</span>
<a href="#l24.234"></a><span id="l24.234" class="difflineminus">-        uiConv.systemMessage(_(&quot;state.&quot; + trust.class, context.username));</span>
<a href="#l24.235"></a><span id="l24.235" class="difflineplus">+        let id = &quot;state-&quot; + trust.class;</span>
<a href="#l24.236"></a><span id="l24.236" class="difflineplus">+        let msg;</span>
<a href="#l24.237"></a><span id="l24.237" class="difflineplus">+        if (OTR.trust(context) == OTR.trustState.TRUST_NOT_PRIVATE) {</span>
<a href="#l24.238"></a><span id="l24.238" class="difflineplus">+          msg = syncL10n.formatValue(id);</span>
<a href="#l24.239"></a><span id="l24.239" class="difflineplus">+        } else {</span>
<a href="#l24.240"></a><span id="l24.240" class="difflineplus">+          msg = syncL10n.formatValue(id, {name: context.username});</span>
<a href="#l24.241"></a><span id="l24.241" class="difflineplus">+        }</span>
<a href="#l24.242"></a><span id="l24.242" class="difflineplus">+        uiConv.systemMessage(msg);</span>
<a href="#l24.243"></a><span id="l24.243">       }</span>
<a href="#l24.244"></a><span id="l24.244">     } catch (e) {</span>
<a href="#l24.245"></a><span id="l24.245">       OTRUI.noOtrPossible(otrContainer, context);</span>
<a href="#l24.246"></a><span id="l24.246">       return;</span>
<a href="#l24.247"></a><span id="l24.247">     }</span>
<a href="#l24.248"></a><span id="l24.248"> </span>
<a href="#l24.249"></a><span id="l24.249">     otrContainer.hidden = false;</span>
<a href="#l24.250"></a><span id="l24.250">     let otrStart = doc.querySelector(&quot;.otr-start&quot;);</span>
<a href="#l24.251"></a><span id="l24.251">     let otrEnd = doc.querySelector(&quot;.otr-end&quot;);</span>
<a href="#l24.252"></a><span id="l24.252">     let otrAuth = doc.querySelector(&quot;.otr-auth&quot;);</span>
<a href="#l24.253"></a><span id="l24.253">     let trust = OTRUI.getTrustSettings(context);</span>
<a href="#l24.254"></a><span id="l24.254" class="difflineminus">-    otrButton.setAttribute(&quot;tooltiptext&quot;, _(&quot;state.&quot; + trust.class, context.username));</span>
<a href="#l24.255"></a><span id="l24.255" class="difflineminus">-    otrButton.setAttribute(&quot;label&quot;, _(&quot;state.&quot; + trust.class + &quot;.label&quot;));</span>
<a href="#l24.256"></a><span id="l24.256" class="difflineplus">+    otrButton.setAttribute(&quot;tooltiptext&quot;,</span>
<a href="#l24.257"></a><span id="l24.257" class="difflineplus">+      _strArgs(&quot;state-&quot; + trust.class, {name: context.username}));</span>
<a href="#l24.258"></a><span id="l24.258" class="difflineplus">+    otrButton.setAttribute(&quot;label&quot;,</span>
<a href="#l24.259"></a><span id="l24.259" class="difflineplus">+      _str(&quot;state-&quot; + trust.class + &quot;-label&quot;));</span>
<a href="#l24.260"></a><span id="l24.260">     otrButton.className = &quot;otr-button otr-&quot; + trust.class;</span>
<a href="#l24.261"></a><span id="l24.261">     otrStart.setAttribute(&quot;label&quot;, trust.startLabel);</span>
<a href="#l24.262"></a><span id="l24.262">     otrStart.setAttribute(&quot;disabled&quot;, trust.disableStart);</span>
<a href="#l24.263"></a><span id="l24.263">     otrEnd.setAttribute(&quot;disabled&quot;, trust.disableEnd);</span>
<a href="#l24.264"></a><span id="l24.264">     otrAuth.setAttribute(&quot;label&quot;, trust.authLabel);</span>
<a href="#l24.265"></a><span id="l24.265">     otrAuth.setAttribute(&quot;disabled&quot;, trust.disableAuth);</span>
<a href="#l24.266"></a><span id="l24.266">     OTRUI.hideAllNotifications();</span>
<a href="#l24.267"></a><span id="l24.267">     OTRUI.showUserNotifications(context);</span>
<a href="#l24.268"></a><span id="l24.268">   },</span>
<a href="#l24.269"></a><span id="l24.269"> </span>
<a href="#l24.270"></a><span id="l24.270">   alertTrust(context) {</span>
<a href="#l24.271"></a><span id="l24.271">     let uiConv = OTR.getUIConvFromContext(context);</span>
<a href="#l24.272"></a><span id="l24.272">     let trust = OTRUI.getTrustSettings(context);</span>
<a href="#l24.273"></a><span id="l24.273" class="difflineminus">-    uiConv.systemMessage(_(&quot;afterauth.&quot; + trust.class, context.username));</span>
<a href="#l24.274"></a><span id="l24.274" class="difflineplus">+    uiConv.systemMessage(</span>
<a href="#l24.275"></a><span id="l24.275" class="difflineplus">+      _strArgs(&quot;afterauth-&quot; + trust.class, {name: context.username}));</span>
<a href="#l24.276"></a><span id="l24.276">   },</span>
<a href="#l24.277"></a><span id="l24.277"> </span>
<a href="#l24.278"></a><span id="l24.278">   getTrustSettings(context) {</span>
<a href="#l24.279"></a><span id="l24.279">     let result = trustMap.get(OTR.trust(context));</span>
<a href="#l24.280"></a><span id="l24.280">     return result;</span>
<a href="#l24.281"></a><span id="l24.281">   },</span>
<a href="#l24.282"></a><span id="l24.282"> </span>
<a href="#l24.283"></a><span id="l24.283">   askAuth(aObject) {</span>
<a href="#l24.284"></a><span id="l24.284" class="difflineat">@@ -444,46 +475,47 @@ var OTRUI = {</span>
<a href="#l24.285"></a><span id="l24.285">     let uiConv = OTR.getUIConvFromContext(context);</span>
<a href="#l24.286"></a><span id="l24.286">     if (!uiConv) return;</span>
<a href="#l24.287"></a><span id="l24.287"> </span>
<a href="#l24.288"></a><span id="l24.288">     if (this.globalBox.getNotificationWithValue(authVerify))</span>
<a href="#l24.289"></a><span id="l24.289">       return;</span>
<a href="#l24.290"></a><span id="l24.290"> </span>
<a href="#l24.291"></a><span id="l24.291">     let window = this.globalDoc.defaultView;</span>
<a href="#l24.292"></a><span id="l24.292"> </span>
<a href="#l24.293"></a><span id="l24.293" class="difflineminus">-    let msg = _(&quot;finger.&quot; + seen, context.username);</span>
<a href="#l24.294"></a><span id="l24.294" class="difflineplus">+    let msg = _strArgs(&quot;finger-&quot; + seen, {name: context.username});</span>
<a href="#l24.295"></a><span id="l24.295">     let buttons = [{</span>
<a href="#l24.296"></a><span id="l24.296" class="difflineminus">-      label: _(&quot;finger.verify&quot;),</span>
<a href="#l24.297"></a><span id="l24.297" class="difflineminus">-      accessKey: _(&quot;verify.accessKey&quot;),</span>
<a href="#l24.298"></a><span id="l24.298" class="difflineplus">+      label: _str(&quot;finger-verify&quot;),</span>
<a href="#l24.299"></a><span id="l24.299" class="difflineplus">+      accessKey: _str(&quot;finger-verify-accessKey&quot;),</span>
<a href="#l24.300"></a><span id="l24.300">       callback() {</span>
<a href="#l24.301"></a><span id="l24.301">         let name = uiConv.target.normalizedName;</span>
<a href="#l24.302"></a><span id="l24.302">         OTRUI.openAuth(window, name, &quot;start&quot;, uiConv);</span>
<a href="#l24.303"></a><span id="l24.303">         // prevent closing of notification bar when the button is hit</span>
<a href="#l24.304"></a><span id="l24.304">         return true;</span>
<a href="#l24.305"></a><span id="l24.305">       },</span>
<a href="#l24.306"></a><span id="l24.306">     }];</span>
<a href="#l24.307"></a><span id="l24.307"> </span>
<a href="#l24.308"></a><span id="l24.308">     let priority = this.globalBox.PRIORITY_WARNING_MEDIUM;</span>
<a href="#l24.309"></a><span id="l24.309">     this.globalBox.appendNotification(msg, authVerify, null, priority, buttons, null);</span>
<a href="#l24.310"></a><span id="l24.310"> </span>
<a href="#l24.311"></a><span id="l24.311" class="difflineminus">-    this.updateNotificationUI(context, &quot;verify&quot;, authVerify);</span>
<a href="#l24.312"></a><span id="l24.312" class="difflineplus">+    let verifyTitle = syncL10n.formatValue(&quot;verify-title&quot;);</span>
<a href="#l24.313"></a><span id="l24.313" class="difflineplus">+    this.updateNotificationUI(context, verifyTitle, authVerify);</span>
<a href="#l24.314"></a><span id="l24.314">   },</span>
<a href="#l24.315"></a><span id="l24.315"> </span>
<a href="#l24.316"></a><span id="l24.316" class="difflineminus">-  updateNotificationUI(context, type, value) {</span>
<a href="#l24.317"></a><span id="l24.317" class="difflineplus">+  updateNotificationUI(context, typeTitle, value) {</span>
<a href="#l24.318"></a><span id="l24.318">     let notification = this.globalBox.getNotificationWithValue(value);</span>
<a href="#l24.319"></a><span id="l24.319">     notification.setAttribute(&quot;user&quot;, context.username);</span>
<a href="#l24.320"></a><span id="l24.320">     notification.setAttribute(&quot;orient&quot;, &quot;vertical&quot;);</span>
<a href="#l24.321"></a><span id="l24.321">     notification.messageDetails.setAttribute(&quot;orient&quot;, &quot;vertical&quot;);</span>
<a href="#l24.322"></a><span id="l24.322">     notification.messageDetails.removeAttribute(&quot;oncommand&quot;);</span>
<a href="#l24.323"></a><span id="l24.323">     notification.messageDetails.removeAttribute(&quot;align&quot;);</span>
<a href="#l24.324"></a><span id="l24.324"> </span>
<a href="#l24.325"></a><span id="l24.325">     let title = this.globalDoc.createElement(&quot;title&quot;);</span>
<a href="#l24.326"></a><span id="l24.326">     title.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l24.327"></a><span id="l24.327">     title.setAttribute(&quot;crop&quot;, &quot;end&quot;);</span>
<a href="#l24.328"></a><span id="l24.328" class="difflineminus">-    title.textContent = _(type + &quot;.title&quot;);</span>
<a href="#l24.329"></a><span id="l24.329" class="difflineplus">+    title.textContent = typeTitle;</span>
<a href="#l24.330"></a><span id="l24.330"> </span>
<a href="#l24.331"></a><span id="l24.331">     let close = notification.querySelector(&quot;toolbarbutton&quot;);</span>
<a href="#l24.332"></a><span id="l24.332">     close.setAttribute(&quot;oncommand&quot;, &quot;this.parentNode.parentNode.dismiss();&quot;);</span>
<a href="#l24.333"></a><span id="l24.333"> </span>
<a href="#l24.334"></a><span id="l24.334">     let top = this.globalDoc.createXULElement(&quot;hbox&quot;);</span>
<a href="#l24.335"></a><span id="l24.335">     top.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l24.336"></a><span id="l24.336">     top.setAttribute(&quot;align&quot;, &quot;center&quot;);</span>
<a href="#l24.337"></a><span id="l24.337">     top.classList.add(&quot;otr-notification-header&quot;);</span>
<a href="#l24.338"></a><span id="l24.338" class="difflineat">@@ -519,35 +551,35 @@ var OTRUI = {</span>
<a href="#l24.339"></a><span id="l24.339">     let uiConv = OTR.getUIConvFromContext(context);</span>
<a href="#l24.340"></a><span id="l24.340">     if (!uiConv) return;</span>
<a href="#l24.341"></a><span id="l24.341"> </span>
<a href="#l24.342"></a><span id="l24.342">     // TODO: maybe update the .label property on the notification instead</span>
<a href="#l24.343"></a><span id="l24.343">     // of closing it ... although, buttons need to be updated too.</span>
<a href="#l24.344"></a><span id="l24.344">     OTRUI.closeVerification(context);</span>
<a href="#l24.345"></a><span id="l24.345"> </span>
<a href="#l24.346"></a><span id="l24.346">     let msg = authLabelMap.get(key);</span>
<a href="#l24.347"></a><span id="l24.347" class="difflineminus">-    let type = authTitleMap.get(key);</span>
<a href="#l24.348"></a><span id="l24.348" class="difflineplus">+    let typeTitle = authTitleMap.get(key);</span>
<a href="#l24.349"></a><span id="l24.349">     let buttons = [];</span>
<a href="#l24.350"></a><span id="l24.350">     if (cancelable) {</span>
<a href="#l24.351"></a><span id="l24.351">       buttons = [{</span>
<a href="#l24.352"></a><span id="l24.352" class="difflineminus">-        label: _(&quot;auth.cancel&quot;),</span>
<a href="#l24.353"></a><span id="l24.353" class="difflineminus">-        accessKey: _(&quot;auth.cancelAccessKey&quot;),</span>
<a href="#l24.354"></a><span id="l24.354" class="difflineplus">+        label: _str(&quot;auth-cancel&quot;),</span>
<a href="#l24.355"></a><span id="l24.355" class="difflineplus">+        accessKey: _str(&quot;auth-cancelAccessKey&quot;),</span>
<a href="#l24.356"></a><span id="l24.356">         callback() {</span>
<a href="#l24.357"></a><span id="l24.357">           let context = OTR.getContext(uiConv.target);</span>
<a href="#l24.358"></a><span id="l24.358">           OTR.abortSMP(context);</span>
<a href="#l24.359"></a><span id="l24.359">         },</span>
<a href="#l24.360"></a><span id="l24.360">       }];</span>
<a href="#l24.361"></a><span id="l24.361">     }</span>
<a href="#l24.362"></a><span id="l24.362"> </span>
<a href="#l24.363"></a><span id="l24.363">     // higher priority to overlay the current notifyUnverified</span>
<a href="#l24.364"></a><span id="l24.364">     let priority = this.globalBox.PRIORITY_WARNING_HIGH;</span>
<a href="#l24.365"></a><span id="l24.365">     OTRUI.closeUnverified(context);</span>
<a href="#l24.366"></a><span id="l24.366">     this.globalBox.appendNotification(msg, key, null, priority, buttons, null);</span>
<a href="#l24.367"></a><span id="l24.367"> </span>
<a href="#l24.368"></a><span id="l24.368" class="difflineminus">-    this.updateNotificationUI(context, type, key);</span>
<a href="#l24.369"></a><span id="l24.369" class="difflineplus">+    this.updateNotificationUI(context, typeTitle, key);</span>
<a href="#l24.370"></a><span id="l24.370">   },</span>
<a href="#l24.371"></a><span id="l24.371"> </span>
<a href="#l24.372"></a><span id="l24.372">   updateAuth(aObj) {</span>
<a href="#l24.373"></a><span id="l24.373">     // let uiConv = OTR.getUIConvFromContext(aObj.context);</span>
<a href="#l24.374"></a><span id="l24.374">     if (!aObj.progress) {</span>
<a href="#l24.375"></a><span id="l24.375">       OTRUI.closeAuth(aObj.context);</span>
<a href="#l24.376"></a><span id="l24.376">       OTRUI.notifyVerification(aObj.context, &quot;otr:auth-error&quot;, false);</span>
<a href="#l24.377"></a><span id="l24.377">     } else if (aObj.progress === 100) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mail/components/im/content/chat-conversation-info.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mail/components/im/content/chat-conversation-info.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -41,16 +41,20 @@ class MozChatConversationInfo extends Mo</span>
<a href="#l25.4"></a><span id="l25.4"> </span>
<a href="#l25.5"></a><span id="l25.5">   connectedCallback() {</span>
<a href="#l25.6"></a><span id="l25.6">     if (this.hasChildNodes() || this.delayConnectedCallback()) {</span>
<a href="#l25.7"></a><span id="l25.7">       return;</span>
<a href="#l25.8"></a><span id="l25.8">     }</span>
<a href="#l25.9"></a><span id="l25.9">     this.setAttribute(&quot;orient&quot;, &quot;vertical&quot;);</span>
<a href="#l25.10"></a><span id="l25.10"> </span>
<a href="#l25.11"></a><span id="l25.11">     this.appendChild(MozXULElement.parseXULToFragment(`</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+      &lt;linkset&gt;</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+        &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/otr/chat.ftl&quot;/&gt;</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+      &lt;/linkset&gt;</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+</span>
<a href="#l25.16"></a><span id="l25.16">       &lt;hbox class=&quot;displayUserAccount&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l25.17"></a><span id="l25.17">         &lt;stack class=&quot;statusImageStack&quot;&gt;</span>
<a href="#l25.18"></a><span id="l25.18">           &lt;box class=&quot;userIconHolder&quot;&gt;</span>
<a href="#l25.19"></a><span id="l25.19">             &lt;image class=&quot;userIcon&quot; mousethrough=&quot;always&quot;&gt;&lt;/image&gt;</span>
<a href="#l25.20"></a><span id="l25.20">           &lt;/box&gt;</span>
<a href="#l25.21"></a><span id="l25.21">           &lt;image class=&quot;statusTypeIcon&quot;&gt;&lt;/image&gt;</span>
<a href="#l25.22"></a><span id="l25.22">         &lt;/stack&gt;</span>
<a href="#l25.23"></a><span id="l25.23">         &lt;stack class=&quot;displayNameAndstatusMessageStack&quot; mousethrough=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineat">@@ -59,29 +63,29 @@ class MozChatConversationInfo extends Mo</span>
<a href="#l25.25"></a><span id="l25.25">             &lt;/description&gt;</span>
<a href="#l25.26"></a><span id="l25.26">             &lt;image class=&quot;prplIcon&quot;&gt;&lt;/image&gt;</span>
<a href="#l25.27"></a><span id="l25.27">           &lt;/hbox&gt;</span>
<a href="#l25.28"></a><span id="l25.28">           &lt;description class=&quot;statusMessage&quot; mousethrough=&quot;never&quot; crop=&quot;end&quot; flex=&quot;100000&quot;&gt;</span>
<a href="#l25.29"></a><span id="l25.29">           &lt;/description&gt;</span>
<a href="#l25.30"></a><span id="l25.30">         &lt;/stack&gt;</span>
<a href="#l25.31"></a><span id="l25.31">       &lt;/hbox&gt;</span>
<a href="#l25.32"></a><span id="l25.32">       &lt;hbox class=&quot;otr-container&quot; align=&quot;left&quot; valign=&quot;middle&quot; flex=&quot;1&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineminus">-        &lt;label class=&quot;otr-label&quot; crop=&quot;end&quot; value=&quot;&amp;state.label;&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+        &lt;label class=&quot;otr-label&quot; crop=&quot;end&quot; data-l10n-id=&quot;state-label&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l25.35"></a><span id="l25.35">         &lt;toolbarbutton id=&quot;otrButton&quot;</span>
<a href="#l25.36"></a><span id="l25.36">                        mode=&quot;dialog&quot;</span>
<a href="#l25.37"></a><span id="l25.37">                        class=&quot;otr-button toolbarbutton-1&quot;</span>
<a href="#l25.38"></a><span id="l25.38">                        type=&quot;menu&quot;</span>
<a href="#l25.39"></a><span id="l25.39">                        label=&quot;Insecure&quot;</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineminus">-                       tooltiptext=&quot;&amp;start.label;&quot;&gt;</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineplus">+                       data-l10n-id=&quot;start-tooltip&quot;&gt;</span>
<a href="#l25.42"></a><span id="l25.42">           &lt;menupopup class=&quot;otr-menu-popup&quot;&gt;</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineminus">-            &lt;menuitem class=&quot;otr-start&quot; label=&quot;&amp;start.label;&quot;</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+            &lt;menuitem class=&quot;otr-start&quot; data-l10n-id=&quot;start-label&quot;</span>
<a href="#l25.45"></a><span id="l25.45">                       oncommand='this.closest(&quot;chat-conversation-info&quot;).onOtrStartClicked();'/&gt;</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineminus">-            &lt;menuitem class=&quot;otr-end&quot; label=&quot;&amp;end.label;&quot;</span>
<a href="#l25.47"></a><span id="l25.47" class="difflineplus">+            &lt;menuitem class=&quot;otr-end&quot; data-l10n-id=&quot;end-label&quot;</span>
<a href="#l25.48"></a><span id="l25.48">                       oncommand='this.closest(&quot;chat-conversation-info&quot;).onOtrEndClicked();'/&gt;</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineminus">-            &lt;menuitem class=&quot;otr-auth&quot; label=&quot;&amp;auth.label;&quot;</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineplus">+            &lt;menuitem class=&quot;otr-auth&quot; data-l10n-id=&quot;auth-label&quot;</span>
<a href="#l25.51"></a><span id="l25.51">                       oncommand='this.closest(&quot;chat-conversation-info&quot;).onOtrAuthClicked();'/&gt;</span>
<a href="#l25.52"></a><span id="l25.52">           &lt;/menupopup&gt;</span>
<a href="#l25.53"></a><span id="l25.53">         &lt;/toolbarbutton&gt;</span>
<a href="#l25.54"></a><span id="l25.54">       &lt;/hbox&gt;</span>
<a href="#l25.55"></a><span id="l25.55">       &lt;hbox id=&quot;otr-notification-box&quot;&gt;&lt;/hbox&gt;</span>
<a href="#l25.56"></a><span id="l25.56">     `, [&quot;chrome://chat/content/otr-chat.dtd&quot;]));</span>
<a href="#l25.57"></a><span id="l25.57"> </span>
<a href="#l25.58"></a><span id="l25.58">     this.topic.addEventListener(&quot;click&quot;, this.startEditTopic.bind(this));</span>
<a href="#l25.59"></a><span id="l25.59" class="difflineat">@@ -168,29 +172,29 @@ class MozChatConversationInfo extends Mo</span>
<a href="#l25.60"></a><span id="l25.60">   }</span>
<a href="#l25.61"></a><span id="l25.61"> </span>
<a href="#l25.62"></a><span id="l25.62">   onOtrStartClicked() {</span>
<a href="#l25.63"></a><span id="l25.63">     // check if start-menu-command is disabled, if yes exit</span>
<a href="#l25.64"></a><span id="l25.64">     let convBinding = document.getElementById(&quot;conversationsDeck&quot;).selectedPanel;</span>
<a href="#l25.65"></a><span id="l25.65">     let uiConv = convBinding._conv;</span>
<a href="#l25.66"></a><span id="l25.66">     let conv = uiConv.target;</span>
<a href="#l25.67"></a><span id="l25.67">     let context = OTR.getContext(conv);</span>
<a href="#l25.68"></a><span id="l25.68" class="difflineminus">-    let bundleId = &quot;alert.&quot; + (</span>
<a href="#l25.69"></a><span id="l25.69" class="difflineplus">+    let bundleId = &quot;alert-&quot; + (</span>
<a href="#l25.70"></a><span id="l25.70">       context.msgstate === OTR.getMessageState().OTRL_MSGSTATE_ENCRYPTED ?</span>
<a href="#l25.71"></a><span id="l25.71">         &quot;refresh&quot; : &quot;start&quot;);</span>
<a href="#l25.72"></a><span id="l25.72">     OTRUI.sendSystemAlert(uiConv, conv, bundleId);</span>
<a href="#l25.73"></a><span id="l25.73">     OTR.sendQueryMsg(conv);</span>
<a href="#l25.74"></a><span id="l25.74">   }</span>
<a href="#l25.75"></a><span id="l25.75"> </span>
<a href="#l25.76"></a><span id="l25.76">   onOtrEndClicked() {</span>
<a href="#l25.77"></a><span id="l25.77">     let convBinding = document.getElementById(&quot;conversationsDeck&quot;).selectedPanel;</span>
<a href="#l25.78"></a><span id="l25.78">     let uiConv = convBinding._conv;</span>
<a href="#l25.79"></a><span id="l25.79">     let conv = uiConv.target;</span>
<a href="#l25.80"></a><span id="l25.80">     OTR.disconnect(conv, false);</span>
<a href="#l25.81"></a><span id="l25.81" class="difflineminus">-    let bundleId = &quot;alert.gone_insecure&quot;;</span>
<a href="#l25.82"></a><span id="l25.82" class="difflineplus">+    let bundleId = &quot;alert-gone_insecure&quot;;</span>
<a href="#l25.83"></a><span id="l25.83">     OTRUI.sendSystemAlert(uiConv, conv, bundleId);</span>
<a href="#l25.84"></a><span id="l25.84">   }</span>
<a href="#l25.85"></a><span id="l25.85"> </span>
<a href="#l25.86"></a><span id="l25.86">   onOtrAuthClicked() {</span>
<a href="#l25.87"></a><span id="l25.87">     let convBinding = document.getElementById(&quot;conversationsDeck&quot;).selectedPanel;</span>
<a href="#l25.88"></a><span id="l25.88">     let uiConv = convBinding._conv;</span>
<a href="#l25.89"></a><span id="l25.89">     let conv = uiConv.target;</span>
<a href="#l25.90"></a><span id="l25.90">     OTRUI.openAuth(window, conv.normalizedName, &quot;start&quot;, uiConv);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/components/im/content/chat-messenger.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/components/im/content/chat-messenger.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1163,17 +1163,17 @@ var chatHandler = {</span>
<a href="#l26.4"></a><span id="l26.4">     let rawConversations = conversations.map((c) =&gt; c.conv);</span>
<a href="#l26.5"></a><span id="l26.5">     let current;</span>
<a href="#l26.6"></a><span id="l26.6">     if (aList.selectedItem.localName == &quot;richlistitem&quot; &amp;&amp; aList.selectedItem.getAttribute(&quot;is&quot;) == &quot;chat-imconv&quot;)</span>
<a href="#l26.7"></a><span id="l26.7">       current = aList.selectedIndex - aList.getIndexOfItem(conversations[0]);</span>
<a href="#l26.8"></a><span id="l26.8">     let newIndex = this._getNextUnreadConversation(rawConversations, current, aReverse);</span>
<a href="#l26.9"></a><span id="l26.9">     if (newIndex !== -1)</span>
<a href="#l26.10"></a><span id="l26.10">       aList.selectedItem = conversations[newIndex];</span>
<a href="#l26.11"></a><span id="l26.11">   },</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-  init() {</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+  async init() {</span>
<a href="#l26.14"></a><span id="l26.14">     Notifications.init();</span>
<a href="#l26.15"></a><span id="l26.15">     if (!Services.prefs.getBoolPref(&quot;mail.chat.enabled&quot;)) {</span>
<a href="#l26.16"></a><span id="l26.16">       [&quot;button-chat&quot;, &quot;menu_goChat&quot;, &quot;goChatSeparator&quot;,</span>
<a href="#l26.17"></a><span id="l26.17">        &quot;imAccountsStatus&quot;, &quot;joinChatMenuItem&quot;, &quot;newIMAccountMenuItem&quot;,</span>
<a href="#l26.18"></a><span id="l26.18">        &quot;newIMContactMenuItem&quot;, &quot;appmenu_joinChatMenuItem&quot;, &quot;appmenu_afterChatSeparator&quot;,</span>
<a href="#l26.19"></a><span id="l26.19">        &quot;appmenu_goChat&quot;, &quot;appmenu_imAccountsStatus&quot;, &quot;appmenu_goChatSeparator&quot;,</span>
<a href="#l26.20"></a><span id="l26.20">        &quot;appmenu_newIMAccountMenuItem&quot;, &quot;appmenu_newIMContactMenuItem&quot;].forEach(function(aId) {</span>
<a href="#l26.21"></a><span id="l26.21">          let elt = document.getElementById(aId);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -4,16 +4,25 @@</span>
<a href="#l27.4"></a><span id="l27.4"> </span>
<a href="#l27.5"></a><span id="l27.5"> # Note: This file should only contain locale entries. All</span>
<a href="#l27.6"></a><span id="l27.6"> # override and resource entries should go to mail/base/jar.mn to avoid</span>
<a href="#l27.7"></a><span id="l27.7"> # having to create the same entry for each locale.</span>
<a href="#l27.8"></a><span id="l27.8"> </span>
<a href="#l27.9"></a><span id="l27.9"> #filter substitution</span>
<a href="#l27.10"></a><span id="l27.10"> </span>
<a href="#l27.11"></a><span id="l27.11"> [localization] @AB_CD@.jar:</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineplus">+  # When ready for l10n, move chat/content/otr/*.ftl</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+  #                        to mail/locales/en-US/messenger/otr/</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+  # and remove the following otr/ lines.</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+  messenger/otr/add-finger.ftl                                          (../../chat/content/otr/add-finger.ftl)</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+  messenger/otr/auth.ftl                                                (../../chat/content/otr/auth.ftl)</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineplus">+  messenger/otr/chat.ftl                                                (../../chat/content/otr/chat.ftl)</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineplus">+  messenger/otr/generate-key.ftl                                        (../../chat/content/otr/generate-key.ftl)</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineplus">+  messenger/otr/otr.ftl                                                 (../../chat/content/otr/otr.ftl)</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineplus">+  messenger/otr/otrUI.ftl                                               (../../chat/content/otr/otrUI.ftl)</span>
<a href="#l27.21"></a><span id="l27.21">   messenger                                                             (%messenger/**/*.ftl)</span>
<a href="#l27.22"></a><span id="l27.22"> </span>
<a href="#l27.23"></a><span id="l27.23"> </span>
<a href="#l27.24"></a><span id="l27.24"> @AB_CD@.jar:</span>
<a href="#l27.25"></a><span id="l27.25"> % locale messenger @AB_CD@ %locale/@AB_CD@/messenger/</span>
<a href="#l27.26"></a><span id="l27.26">   locale/@AB_CD@/messenger/aboutDialog.dtd                              (%chrome/messenger/aboutDialog.dtd)</span>
<a href="#l27.27"></a><span id="l27.27">   locale/@AB_CD@/messenger/aboutDownloads.dtd                           (%chrome/messenger/aboutDownloads.dtd)</span>
<a href="#l27.28"></a><span id="l27.28">   locale/@AB_CD@/messenger/aboutRights.dtd                              (%chrome/messenger/aboutRights.dtd)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:31Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

