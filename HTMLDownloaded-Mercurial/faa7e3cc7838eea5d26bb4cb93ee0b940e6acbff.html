<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 28044:faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff" />
<meta property="og:url" content="/comm-central/rev/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff" />
<meta property="og:description" content="Bug 1562313 - Convert JavaScript components to use static registration in chat/. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff &#x2620;
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">shortlog</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">files</a> |
changeset |
<a href="/comm-central/raw-rev/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">raw</a>  | <a href="/comm-central/archive/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1562313">Bug 1562313</a> - Convert JavaScript components to use static registration in chat/. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">
<tr><td colspan="2" style="background:#ff3333;"><strong>&#x2620;&#x2620; backed out by <a style="font-family: monospace" href="/comm-central/rev/9ba26fa8d407">9ba26fa8d407</a> &#x2620; &#x2620;</strong></td></tr>
<tr><td>author</td><td>&#75;&#104;&#117;&#115;&#104;&#105;&#108;&#32;&#77;&#105;&#115;&#116;&#114;&#121;&#32;&#60;&#107;&#104;&#117;&#115;&#104;&#105;&#108;&#51;&#50;&#52;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 29 Oct 2019 00:29:00 +0100</td></tr>

<tr>
 <td>changeset 28044</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff</a></td>
</tr>



<tr>
<td>parent 28043</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7edaf5c980d383735ccfe8e300ea2783d9468956">7edaf5c980d383735ccfe8e300ea2783d9468956</a>
</td>
</tr>

<tr>
<td>child 28045</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1fc3b5065bc9438015db0242597211ca55244e13">1fc3b5065bc9438015db0242597211ca55244e13</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff">16622</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 29 Oct 2019 08:27:55 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1fc3b5065bc9 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1fc3b5065bc9438015db0242597211ca55244e13">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1fc3b5065bc9438015db0242597211ca55244e13&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1fc3b5065bc9438015db0242597211ca55244e13&newProject=comm-central&newRevision=faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1fc3b5065bc9438015db0242597211ca55244e13&newProject=comm-central&newRevision=faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1fc3b5065bc9438015db0242597211ca55244e13&newProject=comm-central&newRevision=faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1562313">1562313</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1562313">Bug 1562313</a> - Convert JavaScript components to use static registration in chat/. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMAccounts.jsm">chat/components/src/IMAccounts.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMAccounts.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMAccounts.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMAccounts.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMAccounts.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMAccounts.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCommands.jsm">chat/components/src/IMCommands.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCommands.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCommands.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCommands.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCommands.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCommands.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMContacts.jsm">chat/components/src/IMContacts.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMContacts.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMContacts.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMContacts.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMContacts.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMContacts.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMConversations.jsm">chat/components/src/IMConversations.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMConversations.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMConversations.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMConversations.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMConversations.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMConversations.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCore.jsm">chat/components/src/IMCore.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCore.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCore.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCore.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCore.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/IMCore.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/Logger.jsm">chat/components/src/Logger.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/Logger.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/Logger.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/Logger.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/Logger.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/Logger.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/SmileProtocolHandler.jsm">chat/components/src/SmileProtocolHandler.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/SmileProtocolHandler.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/SmileProtocolHandler.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/SmileProtocolHandler.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/SmileProtocolHandler.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/SmileProtocolHandler.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/components.conf">chat/components/src/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.js">chat/components/src/imAccounts.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.manifest">chat/components/src/imAccounts.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imAccounts.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.js">chat/components/src/imCommands.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.manifest">chat/components/src/imCommands.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCommands.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.js">chat/components/src/imContacts.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.manifest">chat/components/src/imContacts.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imContacts.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.js">chat/components/src/imConversations.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.manifest">chat/components/src/imConversations.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imConversations.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.js">chat/components/src/imCore.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.manifest">chat/components/src/imCore.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/imCore.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.js">chat/components/src/logger.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.manifest">chat/components/src/logger.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/logger.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/moz.build">chat/components/src/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.js">chat/components/src/smileProtocolHandler.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.manifest">chat/components/src/smileProtocolHandler.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/smileProtocolHandler.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_commands.js">chat/components/src/test/test_commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_commands.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_commands.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_commands.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_commands.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_commands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_conversations.js">chat/components/src/test/test_conversations.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_conversations.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_conversations.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_conversations.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_conversations.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_conversations.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_logger.js">chat/components/src/test/test_logger.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_logger.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_logger.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_logger.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_logger.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/components/src/test/test_logger.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/Facebook.jsm">chat/protocols/facebook/Facebook.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/Facebook.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/Facebook.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/Facebook.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/Facebook.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/Facebook.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/components.conf">chat/protocols/facebook/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.js">chat/protocols/facebook/facebook.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.manifest">chat/protocols/facebook/facebook.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/facebook.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/moz.build">chat/protocols/facebook/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/facebook/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/Gtalk.jsm">chat/protocols/gtalk/Gtalk.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/Gtalk.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/Gtalk.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/Gtalk.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/Gtalk.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/Gtalk.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/components.conf">chat/protocols/gtalk/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/components.conf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.js">chat/protocols/gtalk/gtalk.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.manifest">chat/protocols/gtalk/gtalk.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/gtalk.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/moz.build">chat/protocols/gtalk/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/gtalk/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/IRC.jsm">chat/protocols/irc/IRC.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/IRC.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/IRC.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/IRC.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/IRC.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/IRC.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/components.conf">chat/protocols/irc/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.js">chat/protocols/irc/irc.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.manifest">chat/protocols/irc/irc.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/irc.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/ircISUPPORT.jsm">chat/protocols/irc/ircISUPPORT.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/ircISUPPORT.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/ircISUPPORT.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/ircISUPPORT.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/ircISUPPORT.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/ircISUPPORT.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/moz.build">chat/protocols/irc/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ctcpQuote.js">chat/protocols/irc/test/test_ctcpQuote.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ctcpQuote.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ctcpQuote.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ctcpQuote.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ctcpQuote.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ctcpQuote.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCAP.js">chat/protocols/irc/test/test_ircCAP.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCAP.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCAP.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCAP.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCAP.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCAP.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCommands.js">chat/protocols/irc/test/test_ircCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCommands.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCommands.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCommands.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCommands.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircMessage.js">chat/protocols/irc/test/test_ircMessage.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircMessage.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircMessage.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircMessage.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircMessage.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircMessage.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircNonStandard.js">chat/protocols/irc/test/test_ircNonStandard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircNonStandard.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircNonStandard.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircNonStandard.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircNonStandard.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircNonStandard.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircServerTime.js">chat/protocols/irc/test/test_ircServerTime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircServerTime.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircServerTime.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircServerTime.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircServerTime.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_ircServerTime.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_sendBufferedCommand.js">chat/protocols/irc/test/test_sendBufferedCommand.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_sendBufferedCommand.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_sendBufferedCommand.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_sendBufferedCommand.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_sendBufferedCommand.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_sendBufferedCommand.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_setMode.js">chat/protocols/irc/test/test_setMode.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_setMode.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_setMode.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_setMode.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_setMode.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_setMode.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_splitLongMessages.js">chat/protocols/irc/test/test_splitLongMessages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_splitLongMessages.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_splitLongMessages.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_splitLongMessages.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_splitLongMessages.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_splitLongMessages.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_tryNewNick.js">chat/protocols/irc/test/test_tryNewNick.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_tryNewNick.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_tryNewNick.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_tryNewNick.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_tryNewNick.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/irc/test/test_tryNewNick.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/JSTestProtocol.jsm">chat/protocols/jsTest/JSTestProtocol.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/JSTestProtocol.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/JSTestProtocol.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/JSTestProtocol.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/JSTestProtocol.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/JSTestProtocol.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/components.conf">chat/protocols/jsTest/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.js">chat/protocols/jsTest/jsTestProtocol.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.manifest">chat/protocols/jsTest/jsTestProtocol.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/jsTestProtocol.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/moz.build">chat/protocols/jsTest/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/jsTest/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/Matrix.jsm">chat/protocols/matrix/Matrix.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/Matrix.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/Matrix.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/Matrix.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/Matrix.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/Matrix.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/components.conf">chat/protocols/matrix/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/components.conf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.js">chat/protocols/matrix/matrix.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.manifest">chat/protocols/matrix/matrix.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/matrix.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/moz.build">chat/protocols/matrix/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/matrix/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/Odnoklassniki.jsm">chat/protocols/odnoklassniki/Odnoklassniki.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/Odnoklassniki.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/Odnoklassniki.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/Odnoklassniki.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/Odnoklassniki.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/Odnoklassniki.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/components.conf">chat/protocols/odnoklassniki/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/moz.build">chat/protocols/odnoklassniki/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.js">chat/protocols/odnoklassniki/odnoklassniki.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.manifest">chat/protocols/odnoklassniki/odnoklassniki.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/odnoklassniki/odnoklassniki.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/Skype.jsm">chat/protocols/skype/Skype.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/Skype.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/Skype.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/Skype.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/Skype.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/Skype.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/components.conf">chat/protocols/skype/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/components.conf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/moz.build">chat/protocols/skype/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.js">chat/protocols/skype/skype.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.manifest">chat/protocols/skype/skype.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/skype.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_MagicSha256.js">chat/protocols/skype/test/test_MagicSha256.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_MagicSha256.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_MagicSha256.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_MagicSha256.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_MagicSha256.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_MagicSha256.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_contactUrlToName.js">chat/protocols/skype/test/test_contactUrlToName.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_contactUrlToName.js">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_contactUrlToName.js">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_contactUrlToName.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_contactUrlToName.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/skype/test/test_contactUrlToName.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/Twitter.jsm">chat/protocols/twitter/Twitter.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/Twitter.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/Twitter.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/Twitter.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/Twitter.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/Twitter.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/components.conf">chat/protocols/twitter/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/moz.build">chat/protocols/twitter/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.js">chat/protocols/twitter/twitter.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.manifest">chat/protocols/twitter/twitter.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/twitter/twitter.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/XMPPProtocol.jsm">chat/protocols/xmpp/XMPPProtocol.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/XMPPProtocol.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/XMPPProtocol.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/XMPPProtocol.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/XMPPProtocol.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/XMPPProtocol.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/components.conf">chat/protocols/xmpp/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/components.conf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/moz.build">chat/protocols/xmpp/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.js">chat/protocols/xmpp/xmpp.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.manifest">chat/protocols/xmpp/xmpp.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/xmpp/xmpp.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/Yahoo.jsm">chat/protocols/yahoo/Yahoo.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/Yahoo.jsm">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/Yahoo.jsm">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/Yahoo.jsm">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/Yahoo.jsm">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/Yahoo.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/components.conf">chat/protocols/yahoo/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/components.conf">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/components.conf">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/components.conf">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/components.conf">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/moz.build">chat/protocols/yahoo/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/moz.build">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/moz.build">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/moz.build">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/moz.build">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.js">chat/protocols/yahoo/yahoo.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.js">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.js">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.manifest">chat/protocols/yahoo/yahoo.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.manifest">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.manifest">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/chat/protocols/yahoo/yahoo.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/mail/installer/package-manifest.in">mail/installer/package-manifest.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/mail/installer/package-manifest.in">file</a> |
<a href="/comm-central/annotate/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/mail/installer/package-manifest.in">annotate</a> |
<a href="/comm-central/diff/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/mail/installer/package-manifest.in">diff</a> |
<a href="/comm-central/comparison/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/mail/installer/package-manifest.in">comparison</a> |
<a href="/comm-central/log/faa7e3cc7838eea5d26bb4cb93ee0b940e6acbff/mail/installer/package-manifest.in">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1">rename from chat/components/src/imAccounts.js</span>
<a href="#l1.2"></a><span id="l1.2">rename to chat/components/src/IMAccounts.jsm</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineminus">--- a/chat/components/src/imAccounts.js</span>
<a href="#l1.4"></a><span id="l1.4" class="difflineplus">+++ b/chat/components/src/IMAccounts.jsm</span>
<a href="#l1.5"></a><span id="l1.5" class="difflineat">@@ -1,11 +1,14 @@</span>
<a href="#l1.6"></a><span id="l1.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.7"></a><span id="l1.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.8"></a><span id="l1.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineplus">+</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;AccountsService&quot;];</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineplus">+</span>
<a href="#l1.12"></a><span id="l1.12"> var {</span>
<a href="#l1.13"></a><span id="l1.13">   ClassInfo,</span>
<a href="#l1.14"></a><span id="l1.14">   EmptyEnumerator,</span>
<a href="#l1.15"></a><span id="l1.15">   nsSimpleEnumerator,</span>
<a href="#l1.16"></a><span id="l1.16">   XPCOMUtils,</span>
<a href="#l1.17"></a><span id="l1.17">   setTimeout,</span>
<a href="#l1.18"></a><span id="l1.18">   clearTimeout,</span>
<a href="#l1.19"></a><span id="l1.19">   executeSoon,</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineat">@@ -1289,14 +1292,9 @@ AccountsService.prototype = {</span>
<a href="#l1.21"></a><span id="l1.21">     let list = this._accountList;</span>
<a href="#l1.22"></a><span id="l1.22">     this._accountList = list</span>
<a href="#l1.23"></a><span id="l1.23">       .split(&quot;,&quot;)</span>
<a href="#l1.24"></a><span id="l1.24">       .filter(k =&gt; k.trim() != aAccountId)</span>
<a href="#l1.25"></a><span id="l1.25">       .join(&quot;,&quot;);</span>
<a href="#l1.26"></a><span id="l1.26">   },</span>
<a href="#l1.27"></a><span id="l1.27"> </span>
<a href="#l1.28"></a><span id="l1.28">   QueryInterface: ChromeUtils.generateQI([Ci.imIAccountsService]),</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-  classDescription: &quot;Accounts&quot;,</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineminus">-  classID: Components.ID(&quot;{a94b5427-cd8d-40cf-b47e-b67671953e70}&quot;),</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/accounts-service;1&quot;,</span>
<a href="#l1.32"></a><span id="l1.32"> };</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([AccountsService]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">rename from chat/components/src/imCommands.js</span>
<a href="#l2.2"></a><span id="l2.2">rename to chat/components/src/IMCommands.jsm</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineminus">--- a/chat/components/src/imCommands.js</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineplus">+++ b/chat/components/src/IMCommands.jsm</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineat">@@ -1,23 +1,25 @@</span>
<a href="#l2.6"></a><span id="l2.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.7"></a><span id="l2.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.8"></a><span id="l2.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;IMCommands&quot;];</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+</span>
<a href="#l2.12"></a><span id="l2.12"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l2.13"></a><span id="l2.13"> var { XPCOMUtils, l10nHelper } = ChromeUtils.import(</span>
<a href="#l2.14"></a><span id="l2.14">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l2.15"></a><span id="l2.15"> );</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l2.18"></a><span id="l2.18">   l10nHelper(&quot;chrome://chat/locale/commands.properties&quot;)</span>
<a href="#l2.19"></a><span id="l2.19"> );</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-function CommandsService() {}</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-CommandsService.prototype = {</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+function IMCommands() {}</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+IMCommands.prototype = {</span>
<a href="#l2.25"></a><span id="l2.25">   initCommands() {</span>
<a href="#l2.26"></a><span id="l2.26">     this._commands = {};</span>
<a href="#l2.27"></a><span id="l2.27">     // The say command is directly implemented in the UI layer, but has a</span>
<a href="#l2.28"></a><span id="l2.28">     // dummy command registered here so it shows up as a command (e.g. when</span>
<a href="#l2.29"></a><span id="l2.29">     // using the /help command).</span>
<a href="#l2.30"></a><span id="l2.30">     this.registerCommand({</span>
<a href="#l2.31"></a><span id="l2.31">       name: &quot;say&quot;,</span>
<a href="#l2.32"></a><span id="l2.32">       get helpString() {</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineat">@@ -279,14 +281,9 @@ CommandsService.prototype = {</span>
<a href="#l2.34"></a><span id="l2.34">     if (!cmdArray.some(aCmd =&gt; aCmd.run(args, aConversation, aReturnedConv))) {</span>
<a href="#l2.35"></a><span id="l2.35">       // If they all failed, print help message.</span>
<a href="#l2.36"></a><span id="l2.36">       this.executeCommand(&quot;/help &quot; + name, aConversation);</span>
<a href="#l2.37"></a><span id="l2.37">     }</span>
<a href="#l2.38"></a><span id="l2.38">     return true;</span>
<a href="#l2.39"></a><span id="l2.39">   },</span>
<a href="#l2.40"></a><span id="l2.40"> </span>
<a href="#l2.41"></a><span id="l2.41">   QueryInterface: ChromeUtils.generateQI([Ci.imICommandsService]),</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineminus">-  classDescription: &quot;Commands&quot;,</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-  classID: Components.ID(&quot;{7cb20c68-ccc8-4a79-b6f1-0b4771ed6c23}&quot;),</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/commands-service;1&quot;,</span>
<a href="#l2.45"></a><span id="l2.45"> };</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">-</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([CommandsService]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">rename from chat/components/src/imContacts.js</span>
<a href="#l3.2"></a><span id="l3.2">rename to chat/components/src/IMContacts.jsm</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineminus">--- a/chat/components/src/imContacts.js</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineplus">+++ b/chat/components/src/IMContacts.jsm</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l3.6"></a><span id="l3.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.7"></a><span id="l3.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.8"></a><span id="l3.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;TagsService&quot;, &quot;ContactsService&quot;];</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+</span>
<a href="#l3.12"></a><span id="l3.12"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l3.13"></a><span id="l3.13"> var { XPCOMUtils, executeSoon, ClassInfo, l10nHelper } = ChromeUtils.import(</span>
<a href="#l3.14"></a><span id="l3.14">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l3.15"></a><span id="l3.15"> );</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l3.18"></a><span id="l3.18">   l10nHelper(&quot;chrome://chat/locale/contacts.properties&quot;)</span>
<a href="#l3.19"></a><span id="l3.19"> );</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineat">@@ -195,19 +197,16 @@ TagsService.prototype = {</span>
<a href="#l3.21"></a><span id="l3.21">     otherContactsTag.showTag(aTag);</span>
<a href="#l3.22"></a><span id="l3.22">   },</span>
<a href="#l3.23"></a><span id="l3.23">   get otherContactsTag() {</span>
<a href="#l3.24"></a><span id="l3.24">     otherContactsTag._initContacts();</span>
<a href="#l3.25"></a><span id="l3.25">     return otherContactsTag;</span>
<a href="#l3.26"></a><span id="l3.26">   },</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28">   QueryInterface: ChromeUtils.generateQI([Ci.imITagsService]),</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineminus">-  classDescription: &quot;Tags&quot;,</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-  classID: Components.ID(&quot;{1fa92237-4303-4384-b8ac-4e65b50810a5}&quot;),</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/tags-service;1&quot;,</span>
<a href="#l3.32"></a><span id="l3.32"> };</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34"> // TODO move into the tagsService</span>
<a href="#l3.35"></a><span id="l3.35"> var Tags = [];</span>
<a href="#l3.36"></a><span id="l3.36"> var TagsById = {};</span>
<a href="#l3.37"></a><span id="l3.37"> </span>
<a href="#l3.38"></a><span id="l3.38"> function Tag(aId, aName) {</span>
<a href="#l3.39"></a><span id="l3.39">   this._id = aId;</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineat">@@ -1794,17 +1793,9 @@ ContactsService.prototype = {</span>
<a href="#l3.41"></a><span id="l3.41">       statement.params.accountId = aId;</span>
<a href="#l3.42"></a><span id="l3.42">       statement.execute();</span>
<a href="#l3.43"></a><span id="l3.43">     } finally {</span>
<a href="#l3.44"></a><span id="l3.44">       statement.finalize();</span>
<a href="#l3.45"></a><span id="l3.45">     }</span>
<a href="#l3.46"></a><span id="l3.46">   },</span>
<a href="#l3.47"></a><span id="l3.47"> </span>
<a href="#l3.48"></a><span id="l3.48">   QueryInterface: ChromeUtils.generateQI([Ci.imIContactsService]),</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-  classDescription: &quot;Contacts&quot;,</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineminus">-  classID: Components.ID(&quot;{8c3725dd-ee26-489d-8135-736015af8c7f}&quot;),</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/contacts-service;1&quot;,</span>
<a href="#l3.52"></a><span id="l3.52"> };</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-  ContactsService,</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-  TagsService,</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineminus">-]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">rename from chat/components/src/imConversations.js</span>
<a href="#l4.2"></a><span id="l4.2">rename to chat/components/src/IMConversations.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineminus">--- a/chat/components/src/imConversations.js</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineplus">+++ b/chat/components/src/IMConversations.jsm</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l4.6"></a><span id="l4.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.7"></a><span id="l4.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.8"></a><span id="l4.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;ConversationsService&quot;, &quot;IMMessage&quot;, &quot;UIConversation&quot;];</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+</span>
<a href="#l4.12"></a><span id="l4.12"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l4.13"></a><span id="l4.13"> var { Status } = ChromeUtils.import(&quot;resource:///modules/imStatusUtils.jsm&quot;);</span>
<a href="#l4.14"></a><span id="l4.14"> var { XPCOMUtils, nsSimpleEnumerator, ClassInfo } = ChromeUtils.import(</span>
<a href="#l4.15"></a><span id="l4.15">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l4.16"></a><span id="l4.16"> );</span>
<a href="#l4.17"></a><span id="l4.17"> var { Message } = ChromeUtils.import(&quot;resource:///modules/jsProtoHelper.jsm&quot;);</span>
<a href="#l4.18"></a><span id="l4.18"> </span>
<a href="#l4.19"></a><span id="l4.19"> var gLastUIConvId = 0;</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineat">@@ -21,20 +23,20 @@ function OutgoingMessage(aMsg, aConversa</span>
<a href="#l4.21"></a><span id="l4.21">   this.conversation = aConversation;</span>
<a href="#l4.22"></a><span id="l4.22"> }</span>
<a href="#l4.23"></a><span id="l4.23"> OutgoingMessage.prototype = {</span>
<a href="#l4.24"></a><span id="l4.24">   __proto__: ClassInfo(&quot;imIOutgoingMessage&quot;, &quot;Outgoing Message&quot;),</span>
<a href="#l4.25"></a><span id="l4.25">   cancelled: false,</span>
<a href="#l4.26"></a><span id="l4.26">   action: false,</span>
<a href="#l4.27"></a><span id="l4.27"> };</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-function imMessage(aPrplMessage) {</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+function IMMessage(aPrplMessage) {</span>
<a href="#l4.31"></a><span id="l4.31">   this.prplMessage = aPrplMessage;</span>
<a href="#l4.32"></a><span id="l4.32"> }</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-imMessage.prototype = {</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+IMMessage.prototype = {</span>
<a href="#l4.35"></a><span id="l4.35">   __proto__: ClassInfo([&quot;imIMessage&quot;, &quot;prplIMessage&quot;], &quot;IM Message&quot;),</span>
<a href="#l4.36"></a><span id="l4.36">   cancelled: false,</span>
<a href="#l4.37"></a><span id="l4.37">   color: &quot;&quot;,</span>
<a href="#l4.38"></a><span id="l4.38">   _displayMessage: null,</span>
<a href="#l4.39"></a><span id="l4.39">   encrypted: false,</span>
<a href="#l4.40"></a><span id="l4.40"> </span>
<a href="#l4.41"></a><span id="l4.41">   get displayMessage() {</span>
<a href="#l4.42"></a><span id="l4.42">     // Explicitly test for null so that blank messages don't fall back to</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineat">@@ -525,17 +527,17 @@ UIConversation.prototype = {</span>
<a href="#l4.44"></a><span id="l4.44">       this._observers.push(aObserver);</span>
<a href="#l4.45"></a><span id="l4.45">     }</span>
<a href="#l4.46"></a><span id="l4.46">   },</span>
<a href="#l4.47"></a><span id="l4.47">   removeObserver(aObserver) {</span>
<a href="#l4.48"></a><span id="l4.48">     this._observers = this._observers.filter(o =&gt; o !== aObserver);</span>
<a href="#l4.49"></a><span id="l4.49">   },</span>
<a href="#l4.50"></a><span id="l4.50">   notifyObservers(aSubject, aTopic, aData) {</span>
<a href="#l4.51"></a><span id="l4.51">     if (aTopic == &quot;new-text&quot;) {</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-      aSubject = new imMessage(aSubject);</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+      aSubject = new IMMessage(aSubject);</span>
<a href="#l4.54"></a><span id="l4.54">       this.notifyObservers(aSubject, &quot;received-message&quot;);</span>
<a href="#l4.55"></a><span id="l4.55">       if (aSubject.cancelled) {</span>
<a href="#l4.56"></a><span id="l4.56">         return;</span>
<a href="#l4.57"></a><span id="l4.57">       }</span>
<a href="#l4.58"></a><span id="l4.58">       if (!aSubject.system) {</span>
<a href="#l4.59"></a><span id="l4.59">         aSubject.conversation.prepareForDisplaying(aSubject);</span>
<a href="#l4.60"></a><span id="l4.60">       }</span>
<a href="#l4.61"></a><span id="l4.61"> </span>
<a href="#l4.62"></a><span id="l4.62" class="difflineat">@@ -826,14 +828,9 @@ ConversationsService.prototype = {</span>
<a href="#l4.63"></a><span id="l4.63">       ) {</span>
<a href="#l4.64"></a><span id="l4.64">         return conv;</span>
<a href="#l4.65"></a><span id="l4.65">       }</span>
<a href="#l4.66"></a><span id="l4.66">     }</span>
<a href="#l4.67"></a><span id="l4.67">     return null;</span>
<a href="#l4.68"></a><span id="l4.68">   },</span>
<a href="#l4.69"></a><span id="l4.69"> </span>
<a href="#l4.70"></a><span id="l4.70">   QueryInterface: ChromeUtils.generateQI([Ci.imIConversationsService]),</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-  classDescription: &quot;Conversations&quot;,</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-  classID: Components.ID(&quot;{b2397cd5-c76d-4618-8410-f344c7c6443a}&quot;),</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/conversations-service;1&quot;,</span>
<a href="#l4.74"></a><span id="l4.74"> };</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineminus">-</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([ConversationsService]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">rename from chat/components/src/imCore.js</span>
<a href="#l5.2"></a><span id="l5.2">rename to chat/components/src/IMCore.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineminus">--- a/chat/components/src/imCore.js</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineplus">+++ b/chat/components/src/IMCore.jsm</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l5.6"></a><span id="l5.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.7"></a><span id="l5.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.8"></a><span id="l5.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;IMCore&quot;];</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+</span>
<a href="#l5.12"></a><span id="l5.12"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l5.13"></a><span id="l5.13"> var {</span>
<a href="#l5.14"></a><span id="l5.14">   XPCOMUtils,</span>
<a href="#l5.15"></a><span id="l5.15">   ClassInfo,</span>
<a href="#l5.16"></a><span id="l5.16">   initLogModule,</span>
<a href="#l5.17"></a><span id="l5.17">   nsSimpleEnumerator,</span>
<a href="#l5.18"></a><span id="l5.18"> } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20" class="difflineat">@@ -268,21 +270,18 @@ UserStatus.prototype = {</span>
<a href="#l5.21"></a><span id="l5.21">   },</span>
<a href="#l5.22"></a><span id="l5.22">   _notifyObservers(aTopic, aData) {</span>
<a href="#l5.23"></a><span id="l5.23">     for (let observer of this._observers) {</span>
<a href="#l5.24"></a><span id="l5.24">       observer.observe(this, aTopic, aData);</span>
<a href="#l5.25"></a><span id="l5.25">     }</span>
<a href="#l5.26"></a><span id="l5.26">   },</span>
<a href="#l5.27"></a><span id="l5.27"> };</span>
<a href="#l5.28"></a><span id="l5.28"> </span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-var gCoreService;</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-function CoreService() {</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-  gCoreService = this;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-}</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-CoreService.prototype = {</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+function IMCore() {}</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+IMCore.prototype = {</span>
<a href="#l5.36"></a><span id="l5.36">   globalUserStatus: null,</span>
<a href="#l5.37"></a><span id="l5.37"> </span>
<a href="#l5.38"></a><span id="l5.38">   _initialized: false,</span>
<a href="#l5.39"></a><span id="l5.39">   get initialized() {</span>
<a href="#l5.40"></a><span id="l5.40">     return this._initialized;</span>
<a href="#l5.41"></a><span id="l5.41">   },</span>
<a href="#l5.42"></a><span id="l5.42">   init() {</span>
<a href="#l5.43"></a><span id="l5.43">     if (this._initialized) {</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineat">@@ -407,14 +406,9 @@ CoreService.prototype = {</span>
<a href="#l5.45"></a><span id="l5.45">       return null;</span>
<a href="#l5.46"></a><span id="l5.46">     }</span>
<a href="#l5.47"></a><span id="l5.47"> </span>
<a href="#l5.48"></a><span id="l5.48">     this._protos[aPrplId] = proto;</span>
<a href="#l5.49"></a><span id="l5.49">     return proto;</span>
<a href="#l5.50"></a><span id="l5.50">   },</span>
<a href="#l5.51"></a><span id="l5.51"> </span>
<a href="#l5.52"></a><span id="l5.52">   QueryInterface: ChromeUtils.generateQI([Ci.imICoreService]),</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-  classDescription: &quot;Core&quot;,</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-  classID: Components.ID(&quot;{073f5953-853c-4a38-bd81-255510c31c2e}&quot;),</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/core-service;1&quot;,</span>
<a href="#l5.56"></a><span id="l5.56"> };</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineminus">-</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([CoreService]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">rename from chat/components/src/logger.js</span>
<a href="#l6.2"></a><span id="l6.2">rename to chat/components/src/Logger.jsm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineminus">--- a/chat/components/src/logger.js</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineplus">+++ b/chat/components/src/Logger.jsm</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineat">@@ -1,13 +1,25 @@</span>
<a href="#l6.6"></a><span id="l6.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.7"></a><span id="l6.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.8"></a><span id="l6.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-var CC = Components.Constructor;</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+var EXPORTED_SYMBOLS = [</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+  &quot;Logger&quot;,</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  &quot;encodeName&quot;,</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+  &quot;convIsRealMUC&quot;,</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+  &quot;getLogFolderPathForAccount&quot;,</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+  &quot;getLogFilePathForConversation&quot;,</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+  &quot;getNewLogFileName&quot;,</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+  &quot;queueFileOperation&quot;,</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+  &quot;fileOperations&quot;,</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+  &quot;appendToFile&quot;,</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+  &quot;getLogWriter&quot;,</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+  &quot;closeLogWriter&quot;,</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+];</span>
<a href="#l6.24"></a><span id="l6.24"> </span>
<a href="#l6.25"></a><span id="l6.25"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l6.26"></a><span id="l6.26"> var { EmptyEnumerator, l10nHelper, XPCOMUtils } = ChromeUtils.import(</span>
<a href="#l6.27"></a><span id="l6.27">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l6.28"></a><span id="l6.28"> );</span>
<a href="#l6.29"></a><span id="l6.29"> var { GenericMessagePrototype } = ChromeUtils.import(</span>
<a href="#l6.30"></a><span id="l6.30">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l6.31"></a><span id="l6.31"> );</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineat">@@ -26,34 +38,34 @@ XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, (</span>
<a href="#l6.33"></a><span id="l6.33"> </span>
<a href="#l6.34"></a><span id="l6.34"> var kLineBreak = &quot;@mozilla.org/windows-registry-key;1&quot; in Cc ? &quot;\r\n&quot; : &quot;\n&quot;;</span>
<a href="#l6.35"></a><span id="l6.35"> </span>
<a href="#l6.36"></a><span id="l6.36"> /*</span>
<a href="#l6.37"></a><span id="l6.37">  * Maps file paths to promises returned by ongoing OS.File operations on them.</span>
<a href="#l6.38"></a><span id="l6.38">  * This is so that a file can be read after a pending write operation completes</span>
<a href="#l6.39"></a><span id="l6.39">  * and vice versa (opening a file multiple times concurrently may fail on Windows).</span>
<a href="#l6.40"></a><span id="l6.40">  */</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineminus">-var gFilePromises = new Map();</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+var fileOperations = new Map();</span>
<a href="#l6.43"></a><span id="l6.43"> </span>
<a href="#l6.44"></a><span id="l6.44"> // Uses above map to queue operations on a file.</span>
<a href="#l6.45"></a><span id="l6.45"> function queueFileOperation(aPath, aOperation) {</span>
<a href="#l6.46"></a><span id="l6.46">   // Ensure the operation is queued regardless of whether the last one succeeded.</span>
<a href="#l6.47"></a><span id="l6.47">   // This is safe since the promise is returned and consumers are expected to</span>
<a href="#l6.48"></a><span id="l6.48">   // handle any errors. If there's no promise existing for the given path already,</span>
<a href="#l6.49"></a><span id="l6.49">   // queue the operation on a dummy pre-resolved promise.</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-  let promise = (gFilePromises.get(aPath) || Promise.resolve()).then(</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+  let promise = (fileOperations.get(aPath) || Promise.resolve()).then(</span>
<a href="#l6.52"></a><span id="l6.52">     aOperation,</span>
<a href="#l6.53"></a><span id="l6.53">     aOperation</span>
<a href="#l6.54"></a><span id="l6.54">   );</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-  gFilePromises.set(aPath, promise);</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+  fileOperations.set(aPath, promise);</span>
<a href="#l6.57"></a><span id="l6.57"> </span>
<a href="#l6.58"></a><span id="l6.58">   let cleanup = () =&gt; {</span>
<a href="#l6.59"></a><span id="l6.59">     // If no further operations have been queued, remove the reference from the map.</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineminus">-    if (gFilePromises.get(aPath) === promise) {</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineminus">-      gFilePromises.delete(aPath);</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineplus">+    if (fileOperations.get(aPath) === promise) {</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineplus">+      fileOperations.delete(aPath);</span>
<a href="#l6.64"></a><span id="l6.64">     }</span>
<a href="#l6.65"></a><span id="l6.65">   };</span>
<a href="#l6.66"></a><span id="l6.66">   // Ensure we clear unused promises whether they resolved or rejected.</span>
<a href="#l6.67"></a><span id="l6.67">   promise.then(cleanup, cleanup);</span>
<a href="#l6.68"></a><span id="l6.68"> </span>
<a href="#l6.69"></a><span id="l6.69">   return promise;</span>
<a href="#l6.70"></a><span id="l6.70"> }</span>
<a href="#l6.71"></a><span id="l6.71"> </span>
<a href="#l6.72"></a><span id="l6.72" class="difflineat">@@ -85,17 +97,17 @@ function appendToFile(aPath, aEncodedStr</span>
<a href="#l6.73"></a><span id="l6.73">       await file.close().catch(Cu.reportError);</span>
<a href="#l6.74"></a><span id="l6.74">     }</span>
<a href="#l6.75"></a><span id="l6.75">   });</span>
<a href="#l6.76"></a><span id="l6.76"> }</span>
<a href="#l6.77"></a><span id="l6.77"> </span>
<a href="#l6.78"></a><span id="l6.78"> OS.File.profileBeforeChange.addBlocker(</span>
<a href="#l6.79"></a><span id="l6.79">   &quot;Chat logger: writing all pending messages&quot;,</span>
<a href="#l6.80"></a><span id="l6.80">   async function() {</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineminus">-    for (let promise of gFilePromises.values()) {</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+    for (let promise of fileOperations.values()) {</span>
<a href="#l6.83"></a><span id="l6.83">       try {</span>
<a href="#l6.84"></a><span id="l6.84">         await promise;</span>
<a href="#l6.85"></a><span id="l6.85">       } catch (aError) {</span>
<a href="#l6.86"></a><span id="l6.86">         // Ignore the error, whatever queued the operation will take care of it.</span>
<a href="#l6.87"></a><span id="l6.87">       }</span>
<a href="#l6.88"></a><span id="l6.88">     }</span>
<a href="#l6.89"></a><span id="l6.89">   }</span>
<a href="#l6.90"></a><span id="l6.90"> );</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineat">@@ -888,17 +900,17 @@ Logger.prototype = {</span>
<a href="#l6.92"></a><span id="l6.92">     // if logging is disabled (paths will be null).</span>
<a href="#l6.93"></a><span id="l6.93">     if (!writer || !writer.paths) {</span>
<a href="#l6.94"></a><span id="l6.94">       return null;</span>
<a href="#l6.95"></a><span id="l6.95">     }</span>
<a href="#l6.96"></a><span id="l6.96">     let paths = writer.paths;</span>
<a href="#l6.97"></a><span id="l6.97">     // Wait for any pending file operations to finish, then resolve to the paths</span>
<a href="#l6.98"></a><span id="l6.98">     // regardless of whether these operations succeeded.</span>
<a href="#l6.99"></a><span id="l6.99">     for (let path of paths) {</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineminus">-      await gFilePromises.get(path);</span>
<a href="#l6.101"></a><span id="l6.101" class="difflineplus">+      await fileOperations.get(path);</span>
<a href="#l6.102"></a><span id="l6.102">     }</span>
<a href="#l6.103"></a><span id="l6.103">     return paths;</span>
<a href="#l6.104"></a><span id="l6.104">   },</span>
<a href="#l6.105"></a><span id="l6.105">   getLogsForAccountAndName(aAccount, aNormalizedName, aGroupByDay) {</span>
<a href="#l6.106"></a><span id="l6.106">     return this._getLogArray(aAccount, aNormalizedName).then(aEntries =&gt;</span>
<a href="#l6.107"></a><span id="l6.107">       this._getEnumerator(aEntries, aGroupByDay)</span>
<a href="#l6.108"></a><span id="l6.108">     );</span>
<a href="#l6.109"></a><span id="l6.109">   },</span>
<a href="#l6.110"></a><span id="l6.110" class="difflineat">@@ -983,17 +995,17 @@ Logger.prototype = {</span>
<a href="#l6.111"></a><span id="l6.111">     let logPath = this.getLogFolderPathForAccount(aAccount);</span>
<a href="#l6.112"></a><span id="l6.112">     // Find all operations on files inside the log folder.</span>
<a href="#l6.113"></a><span id="l6.113">     let pendingPromises = [];</span>
<a href="#l6.114"></a><span id="l6.114">     function checkLogFiles(promiseOperation, filePath) {</span>
<a href="#l6.115"></a><span id="l6.115">       if (filePath.startsWith(logPath)) {</span>
<a href="#l6.116"></a><span id="l6.116">         pendingPromises.push(promiseOperation);</span>
<a href="#l6.117"></a><span id="l6.117">       }</span>
<a href="#l6.118"></a><span id="l6.118">     }</span>
<a href="#l6.119"></a><span id="l6.119" class="difflineminus">-    gFilePromises.forEach(checkLogFiles);</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineplus">+    fileOperations.forEach(checkLogFiles);</span>
<a href="#l6.121"></a><span id="l6.121">     // After all operations finish, remove the whole log folder.</span>
<a href="#l6.122"></a><span id="l6.122">     return Promise.all(pendingPromises)</span>
<a href="#l6.123"></a><span id="l6.123">       .then(values =&gt; {</span>
<a href="#l6.124"></a><span id="l6.124">         OS.File.removeDir(logPath, { ignoreAbsent: true });</span>
<a href="#l6.125"></a><span id="l6.125">       })</span>
<a href="#l6.126"></a><span id="l6.126">       .catch(aError =&gt;</span>
<a href="#l6.127"></a><span id="l6.127">         Cu.reportError(&quot;Failed to remove log folders:\n&quot; + aError)</span>
<a href="#l6.128"></a><span id="l6.128">       );</span>
<a href="#l6.129"></a><span id="l6.129" class="difflineat">@@ -1124,14 +1136,9 @@ Logger.prototype = {</span>
<a href="#l6.130"></a><span id="l6.130">         );</span>
<a href="#l6.131"></a><span id="l6.131">         break;</span>
<a href="#l6.132"></a><span id="l6.132">       default:</span>
<a href="#l6.133"></a><span id="l6.133">         throw new Error(&quot;Unexpected notification &quot; + aTopic);</span>
<a href="#l6.134"></a><span id="l6.134">     }</span>
<a href="#l6.135"></a><span id="l6.135">   },</span>
<a href="#l6.136"></a><span id="l6.136"> </span>
<a href="#l6.137"></a><span id="l6.137">   QueryInterface: ChromeUtils.generateQI([Ci.nsIObserver, Ci.imILogger]),</span>
<a href="#l6.138"></a><span id="l6.138" class="difflineminus">-  classDescription: &quot;Logger&quot;,</span>
<a href="#l6.139"></a><span id="l6.139" class="difflineminus">-  classID: Components.ID(&quot;{fb0dc220-2c7a-4216-9f19-6b8f3480eae9}&quot;),</span>
<a href="#l6.140"></a><span id="l6.140" class="difflineminus">-  contractID: &quot;@mozilla.org/chat/logger;1&quot;,</span>
<a href="#l6.141"></a><span id="l6.141"> };</span>
<a href="#l6.142"></a><span id="l6.142" class="difflineminus">-</span>
<a href="#l6.143"></a><span id="l6.143" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([Logger]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">rename from chat/components/src/smileProtocolHandler.js</span>
<a href="#l7.2"></a><span id="l7.2">rename to chat/components/src/SmileProtocolHandler.jsm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineminus">--- a/chat/components/src/smileProtocolHandler.js</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineplus">+++ b/chat/components/src/SmileProtocolHandler.jsm</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineat">@@ -1,16 +1,15 @@</span>
<a href="#l7.6"></a><span id="l7.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.7"></a><span id="l7.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.8"></a><span id="l7.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;SmileProtocolHandler&quot;];</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+</span>
<a href="#l7.12"></a><span id="l7.12"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-var { XPCOMUtils } = ChromeUtils.import(</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-  &quot;resource://gre/modules/XPCOMUtils.jsm&quot;</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-);</span>
<a href="#l7.16"></a><span id="l7.16"> var { getSmileRealURI } = ChromeUtils.import(</span>
<a href="#l7.17"></a><span id="l7.17">   &quot;resource:///modules/imSmileys.jsm&quot;</span>
<a href="#l7.18"></a><span id="l7.18"> );</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20"> var kSmileRegexp = /^smile:\/\//;</span>
<a href="#l7.21"></a><span id="l7.21"> </span>
<a href="#l7.22"></a><span id="l7.22"> function smileProtocolHandler() {}</span>
<a href="#l7.23"></a><span id="l7.23"> </span>
<a href="#l7.24"></a><span id="l7.24" class="difflineat">@@ -28,15 +27,10 @@ smileProtocolHandler.prototype = {</span>
<a href="#l7.25"></a><span id="l7.25">     let channel = Services.io.newChannelFromURIWithLoadInfo(uri, aLoadInfo);</span>
<a href="#l7.26"></a><span id="l7.26">     channel.originalURI = aURI;</span>
<a href="#l7.27"></a><span id="l7.27">     return channel;</span>
<a href="#l7.28"></a><span id="l7.28">   },</span>
<a href="#l7.29"></a><span id="l7.29">   allowPort(aPort, aScheme) {</span>
<a href="#l7.30"></a><span id="l7.30">     return false;</span>
<a href="#l7.31"></a><span id="l7.31">   },</span>
<a href="#l7.32"></a><span id="l7.32"> </span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-  classDescription: &quot;Smile Protocol Handler&quot;,</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-  classID: Components.ID(&quot;{04e58eae-dfbc-4c9e-8130-6d9ef19cbff4}&quot;),</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-  contractID: &quot;@mozilla.org/network/protocol;1?name=smile&quot;,</span>
<a href="#l7.36"></a><span id="l7.36">   QueryInterface: ChromeUtils.generateQI([Ci.nsIProtocolHandler]),</span>
<a href="#l7.37"></a><span id="l7.37"> };</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">-</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([smileProtocolHandler]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">new file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- /dev/null</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ b/chat/components/src/components.conf</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -0,0 +1,57 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineplus">+Classes = [</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+  {</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    'cid': '{a94b5427-cd8d-40cf-b47e-b67671953e70}',</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/accounts-service;1'],</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+    'jsm': 'resource:///modules/IMAccounts.jsm',</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+    'constructor': 'AccountsService',</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+  },</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+  {</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+    'cid': '{7cb20c68-ccc8-4a79-b6f1-0b4771ed6c23}',</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/commands-service;1'],</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+    'jsm': 'resource:///modules/IMCommands.jsm',</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+    'constructor': 'IMCommands',</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+  },</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+  {</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+    'cid': '{8c3725dd-ee26-489d-8135-736015af8c7f}',</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/contacts-service;1'],</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+    'jsm': 'resource:///modules/IMContacts.jsm',</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+    'constructor': 'ContactsService',</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineplus">+  },</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+  {</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+    'cid': '{1fa92237-4303-4384-b8ac-4e65b50810a5}',</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/tags-service;1'],</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+    'jsm': 'resource:///modules/IMContacts.jsm',</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineplus">+    'constructor': 'TagsService',</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+  },</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+  {</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+    'cid': '{b2397cd5-c76d-4618-8410-f344c7c6443a}',</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/conversations-service;1'],</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+    'jsm': 'resource:///modules/IMConversations.jsm',</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+    'constructor': 'ConversationsService',</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+  },</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+  {</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+    'cid': '{073f5953-853c-4a38-bd81-255510c31c2e}',</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/core-service;1'],</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+    'jsm': 'resource:///modules/IMCore.jsm',</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineplus">+    'constructor': 'IMCore',</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineplus">+  },</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+  {</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+    'cid': '{fb0dc220-2c7a-4216-9f19-6b8f3480eae9}',</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/logger;1'],</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+    'jsm': 'resource:///modules/Logger.jsm',</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+    'constructor': 'Logger',</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineplus">+    'categories': {'profile-after-change': 'Logger'},</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineplus">+  },</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineplus">+  {</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineplus">+    'cid': '{04e58eae-dfbc-4c9e-8130-6d9ef19cbff4}',</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+    'contract_ids': ['@mozilla.org/network/protocol;1?name=smile'],</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+    'jsm': 'resource:///modules/SmileProtocolHandler.jsm',</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+    'constructor': 'SmileProtocolHandler',</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+  },</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">deleted file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- a/chat/components/src/imAccounts.manifest</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ /dev/null</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineminus">-component {a94b5427-cd8d-40cf-b47e-b67671953e70} imAccounts.js</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineminus">-contract @mozilla.org/chat/accounts-service;1 {a94b5427-cd8d-40cf-b47e-b67671953e70}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">deleted file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- a/chat/components/src/imCommands.manifest</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ /dev/null</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineminus">-component {7cb20c68-ccc8-4a79-b6f1-0b4771ed6c23} imCommands.js</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineminus">-contract @mozilla.org/chat/commands-service;1 {7cb20c68-ccc8-4a79-b6f1-0b4771ed6c23}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">deleted file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- a/chat/components/src/imContacts.manifest</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ /dev/null</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -1,4 +0,0 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineminus">-component {8c3725dd-ee26-489d-8135-736015af8c7f} imContacts.js</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineminus">-contract @mozilla.org/chat/contacts-service;1 {8c3725dd-ee26-489d-8135-736015af8c7f}</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineminus">-component {1fa92237-4303-4384-b8ac-4e65b50810a5} imContacts.js</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineminus">-contract @mozilla.org/chat/tags-service;1 {1fa92237-4303-4384-b8ac-4e65b50810a5}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">deleted file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- a/chat/components/src/imConversations.manifest</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ /dev/null</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineminus">-component {b2397cd5-c76d-4618-8410-f344c7c6443a} imConversations.js</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineminus">-contract @mozilla.org/chat/conversations-service;1 {b2397cd5-c76d-4618-8410-f344c7c6443a}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">deleted file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- a/chat/components/src/imCore.manifest</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ /dev/null</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineminus">-component {073f5953-853c-4a38-bd81-255510c31c2e} imCore.js</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineminus">-contract @mozilla.org/chat/core-service;1 {073f5953-853c-4a38-bd81-255510c31c2e}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">deleted file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- a/chat/components/src/logger.manifest</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ /dev/null</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineminus">-component {fb0dc220-2c7a-4216-9f19-6b8f3480eae9} logger.js</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineminus">-contract @mozilla.org/chat/logger;1 {fb0dc220-2c7a-4216-9f19-6b8f3480eae9}</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineminus">-category profile-after-change Logger @mozilla.org/chat/logger;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/chat/components/src/moz.build</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/chat/components/src/moz.build</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,24 +1,20 @@</span>
<a href="#l15.4"></a><span id="l15.4"> # vim: set filetype=python:</span>
<a href="#l15.5"></a><span id="l15.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.6"></a><span id="l15.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.7"></a><span id="l15.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9"> XPCSHELL_TESTS_MANIFESTS += ['test/xpcshell.ini']</span>
<a href="#l15.10"></a><span id="l15.10"> </span>
<a href="#l15.11"></a><span id="l15.11" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-    'imAccounts.js',</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-    'imAccounts.manifest',</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-    'imCommands.js',</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-    'imCommands.manifest',</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-    'imContacts.js',</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-    'imContacts.manifest',</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-    'imConversations.js',</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">-    'imConversations.manifest',</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">-    'imCore.js',</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineminus">-    'imCore.manifest',</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-    'logger.js',</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-    'logger.manifest',</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-    'smileProtocolHandler.js',</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-    'smileProtocolHandler.manifest',</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+    'IMAccounts.jsm',</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+    'IMCommands.jsm',</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+    'IMContacts.jsm',</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+    'IMConversations.jsm',</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+    'IMCore.jsm',</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+    'Logger.jsm',</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+    'SmileProtocolHandler.jsm'</span>
<a href="#l15.34"></a><span id="l15.34"> ]</span>
<a href="#l15.35"></a><span id="l15.35"> </span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+    'components.conf',</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">deleted file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- a/chat/components/src/smileProtocolHandler.manifest</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ /dev/null</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineminus">-component {04e58eae-dfbc-4c9e-8130-6d9ef19cbff4} smileProtocolHandler.js</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineminus">-contract @mozilla.org/network/protocol;1?name=smile {04e58eae-dfbc-4c9e-8130-6d9ef19cbff4}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/chat/components/src/test/test_commands.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/chat/components/src/test/test_commands.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,20 +1,16 @@</span>
<a href="#l17.4"></a><span id="l17.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.5"></a><span id="l17.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.6"></a><span id="l17.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l17.9"></a><span id="l17.9"> // We don't load the command service via Services as we want to access</span>
<a href="#l17.10"></a><span id="l17.10"> // _findCommands in order to avoid having to intercept command execution.</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineminus">-var imCommands = {};</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-Services.scriptloader.loadSubScript(</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-  &quot;resource:///components/imCommands.js&quot;,</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-  imCommands</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-);</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+var { IMCommands } = ChromeUtils.import(&quot;resource:///modules/IMCommands.jsm&quot;);</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18"> var kPrplId = &quot;green&quot;;</span>
<a href="#l17.19"></a><span id="l17.19"> var kPrplId2 = &quot;red&quot;;</span>
<a href="#l17.20"></a><span id="l17.20"> </span>
<a href="#l17.21"></a><span id="l17.21"> var fakeAccount = {</span>
<a href="#l17.22"></a><span id="l17.22">   connected: true,</span>
<a href="#l17.23"></a><span id="l17.23">   protocol: { id: kPrplId },</span>
<a href="#l17.24"></a><span id="l17.24"> };</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineat">@@ -43,17 +39,17 @@ fakeCommand.prototype = {</span>
<a href="#l17.26"></a><span id="l17.26">     return &quot;&quot;;</span>
<a href="#l17.27"></a><span id="l17.27">   },</span>
<a href="#l17.28"></a><span id="l17.28">   usageContext: Ci.imICommand.CMD_CONTEXT_ALL,</span>
<a href="#l17.29"></a><span id="l17.29">   priority: Ci.imICommand.CMD_PRIORITY_PRPL,</span>
<a href="#l17.30"></a><span id="l17.30">   run: (aMsg, aConv) =&gt; true,</span>
<a href="#l17.31"></a><span id="l17.31"> };</span>
<a href="#l17.32"></a><span id="l17.32"> </span>
<a href="#l17.33"></a><span id="l17.33"> function run_test() {</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineminus">-  let cmdserv = new imCommands.CommandsService();</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineplus">+  let cmdserv = new IMCommands();</span>
<a href="#l17.36"></a><span id="l17.36">   cmdserv.initCommands();</span>
<a href="#l17.37"></a><span id="l17.37"> </span>
<a href="#l17.38"></a><span id="l17.38">   // Some commands providing multiple possible completions.</span>
<a href="#l17.39"></a><span id="l17.39">   cmdserv.registerCommand(new fakeCommand(&quot;banana&quot;), kPrplId2);</span>
<a href="#l17.40"></a><span id="l17.40">   cmdserv.registerCommand(new fakeCommand(&quot;baloney&quot;), kPrplId2);</span>
<a href="#l17.41"></a><span id="l17.41"> </span>
<a href="#l17.42"></a><span id="l17.42">   // MUC-only command.</span>
<a href="#l17.43"></a><span id="l17.43">   cmdserv.registerCommand(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/chat/components/src/test/test_conversations.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/chat/components/src/test/test_conversations.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,20 +1,17 @@</span>
<a href="#l18.4"></a><span id="l18.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l18.5"></a><span id="l18.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l18.6"></a><span id="l18.6"> </span>
<a href="#l18.7"></a><span id="l18.7"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l18.8"></a><span id="l18.8"> var { GenericConvIMPrototype, Message } = ChromeUtils.import(</span>
<a href="#l18.9"></a><span id="l18.9">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l18.10"></a><span id="l18.10"> );</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineminus">-</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-var imConversations = {};</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-Services.scriptloader.loadSubScript(</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-  &quot;resource:///components/imConversations.js&quot;,</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineminus">-  imConversations</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+var { IMMessage, UIConversation } = ChromeUtils.import(</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+  &quot;resource:///modules/IMConversations.jsm&quot;</span>
<a href="#l18.18"></a><span id="l18.18"> );</span>
<a href="#l18.19"></a><span id="l18.19"> </span>
<a href="#l18.20"></a><span id="l18.20"> // Fake prplConversation</span>
<a href="#l18.21"></a><span id="l18.21"> var _id = 0;</span>
<a href="#l18.22"></a><span id="l18.22"> function Conversation(aName) {</span>
<a href="#l18.23"></a><span id="l18.23">   this._name = aName;</span>
<a href="#l18.24"></a><span id="l18.24">   this._observers = [];</span>
<a href="#l18.25"></a><span id="l18.25">   this._date = Date.now() * 1000;</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineat">@@ -46,17 +43,17 @@ Conversation.prototype = {</span>
<a href="#l18.27"></a><span id="l18.27"> // message. This prevents regressions due to JS coercions.</span>
<a href="#l18.28"></a><span id="l18.28"> var test_null_message = function() {</span>
<a href="#l18.29"></a><span id="l18.29">   let originalMessage = &quot;Hi!&quot;;</span>
<a href="#l18.30"></a><span id="l18.30">   let pMsg = new Message(&quot;buddy&quot;, originalMessage, {</span>
<a href="#l18.31"></a><span id="l18.31">     outgoing: true,</span>
<a href="#l18.32"></a><span id="l18.32">     _alias: &quot;buddy&quot;,</span>
<a href="#l18.33"></a><span id="l18.33">     time: Date.now(),</span>
<a href="#l18.34"></a><span id="l18.34">   });</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineminus">-  let iMsg = new imConversations.imMessage(pMsg);</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+  let iMsg = new IMMessage(pMsg);</span>
<a href="#l18.37"></a><span id="l18.37">   equal(iMsg.message, originalMessage, &quot;Expected the original message.&quot;);</span>
<a href="#l18.38"></a><span id="l18.38">   // Setting the message should prevent a fallback to the original.</span>
<a href="#l18.39"></a><span id="l18.39">   iMsg.message = &quot;&quot;;</span>
<a href="#l18.40"></a><span id="l18.40">   equal(</span>
<a href="#l18.41"></a><span id="l18.41">     iMsg.message,</span>
<a href="#l18.42"></a><span id="l18.42">     &quot;&quot;,</span>
<a href="#l18.43"></a><span id="l18.43">     &quot;Expected an empty string; not the original message.&quot;</span>
<a href="#l18.44"></a><span id="l18.44">   );</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineat">@@ -99,17 +96,17 @@ function rot13(aString) {</span>
<a href="#l18.46"></a><span id="l18.46"> //</span>
<a href="#l18.47"></a><span id="l18.47"> // The test walks the sending path, which covers both.</span>
<a href="#l18.48"></a><span id="l18.48"> var test_message_transformation = function() {</span>
<a href="#l18.49"></a><span id="l18.49">   let conv = new Conversation();</span>
<a href="#l18.50"></a><span id="l18.50">   conv.sendMsg = function(aMsg) {</span>
<a href="#l18.51"></a><span id="l18.51">     this.writeMessage(&quot;user&quot;, aMsg, { outgoing: true });</span>
<a href="#l18.52"></a><span id="l18.52">   };</span>
<a href="#l18.53"></a><span id="l18.53"> </span>
<a href="#l18.54"></a><span id="l18.54" class="difflineminus">-  let uiConv = new imConversations.UIConversation(conv);</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineplus">+  let uiConv = new UIConversation(conv);</span>
<a href="#l18.56"></a><span id="l18.56">   let message = &quot;Hello!&quot;;</span>
<a href="#l18.57"></a><span id="l18.57">   let receivedMsg = false,</span>
<a href="#l18.58"></a><span id="l18.58">     newTxt = false;</span>
<a href="#l18.59"></a><span id="l18.59"> </span>
<a href="#l18.60"></a><span id="l18.60">   uiConv.addObserver({</span>
<a href="#l18.61"></a><span id="l18.61">     observe(aObject, aTopic, aMsg) {</span>
<a href="#l18.62"></a><span id="l18.62">       switch (aTopic) {</span>
<a href="#l18.63"></a><span id="l18.63">         case &quot;sending-message&quot;:</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineat">@@ -166,17 +163,17 @@ var test_cancel_send_message = function(</span>
<a href="#l18.65"></a><span id="l18.65">   conv.sendMsg = function(aMsg) {</span>
<a href="#l18.66"></a><span id="l18.66">     ok(</span>
<a href="#l18.67"></a><span id="l18.67">       false,</span>
<a href="#l18.68"></a><span id="l18.68">       &quot;The message should have been halted in the conversation service.&quot;</span>
<a href="#l18.69"></a><span id="l18.69">     );</span>
<a href="#l18.70"></a><span id="l18.70">   };</span>
<a href="#l18.71"></a><span id="l18.71"> </span>
<a href="#l18.72"></a><span id="l18.72">   let sending = false;</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineminus">-  let uiConv = new imConversations.UIConversation(conv);</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineplus">+  let uiConv = new UIConversation(conv);</span>
<a href="#l18.75"></a><span id="l18.75">   uiConv.addObserver({</span>
<a href="#l18.76"></a><span id="l18.76">     observe(aObject, aTopic, aMsg) {</span>
<a href="#l18.77"></a><span id="l18.77">       switch (aTopic) {</span>
<a href="#l18.78"></a><span id="l18.78">         case &quot;sending-message&quot;:</span>
<a href="#l18.79"></a><span id="l18.79">           ok(</span>
<a href="#l18.80"></a><span id="l18.80">             aObject.QueryInterface(Ci.imIOutgoingMessage),</span>
<a href="#l18.81"></a><span id="l18.81">             &quot;Wrong message type.&quot;</span>
<a href="#l18.82"></a><span id="l18.82">           );</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineat">@@ -200,17 +197,17 @@ var test_cancel_send_message = function(</span>
<a href="#l18.84"></a><span id="l18.84"> // A test that cancels a message before it gets displayed.</span>
<a href="#l18.85"></a><span id="l18.85"> var test_cancel_display_message = function() {</span>
<a href="#l18.86"></a><span id="l18.86">   let conv = new Conversation();</span>
<a href="#l18.87"></a><span id="l18.87">   conv.sendMsg = function(aMsg) {</span>
<a href="#l18.88"></a><span id="l18.88">     this.writeMessage(&quot;user&quot;, aMsg, { outgoing: true });</span>
<a href="#l18.89"></a><span id="l18.89">   };</span>
<a href="#l18.90"></a><span id="l18.90"> </span>
<a href="#l18.91"></a><span id="l18.91">   let received = false;</span>
<a href="#l18.92"></a><span id="l18.92" class="difflineminus">-  let uiConv = new imConversations.UIConversation(conv);</span>
<a href="#l18.93"></a><span id="l18.93" class="difflineplus">+  let uiConv = new UIConversation(conv);</span>
<a href="#l18.94"></a><span id="l18.94">   uiConv.addObserver({</span>
<a href="#l18.95"></a><span id="l18.95">     observe(aObject, aTopic, aMsg) {</span>
<a href="#l18.96"></a><span id="l18.96">       switch (aTopic) {</span>
<a href="#l18.97"></a><span id="l18.97">         case &quot;received-message&quot;:</span>
<a href="#l18.98"></a><span id="l18.98">           ok(aObject.QueryInterface(Ci.imIMessage), &quot;Wrong message type.&quot;);</span>
<a href="#l18.99"></a><span id="l18.99">           aObject.cancelled = true;</span>
<a href="#l18.100"></a><span id="l18.100">           received = true;</span>
<a href="#l18.101"></a><span id="l18.101">           break;</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineat">@@ -246,17 +243,17 @@ var test_prpl_message_prep = function() </span>
<a href="#l18.103"></a><span id="l18.103"> </span>
<a href="#l18.104"></a><span id="l18.104">   conv.prepareForDisplaying = function(aMsg) {</span>
<a href="#l18.105"></a><span id="l18.105">     ok(aMsg.QueryInterface(Ci.imIMessage), &quot;Wrong message type.&quot;);</span>
<a href="#l18.106"></a><span id="l18.106">     equal(aMsg.displayMessage, prefix + msg, &quot;Expected the prefixed message.&quot;);</span>
<a href="#l18.107"></a><span id="l18.107">     aMsg.displayMessage = aMsg.displayMessage.slice(prefix.length);</span>
<a href="#l18.108"></a><span id="l18.108">   };</span>
<a href="#l18.109"></a><span id="l18.109"> </span>
<a href="#l18.110"></a><span id="l18.110">   let receivedMsg = false;</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineminus">-  let uiConv = new imConversations.UIConversation(conv);</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineplus">+  let uiConv = new UIConversation(conv);</span>
<a href="#l18.113"></a><span id="l18.113">   uiConv.addObserver({</span>
<a href="#l18.114"></a><span id="l18.114">     observe(aObject, aTopic, aMsg) {</span>
<a href="#l18.115"></a><span id="l18.115">       if (aTopic === &quot;new-text&quot;) {</span>
<a href="#l18.116"></a><span id="l18.116">         ok(prepared, &quot;The message was not prepared before sending.&quot;);</span>
<a href="#l18.117"></a><span id="l18.117">         equal(aObject.displayMessage, msg, &quot;Expected the original message.&quot;);</span>
<a href="#l18.118"></a><span id="l18.118">         receivedMsg = true;</span>
<a href="#l18.119"></a><span id="l18.119">       }</span>
<a href="#l18.120"></a><span id="l18.120">     },</span>
<a href="#l18.121"></a><span id="l18.121" class="difflineat">@@ -279,17 +276,17 @@ var test_split_message_before_sending = </span>
<a href="#l18.122"></a><span id="l18.122">     equal(aMsg, msgs[msgCount++], &quot;Sending an unexpected message.&quot;);</span>
<a href="#l18.123"></a><span id="l18.123">   };</span>
<a href="#l18.124"></a><span id="l18.124">   conv.prepareForSending = function(aMsg) {</span>
<a href="#l18.125"></a><span id="l18.125">     ok(aMsg.QueryInterface(Ci.imIOutgoingMessage), &quot;Wrong message type.&quot;);</span>
<a href="#l18.126"></a><span id="l18.126">     prepared = true;</span>
<a href="#l18.127"></a><span id="l18.127">     return aMsg.message.split(&quot;\n&quot;);</span>
<a href="#l18.128"></a><span id="l18.128">   };</span>
<a href="#l18.129"></a><span id="l18.129"> </span>
<a href="#l18.130"></a><span id="l18.130" class="difflineminus">-  let uiConv = new imConversations.UIConversation(conv);</span>
<a href="#l18.131"></a><span id="l18.131" class="difflineplus">+  let uiConv = new UIConversation(conv);</span>
<a href="#l18.132"></a><span id="l18.132">   uiConv.sendMsg(msg);</span>
<a href="#l18.133"></a><span id="l18.133"> </span>
<a href="#l18.134"></a><span id="l18.134">   ok(prepared, &quot;Message wasn't prepared for sending.&quot;);</span>
<a href="#l18.135"></a><span id="l18.135">   equal(msgCount, 3, &quot;Not enough messages were sent.&quot;);</span>
<a href="#l18.136"></a><span id="l18.136"> };</span>
<a href="#l18.137"></a><span id="l18.137"> </span>
<a href="#l18.138"></a><span id="l18.138"> function run_test() {</span>
<a href="#l18.139"></a><span id="l18.139">   test_null_message();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/chat/components/src/test/test_logger.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/chat/components/src/test/test_logger.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -3,20 +3,29 @@</span>
<a href="#l19.4"></a><span id="l19.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6"> do_get_profile();</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l19.9"></a><span id="l19.9"> const { OS } = ChromeUtils.import(&quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11"> var gLogger = {};</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-Services.scriptloader.loadSubScript(</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-  &quot;resource:///components/logger.js&quot;,</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-  gLogger</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-);</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+var {</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+  Logger,</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+  encodeName,</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+  convIsRealMUC,</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+  getLogFolderPathForAccount,</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+  getLogFilePathForConversation,</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+  getNewLogFileName,</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+  queueFileOperation,</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineplus">+  fileOperations,</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineplus">+  appendToFile,</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineplus">+  getLogWriter,</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineplus">+  closeLogWriter,</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineplus">+} = ChromeUtils.import(&quot;resource:///modules/Logger.jsm&quot;);</span>
<a href="#l19.29"></a><span id="l19.29"> </span>
<a href="#l19.30"></a><span id="l19.30"> var logDirPath = OS.Path.join(OS.Constants.Path.profileDir, &quot;logs&quot;);</span>
<a href="#l19.31"></a><span id="l19.31"> </span>
<a href="#l19.32"></a><span id="l19.32"> var dummyAccount = {</span>
<a href="#l19.33"></a><span id="l19.33">   name: &quot;dummy-account&quot;,</span>
<a href="#l19.34"></a><span id="l19.34">   normalizedName: &quot;dummyaccount&quot;,</span>
<a href="#l19.35"></a><span id="l19.35">   protocol: {</span>
<a href="#l19.36"></a><span id="l19.36">     normalizedName: &quot;dummy&quot;,</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineat">@@ -179,150 +188,147 @@ var encodeName_output = [</span>
<a href="#l19.38"></a><span id="l19.38">   &quot;%25file&quot;,</span>
<a href="#l19.39"></a><span id="l19.39">   &quot;%5c&quot; + &quot;fi&quot; + &quot;%3f%2a%26%25&quot; + &quot;le&quot; + &quot;%3c%3e&quot;, // eslint-disable-line no-useless-concat</span>
<a href="#l19.40"></a><span id="l19.40"> ];</span>
<a href="#l19.41"></a><span id="l19.41"> </span>
<a href="#l19.42"></a><span id="l19.42"> var test_queueFileOperation = async function() {</span>
<a href="#l19.43"></a><span id="l19.43">   let dummyRejectedOperation = () =&gt; Promise.reject(&quot;Rejected!&quot;);</span>
<a href="#l19.44"></a><span id="l19.44">   let dummyResolvedOperation = () =&gt; Promise.resolve(&quot;Resolved!&quot;);</span>
<a href="#l19.45"></a><span id="l19.45"> </span>
<a href="#l19.46"></a><span id="l19.46" class="difflineminus">-  let gFP = gLogger.gFilePromises;</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineminus">-  let qFO = gLogger.queueFileOperation;</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineminus">-</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineminus">-  // Immediately after calling qFO, &quot;path1&quot; should be mapped to p1.</span>
<a href="#l19.50"></a><span id="l19.50" class="difflineplus">+  // Immediately after calling queueFileOperation, &quot;path1&quot; should be mapped to p1.</span>
<a href="#l19.51"></a><span id="l19.51">   // After yielding, the reference should be cleared from the map.</span>
<a href="#l19.52"></a><span id="l19.52" class="difflineminus">-  let p1 = qFO(&quot;path1&quot;, dummyResolvedOperation);</span>
<a href="#l19.53"></a><span id="l19.53" class="difflineminus">-  equal(gFP.get(&quot;path1&quot;), p1);</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineplus">+  let p1 = queueFileOperation(&quot;path1&quot;, dummyResolvedOperation);</span>
<a href="#l19.55"></a><span id="l19.55" class="difflineplus">+  equal(fileOperations.get(&quot;path1&quot;), p1);</span>
<a href="#l19.56"></a><span id="l19.56">   await p1;</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineminus">-  ok(!gFP.has(&quot;path1&quot;));</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineplus">+  ok(!fileOperations.has(&quot;path1&quot;));</span>
<a href="#l19.59"></a><span id="l19.59"> </span>
<a href="#l19.60"></a><span id="l19.60">   // Repeat above test for a rejected promise.</span>
<a href="#l19.61"></a><span id="l19.61" class="difflineminus">-  let p2 = qFO(&quot;path2&quot;, dummyRejectedOperation);</span>
<a href="#l19.62"></a><span id="l19.62" class="difflineminus">-  equal(gFP.get(&quot;path2&quot;), p2);</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineplus">+  let p2 = queueFileOperation(&quot;path2&quot;, dummyRejectedOperation);</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineplus">+  equal(fileOperations.get(&quot;path2&quot;), p2);</span>
<a href="#l19.65"></a><span id="l19.65">   // This should throw since p2 rejected. Drop the error.</span>
<a href="#l19.66"></a><span id="l19.66">   await p2.then(() =&gt; do_throw(), () =&gt; {});</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineminus">-  ok(!gFP.has(&quot;path2&quot;));</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineplus">+  ok(!fileOperations.has(&quot;path2&quot;));</span>
<a href="#l19.69"></a><span id="l19.69"> </span>
<a href="#l19.70"></a><span id="l19.70">   let onPromiseComplete = (aPromise, aHandler) =&gt; {</span>
<a href="#l19.71"></a><span id="l19.71">     return aPromise.then(aHandler, aHandler);</span>
<a href="#l19.72"></a><span id="l19.72">   };</span>
<a href="#l19.73"></a><span id="l19.73">   let test_queueOrder = aOperation =&gt; {</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineminus">-    let promise = qFO(&quot;queueOrderPath&quot;, aOperation);</span>
<a href="#l19.75"></a><span id="l19.75" class="difflineplus">+    let promise = queueFileOperation(&quot;queueOrderPath&quot;, aOperation);</span>
<a href="#l19.76"></a><span id="l19.76">     let firstOperationComplete = false;</span>
<a href="#l19.77"></a><span id="l19.77">     onPromiseComplete(promise, () =&gt; (firstOperationComplete = true));</span>
<a href="#l19.78"></a><span id="l19.78" class="difflineminus">-    return qFO(&quot;queueOrderPath&quot;, () =&gt; {</span>
<a href="#l19.79"></a><span id="l19.79" class="difflineplus">+    return queueFileOperation(&quot;queueOrderPath&quot;, () =&gt; {</span>
<a href="#l19.80"></a><span id="l19.80">       ok(firstOperationComplete);</span>
<a href="#l19.81"></a><span id="l19.81">     });</span>
<a href="#l19.82"></a><span id="l19.82">   };</span>
<a href="#l19.83"></a><span id="l19.83">   // Test the queue order for rejected and resolved promises.</span>
<a href="#l19.84"></a><span id="l19.84">   await test_queueOrder(dummyResolvedOperation);</span>
<a href="#l19.85"></a><span id="l19.85">   await test_queueOrder(dummyRejectedOperation);</span>
<a href="#l19.86"></a><span id="l19.86"> };</span>
<a href="#l19.87"></a><span id="l19.87"> </span>
<a href="#l19.88"></a><span id="l19.88"> var test_getLogFolderPathForAccount = async function() {</span>
<a href="#l19.89"></a><span id="l19.89" class="difflineminus">-  let path = gLogger.getLogFolderPathForAccount(dummyAccount);</span>
<a href="#l19.90"></a><span id="l19.90" class="difflineplus">+  let path = getLogFolderPathForAccount(dummyAccount);</span>
<a href="#l19.91"></a><span id="l19.91">   equal(</span>
<a href="#l19.92"></a><span id="l19.92">     OS.Path.join(</span>
<a href="#l19.93"></a><span id="l19.93">       logDirPath,</span>
<a href="#l19.94"></a><span id="l19.94">       dummyAccount.protocol.normalizedName,</span>
<a href="#l19.95"></a><span id="l19.95" class="difflineminus">-      gLogger.encodeName(dummyAccount.normalizedName)</span>
<a href="#l19.96"></a><span id="l19.96" class="difflineplus">+      encodeName(dummyAccount.normalizedName)</span>
<a href="#l19.97"></a><span id="l19.97">     ),</span>
<a href="#l19.98"></a><span id="l19.98">     path</span>
<a href="#l19.99"></a><span id="l19.99">   );</span>
<a href="#l19.100"></a><span id="l19.100"> };</span>
<a href="#l19.101"></a><span id="l19.101"> </span>
<a href="#l19.102"></a><span id="l19.102"> // Tests the global function getLogFilePathForConversation in logger.js.</span>
<a href="#l19.103"></a><span id="l19.103"> var test_getLogFilePathForConversation = async function() {</span>
<a href="#l19.104"></a><span id="l19.104" class="difflineminus">-  let path = gLogger.getLogFilePathForConversation(dummyConv, &quot;format&quot;);</span>
<a href="#l19.105"></a><span id="l19.105" class="difflineplus">+  let path = getLogFilePathForConversation(dummyConv, &quot;format&quot;);</span>
<a href="#l19.106"></a><span id="l19.106">   let expectedPath = OS.Path.join(</span>
<a href="#l19.107"></a><span id="l19.107">     logDirPath,</span>
<a href="#l19.108"></a><span id="l19.108">     dummyAccount.protocol.normalizedName,</span>
<a href="#l19.109"></a><span id="l19.109" class="difflineminus">-    gLogger.encodeName(dummyAccount.normalizedName)</span>
<a href="#l19.110"></a><span id="l19.110" class="difflineplus">+    encodeName(dummyAccount.normalizedName)</span>
<a href="#l19.111"></a><span id="l19.111">   );</span>
<a href="#l19.112"></a><span id="l19.112">   expectedPath = OS.Path.join(</span>
<a href="#l19.113"></a><span id="l19.113">     expectedPath,</span>
<a href="#l19.114"></a><span id="l19.114" class="difflineminus">-    gLogger.encodeName(dummyConv.normalizedName)</span>
<a href="#l19.115"></a><span id="l19.115" class="difflineplus">+    encodeName(dummyConv.normalizedName)</span>
<a href="#l19.116"></a><span id="l19.116">   );</span>
<a href="#l19.117"></a><span id="l19.117">   expectedPath = OS.Path.join(</span>
<a href="#l19.118"></a><span id="l19.118">     expectedPath,</span>
<a href="#l19.119"></a><span id="l19.119" class="difflineminus">-    gLogger.getNewLogFileName(&quot;format&quot;, dummyConv.startDate / 1000)</span>
<a href="#l19.120"></a><span id="l19.120" class="difflineplus">+    getNewLogFileName(&quot;format&quot;, dummyConv.startDate / 1000)</span>
<a href="#l19.121"></a><span id="l19.121">   );</span>
<a href="#l19.122"></a><span id="l19.122">   equal(path, expectedPath);</span>
<a href="#l19.123"></a><span id="l19.123"> };</span>
<a href="#l19.124"></a><span id="l19.124"> </span>
<a href="#l19.125"></a><span id="l19.125"> var test_getLogFilePathForMUC = async function() {</span>
<a href="#l19.126"></a><span id="l19.126" class="difflineminus">-  let path = gLogger.getLogFilePathForConversation(dummyMUC, &quot;format&quot;);</span>
<a href="#l19.127"></a><span id="l19.127" class="difflineplus">+  let path = getLogFilePathForConversation(dummyMUC, &quot;format&quot;);</span>
<a href="#l19.128"></a><span id="l19.128">   let expectedPath = OS.Path.join(</span>
<a href="#l19.129"></a><span id="l19.129">     logDirPath,</span>
<a href="#l19.130"></a><span id="l19.130">     dummyAccount.protocol.normalizedName,</span>
<a href="#l19.131"></a><span id="l19.131" class="difflineminus">-    gLogger.encodeName(dummyAccount.normalizedName)</span>
<a href="#l19.132"></a><span id="l19.132" class="difflineplus">+    encodeName(dummyAccount.normalizedName)</span>
<a href="#l19.133"></a><span id="l19.133">   );</span>
<a href="#l19.134"></a><span id="l19.134">   expectedPath = OS.Path.join(</span>
<a href="#l19.135"></a><span id="l19.135">     expectedPath,</span>
<a href="#l19.136"></a><span id="l19.136" class="difflineminus">-    gLogger.encodeName(dummyMUC.normalizedName + &quot;.chat&quot;)</span>
<a href="#l19.137"></a><span id="l19.137" class="difflineplus">+    encodeName(dummyMUC.normalizedName + &quot;.chat&quot;)</span>
<a href="#l19.138"></a><span id="l19.138">   );</span>
<a href="#l19.139"></a><span id="l19.139">   expectedPath = OS.Path.join(</span>
<a href="#l19.140"></a><span id="l19.140">     expectedPath,</span>
<a href="#l19.141"></a><span id="l19.141" class="difflineminus">-    gLogger.getNewLogFileName(&quot;format&quot;, dummyMUC.startDate / 1000)</span>
<a href="#l19.142"></a><span id="l19.142" class="difflineplus">+    getNewLogFileName(&quot;format&quot;, dummyMUC.startDate / 1000)</span>
<a href="#l19.143"></a><span id="l19.143">   );</span>
<a href="#l19.144"></a><span id="l19.144">   equal(path, expectedPath);</span>
<a href="#l19.145"></a><span id="l19.145"> };</span>
<a href="#l19.146"></a><span id="l19.146"> </span>
<a href="#l19.147"></a><span id="l19.147"> var test_getLogFilePathForTwitterConv = async function() {</span>
<a href="#l19.148"></a><span id="l19.148" class="difflineminus">-  let path = gLogger.getLogFilePathForConversation(dummyTwitterConv, &quot;format&quot;);</span>
<a href="#l19.149"></a><span id="l19.149" class="difflineplus">+  let path = getLogFilePathForConversation(dummyTwitterConv, &quot;format&quot;);</span>
<a href="#l19.150"></a><span id="l19.150">   let expectedPath = OS.Path.join(</span>
<a href="#l19.151"></a><span id="l19.151">     logDirPath,</span>
<a href="#l19.152"></a><span id="l19.152">     dummyTwitterAccount.protocol.normalizedName,</span>
<a href="#l19.153"></a><span id="l19.153" class="difflineminus">-    gLogger.encodeName(dummyTwitterAccount.normalizedName)</span>
<a href="#l19.154"></a><span id="l19.154" class="difflineplus">+    encodeName(dummyTwitterAccount.normalizedName)</span>
<a href="#l19.155"></a><span id="l19.155">   );</span>
<a href="#l19.156"></a><span id="l19.156">   expectedPath = OS.Path.join(</span>
<a href="#l19.157"></a><span id="l19.157">     expectedPath,</span>
<a href="#l19.158"></a><span id="l19.158" class="difflineminus">-    gLogger.encodeName(dummyTwitterConv.normalizedName)</span>
<a href="#l19.159"></a><span id="l19.159" class="difflineplus">+    encodeName(dummyTwitterConv.normalizedName)</span>
<a href="#l19.160"></a><span id="l19.160">   );</span>
<a href="#l19.161"></a><span id="l19.161">   expectedPath = OS.Path.join(</span>
<a href="#l19.162"></a><span id="l19.162">     expectedPath,</span>
<a href="#l19.163"></a><span id="l19.163" class="difflineminus">-    gLogger.getNewLogFileName(&quot;format&quot;, dummyTwitterConv.startDate / 1000)</span>
<a href="#l19.164"></a><span id="l19.164" class="difflineplus">+    getNewLogFileName(&quot;format&quot;, dummyTwitterConv.startDate / 1000)</span>
<a href="#l19.165"></a><span id="l19.165">   );</span>
<a href="#l19.166"></a><span id="l19.166">   equal(path, expectedPath);</span>
<a href="#l19.167"></a><span id="l19.167"> };</span>
<a href="#l19.168"></a><span id="l19.168"> </span>
<a href="#l19.169"></a><span id="l19.169"> var test_appendToFile = async function() {</span>
<a href="#l19.170"></a><span id="l19.170">   const kStringToWrite = &quot;Hello, world!&quot;;</span>
<a href="#l19.171"></a><span id="l19.171">   let path = OS.Path.join(OS.Constants.Path.profileDir, &quot;testFile.txt&quot;);</span>
<a href="#l19.172"></a><span id="l19.172">   let encoder = new TextEncoder();</span>
<a href="#l19.173"></a><span id="l19.173">   let encodedString = encoder.encode(kStringToWrite);</span>
<a href="#l19.174"></a><span id="l19.174" class="difflineminus">-  gLogger.appendToFile(path, encodedString);</span>
<a href="#l19.175"></a><span id="l19.175" class="difflineplus">+  appendToFile(path, encodedString);</span>
<a href="#l19.176"></a><span id="l19.176">   encodedString = encoder.encode(kStringToWrite);</span>
<a href="#l19.177"></a><span id="l19.177" class="difflineminus">-  gLogger.appendToFile(path, encodedString);</span>
<a href="#l19.178"></a><span id="l19.178" class="difflineplus">+  appendToFile(path, encodedString);</span>
<a href="#l19.179"></a><span id="l19.179">   let text = new TextDecoder().decode(</span>
<a href="#l19.180"></a><span id="l19.180" class="difflineminus">-    await gLogger.queueFileOperation(path, () =&gt; OS.File.read(path))</span>
<a href="#l19.181"></a><span id="l19.181" class="difflineplus">+    await queueFileOperation(path, () =&gt; OS.File.read(path))</span>
<a href="#l19.182"></a><span id="l19.182">   );</span>
<a href="#l19.183"></a><span id="l19.183">   // The read text should be equal to kStringToWrite repeated twice.</span>
<a href="#l19.184"></a><span id="l19.184">   equal(text, kStringToWrite + kStringToWrite);</span>
<a href="#l19.185"></a><span id="l19.185">   await OS.File.remove(path);</span>
<a href="#l19.186"></a><span id="l19.186"> };</span>
<a href="#l19.187"></a><span id="l19.187"> </span>
<a href="#l19.188"></a><span id="l19.188"> // Tests the getLogPathsForConversation API defined in the imILogger interface.</span>
<a href="#l19.189"></a><span id="l19.189"> var test_getLogPathsForConversation = async function() {</span>
<a href="#l19.190"></a><span id="l19.190" class="difflineminus">-  let logger = new gLogger.Logger();</span>
<a href="#l19.191"></a><span id="l19.191" class="difflineplus">+  let logger = new Logger();</span>
<a href="#l19.192"></a><span id="l19.192">   let paths = await logger.getLogPathsForConversation(dummyConv);</span>
<a href="#l19.193"></a><span id="l19.193">   // The path should be null since a LogWriter hasn't been created yet.</span>
<a href="#l19.194"></a><span id="l19.194">   equal(paths, null);</span>
<a href="#l19.195"></a><span id="l19.195" class="difflineminus">-  let logWriter = gLogger.getLogWriter(dummyConv);</span>
<a href="#l19.196"></a><span id="l19.196" class="difflineplus">+  let logWriter = getLogWriter(dummyConv);</span>
<a href="#l19.197"></a><span id="l19.197">   paths = await logger.getLogPathsForConversation(dummyConv);</span>
<a href="#l19.198"></a><span id="l19.198">   equal(paths.length, 1);</span>
<a href="#l19.199"></a><span id="l19.199">   equal(paths[0], logWriter.currentPath);</span>
<a href="#l19.200"></a><span id="l19.200">   ok(await OS.File.exists(paths[0]));</span>
<a href="#l19.201"></a><span id="l19.201">   // Ensure this doesn't interfere with future tests.</span>
<a href="#l19.202"></a><span id="l19.202">   await OS.File.remove(paths[0]);</span>
<a href="#l19.203"></a><span id="l19.203" class="difflineminus">-  gLogger.closeLogWriter(dummyConv);</span>
<a href="#l19.204"></a><span id="l19.204" class="difflineplus">+  closeLogWriter(dummyConv);</span>
<a href="#l19.205"></a><span id="l19.205"> };</span>
<a href="#l19.206"></a><span id="l19.206"> </span>
<a href="#l19.207"></a><span id="l19.207"> var test_logging = async function() {</span>
<a href="#l19.208"></a><span id="l19.208" class="difflineminus">-  let logger = new gLogger.Logger();</span>
<a href="#l19.209"></a><span id="l19.209" class="difflineplus">+  let logger = new Logger();</span>
<a href="#l19.210"></a><span id="l19.210">   let oneSec = 1000000; // Microseconds.</span>
<a href="#l19.211"></a><span id="l19.211"> </span>
<a href="#l19.212"></a><span id="l19.212">   // Creates a set of dummy messages for a conv (sets appropriate times).</span>
<a href="#l19.213"></a><span id="l19.213">   let getMsgsForConv = function(aConv) {</span>
<a href="#l19.214"></a><span id="l19.214">     // Convert to seconds because that's what logMessage expects.</span>
<a href="#l19.215"></a><span id="l19.215">     let startTime = Math.round(aConv.startDate / oneSec);</span>
<a href="#l19.216"></a><span id="l19.216">     return [</span>
<a href="#l19.217"></a><span id="l19.217">       {</span>
<a href="#l19.218"></a><span id="l19.218" class="difflineat">@@ -350,45 +356,45 @@ var test_logging = async function() {</span>
<a href="#l19.219"></a><span id="l19.219">         incoming: true,</span>
<a href="#l19.220"></a><span id="l19.220">       },</span>
<a href="#l19.221"></a><span id="l19.221">     ];</span>
<a href="#l19.222"></a><span id="l19.222">   };</span>
<a href="#l19.223"></a><span id="l19.223">   let firstDayMsgs = getMsgsForConv(dummyConv);</span>
<a href="#l19.224"></a><span id="l19.224">   let secondDayMsgs = getMsgsForConv(dummyConv2);</span>
<a href="#l19.225"></a><span id="l19.225"> </span>
<a href="#l19.226"></a><span id="l19.226">   let logMessagesForConv = async function(aConv, aMessages) {</span>
<a href="#l19.227"></a><span id="l19.227" class="difflineminus">-    let logWriter = gLogger.getLogWriter(aConv);</span>
<a href="#l19.228"></a><span id="l19.228" class="difflineplus">+    let logWriter = getLogWriter(aConv);</span>
<a href="#l19.229"></a><span id="l19.229">     for (let message of aMessages) {</span>
<a href="#l19.230"></a><span id="l19.230">       logWriter.logMessage(message);</span>
<a href="#l19.231"></a><span id="l19.231">     }</span>
<a href="#l19.232"></a><span id="l19.232">     // If we don't wait for the messages to get written, we have no guarantee</span>
<a href="#l19.233"></a><span id="l19.233">     // later in the test that the log files were created, and getConversation</span>
<a href="#l19.234"></a><span id="l19.234">     // will return an EmptyEnumerator. Logging the messages is queued on the</span>
<a href="#l19.235"></a><span id="l19.235">     // _initialized promise, so we need to await on that first.</span>
<a href="#l19.236"></a><span id="l19.236">     await logWriter._initialized;</span>
<a href="#l19.237"></a><span id="l19.237" class="difflineminus">-    await gLogger.gFilePromises.get(logWriter.currentPath);</span>
<a href="#l19.238"></a><span id="l19.238" class="difflineplus">+    await fileOperations.get(logWriter.currentPath);</span>
<a href="#l19.239"></a><span id="l19.239">     // Ensure two different files for the different dates.</span>
<a href="#l19.240"></a><span id="l19.240" class="difflineminus">-    gLogger.closeLogWriter(aConv);</span>
<a href="#l19.241"></a><span id="l19.241" class="difflineplus">+    closeLogWriter(aConv);</span>
<a href="#l19.242"></a><span id="l19.242">   };</span>
<a href="#l19.243"></a><span id="l19.243">   await logMessagesForConv(dummyConv, firstDayMsgs);</span>
<a href="#l19.244"></a><span id="l19.244">   await logMessagesForConv(dummyConv2, secondDayMsgs);</span>
<a href="#l19.245"></a><span id="l19.245"> </span>
<a href="#l19.246"></a><span id="l19.246">   // Write a zero-length file and a file with incorrect JSON for each day</span>
<a href="#l19.247"></a><span id="l19.247">   // to ensure they are handled correctly.</span>
<a href="#l19.248"></a><span id="l19.248">   let logDir = OS.Path.dirname(</span>
<a href="#l19.249"></a><span id="l19.249" class="difflineminus">-    gLogger.getLogFilePathForConversation(dummyConv, &quot;json&quot;)</span>
<a href="#l19.250"></a><span id="l19.250" class="difflineplus">+    getLogFilePathForConversation(dummyConv, &quot;json&quot;)</span>
<a href="#l19.251"></a><span id="l19.251">   );</span>
<a href="#l19.252"></a><span id="l19.252">   let createBadFiles = async function(aConv) {</span>
<a href="#l19.253"></a><span id="l19.253">     let blankFile = OS.Path.join(</span>
<a href="#l19.254"></a><span id="l19.254">       logDir,</span>
<a href="#l19.255"></a><span id="l19.255" class="difflineminus">-      gLogger.getNewLogFileName(&quot;json&quot;, (aConv.startDate + oneSec) / 1000)</span>
<a href="#l19.256"></a><span id="l19.256" class="difflineplus">+      getNewLogFileName(&quot;json&quot;, (aConv.startDate + oneSec) / 1000)</span>
<a href="#l19.257"></a><span id="l19.257">     );</span>
<a href="#l19.258"></a><span id="l19.258">     let invalidJSONFile = OS.Path.join(</span>
<a href="#l19.259"></a><span id="l19.259">       logDir,</span>
<a href="#l19.260"></a><span id="l19.260" class="difflineminus">-      gLogger.getNewLogFileName(&quot;json&quot;, (aConv.startDate + 2 * oneSec) / 1000)</span>
<a href="#l19.261"></a><span id="l19.261" class="difflineplus">+      getNewLogFileName(&quot;json&quot;, (aConv.startDate + 2 * oneSec) / 1000)</span>
<a href="#l19.262"></a><span id="l19.262">     );</span>
<a href="#l19.263"></a><span id="l19.263">     let file = await OS.File.open(blankFile, { truncate: true });</span>
<a href="#l19.264"></a><span id="l19.264">     await file.close();</span>
<a href="#l19.265"></a><span id="l19.265">     await OS.File.writeAtomic(</span>
<a href="#l19.266"></a><span id="l19.266">       invalidJSONFile,</span>
<a href="#l19.267"></a><span id="l19.267">       new TextEncoder().encode(&quot;This isn't JSON!&quot;)</span>
<a href="#l19.268"></a><span id="l19.268">     );</span>
<a href="#l19.269"></a><span id="l19.269">   };</span>
<a href="#l19.270"></a><span id="l19.270" class="difflineat">@@ -454,41 +460,39 @@ var test_logging = async function() {</span>
<a href="#l19.271"></a><span id="l19.271">   await logger.forEach({</span>
<a href="#l19.272"></a><span id="l19.272">     async processLog(aLog) {</span>
<a href="#l19.273"></a><span id="l19.273">       let info = await OS.File.stat(aLog);</span>
<a href="#l19.274"></a><span id="l19.274">       ok(!info.isDir);</span>
<a href="#l19.275"></a><span id="l19.275">       ok(aLog.endsWith(&quot;.json&quot;));</span>
<a href="#l19.276"></a><span id="l19.276">       await OS.File.remove(aLog);</span>
<a href="#l19.277"></a><span id="l19.277">     },</span>
<a href="#l19.278"></a><span id="l19.278">   });</span>
<a href="#l19.279"></a><span id="l19.279" class="difflineminus">-  let logFolder = OS.Path.dirname(</span>
<a href="#l19.280"></a><span id="l19.280" class="difflineminus">-    gLogger.getLogFilePathForConversation(dummyConv)</span>
<a href="#l19.281"></a><span id="l19.281" class="difflineminus">-  );</span>
<a href="#l19.282"></a><span id="l19.282" class="difflineplus">+  let logFolder = OS.Path.dirname(getLogFilePathForConversation(dummyConv));</span>
<a href="#l19.283"></a><span id="l19.283">   // The folder should now be empty - this will throw if it isn't.</span>
<a href="#l19.284"></a><span id="l19.284">   await OS.File.removeEmptyDir(logFolder, { ignoreAbsent: false });</span>
<a href="#l19.285"></a><span id="l19.285"> };</span>
<a href="#l19.286"></a><span id="l19.286"> </span>
<a href="#l19.287"></a><span id="l19.287"> var test_logFileSplitting = async function() {</span>
<a href="#l19.288"></a><span id="l19.288">   // Start clean, remove the log directory.</span>
<a href="#l19.289"></a><span id="l19.289">   let logFolderPath = OS.Path.join(OS.Constants.Path.profileDir, &quot;logs&quot;);</span>
<a href="#l19.290"></a><span id="l19.290">   await OS.File.removeDir(logFolderPath, { ignoreAbsent: true });</span>
<a href="#l19.291"></a><span id="l19.291" class="difflineminus">-  let logWriter = gLogger.getLogWriter(dummyConv);</span>
<a href="#l19.292"></a><span id="l19.292" class="difflineplus">+  let logWriter = getLogWriter(dummyConv);</span>
<a href="#l19.293"></a><span id="l19.293">   let startTime = logWriter._startTime / 1000; // Message times are in seconds.</span>
<a href="#l19.294"></a><span id="l19.294">   let oldPath = logWriter.currentPath;</span>
<a href="#l19.295"></a><span id="l19.295">   let message = {</span>
<a href="#l19.296"></a><span id="l19.296">     time: startTime,</span>
<a href="#l19.297"></a><span id="l19.297">     who: &quot;John Doe&quot;,</span>
<a href="#l19.298"></a><span id="l19.298">     originalMessage: &quot;Hello, world!&quot;,</span>
<a href="#l19.299"></a><span id="l19.299">     outgoing: true,</span>
<a href="#l19.300"></a><span id="l19.300">   };</span>
<a href="#l19.301"></a><span id="l19.301"> </span>
<a href="#l19.302"></a><span id="l19.302">   let logMessage = async function(aMessage) {</span>
<a href="#l19.303"></a><span id="l19.303">     logWriter.logMessage(aMessage);</span>
<a href="#l19.304"></a><span id="l19.304">     await logWriter._initialized;</span>
<a href="#l19.305"></a><span id="l19.305" class="difflineminus">-    await gLogger.gFilePromises.get(logWriter.currentPath);</span>
<a href="#l19.306"></a><span id="l19.306" class="difflineplus">+    await fileOperations.get(logWriter.currentPath);</span>
<a href="#l19.307"></a><span id="l19.307">   };</span>
<a href="#l19.308"></a><span id="l19.308"> </span>
<a href="#l19.309"></a><span id="l19.309">   await logMessage(message);</span>
<a href="#l19.310"></a><span id="l19.310">   message.time += logWriter.kInactivityLimit / 1000 + 1;</span>
<a href="#l19.311"></a><span id="l19.311">   // This should go in a new log file.</span>
<a href="#l19.312"></a><span id="l19.312">   await logMessage(message);</span>
<a href="#l19.313"></a><span id="l19.313">   notEqual(logWriter.currentPath, oldPath);</span>
<a href="#l19.314"></a><span id="l19.314">   // The log writer's new start time should be the time of the message.</span>
<a href="#l19.315"></a><span id="l19.315" class="difflineat">@@ -563,23 +567,23 @@ var test_logFileSplitting = async functi</span>
<a href="#l19.316"></a><span id="l19.316"> </span>
<a href="#l19.317"></a><span id="l19.317">   // Clean up.</span>
<a href="#l19.318"></a><span id="l19.318">   await OS.File.removeDir(logFolderPath);</span>
<a href="#l19.319"></a><span id="l19.319"> };</span>
<a href="#l19.320"></a><span id="l19.320"> </span>
<a href="#l19.321"></a><span id="l19.321"> function run_test() {</span>
<a href="#l19.322"></a><span id="l19.322">   // Test encodeName().</span>
<a href="#l19.323"></a><span id="l19.323">   for (let i = 0; i &lt; encodeName_input.length; ++i) {</span>
<a href="#l19.324"></a><span id="l19.324" class="difflineminus">-    equal(gLogger.encodeName(encodeName_input[i]), encodeName_output[i]);</span>
<a href="#l19.325"></a><span id="l19.325" class="difflineplus">+    equal(encodeName(encodeName_input[i]), encodeName_output[i]);</span>
<a href="#l19.326"></a><span id="l19.326">   }</span>
<a href="#l19.327"></a><span id="l19.327"> </span>
<a href="#l19.328"></a><span id="l19.328">   // Test convIsRealMUC().</span>
<a href="#l19.329"></a><span id="l19.329" class="difflineminus">-  ok(!gLogger.convIsRealMUC(dummyConv));</span>
<a href="#l19.330"></a><span id="l19.330" class="difflineminus">-  ok(!gLogger.convIsRealMUC(dummyTwitterConv));</span>
<a href="#l19.331"></a><span id="l19.331" class="difflineminus">-  ok(gLogger.convIsRealMUC(dummyMUC));</span>
<a href="#l19.332"></a><span id="l19.332" class="difflineplus">+  ok(!convIsRealMUC(dummyConv));</span>
<a href="#l19.333"></a><span id="l19.333" class="difflineplus">+  ok(!convIsRealMUC(dummyTwitterConv));</span>
<a href="#l19.334"></a><span id="l19.334" class="difflineplus">+  ok(convIsRealMUC(dummyMUC));</span>
<a href="#l19.335"></a><span id="l19.335"> </span>
<a href="#l19.336"></a><span id="l19.336">   add_task(test_getLogFolderPathForAccount);</span>
<a href="#l19.337"></a><span id="l19.337"> </span>
<a href="#l19.338"></a><span id="l19.338">   add_task(test_getLogFilePathForConversation);</span>
<a href="#l19.339"></a><span id="l19.339"> </span>
<a href="#l19.340"></a><span id="l19.340">   add_task(test_getLogFilePathForMUC);</span>
<a href="#l19.341"></a><span id="l19.341"> </span>
<a href="#l19.342"></a><span id="l19.342">   add_task(test_getLogFilePathForTwitterConv);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">rename from chat/protocols/facebook/facebook.js</span>
<a href="#l20.2"></a><span id="l20.2">rename to chat/protocols/facebook/Facebook.jsm</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineminus">--- a/chat/protocols/facebook/facebook.js</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineplus">+++ b/chat/protocols/facebook/Facebook.jsm</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l20.6"></a><span id="l20.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.7"></a><span id="l20.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.8"></a><span id="l20.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.9"></a><span id="l20.9"> </span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;FacebookProtocol&quot;];</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+</span>
<a href="#l20.12"></a><span id="l20.12"> var { XPCOMUtils, l10nHelper } = ChromeUtils.import(</span>
<a href="#l20.13"></a><span id="l20.13">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l20.14"></a><span id="l20.14"> );</span>
<a href="#l20.15"></a><span id="l20.15"> var { GenericAccountPrototype, GenericProtocolPrototype } = ChromeUtils.import(</span>
<a href="#l20.16"></a><span id="l20.16">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l20.17"></a><span id="l20.17"> );</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineat">@@ -45,12 +47,9 @@ FacebookProtocol.prototype = {</span>
<a href="#l20.21"></a><span id="l20.21">     return _(&quot;facebook.chat.name&quot;);</span>
<a href="#l20.22"></a><span id="l20.22">   },</span>
<a href="#l20.23"></a><span id="l20.23">   get iconBaseURI() {</span>
<a href="#l20.24"></a><span id="l20.24">     return &quot;chrome://prpl-facebook/skin/&quot;;</span>
<a href="#l20.25"></a><span id="l20.25">   },</span>
<a href="#l20.26"></a><span id="l20.26">   getAccount(aImAccount) {</span>
<a href="#l20.27"></a><span id="l20.27">     return new FacebookAccount(this, aImAccount);</span>
<a href="#l20.28"></a><span id="l20.28">   },</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-  classID: Components.ID(&quot;{1d1d0bc5-610c-472f-b2cb-4b89857d80dc}&quot;),</span>
<a href="#l20.30"></a><span id="l20.30"> };</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineminus">-</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([FacebookProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">new file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- /dev/null</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ b/chat/protocols/facebook/components.conf</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineplus">+Classes = [</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+  {</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+    'cid': '{1d1d0bc5-610c-472f-b2cb-4b89857d80dc}',</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/facebook;1'],</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+    'jsm': 'resource:///modules/Facebook.jsm',</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+    'constructor': 'FacebookProtocol',</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-facebook'},</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+  },</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1">deleted file mode 100644</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineminus">--- a/chat/protocols/facebook/facebook.manifest</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineplus">+++ /dev/null</span>
<a href="#l22.4"></a><span id="l22.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l22.5"></a><span id="l22.5" class="difflineminus">-component {1d1d0bc5-610c-472f-b2cb-4b89857d80dc} facebook.js</span>
<a href="#l22.6"></a><span id="l22.6" class="difflineminus">-contract @mozilla.org/chat/facebook;1 {1d1d0bc5-610c-472f-b2cb-4b89857d80dc}</span>
<a href="#l22.7"></a><span id="l22.7" class="difflineminus">-category im-protocol-plugin prpl-facebook @mozilla.org/chat/facebook;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/chat/protocols/facebook/moz.build</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/chat/protocols/facebook/moz.build</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,11 +1,14 @@</span>
<a href="#l23.4"></a><span id="l23.4"> # vim: set filetype=python:</span>
<a href="#l23.5"></a><span id="l23.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.6"></a><span id="l23.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.7"></a><span id="l23.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineminus">-    'facebook.js',</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineminus">-    'facebook.manifest',</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+    'Facebook.jsm',</span>
<a href="#l23.16"></a><span id="l23.16"> ]</span>
<a href="#l23.17"></a><span id="l23.17"> </span>
<a href="#l23.18"></a><span id="l23.18" class="difflineminus">-JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineplus">+    'components.conf',</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">rename from chat/protocols/gtalk/gtalk.js</span>
<a href="#l24.2"></a><span id="l24.2">rename to chat/protocols/gtalk/Gtalk.jsm</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineminus">--- a/chat/protocols/gtalk/gtalk.js</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineplus">+++ b/chat/protocols/gtalk/Gtalk.jsm</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l24.6"></a><span id="l24.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.7"></a><span id="l24.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.8"></a><span id="l24.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;GTalkProtocol&quot;];</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+</span>
<a href="#l24.12"></a><span id="l24.12"> var { XPCOMUtils, l10nHelper } = ChromeUtils.import(</span>
<a href="#l24.13"></a><span id="l24.13">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l24.14"></a><span id="l24.14"> );</span>
<a href="#l24.15"></a><span id="l24.15"> var { GenericProtocolPrototype } = ChromeUtils.import(</span>
<a href="#l24.16"></a><span id="l24.16">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l24.17"></a><span id="l24.17"> );</span>
<a href="#l24.18"></a><span id="l24.18"> var { XMPPAccountPrototype } = ChromeUtils.import(</span>
<a href="#l24.19"></a><span id="l24.19">   &quot;resource:///modules/xmpp.jsm&quot;</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineat">@@ -107,12 +109,9 @@ GTalkProtocol.prototype = {</span>
<a href="#l24.21"></a><span id="l24.21">         return _(&quot;options.resource&quot;);</span>
<a href="#l24.22"></a><span id="l24.22">       },</span>
<a href="#l24.23"></a><span id="l24.23">       default: &quot;&quot;,</span>
<a href="#l24.24"></a><span id="l24.24">     },</span>
<a href="#l24.25"></a><span id="l24.25">   },</span>
<a href="#l24.26"></a><span id="l24.26">   get chatHasTopic() {</span>
<a href="#l24.27"></a><span id="l24.27">     return true;</span>
<a href="#l24.28"></a><span id="l24.28">   },</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineminus">-  classID: Components.ID(&quot;{38a224c1-6748-49a9-8ab2-efc362b1000d}&quot;),</span>
<a href="#l24.30"></a><span id="l24.30"> };</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([GTalkProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">new file mode 100644</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineminus">--- /dev/null</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineplus">+++ b/chat/protocols/gtalk/components.conf</span>
<a href="#l25.4"></a><span id="l25.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l25.5"></a><span id="l25.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l25.6"></a><span id="l25.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l25.7"></a><span id="l25.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.8"></a><span id="l25.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineplus">+</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineplus">+Classes = [</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+  {</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+    'cid': '{38a224c1-6748-49a9-8ab2-efc362b1000d}',</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/gtalk;1'],</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+    'jsm': 'resource:///modules/Gtalk.jsm',</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+    'constructor': 'GTalkProtocol',</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-gtalk'},</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+  },</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">deleted file mode 100644</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineminus">--- a/chat/protocols/gtalk/gtalk.manifest</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineplus">+++ /dev/null</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l26.5"></a><span id="l26.5" class="difflineminus">-component {38a224c1-6748-49a9-8ab2-efc362b1000d} gtalk.js</span>
<a href="#l26.6"></a><span id="l26.6" class="difflineminus">-contract @mozilla.org/chat/gtalk;1 {38a224c1-6748-49a9-8ab2-efc362b1000d}</span>
<a href="#l26.7"></a><span id="l26.7" class="difflineminus">-category im-protocol-plugin prpl-gtalk @mozilla.org/chat/gtalk;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/chat/protocols/gtalk/moz.build</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/chat/protocols/gtalk/moz.build</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1,11 +1,14 @@</span>
<a href="#l27.4"></a><span id="l27.4"> # vim: set filetype=python:</span>
<a href="#l27.5"></a><span id="l27.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.6"></a><span id="l27.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.7"></a><span id="l27.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l27.8"></a><span id="l27.8"> </span>
<a href="#l27.9"></a><span id="l27.9" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l27.10"></a><span id="l27.10" class="difflineminus">-    'gtalk.js',</span>
<a href="#l27.11"></a><span id="l27.11" class="difflineminus">-    'gtalk.manifest',</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+    'Gtalk.jsm',</span>
<a href="#l27.16"></a><span id="l27.16"> ]</span>
<a href="#l27.17"></a><span id="l27.17"> </span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineplus">+    'components.conf',</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">rename from chat/protocols/irc/irc.js</span>
<a href="#l28.2"></a><span id="l28.2">rename to chat/protocols/irc/IRC.jsm</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineminus">--- a/chat/protocols/irc/irc.js</span>
<a href="#l28.4"></a><span id="l28.4" class="difflineplus">+++ b/chat/protocols/irc/IRC.jsm</span>
<a href="#l28.5"></a><span id="l28.5" class="difflineat">@@ -1,12 +1,23 @@</span>
<a href="#l28.6"></a><span id="l28.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.7"></a><span id="l28.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.8"></a><span id="l28.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l28.9"></a><span id="l28.9"> </span>
<a href="#l28.10"></a><span id="l28.10" class="difflineplus">+var EXPORTED_SYMBOLS = [</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineplus">+  &quot;IRCProtocol&quot;,</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+  &quot;IRCAccount&quot;,</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+  &quot;IRCConversation&quot;,</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+  &quot;IRCMessage&quot;,</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+  &quot;IRCChannel&quot;,</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineplus">+  &quot;clearTimeout&quot;,</span>
<a href="#l28.17"></a><span id="l28.17" class="difflineplus">+  &quot;setTimeout&quot;,</span>
<a href="#l28.18"></a><span id="l28.18" class="difflineplus">+  &quot;GenericIRCConversation&quot;,</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineplus">+];</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineplus">+</span>
<a href="#l28.21"></a><span id="l28.21"> var {</span>
<a href="#l28.22"></a><span id="l28.22">   ClassInfo,</span>
<a href="#l28.23"></a><span id="l28.23">   clearTimeout,</span>
<a href="#l28.24"></a><span id="l28.24">   EmptyEnumerator,</span>
<a href="#l28.25"></a><span id="l28.25">   setTimeout,</span>
<a href="#l28.26"></a><span id="l28.26">   executeSoon,</span>
<a href="#l28.27"></a><span id="l28.27">   l10nHelper,</span>
<a href="#l28.28"></a><span id="l28.28">   XPCOMUtils,</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineat">@@ -69,17 +80,17 @@ XPCOMUtils.defineLazyGetter(this, &quot;_conv</span>
<a href="#l28.30"></a><span id="l28.30">  * message is from a server or from a user, thus the usage of a generic &quot;origin&quot;</span>
<a href="#l28.31"></a><span id="l28.31">  * instead of &quot;nickname&quot; or &quot;servername&quot;.</span>
<a href="#l28.32"></a><span id="l28.32">  *</span>
<a href="#l28.33"></a><span id="l28.33">  * Inputs:</span>
<a href="#l28.34"></a><span id="l28.34">  *  aData       The raw string to parse, it should already have the \r\n</span>
<a href="#l28.35"></a><span id="l28.35">  *              stripped from the end.</span>
<a href="#l28.36"></a><span id="l28.36">  *  aOrigin     The default origin to use for unprefixed messages.</span>
<a href="#l28.37"></a><span id="l28.37">  */</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineminus">-function ircMessage(aData, aOrigin) {</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineplus">+function IRCMessage(aData, aOrigin) {</span>
<a href="#l28.40"></a><span id="l28.40">   let message = { rawMessage: aData };</span>
<a href="#l28.41"></a><span id="l28.41">   let temp;</span>
<a href="#l28.42"></a><span id="l28.42"> </span>
<a href="#l28.43"></a><span id="l28.43">   // Splits the raw string into five parts. The third part, the command, is</span>
<a href="#l28.44"></a><span id="l28.44">   // required. A raw string looks like:</span>
<a href="#l28.45"></a><span id="l28.45">   //   [&quot;@&quot; &lt;tags&gt; &quot; &quot;] [&quot;:&quot; &lt;prefix&gt; &quot; &quot;] &lt;command&gt; [&quot; &quot; &lt;parameter&gt;]* [&quot;:&quot; &lt;last parameter&gt;]</span>
<a href="#l28.46"></a><span id="l28.46">   //     &lt;tags&gt;: /[^ ]+/</span>
<a href="#l28.47"></a><span id="l28.47">   //     &lt;prefix&gt;: :(&lt;server name&gt; | &lt;nickname&gt; [[&quot;!&quot; &lt;user&gt;] &quot;@&quot; &lt;host&gt;])</span>
<a href="#l28.48"></a><span id="l28.48" class="difflineat">@@ -194,17 +205,17 @@ function _setMode(aAddNewMode, aNewModes</span>
<a href="#l28.49"></a><span id="l28.49"> }</span>
<a href="#l28.50"></a><span id="l28.50"> </span>
<a href="#l28.51"></a><span id="l28.51"> function TagMessage(aMessage, aTagName) {</span>
<a href="#l28.52"></a><span id="l28.52">   this.message = aMessage;</span>
<a href="#l28.53"></a><span id="l28.53">   this.tagName = aTagName;</span>
<a href="#l28.54"></a><span id="l28.54">   this.tagValue = aMessage.tags.get(aTagName);</span>
<a href="#l28.55"></a><span id="l28.55"> }</span>
<a href="#l28.56"></a><span id="l28.56"> </span>
<a href="#l28.57"></a><span id="l28.57" class="difflineminus">-// Properties / methods shared by both ircChannel and ircConversation.</span>
<a href="#l28.58"></a><span id="l28.58" class="difflineplus">+// Properties / methods shared by both IRCChannel and IRCConversation.</span>
<a href="#l28.59"></a><span id="l28.59"> var GenericIRCConversation = {</span>
<a href="#l28.60"></a><span id="l28.60">   _observedNicks: [],</span>
<a href="#l28.61"></a><span id="l28.61">   // This is set to true after a message is sent to notify the 401</span>
<a href="#l28.62"></a><span id="l28.62">   // ERR_NOSUCHNICK handler to write an error message to the conversation.</span>
<a href="#l28.63"></a><span id="l28.63">   _pendingMessage: false,</span>
<a href="#l28.64"></a><span id="l28.64">   _waitingForNick: false,</span>
<a href="#l28.65"></a><span id="l28.65"> </span>
<a href="#l28.66"></a><span id="l28.66">   normalizeNick(aNick) {</span>
<a href="#l28.67"></a><span id="l28.67" class="difflineat">@@ -225,17 +236,17 @@ var GenericIRCConversation = {</span>
<a href="#l28.68"></a><span id="l28.68">       &quot; :\r\n&quot;;</span>
<a href="#l28.69"></a><span id="l28.69">     return (</span>
<a href="#l28.70"></a><span id="l28.70">       this._account.maxMessageLength - this._account.countBytes(baseMessage)</span>
<a href="#l28.71"></a><span id="l28.71">     );</span>
<a href="#l28.72"></a><span id="l28.72">   },</span>
<a href="#l28.73"></a><span id="l28.73">   /**</span>
<a href="#l28.74"></a><span id="l28.74">    * @param {string} aWho - Message author's username.</span>
<a href="#l28.75"></a><span id="l28.75">    * @param {string} aMessage - Message text.</span>
<a href="#l28.76"></a><span id="l28.76" class="difflineminus">-   * @param {Object} aObject - Other properties to set on the imMessage.</span>
<a href="#l28.77"></a><span id="l28.77" class="difflineplus">+   * @param {Object} aObject - Other properties to set on the IMMessage.</span>
<a href="#l28.78"></a><span id="l28.78">    */</span>
<a href="#l28.79"></a><span id="l28.79">   handleTags(aWho, aMessage, aObject) {</span>
<a href="#l28.80"></a><span id="l28.80">     let messageProps = aObject;</span>
<a href="#l28.81"></a><span id="l28.81">     if (&quot;tags&quot; in aObject &amp;&amp; ircHandlers.hasTagHandlers) {</span>
<a href="#l28.82"></a><span id="l28.82">       // Merge extra info for the handler into the props.</span>
<a href="#l28.83"></a><span id="l28.83">       messageProps = Object.assign(</span>
<a href="#l28.84"></a><span id="l28.84">         {</span>
<a href="#l28.85"></a><span id="l28.85">           who: aWho,</span>
<a href="#l28.86"></a><span id="l28.86" class="difflineat">@@ -249,17 +260,17 @@ var GenericIRCConversation = {</span>
<a href="#l28.87"></a><span id="l28.87">       for (let tag of aObject.tags.keys()) {</span>
<a href="#l28.88"></a><span id="l28.88">         // Unhandled tags may be common, since a tag does not have to be handled</span>
<a href="#l28.89"></a><span id="l28.89">         // with a tag handler, it may also be handled by a message command handler.</span>
<a href="#l28.90"></a><span id="l28.90">         ircHandlers.handleTag(this._account, new TagMessage(messageProps, tag));</span>
<a href="#l28.91"></a><span id="l28.91">       }</span>
<a href="#l28.92"></a><span id="l28.92"> </span>
<a href="#l28.93"></a><span id="l28.93">       // Remove helper prop for tag handlers. We don't want to remove the other</span>
<a href="#l28.94"></a><span id="l28.94">       // ones, since they might have been changed and will override aWho and</span>
<a href="#l28.95"></a><span id="l28.95" class="difflineminus">-      // aMessage in the imMessage constructor.</span>
<a href="#l28.96"></a><span id="l28.96" class="difflineplus">+      // aMessage in the IMMessage constructor.</span>
<a href="#l28.97"></a><span id="l28.97">       delete messageProps.originalMessage;</span>
<a href="#l28.98"></a><span id="l28.98">     }</span>
<a href="#l28.99"></a><span id="l28.99">     // Remove the IRC tags, as those were passed in just for this step.</span>
<a href="#l28.100"></a><span id="l28.100">     delete messageProps.tags;</span>
<a href="#l28.101"></a><span id="l28.101">     return messageProps;</span>
<a href="#l28.102"></a><span id="l28.102">   },</span>
<a href="#l28.103"></a><span id="l28.103">   // Apply CTCP formatting before displaying.</span>
<a href="#l28.104"></a><span id="l28.104">   prepareForDisplaying(aMsg) {</span>
<a href="#l28.105"></a><span id="l28.105" class="difflineat">@@ -410,24 +421,24 @@ var GenericIRCConversation = {</span>
<a href="#l28.106"></a><span id="l28.106">   unInitIRCConversation() {</span>
<a href="#l28.107"></a><span id="l28.107">     this._account.removeConversation(this.name);</span>
<a href="#l28.108"></a><span id="l28.108">     if (this._observedNicks.length) {</span>
<a href="#l28.109"></a><span id="l28.109">       Services.obs.removeObserver(this, &quot;user-info-received&quot;);</span>
<a href="#l28.110"></a><span id="l28.110">     }</span>
<a href="#l28.111"></a><span id="l28.111">   },</span>
<a href="#l28.112"></a><span id="l28.112"> };</span>
<a href="#l28.113"></a><span id="l28.113"> </span>
<a href="#l28.114"></a><span id="l28.114" class="difflineminus">-function ircChannel(aAccount, aName, aNick) {</span>
<a href="#l28.115"></a><span id="l28.115" class="difflineplus">+function IRCChannel(aAccount, aName, aNick) {</span>
<a href="#l28.116"></a><span id="l28.116">   this._init(aAccount, aName, aNick);</span>
<a href="#l28.117"></a><span id="l28.117">   this._participants = new NormalizedMap(this.normalizeNick.bind(this));</span>
<a href="#l28.118"></a><span id="l28.118">   this._modes = new Set();</span>
<a href="#l28.119"></a><span id="l28.119">   this._observedNicks = [];</span>
<a href="#l28.120"></a><span id="l28.120">   this.banMasks = [];</span>
<a href="#l28.121"></a><span id="l28.121"> }</span>
<a href="#l28.122"></a><span id="l28.122" class="difflineminus">-ircChannel.prototype = {</span>
<a href="#l28.123"></a><span id="l28.123" class="difflineplus">+IRCChannel.prototype = {</span>
<a href="#l28.124"></a><span id="l28.124">   __proto__: GenericConvChatPrototype,</span>
<a href="#l28.125"></a><span id="l28.125">   _modes: null,</span>
<a href="#l28.126"></a><span id="l28.126">   _receivedInitialMode: false,</span>
<a href="#l28.127"></a><span id="l28.127">   // For IRC you're not in a channel until the JOIN command is received, open</span>
<a href="#l28.128"></a><span id="l28.128">   // all channels (initially) as left.</span>
<a href="#l28.129"></a><span id="l28.129">   _left: true,</span>
<a href="#l28.130"></a><span id="l28.130">   // True while we are rejoining a channel previously parted by the user.</span>
<a href="#l28.131"></a><span id="l28.131">   _rejoined: false,</span>
<a href="#l28.132"></a><span id="l28.132" class="difflineat">@@ -676,17 +687,17 @@ ircChannel.prototype = {</span>
<a href="#l28.133"></a><span id="l28.133">     // everyone can.</span>
<a href="#l28.134"></a><span id="l28.134">     return !this._modes.has(&quot;t&quot;) || participant.op || participant.halfOp;</span>
<a href="#l28.135"></a><span id="l28.135">   },</span>
<a href="#l28.136"></a><span id="l28.136">   writeMessage(aMsg, aWho, aObject) {</span>
<a href="#l28.137"></a><span id="l28.137">     const messageProps = this.handleTags(aMsg, aWho, aObject);</span>
<a href="#l28.138"></a><span id="l28.138">     GenericConvChatPrototype.writeMessage.call(this, aMsg, aWho, messageProps);</span>
<a href="#l28.139"></a><span id="l28.139">   },</span>
<a href="#l28.140"></a><span id="l28.140"> };</span>
<a href="#l28.141"></a><span id="l28.141" class="difflineminus">-Object.assign(ircChannel.prototype, GenericIRCConversation);</span>
<a href="#l28.142"></a><span id="l28.142" class="difflineplus">+Object.assign(IRCChannel.prototype, GenericIRCConversation);</span>
<a href="#l28.143"></a><span id="l28.143"> </span>
<a href="#l28.144"></a><span id="l28.144"> function ircParticipant(aName, aConv) {</span>
<a href="#l28.145"></a><span id="l28.145">   this._name = aName;</span>
<a href="#l28.146"></a><span id="l28.146">   this._conv = aConv;</span>
<a href="#l28.147"></a><span id="l28.147">   this._account = aConv._account;</span>
<a href="#l28.148"></a><span id="l28.148">   this._modes = new Set();</span>
<a href="#l28.149"></a><span id="l28.149"> </span>
<a href="#l28.150"></a><span id="l28.150">   // Handle multi-prefix modes.</span>
<a href="#l28.151"></a><span id="l28.151" class="difflineat">@@ -732,31 +743,31 @@ ircParticipant.prototype = {</span>
<a href="#l28.152"></a><span id="l28.152">   get founder() {</span>
<a href="#l28.153"></a><span id="l28.153">     return this._modes.has(&quot;O&quot;) || this._modes.has(&quot;q&quot;);</span>
<a href="#l28.154"></a><span id="l28.154">   },</span>
<a href="#l28.155"></a><span id="l28.155">   get typing() {</span>
<a href="#l28.156"></a><span id="l28.156">     return false;</span>
<a href="#l28.157"></a><span id="l28.157">   },</span>
<a href="#l28.158"></a><span id="l28.158"> };</span>
<a href="#l28.159"></a><span id="l28.159"> </span>
<a href="#l28.160"></a><span id="l28.160" class="difflineminus">-function ircConversation(aAccount, aName) {</span>
<a href="#l28.161"></a><span id="l28.161" class="difflineplus">+function IRCConversation(aAccount, aName) {</span>
<a href="#l28.162"></a><span id="l28.162">   let nick = aAccount.normalize(aName);</span>
<a href="#l28.163"></a><span id="l28.163">   if (aAccount.whoisInformation.has(nick)) {</span>
<a href="#l28.164"></a><span id="l28.164">     aName = aAccount.whoisInformation.get(nick).nick;</span>
<a href="#l28.165"></a><span id="l28.165">   }</span>
<a href="#l28.166"></a><span id="l28.166"> </span>
<a href="#l28.167"></a><span id="l28.167">   this._init(aAccount, aName);</span>
<a href="#l28.168"></a><span id="l28.168">   this._observedNicks = [];</span>
<a href="#l28.169"></a><span id="l28.169"> </span>
<a href="#l28.170"></a><span id="l28.170">   // Fetch correctly capitalized name.</span>
<a href="#l28.171"></a><span id="l28.171">   // Always request the info as it may be out of date.</span>
<a href="#l28.172"></a><span id="l28.172">   this._waitingForNick = true;</span>
<a href="#l28.173"></a><span id="l28.173">   this.requestCurrentWhois(aName);</span>
<a href="#l28.174"></a><span id="l28.174"> }</span>
<a href="#l28.175"></a><span id="l28.175" class="difflineminus">-ircConversation.prototype = {</span>
<a href="#l28.176"></a><span id="l28.176" class="difflineplus">+IRCConversation.prototype = {</span>
<a href="#l28.177"></a><span id="l28.177">   __proto__: GenericConvIMPrototype,</span>
<a href="#l28.178"></a><span id="l28.178">   get buddy() {</span>
<a href="#l28.179"></a><span id="l28.179">     return this._account.buddies.get(this.name);</span>
<a href="#l28.180"></a><span id="l28.180">   },</span>
<a href="#l28.181"></a><span id="l28.181"> </span>
<a href="#l28.182"></a><span id="l28.182">   unInit() {</span>
<a href="#l28.183"></a><span id="l28.183">     this.unInitIRCConversation();</span>
<a href="#l28.184"></a><span id="l28.184">     GenericConvIMPrototype.unInit.call(this);</span>
<a href="#l28.185"></a><span id="l28.185" class="difflineat">@@ -766,17 +777,17 @@ ircConversation.prototype = {</span>
<a href="#l28.186"></a><span id="l28.186">     this._name = aNewNick;</span>
<a href="#l28.187"></a><span id="l28.187">     this.notifyObservers(null, &quot;update-conv-title&quot;);</span>
<a href="#l28.188"></a><span id="l28.188">   },</span>
<a href="#l28.189"></a><span id="l28.189">   writeMessage(aMsg, aWho, aObject) {</span>
<a href="#l28.190"></a><span id="l28.190">     const messageProps = this.handleTags(aMsg, aWho, aObject);</span>
<a href="#l28.191"></a><span id="l28.191">     GenericConvIMPrototype.writeMessage.call(this, aMsg, aWho, messageProps);</span>
<a href="#l28.192"></a><span id="l28.192">   },</span>
<a href="#l28.193"></a><span id="l28.193"> };</span>
<a href="#l28.194"></a><span id="l28.194" class="difflineminus">-Object.assign(ircConversation.prototype, GenericIRCConversation);</span>
<a href="#l28.195"></a><span id="l28.195" class="difflineplus">+Object.assign(IRCConversation.prototype, GenericIRCConversation);</span>
<a href="#l28.196"></a><span id="l28.196"> </span>
<a href="#l28.197"></a><span id="l28.197"> function ircSocket(aAccount) {</span>
<a href="#l28.198"></a><span id="l28.198">   this._account = aAccount;</span>
<a href="#l28.199"></a><span id="l28.199">   this._initCharsetConverter();</span>
<a href="#l28.200"></a><span id="l28.200"> }</span>
<a href="#l28.201"></a><span id="l28.201"> ircSocket.prototype = {</span>
<a href="#l28.202"></a><span id="l28.202">   __proto__: Socket,</span>
<a href="#l28.203"></a><span id="l28.203">   // Although RFCs 1459 and 2812 explicitly say that \r\n is the message</span>
<a href="#l28.204"></a><span id="l28.204" class="difflineat">@@ -839,17 +850,17 @@ ircSocket.prototype = {</span>
<a href="#l28.205"></a><span id="l28.205">     const lowDequote = { &quot;0&quot;: &quot;\0&quot;, n: &quot;\n&quot;, r: &quot;\r&quot;, &quot;\x10&quot;: &quot;\x10&quot; };</span>
<a href="#l28.206"></a><span id="l28.206">     let dequotedMessage = aRawMessage.replace(</span>
<a href="#l28.207"></a><span id="l28.207">       // eslint-disable-next-line no-control-regex</span>
<a href="#l28.208"></a><span id="l28.208">       /\x10./g,</span>
<a href="#l28.209"></a><span id="l28.209">       aStr =&gt; lowDequote[aStr[1]] || aStr[1]</span>
<a href="#l28.210"></a><span id="l28.210">     );</span>
<a href="#l28.211"></a><span id="l28.211"> </span>
<a href="#l28.212"></a><span id="l28.212">     try {</span>
<a href="#l28.213"></a><span id="l28.213" class="difflineminus">-      let message = new ircMessage(</span>
<a href="#l28.214"></a><span id="l28.214" class="difflineplus">+      let message = new IRCMessage(</span>
<a href="#l28.215"></a><span id="l28.215">         dequotedMessage,</span>
<a href="#l28.216"></a><span id="l28.216">         this._account._currentServerName</span>
<a href="#l28.217"></a><span id="l28.217">       );</span>
<a href="#l28.218"></a><span id="l28.218">       this.DEBUG(JSON.stringify(message) + conversionWarning);</span>
<a href="#l28.219"></a><span id="l28.219">       if (!ircHandlers.handleMessage(this._account, message)) {</span>
<a href="#l28.220"></a><span id="l28.220">         // If the message was not handled, throw a warning containing</span>
<a href="#l28.221"></a><span id="l28.221">         // the original quoted message.</span>
<a href="#l28.222"></a><span id="l28.222">         this.WARN(&quot;Unhandled IRC message:\n&quot; + aRawMessage);</span>
<a href="#l28.223"></a><span id="l28.223" class="difflineat">@@ -928,20 +939,20 @@ ircSocket.prototype = {</span>
<a href="#l28.224"></a><span id="l28.224">   get WARN() {</span>
<a href="#l28.225"></a><span id="l28.225">     return this._account.WARN;</span>
<a href="#l28.226"></a><span id="l28.226">   },</span>
<a href="#l28.227"></a><span id="l28.227">   get ERROR() {</span>
<a href="#l28.228"></a><span id="l28.228">     return this._account.ERROR;</span>
<a href="#l28.229"></a><span id="l28.229">   },</span>
<a href="#l28.230"></a><span id="l28.230"> };</span>
<a href="#l28.231"></a><span id="l28.231"> </span>
<a href="#l28.232"></a><span id="l28.232" class="difflineminus">-function ircAccountBuddy(aAccount, aBuddy, aTag, aUserName) {</span>
<a href="#l28.233"></a><span id="l28.233" class="difflineplus">+function IRCAccountBuddy(aAccount, aBuddy, aTag, aUserName) {</span>
<a href="#l28.234"></a><span id="l28.234">   this._init(aAccount, aBuddy, aTag, aUserName);</span>
<a href="#l28.235"></a><span id="l28.235"> }</span>
<a href="#l28.236"></a><span id="l28.236" class="difflineminus">-ircAccountBuddy.prototype = {</span>
<a href="#l28.237"></a><span id="l28.237" class="difflineplus">+IRCAccountBuddy.prototype = {</span>
<a href="#l28.238"></a><span id="l28.238">   __proto__: GenericAccountBuddyPrototype,</span>
<a href="#l28.239"></a><span id="l28.239"> </span>
<a href="#l28.240"></a><span id="l28.240">   // Returns a list of imITooltipInfo objects to be displayed when the user</span>
<a href="#l28.241"></a><span id="l28.241">   // hovers over the buddy.</span>
<a href="#l28.242"></a><span id="l28.242">   getTooltipInfo() {</span>
<a href="#l28.243"></a><span id="l28.243">     return this._account.getBuddyInfo(this.normalizedName);</span>
<a href="#l28.244"></a><span id="l28.244">   },</span>
<a href="#l28.245"></a><span id="l28.245"> </span>
<a href="#l28.246"></a><span id="l28.246" class="difflineat">@@ -975,17 +986,17 @@ ircRoomInfo.prototype = {</span>
<a href="#l28.247"></a><span id="l28.247">   get participantCount() {</span>
<a href="#l28.248"></a><span id="l28.248">     return this._account._channelList.get(this.name).participantCount;</span>
<a href="#l28.249"></a><span id="l28.249">   },</span>
<a href="#l28.250"></a><span id="l28.250">   get chatRoomFieldValues() {</span>
<a href="#l28.251"></a><span id="l28.251">     return this._account.getChatRoomDefaultFieldValues(this.name);</span>
<a href="#l28.252"></a><span id="l28.252">   },</span>
<a href="#l28.253"></a><span id="l28.253"> };</span>
<a href="#l28.254"></a><span id="l28.254"> </span>
<a href="#l28.255"></a><span id="l28.255" class="difflineminus">-function ircAccount(aProtocol, aImAccount) {</span>
<a href="#l28.256"></a><span id="l28.256" class="difflineplus">+function IRCAccount(aProtocol, aImAccount) {</span>
<a href="#l28.257"></a><span id="l28.257">   this._init(aProtocol, aImAccount);</span>
<a href="#l28.258"></a><span id="l28.258">   this.buddies = new NormalizedMap(this.normalizeNick.bind(this));</span>
<a href="#l28.259"></a><span id="l28.259">   this.conversations = new NormalizedMap(this.normalize.bind(this));</span>
<a href="#l28.260"></a><span id="l28.260"> </span>
<a href="#l28.261"></a><span id="l28.261">   // Split the account name into usable parts.</span>
<a href="#l28.262"></a><span id="l28.262">   let splitter = this.name.lastIndexOf(&quot;@&quot;);</span>
<a href="#l28.263"></a><span id="l28.263">   this._accountNickname = this.name.slice(0, splitter);</span>
<a href="#l28.264"></a><span id="l28.264">   this._server = this.name.slice(splitter + 1);</span>
<a href="#l28.265"></a><span id="l28.265" class="difflineat">@@ -1003,17 +1014,17 @@ function ircAccount(aProtocol, aImAccoun</span>
<a href="#l28.266"></a><span id="l28.266">   this.whoisInformation = new NormalizedMap(this.normalizeNick.bind(this));</span>
<a href="#l28.267"></a><span id="l28.267">   this._requestedCAPs = new Set();</span>
<a href="#l28.268"></a><span id="l28.268">   this._availableCAPs = new Set();</span>
<a href="#l28.269"></a><span id="l28.269">   this._activeCAPs = new Set();</span>
<a href="#l28.270"></a><span id="l28.270">   this._queuedCAPs = [];</span>
<a href="#l28.271"></a><span id="l28.271">   this._commandBuffers = new Map();</span>
<a href="#l28.272"></a><span id="l28.272">   this._roomInfoCallbacks = new Set();</span>
<a href="#l28.273"></a><span id="l28.273"> }</span>
<a href="#l28.274"></a><span id="l28.274" class="difflineminus">-ircAccount.prototype = {</span>
<a href="#l28.275"></a><span id="l28.275" class="difflineplus">+IRCAccount.prototype = {</span>
<a href="#l28.276"></a><span id="l28.276">   __proto__: GenericAccountPrototype,</span>
<a href="#l28.277"></a><span id="l28.277">   _socket: null,</span>
<a href="#l28.278"></a><span id="l28.278">   _MODE_WALLOPS: 1 &lt;&lt; 2, // mode 'w'</span>
<a href="#l28.279"></a><span id="l28.279">   _MODE_INVISIBLE: 1 &lt;&lt; 3, // mode 'i'</span>
<a href="#l28.280"></a><span id="l28.280">   get _mode() {</span>
<a href="#l28.281"></a><span id="l28.281">     return 0;</span>
<a href="#l28.282"></a><span id="l28.282">   },</span>
<a href="#l28.283"></a><span id="l28.283"> </span>
<a href="#l28.284"></a><span id="l28.284" class="difflineat">@@ -1520,30 +1531,30 @@ ircAccount.prototype = {</span>
<a href="#l28.285"></a><span id="l28.285">       this.ERROR(</span>
<a href="#l28.286"></a><span id="l28.286">         &quot;Trying to untrack a nick that was not being tracked: &quot; + aNick</span>
<a href="#l28.287"></a><span id="l28.287">       );</span>
<a href="#l28.288"></a><span id="l28.288">       return;</span>
<a href="#l28.289"></a><span id="l28.289">     }</span>
<a href="#l28.290"></a><span id="l28.290">     this.trackQueue.splice(index, 1);</span>
<a href="#l28.291"></a><span id="l28.291">   },</span>
<a href="#l28.292"></a><span id="l28.292">   addBuddy(aTag, aName) {</span>
<a href="#l28.293"></a><span id="l28.293" class="difflineminus">-    let buddy = new ircAccountBuddy(this, null, aTag, aName);</span>
<a href="#l28.294"></a><span id="l28.294" class="difflineplus">+    let buddy = new IRCAccountBuddy(this, null, aTag, aName);</span>
<a href="#l28.295"></a><span id="l28.295">     this.buddies.set(buddy.normalizedName, buddy);</span>
<a href="#l28.296"></a><span id="l28.296">     this.trackBuddy(buddy.userName);</span>
<a href="#l28.297"></a><span id="l28.297"> </span>
<a href="#l28.298"></a><span id="l28.298">     Services.contacts.accountBuddyAdded(buddy);</span>
<a href="#l28.299"></a><span id="l28.299">   },</span>
<a href="#l28.300"></a><span id="l28.300">   removeBuddy(aBuddy) {</span>
<a href="#l28.301"></a><span id="l28.301">     this.buddies.delete(aBuddy.normalizedName);</span>
<a href="#l28.302"></a><span id="l28.302">     this.untrackBuddy(aBuddy.userName);</span>
<a href="#l28.303"></a><span id="l28.303">   },</span>
<a href="#l28.304"></a><span id="l28.304">   // Loads a buddy from the local storage. Called for each buddy locally stored</span>
<a href="#l28.305"></a><span id="l28.305">   // before connecting to the server.</span>
<a href="#l28.306"></a><span id="l28.306">   loadBuddy(aBuddy, aTag) {</span>
<a href="#l28.307"></a><span id="l28.307" class="difflineminus">-    let buddy = new ircAccountBuddy(this, aBuddy, aTag);</span>
<a href="#l28.308"></a><span id="l28.308" class="difflineplus">+    let buddy = new IRCAccountBuddy(this, aBuddy, aTag);</span>
<a href="#l28.309"></a><span id="l28.309">     this.buddies.set(buddy.normalizedName, buddy);</span>
<a href="#l28.310"></a><span id="l28.310">     this.trackBuddy(buddy.userName);</span>
<a href="#l28.311"></a><span id="l28.311"> </span>
<a href="#l28.312"></a><span id="l28.312">     return buddy;</span>
<a href="#l28.313"></a><span id="l28.313">   },</span>
<a href="#l28.314"></a><span id="l28.314">   changeBuddyNick(aOldNick, aNewNick) {</span>
<a href="#l28.315"></a><span id="l28.315">     if (this.normalizeNick(aOldNick) == this.normalizeNick(this._nickname)) {</span>
<a href="#l28.316"></a><span id="l28.316">       // Your nickname changed!</span>
<a href="#l28.317"></a><span id="l28.317" class="difflineat">@@ -1992,17 +2003,17 @@ ircAccount.prototype = {</span>
<a href="#l28.318"></a><span id="l28.318">   // Returns a conversation (creates it if it doesn't exist)</span>
<a href="#l28.319"></a><span id="l28.319">   getConversation(aName) {</span>
<a href="#l28.320"></a><span id="l28.320">     if (!this.conversations.has(aName)) {</span>
<a href="#l28.321"></a><span id="l28.321">       // If the whois information has been received, we have the proper nick</span>
<a href="#l28.322"></a><span id="l28.322">       // capitalization.</span>
<a href="#l28.323"></a><span id="l28.323">       if (this.whoisInformation.has(aName)) {</span>
<a href="#l28.324"></a><span id="l28.324">         aName = this.whoisInformation.get(aName).nick;</span>
<a href="#l28.325"></a><span id="l28.325">       }</span>
<a href="#l28.326"></a><span id="l28.326" class="difflineminus">-      let convClass = this.isMUCName(aName) ? ircChannel : ircConversation;</span>
<a href="#l28.327"></a><span id="l28.327" class="difflineplus">+      let convClass = this.isMUCName(aName) ? IRCChannel : IRCConversation;</span>
<a href="#l28.328"></a><span id="l28.328">       this.conversations.set(aName, new convClass(this, aName, this._nickname));</span>
<a href="#l28.329"></a><span id="l28.329">     }</span>
<a href="#l28.330"></a><span id="l28.330">     return this.conversations.get(aName);</span>
<a href="#l28.331"></a><span id="l28.331">   },</span>
<a href="#l28.332"></a><span id="l28.332"> </span>
<a href="#l28.333"></a><span id="l28.333">   removeConversation(aConversationName) {</span>
<a href="#l28.334"></a><span id="l28.334">     if (this.conversations.has(aConversationName)) {</span>
<a href="#l28.335"></a><span id="l28.335">       this.conversations.delete(aConversationName);</span>
<a href="#l28.336"></a><span id="l28.336" class="difflineat">@@ -2267,17 +2278,17 @@ ircAccount.prototype = {</span>
<a href="#l28.337"></a><span id="l28.337">       this._socket.disconnect();</span>
<a href="#l28.338"></a><span id="l28.338">     }</span>
<a href="#l28.339"></a><span id="l28.339">     delete this.imAccount;</span>
<a href="#l28.340"></a><span id="l28.340">     clearTimeout(this._isOnTimer);</span>
<a href="#l28.341"></a><span id="l28.341">     clearTimeout(this._quitTimer);</span>
<a href="#l28.342"></a><span id="l28.342">   },</span>
<a href="#l28.343"></a><span id="l28.343"> };</span>
<a href="#l28.344"></a><span id="l28.344"> </span>
<a href="#l28.345"></a><span id="l28.345" class="difflineminus">-function ircProtocol() {</span>
<a href="#l28.346"></a><span id="l28.346" class="difflineplus">+function IRCProtocol() {</span>
<a href="#l28.347"></a><span id="l28.347">   // ircCommands.jsm exports one variable: commands. Import this directly into</span>
<a href="#l28.348"></a><span id="l28.348">   // the protocol object.</span>
<a href="#l28.349"></a><span id="l28.349">   ChromeUtils.import(&quot;resource:///modules/ircCommands.jsm&quot;, this);</span>
<a href="#l28.350"></a><span id="l28.350">   this.registerCommands();</span>
<a href="#l28.351"></a><span id="l28.351"> </span>
<a href="#l28.352"></a><span id="l28.352">   // Register the standard handlers.</span>
<a href="#l28.353"></a><span id="l28.353">   let tempScope = {};</span>
<a href="#l28.354"></a><span id="l28.354">   ChromeUtils.import(&quot;resource:///modules/ircBase.jsm&quot;, tempScope);</span>
<a href="#l28.355"></a><span id="l28.355" class="difflineat">@@ -2318,17 +2329,17 @@ function ircProtocol() {</span>
<a href="#l28.356"></a><span id="l28.356">   ircHandlers.registerISUPPORTHandler(tempScope.isupportWATCH);</span>
<a href="#l28.357"></a><span id="l28.357">   ircHandlers.registerHandler(tempScope.ircMONITOR);</span>
<a href="#l28.358"></a><span id="l28.358">   ircHandlers.registerISUPPORTHandler(tempScope.isupportMONITOR);</span>
<a href="#l28.359"></a><span id="l28.359">   ircHandlers.registerHandler(tempScope.ircSASL);</span>
<a href="#l28.360"></a><span id="l28.360">   ircHandlers.registerCAPHandler(tempScope.capSASL);</span>
<a href="#l28.361"></a><span id="l28.361">   ircHandlers.registerCAPHandler(tempScope.capServerTime);</span>
<a href="#l28.362"></a><span id="l28.362">   ircHandlers.registerTagHandler(tempScope.tagServerTime);</span>
<a href="#l28.363"></a><span id="l28.363"> }</span>
<a href="#l28.364"></a><span id="l28.364" class="difflineminus">-ircProtocol.prototype = {</span>
<a href="#l28.365"></a><span id="l28.365" class="difflineplus">+IRCProtocol.prototype = {</span>
<a href="#l28.366"></a><span id="l28.366">   __proto__: GenericProtocolPrototype,</span>
<a href="#l28.367"></a><span id="l28.367">   get name() {</span>
<a href="#l28.368"></a><span id="l28.368">     return &quot;IRC&quot;;</span>
<a href="#l28.369"></a><span id="l28.369">   },</span>
<a href="#l28.370"></a><span id="l28.370">   get iconBaseURI() {</span>
<a href="#l28.371"></a><span id="l28.371">     return &quot;chrome://prpl-irc/skin/&quot;;</span>
<a href="#l28.372"></a><span id="l28.372">   },</span>
<a href="#l28.373"></a><span id="l28.373">   get usernameEmptyText() {</span>
<a href="#l28.374"></a><span id="l28.374" class="difflineat">@@ -2404,14 +2415,11 @@ ircProtocol.prototype = {</span>
<a href="#l28.375"></a><span id="l28.375">     return true;</span>
<a href="#l28.376"></a><span id="l28.376">   },</span>
<a href="#l28.377"></a><span id="l28.377">   //  Passwords in IRC are optional, and are needed for certain functionality.</span>
<a href="#l28.378"></a><span id="l28.378">   get passwordOptional() {</span>
<a href="#l28.379"></a><span id="l28.379">     return true;</span>
<a href="#l28.380"></a><span id="l28.380">   },</span>
<a href="#l28.381"></a><span id="l28.381"> </span>
<a href="#l28.382"></a><span id="l28.382">   getAccount(aImAccount) {</span>
<a href="#l28.383"></a><span id="l28.383" class="difflineminus">-    return new ircAccount(this, aImAccount);</span>
<a href="#l28.384"></a><span id="l28.384" class="difflineplus">+    return new IRCAccount(this, aImAccount);</span>
<a href="#l28.385"></a><span id="l28.385">   },</span>
<a href="#l28.386"></a><span id="l28.386" class="difflineminus">-  classID: Components.ID(&quot;{607b2c0b-9504-483f-ad62-41de09238aec}&quot;),</span>
<a href="#l28.387"></a><span id="l28.387"> };</span>
<a href="#l28.388"></a><span id="l28.388" class="difflineminus">-</span>
<a href="#l28.389"></a><span id="l28.389" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([ircProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">new file mode 100644</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineminus">--- /dev/null</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineplus">+++ b/chat/protocols/irc/components.conf</span>
<a href="#l29.4"></a><span id="l29.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l29.5"></a><span id="l29.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l29.6"></a><span id="l29.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l29.7"></a><span id="l29.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.8"></a><span id="l29.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineplus">+</span>
<a href="#l29.11"></a><span id="l29.11" class="difflineplus">+Classes = [</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineplus">+  {</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    'cid': '{607b2c0b-9504-483f-ad62-41de09238aec}',</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/irc;1'],</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+    'jsm': 'resource:///modules/IRC.jsm',</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineplus">+    'constructor': 'IRCProtocol',</span>
<a href="#l29.17"></a><span id="l29.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-irc'},</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineplus">+  },</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">deleted file mode 100644</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineminus">--- a/chat/protocols/irc/irc.manifest</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineplus">+++ /dev/null</span>
<a href="#l30.4"></a><span id="l30.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l30.5"></a><span id="l30.5" class="difflineminus">-component {607b2c0b-9504-483f-ad62-41de09238aec} irc.js</span>
<a href="#l30.6"></a><span id="l30.6" class="difflineminus">-contract @mozilla.org/chat/irc;1 {607b2c0b-9504-483f-ad62-41de09238aec}</span>
<a href="#l30.7"></a><span id="l30.7" class="difflineminus">-category im-protocol-plugin prpl-irc @mozilla.org/chat/irc;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/chat/protocols/irc/ircISUPPORT.jsm</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/chat/protocols/irc/ircISUPPORT.jsm</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -14,17 +14,17 @@</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5"> this.EXPORTED_SYMBOLS = [&quot;ircISUPPORT&quot;, &quot;isupportBase&quot;];</span>
<a href="#l31.6"></a><span id="l31.6"> </span>
<a href="#l31.7"></a><span id="l31.7"> const { ircHandlers } = ChromeUtils.import(</span>
<a href="#l31.8"></a><span id="l31.8">   &quot;resource:///modules/ircHandlers.jsm&quot;</span>
<a href="#l31.9"></a><span id="l31.9"> );</span>
<a href="#l31.10"></a><span id="l31.10"> </span>
<a href="#l31.11"></a><span id="l31.11"> /*</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">- * Parses an ircMessage into an ISUPPORT message for each token of the form:</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+ * Parses an IRCMessage into an ISUPPORT message for each token of the form:</span>
<a href="#l31.14"></a><span id="l31.14">  *   &lt;parameter&gt;=&lt;value&gt; or -&lt;value&gt;</span>
<a href="#l31.15"></a><span id="l31.15">  * The isupport field is added to the message and it has the following fields:</span>
<a href="#l31.16"></a><span id="l31.16">  *   parameter  What is being configured by this ISUPPORT token.</span>
<a href="#l31.17"></a><span id="l31.17">  *   useDefault Whether this parameter should be reset to the default value, as</span>
<a href="#l31.18"></a><span id="l31.18">  *              defined by the RFC.</span>
<a href="#l31.19"></a><span id="l31.19">  *   value      The new value for the parameter.</span>
<a href="#l31.20"></a><span id="l31.20">  */</span>
<a href="#l31.21"></a><span id="l31.21"> function isupportMessage(aMessage) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/chat/protocols/irc/moz.build</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/chat/protocols/irc/moz.build</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,21 +1,17 @@</span>
<a href="#l32.4"></a><span id="l32.4"> # vim: set filetype=python:</span>
<a href="#l32.5"></a><span id="l32.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.6"></a><span id="l32.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.7"></a><span id="l32.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l32.8"></a><span id="l32.8"> </span>
<a href="#l32.9"></a><span id="l32.9"> XPCSHELL_TESTS_MANIFESTS += ['test/xpcshell.ini']</span>
<a href="#l32.10"></a><span id="l32.10"> </span>
<a href="#l32.11"></a><span id="l32.11" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-    'irc.js',</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-    'irc.manifest',</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineminus">-]</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineminus">-</span>
<a href="#l32.16"></a><span id="l32.16"> EXTRA_JS_MODULES += [</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+    'IRC.jsm',</span>
<a href="#l32.18"></a><span id="l32.18">     'ircBase.jsm',</span>
<a href="#l32.19"></a><span id="l32.19">     'ircCAP.jsm',</span>
<a href="#l32.20"></a><span id="l32.20">     'ircCommands.jsm',</span>
<a href="#l32.21"></a><span id="l32.21">     'ircCTCP.jsm',</span>
<a href="#l32.22"></a><span id="l32.22">     'ircDCC.jsm',</span>
<a href="#l32.23"></a><span id="l32.23">     'ircHandlers.jsm',</span>
<a href="#l32.24"></a><span id="l32.24">     'ircISUPPORT.jsm',</span>
<a href="#l32.25"></a><span id="l32.25">     'ircMultiPrefix.jsm',</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineat">@@ -23,8 +19,12 @@ EXTRA_JS_MODULES += [</span>
<a href="#l32.27"></a><span id="l32.27">     'ircSASL.jsm',</span>
<a href="#l32.28"></a><span id="l32.28">     'ircServerTime.jsm',</span>
<a href="#l32.29"></a><span id="l32.29">     'ircServices.jsm',</span>
<a href="#l32.30"></a><span id="l32.30">     'ircUtils.jsm',</span>
<a href="#l32.31"></a><span id="l32.31">     'ircWatchMonitor.jsm',</span>
<a href="#l32.32"></a><span id="l32.32"> ]</span>
<a href="#l32.33"></a><span id="l32.33"> </span>
<a href="#l32.34"></a><span id="l32.34"> JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineplus">+</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineplus">+    'components.conf',</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ctcpQuote.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ctcpQuote.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l33.4"></a><span id="l33.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l33.5"></a><span id="l33.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l33.6"></a><span id="l33.6"> </span>
<a href="#l33.7"></a><span id="l33.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l33.8"></a><span id="l33.8" class="difflineminus">-var irc = {};</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineplus">+var { IRCAccount } = ChromeUtils.import(&quot;resource:///modules/IRC.jsm&quot;);</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12"> var input = [</span>
<a href="#l33.13"></a><span id="l33.13">   undefined,</span>
<a href="#l33.14"></a><span id="l33.14">   &quot;test&quot;,</span>
<a href="#l33.15"></a><span id="l33.15">   &quot;\\test&quot;,</span>
<a href="#l33.16"></a><span id="l33.16">   &quot;te\\st&quot;,</span>
<a href="#l33.17"></a><span id="l33.17">   &quot;test\\&quot;,</span>
<a href="#l33.18"></a><span id="l33.18">   &quot;\\\\test&quot;,</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineat">@@ -40,24 +39,24 @@ var expectedOutputParams = [</span>
<a href="#l33.20"></a><span id="l33.20">   &quot;ACTION te\\ast&quot;,</span>
<a href="#l33.21"></a><span id="l33.21">   &quot;ACTION test\\a&quot;,</span>
<a href="#l33.22"></a><span id="l33.22">   &quot;ACTION \\\\\\\\\\atest&quot;,</span>
<a href="#l33.23"></a><span id="l33.23">   &quot;ACTION \\\\\\\\atest&quot;,</span>
<a href="#l33.24"></a><span id="l33.24"> ];</span>
<a href="#l33.25"></a><span id="l33.25"> </span>
<a href="#l33.26"></a><span id="l33.26"> var outputParams = [];</span>
<a href="#l33.27"></a><span id="l33.27"> </span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-irc.ircAccount.prototype.sendMessage = function(aCommand, aParams) {</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineplus">+IRCAccount.prototype.sendMessage = function(aCommand, aParams) {</span>
<a href="#l33.30"></a><span id="l33.30">   equal(&quot;PRIVMSG&quot;, aCommand);</span>
<a href="#l33.31"></a><span id="l33.31">   outputParams.push(aParams[1]);</span>
<a href="#l33.32"></a><span id="l33.32"> };</span>
<a href="#l33.33"></a><span id="l33.33"> </span>
<a href="#l33.34"></a><span id="l33.34"> function run_test() {</span>
<a href="#l33.35"></a><span id="l33.35">   input.map(aStr =&gt;</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineminus">-    irc.ircAccount.prototype.sendCTCPMessage(&quot;&quot;, false, &quot;ACTION&quot;, aStr)</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineplus">+    IRCAccount.prototype.sendCTCPMessage(&quot;&quot;, false, &quot;ACTION&quot;, aStr)</span>
<a href="#l33.38"></a><span id="l33.38">   );</span>
<a href="#l33.39"></a><span id="l33.39"> </span>
<a href="#l33.40"></a><span id="l33.40">   // Ensure both arrays have the same length.</span>
<a href="#l33.41"></a><span id="l33.41">   equal(expectedOutputParams.length, outputParams.length);</span>
<a href="#l33.42"></a><span id="l33.42">   // Ensure the values in the arrays are equal.</span>
<a href="#l33.43"></a><span id="l33.43">   for (let i = 0; i &lt; outputParams.length; ++i) {</span>
<a href="#l33.44"></a><span id="l33.44">     equal(&quot;\x01&quot; + expectedOutputParams[i] + &quot;\x01&quot;, outputParams[i]);</span>
<a href="#l33.45"></a><span id="l33.45">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ircCAP.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ircCAP.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -177,25 +177,25 @@ function run_test() {</span>
<a href="#l34.4"></a><span id="l34.4">   run_next_test();</span>
<a href="#l34.5"></a><span id="l34.5"> }</span>
<a href="#l34.6"></a><span id="l34.6"> </span>
<a href="#l34.7"></a><span id="l34.7"> /*</span>
<a href="#l34.8"></a><span id="l34.8">  * Test round tripping parsing and then rebuilding the messages from RFC 2812.</span>
<a href="#l34.9"></a><span id="l34.9">  */</span>
<a href="#l34.10"></a><span id="l34.10"> function testCapMessages() {</span>
<a href="#l34.11"></a><span id="l34.11">   for (let data of testData) {</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-    // Generate an ircMessage to send into capMessage.</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+    // Generate an IRCMessage to send into capMessage.</span>
<a href="#l34.14"></a><span id="l34.14">     let i = 0;</span>
<a href="#l34.15"></a><span id="l34.15">     let message;</span>
<a href="#l34.16"></a><span id="l34.16">     let outputs;</span>
<a href="#l34.17"></a><span id="l34.17">     const account = {</span>
<a href="#l34.18"></a><span id="l34.18">       _queuedCAPs: [],</span>
<a href="#l34.19"></a><span id="l34.19">     };</span>
<a href="#l34.20"></a><span id="l34.20"> </span>
<a href="#l34.21"></a><span id="l34.21" class="difflineminus">-    // Generate an ircMessage to send into capMessage.</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineplus">+    // Generate an IRCMessage to send into capMessage.</span>
<a href="#l34.23"></a><span id="l34.23">     while (typeof data[i][0] == &quot;string&quot;) {</span>
<a href="#l34.24"></a><span id="l34.24">       message = {</span>
<a href="#l34.25"></a><span id="l34.25">         params: data[i],</span>
<a href="#l34.26"></a><span id="l34.26">       };</span>
<a href="#l34.27"></a><span id="l34.27"> </span>
<a href="#l34.28"></a><span id="l34.28">       // Create the CAP message.</span>
<a href="#l34.29"></a><span id="l34.29">       outputs = cap.capMessage(message, account);</span>
<a href="#l34.30"></a><span id="l34.30">       ++i;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ircCommands.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ircCommands.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l35.4"></a><span id="l35.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l35.5"></a><span id="l35.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l35.6"></a><span id="l35.6"> </span>
<a href="#l35.7"></a><span id="l35.7"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l35.8"></a><span id="l35.8"> var { commands } = ChromeUtils.import(&quot;resource:///modules/ircCommands.jsm&quot;);</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineminus">-</span>
<a href="#l35.10"></a><span id="l35.10" class="difflineminus">-var irc = {};</span>
<a href="#l35.11"></a><span id="l35.11" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineplus">+var { IRCAccount, IRCConversation } = ChromeUtils.import(</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+  &quot;resource:///modules/IRC.jsm&quot;</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+);</span>
<a href="#l35.15"></a><span id="l35.15"> </span>
<a href="#l35.16"></a><span id="l35.16"> // Ensure the commands have been initialized.</span>
<a href="#l35.17"></a><span id="l35.17"> Services.conversations.initConversations();</span>
<a href="#l35.18"></a><span id="l35.18"> </span>
<a href="#l35.19"></a><span id="l35.19"> var fakeProto = {</span>
<a href="#l35.20"></a><span id="l35.20">   id: &quot;fake-proto&quot;,</span>
<a href="#l35.21"></a><span id="l35.21"> };</span>
<a href="#l35.22"></a><span id="l35.22"> </span>
<a href="#l35.23"></a><span id="l35.23" class="difflineat">@@ -114,36 +114,36 @@ function testModeCommand() {</span>
<a href="#l35.24"></a><span id="l35.24">       expectedMessage: &quot;MODE matrixisreal_19 +oWp&quot;,</span>
<a href="#l35.25"></a><span id="l35.25">     },</span>
<a href="#l35.26"></a><span id="l35.26">     {</span>
<a href="#l35.27"></a><span id="l35.27">       msg: &quot;nick&quot;,</span>
<a href="#l35.28"></a><span id="l35.28">       expectedMessage: &quot;MODE nick&quot;,</span>
<a href="#l35.29"></a><span id="l35.29">     },</span>
<a href="#l35.30"></a><span id="l35.30">   ];</span>
<a href="#l35.31"></a><span id="l35.31"> </span>
<a href="#l35.32"></a><span id="l35.32" class="difflineminus">-  let account = new irc.ircAccount(fakeProto, {</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+  let account = new IRCAccount(fakeProto, {</span>
<a href="#l35.34"></a><span id="l35.34">     name: &quot;defaultnick@instantbird.org&quot;,</span>
<a href="#l35.35"></a><span id="l35.35">   });</span>
<a href="#l35.36"></a><span id="l35.36"> </span>
<a href="#l35.37"></a><span id="l35.37">   // check if the message being sent is same as expected message.</span>
<a href="#l35.38"></a><span id="l35.38">   account.sendRawMessage = aMessage =&gt; {</span>
<a href="#l35.39"></a><span id="l35.39">     equal(aMessage, account._expectedMessage);</span>
<a href="#l35.40"></a><span id="l35.40">   };</span>
<a href="#l35.41"></a><span id="l35.41"> </span>
<a href="#l35.42"></a><span id="l35.42">   const command = _getRunCommand(&quot;mode&quot;);</span>
<a href="#l35.43"></a><span id="l35.43"> </span>
<a href="#l35.44"></a><span id="l35.44">   // First test Channel Commands.</span>
<a href="#l35.45"></a><span id="l35.45">   for (let test of testChannelCommands) {</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineminus">-    let conv = new irc.ircConversation(account, test.channel);</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineplus">+    let conv = new IRCConversation(account, test.channel);</span>
<a href="#l35.48"></a><span id="l35.48">     account._expectedMessage = test.expectedMessage;</span>
<a href="#l35.49"></a><span id="l35.49">     command(test.msg, conv);</span>
<a href="#l35.50"></a><span id="l35.50">   }</span>
<a href="#l35.51"></a><span id="l35.51"> </span>
<a href="#l35.52"></a><span id="l35.52">   // Now test the User Commands.</span>
<a href="#l35.53"></a><span id="l35.53" class="difflineminus">-  let conv = new irc.ircConversation(account, &quot;dummyConversation&quot;);</span>
<a href="#l35.54"></a><span id="l35.54" class="difflineplus">+  let conv = new IRCConversation(account, &quot;dummyConversation&quot;);</span>
<a href="#l35.55"></a><span id="l35.55">   account._nickname = &quot;test_nick&quot;;</span>
<a href="#l35.56"></a><span id="l35.56">   for (let test of testUserCommands) {</span>
<a href="#l35.57"></a><span id="l35.57">     account._expectedMessage = test.expectedMessage;</span>
<a href="#l35.58"></a><span id="l35.58">     command(test.msg, conv);</span>
<a href="#l35.59"></a><span id="l35.59">   }</span>
<a href="#l35.60"></a><span id="l35.60"> </span>
<a href="#l35.61"></a><span id="l35.61">   run_next_test();</span>
<a href="#l35.62"></a><span id="l35.62"> }</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineat">@@ -168,21 +168,21 @@ function testUserModeCommand() {</span>
<a href="#l35.64"></a><span id="l35.64">       expectedMessage: &quot;MODE test_nick +oWp&quot;,</span>
<a href="#l35.65"></a><span id="l35.65">     },</span>
<a href="#l35.66"></a><span id="l35.66">     {</span>
<a href="#l35.67"></a><span id="l35.67">       msg: &quot;&quot;,</span>
<a href="#l35.68"></a><span id="l35.68">       expectedMessage: &quot;MODE test_nick&quot;,</span>
<a href="#l35.69"></a><span id="l35.69">     },</span>
<a href="#l35.70"></a><span id="l35.70">   ];</span>
<a href="#l35.71"></a><span id="l35.71"> </span>
<a href="#l35.72"></a><span id="l35.72" class="difflineminus">-  let account = new irc.ircAccount(fakeProto, {</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineplus">+  let account = new IRCAccount(fakeProto, {</span>
<a href="#l35.74"></a><span id="l35.74">     name: &quot;test_nick@instantbird.org&quot;,</span>
<a href="#l35.75"></a><span id="l35.75">   });</span>
<a href="#l35.76"></a><span id="l35.76">   account._nickname = &quot;test_nick&quot;;</span>
<a href="#l35.77"></a><span id="l35.77" class="difflineminus">-  let conv = new irc.ircConversation(account, &quot;newconv&quot;);</span>
<a href="#l35.78"></a><span id="l35.78" class="difflineplus">+  let conv = new IRCConversation(account, &quot;newconv&quot;);</span>
<a href="#l35.79"></a><span id="l35.79"> </span>
<a href="#l35.80"></a><span id="l35.80">   // check if the message being sent is same as expected message.</span>
<a href="#l35.81"></a><span id="l35.81">   account.sendRawMessage = aMessage =&gt; {</span>
<a href="#l35.82"></a><span id="l35.82">     equal(aMessage, account._expectedMessage);</span>
<a href="#l35.83"></a><span id="l35.83">   };</span>
<a href="#l35.84"></a><span id="l35.84"> </span>
<a href="#l35.85"></a><span id="l35.85">   const command = _getRunCommand(&quot;umode&quot;);</span>
<a href="#l35.86"></a><span id="l35.86"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ircMessage.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ircMessage.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,14 +1,15 @@</span>
<a href="#l36.4"></a><span id="l36.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l36.5"></a><span id="l36.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l36.6"></a><span id="l36.6"> </span>
<a href="#l36.7"></a><span id="l36.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l36.8"></a><span id="l36.8" class="difflineminus">-var irc = {};</span>
<a href="#l36.9"></a><span id="l36.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l36.10"></a><span id="l36.10" class="difflineplus">+var { IRCAccount, IRCMessage } = ChromeUtils.import(</span>
<a href="#l36.11"></a><span id="l36.11" class="difflineplus">+  &quot;resource:///modules/IRC.jsm&quot;</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineplus">+);</span>
<a href="#l36.13"></a><span id="l36.13"> </span>
<a href="#l36.14"></a><span id="l36.14"> var testData = [</span>
<a href="#l36.15"></a><span id="l36.15">   // First off, let's test the messages from RFC 2812.</span>
<a href="#l36.16"></a><span id="l36.16">   &quot;PASS secretpasswordhere&quot;,</span>
<a href="#l36.17"></a><span id="l36.17">   &quot;NICK Wiz&quot;,</span>
<a href="#l36.18"></a><span id="l36.18">   &quot;:WiZ!jto@tolsun.oulu.fi NICK Kilroy&quot;,</span>
<a href="#l36.19"></a><span id="l36.19">   &quot;USER guest 0 * :Ronnie Reagan&quot;,</span>
<a href="#l36.20"></a><span id="l36.20">   &quot;USER guest 8 * :Ronnie Reagan&quot;,</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineat">@@ -126,19 +127,19 @@ function run_test() {</span>
<a href="#l36.22"></a><span id="l36.22"> }</span>
<a href="#l36.23"></a><span id="l36.23"> </span>
<a href="#l36.24"></a><span id="l36.24"> /*</span>
<a href="#l36.25"></a><span id="l36.25">  * Test round tripping parsing and then rebuilding the messages from RFC 2812.</span>
<a href="#l36.26"></a><span id="l36.26">  */</span>
<a href="#l36.27"></a><span id="l36.27"> function testRFC2812Messages() {</span>
<a href="#l36.28"></a><span id="l36.28">   for (let expectedStringMessage of testData) {</span>
<a href="#l36.29"></a><span id="l36.29">     // Pass in an empty default origin in order to check this below.</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineminus">-    let message = irc.ircMessage(expectedStringMessage, &quot;&quot;);</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineplus">+    let message = IRCMessage(expectedStringMessage, &quot;&quot;);</span>
<a href="#l36.32"></a><span id="l36.32"> </span>
<a href="#l36.33"></a><span id="l36.33" class="difflineminus">-    let stringMessage = irc.ircAccount.prototype.buildMessage(</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineplus">+    let stringMessage = IRCAccount.prototype.buildMessage(</span>
<a href="#l36.35"></a><span id="l36.35">       message.command,</span>
<a href="#l36.36"></a><span id="l36.36">       message.params</span>
<a href="#l36.37"></a><span id="l36.37">     );</span>
<a href="#l36.38"></a><span id="l36.38"> </span>
<a href="#l36.39"></a><span id="l36.39">     // Let's do a little dance here...we don't rebuild the &quot;source&quot; of the</span>
<a href="#l36.40"></a><span id="l36.40">     // message (the server does that), so when comparing our output message, we</span>
<a href="#l36.41"></a><span id="l36.41">     // need to avoid comparing to that part.</span>
<a href="#l36.42"></a><span id="l36.42">     if (message.origin) {</span>
<a href="#l36.43"></a><span id="l36.43" class="difflineat">@@ -148,17 +149,17 @@ function testRFC2812Messages() {</span>
<a href="#l36.44"></a><span id="l36.44">     }</span>
<a href="#l36.45"></a><span id="l36.45"> </span>
<a href="#l36.46"></a><span id="l36.46">     equal(stringMessage, expectedStringMessage);</span>
<a href="#l36.47"></a><span id="l36.47">   }</span>
<a href="#l36.48"></a><span id="l36.48"> </span>
<a href="#l36.49"></a><span id="l36.49">   run_next_test();</span>
<a href="#l36.50"></a><span id="l36.50"> }</span>
<a href="#l36.51"></a><span id="l36.51"> </span>
<a href="#l36.52"></a><span id="l36.52" class="difflineminus">-// Unreal sends a couple of broken messages, see ircMessage in irc.js for a</span>
<a href="#l36.53"></a><span id="l36.53" class="difflineplus">+// Unreal sends a couple of broken messages, see IRCMessage in IRC.jsm for a</span>
<a href="#l36.54"></a><span id="l36.54"> // description of what's wrong.</span>
<a href="#l36.55"></a><span id="l36.55"> function testBrokenUnrealMessages() {</span>
<a href="#l36.56"></a><span id="l36.56">   let messages = {</span>
<a href="#l36.57"></a><span id="l36.57">     // Two spaces after command.</span>
<a href="#l36.58"></a><span id="l36.58">     &quot;:gravel.mozilla.org 432  #momo :Erroneous Nickname: Illegal characters&quot;: {</span>
<a href="#l36.59"></a><span id="l36.59">       rawMessage:</span>
<a href="#l36.60"></a><span id="l36.60">         &quot;:gravel.mozilla.org 432  #momo :Erroneous Nickname: Illegal characters&quot;,</span>
<a href="#l36.61"></a><span id="l36.61">       command: &quot;432&quot;,</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineat">@@ -189,17 +190,17 @@ function testBrokenUnrealMessages() {</span>
<a href="#l36.63"></a><span id="l36.63">       user: undefined,</span>
<a href="#l36.64"></a><span id="l36.64">       host: undefined,</span>
<a href="#l36.65"></a><span id="l36.65">       source: &quot;&quot;,</span>
<a href="#l36.66"></a><span id="l36.66">       tags: new Map(),</span>
<a href="#l36.67"></a><span id="l36.67">     },</span>
<a href="#l36.68"></a><span id="l36.68">   };</span>
<a href="#l36.69"></a><span id="l36.69"> </span>
<a href="#l36.70"></a><span id="l36.70">   for (let messageStr in messages) {</span>
<a href="#l36.71"></a><span id="l36.71" class="difflineminus">-    deepEqual(messages[messageStr], irc.ircMessage(messageStr, &quot;&quot;));</span>
<a href="#l36.72"></a><span id="l36.72" class="difflineplus">+    deepEqual(messages[messageStr], IRCMessage(messageStr, &quot;&quot;));</span>
<a href="#l36.73"></a><span id="l36.73">   }</span>
<a href="#l36.74"></a><span id="l36.74"> </span>
<a href="#l36.75"></a><span id="l36.75">   run_next_test();</span>
<a href="#l36.76"></a><span id="l36.76"> }</span>
<a href="#l36.77"></a><span id="l36.77"> </span>
<a href="#l36.78"></a><span id="l36.78"> // After unescaping we can end up with line breaks inside of IRC messages. Test</span>
<a href="#l36.79"></a><span id="l36.79"> // this edge case specifically.</span>
<a href="#l36.80"></a><span id="l36.80"> function testNewLinesInMessages() {</span>
<a href="#l36.81"></a><span id="l36.81" class="difflineat">@@ -224,17 +225,17 @@ function testNewLinesInMessages() {</span>
<a href="#l36.82"></a><span id="l36.82">       user: &quot;Instantbir&quot;,</span>
<a href="#l36.83"></a><span id="l36.83">       host: &quot;host&quot;,</span>
<a href="#l36.84"></a><span id="l36.84">       tags: new Map(),</span>
<a href="#l36.85"></a><span id="l36.85">       source: &quot;Instantbir@host&quot;,</span>
<a href="#l36.86"></a><span id="l36.86">     },</span>
<a href="#l36.87"></a><span id="l36.87">   };</span>
<a href="#l36.88"></a><span id="l36.88"> </span>
<a href="#l36.89"></a><span id="l36.89">   for (let messageStr in messages) {</span>
<a href="#l36.90"></a><span id="l36.90" class="difflineminus">-    deepEqual(messages[messageStr], irc.ircMessage(messageStr));</span>
<a href="#l36.91"></a><span id="l36.91" class="difflineplus">+    deepEqual(messages[messageStr], IRCMessage(messageStr));</span>
<a href="#l36.92"></a><span id="l36.92">   }</span>
<a href="#l36.93"></a><span id="l36.93"> </span>
<a href="#l36.94"></a><span id="l36.94">   run_next_test();</span>
<a href="#l36.95"></a><span id="l36.95"> }</span>
<a href="#l36.96"></a><span id="l36.96"> </span>
<a href="#l36.97"></a><span id="l36.97"> // Sometimes it is a bit hard to tell whether a prefix is a nickname or a</span>
<a href="#l36.98"></a><span id="l36.98"> // servername. Generally this happens when connecting to localhost or a local</span>
<a href="#l36.99"></a><span id="l36.99"> // hostname and is likely seen with bouncers.</span>
<a href="#l36.100"></a><span id="l36.100" class="difflineat">@@ -249,17 +250,17 @@ function testLocalhost() {</span>
<a href="#l36.101"></a><span id="l36.101">       user: undefined,</span>
<a href="#l36.102"></a><span id="l36.102">       host: undefined,</span>
<a href="#l36.103"></a><span id="l36.103">       tags: new Map(),</span>
<a href="#l36.104"></a><span id="l36.104">       source: &quot;&quot;,</span>
<a href="#l36.105"></a><span id="l36.105">     },</span>
<a href="#l36.106"></a><span id="l36.106">   };</span>
<a href="#l36.107"></a><span id="l36.107"> </span>
<a href="#l36.108"></a><span id="l36.108">   for (let messageStr in messages) {</span>
<a href="#l36.109"></a><span id="l36.109" class="difflineminus">-    deepEqual(messages[messageStr], irc.ircMessage(messageStr));</span>
<a href="#l36.110"></a><span id="l36.110" class="difflineplus">+    deepEqual(messages[messageStr], IRCMessage(messageStr));</span>
<a href="#l36.111"></a><span id="l36.111">   }</span>
<a href="#l36.112"></a><span id="l36.112"> </span>
<a href="#l36.113"></a><span id="l36.113">   run_next_test();</span>
<a href="#l36.114"></a><span id="l36.114"> }</span>
<a href="#l36.115"></a><span id="l36.115"> </span>
<a href="#l36.116"></a><span id="l36.116"> function testTags() {</span>
<a href="#l36.117"></a><span id="l36.117">   let messages = {</span>
<a href="#l36.118"></a><span id="l36.118">     &quot;@aaa=bBb;ccc;example.com/ddd=eee :nick!ident@host.com PRIVMSG me :Hello&quot;: {</span>
<a href="#l36.119"></a><span id="l36.119" class="difflineat">@@ -320,13 +321,13 @@ function testTags() {</span>
<a href="#l36.120"></a><span id="l36.120">       user: &quot;~john&quot;,</span>
<a href="#l36.121"></a><span id="l36.121">       host: &quot;1.2.3.4&quot;,</span>
<a href="#l36.122"></a><span id="l36.122">       tags: new Map([[&quot;time&quot;, &quot;2012-06-30T23:59:60.419Z&quot;]]),</span>
<a href="#l36.123"></a><span id="l36.123">       source: &quot;~john@1.2.3.4&quot;,</span>
<a href="#l36.124"></a><span id="l36.124">     },</span>
<a href="#l36.125"></a><span id="l36.125">   };</span>
<a href="#l36.126"></a><span id="l36.126"> </span>
<a href="#l36.127"></a><span id="l36.127">   for (let messageStr in messages) {</span>
<a href="#l36.128"></a><span id="l36.128" class="difflineminus">-    deepEqual(messages[messageStr], irc.ircMessage(messageStr, &quot;&quot;));</span>
<a href="#l36.129"></a><span id="l36.129" class="difflineplus">+    deepEqual(messages[messageStr], IRCMessage(messageStr, &quot;&quot;));</span>
<a href="#l36.130"></a><span id="l36.130">   }</span>
<a href="#l36.131"></a><span id="l36.131"> </span>
<a href="#l36.132"></a><span id="l36.132">   run_next_test();</span>
<a href="#l36.133"></a><span id="l36.133"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ircNonStandard.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ircNonStandard.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l37.4"></a><span id="l37.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l37.5"></a><span id="l37.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l37.6"></a><span id="l37.6"> </span>
<a href="#l37.7"></a><span id="l37.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l37.8"></a><span id="l37.8" class="difflineminus">-var irc = {};</span>
<a href="#l37.9"></a><span id="l37.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l37.10"></a><span id="l37.10" class="difflineplus">+var { IRCMessage } = ChromeUtils.import(&quot;resource:///modules/IRC.jsm&quot;);</span>
<a href="#l37.11"></a><span id="l37.11"> const { ircNonStandard } = ChromeUtils.import(</span>
<a href="#l37.12"></a><span id="l37.12">   &quot;resource:///modules/ircNonStandard.jsm&quot;</span>
<a href="#l37.13"></a><span id="l37.13"> );</span>
<a href="#l37.14"></a><span id="l37.14"> </span>
<a href="#l37.15"></a><span id="l37.15"> // The function that is under test here.</span>
<a href="#l37.16"></a><span id="l37.16"> var NOTICE = ircNonStandard.commands.NOTICE;</span>
<a href="#l37.17"></a><span id="l37.17"> </span>
<a href="#l37.18"></a><span id="l37.18"> function FakeConversation() {}</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineat">@@ -52,17 +51,17 @@ function run_test() {</span>
<a href="#l37.20"></a><span id="l37.20"> /*</span>
<a href="#l37.21"></a><span id="l37.21">  * Test that SECURELIST properly sets the timer such that another LIST call can</span>
<a href="#l37.22"></a><span id="l37.22">  * happen soon. See bug 1082501.</span>
<a href="#l37.23"></a><span id="l37.23">  */</span>
<a href="#l37.24"></a><span id="l37.24"> function testSecureList() {</span>
<a href="#l37.25"></a><span id="l37.25">   const kSecureListMsg =</span>
<a href="#l37.26"></a><span id="l37.26">     &quot;:fripp.mozilla.org NOTICE aleth-build :*** You cannot list within the first 60 seconds of connecting. Please try again later.&quot;;</span>
<a href="#l37.27"></a><span id="l37.27"> </span>
<a href="#l37.28"></a><span id="l37.28" class="difflineminus">-  let message = irc.ircMessage(kSecureListMsg, &quot;&quot;);</span>
<a href="#l37.29"></a><span id="l37.29" class="difflineplus">+  let message = IRCMessage(kSecureListMsg, &quot;&quot;);</span>
<a href="#l37.30"></a><span id="l37.30">   let account = new FakeAccount();</span>
<a href="#l37.31"></a><span id="l37.31">   account.connected = true;</span>
<a href="#l37.32"></a><span id="l37.32">   let result = NOTICE.call(account, message);</span>
<a href="#l37.33"></a><span id="l37.33"> </span>
<a href="#l37.34"></a><span id="l37.34">   // Yes, it was handled.</span>
<a href="#l37.35"></a><span id="l37.35">   ok(result);</span>
<a href="#l37.36"></a><span id="l37.36"> </span>
<a href="#l37.37"></a><span id="l37.37">   // Undo the expected calculation, this should be near 0.</span>
<a href="#l37.38"></a><span id="l37.38" class="difflineat">@@ -79,17 +78,17 @@ function testSecureList() {</span>
<a href="#l37.39"></a><span id="l37.39">  */</span>
<a href="#l37.40"></a><span id="l37.40"> function testZncAuth() {</span>
<a href="#l37.41"></a><span id="l37.41">   const kZncMsgs = [</span>
<a href="#l37.42"></a><span id="l37.42">     &quot;:irc.znc.in NOTICE AUTH :*** You need to send your password. Try /quote PASS &lt;username&gt;:&lt;password&gt;&quot;,</span>
<a href="#l37.43"></a><span id="l37.43">     &quot;:irc.znc.in NOTICE AUTH :*** You need to send your password. Configure your client to send a server password.&quot;,</span>
<a href="#l37.44"></a><span id="l37.44">   ];</span>
<a href="#l37.45"></a><span id="l37.45"> </span>
<a href="#l37.46"></a><span id="l37.46">   for (let msg of kZncMsgs) {</span>
<a href="#l37.47"></a><span id="l37.47" class="difflineminus">-    let message = irc.ircMessage(msg, &quot;&quot;);</span>
<a href="#l37.48"></a><span id="l37.48" class="difflineplus">+    let message = IRCMessage(msg, &quot;&quot;);</span>
<a href="#l37.49"></a><span id="l37.49">     // No provided password.</span>
<a href="#l37.50"></a><span id="l37.50">     let account = new FakeAccount();</span>
<a href="#l37.51"></a><span id="l37.51">     let result = NOTICE.call(account, message);</span>
<a href="#l37.52"></a><span id="l37.52"> </span>
<a href="#l37.53"></a><span id="l37.53">     // Yes, it was handled.</span>
<a href="#l37.54"></a><span id="l37.54">     Assert.ok(result);</span>
<a href="#l37.55"></a><span id="l37.55"> </span>
<a href="#l37.56"></a><span id="l37.56">     // No sent data and parameters should be unchanged.</span>
<a href="#l37.57"></a><span id="l37.57" class="difflineat">@@ -138,27 +137,27 @@ function testUMich() {</span>
<a href="#l37.58"></a><span id="l37.58">     &quot;NOTICE AUTH :*** No Ident response&quot;,</span>
<a href="#l37.59"></a><span id="l37.59">   ];</span>
<a href="#l37.60"></a><span id="l37.60"> </span>
<a href="#l37.61"></a><span id="l37.61">   const kFinalMsg =</span>
<a href="#l37.62"></a><span id="l37.62">     ':irc.umich.edu NOTICE clokep :To complete your connection to this server, type &quot;/QUOTE PONG :cookie&quot;, where cookie is the following ascii.';</span>
<a href="#l37.63"></a><span id="l37.63"> </span>
<a href="#l37.64"></a><span id="l37.64">   let account = new FakeAccount();</span>
<a href="#l37.65"></a><span id="l37.65">   for (let msg of kMsgs) {</span>
<a href="#l37.66"></a><span id="l37.66" class="difflineminus">-    let message = irc.ircMessage(msg, &quot;&quot;);</span>
<a href="#l37.67"></a><span id="l37.67" class="difflineplus">+    let message = IRCMessage(msg, &quot;&quot;);</span>
<a href="#l37.68"></a><span id="l37.68">     let result = NOTICE.call(account, message);</span>
<a href="#l37.69"></a><span id="l37.69"> </span>
<a href="#l37.70"></a><span id="l37.70">     // These initial notices are not handled (i.e. they'll be subject to</span>
<a href="#l37.71"></a><span id="l37.71">     // _showServerTab).</span>
<a href="#l37.72"></a><span id="l37.72">     equal(result, false);</span>
<a href="#l37.73"></a><span id="l37.73">   }</span>
<a href="#l37.74"></a><span id="l37.74"> </span>
<a href="#l37.75"></a><span id="l37.75">   // And finally the last one should be printed out, always. It contains the</span>
<a href="#l37.76"></a><span id="l37.76">   // directions of what to do next.</span>
<a href="#l37.77"></a><span id="l37.77" class="difflineminus">-  let message = irc.ircMessage(kFinalMsg, &quot;&quot;);</span>
<a href="#l37.78"></a><span id="l37.78" class="difflineplus">+  let message = IRCMessage(kFinalMsg, &quot;&quot;);</span>
<a href="#l37.79"></a><span id="l37.79">   let result = NOTICE.call(account, message);</span>
<a href="#l37.80"></a><span id="l37.80">   ok(result);</span>
<a href="#l37.81"></a><span id="l37.81">   equal(account.convs.length, 1);</span>
<a href="#l37.82"></a><span id="l37.82">   equal(account.convs[0], &quot;irc.umich.edu&quot;);</span>
<a href="#l37.83"></a><span id="l37.83"> </span>
<a href="#l37.84"></a><span id="l37.84">   run_next_test();</span>
<a href="#l37.85"></a><span id="l37.85"> }</span>
<a href="#l37.86"></a><span id="l37.86"> </span>
<a href="#l37.87"></a><span id="l37.87" class="difflineat">@@ -167,17 +166,17 @@ function testUMich() {</span>
<a href="#l37.88"></a><span id="l37.88">  */</span>
<a href="#l37.89"></a><span id="l37.89"> function testAuthNick() {</span>
<a href="#l37.90"></a><span id="l37.90">   const kMsg =</span>
<a href="#l37.91"></a><span id="l37.91">     ':irc.umich.edu NOTICE AUTH :To complete your connection to this server, type &quot;/QUOTE PONG :cookie&quot;, where cookie is the following ascii.';</span>
<a href="#l37.92"></a><span id="l37.92"> </span>
<a href="#l37.93"></a><span id="l37.93">   let account = new FakeAccount();</span>
<a href="#l37.94"></a><span id="l37.94">   account._nickname = &quot;AUTH&quot;;</span>
<a href="#l37.95"></a><span id="l37.95"> </span>
<a href="#l37.96"></a><span id="l37.96" class="difflineminus">-  let message = irc.ircMessage(kMsg, &quot;&quot;);</span>
<a href="#l37.97"></a><span id="l37.97" class="difflineplus">+  let message = IRCMessage(kMsg, &quot;&quot;);</span>
<a href="#l37.98"></a><span id="l37.98">   let result = NOTICE.call(account, message);</span>
<a href="#l37.99"></a><span id="l37.99"> </span>
<a href="#l37.100"></a><span id="l37.100">   // Since it is ambiguous if it was an authentication message or a message</span>
<a href="#l37.101"></a><span id="l37.101">   // directed at the user, print it out.</span>
<a href="#l37.102"></a><span id="l37.102">   ok(result);</span>
<a href="#l37.103"></a><span id="l37.103"> </span>
<a href="#l37.104"></a><span id="l37.104">   run_next_test();</span>
<a href="#l37.105"></a><span id="l37.105"> }</span>
<a href="#l37.106"></a><span id="l37.106" class="difflineat">@@ -193,17 +192,17 @@ function testIgnoredNotices() {</span>
<a href="#l37.107"></a><span id="l37.107">     // Some servers (oftc) send a NOTICE that isn't an auth, but notifies about</span>
<a href="#l37.108"></a><span id="l37.108">     // the connection. See bug 1182735.</span>
<a href="#l37.109"></a><span id="l37.109">     &quot;:beauty.oftc.net NOTICE myusername :*** Connected securely via UNKNOWN AES128-SHA-128&quot;,</span>
<a href="#l37.110"></a><span id="l37.110">   ];</span>
<a href="#l37.111"></a><span id="l37.111"> </span>
<a href="#l37.112"></a><span id="l37.112">   for (let msg of kMsgs) {</span>
<a href="#l37.113"></a><span id="l37.113">     let account = new FakeAccount();</span>
<a href="#l37.114"></a><span id="l37.114"> </span>
<a href="#l37.115"></a><span id="l37.115" class="difflineminus">-    let message = irc.ircMessage(msg, &quot;&quot;);</span>
<a href="#l37.116"></a><span id="l37.116" class="difflineplus">+    let message = IRCMessage(msg, &quot;&quot;);</span>
<a href="#l37.117"></a><span id="l37.117">     let result = NOTICE.call(account, message);</span>
<a href="#l37.118"></a><span id="l37.118"> </span>
<a href="#l37.119"></a><span id="l37.119">     // This message should *NOT* be shown.</span>
<a href="#l37.120"></a><span id="l37.120">     equal(result, false);</span>
<a href="#l37.121"></a><span id="l37.121">   }</span>
<a href="#l37.122"></a><span id="l37.122"> </span>
<a href="#l37.123"></a><span id="l37.123">   run_next_test();</span>
<a href="#l37.124"></a><span id="l37.124"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/chat/protocols/irc/test/test_ircServerTime.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_ircServerTime.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -1,21 +1,20 @@</span>
<a href="#l38.4"></a><span id="l38.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l38.5"></a><span id="l38.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l38.6"></a><span id="l38.6"> </span>
<a href="#l38.7"></a><span id="l38.7"> var { tagServerTime } = ChromeUtils.import(</span>
<a href="#l38.8"></a><span id="l38.8">   &quot;resource:///modules/ircServerTime.jsm&quot;</span>
<a href="#l38.9"></a><span id="l38.9"> );</span>
<a href="#l38.10"></a><span id="l38.10"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l38.11"></a><span id="l38.11"> </span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-var irc = {};</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+var { IRCMessage } = ChromeUtils.import(&quot;resource:///modules/IRC.jsm&quot;);</span>
<a href="#l38.15"></a><span id="l38.15"> </span>
<a href="#l38.16"></a><span id="l38.16"> function getTags(aRawMsg) {</span>
<a href="#l38.17"></a><span id="l38.17" class="difflineminus">-  const { tags } = irc.ircMessage(aRawMsg, &quot;doesnt@matter&quot;);</span>
<a href="#l38.18"></a><span id="l38.18" class="difflineplus">+  const { tags } = IRCMessage(aRawMsg, &quot;doesnt@matter&quot;);</span>
<a href="#l38.19"></a><span id="l38.19"> </span>
<a href="#l38.20"></a><span id="l38.20">   return tags;</span>
<a href="#l38.21"></a><span id="l38.21"> }</span>
<a href="#l38.22"></a><span id="l38.22"> </span>
<a href="#l38.23"></a><span id="l38.23"> function run_test() {</span>
<a href="#l38.24"></a><span id="l38.24">   add_test(specMessages);</span>
<a href="#l38.25"></a><span id="l38.25"> </span>
<a href="#l38.26"></a><span id="l38.26">   run_next_test();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/chat/protocols/irc/test/test_sendBufferedCommand.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_sendBufferedCommand.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -1,22 +1,23 @@</span>
<a href="#l39.4"></a><span id="l39.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l39.5"></a><span id="l39.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l39.6"></a><span id="l39.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l39.7"></a><span id="l39.7"> </span>
<a href="#l39.8"></a><span id="l39.8"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l39.9"></a><span id="l39.9" class="difflineminus">-var irc = {};</span>
<a href="#l39.10"></a><span id="l39.10" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l39.11"></a><span id="l39.11" class="difflineplus">+var { setTimeout, IRCAccount, clearTimeout } = ChromeUtils.import(</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineplus">+  &quot;resource:///modules/IRC.jsm&quot;</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+);</span>
<a href="#l39.14"></a><span id="l39.14"> </span>
<a href="#l39.15"></a><span id="l39.15"> function FakeAccount() {</span>
<a href="#l39.16"></a><span id="l39.16">   this._commandBuffers = new Map();</span>
<a href="#l39.17"></a><span id="l39.17">   this.callbacks = [];</span>
<a href="#l39.18"></a><span id="l39.18"> }</span>
<a href="#l39.19"></a><span id="l39.19"> FakeAccount.prototype = {</span>
<a href="#l39.20"></a><span id="l39.20" class="difflineminus">-  __proto__: irc.ircAccount.prototype,</span>
<a href="#l39.21"></a><span id="l39.21" class="difflineplus">+  __proto__: IRCAccount.prototype,</span>
<a href="#l39.22"></a><span id="l39.22">   maxMessageLength: 60,</span>
<a href="#l39.23"></a><span id="l39.23">   callbacks: [],</span>
<a href="#l39.24"></a><span id="l39.24">   sendMessage(aCommand, aParams) {</span>
<a href="#l39.25"></a><span id="l39.25">     this.callbacks.shift()(aCommand, aParams);</span>
<a href="#l39.26"></a><span id="l39.26">   },</span>
<a href="#l39.27"></a><span id="l39.27"> };</span>
<a href="#l39.28"></a><span id="l39.28"> </span>
<a href="#l39.29"></a><span id="l39.29"> var account = new FakeAccount();</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineat">@@ -60,25 +61,26 @@ function test_parameterCollect() {</span>
<a href="#l39.31"></a><span id="l39.31">   for (let test of tests) {</span>
<a href="#l39.32"></a><span id="l39.32">     let timeout;</span>
<a href="#l39.33"></a><span id="l39.33">     // Destructure test to local variables so each function</span>
<a href="#l39.34"></a><span id="l39.34">     // generated here gets the correct value in its scope.</span>
<a href="#l39.35"></a><span id="l39.35">     let { data, result } = test;</span>
<a href="#l39.36"></a><span id="l39.36">     account.callbacks.push((aCommand, aParams) =&gt; {</span>
<a href="#l39.37"></a><span id="l39.37">       let msg = account.buildMessage(aCommand, aParams);</span>
<a href="#l39.38"></a><span id="l39.38">       equal(msg, result, &quot;Test buffering of parameters&quot;);</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineminus">-      irc.clearTimeout(timeout);</span>
<a href="#l39.40"></a><span id="l39.40" class="difflineplus">+      clearTimeout(timeout);</span>
<a href="#l39.41"></a><span id="l39.41">       account._lastCommandSendTime = 0;</span>
<a href="#l39.42"></a><span id="l39.42">       run_next_test();</span>
<a href="#l39.43"></a><span id="l39.43">     });</span>
<a href="#l39.44"></a><span id="l39.44">     add_test(() =&gt; {</span>
<a href="#l39.45"></a><span id="l39.45">       // This timeout lets the test fail more quickly if</span>
<a href="#l39.46"></a><span id="l39.46">       // some of the callbacks we added don't get called.</span>
<a href="#l39.47"></a><span id="l39.47">       // Not strictly speaking necessary.</span>
<a href="#l39.48"></a><span id="l39.48" class="difflineminus">-      timeout = irc.setTimeout(() =&gt; {</span>
<a href="#l39.49"></a><span id="l39.49" class="difflineplus">+      // eslint-disable-next-line mozilla/no-arbitrary-setTimeout</span>
<a href="#l39.50"></a><span id="l39.50" class="difflineplus">+      timeout = setTimeout(() =&gt; {</span>
<a href="#l39.51"></a><span id="l39.51">         ok(false, &quot;test_parameterCollect failed after timeout.&quot;);</span>
<a href="#l39.52"></a><span id="l39.52">         run_next_test();</span>
<a href="#l39.53"></a><span id="l39.53">       }, 2000);</span>
<a href="#l39.54"></a><span id="l39.54">       for (let [channel, key] of data) {</span>
<a href="#l39.55"></a><span id="l39.55">         account.sendBufferedCommand(&quot;JOIN&quot;, channel, key);</span>
<a href="#l39.56"></a><span id="l39.56">       }</span>
<a href="#l39.57"></a><span id="l39.57">     });</span>
<a href="#l39.58"></a><span id="l39.58">   }</span>
<a href="#l39.59"></a><span id="l39.59" class="difflineat">@@ -87,32 +89,34 @@ function test_parameterCollect() {</span>
<a href="#l39.60"></a><span id="l39.60">   // the event loop.</span>
<a href="#l39.61"></a><span id="l39.61">   account._lastCommandSendTime = 0;</span>
<a href="#l39.62"></a><span id="l39.62">   for (let test of tests) {</span>
<a href="#l39.63"></a><span id="l39.63">     let timeout;</span>
<a href="#l39.64"></a><span id="l39.64">     let { data, result } = test;</span>
<a href="#l39.65"></a><span id="l39.65">     account.callbacks.push((aCommand, aParams) =&gt; {</span>
<a href="#l39.66"></a><span id="l39.66">       let msg = account.buildMessage(aCommand, aParams);</span>
<a href="#l39.67"></a><span id="l39.67">       equal(msg, result, &quot;Test buffering with setTimeout&quot;);</span>
<a href="#l39.68"></a><span id="l39.68" class="difflineminus">-      irc.clearTimeout(timeout);</span>
<a href="#l39.69"></a><span id="l39.69" class="difflineplus">+      clearTimeout(timeout);</span>
<a href="#l39.70"></a><span id="l39.70">       run_next_test();</span>
<a href="#l39.71"></a><span id="l39.71">     });</span>
<a href="#l39.72"></a><span id="l39.72">     add_test(() =&gt; {</span>
<a href="#l39.73"></a><span id="l39.73">       // This timeout lets the test fail more quickly if</span>
<a href="#l39.74"></a><span id="l39.74">       // some of the callbacks we added don't get called.</span>
<a href="#l39.75"></a><span id="l39.75">       // Not strictly speaking necessary.</span>
<a href="#l39.76"></a><span id="l39.76" class="difflineminus">-      timeout = irc.setTimeout(() =&gt; {</span>
<a href="#l39.77"></a><span id="l39.77" class="difflineplus">+      // eslint-disable-next-line mozilla/no-arbitrary-setTimeout</span>
<a href="#l39.78"></a><span id="l39.78" class="difflineplus">+      timeout = setTimeout(() =&gt; {</span>
<a href="#l39.79"></a><span id="l39.79">         ok(false, &quot;test_parameterCollect failed after timeout.&quot;);</span>
<a href="#l39.80"></a><span id="l39.80">         run_next_test();</span>
<a href="#l39.81"></a><span id="l39.81">       }, 2000);</span>
<a href="#l39.82"></a><span id="l39.82">       let delay = 0;</span>
<a href="#l39.83"></a><span id="l39.83">       for (let params of data) {</span>
<a href="#l39.84"></a><span id="l39.84">         let [channel, key] = params;</span>
<a href="#l39.85"></a><span id="l39.85">         delay += 200;</span>
<a href="#l39.86"></a><span id="l39.86" class="difflineminus">-        irc.setTimeout(() =&gt; {</span>
<a href="#l39.87"></a><span id="l39.87" class="difflineplus">+        // eslint-disable-next-line mozilla/no-arbitrary-setTimeout</span>
<a href="#l39.88"></a><span id="l39.88" class="difflineplus">+        setTimeout(() =&gt; {</span>
<a href="#l39.89"></a><span id="l39.89">           account.sendBufferedCommand(&quot;JOIN&quot;, channel, key);</span>
<a href="#l39.90"></a><span id="l39.90">         }, delay);</span>
<a href="#l39.91"></a><span id="l39.91">       }</span>
<a href="#l39.92"></a><span id="l39.92">     });</span>
<a href="#l39.93"></a><span id="l39.93">   }</span>
<a href="#l39.94"></a><span id="l39.94"> }</span>
<a href="#l39.95"></a><span id="l39.95"> </span>
<a href="#l39.96"></a><span id="l39.96"> function test_maxLength() {</span>
<a href="#l39.97"></a><span id="l39.97" class="difflineat">@@ -163,26 +167,27 @@ function test_maxLength() {</span>
<a href="#l39.98"></a><span id="l39.98">     let { data, results } = test;</span>
<a href="#l39.99"></a><span id="l39.99">     for (let r of results) {</span>
<a href="#l39.100"></a><span id="l39.100">       let result = r;</span>
<a href="#l39.101"></a><span id="l39.101">       account.callbacks.push((aCommand, aParams) =&gt; {</span>
<a href="#l39.102"></a><span id="l39.102">         let msg = account.buildMessage(aCommand, aParams);</span>
<a href="#l39.103"></a><span id="l39.103">         equal(msg, result, &quot;Test maximum message length constraint&quot;);</span>
<a href="#l39.104"></a><span id="l39.104">         // After all results are checked, run the next test.</span>
<a href="#l39.105"></a><span id="l39.105">         if (result == results[results.length - 1]) {</span>
<a href="#l39.106"></a><span id="l39.106" class="difflineminus">-          irc.clearTimeout(timeout);</span>
<a href="#l39.107"></a><span id="l39.107" class="difflineplus">+          clearTimeout(timeout);</span>
<a href="#l39.108"></a><span id="l39.108">           run_next_test();</span>
<a href="#l39.109"></a><span id="l39.109">         }</span>
<a href="#l39.110"></a><span id="l39.110">       });</span>
<a href="#l39.111"></a><span id="l39.111">     }</span>
<a href="#l39.112"></a><span id="l39.112">     add_test(() =&gt; {</span>
<a href="#l39.113"></a><span id="l39.113">       // This timeout lets the test fail more quickly if</span>
<a href="#l39.114"></a><span id="l39.114">       // some of the callbacks we added don't get called.</span>
<a href="#l39.115"></a><span id="l39.115">       // Not strictly speaking necessary.</span>
<a href="#l39.116"></a><span id="l39.116" class="difflineminus">-      timeout = irc.setTimeout(() =&gt; {</span>
<a href="#l39.117"></a><span id="l39.117" class="difflineplus">+      // eslint-disable-next-line mozilla/no-arbitrary-setTimeout</span>
<a href="#l39.118"></a><span id="l39.118" class="difflineplus">+      timeout = setTimeout(() =&gt; {</span>
<a href="#l39.119"></a><span id="l39.119">         ok(false, &quot;test_maxLength failed after timeout.&quot;);</span>
<a href="#l39.120"></a><span id="l39.120">         run_next_test();</span>
<a href="#l39.121"></a><span id="l39.121">       }, 2000);</span>
<a href="#l39.122"></a><span id="l39.122">       for (let [channel, key] of data) {</span>
<a href="#l39.123"></a><span id="l39.123">         account.sendBufferedCommand(&quot;JOIN&quot;, channel, key);</span>
<a href="#l39.124"></a><span id="l39.124">       }</span>
<a href="#l39.125"></a><span id="l39.125">     });</span>
<a href="#l39.126"></a><span id="l39.126">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/chat/protocols/irc/test/test_setMode.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_setMode.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -1,35 +1,36 @@</span>
<a href="#l40.4"></a><span id="l40.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l40.5"></a><span id="l40.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l40.6"></a><span id="l40.6"> </span>
<a href="#l40.7"></a><span id="l40.7"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l40.8"></a><span id="l40.8" class="difflineminus">-var irc = {};</span>
<a href="#l40.9"></a><span id="l40.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l40.10"></a><span id="l40.10" class="difflineplus">+var { IRCAccount, IRCChannel } = ChromeUtils.import(</span>
<a href="#l40.11"></a><span id="l40.11" class="difflineplus">+  &quot;resource:///modules/IRC.jsm&quot;</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineplus">+);</span>
<a href="#l40.13"></a><span id="l40.13"> Services.conversations.initConversations();</span>
<a href="#l40.14"></a><span id="l40.14"> </span>
<a href="#l40.15"></a><span id="l40.15"> function FakeAccount() {</span>
<a href="#l40.16"></a><span id="l40.16" class="difflineminus">-  this.normalizeNick = irc.ircAccount.prototype.normalizeNick.bind(this);</span>
<a href="#l40.17"></a><span id="l40.17" class="difflineplus">+  this.normalizeNick = IRCAccount.prototype.normalizeNick.bind(this);</span>
<a href="#l40.18"></a><span id="l40.18"> }</span>
<a href="#l40.19"></a><span id="l40.19"> FakeAccount.prototype = {</span>
<a href="#l40.20"></a><span id="l40.20" class="difflineminus">-  __proto__: irc.ircAccount.prototype,</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineplus">+  __proto__: IRCAccount.prototype,</span>
<a href="#l40.22"></a><span id="l40.22">   setWhois: (n, f) =&gt; true,</span>
<a href="#l40.23"></a><span id="l40.23">   ERROR: do_throw,</span>
<a href="#l40.24"></a><span id="l40.24"> };</span>
<a href="#l40.25"></a><span id="l40.25"> </span>
<a href="#l40.26"></a><span id="l40.26"> function run_test() {</span>
<a href="#l40.27"></a><span id="l40.27">   add_test(test_topicSettable);</span>
<a href="#l40.28"></a><span id="l40.28">   add_test(test_topicSettableJoinAsOp);</span>
<a href="#l40.29"></a><span id="l40.29"> </span>
<a href="#l40.30"></a><span id="l40.30">   run_next_test();</span>
<a href="#l40.31"></a><span id="l40.31"> }</span>
<a href="#l40.32"></a><span id="l40.32"> </span>
<a href="#l40.33"></a><span id="l40.33"> // Test joining a channel, then being set as op.</span>
<a href="#l40.34"></a><span id="l40.34"> function test_topicSettable() {</span>
<a href="#l40.35"></a><span id="l40.35" class="difflineminus">-  let channel = new irc.ircChannel(new FakeAccount(), &quot;#test&quot;, &quot;nick&quot;);</span>
<a href="#l40.36"></a><span id="l40.36" class="difflineplus">+  let channel = new IRCChannel(new FakeAccount(), &quot;#test&quot;, &quot;nick&quot;);</span>
<a href="#l40.37"></a><span id="l40.37">   // We're not in the room yet, so the topic is NOT editable.</span>
<a href="#l40.38"></a><span id="l40.38">   equal(channel.topicSettable, false);</span>
<a href="#l40.39"></a><span id="l40.39"> </span>
<a href="#l40.40"></a><span id="l40.40">   // Join the room.</span>
<a href="#l40.41"></a><span id="l40.41">   channel.getParticipant(&quot;nick&quot;);</span>
<a href="#l40.42"></a><span id="l40.42">   // The topic should be editable.</span>
<a href="#l40.43"></a><span id="l40.43">   equal(channel.topicSettable, true);</span>
<a href="#l40.44"></a><span id="l40.44"> </span>
<a href="#l40.45"></a><span id="l40.45" class="difflineat">@@ -43,17 +44,17 @@ function test_topicSettable() {</span>
<a href="#l40.46"></a><span id="l40.46">   // Nick is now an op and can set the topic!</span>
<a href="#l40.47"></a><span id="l40.47">   equal(channel.topicSettable, true);</span>
<a href="#l40.48"></a><span id="l40.48"> </span>
<a href="#l40.49"></a><span id="l40.49">   run_next_test();</span>
<a href="#l40.50"></a><span id="l40.50"> }</span>
<a href="#l40.51"></a><span id="l40.51"> </span>
<a href="#l40.52"></a><span id="l40.52"> // Test when you join as an op (as opposed to being set to op after joining).</span>
<a href="#l40.53"></a><span id="l40.53"> function test_topicSettableJoinAsOp() {</span>
<a href="#l40.54"></a><span id="l40.54" class="difflineminus">-  let channel = new irc.ircChannel(new FakeAccount(), &quot;#test&quot;, &quot;nick&quot;);</span>
<a href="#l40.55"></a><span id="l40.55" class="difflineplus">+  let channel = new IRCChannel(new FakeAccount(), &quot;#test&quot;, &quot;nick&quot;);</span>
<a href="#l40.56"></a><span id="l40.56">   // We're not in the room yet, so the topic is NOT editable.</span>
<a href="#l40.57"></a><span id="l40.57">   equal(channel.topicSettable, false);</span>
<a href="#l40.58"></a><span id="l40.58"> </span>
<a href="#l40.59"></a><span id="l40.59">   // Join the room as an op.</span>
<a href="#l40.60"></a><span id="l40.60">   channel.getParticipant(&quot;@nick&quot;);</span>
<a href="#l40.61"></a><span id="l40.61">   // The topic should be editable.</span>
<a href="#l40.62"></a><span id="l40.62">   equal(channel.topicSettable, true);</span>
<a href="#l40.63"></a><span id="l40.63"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/chat/protocols/irc/test/test_splitLongMessages.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_splitLongMessages.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -1,40 +1,41 @@</span>
<a href="#l41.4"></a><span id="l41.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l41.5"></a><span id="l41.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l41.6"></a><span id="l41.6"> </span>
<a href="#l41.7"></a><span id="l41.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l41.8"></a><span id="l41.8" class="difflineminus">-var irc = {};</span>
<a href="#l41.9"></a><span id="l41.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l41.10"></a><span id="l41.10" class="difflineplus">+var { IRCAccount, GenericIRCConversation } = ChromeUtils.import(</span>
<a href="#l41.11"></a><span id="l41.11" class="difflineplus">+  &quot;resource:///modules/IRC.jsm&quot;</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineplus">+);</span>
<a href="#l41.13"></a><span id="l41.13"> </span>
<a href="#l41.14"></a><span id="l41.14"> var messages = {</span>
<a href="#l41.15"></a><span id="l41.15">   // Exactly 51 characters.</span>
<a href="#l41.16"></a><span id="l41.16">   &quot;This is a test.&quot;: [&quot;This is a test.&quot;],</span>
<a href="#l41.17"></a><span id="l41.17">   // Too long.</span>
<a href="#l41.18"></a><span id="l41.18">   &quot;This is a message that is too long.&quot;: [</span>
<a href="#l41.19"></a><span id="l41.19">     &quot;This is a&quot;,</span>
<a href="#l41.20"></a><span id="l41.20">     &quot;message that is&quot;,</span>
<a href="#l41.21"></a><span id="l41.21">     &quot;too long.&quot;,</span>
<a href="#l41.22"></a><span id="l41.22">   ],</span>
<a href="#l41.23"></a><span id="l41.23">   // Too short.</span>
<a href="#l41.24"></a><span id="l41.24">   &quot;Short msg.&quot;: [&quot;Short msg.&quot;],</span>
<a href="#l41.25"></a><span id="l41.25">   &quot;Thismessagecan'tbecut.&quot;: [&quot;Thismessagecan'&quot;, &quot;tbecut.&quot;],</span>
<a href="#l41.26"></a><span id="l41.26"> };</span>
<a href="#l41.27"></a><span id="l41.27"> </span>
<a href="#l41.28"></a><span id="l41.28" class="difflineminus">-irc.GenericIRCConversation.name = &quot;target&quot;;</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineminus">-irc.GenericIRCConversation._account = {</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineminus">-  __proto__: irc.ircAccount.prototype,</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineplus">+GenericIRCConversation.name = &quot;target&quot;;</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineplus">+GenericIRCConversation._account = {</span>
<a href="#l41.33"></a><span id="l41.33" class="difflineplus">+  __proto__: IRCAccount.prototype,</span>
<a href="#l41.34"></a><span id="l41.34">   _nickname: &quot;sender&quot;,</span>
<a href="#l41.35"></a><span id="l41.35">   prefix: &quot;!user@host&quot;,</span>
<a href="#l41.36"></a><span id="l41.36">   maxMessageLength: 51, // For convenience.</span>
<a href="#l41.37"></a><span id="l41.37"> };</span>
<a href="#l41.38"></a><span id="l41.38"> </span>
<a href="#l41.39"></a><span id="l41.39"> function run_test() {</span>
<a href="#l41.40"></a><span id="l41.40">   for (let message in messages) {</span>
<a href="#l41.41"></a><span id="l41.41">     let msg = { message };</span>
<a href="#l41.42"></a><span id="l41.42" class="difflineminus">-    let generatedMsgs = irc.GenericIRCConversation.prepareForSending(msg);</span>
<a href="#l41.43"></a><span id="l41.43" class="difflineplus">+    let generatedMsgs = GenericIRCConversation.prepareForSending(msg);</span>
<a href="#l41.44"></a><span id="l41.44"> </span>
<a href="#l41.45"></a><span id="l41.45">     // The expected messages as defined above.</span>
<a href="#l41.46"></a><span id="l41.46">     let expectedMsgs = messages[message];</span>
<a href="#l41.47"></a><span id="l41.47">     // Ensure the arrays are equal.</span>
<a href="#l41.48"></a><span id="l41.48">     deepEqual(generatedMsgs, expectedMsgs);</span>
<a href="#l41.49"></a><span id="l41.49">   }</span>
<a href="#l41.50"></a><span id="l41.50"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/chat/protocols/irc/test/test_tryNewNick.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/chat/protocols/irc/test/test_tryNewNick.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l42.4"></a><span id="l42.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l42.5"></a><span id="l42.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l42.6"></a><span id="l42.6"> </span>
<a href="#l42.7"></a><span id="l42.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l42.8"></a><span id="l42.8" class="difflineminus">-var irc = {};</span>
<a href="#l42.9"></a><span id="l42.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/irc.js&quot;, irc);</span>
<a href="#l42.10"></a><span id="l42.10" class="difflineplus">+var { IRCAccount } = ChromeUtils.import(&quot;resource:///modules/IRC.jsm&quot;);</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12"> var fakeProto = {</span>
<a href="#l42.13"></a><span id="l42.13">   id: &quot;fake-proto&quot;,</span>
<a href="#l42.14"></a><span id="l42.14">   options: { alternateNicks: &quot;&quot; },</span>
<a href="#l42.15"></a><span id="l42.15">   _getOptionDefault(aOption) {</span>
<a href="#l42.16"></a><span id="l42.16">     return this.options[aOption];</span>
<a href="#l42.17"></a><span id="l42.17">   },</span>
<a href="#l42.18"></a><span id="l42.18"> };</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineat">@@ -26,17 +25,17 @@ function test_tryNewNick() {</span>
<a href="#l42.20"></a><span id="l42.20">     clo1kep: &quot;clo1kep1&quot;,</span>
<a href="#l42.21"></a><span id="l42.21">     clo1kep1: &quot;clo1kep2&quot;,</span>
<a href="#l42.22"></a><span id="l42.22">     clo1kep10: &quot;clo1kep11&quot;,</span>
<a href="#l42.23"></a><span id="l42.23">     clo1kep0: &quot;clo1kep1&quot;,</span>
<a href="#l42.24"></a><span id="l42.24">     clo1kep01: &quot;clo1kep02&quot;,</span>
<a href="#l42.25"></a><span id="l42.25">     clo1kep09: &quot;clo1kep10&quot;,</span>
<a href="#l42.26"></a><span id="l42.26">   };</span>
<a href="#l42.27"></a><span id="l42.27"> </span>
<a href="#l42.28"></a><span id="l42.28" class="difflineminus">-  let account = new irc.ircAccount(fakeProto, {</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineplus">+  let account = new IRCAccount(fakeProto, {</span>
<a href="#l42.30"></a><span id="l42.30">     name: &quot;clokep@instantbird.org&quot;,</span>
<a href="#l42.31"></a><span id="l42.31">   });</span>
<a href="#l42.32"></a><span id="l42.32">   account.LOG = function(aStr) {};</span>
<a href="#l42.33"></a><span id="l42.33">   account.normalize = aStr =&gt; aStr;</span>
<a href="#l42.34"></a><span id="l42.34"> </span>
<a href="#l42.35"></a><span id="l42.35">   for (let currentNick in testData) {</span>
<a href="#l42.36"></a><span id="l42.36">     account._sentNickname = currentNick;</span>
<a href="#l42.37"></a><span id="l42.37">     account.sendMessage = (aCommand, aNewNick) =&gt;</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineat">@@ -69,17 +68,17 @@ function test_maxLength() {</span>
<a href="#l42.39"></a><span id="l42.39">     [&quot;abcdefgh1&quot;, &quot;abcdefg10&quot;],</span>
<a href="#l42.40"></a><span id="l42.40">     [&quot;abcdefg10&quot;, &quot;abcdefg11&quot;],</span>
<a href="#l42.41"></a><span id="l42.41">     [&quot;abcdefg99&quot;, &quot;abcdefg100&quot;],</span>
<a href="#l42.42"></a><span id="l42.42">     [&quot;abcdefg10&quot;, &quot;abcdef100&quot;],</span>
<a href="#l42.43"></a><span id="l42.43">     [&quot;a99999999&quot;, &quot;a100000000&quot;],</span>
<a href="#l42.44"></a><span id="l42.44">     [&quot;a10000000&quot;, &quot;a00000000&quot;],</span>
<a href="#l42.45"></a><span id="l42.45">   ];</span>
<a href="#l42.46"></a><span id="l42.46"> </span>
<a href="#l42.47"></a><span id="l42.47" class="difflineminus">-  let account = new irc.ircAccount(fakeProto, {</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineplus">+  let account = new IRCAccount(fakeProto, {</span>
<a href="#l42.49"></a><span id="l42.49">     name: &quot;clokep@instantbird.org&quot;,</span>
<a href="#l42.50"></a><span id="l42.50">   });</span>
<a href="#l42.51"></a><span id="l42.51">   account.LOG = function(aStr) {};</span>
<a href="#l42.52"></a><span id="l42.52">   account._sentNickname = &quot;abcdefghi&quot;;</span>
<a href="#l42.53"></a><span id="l42.53">   account.normalize = aStr =&gt; aStr;</span>
<a href="#l42.54"></a><span id="l42.54"> </span>
<a href="#l42.55"></a><span id="l42.55">   for (let currentNick of testData) {</span>
<a href="#l42.56"></a><span id="l42.56">     account.sendMessage = (aCommand, aNewNick) =&gt;</span>
<a href="#l42.57"></a><span id="l42.57" class="difflineat">@@ -102,17 +101,17 @@ function test_altNicks() {</span>
<a href="#l42.58"></a><span id="l42.58">     &quot;clokep|&quot;: [altNicks, &quot;clokep|1&quot;],</span>
<a href="#l42.59"></a><span id="l42.59">     // Test element not in list with number at end.</span>
<a href="#l42.60"></a><span id="l42.60">     clokep1: [altNicks, &quot;clokep2&quot;],</span>
<a href="#l42.61"></a><span id="l42.61"> </span>
<a href="#l42.62"></a><span id="l42.62">     // Test messy alternatives.</span>
<a href="#l42.63"></a><span id="l42.63">     &quot;clokep[&quot;: [&quot; clokep ,\n clokep111,,,\tclokep[, clokep_&quot;, &quot;clokep_&quot;],</span>
<a href="#l42.64"></a><span id="l42.64">   };</span>
<a href="#l42.65"></a><span id="l42.65"> </span>
<a href="#l42.66"></a><span id="l42.66" class="difflineminus">-  let account = new irc.ircAccount(fakeProto, {</span>
<a href="#l42.67"></a><span id="l42.67" class="difflineplus">+  let account = new IRCAccount(fakeProto, {</span>
<a href="#l42.68"></a><span id="l42.68">     name: &quot;clokep@instantbird.org&quot;,</span>
<a href="#l42.69"></a><span id="l42.69">   });</span>
<a href="#l42.70"></a><span id="l42.70">   account.LOG = function(aStr) {};</span>
<a href="#l42.71"></a><span id="l42.71">   account.normalize = aStr =&gt; aStr;</span>
<a href="#l42.72"></a><span id="l42.72"> </span>
<a href="#l42.73"></a><span id="l42.73">   for (let currentNick in testData) {</span>
<a href="#l42.74"></a><span id="l42.74">     // Only one pref is touched in here, override the default to return</span>
<a href="#l42.75"></a><span id="l42.75">     // what this test needs.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1">rename from chat/protocols/jsTest/jsTestProtocol.js</span>
<a href="#l43.2"></a><span id="l43.2">rename to chat/protocols/jsTest/JSTestProtocol.jsm</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineminus">--- a/chat/protocols/jsTest/jsTestProtocol.js</span>
<a href="#l43.4"></a><span id="l43.4" class="difflineplus">+++ b/chat/protocols/jsTest/JSTestProtocol.jsm</span>
<a href="#l43.5"></a><span id="l43.5" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l43.6"></a><span id="l43.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l43.7"></a><span id="l43.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l43.8"></a><span id="l43.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l43.9"></a><span id="l43.9"> </span>
<a href="#l43.10"></a><span id="l43.10" class="difflineminus">-var { XPCOMUtils, setTimeout } = ChromeUtils.import(</span>
<a href="#l43.11"></a><span id="l43.11" class="difflineminus">-  &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;JSTestProtocol&quot;];</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineplus">+</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineplus">+var { setTimeout } = ChromeUtils.import(&quot;resource:///modules/imXPCOMUtils.jsm&quot;);</span>
<a href="#l43.16"></a><span id="l43.16"> var {</span>
<a href="#l43.17"></a><span id="l43.17">   GenericAccountPrototype,</span>
<a href="#l43.18"></a><span id="l43.18">   GenericConvIMPrototype,</span>
<a href="#l43.19"></a><span id="l43.19">   GenericProtocolPrototype,</span>
<a href="#l43.20"></a><span id="l43.20"> } = ChromeUtils.import(&quot;resource:///modules/jsProtoHelper.jsm&quot;);</span>
<a href="#l43.21"></a><span id="l43.21"> </span>
<a href="#l43.22"></a><span id="l43.22"> function Conversation(aAccount) {</span>
<a href="#l43.23"></a><span id="l43.23">   this._init(aAccount);</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineat">@@ -102,18 +102,18 @@ Account.prototype = {</span>
<a href="#l43.25"></a><span id="l43.25">       required: true,</span>
<a href="#l43.26"></a><span id="l43.26">     },</span>
<a href="#l43.27"></a><span id="l43.27">   },</span>
<a href="#l43.28"></a><span id="l43.28"> </span>
<a href="#l43.29"></a><span id="l43.29">   // Nothing to do.</span>
<a href="#l43.30"></a><span id="l43.30">   unInit() {},</span>
<a href="#l43.31"></a><span id="l43.31"> };</span>
<a href="#l43.32"></a><span id="l43.32"> </span>
<a href="#l43.33"></a><span id="l43.33" class="difflineminus">-function jsTestProtocol() {}</span>
<a href="#l43.34"></a><span id="l43.34" class="difflineminus">-jsTestProtocol.prototype = {</span>
<a href="#l43.35"></a><span id="l43.35" class="difflineplus">+function JSTestProtocol() {}</span>
<a href="#l43.36"></a><span id="l43.36" class="difflineplus">+JSTestProtocol.prototype = {</span>
<a href="#l43.37"></a><span id="l43.37">   __proto__: GenericProtocolPrototype,</span>
<a href="#l43.38"></a><span id="l43.38">   get name() {</span>
<a href="#l43.39"></a><span id="l43.39">     return &quot;JS Test&quot;;</span>
<a href="#l43.40"></a><span id="l43.40">   },</span>
<a href="#l43.41"></a><span id="l43.41">   options: {</span>
<a href="#l43.42"></a><span id="l43.42">     text: { label: &quot;Text option&quot;, default: &quot;foo&quot; },</span>
<a href="#l43.43"></a><span id="l43.43">     bool: { label: &quot;Boolean option&quot;, default: true },</span>
<a href="#l43.44"></a><span id="l43.44">     int: { label: &quot;Integer option&quot;, default: 42 },</span>
<a href="#l43.45"></a><span id="l43.45" class="difflineat">@@ -133,12 +133,9 @@ jsTestProtocol.prototype = {</span>
<a href="#l43.46"></a><span id="l43.46">       separator: &quot;@&quot;,</span>
<a href="#l43.47"></a><span id="l43.47">       defaultValue: &quot;default.server&quot;,</span>
<a href="#l43.48"></a><span id="l43.48">       reverse: true,</span>
<a href="#l43.49"></a><span id="l43.49">     },</span>
<a href="#l43.50"></a><span id="l43.50">   ],</span>
<a href="#l43.51"></a><span id="l43.51">   getAccount(aImAccount) {</span>
<a href="#l43.52"></a><span id="l43.52">     return new Account(this, aImAccount);</span>
<a href="#l43.53"></a><span id="l43.53">   },</span>
<a href="#l43.54"></a><span id="l43.54" class="difflineminus">-  classID: Components.ID(&quot;{a0774c5a-4aea-458b-9fbc-8d3cbf1a4630}&quot;),</span>
<a href="#l43.55"></a><span id="l43.55"> };</span>
<a href="#l43.56"></a><span id="l43.56" class="difflineminus">-</span>
<a href="#l43.57"></a><span id="l43.57" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([jsTestProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1">new file mode 100644</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineminus">--- /dev/null</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineplus">+++ b/chat/protocols/jsTest/components.conf</span>
<a href="#l44.4"></a><span id="l44.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l44.5"></a><span id="l44.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l44.6"></a><span id="l44.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l44.7"></a><span id="l44.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l44.8"></a><span id="l44.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l44.9"></a><span id="l44.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l44.10"></a><span id="l44.10" class="difflineplus">+</span>
<a href="#l44.11"></a><span id="l44.11" class="difflineplus">+Classes = [</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineplus">+  {</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+    'cid': '{a0774c5a-4aea-458b-9fbc-8d3cbf1a4630}',</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/jstest;1'],</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineplus">+    'jsm': 'resource:///modules/JSTestProtocol.jsm',</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineplus">+    'constructor': 'JSTestProtocol',</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-jstest'},</span>
<a href="#l44.18"></a><span id="l44.18" class="difflineplus">+  },</span>
<a href="#l44.19"></a><span id="l44.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1">deleted file mode 100644</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineminus">--- a/chat/protocols/jsTest/jsTestProtocol.manifest</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineplus">+++ /dev/null</span>
<a href="#l45.4"></a><span id="l45.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l45.5"></a><span id="l45.5" class="difflineminus">-component {a0774c5a-4aea-458b-9fbc-8d3cbf1a4630} jsTestProtocol.js</span>
<a href="#l45.6"></a><span id="l45.6" class="difflineminus">-contract @mozilla.org/chat/jstest;1 {a0774c5a-4aea-458b-9fbc-8d3cbf1a4630}</span>
<a href="#l45.7"></a><span id="l45.7" class="difflineminus">-category im-protocol-plugin prpl-jstest @mozilla.org/chat/jstest;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/chat/protocols/jsTest/moz.build</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/chat/protocols/jsTest/moz.build</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -1,11 +1,14 @@</span>
<a href="#l46.4"></a><span id="l46.4"> # vim: set filetype=python:</span>
<a href="#l46.5"></a><span id="l46.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l46.6"></a><span id="l46.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l46.7"></a><span id="l46.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l46.8"></a><span id="l46.8"> </span>
<a href="#l46.9"></a><span id="l46.9"> if CONFIG['MOZ_DEBUG']:</span>
<a href="#l46.10"></a><span id="l46.10" class="difflineminus">-    EXTRA_COMPONENTS += [</span>
<a href="#l46.11"></a><span id="l46.11" class="difflineminus">-        'jsTestProtocol.js',</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-        'jsTestProtocol.manifest',</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+    EXTRA_JS_MODULES += [</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineplus">+        'JSTestProtocol.jsm',</span>
<a href="#l46.15"></a><span id="l46.15">     ]</span>
<a href="#l46.16"></a><span id="l46.16"> </span>
<a href="#l46.17"></a><span id="l46.17" class="difflineplus">+    XPCOM_MANIFESTS += [</span>
<a href="#l46.18"></a><span id="l46.18" class="difflineplus">+        'components.conf',</span>
<a href="#l46.19"></a><span id="l46.19" class="difflineplus">+    ]</span>
<a href="#l46.20"></a><span id="l46.20" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1">rename from chat/protocols/matrix/matrix.js</span>
<a href="#l47.2"></a><span id="l47.2">rename to chat/protocols/matrix/Matrix.jsm</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineminus">--- a/chat/protocols/matrix/matrix.js</span>
<a href="#l47.4"></a><span id="l47.4" class="difflineplus">+++ b/chat/protocols/matrix/Matrix.jsm</span>
<a href="#l47.5"></a><span id="l47.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l47.6"></a><span id="l47.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l47.7"></a><span id="l47.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l47.8"></a><span id="l47.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l47.9"></a><span id="l47.9"> </span>
<a href="#l47.10"></a><span id="l47.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;MatrixProtocol&quot;];</span>
<a href="#l47.11"></a><span id="l47.11" class="difflineplus">+</span>
<a href="#l47.12"></a><span id="l47.12"> var { XPCOMUtils, nsSimpleEnumerator, l10nHelper } = ChromeUtils.import(</span>
<a href="#l47.13"></a><span id="l47.13">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l47.14"></a><span id="l47.14"> );</span>
<a href="#l47.15"></a><span id="l47.15"> var {</span>
<a href="#l47.16"></a><span id="l47.16">   GenericAccountPrototype,</span>
<a href="#l47.17"></a><span id="l47.17">   GenericConvChatPrototype,</span>
<a href="#l47.18"></a><span id="l47.18">   GenericConvChatBuddyPrototype,</span>
<a href="#l47.19"></a><span id="l47.19">   GenericProtocolPrototype,</span>
<a href="#l47.20"></a><span id="l47.20" class="difflineat">@@ -300,13 +302,9 @@ MatrixProtocol.prototype = {</span>
<a href="#l47.21"></a><span id="l47.21">       },</span>
<a href="#l47.22"></a><span id="l47.22">       default: 443,</span>
<a href="#l47.23"></a><span id="l47.23">     },</span>
<a href="#l47.24"></a><span id="l47.24">   },</span>
<a href="#l47.25"></a><span id="l47.25"> </span>
<a href="#l47.26"></a><span id="l47.26">   get chatHasTopic() {</span>
<a href="#l47.27"></a><span id="l47.27">     return true;</span>
<a href="#l47.28"></a><span id="l47.28">   },</span>
<a href="#l47.29"></a><span id="l47.29" class="difflineminus">-</span>
<a href="#l47.30"></a><span id="l47.30" class="difflineminus">-  classID: Components.ID(&quot;{e9653ac6-a671-11e6-bf84-60a44c717042}&quot;),</span>
<a href="#l47.31"></a><span id="l47.31"> };</span>
<a href="#l47.32"></a><span id="l47.32" class="difflineminus">-</span>
<a href="#l47.33"></a><span id="l47.33" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([MatrixProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1">new file mode 100644</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineminus">--- /dev/null</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineplus">+++ b/chat/protocols/matrix/components.conf</span>
<a href="#l48.4"></a><span id="l48.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l48.5"></a><span id="l48.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l48.6"></a><span id="l48.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l48.7"></a><span id="l48.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l48.8"></a><span id="l48.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l48.9"></a><span id="l48.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l48.10"></a><span id="l48.10" class="difflineplus">+</span>
<a href="#l48.11"></a><span id="l48.11" class="difflineplus">+Classes = [</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineplus">+  {</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+    'cid': '{e9653ac6-a671-11e6-bf84-60a44c717042}',</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/matrix;1'],</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineplus">+    'jsm': 'resource:///modules/Matrix.jsm',</span>
<a href="#l48.16"></a><span id="l48.16" class="difflineplus">+    'constructor': 'MatrixProtocol',</span>
<a href="#l48.17"></a><span id="l48.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-matrix'},</span>
<a href="#l48.18"></a><span id="l48.18" class="difflineplus">+  },</span>
<a href="#l48.19"></a><span id="l48.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1">deleted file mode 100644</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineminus">--- a/chat/protocols/matrix/matrix.manifest</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineplus">+++ /dev/null</span>
<a href="#l49.4"></a><span id="l49.4" class="difflineat">@@ -1,4 +0,0 @@</span>
<a href="#l49.5"></a><span id="l49.5" class="difflineminus">-component {e9653ac6-a671-11e6-bf84-60a44c717042} matrix.js</span>
<a href="#l49.6"></a><span id="l49.6" class="difflineminus">-contract @mozilla.org/chat/matrix;1 {e9653ac6-a671-11e6-bf84-60a44c717042}</span>
<a href="#l49.7"></a><span id="l49.7" class="difflineminus">-category im-protocol-plugin prpl-matrix @mozilla.org/chat/matrix;1</span>
<a href="#l49.8"></a><span id="l49.8" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/chat/protocols/matrix/moz.build</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/chat/protocols/matrix/moz.build</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -5,20 +5,20 @@</span>
<a href="#l50.4"></a><span id="l50.4"> </span>
<a href="#l50.5"></a><span id="l50.5"> # XPCSHELL_TESTS_MANIFESTS += []</span>
<a href="#l50.6"></a><span id="l50.6"> </span>
<a href="#l50.7"></a><span id="l50.7"> DIRS += [</span>
<a href="#l50.8"></a><span id="l50.8">     'lib',</span>
<a href="#l50.9"></a><span id="l50.9">     'shims',</span>
<a href="#l50.10"></a><span id="l50.10"> ]</span>
<a href="#l50.11"></a><span id="l50.11"> </span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineminus">-    'matrix.js',</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineminus">-    'matrix.manifest',</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineminus">-]</span>
<a href="#l50.16"></a><span id="l50.16" class="difflineminus">-</span>
<a href="#l50.17"></a><span id="l50.17"> EXTRA_JS_MODULES += [</span>
<a href="#l50.18"></a><span id="l50.18">     'matrix-sdk.jsm',</span>
<a href="#l50.19"></a><span id="l50.19" class="difflineplus">+    'Matrix.jsm',</span>
<a href="#l50.20"></a><span id="l50.20"> ]</span>
<a href="#l50.21"></a><span id="l50.21"> </span>
<a href="#l50.22"></a><span id="l50.22"> JAR_MANIFESTS += [</span>
<a href="#l50.23"></a><span id="l50.23">     'jar.mn',</span>
<a href="#l50.24"></a><span id="l50.24"> ]</span>
<a href="#l50.25"></a><span id="l50.25" class="difflineplus">+</span>
<a href="#l50.26"></a><span id="l50.26" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l50.27"></a><span id="l50.27" class="difflineplus">+    'components.conf',</span>
<a href="#l50.28"></a><span id="l50.28" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1">rename from chat/protocols/odnoklassniki/odnoklassniki.js</span>
<a href="#l51.2"></a><span id="l51.2">rename to chat/protocols/odnoklassniki/Odnoklassniki.jsm</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineminus">--- a/chat/protocols/odnoklassniki/odnoklassniki.js</span>
<a href="#l51.4"></a><span id="l51.4" class="difflineplus">+++ b/chat/protocols/odnoklassniki/Odnoklassniki.jsm</span>
<a href="#l51.5"></a><span id="l51.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l51.6"></a><span id="l51.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l51.7"></a><span id="l51.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l51.8"></a><span id="l51.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l51.9"></a><span id="l51.9"> </span>
<a href="#l51.10"></a><span id="l51.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;OdnoklassnikiProtocol&quot;];</span>
<a href="#l51.11"></a><span id="l51.11" class="difflineplus">+</span>
<a href="#l51.12"></a><span id="l51.12"> var { XPCOMUtils, l10nHelper } = ChromeUtils.import(</span>
<a href="#l51.13"></a><span id="l51.13">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l51.14"></a><span id="l51.14"> );</span>
<a href="#l51.15"></a><span id="l51.15"> var { GenericProtocolPrototype } = ChromeUtils.import(</span>
<a href="#l51.16"></a><span id="l51.16">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l51.17"></a><span id="l51.17"> );</span>
<a href="#l51.18"></a><span id="l51.18"> var { XMPPAccountPrototype } = ChromeUtils.import(</span>
<a href="#l51.19"></a><span id="l51.19">   &quot;resource:///modules/xmpp.jsm&quot;</span>
<a href="#l51.20"></a><span id="l51.20" class="difflineat">@@ -70,12 +72,9 @@ OdnoklassnikiProtocol.prototype = {</span>
<a href="#l51.21"></a><span id="l51.21">     return &quot;chrome://prpl-odnoklassniki/skin/&quot;;</span>
<a href="#l51.22"></a><span id="l51.22">   },</span>
<a href="#l51.23"></a><span id="l51.23">   get usernameEmptyText() {</span>
<a href="#l51.24"></a><span id="l51.24">     return _(&quot;odnoklassniki.usernameHint&quot;);</span>
<a href="#l51.25"></a><span id="l51.25">   },</span>
<a href="#l51.26"></a><span id="l51.26">   getAccount(aImAccount) {</span>
<a href="#l51.27"></a><span id="l51.27">     return new OdnoklassnikiAccount(this, aImAccount);</span>
<a href="#l51.28"></a><span id="l51.28">   },</span>
<a href="#l51.29"></a><span id="l51.29" class="difflineminus">-  classID: Components.ID(&quot;{29b09a83-81c1-2032-11e2-6d9bc4f8e969}&quot;),</span>
<a href="#l51.30"></a><span id="l51.30"> };</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineminus">-</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([OdnoklassnikiProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1">new file mode 100644</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineminus">--- /dev/null</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineplus">+++ b/chat/protocols/odnoklassniki/components.conf</span>
<a href="#l52.4"></a><span id="l52.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l52.5"></a><span id="l52.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l52.6"></a><span id="l52.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l52.7"></a><span id="l52.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l52.8"></a><span id="l52.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l52.9"></a><span id="l52.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l52.10"></a><span id="l52.10" class="difflineplus">+</span>
<a href="#l52.11"></a><span id="l52.11" class="difflineplus">+Classes = [</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineplus">+  {</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+    'cid': '{29b09a83-81c1-2032-11e2-6d9bc4f8e969}',</span>
<a href="#l52.14"></a><span id="l52.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/odnoklassniki;1'],</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineplus">+    'jsm': 'resource:///modules/Odnoklassniki.jsm',</span>
<a href="#l52.16"></a><span id="l52.16" class="difflineplus">+    'constructor': 'OdnoklassnikiProtocol',</span>
<a href="#l52.17"></a><span id="l52.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-odnoklassniki'},</span>
<a href="#l52.18"></a><span id="l52.18" class="difflineplus">+  },</span>
<a href="#l52.19"></a><span id="l52.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/chat/protocols/odnoklassniki/moz.build</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/chat/protocols/odnoklassniki/moz.build</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -1,11 +1,14 @@</span>
<a href="#l53.4"></a><span id="l53.4"> # vim: set filetype=python:</span>
<a href="#l53.5"></a><span id="l53.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l53.6"></a><span id="l53.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l53.7"></a><span id="l53.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l53.8"></a><span id="l53.8"> </span>
<a href="#l53.9"></a><span id="l53.9" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l53.10"></a><span id="l53.10" class="difflineminus">-    'odnoklassniki.js',</span>
<a href="#l53.11"></a><span id="l53.11" class="difflineminus">-    'odnoklassniki.manifest',</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+</span>
<a href="#l53.14"></a><span id="l53.14" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l53.15"></a><span id="l53.15" class="difflineplus">+    'components.conf',</span>
<a href="#l53.16"></a><span id="l53.16"> ]</span>
<a href="#l53.17"></a><span id="l53.17"> </span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l53.20"></a><span id="l53.20" class="difflineplus">+    'Odnoklassniki.jsm',</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1">deleted file mode 100644</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineminus">--- a/chat/protocols/odnoklassniki/odnoklassniki.manifest</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineplus">+++ /dev/null</span>
<a href="#l54.4"></a><span id="l54.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l54.5"></a><span id="l54.5" class="difflineminus">-component {29b09a83-81c1-2032-11e2-6d9bc4f8e969} odnoklassniki.js</span>
<a href="#l54.6"></a><span id="l54.6" class="difflineminus">-contract @mozilla.org/chat/odnoklassniki;1 {29b09a83-81c1-2032-11e2-6d9bc4f8e969}</span>
<a href="#l54.7"></a><span id="l54.7" class="difflineminus">-category im-protocol-plugin prpl-odnoklassniki @mozilla.org/chat/odnoklassniki;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1">rename from chat/protocols/skype/skype.js</span>
<a href="#l55.2"></a><span id="l55.2">rename to chat/protocols/skype/Skype.jsm</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineminus">--- a/chat/protocols/skype/skype.js</span>
<a href="#l55.4"></a><span id="l55.4" class="difflineplus">+++ b/chat/protocols/skype/Skype.jsm</span>
<a href="#l55.5"></a><span id="l55.5" class="difflineat">@@ -1,12 +1,13 @@</span>
<a href="#l55.6"></a><span id="l55.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l55.7"></a><span id="l55.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l55.8"></a><span id="l55.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l55.9"></a><span id="l55.9"> </span>
<a href="#l55.10"></a><span id="l55.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;SkypeProtocol&quot;, &quot;contactUrlToName&quot;, &quot;magicSha256&quot;];</span>
<a href="#l55.11"></a><span id="l55.11"> var { httpRequest } = ChromeUtils.import(&quot;resource://gre/modules/Http.jsm&quot;);</span>
<a href="#l55.12"></a><span id="l55.12"> var { StringToArrayBuffer } = ChromeUtils.import(</span>
<a href="#l55.13"></a><span id="l55.13">   &quot;resource:///modules/ArrayBufferUtils.jsm&quot;</span>
<a href="#l55.14"></a><span id="l55.14"> );</span>
<a href="#l55.15"></a><span id="l55.15"> var { bigInt } = ChromeUtils.import(&quot;resource:///modules/BigInteger.jsm&quot;);</span>
<a href="#l55.16"></a><span id="l55.16"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l55.17"></a><span id="l55.17"> var {</span>
<a href="#l55.18"></a><span id="l55.18">   XPCOMUtils,</span>
<a href="#l55.19"></a><span id="l55.19" class="difflineat">@@ -951,12 +952,9 @@ SkypeProtocol.prototype = {</span>
<a href="#l55.20"></a><span id="l55.20"> </span>
<a href="#l55.21"></a><span id="l55.21">   get passwordOptional() {</span>
<a href="#l55.22"></a><span id="l55.22">     return false;</span>
<a href="#l55.23"></a><span id="l55.23">   },</span>
<a href="#l55.24"></a><span id="l55.24"> </span>
<a href="#l55.25"></a><span id="l55.25">   getAccount(aImAccount) {</span>
<a href="#l55.26"></a><span id="l55.26">     return new SkypeAccount(this, aImAccount);</span>
<a href="#l55.27"></a><span id="l55.27">   },</span>
<a href="#l55.28"></a><span id="l55.28" class="difflineminus">-  classID: Components.ID(&quot;{8446c0f6-9f59-4710-844e-eaa6c1f49d35}&quot;),</span>
<a href="#l55.29"></a><span id="l55.29"> };</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineminus">-</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([SkypeProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1">new file mode 100644</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineminus">--- /dev/null</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineplus">+++ b/chat/protocols/skype/components.conf</span>
<a href="#l56.4"></a><span id="l56.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l56.5"></a><span id="l56.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l56.6"></a><span id="l56.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l56.7"></a><span id="l56.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l56.8"></a><span id="l56.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l56.9"></a><span id="l56.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l56.10"></a><span id="l56.10" class="difflineplus">+</span>
<a href="#l56.11"></a><span id="l56.11" class="difflineplus">+Classes = [</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineplus">+  {</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+    'cid': '{8446c0f6-9f59-4710-844e-eaa6c1f49d35}',</span>
<a href="#l56.14"></a><span id="l56.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/skype;1'],</span>
<a href="#l56.15"></a><span id="l56.15" class="difflineplus">+    'jsm': 'resource:///modules/Skype.jsm',</span>
<a href="#l56.16"></a><span id="l56.16" class="difflineplus">+    'constructor': 'SkypeProtocol',</span>
<a href="#l56.17"></a><span id="l56.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-skype'},</span>
<a href="#l56.18"></a><span id="l56.18" class="difflineplus">+  },</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/chat/protocols/skype/moz.build</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/chat/protocols/skype/moz.build</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -1,13 +1,16 @@</span>
<a href="#l57.4"></a><span id="l57.4"> # vim: set filetype=python:</span>
<a href="#l57.5"></a><span id="l57.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l57.6"></a><span id="l57.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l57.7"></a><span id="l57.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l57.8"></a><span id="l57.8"> </span>
<a href="#l57.9"></a><span id="l57.9"> XPCSHELL_TESTS_MANIFESTS += ['test/xpcshell.ini']</span>
<a href="#l57.10"></a><span id="l57.10"> </span>
<a href="#l57.11"></a><span id="l57.11" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-    'skype.js',</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineminus">-    'skype.manifest',</span>
<a href="#l57.14"></a><span id="l57.14" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l57.15"></a><span id="l57.15" class="difflineplus">+</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l57.17"></a><span id="l57.17" class="difflineplus">+    'Skype.jsm',</span>
<a href="#l57.18"></a><span id="l57.18"> ]</span>
<a href="#l57.19"></a><span id="l57.19"> </span>
<a href="#l57.20"></a><span id="l57.20" class="difflineminus">-JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l57.21"></a><span id="l57.21" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l57.22"></a><span id="l57.22" class="difflineplus">+    'components.conf',</span>
<a href="#l57.23"></a><span id="l57.23" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1">deleted file mode 100644</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineminus">--- a/chat/protocols/skype/skype.manifest</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineplus">+++ /dev/null</span>
<a href="#l58.4"></a><span id="l58.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l58.5"></a><span id="l58.5" class="difflineminus">-component {8446c0f6-9f59-4710-844e-eaa6c1f49d35} skype.js</span>
<a href="#l58.6"></a><span id="l58.6" class="difflineminus">-contract @mozilla.org/chat/skype;1 {8446c0f6-9f59-4710-844e-eaa6c1f49d35}</span>
<a href="#l58.7"></a><span id="l58.7" class="difflineminus">-category im-protocol-plugin prpl-skype @mozilla.org/chat/skype;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/chat/protocols/skype/test/test_MagicSha256.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/chat/protocols/skype/test/test_MagicSha256.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -1,26 +1,25 @@</span>
<a href="#l59.4"></a><span id="l59.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l59.5"></a><span id="l59.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l59.6"></a><span id="l59.6"> </span>
<a href="#l59.7"></a><span id="l59.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l59.8"></a><span id="l59.8" class="difflineminus">-var skype = {};</span>
<a href="#l59.9"></a><span id="l59.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/skype.js&quot;, skype);</span>
<a href="#l59.10"></a><span id="l59.10" class="difflineplus">+var { magicSha256 } = ChromeUtils.import(&quot;resource:///modules/Skype.jsm&quot;);</span>
<a href="#l59.11"></a><span id="l59.11"> </span>
<a href="#l59.12"></a><span id="l59.12"> var data = {</span>
<a href="#l59.13"></a><span id="l59.13">   &quot;1416264993&quot;: &quot;3a33ac47fe2ec1a33d569f4be5c69ddc&quot;,</span>
<a href="#l59.14"></a><span id="l59.14">   &quot;1416387358&quot;: &quot;eca9716e1eedcbe93320ba794cea3388&quot;,</span>
<a href="#l59.15"></a><span id="l59.15">   &quot;1416392361&quot;: &quot;2ed6fc80c3303caa137ae3fd4fcc7d80&quot;,</span>
<a href="#l59.16"></a><span id="l59.16"> };</span>
<a href="#l59.17"></a><span id="l59.17"> </span>
<a href="#l59.18"></a><span id="l59.18"> function run_test() {</span>
<a href="#l59.19"></a><span id="l59.19">   add_test(test_MagicSha256);</span>
<a href="#l59.20"></a><span id="l59.20"> </span>
<a href="#l59.21"></a><span id="l59.21">   run_next_test();</span>
<a href="#l59.22"></a><span id="l59.22"> }</span>
<a href="#l59.23"></a><span id="l59.23"> </span>
<a href="#l59.24"></a><span id="l59.24"> function test_MagicSha256() {</span>
<a href="#l59.25"></a><span id="l59.25">   for (let input in data) {</span>
<a href="#l59.26"></a><span id="l59.26" class="difflineminus">-    equal(data[input], skype.magicSha256(input));</span>
<a href="#l59.27"></a><span id="l59.27" class="difflineplus">+    equal(data[input], magicSha256(input));</span>
<a href="#l59.28"></a><span id="l59.28">   }</span>
<a href="#l59.29"></a><span id="l59.29"> </span>
<a href="#l59.30"></a><span id="l59.30">   run_next_test();</span>
<a href="#l59.31"></a><span id="l59.31"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/chat/protocols/skype/test/test_contactUrlToName.js</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/chat/protocols/skype/test/test_contactUrlToName.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -1,27 +1,26 @@</span>
<a href="#l60.4"></a><span id="l60.4"> /* Any copyright is dedicated to the Public Domain.</span>
<a href="#l60.5"></a><span id="l60.5">  * http://creativecommons.org/publicdomain/zero/1.0/ */</span>
<a href="#l60.6"></a><span id="l60.6"> </span>
<a href="#l60.7"></a><span id="l60.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l60.8"></a><span id="l60.8" class="difflineminus">-var skype = {};</span>
<a href="#l60.9"></a><span id="l60.9" class="difflineminus">-Services.scriptloader.loadSubScript(&quot;resource:///components/skype.js&quot;, skype);</span>
<a href="#l60.10"></a><span id="l60.10" class="difflineplus">+var { contactUrlToName } = ChromeUtils.import(&quot;resource:///modules/Skype.jsm&quot;);</span>
<a href="#l60.11"></a><span id="l60.11"> </span>
<a href="#l60.12"></a><span id="l60.12"> var data = {</span>
<a href="#l60.13"></a><span id="l60.13">   &quot;https://bay-client-s.gateway.messenger.live.com/v1/users/ME/contacts/8:clokep&quot;:</span>
<a href="#l60.14"></a><span id="l60.14">     &quot;clokep&quot;,</span>
<a href="#l60.15"></a><span id="l60.15">   &quot;https://bay-client-s.gateway.messenger.live.com/v1/users/8:clokep/presenceDocs/messagingService&quot;:</span>
<a href="#l60.16"></a><span id="l60.16">     &quot;clokep&quot;,</span>
<a href="#l60.17"></a><span id="l60.17"> };</span>
<a href="#l60.18"></a><span id="l60.18"> </span>
<a href="#l60.19"></a><span id="l60.19"> function run_test() {</span>
<a href="#l60.20"></a><span id="l60.20">   add_test(test_contactUrlToName);</span>
<a href="#l60.21"></a><span id="l60.21"> </span>
<a href="#l60.22"></a><span id="l60.22">   run_next_test();</span>
<a href="#l60.23"></a><span id="l60.23"> }</span>
<a href="#l60.24"></a><span id="l60.24"> </span>
<a href="#l60.25"></a><span id="l60.25"> function test_contactUrlToName() {</span>
<a href="#l60.26"></a><span id="l60.26">   for (let input in data) {</span>
<a href="#l60.27"></a><span id="l60.27" class="difflineminus">-    equal(data[input], skype.contactUrlToName(input));</span>
<a href="#l60.28"></a><span id="l60.28" class="difflineplus">+    equal(data[input], contactUrlToName(input));</span>
<a href="#l60.29"></a><span id="l60.29">   }</span>
<a href="#l60.30"></a><span id="l60.30"> </span>
<a href="#l60.31"></a><span id="l60.31">   run_next_test();</span>
<a href="#l60.32"></a><span id="l60.32"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1">rename from chat/protocols/twitter/twitter.js</span>
<a href="#l61.2"></a><span id="l61.2">rename to chat/protocols/twitter/Twitter.jsm</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineminus">--- a/chat/protocols/twitter/twitter.js</span>
<a href="#l61.4"></a><span id="l61.4" class="difflineplus">+++ b/chat/protocols/twitter/Twitter.jsm</span>
<a href="#l61.5"></a><span id="l61.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l61.6"></a><span id="l61.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l61.7"></a><span id="l61.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l61.8"></a><span id="l61.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l61.9"></a><span id="l61.9"> </span>
<a href="#l61.10"></a><span id="l61.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;TwitterProtocol&quot;];</span>
<a href="#l61.11"></a><span id="l61.11" class="difflineplus">+</span>
<a href="#l61.12"></a><span id="l61.12"> var { httpRequest, percentEncode } = ChromeUtils.import(</span>
<a href="#l61.13"></a><span id="l61.13">   &quot;resource://gre/modules/Http.jsm&quot;</span>
<a href="#l61.14"></a><span id="l61.14"> );</span>
<a href="#l61.15"></a><span id="l61.15"> var { Services } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l61.16"></a><span id="l61.16"> var {</span>
<a href="#l61.17"></a><span id="l61.17">   XPCOMUtils,</span>
<a href="#l61.18"></a><span id="l61.18">   setTimeout,</span>
<a href="#l61.19"></a><span id="l61.19">   clearTimeout,</span>
<a href="#l61.20"></a><span id="l61.20" class="difflineat">@@ -1567,12 +1569,9 @@ TwitterProtocol.prototype = {</span>
<a href="#l61.21"></a><span id="l61.21">         aMsg.split(&quot; &quot;).forEach(account.stopFollowing, account);</span>
<a href="#l61.22"></a><span id="l61.22">         return true;</span>
<a href="#l61.23"></a><span id="l61.23">       },</span>
<a href="#l61.24"></a><span id="l61.24">     },</span>
<a href="#l61.25"></a><span id="l61.25">   ],</span>
<a href="#l61.26"></a><span id="l61.26">   getAccount(aImAccount) {</span>
<a href="#l61.27"></a><span id="l61.27">     return new Account(this, aImAccount);</span>
<a href="#l61.28"></a><span id="l61.28">   },</span>
<a href="#l61.29"></a><span id="l61.29" class="difflineminus">-  classID: Components.ID(&quot;{31082ff6-1de8-422b-ab60-ca0ac0b2af13}&quot;),</span>
<a href="#l61.30"></a><span id="l61.30"> };</span>
<a href="#l61.31"></a><span id="l61.31" class="difflineminus">-</span>
<a href="#l61.32"></a><span id="l61.32" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([TwitterProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1">new file mode 100644</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineminus">--- /dev/null</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineplus">+++ b/chat/protocols/twitter/components.conf</span>
<a href="#l62.4"></a><span id="l62.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l62.5"></a><span id="l62.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l62.6"></a><span id="l62.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l62.7"></a><span id="l62.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l62.8"></a><span id="l62.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l62.9"></a><span id="l62.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l62.10"></a><span id="l62.10" class="difflineplus">+</span>
<a href="#l62.11"></a><span id="l62.11" class="difflineplus">+Classes = [</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineplus">+  {</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+    'cid': '{31082ff6-1de8-422b-ab60-ca0ac0b2af13}',</span>
<a href="#l62.14"></a><span id="l62.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/twitter;1'],</span>
<a href="#l62.15"></a><span id="l62.15" class="difflineplus">+    'jsm': 'resource:///modules/Twitter.jsm',</span>
<a href="#l62.16"></a><span id="l62.16" class="difflineplus">+    'constructor': 'TwitterProtocol',</span>
<a href="#l62.17"></a><span id="l62.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-twitter'},</span>
<a href="#l62.18"></a><span id="l62.18" class="difflineplus">+  },</span>
<a href="#l62.19"></a><span id="l62.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/chat/protocols/twitter/moz.build</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/chat/protocols/twitter/moz.build</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -1,14 +1,15 @@</span>
<a href="#l63.4"></a><span id="l63.4"> # vim: set filetype=python:</span>
<a href="#l63.5"></a><span id="l63.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l63.6"></a><span id="l63.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l63.7"></a><span id="l63.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l63.8"></a><span id="l63.8"> </span>
<a href="#l63.9"></a><span id="l63.9" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l63.10"></a><span id="l63.10" class="difflineminus">-    'twitter.js',</span>
<a href="#l63.11"></a><span id="l63.11" class="difflineminus">-    'twitter.manifest',</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+    'twitter-text.jsm',</span>
<a href="#l63.14"></a><span id="l63.14" class="difflineplus">+    'Twitter.jsm',</span>
<a href="#l63.15"></a><span id="l63.15"> ]</span>
<a href="#l63.16"></a><span id="l63.16"> </span>
<a href="#l63.17"></a><span id="l63.17" class="difflineminus">-EXTRA_JS_MODULES += [</span>
<a href="#l63.18"></a><span id="l63.18" class="difflineminus">-    'twitter-text.jsm',</span>
<a href="#l63.19"></a><span id="l63.19" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l63.20"></a><span id="l63.20" class="difflineplus">+</span>
<a href="#l63.21"></a><span id="l63.21" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l63.22"></a><span id="l63.22" class="difflineplus">+    'components.conf',</span>
<a href="#l63.23"></a><span id="l63.23"> ]</span>
<a href="#l63.24"></a><span id="l63.24" class="difflineminus">-JAR_MANIFESTS += ['jar.mn']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1">deleted file mode 100644</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineminus">--- a/chat/protocols/twitter/twitter.manifest</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineplus">+++ /dev/null</span>
<a href="#l64.4"></a><span id="l64.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l64.5"></a><span id="l64.5" class="difflineminus">-component {31082ff6-1de8-422b-ab60-ca0ac0b2af13} twitter.js</span>
<a href="#l64.6"></a><span id="l64.6" class="difflineminus">-contract @mozilla.org/chat/twitter;1 {31082ff6-1de8-422b-ab60-ca0ac0b2af13}</span>
<a href="#l64.7"></a><span id="l64.7" class="difflineminus">-category im-protocol-plugin prpl-twitter @mozilla.org/chat/twitter;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1">rename from chat/protocols/xmpp/xmpp.js</span>
<a href="#l65.2"></a><span id="l65.2">rename to chat/protocols/xmpp/XMPPProtocol.jsm</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineminus">--- a/chat/protocols/xmpp/xmpp.js</span>
<a href="#l65.4"></a><span id="l65.4" class="difflineplus">+++ b/chat/protocols/xmpp/XMPPProtocol.jsm</span>
<a href="#l65.5"></a><span id="l65.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l65.6"></a><span id="l65.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l65.7"></a><span id="l65.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l65.8"></a><span id="l65.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l65.9"></a><span id="l65.9"> </span>
<a href="#l65.10"></a><span id="l65.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;XMPPProtocol&quot;];</span>
<a href="#l65.11"></a><span id="l65.11" class="difflineplus">+</span>
<a href="#l65.12"></a><span id="l65.12"> var { XPCOMUtils, l10nHelper } = ChromeUtils.import(</span>
<a href="#l65.13"></a><span id="l65.13">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l65.14"></a><span id="l65.14"> );</span>
<a href="#l65.15"></a><span id="l65.15"> var { GenericProtocolPrototype } = ChromeUtils.import(</span>
<a href="#l65.16"></a><span id="l65.16">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l65.17"></a><span id="l65.17"> );</span>
<a href="#l65.18"></a><span id="l65.18"> var { XMPPAccountPrototype } = ChromeUtils.import(</span>
<a href="#l65.19"></a><span id="l65.19">   &quot;resource:///modules/xmpp.jsm&quot;</span>
<a href="#l65.20"></a><span id="l65.20" class="difflineat">@@ -94,13 +96,9 @@ XMPPProtocol.prototype = {</span>
<a href="#l65.21"></a><span id="l65.21">         return _(&quot;options.connectPort&quot;);</span>
<a href="#l65.22"></a><span id="l65.22">       },</span>
<a href="#l65.23"></a><span id="l65.23">       default: 5222,</span>
<a href="#l65.24"></a><span id="l65.24">     },</span>
<a href="#l65.25"></a><span id="l65.25">   },</span>
<a href="#l65.26"></a><span id="l65.26">   get chatHasTopic() {</span>
<a href="#l65.27"></a><span id="l65.27">     return true;</span>
<a href="#l65.28"></a><span id="l65.28">   },</span>
<a href="#l65.29"></a><span id="l65.29" class="difflineminus">-</span>
<a href="#l65.30"></a><span id="l65.30" class="difflineminus">-  classID: Components.ID(&quot;{dde786d1-6f59-43d0-9bc8-b505a757fb30}&quot;),</span>
<a href="#l65.31"></a><span id="l65.31"> };</span>
<a href="#l65.32"></a><span id="l65.32" class="difflineminus">-</span>
<a href="#l65.33"></a><span id="l65.33" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([XMPPProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1">new file mode 100644</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineminus">--- /dev/null</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineplus">+++ b/chat/protocols/xmpp/components.conf</span>
<a href="#l66.4"></a><span id="l66.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l66.5"></a><span id="l66.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l66.6"></a><span id="l66.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l66.7"></a><span id="l66.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l66.8"></a><span id="l66.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l66.9"></a><span id="l66.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l66.10"></a><span id="l66.10" class="difflineplus">+</span>
<a href="#l66.11"></a><span id="l66.11" class="difflineplus">+Classes = [</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineplus">+  {</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+    'cid': '{dde786d1-6f59-43d0-9bc8-b505a757fb30}',</span>
<a href="#l66.14"></a><span id="l66.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/xmpp;1'],</span>
<a href="#l66.15"></a><span id="l66.15" class="difflineplus">+    'jsm': 'resource:///modules/XMPPProtocol.jsm',</span>
<a href="#l66.16"></a><span id="l66.16" class="difflineplus">+    'constructor': 'XMPPProtocol',</span>
<a href="#l66.17"></a><span id="l66.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-jabber'},</span>
<a href="#l66.18"></a><span id="l66.18" class="difflineplus">+  },</span>
<a href="#l66.19"></a><span id="l66.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/chat/protocols/xmpp/moz.build</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/chat/protocols/xmpp/moz.build</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -1,21 +1,21 @@</span>
<a href="#l67.4"></a><span id="l67.4"> # vim: set filetype=python:</span>
<a href="#l67.5"></a><span id="l67.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l67.6"></a><span id="l67.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l67.7"></a><span id="l67.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l67.8"></a><span id="l67.8"> </span>
<a href="#l67.9"></a><span id="l67.9"> XPCSHELL_TESTS_MANIFESTS += ['test/xpcshell.ini']</span>
<a href="#l67.10"></a><span id="l67.10"> </span>
<a href="#l67.11"></a><span id="l67.11" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-    'xmpp.js',</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineminus">-    'xmpp.manifest',</span>
<a href="#l67.14"></a><span id="l67.14" class="difflineminus">-]</span>
<a href="#l67.15"></a><span id="l67.15" class="difflineminus">-</span>
<a href="#l67.16"></a><span id="l67.16"> EXTRA_JS_MODULES += [</span>
<a href="#l67.17"></a><span id="l67.17">     'xmpp-authmechs.jsm',</span>
<a href="#l67.18"></a><span id="l67.18">     'xmpp-commands.jsm',</span>
<a href="#l67.19"></a><span id="l67.19">     'xmpp-session.jsm',</span>
<a href="#l67.20"></a><span id="l67.20">     'xmpp-xml.jsm',</span>
<a href="#l67.21"></a><span id="l67.21">     'xmpp.jsm',</span>
<a href="#l67.22"></a><span id="l67.22" class="difflineplus">+    'XMPPProtocol.jsm',</span>
<a href="#l67.23"></a><span id="l67.23"> ]</span>
<a href="#l67.24"></a><span id="l67.24"> </span>
<a href="#l67.25"></a><span id="l67.25"> JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l67.26"></a><span id="l67.26" class="difflineplus">+</span>
<a href="#l67.27"></a><span id="l67.27" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l67.28"></a><span id="l67.28" class="difflineplus">+    'components.conf',</span>
<a href="#l67.29"></a><span id="l67.29" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1">deleted file mode 100644</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineminus">--- a/chat/protocols/xmpp/xmpp.manifest</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineplus">+++ /dev/null</span>
<a href="#l68.4"></a><span id="l68.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l68.5"></a><span id="l68.5" class="difflineminus">-component {dde786d1-6f59-43d0-9bc8-b505a757fb30} xmpp.js</span>
<a href="#l68.6"></a><span id="l68.6" class="difflineminus">-contract @mozilla.org/chat/xmpp;1 {dde786d1-6f59-43d0-9bc8-b505a757fb30}</span>
<a href="#l68.7"></a><span id="l68.7" class="difflineminus">-category im-protocol-plugin prpl-jabber @mozilla.org/chat/xmpp;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1">rename from chat/protocols/yahoo/yahoo.js</span>
<a href="#l69.2"></a><span id="l69.2">rename to chat/protocols/yahoo/Yahoo.jsm</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineminus">--- a/chat/protocols/yahoo/yahoo.js</span>
<a href="#l69.4"></a><span id="l69.4" class="difflineplus">+++ b/chat/protocols/yahoo/Yahoo.jsm</span>
<a href="#l69.5"></a><span id="l69.5" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l69.6"></a><span id="l69.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l69.7"></a><span id="l69.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l69.8"></a><span id="l69.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l69.9"></a><span id="l69.9"> </span>
<a href="#l69.10"></a><span id="l69.10" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;YahooProtocol&quot;];</span>
<a href="#l69.11"></a><span id="l69.11" class="difflineplus">+</span>
<a href="#l69.12"></a><span id="l69.12"> var { XPCOMUtils, l10nHelper } = ChromeUtils.import(</span>
<a href="#l69.13"></a><span id="l69.13">   &quot;resource:///modules/imXPCOMUtils.jsm&quot;</span>
<a href="#l69.14"></a><span id="l69.14"> );</span>
<a href="#l69.15"></a><span id="l69.15"> var { GenericAccountPrototype, GenericProtocolPrototype } = ChromeUtils.import(</span>
<a href="#l69.16"></a><span id="l69.16">   &quot;resource:///modules/jsProtoHelper.jsm&quot;</span>
<a href="#l69.17"></a><span id="l69.17"> );</span>
<a href="#l69.18"></a><span id="l69.18"> </span>
<a href="#l69.19"></a><span id="l69.19"> XPCOMUtils.defineLazyGetter(this, &quot;_&quot;, () =&gt;</span>
<a href="#l69.20"></a><span id="l69.20" class="difflineat">@@ -46,12 +48,9 @@ YahooProtocol.prototype = {</span>
<a href="#l69.21"></a><span id="l69.21">     return &quot;Yahoo&quot;;</span>
<a href="#l69.22"></a><span id="l69.22">   },</span>
<a href="#l69.23"></a><span id="l69.23">   get iconBaseURI() {</span>
<a href="#l69.24"></a><span id="l69.24">     return &quot;chrome://prpl-yahoo/skin/&quot;;</span>
<a href="#l69.25"></a><span id="l69.25">   },</span>
<a href="#l69.26"></a><span id="l69.26">   getAccount(aImAccount) {</span>
<a href="#l69.27"></a><span id="l69.27">     return new YahooAccount(this, aImAccount);</span>
<a href="#l69.28"></a><span id="l69.28">   },</span>
<a href="#l69.29"></a><span id="l69.29" class="difflineminus">-  classID: Components.ID(&quot;{50ea817e-5d79-4657-91ae-aa0a52bdb98c}&quot;),</span>
<a href="#l69.30"></a><span id="l69.30"> };</span>
<a href="#l69.31"></a><span id="l69.31" class="difflineminus">-</span>
<a href="#l69.32"></a><span id="l69.32" class="difflineminus">-var NSGetFactory = XPCOMUtils.generateNSGetFactory([YahooProtocol]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1">new file mode 100644</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineminus">--- /dev/null</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineplus">+++ b/chat/protocols/yahoo/components.conf</span>
<a href="#l70.4"></a><span id="l70.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l70.5"></a><span id="l70.5" class="difflineplus">+# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l70.6"></a><span id="l70.6" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l70.7"></a><span id="l70.7" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l70.8"></a><span id="l70.8" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l70.9"></a><span id="l70.9" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l70.10"></a><span id="l70.10" class="difflineplus">+</span>
<a href="#l70.11"></a><span id="l70.11" class="difflineplus">+Classes = [</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineplus">+  {</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+    'cid': '{50ea817e-5d79-4657-91ae-aa0a52bdb98c}',</span>
<a href="#l70.14"></a><span id="l70.14" class="difflineplus">+    'contract_ids': ['@mozilla.org/chat/yahoo;1'],</span>
<a href="#l70.15"></a><span id="l70.15" class="difflineplus">+    'jsm': 'resource:///modules/Yahoo.jsm',</span>
<a href="#l70.16"></a><span id="l70.16" class="difflineplus">+    'constructor': 'YahooProtocol',</span>
<a href="#l70.17"></a><span id="l70.17" class="difflineplus">+    'categories': {'im-protocol-plugin': 'prpl-yahoo'},</span>
<a href="#l70.18"></a><span id="l70.18" class="difflineplus">+  },</span>
<a href="#l70.19"></a><span id="l70.19" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/chat/protocols/yahoo/moz.build</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/chat/protocols/yahoo/moz.build</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -1,11 +1,14 @@</span>
<a href="#l71.4"></a><span id="l71.4"> # vim: set filetype=python:</span>
<a href="#l71.5"></a><span id="l71.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l71.6"></a><span id="l71.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l71.7"></a><span id="l71.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l71.8"></a><span id="l71.8"> </span>
<a href="#l71.9"></a><span id="l71.9" class="difflineminus">-EXTRA_COMPONENTS += [</span>
<a href="#l71.10"></a><span id="l71.10" class="difflineminus">-    'yahoo.js',</span>
<a href="#l71.11"></a><span id="l71.11" class="difflineminus">-    'yahoo.manifest',</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+</span>
<a href="#l71.14"></a><span id="l71.14" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l71.15"></a><span id="l71.15" class="difflineplus">+    'Yahoo.jsm',</span>
<a href="#l71.16"></a><span id="l71.16"> ]</span>
<a href="#l71.17"></a><span id="l71.17"> </span>
<a href="#l71.18"></a><span id="l71.18" class="difflineminus">-JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l71.19"></a><span id="l71.19" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l71.20"></a><span id="l71.20" class="difflineplus">+    'components.conf',</span>
<a href="#l71.21"></a><span id="l71.21" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1">deleted file mode 100644</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineminus">--- a/chat/protocols/yahoo/yahoo.manifest</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineplus">+++ /dev/null</span>
<a href="#l72.4"></a><span id="l72.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l72.5"></a><span id="l72.5" class="difflineminus">-component {50ea817e-5d79-4657-91ae-aa0a52bdb98c} yahoo.js</span>
<a href="#l72.6"></a><span id="l72.6" class="difflineminus">-contract @mozilla.org/chat/yahoo;1 {50ea817e-5d79-4657-91ae-aa0a52bdb98c}</span>
<a href="#l72.7"></a><span id="l72.7" class="difflineminus">-category im-protocol-plugin prpl-yahoo @mozilla.org/chat/yahoo;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/mail/installer/package-manifest.in</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/mail/installer/package-manifest.in</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -242,48 +242,16 @@</span>
<a href="#l73.4"></a><span id="l73.4"> @RESPATH@/components/smime-service.manifest</span>
<a href="#l73.5"></a><span id="l73.5"> </span>
<a href="#l73.6"></a><span id="l73.6"> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<a href="#l73.7"></a><span id="l73.7"> ; instant messaging</span>
<a href="#l73.8"></a><span id="l73.8"> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<a href="#l73.9"></a><span id="l73.9"> @RESPATH@/@PREF_DIR@/chat-prefs.js</span>
<a href="#l73.10"></a><span id="l73.10"> @RESPATH@/chrome/chat@JAREXT@</span>
<a href="#l73.11"></a><span id="l73.11"> @RESPATH@/chrome/chat.manifest</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-@RESPATH@/components/imAccounts.js</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineminus">-@RESPATH@/components/imAccounts.manifest</span>
<a href="#l73.14"></a><span id="l73.14" class="difflineminus">-@RESPATH@/components/imCommands.js</span>
<a href="#l73.15"></a><span id="l73.15" class="difflineminus">-@RESPATH@/components/imCommands.manifest</span>
<a href="#l73.16"></a><span id="l73.16" class="difflineminus">-@RESPATH@/components/imContacts.js</span>
<a href="#l73.17"></a><span id="l73.17" class="difflineminus">-@RESPATH@/components/imContacts.manifest</span>
<a href="#l73.18"></a><span id="l73.18" class="difflineminus">-@RESPATH@/components/imConversations.js</span>
<a href="#l73.19"></a><span id="l73.19" class="difflineminus">-@RESPATH@/components/imConversations.manifest</span>
<a href="#l73.20"></a><span id="l73.20" class="difflineminus">-@RESPATH@/components/imCore.js</span>
<a href="#l73.21"></a><span id="l73.21" class="difflineminus">-@RESPATH@/components/imCore.manifest</span>
<a href="#l73.22"></a><span id="l73.22" class="difflineminus">-@RESPATH@/components/facebook.js</span>
<a href="#l73.23"></a><span id="l73.23" class="difflineminus">-@RESPATH@/components/facebook.manifest</span>
<a href="#l73.24"></a><span id="l73.24" class="difflineminus">-@RESPATH@/components/gtalk.js</span>
<a href="#l73.25"></a><span id="l73.25" class="difflineminus">-@RESPATH@/components/gtalk.manifest</span>
<a href="#l73.26"></a><span id="l73.26" class="difflineminus">-@RESPATH@/components/irc.js</span>
<a href="#l73.27"></a><span id="l73.27" class="difflineminus">-@RESPATH@/components/irc.manifest</span>
<a href="#l73.28"></a><span id="l73.28" class="difflineminus">-@RESPATH@/components/matrix.js</span>
<a href="#l73.29"></a><span id="l73.29" class="difflineminus">-@RESPATH@/components/matrix.manifest</span>
<a href="#l73.30"></a><span id="l73.30" class="difflineminus">-@RESPATH@/components/odnoklassniki.js</span>
<a href="#l73.31"></a><span id="l73.31" class="difflineminus">-@RESPATH@/components/odnoklassniki.manifest</span>
<a href="#l73.32"></a><span id="l73.32" class="difflineminus">-@RESPATH@/components/skype.js</span>
<a href="#l73.33"></a><span id="l73.33" class="difflineminus">-@RESPATH@/components/skype.manifest</span>
<a href="#l73.34"></a><span id="l73.34" class="difflineminus">-@RESPATH@/components/twitter.js</span>
<a href="#l73.35"></a><span id="l73.35" class="difflineminus">-@RESPATH@/components/twitter.manifest</span>
<a href="#l73.36"></a><span id="l73.36" class="difflineminus">-@RESPATH@/components/xmpp.js</span>
<a href="#l73.37"></a><span id="l73.37" class="difflineminus">-@RESPATH@/components/xmpp.manifest</span>
<a href="#l73.38"></a><span id="l73.38" class="difflineminus">-@RESPATH@/components/yahoo.js</span>
<a href="#l73.39"></a><span id="l73.39" class="difflineminus">-@RESPATH@/components/yahoo.manifest</span>
<a href="#l73.40"></a><span id="l73.40" class="difflineminus">-@RESPATH@/components/smileProtocolHandler.js</span>
<a href="#l73.41"></a><span id="l73.41" class="difflineminus">-@RESPATH@/components/smileProtocolHandler.manifest</span>
<a href="#l73.42"></a><span id="l73.42" class="difflineminus">-@RESPATH@/components/logger.js</span>
<a href="#l73.43"></a><span id="l73.43" class="difflineminus">-@RESPATH@/components/logger.manifest</span>
<a href="#l73.44"></a><span id="l73.44"> </span>
<a href="#l73.45"></a><span id="l73.45"> ; Thunderbird specific</span>
<a href="#l73.46"></a><span id="l73.46"> @RESPATH@/@PREF_DIR@/all-im.js</span>
<a href="#l73.47"></a><span id="l73.47"> </span>
<a href="#l73.48"></a><span id="l73.48"> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<a href="#l73.49"></a><span id="l73.49"> ; Chrome Files</span>
<a href="#l73.50"></a><span id="l73.50"> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<a href="#l73.51"></a><span id="l73.51"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

