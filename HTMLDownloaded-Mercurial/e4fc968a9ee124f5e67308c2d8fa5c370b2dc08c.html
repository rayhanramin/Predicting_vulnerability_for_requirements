<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 1619:e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c" />
<meta property="og:url" content="/comm-central/rev/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c" />
<meta property="og:description" content="Bug 470182 (Thunderbird Win32 only) - Create separate log file for shortcuts. r=philringnalda" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">shortlog</a> |
<a href="/comm-central/log/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">files</a> |
changeset |
<a href="/comm-central/raw-rev/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">raw</a>  | <a href="/comm-central/archive/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470182">Bug 470182</a> (Thunderbird Win32 only) - Create separate log file for shortcuts. r=philringnalda
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#82;&#111;&#98;&#101;&#114;&#116;&#32;&#83;&#116;&#114;&#111;&#110;&#103;&#32;&#60;&#114;&#111;&#98;&#101;&#114;&#116;&#46;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 13 Jan 2009 00:03:29 -0800</td></tr>

<tr>
 <td>changeset 1619</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c</a></td>
</tr>



<tr>
<td>parent 1618</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/30975188e0f422f54d6e8651977463d9a5d4bd38">30975188e0f422f54d6e8651977463d9a5d4bd38</a>
</td>
</tr>

<tr>
<td>child 1620</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/2eb04c5e52fb14448d758f2677f43d1f7c5dc98c">2eb04c5e52fb14448d758f2677f43d1f7c5dc98c</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c">1299</a></td></tr>
<tr><td>push user</td><td>rstrong@mozilla.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 13 Jan 2009 08:06:41 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@306be9e163b0 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=306be9e163b0b3a26e9b225a234616790f8df844">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=306be9e163b0b3a26e9b225a234616790f8df844&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=306be9e163b0b3a26e9b225a234616790f8df844&newProject=comm-central&newRevision=30975188e0f422f54d6e8651977463d9a5d4bd38&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=306be9e163b0b3a26e9b225a234616790f8df844&newProject=comm-central&newRevision=30975188e0f422f54d6e8651977463d9a5d4bd38&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=306be9e163b0b3a26e9b225a234616790f8df844&newProject=comm-central&newRevision=30975188e0f422f54d6e8651977463d9a5d4bd38&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philringnalda%29&revcount=50">philringnalda</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470182">470182</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470182">Bug 470182</a> (Thunderbird Win32 only) - Create separate log file for shortcuts. r=philringnalda</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/installer.nsi">mail/installer/windows/nsis/installer.nsi</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/installer.nsi">file</a> |
<a href="/comm-central/annotate/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/installer.nsi">annotate</a> |
<a href="/comm-central/diff/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/installer.nsi">diff</a> |
<a href="/comm-central/comparison/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/installer.nsi">comparison</a> |
<a href="/comm-central/log/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/installer.nsi">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/shared.nsh">mail/installer/windows/nsis/shared.nsh</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/shared.nsh">file</a> |
<a href="/comm-central/annotate/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/shared.nsh">annotate</a> |
<a href="/comm-central/diff/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/shared.nsh">diff</a> |
<a href="/comm-central/comparison/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/shared.nsh">comparison</a> |
<a href="/comm-central/log/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/shared.nsh">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/uninstaller.nsi">mail/installer/windows/nsis/uninstaller.nsi</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/uninstaller.nsi">file</a> |
<a href="/comm-central/annotate/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/uninstaller.nsi">annotate</a> |
<a href="/comm-central/diff/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/uninstaller.nsi">diff</a> |
<a href="/comm-central/comparison/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/uninstaller.nsi">comparison</a> |
<a href="/comm-central/log/e4fc968a9ee124f5e67308c2d8fa5c370b2dc08c/mail/installer/windows/nsis/uninstaller.nsi">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/installer/windows/nsis/installer.nsi</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/installer/windows/nsis/installer.nsi</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -48,25 +48,16 @@</span>
<a href="#l1.4"></a><span id="l1.4"> SetDatablockOptimize on</span>
<a href="#l1.5"></a><span id="l1.5"> SetCompress off</span>
<a href="#l1.6"></a><span id="l1.6"> CRCCheck on</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> RequestExecutionLevel user</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> !addplugindir ./</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-; empty files - except for the comment line - for generating custom pages.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-!system 'echo ; &gt; options.ini'</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-!system 'echo ; &gt; shortcuts.ini'</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-!system 'echo ; &gt; summary.ini'</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-; USE_UAC_PLUGIN is temporary until all applications have been updated to use</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-; the UAC plugin</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-!define USE_UAC_PLUGIN</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-</span>
<a href="#l1.21"></a><span id="l1.21"> Var TmpVal</span>
<a href="#l1.22"></a><span id="l1.22"> Var StartMenuDir</span>
<a href="#l1.23"></a><span id="l1.23"> Var InstallType</span>
<a href="#l1.24"></a><span id="l1.24"> Var AddStartMenuSC</span>
<a href="#l1.25"></a><span id="l1.25"> Var AddQuickLaunchSC</span>
<a href="#l1.26"></a><span id="l1.26"> Var AddDesktopSC</span>
<a href="#l1.27"></a><span id="l1.27"> </span>
<a href="#l1.28"></a><span id="l1.28"> ; Other included files may depend upon these includes!</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineat">@@ -91,21 +82,25 @@ Var AddDesktopSC</span>
<a href="#l1.30"></a><span id="l1.30"> !include version.nsh</span>
<a href="#l1.31"></a><span id="l1.31"> </span>
<a href="#l1.32"></a><span id="l1.32"> VIAddVersionKey &quot;FileDescription&quot;  &quot;${BrandShortName} Installer&quot;</span>
<a href="#l1.33"></a><span id="l1.33"> VIAddVersionKey &quot;OriginalFilename&quot; &quot;setup.exe&quot;</span>
<a href="#l1.34"></a><span id="l1.34"> </span>
<a href="#l1.35"></a><span id="l1.35"> ; Must be inserted before other macros that use logging</span>
<a href="#l1.36"></a><span id="l1.36"> !insertmacro _LoggingCommon</span>
<a href="#l1.37"></a><span id="l1.37"> </span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+; Most commonly used macros for managing shortcuts</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+!insertmacro _LoggingShortcutsCommon</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+</span>
<a href="#l1.41"></a><span id="l1.41"> !insertmacro AddHandlerValues</span>
<a href="#l1.42"></a><span id="l1.42"> !insertmacro ChangeMUIHeaderImage</span>
<a href="#l1.43"></a><span id="l1.43"> !insertmacro CheckForFilesInUse</span>
<a href="#l1.44"></a><span id="l1.44"> !insertmacro CleanUpdatesDir</span>
<a href="#l1.45"></a><span id="l1.45"> !insertmacro CopyFilesFromDir</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineplus">+!insertmacro FindSMProgramsDir</span>
<a href="#l1.47"></a><span id="l1.47"> !insertmacro GetPathFromString</span>
<a href="#l1.48"></a><span id="l1.48"> !insertmacro GetParent</span>
<a href="#l1.49"></a><span id="l1.49"> !insertmacro IsHandlerForInstallDir</span>
<a href="#l1.50"></a><span id="l1.50"> !insertmacro ManualCloseAppPrompt</span>
<a href="#l1.51"></a><span id="l1.51"> !insertmacro RegCleanMain</span>
<a href="#l1.52"></a><span id="l1.52"> !insertmacro RegCleanUninstall</span>
<a href="#l1.53"></a><span id="l1.53"> !insertmacro SetBrandNameVars</span>
<a href="#l1.54"></a><span id="l1.54"> !insertmacro UnloadUAC</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineat">@@ -124,20 +119,16 @@ VIAddVersionKey &quot;OriginalFilename&quot; &quot;setu</span>
<a href="#l1.56"></a><span id="l1.56"> !insertmacro PreDirectoryCommon</span>
<a href="#l1.57"></a><span id="l1.57"> </span>
<a href="#l1.58"></a><span id="l1.58"> Name &quot;${BrandFullName}&quot;</span>
<a href="#l1.59"></a><span id="l1.59"> OutFile &quot;setup.exe&quot;</span>
<a href="#l1.60"></a><span id="l1.60"> InstallDirRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot; &quot;InstallLocation&quot;</span>
<a href="#l1.61"></a><span id="l1.61"> InstallDir &quot;$PROGRAMFILES\${BrandFullName}\&quot;</span>
<a href="#l1.62"></a><span id="l1.62"> ShowInstDetails nevershow</span>
<a href="#l1.63"></a><span id="l1.63"> </span>
<a href="#l1.64"></a><span id="l1.64" class="difflineminus">-ReserveFile options.ini</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineminus">-ReserveFile shortcuts.ini</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineminus">-ReserveFile summary.ini</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineminus">-</span>
<a href="#l1.68"></a><span id="l1.68"> ################################################################################</span>
<a href="#l1.69"></a><span id="l1.69"> # Modern User Interface - MUI</span>
<a href="#l1.70"></a><span id="l1.70"> </span>
<a href="#l1.71"></a><span id="l1.71"> !define MUI_ABORTWARNING</span>
<a href="#l1.72"></a><span id="l1.72"> !define MUI_ICON setup.ico</span>
<a href="#l1.73"></a><span id="l1.73"> !define MUI_UNICON setup.ico</span>
<a href="#l1.74"></a><span id="l1.74"> !define MUI_WELCOMEPAGE_TITLE_3LINES</span>
<a href="#l1.75"></a><span id="l1.75"> !define MUI_HEADERIMAGE</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineat">@@ -174,19 +165,16 @@ Page custom preOptions leaveOptions</span>
<a href="#l1.77"></a><span id="l1.77"> </span>
<a href="#l1.78"></a><span id="l1.78"> ; Custom Shortcuts Page</span>
<a href="#l1.79"></a><span id="l1.79"> Page custom preShortcuts leaveShortcuts</span>
<a href="#l1.80"></a><span id="l1.80"> </span>
<a href="#l1.81"></a><span id="l1.81"> ; Start Menu Folder Page Configuration</span>
<a href="#l1.82"></a><span id="l1.82"> !define MUI_PAGE_CUSTOMFUNCTION_PRE preStartMenu</span>
<a href="#l1.83"></a><span id="l1.83"> !define MUI_PAGE_CUSTOMFUNCTION_LEAVE leaveStartMenu</span>
<a href="#l1.84"></a><span id="l1.84"> !define MUI_STARTMENUPAGE_NODISABLE</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineminus">-!define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKLM&quot;</span>
<a href="#l1.86"></a><span id="l1.86" class="difflineminus">-!define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot;</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineminus">-!define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;</span>
<a href="#l1.88"></a><span id="l1.88"> !insertmacro MUI_PAGE_STARTMENU Application $StartMenuDir</span>
<a href="#l1.89"></a><span id="l1.89"> </span>
<a href="#l1.90"></a><span id="l1.90"> ; Custom Summary Page</span>
<a href="#l1.91"></a><span id="l1.91"> Page custom preSummary leaveSummary</span>
<a href="#l1.92"></a><span id="l1.92"> </span>
<a href="#l1.93"></a><span id="l1.93"> ; Install Files Page</span>
<a href="#l1.94"></a><span id="l1.94"> !insertmacro MUI_PAGE_INSTFILES</span>
<a href="#l1.95"></a><span id="l1.95"> </span>
<a href="#l1.96"></a><span id="l1.96" class="difflineat">@@ -278,17 +266,17 @@ Section &quot;-Application&quot; APP_IDX</span>
<a href="#l1.97"></a><span id="l1.97">   RegDLL &quot;$INSTDIR\AccessibleMarshal.dll&quot;</span>
<a href="#l1.98"></a><span id="l1.98">   ${If} ${Errors}</span>
<a href="#l1.99"></a><span id="l1.99">     ${LogMsg} &quot;** ERROR Registering: $INSTDIR\AccessibleMarshal.dll **&quot;</span>
<a href="#l1.100"></a><span id="l1.100">   ${Else}</span>
<a href="#l1.101"></a><span id="l1.101">     ${LogUninstall} &quot;DLLReg: \AccessibleMarshal.dll&quot;</span>
<a href="#l1.102"></a><span id="l1.102">     ${LogMsg} &quot;Registered: $INSTDIR\AccessibleMarshal.dll&quot;</span>
<a href="#l1.103"></a><span id="l1.103">   ${EndIf}</span>
<a href="#l1.104"></a><span id="l1.104"> </span>
<a href="#l1.105"></a><span id="l1.105" class="difflineminus">-  ; Write extra files created by the application to the uninstall.log so they</span>
<a href="#l1.106"></a><span id="l1.106" class="difflineplus">+  ; Write extra files created by the application to the uninstall log so they</span>
<a href="#l1.107"></a><span id="l1.107">   ; will be removed when the application is uninstalled. To remove an empty</span>
<a href="#l1.108"></a><span id="l1.108">   ; directory write a bogus filename to the deepest directory and all empty</span>
<a href="#l1.109"></a><span id="l1.109">   ; parent directories will be removed.</span>
<a href="#l1.110"></a><span id="l1.110">   ${LogUninstall} &quot;File: \components\compreg.dat&quot;</span>
<a href="#l1.111"></a><span id="l1.111">   ${LogUninstall} &quot;File: \components\xpti.dat&quot;</span>
<a href="#l1.112"></a><span id="l1.112">   ${LogUninstall} &quot;File: \.autoreg&quot;</span>
<a href="#l1.113"></a><span id="l1.113">   ${LogUninstall} &quot;File: \active-update.xml&quot;</span>
<a href="#l1.114"></a><span id="l1.114">   ${LogUninstall} &quot;File: \install.log&quot;</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineat">@@ -347,28 +335,31 @@ Section &quot;-Application&quot; APP_IDX</span>
<a href="#l1.116"></a><span id="l1.116"> </span>
<a href="#l1.117"></a><span id="l1.117">   ; The order that reg keys and values are added is important if you use the</span>
<a href="#l1.118"></a><span id="l1.118">   ; uninstall log to remove them on uninstall. When using the uninstall log you</span>
<a href="#l1.119"></a><span id="l1.119">   ; MUST add children first so they will be removed first on uninstall so they</span>
<a href="#l1.120"></a><span id="l1.120">   ; will be empty when the key is deleted. This allows the uninstaller to</span>
<a href="#l1.121"></a><span id="l1.121">   ; specify that only empty keys will be deleted.</span>
<a href="#l1.122"></a><span id="l1.122">   ${SetAppKeys}</span>
<a href="#l1.123"></a><span id="l1.123"> </span>
<a href="#l1.124"></a><span id="l1.124" class="difflineminus">-  ; XXXrstrong - this should be set in shared.nsh along with &quot;Create Quick</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineminus">-  ; Launch Shortcut&quot; and Create Desktop Shortcut.</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Uninstall&quot;</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineminus">-  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Start Menu Shortcut&quot; $AddStartMenuSC 0</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineminus">-</span>
<a href="#l1.129"></a><span id="l1.129">   ; On install always add the ThunderbirdEML, Thunderbird.Url.mailto, and</span>
<a href="#l1.130"></a><span id="l1.130">   ; Thunderbird.Url.news keys.</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineminus">-  ${AddHandlerValues} &quot;$0\ThunderbirdEML&quot;  &quot;$2&quot; &quot;$8,0&quot; \</span>
<a href="#l1.132"></a><span id="l1.132" class="difflineplus">+  ${GetLongPath} &quot;$INSTDIR\${FileMainEXE}&quot; $8</span>
<a href="#l1.133"></a><span id="l1.133" class="difflineplus">+  StrCpy $0 &quot;SOFTWARE\Classes&quot;</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineplus">+  StrCpy $1 &quot;$\&quot;$8$\&quot; $\&quot;%1$\&quot;&quot;</span>
<a href="#l1.135"></a><span id="l1.135" class="difflineplus">+  StrCpy $2 &quot;$\&quot;$8$\&quot; -osint -compose $\&quot;%1$\&quot;&quot;</span>
<a href="#l1.136"></a><span id="l1.136" class="difflineplus">+  StrCpy $3 &quot;$\&quot;$8$\&quot; -osint -mail $\&quot;%1$\&quot;&quot;</span>
<a href="#l1.137"></a><span id="l1.137" class="difflineplus">+</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineplus">+  ; An empty string is used for the 5th param because ThunderbirdEML is not a</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineplus">+  ; protocol handler</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineplus">+  ${AddHandlerValues} &quot;$0\ThunderbirdEML&quot;  &quot;$1&quot; &quot;$8,0&quot; \</span>
<a href="#l1.141"></a><span id="l1.141">                       &quot;${AppRegNameMail} Document&quot; &quot;&quot; &quot;&quot;</span>
<a href="#l1.142"></a><span id="l1.142" class="difflineminus">-  ${AddHandlerValues} &quot;$0\Thunderbird.Url.mailto&quot;  &quot;$3&quot; &quot;$8,0&quot; \</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineplus">+  ${AddHandlerValues} &quot;$0\Thunderbird.Url.mailto&quot;  &quot;$2&quot; &quot;$8,0&quot; \</span>
<a href="#l1.144"></a><span id="l1.144">                       &quot;${AppRegNameMail} URL&quot; &quot;true&quot; &quot;&quot;</span>
<a href="#l1.145"></a><span id="l1.145" class="difflineminus">-  ${AddHandlerValues} &quot;$0\Thunderbird.Url.news&quot; &quot;$2&quot; &quot;$8,0&quot; \</span>
<a href="#l1.146"></a><span id="l1.146" class="difflineplus">+  ${AddHandlerValues} &quot;$0\Thunderbird.Url.news&quot; &quot;$3&quot; &quot;$8,0&quot; \</span>
<a href="#l1.147"></a><span id="l1.147">                       &quot;${AppRegNameNews} URL&quot; &quot;true&quot; &quot;&quot;</span>
<a href="#l1.148"></a><span id="l1.148"> </span>
<a href="#l1.149"></a><span id="l1.149">   ; The following keys should only be set if we can write to HKLM</span>
<a href="#l1.150"></a><span id="l1.150">   ${If} $TmpVal == &quot;HKLM&quot;</span>
<a href="#l1.151"></a><span id="l1.151">     ; Uninstall keys can only exist under HKLM on some versions of windows.</span>
<a href="#l1.152"></a><span id="l1.152">     ${SetUninstallKeys}</span>
<a href="#l1.153"></a><span id="l1.153"> </span>
<a href="#l1.154"></a><span id="l1.154">     ; Set the Start Menu Internet and Vista Registered App HKLM registry keys.</span>
<a href="#l1.155"></a><span id="l1.155" class="difflineat">@@ -389,41 +380,48 @@ Section &quot;-Application&quot; APP_IDX</span>
<a href="#l1.156"></a><span id="l1.156">   ; These need special handling on uninstall since they may be overwritten by</span>
<a href="#l1.157"></a><span id="l1.157">   ; an install into a different location.</span>
<a href="#l1.158"></a><span id="l1.158">   StrCpy $0 &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\${FileMainEXE}&quot;</span>
<a href="#l1.159"></a><span id="l1.159">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.160"></a><span id="l1.160">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Path&quot; &quot;$INSTDIR&quot; 0</span>
<a href="#l1.161"></a><span id="l1.161"> </span>
<a href="#l1.162"></a><span id="l1.162">   !insertmacro MUI_STARTMENU_WRITE_BEGIN Application</span>
<a href="#l1.163"></a><span id="l1.163"> </span>
<a href="#l1.164"></a><span id="l1.164" class="difflineminus">-  ; Create Start Menu shortcuts</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineplus">+  ; Create shortcuts</span>
<a href="#l1.166"></a><span id="l1.166">   ${LogHeader} &quot;Adding Shortcuts&quot;</span>
<a href="#l1.167"></a><span id="l1.167" class="difflineplus">+</span>
<a href="#l1.168"></a><span id="l1.168" class="difflineplus">+  ; Always add the relative path to the application's Start Menu directory and</span>
<a href="#l1.169"></a><span id="l1.169" class="difflineplus">+  ; the application's shortcuts to the shortcuts log ini file. The</span>
<a href="#l1.170"></a><span id="l1.170" class="difflineplus">+  ; DeleteShortcuts macro will do the right thing on uninstall if they don't</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineplus">+  ; exist.</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineplus">+  ${LogSMProgramsDirRelPath} &quot;$StartMenuDir&quot;</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineplus">+  ${LogSMProgramsShortcut} &quot;${BrandFullName}.lnk&quot;</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineplus">+  ${LogSMProgramsShortcut} &quot;${BrandFullName} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l1.175"></a><span id="l1.175" class="difflineplus">+  ${LogQuickLaunchShortcut} &quot;${BrandFullName}.lnk&quot;</span>
<a href="#l1.176"></a><span id="l1.176" class="difflineplus">+  ${LogDesktopShortcut} &quot;${BrandFullName}.lnk&quot;</span>
<a href="#l1.177"></a><span id="l1.177" class="difflineplus">+</span>
<a href="#l1.178"></a><span id="l1.178">   ${If} $AddStartMenuSC == 1</span>
<a href="#l1.179"></a><span id="l1.179">     ${Unless} ${FileExists} &quot;$SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l1.180"></a><span id="l1.180">       CreateDirectory &quot;$SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l1.181"></a><span id="l1.181">       ${LogMsg} &quot;Added Start Menu Directory: $SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l1.182"></a><span id="l1.182">     ${EndUnless}</span>
<a href="#l1.183"></a><span id="l1.183" class="difflineminus">-    CreateShortCut &quot;$SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.184"></a><span id="l1.184" class="difflineminus">-    ${LogUninstall} &quot;File: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal}.lnk&quot;</span>
<a href="#l1.185"></a><span id="l1.185" class="difflineminus">-    ${LogMsg} &quot;Added Shortcut: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal}.lnk&quot;</span>
<a href="#l1.186"></a><span id="l1.186" class="difflineminus">-    CreateShortCut &quot;$SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal} ($(SAFE_MODE)).lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;-safe-mode&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.187"></a><span id="l1.187" class="difflineminus">-    ${LogUninstall} &quot;File: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l1.188"></a><span id="l1.188" class="difflineminus">-    ${LogMsg} &quot;Added Shortcut: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l1.189"></a><span id="l1.189" class="difflineplus">+    CreateShortCut &quot;$SMPROGRAMS\$StartMenuDir\${BrandFullName}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.190"></a><span id="l1.190" class="difflineplus">+    ${LogMsg} &quot;Added Shortcut: $SMPROGRAMS\$StartMenuDir\${BrandFullName}.lnk&quot;</span>
<a href="#l1.191"></a><span id="l1.191" class="difflineplus">+    CreateShortCut &quot;$SMPROGRAMS\$StartMenuDir\${BrandFullName} ($(SAFE_MODE)).lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;-safe-mode&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.192"></a><span id="l1.192" class="difflineplus">+    ${LogMsg} &quot;Added Shortcut: $SMPROGRAMS\$StartMenuDir\${BrandFullName} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l1.193"></a><span id="l1.193">   ${EndIf}</span>
<a href="#l1.194"></a><span id="l1.194"> </span>
<a href="#l1.195"></a><span id="l1.195">   ; perhaps use the uninstall keys</span>
<a href="#l1.196"></a><span id="l1.196">   ${If} $AddQuickLaunchSC == 1</span>
<a href="#l1.197"></a><span id="l1.197">     CreateShortCut &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineminus">-    ${LogUninstall} &quot;File: $QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l1.199"></a><span id="l1.199">     ${LogMsg} &quot;Added Shortcut: $QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l1.200"></a><span id="l1.200">   ${EndIf}</span>
<a href="#l1.201"></a><span id="l1.201"> </span>
<a href="#l1.202"></a><span id="l1.202">   ${If} $AddDesktopSC == 1</span>
<a href="#l1.203"></a><span id="l1.203">     CreateShortCut &quot;$DESKTOP\${BrandFullName}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineminus">-    ${LogUninstall} &quot;File: $DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l1.205"></a><span id="l1.205">     ${LogMsg} &quot;Added Shortcut: $DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l1.206"></a><span id="l1.206">   ${EndIf}</span>
<a href="#l1.207"></a><span id="l1.207"> </span>
<a href="#l1.208"></a><span id="l1.208">   !insertmacro MUI_STARTMENU_WRITE_END</span>
<a href="#l1.209"></a><span id="l1.209"> SectionEnd</span>
<a href="#l1.210"></a><span id="l1.210"> </span>
<a href="#l1.211"></a><span id="l1.211"> ; Cleanup operations to perform at the end of the installation.</span>
<a href="#l1.212"></a><span id="l1.212"> Section &quot;-InstallEndCleanup&quot;</span>
<a href="#l1.213"></a><span id="l1.213" class="difflineat">@@ -625,16 +623,42 @@ Function leaveShortcuts</span>
<a href="#l1.214"></a><span id="l1.214">     Abort</span>
<a href="#l1.215"></a><span id="l1.215">   ${EndIf}</span>
<a href="#l1.216"></a><span id="l1.216">   ${MUI_INSTALLOPTIONS_READ} $AddDesktopSC &quot;shortcuts.ini&quot; &quot;Field 2&quot; &quot;State&quot;</span>
<a href="#l1.217"></a><span id="l1.217">   ${MUI_INSTALLOPTIONS_READ} $AddStartMenuSC &quot;shortcuts.ini&quot; &quot;Field 3&quot; &quot;State&quot;</span>
<a href="#l1.218"></a><span id="l1.218">   ${MUI_INSTALLOPTIONS_READ} $AddQuickLaunchSC &quot;shortcuts.ini&quot; &quot;Field 4&quot; &quot;State&quot;</span>
<a href="#l1.219"></a><span id="l1.219"> FunctionEnd</span>
<a href="#l1.220"></a><span id="l1.220"> </span>
<a href="#l1.221"></a><span id="l1.221"> Function preStartMenu</span>
<a href="#l1.222"></a><span id="l1.222" class="difflineplus">+  ; With the Unicode installer the path to the application's Start Menu</span>
<a href="#l1.223"></a><span id="l1.223" class="difflineplus">+  ; directory relative to the Start Menu's Programs directory is written to the</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineplus">+  ; shortcuts log ini file and is used to set the default Start Menu directory.</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineplus">+  ${GetSMProgramsDirRelPath} $0</span>
<a href="#l1.226"></a><span id="l1.226" class="difflineplus">+  ${If} &quot;$0&quot; != &quot;&quot;</span>
<a href="#l1.227"></a><span id="l1.227" class="difflineplus">+    StrCpy $StartMenuDir &quot;$0&quot;</span>
<a href="#l1.228"></a><span id="l1.228" class="difflineplus">+  ${Else}</span>
<a href="#l1.229"></a><span id="l1.229" class="difflineplus">+    ; Prior to the Unicode installer the path to the application's Start Menu</span>
<a href="#l1.230"></a><span id="l1.230" class="difflineplus">+    ; directory relative to the Start Menu's Programs directory was written to</span>
<a href="#l1.231"></a><span id="l1.231" class="difflineplus">+    ; the registry and use this value to set the default Start Menu directory.</span>
<a href="#l1.232"></a><span id="l1.232" class="difflineplus">+    ClearErrors</span>
<a href="#l1.233"></a><span id="l1.233" class="difflineplus">+    ReadRegStr $0 HKLM &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot; &quot;Start Menu Folder&quot;</span>
<a href="#l1.234"></a><span id="l1.234" class="difflineplus">+    ${If} ${Errors}</span>
<a href="#l1.235"></a><span id="l1.235" class="difflineplus">+      ; Use the FindSMProgramsDir macro to find a previously used path to the</span>
<a href="#l1.236"></a><span id="l1.236" class="difflineplus">+      ; application's Start Menu directory relative to the Start Menu's Programs</span>
<a href="#l1.237"></a><span id="l1.237" class="difflineplus">+      ; directory in the uninstall log and use this value to set the default</span>
<a href="#l1.238"></a><span id="l1.238" class="difflineplus">+      ; Start Menu directory.</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineplus">+      ${FindSMProgramsDir} $0</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineplus">+      ${If} &quot;$0&quot; != &quot;&quot;</span>
<a href="#l1.241"></a><span id="l1.241" class="difflineplus">+        StrCpy $StartMenuDir &quot;$0&quot;</span>
<a href="#l1.242"></a><span id="l1.242" class="difflineplus">+      ${EndIf}</span>
<a href="#l1.243"></a><span id="l1.243" class="difflineplus">+    ${Else}</span>
<a href="#l1.244"></a><span id="l1.244" class="difflineplus">+      StrCpy $StartMenuDir &quot;$0&quot;</span>
<a href="#l1.245"></a><span id="l1.245" class="difflineplus">+    ${EndUnless}</span>
<a href="#l1.246"></a><span id="l1.246" class="difflineplus">+  ${EndIf}</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineplus">+</span>
<a href="#l1.248"></a><span id="l1.248">   ${CheckCustomCommon}</span>
<a href="#l1.249"></a><span id="l1.249">   ${If} $AddStartMenuSC != 1</span>
<a href="#l1.250"></a><span id="l1.250">     Abort</span>
<a href="#l1.251"></a><span id="l1.251">   ${EndIf}</span>
<a href="#l1.252"></a><span id="l1.252"> FunctionEnd</span>
<a href="#l1.253"></a><span id="l1.253"> </span>
<a href="#l1.254"></a><span id="l1.254"> Function leaveStartMenu</span>
<a href="#l1.255"></a><span id="l1.255">   ${If} $InstallType == ${INSTALLTYPE_CUSTOM}</span>
<a href="#l1.256"></a><span id="l1.256" class="difflineat">@@ -714,19 +738,19 @@ FunctionEnd</span>
<a href="#l1.257"></a><span id="l1.257"> # Initialization Functions</span>
<a href="#l1.258"></a><span id="l1.258"> </span>
<a href="#l1.259"></a><span id="l1.259"> Function .onInit</span>
<a href="#l1.260"></a><span id="l1.260">   StrCpy $LANGUAGE 0</span>
<a href="#l1.261"></a><span id="l1.261">   ${SetBrandNameVars} &quot;$EXEDIR\localized\distribution\setup.ini&quot;</span>
<a href="#l1.262"></a><span id="l1.262"> </span>
<a href="#l1.263"></a><span id="l1.263">   ${InstallOnInitCommon} &quot;$(WARN_MIN_SUPPORTED_OS_MSG)&quot;</span>
<a href="#l1.264"></a><span id="l1.264"> </span>
<a href="#l1.265"></a><span id="l1.265" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;options.ini&quot;</span>
<a href="#l1.266"></a><span id="l1.266" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;shortcuts.ini&quot;</span>
<a href="#l1.267"></a><span id="l1.267" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;summary.ini&quot;</span>
<a href="#l1.268"></a><span id="l1.268" class="difflineplus">+  !insertmacro InitInstallOptionsFile &quot;options.ini&quot;</span>
<a href="#l1.269"></a><span id="l1.269" class="difflineplus">+  !insertmacro InitInstallOptionsFile &quot;shortcuts.ini&quot;</span>
<a href="#l1.270"></a><span id="l1.270" class="difflineplus">+  !insertmacro InitInstallOptionsFile &quot;summary.ini&quot;</span>
<a href="#l1.271"></a><span id="l1.271"> </span>
<a href="#l1.272"></a><span id="l1.272">   ; Setup the options.ini file for the Custom Options Page</span>
<a href="#l1.273"></a><span id="l1.273">   WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Settings&quot; NumFields &quot;5&quot;</span>
<a href="#l1.274"></a><span id="l1.274"> </span>
<a href="#l1.275"></a><span id="l1.275">   WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Type   &quot;label&quot;</span>
<a href="#l1.276"></a><span id="l1.276">   WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Text   &quot;$(OPTIONS_SUMMARY)&quot;</span>
<a href="#l1.277"></a><span id="l1.277">   WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Left   &quot;0&quot;</span>
<a href="#l1.278"></a><span id="l1.278">   WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Right  &quot;-1&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/installer/windows/nsis/shared.nsh</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/installer/windows/nsis/shared.nsh</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -31,16 +31,18 @@</span>
<a href="#l2.4"></a><span id="l2.4"> # decision by deleting the provisions above and replace them with the notice</span>
<a href="#l2.5"></a><span id="l2.5"> # and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l2.6"></a><span id="l2.6"> # the provisions above, a recipient may use your version of this file under</span>
<a href="#l2.7"></a><span id="l2.7"> # the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l2.8"></a><span id="l2.8"> #</span>
<a href="#l2.9"></a><span id="l2.9"> # ***** END LICENSE BLOCK *****</span>
<a href="#l2.10"></a><span id="l2.10"> </span>
<a href="#l2.11"></a><span id="l2.11"> !macro PostUpdate</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+  ${CreateShortcutsLog}</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+</span>
<a href="#l2.14"></a><span id="l2.14">   ; Remove registry entries for non-existent apps and for apps that point to our</span>
<a href="#l2.15"></a><span id="l2.15">   ; install location in the Software\Mozilla key and uninstall registry entries</span>
<a href="#l2.16"></a><span id="l2.16">   ; that point to our install location for both HKCU and HKLM.</span>
<a href="#l2.17"></a><span id="l2.17">   SetShellVarContext current  ; Set SHCTX to the current user (e.g. HKCU)</span>
<a href="#l2.18"></a><span id="l2.18">   ${RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l2.19"></a><span id="l2.19">   ${RegCleanUninstall}</span>
<a href="#l2.20"></a><span id="l2.20">   ${UpdateProtocolHandlers}</span>
<a href="#l2.21"></a><span id="l2.21"> </span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -455,61 +457,16 @@</span>
<a href="#l2.23"></a><span id="l2.23"> </span>
<a href="#l2.24"></a><span id="l2.24"> !macro SetAppKeys</span>
<a href="#l2.25"></a><span id="l2.25">   ${GetLongPath} &quot;$INSTDIR&quot; $8</span>
<a href="#l2.26"></a><span id="l2.26">   StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot;</span>
<a href="#l2.27"></a><span id="l2.27">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Install Directory&quot; &quot;$8&quot; 0</span>
<a href="#l2.28"></a><span id="l2.28">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;PathToExe&quot; &quot;$8\${FileMainEXE}&quot; 0</span>
<a href="#l2.29"></a><span id="l2.29">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Program Folder Path&quot; &quot;$SMPROGRAMS\$StartMenuDir&quot; 0</span>
<a href="#l2.30"></a><span id="l2.30"> </span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-  SetShellVarContext all  ; Set $DESKTOP to All Users</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-  ${Unless} ${FileExists} &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">-    SetShellVarContext current  ; Set $DESKTOP to the current user's desktop</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineminus">-  ${EndUnless}</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineminus">-  ${If} ${FileExists} &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-    ShellLink::GetShortCutArgs &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineminus">-    Pop $1</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-    ${If} &quot;$1&quot; == &quot;&quot;</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-      ShellLink::GetShortCutTarget &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-      Pop $1</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineminus">-      ${GetLongPath} &quot;$1&quot; $1</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-      ${If} &quot;$1&quot; == &quot;$8\${FileMainEXE}&quot;</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Desktop Shortcut&quot; 1 0</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-      ${Else}</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">-        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Desktop Shortcut&quot; 0 0</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-      ${EndIf}</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineminus">-    ${EndIf}</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineminus">-  ${EndIf}</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineminus">-</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineminus">-  ; XXXrstrong - need a cleaner way to prevent unsetting SHCTX from HKLM when</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineminus">-  ; trying to find the desktop shortcut.</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineminus">-  ${If} &quot;$TmpVal&quot; == &quot;HKCU&quot;</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-    SetShellVarContext current ; Set SHCTX to the current user (e.g. HKCU)</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-  ${Else}</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineminus">-    SetShellVarContext all     ; Set SHCTX to all users (e.g. HKLM)</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineminus">-  ${EndIf}</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineminus">-  ${If} ${FileExists} &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineminus">-    ShellLink::GetShortCutArgs &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineminus">-    Pop $1</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineminus">-    ${If} &quot;$1&quot; == &quot;&quot;</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineminus">-      ShellLink::GetShortCutTarget &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineminus">-      Pop $1</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineminus">-      ${GetLongPath} &quot;$1&quot; $1</span>
<a href="#l2.66"></a><span id="l2.66" class="difflineminus">-      ${If} &quot;$1&quot; == &quot;$8\${FileMainEXE}&quot;</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineminus">-        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Quick Launch Shortcut&quot; 1 0</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineminus">-      ${Else}</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Quick Launch Shortcut&quot; 0 0</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineminus">-      ${EndIf}</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineminus">-    ${EndIf}</span>
<a href="#l2.72"></a><span id="l2.72" class="difflineminus">-  ${EndIf}</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineminus">-  ; XXXrstrong - &quot;Create Start Menu Shortcut&quot; and &quot;Start Menu Folder&quot; are only</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineminus">-  ; set in the installer and should also be set here for software update.</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineminus">-</span>
<a href="#l2.76"></a><span id="l2.76">   StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Uninstall&quot;</span>
<a href="#l2.77"></a><span id="l2.77">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Uninstall Log Folder&quot; &quot;$8\uninstall&quot; 0</span>
<a href="#l2.78"></a><span id="l2.78">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Description&quot; &quot;${BrandFullNameInternal} (${AppVersion})&quot; 0</span>
<a href="#l2.79"></a><span id="l2.79"> </span>
<a href="#l2.80"></a><span id="l2.80">   StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})&quot;</span>
<a href="#l2.81"></a><span id="l2.81">   ${WriteRegStr2} $TmpVal  &quot;$0&quot; &quot;&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l2.82"></a><span id="l2.82"> </span>
<a href="#l2.83"></a><span id="l2.83">   StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}\bin&quot;</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineat">@@ -650,16 +607,45 @@</span>
<a href="#l2.85"></a><span id="l2.85">   ; The Vista shim for 1.5.0.10 writes out a set of bogus keys which we need to</span>
<a href="#l2.86"></a><span id="l2.86">   ; cleanup. Intentionally hard coding Mozilla Thunderbird here</span>
<a href="#l2.87"></a><span id="l2.87">   ; as this is the string used by the vista shim.</span>
<a href="#l2.88"></a><span id="l2.88">   DeleteRegKey HKLM &quot;$0\Mozilla Thunderbird.Url.mailto&quot;</span>
<a href="#l2.89"></a><span id="l2.89">   DeleteRegValue HKLM &quot;Software\RegisteredApplications&quot; &quot;Mozilla Thunderbird&quot;</span>
<a href="#l2.90"></a><span id="l2.90"> !macroend</span>
<a href="#l2.91"></a><span id="l2.91"> !define RemoveDeprecatedKeys &quot;!insertmacro RemoveDeprecatedKeys&quot;</span>
<a href="#l2.92"></a><span id="l2.92"> </span>
<a href="#l2.93"></a><span id="l2.93" class="difflineplus">+; Creates the shortcuts log ini file with the appropriate entries if it doesn't</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineplus">+; already exist.</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineplus">+!macro CreateShortcutsLog</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineplus">+  ${GetShortcutsLogPath} $0</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineplus">+  ${Unless} ${FileExists} &quot;$0&quot;</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineplus">+    ; Default to ${BrandFullName} for the Start Menu Folder</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineplus">+    StrCpy $TmpVal ${BrandFullName}</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineplus">+    ; Prior to Unicode installer the Start Menu directory was written to the</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineplus">+    ; registry and this value can be used to set the Start Menu directory.</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+    ClearErrors</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineplus">+    ReadRegStr $0 SHCTX &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot; &quot;Start Menu Folder&quot;</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineplus">+    ${If} ${Errors}</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineplus">+      ${FindSMProgramsDir} $0</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineplus">+      ${If} &quot;$0&quot; != &quot;&quot;</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineplus">+        StrCpy $TmpVal &quot;$0&quot;</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineplus">+      ${EndIf}</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineplus">+    ${Else}</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineplus">+      StrCpy $TmpVal &quot;$0&quot;</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineplus">+    ${EndUnless}</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineplus">+</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineplus">+    ${LogSMProgramsDirRelPath} &quot;$TmpVal&quot;</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineplus">+    ${LogSMProgramsShortcut} &quot;${BrandFullName}.lnk&quot;</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineplus">+    ${LogSMProgramsShortcut} &quot;${BrandFullName} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineplus">+    ${LogQuickLaunchShortcut} &quot;${BrandFullName}.lnk&quot;</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineplus">+    ${LogDesktopShortcut} &quot;${BrandFullName}.lnk&quot;</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineplus">+  ${EndUnless}</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineplus">+!macroend</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineplus">+!define CreateShortcutsLog &quot;!insertmacro CreateShortcutsLog&quot;</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineplus">+</span>
<a href="#l2.122"></a><span id="l2.122"> ; The MAPI DLL's are copied and the copies are used for the MAPI registration</span>
<a href="#l2.123"></a><span id="l2.123"> ; to lessen file in use errors on application update.</span>
<a href="#l2.124"></a><span id="l2.124"> !macro UpgradeMapiDLLs</span>
<a href="#l2.125"></a><span id="l2.125">   ClearErrors</span>
<a href="#l2.126"></a><span id="l2.126">   ${DeleteFile} &quot;$INSTDIR\MapiProxy_InUse.dll&quot;</span>
<a href="#l2.127"></a><span id="l2.127">   ${If} ${Errors}</span>
<a href="#l2.128"></a><span id="l2.128">     ${DeleteFile} &quot;$INSTDIR\MapiProxy_InUse.dll.moz-delete&quot; ; shouldn't exist</span>
<a href="#l2.129"></a><span id="l2.129">     Rename &quot;$INSTDIR\MapiProxy_InUse.dll&quot; &quot;$INSTDIR\MapiProxy_InUse.dll.moz-delete&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/installer/windows/nsis/uninstaller.nsi</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/installer/windows/nsis/uninstaller.nsi</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -48,20 +48,16 @@</span>
<a href="#l3.4"></a><span id="l3.4"> SetDatablockOptimize on</span>
<a href="#l3.5"></a><span id="l3.5"> SetCompress off</span>
<a href="#l3.6"></a><span id="l3.6"> CRCCheck on</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> RequestExecutionLevel user</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> !addplugindir ./</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-; USE_UAC_PLUGIN is temporary until all applications have been updated to use</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-; the UAC plugin</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-!define USE_UAC_PLUGIN</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-</span>
<a href="#l3.16"></a><span id="l3.16"> ; prevents compiling of the reg write logging.</span>
<a href="#l3.17"></a><span id="l3.17"> !define NO_LOG</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> Var TmpVal</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21"> ; Other included files may depend upon these includes!</span>
<a href="#l3.22"></a><span id="l3.22"> ; The following includes are provided by NSIS.</span>
<a href="#l3.23"></a><span id="l3.23"> !include FileFunc.nsh</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineat">@@ -85,32 +81,37 @@ Var TmpVal</span>
<a href="#l3.25"></a><span id="l3.25"> !include locales.nsi</span>
<a href="#l3.26"></a><span id="l3.26"> !include version.nsh</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28"> ; This is named BrandShortName helper because we use this for software update</span>
<a href="#l3.29"></a><span id="l3.29"> ; post update cleanup.</span>
<a href="#l3.30"></a><span id="l3.30"> VIAddVersionKey &quot;FileDescription&quot;  &quot;${BrandShortName} Helper&quot;</span>
<a href="#l3.31"></a><span id="l3.31"> VIAddVersionKey &quot;OriginalFilename&quot; &quot;helper.exe&quot;</span>
<a href="#l3.32"></a><span id="l3.32"> </span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+; Most commonly used macros for managing shortcuts</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+!insertmacro _LoggingShortcutsCommon</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+</span>
<a href="#l3.36"></a><span id="l3.36"> !insertmacro AddHandlerValues</span>
<a href="#l3.37"></a><span id="l3.37"> !insertmacro CleanVirtualStore</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+!insertmacro FindSMProgramsDir</span>
<a href="#l3.39"></a><span id="l3.39"> !insertmacro GetLongPath</span>
<a href="#l3.40"></a><span id="l3.40"> !insertmacro GetPathFromString</span>
<a href="#l3.41"></a><span id="l3.41"> !insertmacro IsHandlerForInstallDir</span>
<a href="#l3.42"></a><span id="l3.42"> !insertmacro RegCleanMain</span>
<a href="#l3.43"></a><span id="l3.43"> !insertmacro RegCleanUninstall</span>
<a href="#l3.44"></a><span id="l3.44"> !insertmacro SetBrandNameVars</span>
<a href="#l3.45"></a><span id="l3.45"> !insertmacro UnloadUAC</span>
<a href="#l3.46"></a><span id="l3.46"> !insertmacro WriteRegDWORD2</span>
<a href="#l3.47"></a><span id="l3.47"> !insertmacro WriteRegStr2</span>
<a href="#l3.48"></a><span id="l3.48"> </span>
<a href="#l3.49"></a><span id="l3.49"> !insertmacro un.ChangeMUIHeaderImage</span>
<a href="#l3.50"></a><span id="l3.50"> !insertmacro un.CheckForFilesInUse</span>
<a href="#l3.51"></a><span id="l3.51"> !insertmacro un.CleanUpdatesDir</span>
<a href="#l3.52"></a><span id="l3.52"> !insertmacro un.CleanVirtualStore</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+!insertmacro un.DeleteShortcuts</span>
<a href="#l3.54"></a><span id="l3.54"> !insertmacro un.GetLongPath</span>
<a href="#l3.55"></a><span id="l3.55"> !insertmacro un.GetSecondInstallPath</span>
<a href="#l3.56"></a><span id="l3.56"> !insertmacro un.ManualCloseAppPrompt</span>
<a href="#l3.57"></a><span id="l3.57"> !insertmacro un.ParseUninstallLog</span>
<a href="#l3.58"></a><span id="l3.58"> !insertmacro un.RegCleanAppHandler</span>
<a href="#l3.59"></a><span id="l3.59"> !insertmacro un.RegCleanFileHandler</span>
<a href="#l3.60"></a><span id="l3.60"> !insertmacro un.RegCleanMain</span>
<a href="#l3.61"></a><span id="l3.61"> !insertmacro un.RegCleanProtocolHandler</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineat">@@ -205,27 +206,29 @@ Section &quot;Uninstall&quot;</span>
<a href="#l3.63"></a><span id="l3.63">     Sleep 5000</span>
<a href="#l3.64"></a><span id="l3.64">     ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l3.65"></a><span id="l3.65">     ClearErrors</span>
<a href="#l3.66"></a><span id="l3.66">   ${EndIf}</span>
<a href="#l3.67"></a><span id="l3.67"> </span>
<a href="#l3.68"></a><span id="l3.68">   SetShellVarContext current  ; Set SHCTX to HKCU</span>
<a href="#l3.69"></a><span id="l3.69">   ${un.RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l3.70"></a><span id="l3.70">   ${un.RegCleanUninstall}</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+  ${un.DeleteShortcuts}</span>
<a href="#l3.72"></a><span id="l3.72"> </span>
<a href="#l3.73"></a><span id="l3.73">   ClearErrors</span>
<a href="#l3.74"></a><span id="l3.74">   WriteRegStr HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot; &quot;Write Test&quot;</span>
<a href="#l3.75"></a><span id="l3.75">   ${If} ${Errors}</span>
<a href="#l3.76"></a><span id="l3.76">     StrCpy $TmpVal &quot;HKCU&quot; ; used primarily for logging</span>
<a href="#l3.77"></a><span id="l3.77">   ${Else}</span>
<a href="#l3.78"></a><span id="l3.78">     SetShellVarContext all  ; Set SHCTX to HKLM</span>
<a href="#l3.79"></a><span id="l3.79">     DeleteRegValue HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot;</span>
<a href="#l3.80"></a><span id="l3.80">     StrCpy $TmpVal &quot;HKLM&quot; ; used primarily for logging</span>
<a href="#l3.81"></a><span id="l3.81">     ${un.RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l3.82"></a><span id="l3.82">     ${un.RegCleanUninstall}</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+    ${un.DeleteShortcuts}</span>
<a href="#l3.84"></a><span id="l3.84">   ${EndIf}</span>
<a href="#l3.85"></a><span id="l3.85"> </span>
<a href="#l3.86"></a><span id="l3.86">   ${un.RegCleanAppHandler} &quot;Thunderbird.Url.mailto&quot;</span>
<a href="#l3.87"></a><span id="l3.87">   ${un.RegCleanAppHandler} &quot;Thunderbird.Url.news&quot;</span>
<a href="#l3.88"></a><span id="l3.88">   ${un.RegCleanAppHandler} &quot;ThunderbirdEML&quot;</span>
<a href="#l3.89"></a><span id="l3.89">   ${un.RegCleanProtocolHandler} &quot;mailto&quot;</span>
<a href="#l3.90"></a><span id="l3.90">   ${un.RegCleanProtocolHandler} &quot;news&quot;</span>
<a href="#l3.91"></a><span id="l3.91">   ${un.RegCleanProtocolHandler} &quot;nntp&quot;</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineat">@@ -506,16 +509,18 @@ Function un.onInit</span>
<a href="#l3.93"></a><span id="l3.93">   ${EndUnless}</span>
<a href="#l3.94"></a><span id="l3.94"> </span>
<a href="#l3.95"></a><span id="l3.95">   StrCpy $LANGUAGE 0</span>
<a href="#l3.96"></a><span id="l3.96">   ${un.SetBrandNameVars} &quot;$INSTDIR\distribution\setup.ini&quot;</span>
<a href="#l3.97"></a><span id="l3.97"> </span>
<a href="#l3.98"></a><span id="l3.98">   ; Initialize $hHeaderBitmap to prevent redundant changing of the bitmap if</span>
<a href="#l3.99"></a><span id="l3.99">   ; the user clicks the back button</span>
<a href="#l3.100"></a><span id="l3.100">   StrCpy $hHeaderBitmap &quot;&quot;</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineplus">+</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineplus">+  !insertmacro InitInstallOptionsFile &quot;unconfirm.ini&quot;</span>
<a href="#l3.103"></a><span id="l3.103"> FunctionEnd</span>
<a href="#l3.104"></a><span id="l3.104"> </span>
<a href="#l3.105"></a><span id="l3.105"> Function .onGUIEnd</span>
<a href="#l3.106"></a><span id="l3.106">   ${OnEndCommon}</span>
<a href="#l3.107"></a><span id="l3.107"> FunctionEnd</span>
<a href="#l3.108"></a><span id="l3.108"> </span>
<a href="#l3.109"></a><span id="l3.109"> Function un.onGUIEnd</span>
<a href="#l3.110"></a><span id="l3.110">   ${un.OnEndCommon}</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

