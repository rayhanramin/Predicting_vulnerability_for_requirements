<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 18832:17e3470d8d8d489e589b3c8a36c5e3b89a73068d</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 17e3470d8d8d489e589b3c8a36c5e3b89a73068d" />
<meta property="og:url" content="/comm-central/rev/17e3470d8d8d489e589b3c8a36c5e3b89a73068d" />
<meta property="og:description" content="Bug 1237602 - Port bug 1220564 - Remove legacy array/generator comprehension: chat and im. r=aleth" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 17e3470d8d8d489e589b3c8a36c5e3b89a73068d 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">shortlog</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">files</a> |
changeset |
<a href="/comm-central/raw-rev/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">raw</a>  | <a href="/comm-central/archive/17e3470d8d8d489e589b3c8a36c5e3b89a73068d.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1237602">Bug 1237602</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220564">bug 1220564</a> - Remove legacy array/generator comprehension: chat and im. r=aleth
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#83;&#101;&#98;&#97;&#115;&#116;&#105;&#97;&#110;&#32;&#72;&#101;&#110;&#103;&#115;&#116;&#32;&#60;&#97;&#114;&#99;&#104;&#97;&#101;&#111;&#112;&#116;&#101;&#114;&#121;&#120;&#64;&#99;&#111;&#111;&#108;&#101;&#45;&#102;&#105;&#108;&#101;&#115;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 12 Jan 2016 00:27:14 +0100</td></tr>

<tr>
 <td>changeset 18832</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/17e3470d8d8d489e589b3c8a36c5e3b89a73068d">17e3470d8d8d489e589b3c8a36c5e3b89a73068d</a></td>
</tr>



<tr>
<td>parent 18831</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/21ee57c22c62db0f2c61d15b60933ad563caf4d3">21ee57c22c62db0f2c61d15b60933ad563caf4d3</a>
</td>
</tr>

<tr>
<td>child 18833</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/30d7839cccbecc3103b8734eabfe94b8a1ecced8">30d7839cccbecc3103b8734eabfe94b8a1ecced8</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=17e3470d8d8d489e589b3c8a36c5e3b89a73068d">11539</a></td></tr>
<tr><td>push user</td><td>archaeopteryx@coole-files.de</td></tr>
<tr><td>push date</td><td class="date age">Mon, 11 Jan 2016 23:31:12 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1a7fafc84e67 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1a7fafc84e67cb372998e45e1568dc832f85b6d6">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&newProject=comm-central&newRevision=17e3470d8d8d489e589b3c8a36c5e3b89a73068d&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&newProject=comm-central&newRevision=17e3470d8d8d489e589b3c8a36c5e3b89a73068d&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1a7fafc84e67cb372998e45e1568dc832f85b6d6&newProject=comm-central&newRevision=17e3470d8d8d489e589b3c8a36c5e3b89a73068d&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28aleth%29&revcount=50">aleth</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1237602">1237602</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220564">1220564</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1237602">Bug 1237602</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220564">bug 1220564</a> - Remove legacy array/generator comprehension: chat and im. r=aleth</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/imContacts.js">chat/components/src/imContacts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/imContacts.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/imContacts.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/imContacts.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/imContacts.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/imContacts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/logger.js">chat/components/src/logger.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/logger.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/logger.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/logger.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/logger.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/components/src/logger.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/ArrayBufferUtils.jsm">chat/modules/ArrayBufferUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/ArrayBufferUtils.jsm">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/ArrayBufferUtils.jsm">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/ArrayBufferUtils.jsm">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/ArrayBufferUtils.jsm">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/ArrayBufferUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/NormalizedMap.jsm">chat/modules/NormalizedMap.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/NormalizedMap.jsm">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/NormalizedMap.jsm">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/NormalizedMap.jsm">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/NormalizedMap.jsm">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/NormalizedMap.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/jsProtoHelper.jsm">chat/modules/jsProtoHelper.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/jsProtoHelper.jsm">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/jsProtoHelper.jsm">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/jsProtoHelper.jsm">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/jsProtoHelper.jsm">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/jsProtoHelper.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/test/test_NormalizedMap.js">chat/modules/test/test_NormalizedMap.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/test/test_NormalizedMap.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/test/test_NormalizedMap.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/test/test_NormalizedMap.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/test/test_NormalizedMap.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/modules/test/test_NormalizedMap.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/irc/irc.js">chat/protocols/irc/irc.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/irc/irc.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/irc/irc.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/irc/irc.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/irc/irc.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/irc/irc.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/twitter/twitter.js">chat/protocols/twitter/twitter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/twitter/twitter.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/twitter/twitter.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/twitter/twitter.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/twitter/twitter.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/twitter/twitter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-authmechs.jsm">chat/protocols/xmpp/xmpp-authmechs.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-authmechs.jsm">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-authmechs.jsm">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-authmechs.jsm">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-authmechs.jsm">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-authmechs.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-session.jsm">chat/protocols/xmpp/xmpp-session.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-session.jsm">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-session.jsm">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-session.jsm">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-session.jsm">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp-session.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp.jsm">chat/protocols/xmpp/xmpp.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp.jsm">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp.jsm">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp.jsm">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp.jsm">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/xmpp/xmpp.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/yahoo/yahoo.js">chat/protocols/yahoo/yahoo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/yahoo/yahoo.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/yahoo/yahoo.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/yahoo/yahoo.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/yahoo/yahoo.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/chat/protocols/yahoo/yahoo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/components/ibConvStatsService.js">im/components/ibConvStatsService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/components/ibConvStatsService.js">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/components/ibConvStatsService.js">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/components/ibConvStatsService.js">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/components/ibConvStatsService.js">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/components/ibConvStatsService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/content/conversation.xml">im/content/conversation.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/content/conversation.xml">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/content/conversation.xml">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/content/conversation.xml">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/content/conversation.xml">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/im/content/conversation.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/mail/components/im/content/imconversation.xml">mail/components/im/content/imconversation.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/mail/components/im/content/imconversation.xml">file</a> |
<a href="/comm-central/annotate/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/mail/components/im/content/imconversation.xml">annotate</a> |
<a href="/comm-central/diff/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/mail/components/im/content/imconversation.xml">diff</a> |
<a href="/comm-central/comparison/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/mail/components/im/content/imconversation.xml">comparison</a> |
<a href="/comm-central/log/17e3470d8d8d489e589b3c8a36c5e3b89a73068d/mail/components/im/content/imconversation.xml">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/chat/components/src/imContacts.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/chat/components/src/imContacts.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -246,17 +246,17 @@ Tag.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> var otherContactsTag = {</span>
<a href="#l1.7"></a><span id="l1.7">   hiddenTagsPref: &quot;messenger.buddies.hiddenTags&quot;,</span>
<a href="#l1.8"></a><span id="l1.8">   _hiddenTags: {},</span>
<a href="#l1.9"></a><span id="l1.9">   _contactsInitialized: false,</span>
<a href="#l1.10"></a><span id="l1.10">   _saveHiddenTagsPref: function() {</span>
<a href="#l1.11"></a><span id="l1.11">     Services.prefs.setCharPref(this.hiddenTagsPref,</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-                               [id for (id in this._hiddenTags)].join(&quot;,&quot;));</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                               Object.keys(this._hiddenTags).join(&quot;,&quot;));</span>
<a href="#l1.14"></a><span id="l1.14">   },</span>
<a href="#l1.15"></a><span id="l1.15">   showTag: function(aTag) {</span>
<a href="#l1.16"></a><span id="l1.16">     let id = aTag.id;</span>
<a href="#l1.17"></a><span id="l1.17">     delete this._hiddenTags[id];</span>
<a href="#l1.18"></a><span id="l1.18">     for each (let contact in this._contacts)</span>
<a href="#l1.19"></a><span id="l1.19">       if (contact.getTags().some(t =&gt; t.id == id))</span>
<a href="#l1.20"></a><span id="l1.20">         this._removeContact(contact);</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -327,17 +327,17 @@ var otherContactsTag = {</span>
<a href="#l1.23"></a><span id="l1.23">     Services.obs.addObserver(this, &quot;contact-removed&quot;, false);</span>
<a href="#l1.24"></a><span id="l1.24">   },</span>
<a href="#l1.25"></a><span id="l1.25"> </span>
<a href="#l1.26"></a><span id="l1.26">   // imITag implementation</span>
<a href="#l1.27"></a><span id="l1.27">   get id() { return -1; },</span>
<a href="#l1.28"></a><span id="l1.28">   get name() { return &quot;__others__&quot;; },</span>
<a href="#l1.29"></a><span id="l1.29">   set name(aNewName) { throw Cr.NS_ERROR_NOT_AVAILABLE; },</span>
<a href="#l1.30"></a><span id="l1.30">   getContacts: function(aContactCount) {</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-    let contacts = [contact for each (contact in this._contacts)];</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+    let contacts = [...this._contacts];</span>
<a href="#l1.33"></a><span id="l1.33">     if (aContactCount)</span>
<a href="#l1.34"></a><span id="l1.34">       aContactCount.value = contacts.length;</span>
<a href="#l1.35"></a><span id="l1.35">     return contacts;</span>
<a href="#l1.36"></a><span id="l1.36">   },</span>
<a href="#l1.37"></a><span id="l1.37">   _addContact: function(aContact) {</span>
<a href="#l1.38"></a><span id="l1.38">     this._contacts[aContact.id] = aContact;</span>
<a href="#l1.39"></a><span id="l1.39">     this.notifyObservers(aContact, &quot;contact-moved-in&quot;);</span>
<a href="#l1.40"></a><span id="l1.40">     for each (let observer in ContactsById[aContact.id]._observers)</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineat">@@ -1315,17 +1315,19 @@ ContactsService.prototype = {</span>
<a href="#l1.42"></a><span id="l1.42">       buddy.destroy();</span>
<a href="#l1.43"></a><span id="l1.43">     BuddiesById = { };</span>
<a href="#l1.44"></a><span id="l1.44">     ContactsById = { };</span>
<a href="#l1.45"></a><span id="l1.45">   },</span>
<a href="#l1.46"></a><span id="l1.46"> </span>
<a href="#l1.47"></a><span id="l1.47">   getContactById: aId =&gt; ContactsById[aId],</span>
<a href="#l1.48"></a><span id="l1.48">   // Get an array of all existing contacts.</span>
<a href="#l1.49"></a><span id="l1.49">   getContacts: function(aContactCount) {</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-    let contacts = [ContactsById[id] for (id in ContactsById) if (!ContactsById[id]._empty)];</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineplus">+    let contacts = Object.keys(ContactsById)</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineplus">+                         .filter(id =&gt; !ContactsById[id]._empty)</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineplus">+                         .map(id =&gt; ContactsById[id]);</span>
<a href="#l1.54"></a><span id="l1.54">     if (aContactCount)</span>
<a href="#l1.55"></a><span id="l1.55">       aContactCount.value = contacts.length;</span>
<a href="#l1.56"></a><span id="l1.56">     return contacts;</span>
<a href="#l1.57"></a><span id="l1.57">   },</span>
<a href="#l1.58"></a><span id="l1.58">   getBuddyById: aId =&gt; BuddiesById[aId],</span>
<a href="#l1.59"></a><span id="l1.59">   getBuddyByNameAndProtocol: function(aNormalizedName, aPrpl) {</span>
<a href="#l1.60"></a><span id="l1.60">     let statement =</span>
<a href="#l1.61"></a><span id="l1.61">       DBConn.createStatement(&quot;SELECT b.id FROM buddies b &quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/chat/components/src/logger.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/chat/components/src/logger.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -503,17 +503,17 @@ function Log(aEntries) {</span>
<a href="#l2.4"></a><span id="l2.4">     throw new Error(&quot;Log was passed an invalid argument, &quot; +</span>
<a href="#l2.5"></a><span id="l2.5">                     &quot;expected a non-empty array or a string.&quot;);</span>
<a href="#l2.6"></a><span id="l2.6">   }</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8">   // Assume aEntries is an array of objects.</span>
<a href="#l2.9"></a><span id="l2.9">   // Sort our list of entries for this day in increasing order.</span>
<a href="#l2.10"></a><span id="l2.10">   aEntries.sort((aLeft, aRight) =&gt; aLeft.time - aRight.time);</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  this._entryPaths = [entry.path for (entry of aEntries)];</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  this._entryPaths = aEntries.map(entry =&gt; entry.path);</span>
<a href="#l2.14"></a><span id="l2.14">   // Calculate the timestamp for the first entry down to the day.</span>
<a href="#l2.15"></a><span id="l2.15">   let timestamp = new Date(aEntries[0].time);</span>
<a href="#l2.16"></a><span id="l2.16">   timestamp.setHours(0);</span>
<a href="#l2.17"></a><span id="l2.17">   timestamp.setMinutes(0);</span>
<a href="#l2.18"></a><span id="l2.18">   timestamp.setSeconds(0);</span>
<a href="#l2.19"></a><span id="l2.19">   this.time = timestamp.valueOf() / 1000;</span>
<a href="#l2.20"></a><span id="l2.20">   // Path is used to uniquely identify a Log, and sometimes used to</span>
<a href="#l2.21"></a><span id="l2.21">   // quickly determine which directory a log file is from.  We'll use</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/chat/modules/ArrayBufferUtils.jsm</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/chat/modules/ArrayBufferUtils.jsm</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -31,22 +31,26 @@ function ArrayBufferToBytes(aBuf) {</span>
<a href="#l3.4"></a><span id="l3.4"> function BytesToArrayBuffer(aBytes = []) {</span>
<a href="#l3.5"></a><span id="l3.5">   let buf = new ArrayBuffer(aBytes.length);</span>
<a href="#l3.6"></a><span id="l3.6">   let view = new Uint8Array(buf);</span>
<a href="#l3.7"></a><span id="l3.7">   view.set(aBytes);</span>
<a href="#l3.8"></a><span id="l3.8">   return buf;</span>
<a href="#l3.9"></a><span id="l3.9"> }</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11"> function StringToBytes(aString) {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  return [aString.charCodeAt(i) for (i in aString)];</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  let bytes = [];</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+  for (let i in aString) {</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+    bytes.push(aString.charCodeAt(i));</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+  }</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+  return bytes;</span>
<a href="#l3.18"></a><span id="l3.18"> }</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20"> function StringToArrayBuffer(aString) {</span>
<a href="#l3.21"></a><span id="l3.21">   return BytesToArrayBuffer(StringToBytes(aString));</span>
<a href="#l3.22"></a><span id="l3.22"> }</span>
<a href="#l3.23"></a><span id="l3.23"> </span>
<a href="#l3.24"></a><span id="l3.24"> function ArrayBufferToString(aData) {</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">-  return [for (b of new Uint8Array(aData)) String.fromCharCode(b)].join(&quot;&quot;);</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+  return Array.from(new Uint8Array(aData)).map(b =&gt; String.fromCharCode(b)).join(&quot;&quot;);</span>
<a href="#l3.27"></a><span id="l3.27"> }</span>
<a href="#l3.28"></a><span id="l3.28"> </span>
<a href="#l3.29"></a><span id="l3.29"> function ArrayBufferToHexString(aData) {</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-  return &quot;0x&quot; + [for (b of new Uint8Array(aData)) (&quot;0&quot; + b.toString(16)).slice(-2)].join(&quot; &quot;);</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+  return &quot;0x&quot; + Array.from(new Uint8Array(aData)).map(b =&gt; (&quot;0&quot; + b.toString(16)).slice(-2)).join(&quot; &quot;);</span>
<a href="#l3.32"></a><span id="l3.32"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/chat/modules/NormalizedMap.jsm</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/chat/modules/NormalizedMap.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -19,17 +19,18 @@ this.EXPORTED_SYMBOLS = [&quot;NormalizedMap&quot;</span>
<a href="#l4.4"></a><span id="l4.4">  * 838540 is fixed and native inheritance of a JavaScript built-in is possible.</span>
<a href="#l4.5"></a><span id="l4.5">  */</span>
<a href="#l4.6"></a><span id="l4.6"> function NormalizedMap(aNormalize, aIterable = []) {</span>
<a href="#l4.7"></a><span id="l4.7">   if (typeof(aNormalize) != &quot;function&quot;)</span>
<a href="#l4.8"></a><span id="l4.8">     throw &quot;NormalizedMap must have a normalize function!&quot;;</span>
<a href="#l4.9"></a><span id="l4.9">   this._normalize = aNormalize;</span>
<a href="#l4.10"></a><span id="l4.10">   // Create the wrapped Map; use the provided iterable after normalizing the</span>
<a href="#l4.11"></a><span id="l4.11">   // keys.</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  this._map = new Map([[aNormalize(key), val] for ([key, val] of aIterable)]);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  let entries = [...aIterable].map(([key, val]) =&gt; [aNormalize(key), val]);</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+  this._map = new Map(entries);</span>
<a href="#l4.15"></a><span id="l4.15"> }</span>
<a href="#l4.16"></a><span id="l4.16"> NormalizedMap.prototype = {</span>
<a href="#l4.17"></a><span id="l4.17">   _map: null,</span>
<a href="#l4.18"></a><span id="l4.18">   // The function to apply to all keys.</span>
<a href="#l4.19"></a><span id="l4.19">   _normalize: null,</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">   // Anything that accepts a key as an input needs to be manually overridden.</span>
<a href="#l4.22"></a><span id="l4.22">   delete(key) { return this._map.delete(this._normalize(key)); },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/chat/modules/jsProtoHelper.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/chat/modules/jsProtoHelper.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -619,17 +619,17 @@ var GenericConvChatPrototype = {</span>
<a href="#l5.4"></a><span id="l5.4">   },</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6">   getParticipant: function(aName) {</span>
<a href="#l5.7"></a><span id="l5.7">     return this._participants.has(aName) ? this._participants.get(aName) : null;</span>
<a href="#l5.8"></a><span id="l5.8">   },</span>
<a href="#l5.9"></a><span id="l5.9">   getParticipants: function() {</span>
<a href="#l5.10"></a><span id="l5.10">     // Convert the values of the Map into a nsSimpleEnumerator.</span>
<a href="#l5.11"></a><span id="l5.11">     return new nsSimpleEnumerator(</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-      [participant for (participant of this._participants.values())]</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+      Array.from(this._participants.values())</span>
<a href="#l5.14"></a><span id="l5.14">     );</span>
<a href="#l5.15"></a><span id="l5.15">   },</span>
<a href="#l5.16"></a><span id="l5.16">   getNormalizedChatBuddyName: aChatBuddyName =&gt; aChatBuddyName,</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18">   // Updates the nick of a participant in conversation to a new one.</span>
<a href="#l5.19"></a><span id="l5.19">   updateNick: function(aOldNick, aNewNick, isOwnNick) {</span>
<a href="#l5.20"></a><span id="l5.20">     let message;</span>
<a href="#l5.21"></a><span id="l5.21">     let isParticipant = this._participants.has(aOldNick);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/chat/modules/test/test_NormalizedMap.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/chat/modules/test/test_NormalizedMap.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -6,21 +6,21 @@ Components.utils.import(&quot;resource:///mod</span>
<a href="#l6.4"></a><span id="l6.4"> function test_setter_getter() {</span>
<a href="#l6.5"></a><span id="l6.5">   let m = new NormalizedMap(aStr =&gt; aStr.toLowerCase());</span>
<a href="#l6.6"></a><span id="l6.6">   m.set(&quot;foo&quot;, &quot;bar&quot;);</span>
<a href="#l6.7"></a><span id="l6.7">   m.set(&quot;BaZ&quot;, &quot;blah&quot;);</span>
<a href="#l6.8"></a><span id="l6.8">   do_check_eq(m.has(&quot;FOO&quot;), true);</span>
<a href="#l6.9"></a><span id="l6.9">   do_check_eq(m.has(&quot;BaZ&quot;), true);</span>
<a href="#l6.10"></a><span id="l6.10">   do_check_eq(m.get(&quot;FOO&quot;), &quot;bar&quot;);</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  let keys = [v for (v of m.keys())];</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  let keys = Array.from(m.keys());</span>
<a href="#l6.14"></a><span id="l6.14">   do_check_eq(keys[0], &quot;foo&quot;);</span>
<a href="#l6.15"></a><span id="l6.15">   do_check_eq(keys[1], &quot;baz&quot;);</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-  let values = [v for (v of m.values())];</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+  let values = Array.from(m.values());</span>
<a href="#l6.19"></a><span id="l6.19">   do_check_eq(values[0], &quot;bar&quot;);</span>
<a href="#l6.20"></a><span id="l6.20">   do_check_eq(values[1], &quot;blah&quot;);</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22">   do_check_eq(m.size, 2);</span>
<a href="#l6.23"></a><span id="l6.23"> </span>
<a href="#l6.24"></a><span id="l6.24">   run_next_test();</span>
<a href="#l6.25"></a><span id="l6.25"> }</span>
<a href="#l6.26"></a><span id="l6.26"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/chat/protocols/irc/irc.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/chat/protocols/irc/irc.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -923,17 +923,17 @@ ircAccount.prototype = {</span>
<a href="#l7.4"></a><span id="l7.4">     // We should not report this initial mode message as a mode change</span>
<a href="#l7.5"></a><span id="l7.5">     // initiated by the user, but instead display the full mode</span>
<a href="#l7.6"></a><span id="l7.6">     // and then remember we have done so.</span>
<a href="#l7.7"></a><span id="l7.7">     this._userModeReceived = true;</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9">     if (this._showServerTab) {</span>
<a href="#l7.10"></a><span id="l7.10">       let msg;</span>
<a href="#l7.11"></a><span id="l7.11">       if (aDisplayFullMode)</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-        msg = _(&quot;message.yourmode&quot;, [mode for (mode of this._modes)].join(&quot;&quot;));</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+        msg = _(&quot;message.yourmode&quot;, Array.from(this._modes).join(&quot;&quot;));</span>
<a href="#l7.14"></a><span id="l7.14">       else {</span>
<a href="#l7.15"></a><span id="l7.15">         msg = _(&quot;message.usermode&quot;, aNewModes, aNick,</span>
<a href="#l7.16"></a><span id="l7.16">                 aSetter || this._currentServerName);</span>
<a href="#l7.17"></a><span id="l7.17">       }</span>
<a href="#l7.18"></a><span id="l7.18">       this.getConversation(this._currentServerName)</span>
<a href="#l7.19"></a><span id="l7.19">           .writeMessage(this._currentServerName, msg, {system: true});</span>
<a href="#l7.20"></a><span id="l7.20">     }</span>
<a href="#l7.21"></a><span id="l7.21">     return true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/chat/protocols/twitter/twitter.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/chat/protocols/twitter/twitter.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -124,17 +124,21 @@ Action.prototype = {</span>
<a href="#l8.4"></a><span id="l8.4"> };</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> function Conversation(aAccount)</span>
<a href="#l8.7"></a><span id="l8.7"> {</span>
<a href="#l8.8"></a><span id="l8.8">   this._init(aAccount);</span>
<a href="#l8.9"></a><span id="l8.9">   this._ensureParticipantExists(aAccount.name);</span>
<a href="#l8.10"></a><span id="l8.10">   // We need the screen names for the IDs in _friends, but _userInfo is</span>
<a href="#l8.11"></a><span id="l8.11">   // indexed by name, so we build an ID -&gt; name map.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  let names = new Map([userInfo.id_str, name] for ([name, userInfo] of aAccount._userInfo));</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+  let entries = [];</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+  for (let [name, userInfo] of aAccount._userInfo) {</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+    entries.push([userInfo.id_str, name]);</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+  }</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+  let names = new Map(entries);</span>
<a href="#l8.18"></a><span id="l8.18">   for (let id_str of aAccount._friends)</span>
<a href="#l8.19"></a><span id="l8.19">     this._ensureParticipantExists(names.get(id_str));</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21">   // If the user's info has already been received, update the timeline topic.</span>
<a href="#l8.22"></a><span id="l8.22">   if (aAccount._userInfo.has(aAccount.name)) {</span>
<a href="#l8.23"></a><span id="l8.23">     let userInfo = aAccount._userInfo.get(aAccount.name);</span>
<a href="#l8.24"></a><span id="l8.24">     if (&quot;description&quot; in userInfo)</span>
<a href="#l8.25"></a><span id="l8.25">       this.setTopic(userInfo.description, aAccount.name, true);</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineat">@@ -507,17 +511,17 @@ Account.prototype = {</span>
<a href="#l8.27"></a><span id="l8.27"> </span>
<a href="#l8.28"></a><span id="l8.28">     let keyFactory = Cc[&quot;@mozilla.org/security/keyobjectfactory;1&quot;]</span>
<a href="#l8.29"></a><span id="l8.29">                      .getService(Ci.nsIKeyObjectFactory);</span>
<a href="#l8.30"></a><span id="l8.30">     let hmac =</span>
<a href="#l8.31"></a><span id="l8.31">       Cc[&quot;@mozilla.org/security/hmac;1&quot;].createInstance(Ci.nsICryptoHMAC);</span>
<a href="#l8.32"></a><span id="l8.32">     hmac.init(hmac.SHA1,</span>
<a href="#l8.33"></a><span id="l8.33">               keyFactory.keyFromString(Ci.nsIKeyObject.HMAC, signatureKey));</span>
<a href="#l8.34"></a><span id="l8.34">     // No UTF-8 encoding, special chars are already escaped.</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-    let bytes = [b.charCodeAt() for each (b in signatureBase)];</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+    let bytes = [...signatureBase].map(b =&gt; b.charCodeAt());</span>
<a href="#l8.37"></a><span id="l8.37">     hmac.update(bytes, bytes.length);</span>
<a href="#l8.38"></a><span id="l8.38">     let signature = hmac.finish(true);</span>
<a href="#l8.39"></a><span id="l8.39"> </span>
<a href="#l8.40"></a><span id="l8.40">     params.push([&quot;oauth_signature&quot;, encodeURIComponent(signature)]);</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42">     let authorization =</span>
<a href="#l8.43"></a><span id="l8.43">       &quot;OAuth &quot; + params.map(p =&gt; p[0] + &quot;=\&quot;&quot; + p[1] + &quot;\&quot;&quot;).join(&quot;, &quot;);</span>
<a href="#l8.44"></a><span id="l8.44"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/chat/protocols/xmpp/xmpp-authmechs.jsm</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/chat/protocols/xmpp/xmpp-authmechs.jsm</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -45,26 +45,27 @@ function md5(aString, aUTF8) {</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5">   let data;</span>
<a href="#l9.6"></a><span id="l9.6">   if (aUTF8) {</span>
<a href="#l9.7"></a><span id="l9.7">     let converter = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;]</span>
<a href="#l9.8"></a><span id="l9.8">                       .createInstance(Ci.nsIScriptableUnicodeConverter);</span>
<a href="#l9.9"></a><span id="l9.9">     converter.charset = &quot;UTF-8&quot;;</span>
<a href="#l9.10"></a><span id="l9.10">     data = converter.convertToByteArray(aString);</span>
<a href="#l9.11"></a><span id="l9.11">   }</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  else</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-    data = [aString.charCodeAt(i) for (i in aString)];</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+  else {</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+    data = Object.keys(aString).map(i =&gt; aString.charCodeAt(i));</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+  }</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18">   ch.update(data, data.length);</span>
<a href="#l9.19"></a><span id="l9.19">   return ch.finish(false);</span>
<a href="#l9.20"></a><span id="l9.20"> }</span>
<a href="#l9.21"></a><span id="l9.21"> function md5hex(aString) {</span>
<a href="#l9.22"></a><span id="l9.22">   let hash = md5(aString);</span>
<a href="#l9.23"></a><span id="l9.23">   function toHexString(charCode) { return (&quot;0&quot; + charCode.toString(16)).slice(-2); }</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineminus">-  return [toHexString(hash.charCodeAt(i)) for (i in hash)].join(&quot;&quot;);</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineplus">+  return Object.keys(hash).map(i =&gt; toHexString(hash.charCodeAt(i))).join(&quot;&quot;);</span>
<a href="#l9.26"></a><span id="l9.26"> }</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28"> function digestMD5(aName, aRealm, aPassword, aNonce, aCnonce, aDigestUri) {</span>
<a href="#l9.29"></a><span id="l9.29">   let y = md5(aName + &quot;:&quot; + aRealm + &quot;:&quot; + aPassword, true);</span>
<a href="#l9.30"></a><span id="l9.30">   return md5hex(md5hex(y + &quot;:&quot; + aNonce + &quot;:&quot; + aCnonce) +</span>
<a href="#l9.31"></a><span id="l9.31">                 &quot;:&quot; + aNonce + &quot;:00000001:&quot; + aCnonce + &quot;:auth:&quot; +</span>
<a href="#l9.32"></a><span id="l9.32">                 md5hex(&quot;AUTHENTICATE:&quot; + aDigestUri));</span>
<a href="#l9.33"></a><span id="l9.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/chat/protocols/xmpp/xmpp-session.jsm</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/chat/protocols/xmpp/xmpp-session.jsm</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -484,17 +484,17 @@ XMPPSession.prototype = {</span>
<a href="#l10.4"></a><span id="l10.4">         let converter = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;]</span>
<a href="#l10.5"></a><span id="l10.5">                           .createInstance(Ci.nsIScriptableUnicodeConverter);</span>
<a href="#l10.6"></a><span id="l10.6">         converter.charset = &quot;UTF-8&quot;;</span>
<a href="#l10.7"></a><span id="l10.7">         let data = converter.convertToByteArray(hashBase);</span>
<a href="#l10.8"></a><span id="l10.8">         ch.update(data, data.length);</span>
<a href="#l10.9"></a><span id="l10.9">         let hash = ch.finish(false);</span>
<a href="#l10.10"></a><span id="l10.10">         let toHexString =</span>
<a href="#l10.11"></a><span id="l10.11">           charCode =&gt; (&quot;0&quot; + charCode.toString(16)).slice(-2);</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-        let digest = [toHexString(hash.charCodeAt(i)) for (i in hash)].join(&quot;&quot;);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+        let digest = Object.keys(hash).map(i =&gt; toHexString(hash.charCodeAt(i))).join(&quot;&quot;);</span>
<a href="#l10.14"></a><span id="l10.14"> </span>
<a href="#l10.15"></a><span id="l10.15">         children.push(Stanza.node(&quot;digest&quot;, null, null, digest));</span>
<a href="#l10.16"></a><span id="l10.16">         logString =</span>
<a href="#l10.17"></a><span id="l10.17">           &quot;legacyAuth stanza containing SHA-1 hash of the password not logged&quot;;</span>
<a href="#l10.18"></a><span id="l10.18">       }</span>
<a href="#l10.19"></a><span id="l10.19">       else if (&quot;password&quot; in values) {</span>
<a href="#l10.20"></a><span id="l10.20">         if (!this._encrypted &amp;&amp;</span>
<a href="#l10.21"></a><span id="l10.21">             this._connectionSecurity != &quot;allow_unencrypted_plain_auth&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/chat/protocols/xmpp/xmpp.jsm</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/chat/protocols/xmpp/xmpp.jsm</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -898,21 +898,21 @@ var XMPPAccountBuddyPrototype = {</span>
<a href="#l11.4"></a><span id="l11.4">         data = &quot;&quot;;</span>
<a href="#l11.5"></a><span id="l11.5">       }</span>
<a href="#l11.6"></a><span id="l11.6">     }</span>
<a href="#l11.7"></a><span id="l11.7">     content += parseBase64(data);</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9">     // Store a sha1 hash of the photo we have just received.</span>
<a href="#l11.10"></a><span id="l11.10">     let ch = Cc[&quot;@mozilla.org/security/hash;1&quot;].createInstance(Ci.nsICryptoHash);</span>
<a href="#l11.11"></a><span id="l11.11">     ch.init(ch.SHA1);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    let dataArray = [content.charCodeAt(i) for (i in content)];</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    let dataArray = Object.keys(content).map(i =&gt; content.charCodeAt(i));</span>
<a href="#l11.14"></a><span id="l11.14">     ch.update(dataArray, dataArray.length);</span>
<a href="#l11.15"></a><span id="l11.15">     let hash = ch.finish(false);</span>
<a href="#l11.16"></a><span id="l11.16">     function toHexString(charCode) { return (&quot;0&quot; + charCode.toString(16)).slice(-2); }</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineminus">-    this._photoHash = [toHexString(hash.charCodeAt(i)) for (i in hash)].join(&quot;&quot;);</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+    this._photoHash = Object.keys(hash).map(i =&gt; toHexString(hash.charCodeAt(i))).join(&quot;&quot;);</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20">     let istream = Cc[&quot;@mozilla.org/io/string-input-stream;1&quot;]</span>
<a href="#l11.21"></a><span id="l11.21">                   .createInstance(Ci.nsIStringInputStream);</span>
<a href="#l11.22"></a><span id="l11.22">     istream.setData(content, content.length);</span>
<a href="#l11.23"></a><span id="l11.23"> </span>
<a href="#l11.24"></a><span id="l11.24">     let fileName = this._photoHash + &quot;.&quot; + kExt[type];</span>
<a href="#l11.25"></a><span id="l11.25">     let file = FileUtils.getFile(&quot;ProfD&quot;, [&quot;icons&quot;,</span>
<a href="#l11.26"></a><span id="l11.26">                                            this.account.protocol.normalizedName,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/chat/protocols/yahoo/yahoo.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/chat/protocols/yahoo/yahoo.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -116,17 +116,17 @@ YahooConference.prototype = {</span>
<a href="#l12.4"></a><span id="l12.4">     let buddy = new YahooConferenceBuddy(aName, this);</span>
<a href="#l12.5"></a><span id="l12.5">     this._participants.set(aName, buddy);</span>
<a href="#l12.6"></a><span id="l12.6">     this.notifyObservers(new nsSimpleEnumerator([buddy]), &quot;chat-buddy-add&quot;);</span>
<a href="#l12.7"></a><span id="l12.7">     this.writeMessage(this._roomName,</span>
<a href="#l12.8"></a><span id="l12.8">                       _(&quot;system.message.conferenceLogon&quot;, aName),</span>
<a href="#l12.9"></a><span id="l12.9">                       {system: true});</span>
<a href="#l12.10"></a><span id="l12.10">   },</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  getParticipantNames: function() { return [for (p of this._participants.values()) p.name]; }</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  getParticipantNames: function() { return Array.from(this._participants.values()).map(p =&gt; p.name); }</span>
<a href="#l12.14"></a><span id="l12.14"> };</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16"> function YahooConferenceBuddy(aName, aConference)</span>
<a href="#l12.17"></a><span id="l12.17"> {</span>
<a href="#l12.18"></a><span id="l12.18">   this._name = aName;</span>
<a href="#l12.19"></a><span id="l12.19">   this._conference = aConference;</span>
<a href="#l12.20"></a><span id="l12.20"> }</span>
<a href="#l12.21"></a><span id="l12.21"> YahooConferenceBuddy.prototype = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/im/components/ibConvStatsService.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/im/components/ibConvStatsService.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -617,17 +617,17 @@ PossibleConvFromContact.prototype = {</span>
<a href="#l13.4"></a><span id="l13.4">                                    accountbuddy.normalizedName, false));</span>
<a href="#l13.5"></a><span id="l13.5">       }</span>
<a href="#l13.6"></a><span id="l13.6">     }</span>
<a href="#l13.7"></a><span id="l13.7">     return ids;</span>
<a href="#l13.8"></a><span id="l13.8">   },</span>
<a href="#l13.9"></a><span id="l13.9">   get lowerCaseName() {</span>
<a href="#l13.10"></a><span id="l13.10">     if (!this._lowerCaseName) {</span>
<a href="#l13.11"></a><span id="l13.11">       let buddies = this.contact.getBuddies();</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-      let names = [b.displayName for (b of buddies)].join(&quot; &quot;);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+      let names = buddies.map(b =&gt; b.displayName).join(&quot; &quot;);</span>
<a href="#l13.14"></a><span id="l13.14">       this._lowerCaseName = names.toLowerCase();</span>
<a href="#l13.15"></a><span id="l13.15">     }</span>
<a href="#l13.16"></a><span id="l13.16">     return this._lowerCaseName;</span>
<a href="#l13.17"></a><span id="l13.17">   },</span>
<a href="#l13.18"></a><span id="l13.18">   get buddyIconFilename() { return this.contact.buddyIconFilename; },</span>
<a href="#l13.19"></a><span id="l13.19">   get infoText() {</span>
<a href="#l13.20"></a><span id="l13.20">     let tagNames = this.contact.getTags().map(aTag =&gt; aTag.name);</span>
<a href="#l13.21"></a><span id="l13.21">     tagNames.sort((a, b) =&gt; a.toLowerCase().localeCompare(b.toLowerCase()));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/im/content/conversation.xml</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/im/content/conversation.xml</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -564,17 +564,17 @@</span>
<a href="#l14.4"></a><span id="l14.4">               // More than one nick:</span>
<a href="#l14.5"></a><span id="l14.5">               //   &quot;nick1, nick2: &quot; -&gt; &quot;nick1: nick2&quot;</span>
<a href="#l14.6"></a><span id="l14.6">               // Single nick: remove the suffix</span>
<a href="#l14.7"></a><span id="l14.7">               //   &quot;nick1: &quot; -&gt; &quot;nick1&quot;</span>
<a href="#l14.8"></a><span id="l14.8">               let pos = inputBox.selectionStart;</span>
<a href="#l14.9"></a><span id="l14.9">               const suffix = &quot;: &quot;;</span>
<a href="#l14.10"></a><span id="l14.10">               if (pos &gt; suffix.length &amp;&amp;</span>
<a href="#l14.11"></a><span id="l14.11">                   text.substring(pos - suffix.length, pos) == suffix) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-                let completions = [b for (b of this.buddies.keys())];</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+                let completions = Array.from(this.buddies.keys());</span>
<a href="#l14.14"></a><span id="l14.14">                 // Check if the preceding words are a sequence of nick completions.</span>
<a href="#l14.15"></a><span id="l14.15">                 let preceding = text.substring(0, pos - suffix.length).split(&quot;, &quot;);</span>
<a href="#l14.16"></a><span id="l14.16">                 if (preceding.every(n =&gt; completions.indexOf(n) != -1)) {</span>
<a href="#l14.17"></a><span id="l14.17">                   let s = preceding.pop();</span>
<a href="#l14.18"></a><span id="l14.18">                   if (preceding.length)</span>
<a href="#l14.19"></a><span id="l14.19">                     s = suffix + s;</span>
<a href="#l14.20"></a><span id="l14.20">                   inputBox.selectionStart -= s.length + suffix.length;</span>
<a href="#l14.21"></a><span id="l14.21">                   this.addString(s);</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -654,17 +654,17 @@</span>
<a href="#l14.23"></a><span id="l14.23">             }</span>
<a href="#l14.24"></a><span id="l14.24">             else {</span>
<a href="#l14.25"></a><span id="l14.25">               // If it's not a command, the only thing we can complete is a nick.</span>
<a href="#l14.26"></a><span id="l14.26">               if (!this._conv.isChat)</span>
<a href="#l14.27"></a><span id="l14.27">                 return;</span>
<a href="#l14.28"></a><span id="l14.28"> </span>
<a href="#l14.29"></a><span id="l14.29">               firstWordSuffix = &quot;: &quot;;</span>
<a href="#l14.30"></a><span id="l14.30"> </span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-              completions = [b for (b of this.buddies.keys())];</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+              completions = Array.from(this.buddies.keys());</span>
<a href="#l14.33"></a><span id="l14.33"> </span>
<a href="#l14.34"></a><span id="l14.34">               // Add recently parted nicks.</span>
<a href="#l14.35"></a><span id="l14.35">               const kIncludeNickTimespan = 300000;</span>
<a href="#l14.36"></a><span id="l14.36">               let cutoffTime = Date.now() - kIncludeNickTimespan;</span>
<a href="#l14.37"></a><span id="l14.37">               let partedNicks = Object.keys(this.partedBuddies);</span>
<a href="#l14.38"></a><span id="l14.38">               let j = partedNicks.length - 1;</span>
<a href="#l14.39"></a><span id="l14.39">               while (j &gt;= 0 &amp;&amp;</span>
<a href="#l14.40"></a><span id="l14.40">                      this.partedBuddies[partedNicks[j]].partTime &gt; cutoffTime)</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -1077,17 +1077,17 @@</span>
<a href="#l14.42"></a><span id="l14.42">                 return;</span>
<a href="#l14.43"></a><span id="l14.43">               // Add msg.who to leading list of nicks.</span>
<a href="#l14.44"></a><span id="l14.44">               let text = this.editor.value;</span>
<a href="#l14.45"></a><span id="l14.45">               if (text.indexOf(msg.who) != -1)</span>
<a href="#l14.46"></a><span id="l14.46">                 return;</span>
<a href="#l14.47"></a><span id="l14.47">               let secondNick = false;</span>
<a href="#l14.48"></a><span id="l14.48">               let pos = text.indexOf(&quot;:&quot;);</span>
<a href="#l14.49"></a><span id="l14.49">               if (pos != -1) {</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-                let completions = [b for (b of this.buddies.keys())];</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+                let completions = Array.from(this.buddies.keys());</span>
<a href="#l14.52"></a><span id="l14.52">                 // Check if the preceding words are a sequence of nicks.</span>
<a href="#l14.53"></a><span id="l14.53">                 let preceding = text.substring(0, pos).split(&quot;, &quot;);</span>
<a href="#l14.54"></a><span id="l14.54">                 if (preceding.every(n =&gt; completions.indexOf(n) != -1))</span>
<a href="#l14.55"></a><span id="l14.55">                   secondNick = true;</span>
<a href="#l14.56"></a><span id="l14.56">               }</span>
<a href="#l14.57"></a><span id="l14.57">               this.addPrompt(msg.who + (secondNick ? &quot;, &quot; : &quot;: &quot;));</span>
<a href="#l14.58"></a><span id="l14.58">               if (this._completions)</span>
<a href="#l14.59"></a><span id="l14.59">                 delete this._completions;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/components/im/content/imconversation.xml</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/components/im/content/imconversation.xml</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -490,17 +490,17 @@</span>
<a href="#l15.4"></a><span id="l15.4">             // More than one nick:</span>
<a href="#l15.5"></a><span id="l15.5">             //   &quot;nick1, nick2: &quot; -&gt; &quot;nick1: nick2&quot;</span>
<a href="#l15.6"></a><span id="l15.6">             // Single nick: remove the suffix</span>
<a href="#l15.7"></a><span id="l15.7">             //   &quot;nick1: &quot; -&gt; &quot;nick1&quot;</span>
<a href="#l15.8"></a><span id="l15.8">             let pos = inputBox.selectionStart;</span>
<a href="#l15.9"></a><span id="l15.9">             const suffix = &quot;: &quot;;</span>
<a href="#l15.10"></a><span id="l15.10">             if (pos &gt; suffix.length &amp;&amp;</span>
<a href="#l15.11"></a><span id="l15.11">                 text.substring(pos - suffix.length, pos) == suffix) {</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-              let completions = [b for (b of this.buddies.keys())];</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+              let completions = Array.from(this.buddies.keys());</span>
<a href="#l15.14"></a><span id="l15.14">               // Check if the preceding words are a sequence of nick completions.</span>
<a href="#l15.15"></a><span id="l15.15">               let preceding = text.substring(0, pos - suffix.length).split(&quot;, &quot;);</span>
<a href="#l15.16"></a><span id="l15.16">               if (preceding.every(n =&gt; completions.indexOf(n) != -1)) {</span>
<a href="#l15.17"></a><span id="l15.17">                 let s = preceding.pop();</span>
<a href="#l15.18"></a><span id="l15.18">                 if (preceding.length)</span>
<a href="#l15.19"></a><span id="l15.19">                   s = suffix + s;</span>
<a href="#l15.20"></a><span id="l15.20">                 inputBox.selectionStart -= s.length + suffix.length;</span>
<a href="#l15.21"></a><span id="l15.21">                 this.addString(s);</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -580,17 +580,17 @@</span>
<a href="#l15.23"></a><span id="l15.23">           }</span>
<a href="#l15.24"></a><span id="l15.24">           else {</span>
<a href="#l15.25"></a><span id="l15.25">             // If it's not a command, the only thing we can complete is a nick.</span>
<a href="#l15.26"></a><span id="l15.26">             if (!this._conv.isChat)</span>
<a href="#l15.27"></a><span id="l15.27">               return;</span>
<a href="#l15.28"></a><span id="l15.28"> </span>
<a href="#l15.29"></a><span id="l15.29">             firstWordSuffix = &quot;: &quot;;</span>
<a href="#l15.30"></a><span id="l15.30"> </span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-            completions = [b for (b of this.buddies.keys())];</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+            completions = Array.from(this.buddies.keys());</span>
<a href="#l15.33"></a><span id="l15.33"> </span>
<a href="#l15.34"></a><span id="l15.34"> /*</span>
<a href="#l15.35"></a><span id="l15.35">             // Add recently parted nicks.</span>
<a href="#l15.36"></a><span id="l15.36">             const kIncludeNickTimespan = 300000;</span>
<a href="#l15.37"></a><span id="l15.37">             let cutoffTime = Date.now() - kIncludeNickTimespan;</span>
<a href="#l15.38"></a><span id="l15.38">             let partedNicks = Object.keys(this.partedBuddies);</span>
<a href="#l15.39"></a><span id="l15.39">             let j = partedNicks.length - 1;</span>
<a href="#l15.40"></a><span id="l15.40">             while (j &gt;= 0 &amp;&amp;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

