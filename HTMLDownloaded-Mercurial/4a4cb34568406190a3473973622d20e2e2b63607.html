<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 26036:4a4cb34568406190a3473973622d20e2e2b63607</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 4a4cb34568406190a3473973622d20e2e2b63607" />
<meta property="og:url" content="/comm-central/rev/4a4cb34568406190a3473973622d20e2e2b63607" />
<meta property="og:description" content="Bug 1527770 - Convert Thunderbird preferences to use preferencesBindings.js; r=aceman" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 4a4cb34568406190a3473973622d20e2e2b63607 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/4a4cb34568406190a3473973622d20e2e2b63607">shortlog</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/4a4cb34568406190a3473973622d20e2e2b63607">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607">files</a> |
changeset |
<a href="/comm-central/raw-rev/4a4cb34568406190a3473973622d20e2e2b63607">raw</a>  | <a href="/comm-central/archive/4a4cb34568406190a3473973622d20e2e2b63607.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1527770">Bug 1527770</a> - Convert Thunderbird preferences to use preferencesBindings.js; r=aceman
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 07 Mar 2019 22:57:21 +1300</td></tr>

<tr>
 <td>changeset 26036</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/4a4cb34568406190a3473973622d20e2e2b63607">4a4cb34568406190a3473973622d20e2e2b63607</a></td>
</tr>



<tr>
<td>parent 26035</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/333fa90d259dc5d99a081b6bd38e9d6fd6157b3d">333fa90d259dc5d99a081b6bd38e9d6fd6157b3d</a>
</td>
</tr>

<tr>
<td>child 26037</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b0760df47d169e3a9c57cd0f55e051a600114d99">b0760df47d169e3a9c57cd0f55e051a600114d99</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=4a4cb34568406190a3473973622d20e2e2b63607">15623</a></td></tr>
<tr><td>push user</td><td>geoff@darktrojan.net</td></tr>
<tr><td>push date</td><td class="date age">Thu, 07 Mar 2019 09:58:20 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@f1ef44fd16c8 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f1ef44fd16c8c65d235f7f8d0da4a2772cdc1428">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f1ef44fd16c8c65d235f7f8d0da4a2772cdc1428&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f1ef44fd16c8c65d235f7f8d0da4a2772cdc1428&newProject=comm-central&newRevision=de90669821c5dba1ce97e6346b40584420ba60c5&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f1ef44fd16c8c65d235f7f8d0da4a2772cdc1428&newProject=comm-central&newRevision=de90669821c5dba1ce97e6346b40584420ba60c5&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f1ef44fd16c8c65d235f7f8d0da4a2772cdc1428&newProject=comm-central&newRevision=de90669821c5dba1ce97e6346b40584420ba60c5&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28aceman%29&revcount=50">aceman</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1527770">1527770</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1527770">Bug 1527770</a> - Convert Thunderbird preferences to use preferencesBindings.js; r=aceman</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.js">calendar/base/content/preferences/alarms.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.xul">calendar/base/content/preferences/alarms.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/alarms.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.js">calendar/base/content/preferences/categories.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.xul">calendar/base/content/preferences/categories.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/categories.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.js">calendar/base/content/preferences/general.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.xul">calendar/base/content/preferences/general.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/general.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.js">calendar/base/content/preferences/views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.xul">calendar/base/content/preferences/views.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/base/content/preferences/views.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.js">calendar/lightning/content/messenger-overlay-preferences.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.xul">calendar/lightning/content/messenger-overlay-preferences.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/calendar/lightning/content/messenger-overlay-preferences.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/common/bindings/preferences.xml">common/bindings/preferences.xml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/common/bindings/preferences.xml">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/common/bindings/preferences.xml">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/common/bindings/preferences.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitize.xul">mail/base/content/sanitize.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitize.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitize.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitize.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitize.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitize.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitizeDialog.js">mail/base/content/sanitizeDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitizeDialog.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitizeDialog.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitizeDialog.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitizeDialog.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/base/content/sanitizeDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/aboutPreferences.xul">mail/components/preferences/aboutPreferences.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/aboutPreferences.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/aboutPreferences.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/aboutPreferences.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/aboutPreferences.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/aboutPreferences.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.inc.xul">mail/components/preferences/advanced.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.js">mail/components/preferences/advanced.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/advanced.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.inc.xul">mail/components/preferences/applications.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.js">mail/components/preferences/applications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/applications.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/attachmentReminder.xul">mail/components/preferences/attachmentReminder.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/attachmentReminder.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/attachmentReminder.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/attachmentReminder.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/attachmentReminder.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/attachmentReminder.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.inc.xul">mail/components/preferences/chat.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.js">mail/components/preferences/chat.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/chat.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.js">mail/components/preferences/colors.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.xul">mail/components/preferences/colors.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/colors.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.inc.xul">mail/components/preferences/compose.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.js">mail/components/preferences/compose.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/compose.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.js">mail/components/preferences/connection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.xul">mail/components/preferences/connection.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/connection.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.inc.xul">mail/components/preferences/display.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.js">mail/components/preferences/display.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/display.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.js">mail/components/preferences/dockoptions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.xul">mail/components/preferences/dockoptions.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/dockoptions.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/doctype.inc.xul">mail/components/preferences/doctype.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/doctype.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/doctype.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/doctype.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/doctype.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/doctype.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/downloads.js">mail/components/preferences/downloads.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/downloads.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/downloads.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/downloads.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/downloads.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/downloads.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/fonts.xul">mail/components/preferences/fonts.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/fonts.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/fonts.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/fonts.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/fonts.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/fonts.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.inc.xul">mail/components/preferences/general.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.js">mail/components/preferences/general.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/general.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/jar.mn">mail/components/preferences/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/jar.mn">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/jar.mn">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/jar.mn">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/jar.mn">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/messagestyle.js">mail/components/preferences/messagestyle.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/messagestyle.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/messagestyle.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/messagestyle.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/messagestyle.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/messagestyle.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.js">mail/components/preferences/notifications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.xul">mail/components/preferences/notifications.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/notifications.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.js">mail/components/preferences/offline.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.xul">mail/components/preferences/offline.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/offline.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.css">mail/components/preferences/preferences.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.js">mail/components/preferences/preferences.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.xml">mail/components/preferences/preferences.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.xml">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.xml">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.xml">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.xml">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/preferences.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.inc.xul">mail/components/preferences/privacy.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.js">mail/components/preferences/privacy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/privacy.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.js">mail/components/preferences/receipts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.xul">mail/components/preferences/receipts.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/receipts.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.inc.xul">mail/components/preferences/security.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.inc.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.inc.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.inc.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.inc.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.js">mail/components/preferences/security.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/security.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.js">mail/components/preferences/sendoptions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.js">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.js">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.js">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.js">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.xul">mail/components/preferences/sendoptions.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.xul">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.xul">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.xul">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.xul">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/components/preferences/sendoptions.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/linux/mail/preferences/preferences.css">mail/themes/linux/mail/preferences/preferences.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/linux/mail/preferences/preferences.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/linux/mail/preferences/preferences.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/linux/mail/preferences/preferences.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/linux/mail/preferences/preferences.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/linux/mail/preferences/preferences.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/dialog.css">mail/themes/osx/mail/preferences/dialog.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/dialog.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/dialog.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/dialog.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/dialog.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/dialog.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/preferences.css">mail/themes/osx/mail/preferences/preferences.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/preferences.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/preferences.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/preferences.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/preferences.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/osx/mail/preferences/preferences.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/aboutPreferences.css">mail/themes/shared/mail/incontentprefs/aboutPreferences.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/aboutPreferences.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/aboutPreferences.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/aboutPreferences.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/aboutPreferences.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/aboutPreferences.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/dialog.css">mail/themes/shared/mail/incontentprefs/dialog.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/dialog.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/dialog.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/dialog.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/dialog.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/shared/mail/incontentprefs/dialog.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/windows/mail/preferences/preferences.css">mail/themes/windows/mail/preferences/preferences.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/windows/mail/preferences/preferences.css">file</a> |
<a href="/comm-central/annotate/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/windows/mail/preferences/preferences.css">annotate</a> |
<a href="/comm-central/diff/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/windows/mail/preferences/preferences.css">diff</a> |
<a href="/comm-central/comparison/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/windows/mail/preferences/preferences.css">comparison</a> |
<a href="/comm-central/log/4a4cb34568406190a3473973622d20e2e2b63607/mail/themes/windows/mail/preferences/preferences.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/preferences/alarms.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/preferences/alarms.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,16 +1,30 @@</span>
<a href="#l1.4"></a><span id="l1.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.5"></a><span id="l1.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.6"></a><span id="l1.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> /* exported gAlarmsPane */</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    { id: &quot;calendar.alarms.playsound&quot;, type: &quot;bool&quot; },</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+    { id: &quot;calendar.alarms.soundURL&quot;, type: &quot;string&quot; },</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+    { id: &quot;calendar.alarms.show&quot;, type: &quot;bool&quot; },</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+    { id: &quot;calendar.alarms.showmissed&quot;, type: &quot;bool&quot; },</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+    { id: &quot;calendar.alarms.onforevents&quot;, type: &quot;int&quot; },</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineplus">+    { id: &quot;calendar.alarms.onfortodos&quot;, type: &quot;int&quot; },</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+    { id: &quot;calendar.alarms.eventalarmlen&quot;, type: &quot;int&quot; },</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+    { id: &quot;calendar.alarms.eventalarmunit&quot;, type: &quot;string&quot; },</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+    { id: &quot;calendar.alarms.todoalarmlen&quot;, type: &quot;int&quot; },</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineplus">+    { id: &quot;calendar.alarms.todoalarmunit&quot;, type: &quot;string&quot; },</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineplus">+    { id: &quot;calendar.alarms.defaultsnoozelength&quot;, type: &quot;int&quot; },</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+]);</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+</span>
<a href="#l1.26"></a><span id="l1.26"> /**</span>
<a href="#l1.27"></a><span id="l1.27">  * Global Object to hold methods for the alarms pref pane</span>
<a href="#l1.28"></a><span id="l1.28">  */</span>
<a href="#l1.29"></a><span id="l1.29"> var gAlarmsPane = {</span>
<a href="#l1.30"></a><span id="l1.30">     /**</span>
<a href="#l1.31"></a><span id="l1.31">      * Initialize the alarms pref pane. Sets up dialog controls to match the</span>
<a href="#l1.32"></a><span id="l1.32">      * values set in prefs.</span>
<a href="#l1.33"></a><span id="l1.33">      */</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineat">@@ -43,32 +57,32 @@ var gAlarmsPane = {</span>
<a href="#l1.35"></a><span id="l1.35">     },</span>
<a href="#l1.36"></a><span id="l1.36"> </span>
<a href="#l1.37"></a><span id="l1.37">     /**</span>
<a href="#l1.38"></a><span id="l1.38">      * Handler function to be called when the calendar.alarms.soundURL pref has</span>
<a href="#l1.39"></a><span id="l1.39">      * changed. Updates the label in the dialog.</span>
<a href="#l1.40"></a><span id="l1.40">      */</span>
<a href="#l1.41"></a><span id="l1.41">     readSoundLocation: function() {</span>
<a href="#l1.42"></a><span id="l1.42">         let soundUrl = document.getElementById(&quot;alarmSoundFileField&quot;);</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineminus">-        soundUrl.value = document.getElementById(&quot;calendar.alarms.soundURL&quot;).value;</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineplus">+        soundUrl.value = Preferences.get(&quot;calendar.alarms.soundURL&quot;).value;</span>
<a href="#l1.45"></a><span id="l1.45">         if (soundUrl.value.startsWith(&quot;file://&quot;)) {</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineminus">-            soundUrl.label = this.convertURLToLocalFile(soundUrl.value).leafName;</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineplus">+            soundUrl.label = gAlarmsPane.convertURLToLocalFile(soundUrl.value).leafName;</span>
<a href="#l1.48"></a><span id="l1.48">         } else {</span>
<a href="#l1.49"></a><span id="l1.49">             soundUrl.label = soundUrl.value;</span>
<a href="#l1.50"></a><span id="l1.50">         }</span>
<a href="#l1.51"></a><span id="l1.51">         soundUrl.style.backgroundImage = &quot;url(moz-icon://&quot; + soundUrl.label + &quot;?size=16)&quot;;</span>
<a href="#l1.52"></a><span id="l1.52">         return undefined;</span>
<a href="#l1.53"></a><span id="l1.53">     },</span>
<a href="#l1.54"></a><span id="l1.54"> </span>
<a href="#l1.55"></a><span id="l1.55">     /**</span>
<a href="#l1.56"></a><span id="l1.56">      * Causes the default sound to be selected in the dialog controls</span>
<a href="#l1.57"></a><span id="l1.57">      */</span>
<a href="#l1.58"></a><span id="l1.58">     useDefaultSound: function() {</span>
<a href="#l1.59"></a><span id="l1.59">         let defaultSoundUrl = &quot;chrome://calendar/content/sound.wav&quot;;</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineminus">-        document.getElementById(&quot;calendar.alarms.soundURL&quot;).value = defaultSoundUrl;</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineplus">+        Preferences.get(&quot;calendar.alarms.soundURL&quot;).value = defaultSoundUrl;</span>
<a href="#l1.62"></a><span id="l1.62">         document.getElementById(&quot;alarmSoundCheckbox&quot;).checked = true;</span>
<a href="#l1.63"></a><span id="l1.63">         this.readSoundLocation();</span>
<a href="#l1.64"></a><span id="l1.64">     },</span>
<a href="#l1.65"></a><span id="l1.65"> </span>
<a href="#l1.66"></a><span id="l1.66">     /**</span>
<a href="#l1.67"></a><span id="l1.67">      * Opens a filepicker to open a local sound for the alarm.</span>
<a href="#l1.68"></a><span id="l1.68">      */</span>
<a href="#l1.69"></a><span id="l1.69">     browseAlarm: function() {</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineat">@@ -82,17 +96,17 @@ var gAlarmsPane = {</span>
<a href="#l1.71"></a><span id="l1.71">         picker.init(window, title, Ci.nsIFilePicker.modeOpen);</span>
<a href="#l1.72"></a><span id="l1.72">         picker.appendFilter(label, wildmat);</span>
<a href="#l1.73"></a><span id="l1.73">         picker.appendFilters(Ci.nsIFilePicker.filterAll);</span>
<a href="#l1.74"></a><span id="l1.74"> </span>
<a href="#l1.75"></a><span id="l1.75">         picker.open(rv =&gt; {</span>
<a href="#l1.76"></a><span id="l1.76">             if (rv != Ci.nsIFilePicker.returnOK || !picker.file) {</span>
<a href="#l1.77"></a><span id="l1.77">                 return;</span>
<a href="#l1.78"></a><span id="l1.78">             }</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineminus">-            document.getElementById(&quot;calendar.alarms.soundURL&quot;).value = picker.fileURL.spec;</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+            Preferences.get(&quot;calendar.alarms.soundURL&quot;).value = picker.fileURL.spec;</span>
<a href="#l1.81"></a><span id="l1.81">             document.getElementById(&quot;alarmSoundCheckbox&quot;).checked = true;</span>
<a href="#l1.82"></a><span id="l1.82">             this.readSoundLocation();</span>
<a href="#l1.83"></a><span id="l1.83">         });</span>
<a href="#l1.84"></a><span id="l1.84">     },</span>
<a href="#l1.85"></a><span id="l1.85"> </span>
<a href="#l1.86"></a><span id="l1.86">     /**</span>
<a href="#l1.87"></a><span id="l1.87">      * Plays the alarm sound currently selected.</span>
<a href="#l1.88"></a><span id="l1.88">      */</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineat">@@ -114,22 +128,25 @@ var gAlarmsPane = {</span>
<a href="#l1.90"></a><span id="l1.90">     },</span>
<a href="#l1.91"></a><span id="l1.91"> </span>
<a href="#l1.92"></a><span id="l1.92">     /**</span>
<a href="#l1.93"></a><span id="l1.93">      * Handler function to call when the calendar.alarms.playsound preference</span>
<a href="#l1.94"></a><span id="l1.94">      * has been changed. Updates the disabled state of fields that depend on</span>
<a href="#l1.95"></a><span id="l1.95">      * playing a sound.</span>
<a href="#l1.96"></a><span id="l1.96">      */</span>
<a href="#l1.97"></a><span id="l1.97">     alarmsPlaySoundPrefChanged: function() {</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineminus">-        let alarmsPlaySoundPref = document.getElementById(&quot;calendar.alarms.playsound&quot;);</span>
<a href="#l1.99"></a><span id="l1.99" class="difflineplus">+        let alarmsPlaySoundPref = Preferences.get(&quot;calendar.alarms.playsound&quot;);</span>
<a href="#l1.100"></a><span id="l1.100"> </span>
<a href="#l1.101"></a><span id="l1.101">         let items = [</span>
<a href="#l1.102"></a><span id="l1.102">             document.getElementById(&quot;alarmSoundFileField&quot;),</span>
<a href="#l1.103"></a><span id="l1.103">             document.getElementById(&quot;calendar.prefs.alarm.sound.useDefault&quot;),</span>
<a href="#l1.104"></a><span id="l1.104">             document.getElementById(&quot;calendar.prefs.alarm.sound.browse&quot;),</span>
<a href="#l1.105"></a><span id="l1.105">             document.getElementById(&quot;calendar.prefs.alarm.sound.play&quot;)</span>
<a href="#l1.106"></a><span id="l1.106">         ];</span>
<a href="#l1.107"></a><span id="l1.107"> </span>
<a href="#l1.108"></a><span id="l1.108">         for (let item of items) {</span>
<a href="#l1.109"></a><span id="l1.109">             item.disabled = !alarmsPlaySoundPref.value;</span>
<a href="#l1.110"></a><span id="l1.110">         }</span>
<a href="#l1.111"></a><span id="l1.111">     }</span>
<a href="#l1.112"></a><span id="l1.112"> };</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineplus">+</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineplus">+Preferences.get(&quot;calendar.alarms.playsound&quot;).on(&quot;change&quot;, gAlarmsPane.alarmsPlaySoundPrefChanged);</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineplus">+Preferences.get(&quot;calendar.alarms.soundURL&quot;).on(&quot;change&quot;, gAlarmsPane.readSoundLocation);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/preferences/alarms.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/preferences/alarms.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -19,53 +19,16 @@</span>
<a href="#l2.4"></a><span id="l2.4">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l2.5"></a><span id="l2.5">             src=&quot;chrome://calendar/content/calendar-dialog-utils.js&quot;/&gt;</span>
<a href="#l2.6"></a><span id="l2.6">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l2.7"></a><span id="l2.7">             src=&quot;chrome://calendar/content/calendar-ui-utils.js&quot;/&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">     &lt;vbox id=&quot;calPreferencesBoxAlarms&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10">         &lt;stringbundle id=&quot;bundleCalendarPreferences&quot;</span>
<a href="#l2.11"></a><span id="l2.11">                       src=&quot;chrome://calendar/locale/calendar.properties&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        &lt;preferences&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.playsound&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-                        name=&quot;calendar.alarms.playsound&quot;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-                        onchange=&quot;gAlarmsPane.alarmsPlaySoundPrefChanged();&quot;/&gt;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.soundURL&quot;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineminus">-                        name=&quot;calendar.alarms.soundURL&quot;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineminus">-                        type=&quot;string&quot;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineminus">-                        onchange=&quot;gAlarmsPane.readSoundLocation();&quot;/&gt;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.show&quot;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-                        name=&quot;calendar.alarms.show&quot;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineminus">-                        type=&quot;bool&quot;/&gt;</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.showmissed&quot;</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineminus">-                        name=&quot;calendar.alarms.showmissed&quot;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineminus">-                        type=&quot;bool&quot;/&gt;</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.onforevents&quot;</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineminus">-                        name=&quot;calendar.alarms.onforevents&quot;</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.onfortodos&quot;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-                        name=&quot;calendar.alarms.onfortodos&quot;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.eventalarmlen&quot;</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineminus">-                        name=&quot;calendar.alarms.eventalarmlen&quot;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.eventalarmunit&quot;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-                        name=&quot;calendar.alarms.eventalarmunit&quot;</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.todoalarmlen&quot;</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-                        name=&quot;calendar.alarms.todoalarmlen&quot;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.todoalarmunit&quot;</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-                        name=&quot;calendar.alarms.todoalarmunit&quot;</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-            &lt;preference id=&quot;calendar.alarms.defaultsnoozelength&quot;</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">-                        name=&quot;calendar.alarms.defaultsnoozelength&quot;</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineminus">-        &lt;/preferences&gt;</span>
<a href="#l2.49"></a><span id="l2.49"> </span>
<a href="#l2.50"></a><span id="l2.50">         &lt;groupbox&gt;</span>
<a href="#l2.51"></a><span id="l2.51">             &lt;label&gt;&lt;html:h2&gt;&amp;pref.alarmgoesoff.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l2.52"></a><span id="l2.52">             &lt;grid id=&quot;alarm-sound-grid&quot;&gt;</span>
<a href="#l2.53"></a><span id="l2.53">                 &lt;columns id=&quot;alarm-sound-columns&quot;&gt;</span>
<a href="#l2.54"></a><span id="l2.54">                     &lt;column id=&quot;alarm-sound-label-column&quot;/&gt;</span>
<a href="#l2.55"></a><span id="l2.55">                     &lt;column id=&quot;alarm-sound-content-column&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l2.56"></a><span id="l2.56">                 &lt;/columns&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/preferences/categories.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/preferences/categories.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -3,16 +3,18 @@</span>
<a href="#l3.4"></a><span id="l3.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6"> /* exported gCategoriesPane */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l3.9"></a><span id="l3.9"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.10"></a><span id="l3.10"> var { AppConstants } = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+Preferences.add({ id: &quot;calendar.categories.names&quot;, type: &quot;string&quot; });</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+</span>
<a href="#l3.14"></a><span id="l3.14"> var gCategoryList;</span>
<a href="#l3.15"></a><span id="l3.15"> var categoryPrefBranch = Services.prefs.getBranch(&quot;calendar.category.color.&quot;);</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17"> /**</span>
<a href="#l3.18"></a><span id="l3.18">  * Global Object to hold methods for the categories pref pane</span>
<a href="#l3.19"></a><span id="l3.19">  */</span>
<a href="#l3.20"></a><span id="l3.20"> var gCategoriesPane = {</span>
<a href="#l3.21"></a><span id="l3.21"> </span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -36,22 +38,22 @@ var gCategoriesPane = {</span>
<a href="#l3.23"></a><span id="l3.23">         }</span>
<a href="#l3.24"></a><span id="l3.24"> </span>
<a href="#l3.25"></a><span id="l3.25">         // A list of preferences to be reverted when the dialog is cancelled.</span>
<a href="#l3.26"></a><span id="l3.26">         // It needs to be a property of the parent to be visible onCancel</span>
<a href="#l3.27"></a><span id="l3.27">         if (!(&quot;backupPrefList&quot; in parent)) {</span>
<a href="#l3.28"></a><span id="l3.28">             parent.backupPrefList = [];</span>
<a href="#l3.29"></a><span id="l3.29">         }</span>
<a href="#l3.30"></a><span id="l3.30"> </span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-        let categories = document.getElementById(&quot;calendar.categories.names&quot;).value;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+        let categories = Preferences.get(&quot;calendar.categories.names&quot;).value;</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34">         // If no categories are configured load a default set from properties file</span>
<a href="#l3.35"></a><span id="l3.35">         if (!categories) {</span>
<a href="#l3.36"></a><span id="l3.36">             categories = cal.category.setupDefaultCategories();</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-            document.getElementById(&quot;calendar.categories.names&quot;).value = categories;</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+            Preferences.get(&quot;calendar.categories.names&quot;).value = categories;</span>
<a href="#l3.39"></a><span id="l3.39">         }</span>
<a href="#l3.40"></a><span id="l3.40"> </span>
<a href="#l3.41"></a><span id="l3.41">         gCategoryList = cal.category.stringToArray(categories);</span>
<a href="#l3.42"></a><span id="l3.42"> </span>
<a href="#l3.43"></a><span id="l3.43">         this.updateCategoryList();</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45">         this.mCategoryDialog = &quot;chrome://calendar/content/preferences/editCategory.xul&quot;;</span>
<a href="#l3.46"></a><span id="l3.46"> </span>
<a href="#l3.47"></a><span id="l3.47" class="difflineat">@@ -65,17 +67,17 @@ var gCategoriesPane = {</span>
<a href="#l3.48"></a><span id="l3.48"> </span>
<a href="#l3.49"></a><span id="l3.49">     /**</span>
<a href="#l3.50"></a><span id="l3.50">      * Updates the listbox containing the categories from the categories saved</span>
<a href="#l3.51"></a><span id="l3.51">      * in preferences.</span>
<a href="#l3.52"></a><span id="l3.52">      */</span>
<a href="#l3.53"></a><span id="l3.53"> </span>
<a href="#l3.54"></a><span id="l3.54">     updatePrefs: function() {</span>
<a href="#l3.55"></a><span id="l3.55">         cal.l10n.sortArrayByLocaleCollator(gCategoryList);</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-        document.getElementById(&quot;calendar.categories.names&quot;).value =</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+        Preferences.get(&quot;calendar.categories.names&quot;).value =</span>
<a href="#l3.58"></a><span id="l3.58">             cal.category.arrayToString(gCategoryList);</span>
<a href="#l3.59"></a><span id="l3.59">     },</span>
<a href="#l3.60"></a><span id="l3.60"> </span>
<a href="#l3.61"></a><span id="l3.61">     updateCategoryList: function() {</span>
<a href="#l3.62"></a><span id="l3.62">         this.updatePrefs();</span>
<a href="#l3.63"></a><span id="l3.63">         let listbox = document.getElementById(&quot;categorieslist&quot;);</span>
<a href="#l3.64"></a><span id="l3.64"> </span>
<a href="#l3.65"></a><span id="l3.65">         listbox.clearSelection();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/preferences/categories.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/preferences/categories.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -17,22 +17,16 @@</span>
<a href="#l4.4"></a><span id="l4.4">         var newTitle   = &quot;&amp;pref.categories.new.title;&quot;;</span>
<a href="#l4.5"></a><span id="l4.5">         var editTitle  = &quot;&amp;pref.categories.edit.title;&quot;;</span>
<a href="#l4.6"></a><span id="l4.6">         var overwrite  = &quot;&amp;pref.categories.overwrite;&quot;;</span>
<a href="#l4.7"></a><span id="l4.7">         var overwriteTitle = &quot;&amp;pref.categories.overwrite.title;&quot;;</span>
<a href="#l4.8"></a><span id="l4.8">         var noBlankCategories = &quot;&amp;pref.categories.noBlankCategories;&quot;;</span>
<a href="#l4.9"></a><span id="l4.9">     &lt;/script&gt;</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">     &lt;vbox id=&quot;calPreferencesBoxCategories&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-        &lt;preferences&gt;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-            &lt;preference id=&quot;calendar.categories.names&quot;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-                        name=&quot;calendar.categories.names&quot;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-        &lt;/preferences&gt;</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-</span>
<a href="#l4.18"></a><span id="l4.18">         &lt;richlistbox id=&quot;categorieslist&quot;</span>
<a href="#l4.19"></a><span id="l4.19">                      flex=&quot;1&quot;</span>
<a href="#l4.20"></a><span id="l4.20">                      seltype=&quot;multiple&quot;</span>
<a href="#l4.21"></a><span id="l4.21">                      onselect=&quot;gCategoriesPane.updateButtons()&quot;</span>
<a href="#l4.22"></a><span id="l4.22">                      ondblclick=&quot;gCategoriesPane.listOnDblClick(event)&quot;/&gt;</span>
<a href="#l4.23"></a><span id="l4.23">         &lt;hbox pack=&quot;end&quot;&gt;</span>
<a href="#l4.24"></a><span id="l4.24">             &lt;button label=&quot;&amp;pref.categories.newButton.label;&quot;</span>
<a href="#l4.25"></a><span id="l4.25">                     accesskey=&quot;&amp;pref.categories.newButton.accesskey;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/preferences/general.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/preferences/general.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,16 +1,31 @@</span>
<a href="#l5.4"></a><span id="l5.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> /* exported gCalendarGeneralPane */</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    { id: &quot;calendar.date.format&quot;, type: &quot;int&quot; },</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+    { id: &quot;calendar.event.defaultlength&quot;, type: &quot;int&quot; },</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+    { id: &quot;calendar.timezone.local&quot;, type: &quot;string&quot; },</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+    { id: &quot;calendar.task.defaultstart&quot;, type: &quot;string&quot; },</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+    { id: &quot;calendar.task.defaultstartoffset&quot;, type: &quot;int&quot; },</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+    { id: &quot;calendar.task.defaultstartoffsetunits&quot;, type: &quot;string&quot; },</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+    { id: &quot;calendar.task.defaultdue&quot;, type: &quot;string&quot; },</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+    { id: &quot;calendar.task.defaultdueoffset&quot;, type: &quot;int&quot; },</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+    { id: &quot;calendar.task.defaultdueoffsetunits&quot;, type: &quot;string&quot; },</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+    { id: &quot;calendar.view.useSystemColors&quot;, type: &quot;bool&quot; },</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+    { id: &quot;calendar.agendaListbox.soondays&quot;, type: &quot;int&quot; },</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+    { id: &quot;calendar.item.editInTab&quot;, type: &quot;bool&quot; },</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+]);</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+</span>
<a href="#l5.27"></a><span id="l5.27"> /**</span>
<a href="#l5.28"></a><span id="l5.28">  * Global Object to hold methods for the general pref pane</span>
<a href="#l5.29"></a><span id="l5.29">  */</span>
<a href="#l5.30"></a><span id="l5.30"> var gCalendarGeneralPane = {</span>
<a href="#l5.31"></a><span id="l5.31">     /**</span>
<a href="#l5.32"></a><span id="l5.32">      * Initialize the general pref pane. Sets up dialog controls to match the</span>
<a href="#l5.33"></a><span id="l5.33">      * values set in prefs.</span>
<a href="#l5.34"></a><span id="l5.34">      */</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineat">@@ -49,17 +64,17 @@ var gCalendarGeneralPane = {</span>
<a href="#l5.36"></a><span id="l5.36">             }</span>
<a href="#l5.37"></a><span id="l5.37">         }</span>
<a href="#l5.38"></a><span id="l5.38">         // the display names need to be sorted</span>
<a href="#l5.39"></a><span id="l5.39">         displayNames.sort((a, b) =&gt; a.localeCompare(b));</span>
<a href="#l5.40"></a><span id="l5.40">         for (let displayName of displayNames) {</span>
<a href="#l5.41"></a><span id="l5.41">             addMenuItem(tzMenuPopup, displayName, tzids[displayName]);</span>
<a href="#l5.42"></a><span id="l5.42">         }</span>
<a href="#l5.43"></a><span id="l5.43"> </span>
<a href="#l5.44"></a><span id="l5.44" class="difflineminus">-        let prefValue = document.getElementById(&quot;calendar-timezone-local&quot;).value;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+        let prefValue = Preferences.get(&quot;calendar.timezone.local&quot;).value;</span>
<a href="#l5.46"></a><span id="l5.46">         if (!prefValue) {</span>
<a href="#l5.47"></a><span id="l5.47">             prefValue = cal.dtz.defaultTimezone.tzid;</span>
<a href="#l5.48"></a><span id="l5.48">         }</span>
<a href="#l5.49"></a><span id="l5.49">         tzMenuList.value = prefValue;</span>
<a href="#l5.50"></a><span id="l5.50"> </span>
<a href="#l5.51"></a><span id="l5.51">         // Set the soondays menulist preference</span>
<a href="#l5.52"></a><span id="l5.52">         this.initializeTodaypaneMenu();</span>
<a href="#l5.53"></a><span id="l5.53">     },</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineat">@@ -92,17 +107,17 @@ var gCalendarGeneralPane = {</span>
<a href="#l5.55"></a><span id="l5.55">             let menuitemValue = Number(menuItem.value);</span>
<a href="#l5.56"></a><span id="l5.56">             if (menuitemValue &gt; 7) {</span>
<a href="#l5.57"></a><span id="l5.57">                 menuItem.label = unitPluralForm(menuitemValue / 7, &quot;weeks&quot;);</span>
<a href="#l5.58"></a><span id="l5.58">             } else {</span>
<a href="#l5.59"></a><span id="l5.59">                 menuItem.label = unitPluralForm(menuitemValue, &quot;days&quot;);</span>
<a href="#l5.60"></a><span id="l5.60">             }</span>
<a href="#l5.61"></a><span id="l5.61">         }</span>
<a href="#l5.62"></a><span id="l5.62"> </span>
<a href="#l5.63"></a><span id="l5.63" class="difflineminus">-        let pref = document.getElementById(&quot;calendar.agendaListbox.soondays&quot;);</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+        let pref = Preferences.get(&quot;calendar.agendaListbox.soondays&quot;);</span>
<a href="#l5.65"></a><span id="l5.65">         let soonpref = pref.value || 5;</span>
<a href="#l5.66"></a><span id="l5.66"> </span>
<a href="#l5.67"></a><span id="l5.67">         // Check if soonDays preference has been edited with a wrong value.</span>
<a href="#l5.68"></a><span id="l5.68">         if (soonpref &gt; 0 &amp;&amp; soonpref &lt;= 28) {</span>
<a href="#l5.69"></a><span id="l5.69">             if (soonpref % 7 != 0) {</span>
<a href="#l5.70"></a><span id="l5.70">                 let intSoonpref = Math.floor(soonpref / 7) * 7;</span>
<a href="#l5.71"></a><span id="l5.71">                 soonpref = (intSoonpref == 0 ? soonpref : intSoonpref);</span>
<a href="#l5.72"></a><span id="l5.72">                 pref.value = soonpref;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/preferences/general.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/preferences/general.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -23,56 +23,16 @@</span>
<a href="#l6.4"></a><span id="l6.4"> </span>
<a href="#l6.5"></a><span id="l6.5">     &lt;!-- Get the localized text for use in the .js --&gt;</span>
<a href="#l6.6"></a><span id="l6.6">     &lt;script type=&quot;application/javascript&quot;&gt;</span>
<a href="#l6.7"></a><span id="l6.7">         var labelLong  = &quot;&amp;pref.dateformat.long;&quot;;</span>
<a href="#l6.8"></a><span id="l6.8">         var labelShort = &quot;&amp;pref.dateformat.short;&quot;;</span>
<a href="#l6.9"></a><span id="l6.9">     &lt;/script&gt;</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">     &lt;vbox id=&quot;calPreferencesBoxGeneral&quot;&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-        &lt;preferences&gt;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-            &lt;preference id=&quot;calendar.date.format&quot;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-                        name=&quot;calendar.date.format&quot;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-            &lt;preference id=&quot;calendar.event.defaultlength&quot;</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-                        name=&quot;calendar.event.defaultlength&quot;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-            &lt;preference id=&quot;calendar-timezone-local&quot;</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-                        name=&quot;calendar.timezone.local&quot;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-            &lt;preference id=&quot;calendar.task.defaultstart&quot;</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-                        name=&quot;calendar.task.defaultstart&quot;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-            &lt;preference id=&quot;calendar.task.defaultstartoffset&quot;</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-                        name=&quot;calendar.task.defaultstartoffset&quot;</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-            &lt;preference id=&quot;calendar.task.defaultstartoffsetunits&quot;</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-                        name=&quot;calendar.task.defaultstartoffsetunits&quot;</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-            &lt;preference id=&quot;calendar.task.defaultdue&quot;</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-                        name=&quot;calendar.task.defaultdue&quot;</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-            &lt;preference id=&quot;calendar.task.defaultdueoffset&quot;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-                        name=&quot;calendar.task.defaultdueoffset&quot;</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-            &lt;preference id=&quot;calendar.task.defaultdueoffsetunits&quot;</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineminus">-                        name=&quot;calendar.task.defaultdueoffsetunits&quot;</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineminus">-                        type=&quot;string&quot;/&gt;</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineminus">-            &lt;preference id=&quot;calendar.view.useSystemColors&quot;</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-                        name=&quot;calendar.view.useSystemColors&quot;</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-                        type=&quot;bool&quot;/&gt;</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineminus">-            &lt;preference id=&quot;calendar.agendaListbox.soondays&quot;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineminus">-                        name=&quot;calendar.agendaListbox.soondays&quot;</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-            &lt;preference id=&quot;calendar.item.editInTab&quot;</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-                        name=&quot;calendar.item.editInTab&quot;</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-                        type=&quot;bool&quot;/&gt;</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-        &lt;/preferences&gt;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-</span>
<a href="#l6.52"></a><span id="l6.52">         &lt;groupbox&gt;</span>
<a href="#l6.53"></a><span id="l6.53">             &lt;label&gt;&lt;html:h2&gt;&amp;pref.mainbox.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l6.54"></a><span id="l6.54">             &lt;vbox align=&quot;left&quot;&gt;</span>
<a href="#l6.55"></a><span id="l6.55">               &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l6.56"></a><span id="l6.56">                 &lt;label value=&quot;&amp;pref.dateformat.label;&quot;</span>
<a href="#l6.57"></a><span id="l6.57">                        accesskey=&quot;&amp;pref.dateformat.accesskey;&quot;</span>
<a href="#l6.58"></a><span id="l6.58">                        control=&quot;dateformat&quot;/&gt;</span>
<a href="#l6.59"></a><span id="l6.59">                 &lt;menulist id=&quot;dateformat&quot; crop=&quot;none&quot;</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineat">@@ -92,17 +52,17 @@</span>
<a href="#l6.61"></a><span id="l6.61"> </span>
<a href="#l6.62"></a><span id="l6.62">         &lt;groupbox&gt;</span>
<a href="#l6.63"></a><span id="l6.63">             &lt;label&gt;&lt;html:h2&gt;&amp;pref.timezones.caption;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l6.64"></a><span id="l6.64">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l6.65"></a><span id="l6.65">                 &lt;label value=&quot;&amp;pref.timezones.label;&quot;</span>
<a href="#l6.66"></a><span id="l6.66">                        accesskey=&quot;&amp;pref.timezones.accesskey;&quot;</span>
<a href="#l6.67"></a><span id="l6.67">                        control=&quot;calendar-timezone-menulist&quot;/&gt;</span>
<a href="#l6.68"></a><span id="l6.68">                 &lt;menulist id=&quot;calendar-timezone-menulist&quot;</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineminus">-                          preference=&quot;calendar-timezone-local&quot;&gt;</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+                          preference=&quot;calendar.timezone.local&quot;&gt;</span>
<a href="#l6.71"></a><span id="l6.71">                     &lt;menupopup id=&quot;calendar-timezone-menupopup&quot;/&gt;</span>
<a href="#l6.72"></a><span id="l6.72">                 &lt;/menulist&gt;</span>
<a href="#l6.73"></a><span id="l6.73">             &lt;/hbox&gt;</span>
<a href="#l6.74"></a><span id="l6.74">         &lt;/groupbox&gt;</span>
<a href="#l6.75"></a><span id="l6.75"> </span>
<a href="#l6.76"></a><span id="l6.76">         &lt;groupbox id=&quot;defaults-itemtype-groupbox&quot;&gt;</span>
<a href="#l6.77"></a><span id="l6.77">             &lt;label&gt;&lt;html:h2 id=&quot;defaults-itemtype-caption&quot;&gt;&amp;pref.defaults.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l6.78"></a><span id="l6.78">             &lt;hbox id=&quot;defaults-itemtype-box&quot; align=&quot;top&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/preferences/views.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/preferences/views.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,14 +1,32 @@</span>
<a href="#l7.4"></a><span id="l7.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.5"></a><span id="l7.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.6"></a><span id="l7.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> /* exported gViewsPane */</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+Preferences.addAll([</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+    { id: &quot;calendar.week.start&quot;, type: &quot;int&quot; },</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+    { id: &quot;calendar.view-minimonth.showWeekNumber&quot;, type: &quot;bool&quot; },</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    { id: &quot;calendar.week.d0sundaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+    { id: &quot;calendar.week.d1mondaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+    { id: &quot;calendar.week.d2tuesdaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+    { id: &quot;calendar.week.d3wednesdaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+    { id: &quot;calendar.week.d4thursdaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+    { id: &quot;calendar.week.d5fridaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+    { id: &quot;calendar.week.d6saturdaysoff&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+    { id: &quot;calendar.view.daystarthour&quot;, type: &quot;int&quot; },</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+    { id: &quot;calendar.view.dayendhour&quot;, type: &quot;int&quot; },</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+    { id: &quot;calendar.view.visiblehours&quot;, type: &quot;int&quot; },</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+    { id: &quot;calendar.weeks.inview&quot;, type: &quot;int&quot; },</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+    { id: &quot;calendar.previousweeks.inview&quot;, type: &quot;int&quot; },</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+    { id: &quot;calendar.view.showLocation&quot;, type: &quot;bool&quot; },</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+]);</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+</span>
<a href="#l7.28"></a><span id="l7.28"> /**</span>
<a href="#l7.29"></a><span id="l7.29">  * Global Object to hold methods for the views pref pane</span>
<a href="#l7.30"></a><span id="l7.30">  */</span>
<a href="#l7.31"></a><span id="l7.31"> var gViewsPane = {</span>
<a href="#l7.32"></a><span id="l7.32">     /**</span>
<a href="#l7.33"></a><span id="l7.33">      * Initialize the views pref pane. Sets up dialog controls to match the</span>
<a href="#l7.34"></a><span id="l7.34">      * values set in prefs.</span>
<a href="#l7.35"></a><span id="l7.35">      */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/preferences/views.xul</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/preferences/views.xul</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -15,71 +15,16 @@</span>
<a href="#l8.4"></a><span id="l8.4">          xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l8.7"></a><span id="l8.7">             src=&quot;chrome://calendar/content/preferences/views.js&quot;/&gt;</span>
<a href="#l8.8"></a><span id="l8.8">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l8.9"></a><span id="l8.9">             src=&quot;chrome://calendar/content/calendar-ui-utils.js&quot;/&gt;</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11">     &lt;vbox id=&quot;calPreferencesBoxViews&quot;&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-        &lt;preferences&gt;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-            &lt;preference id=&quot;calendar.week.start&quot;</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-                        name=&quot;calendar.week.start&quot;</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-            &lt;preference id=&quot;calendar.view-minimonth.showWeekNumber&quot;</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-                        name=&quot;calendar.view-minimonth.showWeekNumber&quot;</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-                        type=&quot;bool&quot;/&gt;</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d0sundaysoff&quot;</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineminus">-                        name=&quot;calendar.week.d0sundaysoff&quot;</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d1mondaysoff&quot;</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineminus">-                        name=&quot;calendar.week.d1mondaysoff&quot;</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d2tuesdaysoff&quot;</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineminus">-                        name=&quot;calendar.week.d2tuesdaysoff&quot;</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d3wednesdaysoff&quot;</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-                        name=&quot;calendar.week.d3wednesdaysoff&quot;</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d4thursdaysoff&quot;</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineminus">-                        name=&quot;calendar.week.d4thursdaysoff&quot;</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d5fridaysoff&quot;</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineminus">-                        name=&quot;calendar.week.d5fridaysoff&quot;</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineminus">-            &lt;preference id=&quot;calendar.week.d6saturdaysoff&quot;</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineminus">-                        name=&quot;calendar.week.d6saturdaysoff&quot;</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineminus">-                        inverted=&quot;true&quot;/&gt;</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-            &lt;preference id=&quot;calendar.view.daystarthour&quot;</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-                        name=&quot;calendar.view.daystarthour&quot;</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-            &lt;preference id=&quot;calendar.view.dayendhour&quot;</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-                        name=&quot;calendar.view.dayendhour&quot;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-            &lt;preference id=&quot;calendar.view.visiblehours&quot;</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-                        name=&quot;calendar.view.visiblehours&quot;</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-            &lt;preference id=&quot;calendar.weeks.inview&quot;</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineminus">-                        name=&quot;calendar.weeks.inview&quot;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-            &lt;preference id=&quot;calendar.previousweeks.inview&quot;</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-                        name=&quot;calendar.previousweeks.inview&quot;</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineminus">-            &lt;preference id=&quot;calendar.view.showLocation&quot;</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineminus">-                        name=&quot;calendar.view.showLocation&quot;</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineminus">-                        type=&quot;bool&quot;/&gt;</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineminus">-        &lt;/preferences&gt;</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineminus">-</span>
<a href="#l8.67"></a><span id="l8.67">         &lt;groupbox&gt;</span>
<a href="#l8.68"></a><span id="l8.68">             &lt;label&gt;&lt;html:h2&gt;&amp;pref.calendar.view.allview.caption;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l8.69"></a><span id="l8.69">             &lt;hbox&gt;</span>
<a href="#l8.70"></a><span id="l8.70">                 &lt;hbox align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.71"></a><span id="l8.71">                     &lt;label value=&quot;&amp;pref.weekstarts.label;&quot;</span>
<a href="#l8.72"></a><span id="l8.72">                            accesskey=&quot;&amp;pref.weekstarts.accesskey;&quot;</span>
<a href="#l8.73"></a><span id="l8.73">                            control=&quot;weekstarts&quot;/&gt;</span>
<a href="#l8.74"></a><span id="l8.74">                     &lt;menulist id=&quot;weekstarts&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-preferences.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-preferences.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,19 +1,21 @@</span>
<a href="#l9.4"></a><span id="l9.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.5"></a><span id="l9.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.6"></a><span id="l9.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8"> /* exported gLightningPane */</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+Preferences.add({ id: &quot;calendar.preferences.lightning.selectedTabIndex&quot;, type: &quot;int&quot; });</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineplus">+</span>
<a href="#l9.12"></a><span id="l9.12"> var gLightningPane = {</span>
<a href="#l9.13"></a><span id="l9.13">     mInitialized: false,</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15">     init: function() {</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-        let preference = document.getElementById(&quot;calendar.preferences.lightning.selectedTabIndex&quot;);</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+        let preference = Preferences.get(&quot;calendar.preferences.lightning.selectedTabIndex&quot;);</span>
<a href="#l9.18"></a><span id="l9.18">         let ltnPrefs = document.getElementById(&quot;calPreferencesTabbox&quot;);</span>
<a href="#l9.19"></a><span id="l9.19">         if (preference.value) {</span>
<a href="#l9.20"></a><span id="l9.20">             ltnPrefs.selectedIndex = preference.value;</span>
<a href="#l9.21"></a><span id="l9.21">         }</span>
<a href="#l9.22"></a><span id="l9.22">         ltnPrefs.addEventListener(&quot;select&quot;, gLightningPane.tabSelectionChanged.bind(this));</span>
<a href="#l9.23"></a><span id="l9.23">         this.mInitialized = true;</span>
<a href="#l9.24"></a><span id="l9.24"> </span>
<a href="#l9.25"></a><span id="l9.25">         let elements = document.querySelectorAll(&quot;#paneLightning preference&quot;);</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineat">@@ -22,17 +24,17 @@ var gLightningPane = {</span>
<a href="#l9.27"></a><span id="l9.27">         }</span>
<a href="#l9.28"></a><span id="l9.28">     },</span>
<a href="#l9.29"></a><span id="l9.29"> </span>
<a href="#l9.30"></a><span id="l9.30">     tabSelectionChanged: function() {</span>
<a href="#l9.31"></a><span id="l9.31">         if (!this.mInitialized) {</span>
<a href="#l9.32"></a><span id="l9.32">             return;</span>
<a href="#l9.33"></a><span id="l9.33">         }</span>
<a href="#l9.34"></a><span id="l9.34">         let ltnPrefs = document.getElementById(&quot;calPreferencesTabbox&quot;);</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-        let preference = document.getElementById(&quot;calendar.preferences.lightning.selectedTabIndex&quot;);</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+        let preference = Preferences.get(&quot;calendar.preferences.lightning.selectedTabIndex&quot;);</span>
<a href="#l9.37"></a><span id="l9.37">         preference.valueFromPreferences = ltnPrefs.selectedIndex;</span>
<a href="#l9.38"></a><span id="l9.38">     }</span>
<a href="#l9.39"></a><span id="l9.39"> };</span>
<a href="#l9.40"></a><span id="l9.40"> </span>
<a href="#l9.41"></a><span id="l9.41"> gCalendarGeneralPane.init();</span>
<a href="#l9.42"></a><span id="l9.42"> gAlarmsPane.init();</span>
<a href="#l9.43"></a><span id="l9.43"> gCategoriesPane.init();</span>
<a href="#l9.44"></a><span id="l9.44"> gViewsPane.init();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-preferences.xul</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-preferences.xul</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -14,21 +14,16 @@</span>
<a href="#l10.4"></a><span id="l10.4"> &lt;?xml-stylesheet href=&quot;chrome://lightning/skin/lightning.css&quot;?&gt;</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6"> &lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8">         &lt;prefpane id=&quot;paneLightning&quot;</span>
<a href="#l10.9"></a><span id="l10.9">                   flex=&quot;1&quot;</span>
<a href="#l10.10"></a><span id="l10.10">                   insertbefore=&quot;paneAdvanced&quot;</span>
<a href="#l10.11"></a><span id="l10.11">                   label=&quot;&amp;lightning.preferencesLabel;&quot;&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-            &lt;preferences&gt;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-                &lt;preference id=&quot;calendar.preferences.lightning.selectedTabIndex&quot;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-                            name=&quot;calendar.preferences.lightning.selectedTabIndex&quot;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-                            type=&quot;int&quot;/&gt;</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-            &lt;/preferences&gt;</span>
<a href="#l10.17"></a><span id="l10.17">             &lt;tabbox id=&quot;calPreferencesTabbox&quot;</span>
<a href="#l10.18"></a><span id="l10.18">                     flex=&quot;1&quot;&gt;</span>
<a href="#l10.19"></a><span id="l10.19">                 &lt;tabs&gt;</span>
<a href="#l10.20"></a><span id="l10.20">                     &lt;tab id=&quot;calPreferencesTabGeneral&quot;</span>
<a href="#l10.21"></a><span id="l10.21">                          label=&quot;&amp;paneGeneral.title;&quot;/&gt;</span>
<a href="#l10.22"></a><span id="l10.22">                     &lt;tab id=&quot;calPreferencesTabAlarms&quot;</span>
<a href="#l10.23"></a><span id="l10.23">                          label=&quot;&amp;paneAlarms.title;&quot;/&gt;</span>
<a href="#l10.24"></a><span id="l10.24">                     &lt;tab id=&quot;calPreferencesTabCategories&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/base/content/sanitize.xul</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/base/content/sanitize.xul</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,16 +1,15 @@</span>
<a href="#l11.4"></a><span id="l11.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.7"></a><span id="l11.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.8"></a><span id="l11.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l11.12"></a><span id="l11.12"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/sanitizeDialog.css&quot;?&gt;</span>
<a href="#l11.13"></a><span id="l11.13"> &lt;?xml-stylesheet href=&quot;chrome://messenger/content/sanitizeDialog.css&quot;?&gt;</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15"> &lt;!DOCTYPE dialog [</span>
<a href="#l11.16"></a><span id="l11.16">   &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span>
<a href="#l11.17"></a><span id="l11.17">   &lt;!ENTITY % sanitizeDTD SYSTEM &quot;chrome://messenger/locale/sanitize.dtd&quot;&gt;</span>
<a href="#l11.18"></a><span id="l11.18">   %brandDTD;</span>
<a href="#l11.19"></a><span id="l11.19">   %sanitizeDTD;</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineat">@@ -26,39 +25,25 @@</span>
<a href="#l11.21"></a><span id="l11.21">         ondialogaccept=&quot;gSanitizePromptDialog.sanitize();&quot;&gt;</span>
<a href="#l11.22"></a><span id="l11.22"> </span>
<a href="#l11.23"></a><span id="l11.23">   &lt;vbox id=&quot;SanitizeDialogPane&quot;&gt;</span>
<a href="#l11.24"></a><span id="l11.24">     &lt;stringbundle id=&quot;bundleBrowser&quot;</span>
<a href="#l11.25"></a><span id="l11.25">             src=&quot;chrome://messenger/locale/messenger.properties&quot;/&gt;</span>
<a href="#l11.26"></a><span id="l11.26"> </span>
<a href="#l11.27"></a><span id="l11.27">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l11.28"></a><span id="l11.28">             src=&quot;chrome://messenger/content/sanitize.js&quot;/&gt;</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineminus">-</span>
<a href="#l11.30"></a><span id="l11.30">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l11.31"></a><span id="l11.31">             src=&quot;chrome://messenger/content/sanitizeDialog.js&quot;/&gt;</span>
<a href="#l11.32"></a><span id="l11.32"> </span>
<a href="#l11.33"></a><span id="l11.33" class="difflineminus">-    &lt;preferences id=&quot;sanitizePreferences&quot;&gt;</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-      &lt;preference id=&quot;privacy.cpd.history&quot; name=&quot;privacy.cpd.history&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-      &lt;preference id=&quot;privacy.cpd.cookies&quot; name=&quot;privacy.cpd.cookies&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">-      &lt;preference id=&quot;privacy.cpd.cache&quot;   name=&quot;privacy.cpd.cache&quot;   type=&quot;bool&quot;/&gt;</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineminus">-</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineminus">-    &lt;preferences id=&quot;nonItemPreferences&quot;&gt;</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineminus">-      &lt;preference id=&quot;privacy.sanitize.timeSpan&quot;</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineminus">-                  name=&quot;privacy.sanitize.timeSpan&quot;</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineminus">-</span>
<a href="#l11.45"></a><span id="l11.45">     &lt;hbox id=&quot;SanitizeDurationBox&quot; align=&quot;center&quot;&gt;</span>
<a href="#l11.46"></a><span id="l11.46">       &lt;label value=&quot;&amp;clearTimeDuration.label;&quot;</span>
<a href="#l11.47"></a><span id="l11.47">              accesskey=&quot;&amp;clearTimeDuration.accesskey;&quot;</span>
<a href="#l11.48"></a><span id="l11.48">              control=&quot;sanitizeDurationChoice&quot;</span>
<a href="#l11.49"></a><span id="l11.49">              id=&quot;sanitizeDurationLabel&quot;/&gt;</span>
<a href="#l11.50"></a><span id="l11.50">       &lt;menulist id=&quot;sanitizeDurationChoice&quot;</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineminus">-                preference=&quot;privacy.sanitize.timeSpan&quot;</span>
<a href="#l11.52"></a><span id="l11.52">                 onselect=&quot;gSanitizePromptDialog.selectByTimespan();&quot;</span>
<a href="#l11.53"></a><span id="l11.53">                 flex=&quot;1&quot;&gt;</span>
<a href="#l11.54"></a><span id="l11.54">         &lt;menupopup id=&quot;sanitizeDurationPopup&quot;&gt;</span>
<a href="#l11.55"></a><span id="l11.55">           &lt;menuitem label=&quot;&amp;clearTimeDuration.lastHour;&quot; value=&quot;1&quot;/&gt;</span>
<a href="#l11.56"></a><span id="l11.56">           &lt;menuitem label=&quot;&amp;clearTimeDuration.last2Hours;&quot; value=&quot;2&quot;/&gt;</span>
<a href="#l11.57"></a><span id="l11.57">           &lt;menuitem label=&quot;&amp;clearTimeDuration.last4Hours;&quot; value=&quot;3&quot;/&gt;</span>
<a href="#l11.58"></a><span id="l11.58">           &lt;menuitem label=&quot;&amp;clearTimeDuration.today;&quot; value=&quot;4&quot;/&gt;</span>
<a href="#l11.59"></a><span id="l11.59">           &lt;menuseparator/&gt;</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineat">@@ -95,21 +80,21 @@</span>
<a href="#l11.61"></a><span id="l11.61">              value=&quot;&amp;detailsProgressiveDisclosure.label;&quot;</span>
<a href="#l11.62"></a><span id="l11.62">              accesskey=&quot;&amp;detailsProgressiveDisclosure.accesskey;&quot;</span>
<a href="#l11.63"></a><span id="l11.63">              control=&quot;detailsExpander&quot;/&gt;</span>
<a href="#l11.64"></a><span id="l11.64">     &lt;/hbox&gt;</span>
<a href="#l11.65"></a><span id="l11.65">     &lt;vbox id=&quot;itemList&quot; collapsed=&quot;true&quot; persist=&quot;collapsed&quot;&gt;</span>
<a href="#l11.66"></a><span id="l11.66">       &lt;checkbox label=&quot;&amp;itemHistory.label;&quot;</span>
<a href="#l11.67"></a><span id="l11.67">                 accesskey=&quot;&amp;itemHistory.accesskey;&quot;</span>
<a href="#l11.68"></a><span id="l11.68">                 preference=&quot;privacy.cpd.history&quot;</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-                onsyncfrompreference=&quot;return gSanitizePromptDialog.onReadGeneric();&quot;/&gt;</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+                oncommand=&quot;gSanitizePromptDialog.onReadGeneric();&quot;/&gt;</span>
<a href="#l11.71"></a><span id="l11.71">       &lt;checkbox label=&quot;&amp;itemCookies.label;&quot;</span>
<a href="#l11.72"></a><span id="l11.72">                 accesskey=&quot;&amp;itemCookies.accesskey;&quot;</span>
<a href="#l11.73"></a><span id="l11.73">                 preference=&quot;privacy.cpd.cookies&quot;</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineminus">-                onsyncfrompreference=&quot;return gSanitizePromptDialog.onReadGeneric();&quot;/&gt;</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineplus">+                oncommand=&quot;gSanitizePromptDialog.onReadGeneric();&quot;/&gt;</span>
<a href="#l11.76"></a><span id="l11.76">       &lt;checkbox label=&quot;&amp;itemCache.label;&quot;</span>
<a href="#l11.77"></a><span id="l11.77">                 accesskey=&quot;&amp;itemCache.accesskey;&quot;</span>
<a href="#l11.78"></a><span id="l11.78">                 preference=&quot;privacy.cpd.cache&quot;</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineminus">-                onsyncfrompreference=&quot;return gSanitizePromptDialog.onReadGeneric();&quot;/&gt;</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+                oncommand=&quot;gSanitizePromptDialog.onReadGeneric();&quot;/&gt;</span>
<a href="#l11.81"></a><span id="l11.81">     &lt;/vbox&gt;</span>
<a href="#l11.82"></a><span id="l11.82"> </span>
<a href="#l11.83"></a><span id="l11.83">   &lt;/vbox&gt;</span>
<a href="#l11.84"></a><span id="l11.84"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/base/content/sanitizeDialog.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/base/content/sanitizeDialog.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -13,46 +13,44 @@ var gSanitizePromptDialog = {</span>
<a href="#l12.4"></a><span id="l12.4">     return this._bundleBrowser;</span>
<a href="#l12.5"></a><span id="l12.5">   },</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7">   get selectedTimespan() {</span>
<a href="#l12.8"></a><span id="l12.8">     var durList = document.getElementById(&quot;sanitizeDurationChoice&quot;);</span>
<a href="#l12.9"></a><span id="l12.9">     return parseInt(durList.value);</span>
<a href="#l12.10"></a><span id="l12.10">   },</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  get sanitizePreferences() {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-    if (!this._sanitizePreferences) {</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-      this._sanitizePreferences =</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-        document.getElementById(&quot;sanitizePreferences&quot;);</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-    }</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-    return this._sanitizePreferences;</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  },</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-</span>
<a href="#l12.20"></a><span id="l12.20">   get warningBox() {</span>
<a href="#l12.21"></a><span id="l12.21">     return document.getElementById(&quot;sanitizeEverythingWarningBox&quot;);</span>
<a href="#l12.22"></a><span id="l12.22">   },</span>
<a href="#l12.23"></a><span id="l12.23"> </span>
<a href="#l12.24"></a><span id="l12.24">   init() {</span>
<a href="#l12.25"></a><span id="l12.25">     // This is used by selectByTimespan() to determine if the window has loaded.</span>
<a href="#l12.26"></a><span id="l12.26">     this._inited = true;</span>
<a href="#l12.27"></a><span id="l12.27"> </span>
<a href="#l12.28"></a><span id="l12.28">     var s = new Sanitizer();</span>
<a href="#l12.29"></a><span id="l12.29">     s.prefDomain = &quot;privacy.cpd.&quot;;</span>
<a href="#l12.30"></a><span id="l12.30"> </span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+    document.getElementById(&quot;sanitizeDurationChoice&quot;).value =</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+      Services.prefs.getIntPref(&quot;privacy.sanitize.timeSpan&quot;);</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+</span>
<a href="#l12.34"></a><span id="l12.34">     let sanitizeItemList = document.querySelectorAll(&quot;#itemList &gt; [preference]&quot;);</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineminus">-    for (let i = 0; i &lt; sanitizeItemList.length; i++) {</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineminus">-      let prefItem = sanitizeItemList[i];</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+    for (let prefItem of sanitizeItemList) {</span>
<a href="#l12.38"></a><span id="l12.38">       let name = s.getNameFromPreference(prefItem.getAttribute(&quot;preference&quot;));</span>
<a href="#l12.39"></a><span id="l12.39">       if (!s.canClearItem(name)) {</span>
<a href="#l12.40"></a><span id="l12.40">         prefItem.preference = null;</span>
<a href="#l12.41"></a><span id="l12.41">         prefItem.checked = false;</span>
<a href="#l12.42"></a><span id="l12.42">         prefItem.disabled = true;</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+      } else {</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+        prefItem.checked = Services.prefs.getBoolPref(prefItem.getAttribute(&quot;preference&quot;));</span>
<a href="#l12.45"></a><span id="l12.45">       }</span>
<a href="#l12.46"></a><span id="l12.46">     }</span>
<a href="#l12.47"></a><span id="l12.47"> </span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+    this.onReadGeneric();</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+</span>
<a href="#l12.50"></a><span id="l12.50">     document.documentElement.getButton(&quot;accept&quot;).label =</span>
<a href="#l12.51"></a><span id="l12.51">       this.bundleBrowser.getString(&quot;sanitizeButtonOK&quot;);</span>
<a href="#l12.52"></a><span id="l12.52"> </span>
<a href="#l12.53"></a><span id="l12.53">     if (this.selectedTimespan === Sanitizer.TIMESPAN_EVERYTHING) {</span>
<a href="#l12.54"></a><span id="l12.54">       this.prepareWarning();</span>
<a href="#l12.55"></a><span id="l12.55">       this.warningBox.hidden = false;</span>
<a href="#l12.56"></a><span id="l12.56">       document.title =</span>
<a href="#l12.57"></a><span id="l12.57">         this.bundleBrowser.getString(&quot;sanitizeDialog2.everything.title&quot;);</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineat">@@ -137,23 +135,22 @@ var gSanitizePromptDialog = {</span>
<a href="#l12.59"></a><span id="l12.59">   /**</span>
<a href="#l12.60"></a><span id="l12.60">    * Called when the value of a preference element is synced from the actual</span>
<a href="#l12.61"></a><span id="l12.61">    * pref.  Enables or disables the OK button appropriately.</span>
<a href="#l12.62"></a><span id="l12.62">    */</span>
<a href="#l12.63"></a><span id="l12.63">   onReadGeneric() {</span>
<a href="#l12.64"></a><span id="l12.64">     var found = false;</span>
<a href="#l12.65"></a><span id="l12.65"> </span>
<a href="#l12.66"></a><span id="l12.66">     // Find any other pref that's checked and enabled.</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineminus">-    var i = 0;</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineminus">-    while (!found &amp;&amp; i &lt; this.sanitizePreferences.childNodes.length) {</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-      var preference = this.sanitizePreferences.childNodes[i];</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineminus">-</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineminus">-      found = !!preference.value &amp;&amp;</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineminus">-              !preference.disabled;</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineminus">-      i++;</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+    let sanitizeItemList = document.querySelectorAll(&quot;#itemList &gt; [preference]&quot;);</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+    for (let prefItem of sanitizeItemList) {</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+      found = !prefItem.disabled &amp;&amp; prefItem.checked;</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+      if (found) {</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineplus">+        break;</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+      }</span>
<a href="#l12.80"></a><span id="l12.80">     }</span>
<a href="#l12.81"></a><span id="l12.81"> </span>
<a href="#l12.82"></a><span id="l12.82">     try {</span>
<a href="#l12.83"></a><span id="l12.83">       document.documentElement.getButton(&quot;accept&quot;).disabled = !found;</span>
<a href="#l12.84"></a><span id="l12.84">     } catch (e) {}</span>
<a href="#l12.85"></a><span id="l12.85"> </span>
<a href="#l12.86"></a><span id="l12.86">     // Update the warning prompt if needed</span>
<a href="#l12.87"></a><span id="l12.87">     this.prepareWarning(true);</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineat">@@ -167,34 +164,33 @@ var gSanitizePromptDialog = {</span>
<a href="#l12.89"></a><span id="l12.89">    * without it the dialog has no OK and Cancel buttons -- the prefs are not</span>
<a href="#l12.90"></a><span id="l12.90">    * updated on dialogaccept on platforms that don't support instant-apply</span>
<a href="#l12.91"></a><span id="l12.91">    * (i.e., Windows).  We must therefore manually set the prefs from their</span>
<a href="#l12.92"></a><span id="l12.92">    * corresponding preference elements.</span>
<a href="#l12.93"></a><span id="l12.93">    */</span>
<a href="#l12.94"></a><span id="l12.94">   updatePrefs() {</span>
<a href="#l12.95"></a><span id="l12.95">     Sanitizer.prefs.setIntPref(&quot;timeSpan&quot;, this.selectedTimespan);</span>
<a href="#l12.96"></a><span id="l12.96"> </span>
<a href="#l12.97"></a><span id="l12.97" class="difflineminus">-    // Now manually set the prefs from their corresponding preference</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineminus">-    // elements.</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineminus">-    var prefs = this.sanitizePreferences.rootBranch;</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineminus">-    for (let i = 0; i &lt; this.sanitizePreferences.childNodes.length; ++i) {</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineminus">-      var p = this.sanitizePreferences.childNodes[i];</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineminus">-      prefs.setBoolPref(p.name, p.value);</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineplus">+    // Now manually set the prefs from their corresponding preference elements.</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineplus">+    let sanitizeItemList = document.querySelectorAll(&quot;#itemList &gt; [preference]&quot;);</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineplus">+    for (let prefItem of sanitizeItemList) {</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineplus">+      let prefName = prefItem.getAttribute(&quot;preference&quot;);</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineplus">+      Services.prefs.setBoolPref(prefName, prefItem.checked);</span>
<a href="#l12.108"></a><span id="l12.108">     }</span>
<a href="#l12.109"></a><span id="l12.109">   },</span>
<a href="#l12.110"></a><span id="l12.110"> </span>
<a href="#l12.111"></a><span id="l12.111">   /**</span>
<a href="#l12.112"></a><span id="l12.112">    * Check if all of the history items have been selected like the default status.</span>
<a href="#l12.113"></a><span id="l12.113">    */</span>
<a href="#l12.114"></a><span id="l12.114">   hasNonSelectedItems() {</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineminus">-    let checkboxes = document.querySelectorAll(&quot;#itemList &gt; [preference]&quot;);</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineminus">-    for (let i = 0; i &lt; checkboxes.length; ++i) {</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineminus">-      let pref = document.getElementById(checkboxes[i].getAttribute(&quot;preference&quot;));</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineminus">-      if (!pref.value)</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+    let sanitizeItemList = document.querySelectorAll(&quot;#itemList &gt; [preference]&quot;);</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineplus">+    for (let prefItem of sanitizeItemList) {</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineplus">+      if (!prefItem.checked) {</span>
<a href="#l12.122"></a><span id="l12.122">         return true;</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineplus">+      }</span>
<a href="#l12.124"></a><span id="l12.124">     }</span>
<a href="#l12.125"></a><span id="l12.125">     return false;</span>
<a href="#l12.126"></a><span id="l12.126">   },</span>
<a href="#l12.127"></a><span id="l12.127"> </span>
<a href="#l12.128"></a><span id="l12.128">   /**</span>
<a href="#l12.129"></a><span id="l12.129">    * Show the history items list.</span>
<a href="#l12.130"></a><span id="l12.130">    */</span>
<a href="#l12.131"></a><span id="l12.131">   showItemList() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/components/preferences/aboutPreferences.xul</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/components/preferences/aboutPreferences.xul</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -26,16 +26,17 @@</span>
<a href="#l13.4"></a><span id="l13.4"> #endif</span>
<a href="#l13.5"></a><span id="l13.5"> #ifdef XP_UNIX</span>
<a href="#l13.6"></a><span id="l13.6"> #ifndef XP_MACOSX</span>
<a href="#l13.7"></a><span id="l13.7">          title=&quot;&amp;prefWindow.titleGNOME;&quot;&gt;</span>
<a href="#l13.8"></a><span id="l13.8"> #else</span>
<a href="#l13.9"></a><span id="l13.9">          title=&quot;&amp;prefWindow.titleMAC;&quot;&gt;</span>
<a href="#l13.10"></a><span id="l13.10"> #endif</span>
<a href="#l13.11"></a><span id="l13.11"> #endif</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l13.13"></a><span id="l13.13"> </span>
<a href="#l13.14"></a><span id="l13.14">   &lt;stringbundle id=&quot;bundleBrand&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l13.15"></a><span id="l13.15">   &lt;stringbundle id=&quot;bundlePreferences&quot;</span>
<a href="#l13.16"></a><span id="l13.16">                 src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l13.17"></a><span id="l13.17">   &lt;linkset&gt;</span>
<a href="#l13.18"></a><span id="l13.18">     &lt;html:link rel=&quot;localization&quot; href=&quot;branding/brand.ftl&quot;/&gt;</span>
<a href="#l13.19"></a><span id="l13.19">     &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/preferences/preferences.ftl&quot;/&gt;</span>
<a href="#l13.20"></a><span id="l13.20">     &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/preferences/fonts.ftl&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/components/preferences/advanced.inc.xul</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/components/preferences/advanced.inc.xul</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -3,122 +3,21 @@</span>
<a href="#l14.4"></a><span id="l14.4"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l14.5"></a><span id="l14.5">   &lt;prefpane id=&quot;paneAdvanced&quot; label=&quot;&amp;paneAdvanced.title;&quot;&gt;</span>
<a href="#l14.6"></a><span id="l14.6"> #ifdef MOZ_UPDATER</span>
<a href="#l14.7"></a><span id="l14.7">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/aboutDialog-appUpdater.js&quot;/&gt;</span>
<a href="#l14.8"></a><span id="l14.8"> #endif</span>
<a href="#l14.9"></a><span id="l14.9">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/advanced.js&quot;/&gt;</span>
<a href="#l14.10"></a><span id="l14.10">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://communicator/content/utilityOverlay.js&quot;/&gt;</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    &lt;preferences id=&quot;advancedPreferences&quot;&gt;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-      &lt;preference id=&quot;mail.preferences.advanced.selectedTabIndex&quot;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-                  name=&quot;mail.preferences.advanced.selectedTabIndex&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-      &lt;!-- General tab --&gt;</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-      &lt;preference id=&quot;general.autoScroll&quot;</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineminus">-                  name=&quot;general.autoScroll&quot;</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineminus">-      &lt;preference id=&quot;general.smoothScroll&quot;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineminus">-                  name=&quot;general.smoothScroll&quot;</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-      &lt;preference id=&quot;intl.regional_prefs.use_os_locales&quot;</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineminus">-                  name=&quot;intl.regional_prefs.use_os_locales&quot;</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineminus">-      &lt;preference id=&quot;mailnews.database.global.indexer.enabled&quot;</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineminus">-                  name=&quot;mailnews.database.global.indexer.enabled&quot;</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineminus">-</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-      &lt;preference id=&quot;layers.acceleration.disabled&quot;</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineminus">-                  name=&quot;layers.acceleration.disabled&quot;</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-                  type=&quot;bool&quot;</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineminus">-                  inverted=&quot;true&quot;</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineminus">-                  onchange=&quot;gAdvancedPane.updateHardwareAcceleration(this.value);&quot;/&gt;</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineminus">-</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineminus">-#ifdef HAVE_SHELL_SERVICE</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineminus">-      &lt;preference id=&quot;mail.shell.checkDefaultClient&quot;</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineminus">-                  name=&quot;mail.shell.checkDefaultClient&quot;</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineminus">-      &lt;preference id=&quot;pref.general.disable_button.default_mail&quot;</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineminus">-                  name=&quot;pref.general.disable_button.default_mail&quot;</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineminus">-#endif</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineminus">-      &lt;!-- Keep one id, so that we don't have to do platform specific stuff later --&gt;</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineminus">-#ifdef XP_WIN</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineminus">-      &lt;preference id=&quot;searchintegration.enable&quot;</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineminus">-                  name=&quot;mail.winsearch.enable&quot;</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-#else</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineminus">-#ifdef XP_MACOSX</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineminus">-      &lt;preference id=&quot;searchintegration.enable&quot;</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineminus">-                  name=&quot;mail.spotlight.enable&quot;</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineminus">-#else</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineminus">-      &lt;!-- We don't have any OS search integration for linux yet. --&gt;</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineminus">-      &lt;preference id=&quot;searchintegration.enable&quot;</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineminus">-                  name=&quot;mail.XXX.enable&quot;</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineminus">-#endif</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineminus">-#endif</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineminus">-</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineminus">-      &lt;!-- Data Choices tab --&gt;</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineminus">-#ifdef MOZ_TELEMETRY_REPORTING</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineminus">-      &lt;preference id=&quot;toolkit.telemetry.enabled&quot;</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineminus">-                  name=&quot;toolkit.telemetry.enabled&quot;</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineminus">-#endif</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineminus">-</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineminus">-      &lt;!-- Network tab --&gt;</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineminus">-      &lt;preference id=&quot;mail.prompt_purge_threshhold&quot;</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineminus">-                  name=&quot;mail.prompt_purge_threshhold&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineminus">-      &lt;preference id=&quot;mail.purge_threshhold_mb&quot;</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineminus">-                  name=&quot;mail.purge_threshhold_mb&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineminus">-      &lt;preference id=&quot;browser.cache.disk.capacity&quot;</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineminus">-                  name=&quot;browser.cache.disk.capacity&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineminus">-      &lt;preference id=&quot;browser.cache.disk.smart_size.enabled&quot;</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineminus">-                  name=&quot;browser.cache.disk.smart_size.enabled&quot;</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineminus">-                  inverted=&quot;true&quot;</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineminus">-#ifdef MOZ_UPDATER</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineminus">-      &lt;!-- Update tab --&gt;</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineminus">-      &lt;preference id=&quot;app.update.disable_button.showUpdateHistory&quot;</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineminus">-                  name=&quot;app.update.disable_button.showUpdateHistory&quot;</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineminus">-</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineminus">-#ifdef MOZ_MAINTENANCE_SERVICE</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineminus">-      &lt;preference id=&quot;app.update.service.enabled&quot;</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineminus">-                  name=&quot;app.update.service.enabled&quot;</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineminus">-#endif</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineminus">-#endif</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineminus">-      &lt;!-- Certificates tab --&gt;</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineminus">-      &lt;preference id=&quot;security.default_personal_cert&quot;</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineminus">-                  name=&quot;security.default_personal_cert&quot;</span>
<a href="#l14.96"></a><span id="l14.96" class="difflineminus">-                  type=&quot;string&quot;/&gt;</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineminus">-      &lt;preference id=&quot;security.disable_button.openCertManager&quot;</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineminus">-                  name=&quot;security.disable_button.openCertManager&quot;</span>
<a href="#l14.99"></a><span id="l14.99" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.100"></a><span id="l14.100" class="difflineminus">-      &lt;preference id=&quot;security.disable_button.openDeviceManager&quot;</span>
<a href="#l14.101"></a><span id="l14.101" class="difflineminus">-                  name=&quot;security.disable_button.openDeviceManager&quot;</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineminus">-      &lt;preference id=&quot;security.OCSP.enabled&quot;</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineminus">-                  name=&quot;security.OCSP.enabled&quot;</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l14.106"></a><span id="l14.106" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineminus">-</span>
<a href="#l14.108"></a><span id="l14.108"> #ifdef HAVE_SHELL_SERVICE</span>
<a href="#l14.109"></a><span id="l14.109">     &lt;stringbundle id=&quot;bundlePreferences&quot; src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l14.110"></a><span id="l14.110">     &lt;stringbundle id=&quot;bundleBrand&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l14.111"></a><span id="l14.111"> #endif</span>
<a href="#l14.112"></a><span id="l14.112"> </span>
<a href="#l14.113"></a><span id="l14.113" class="difflineminus">-    &lt;commandset id=&quot;networkTabCommandSet&quot;&gt;</span>
<a href="#l14.114"></a><span id="l14.114" class="difflineminus">-      &lt;command id=&quot;cmd_toggleCompact&quot;</span>
<a href="#l14.115"></a><span id="l14.115" class="difflineminus">-               oncommand=&quot;gAdvancedPane.updateCompactOptions();&quot;/&gt;</span>
<a href="#l14.116"></a><span id="l14.116" class="difflineminus">-    &lt;/commandset&gt;</span>
<a href="#l14.117"></a><span id="l14.117" class="difflineminus">-</span>
<a href="#l14.118"></a><span id="l14.118">     &lt;tabbox id=&quot;advancedPrefs&quot; flex=&quot;1&quot; onselect=&quot;gAdvancedPane.tabSelectionChanged();&quot;&gt;</span>
<a href="#l14.119"></a><span id="l14.119">       &lt;tabs id=&quot;advancedPrefsTabs&quot;&gt;</span>
<a href="#l14.120"></a><span id="l14.120">         &lt;tab id=&quot;generalTab&quot; label=&quot;&amp;itemGeneral.label;&quot;/&gt;</span>
<a href="#l14.121"></a><span id="l14.121"> #ifdef MOZ_DATA_REPORTING</span>
<a href="#l14.122"></a><span id="l14.122">         &lt;tab id=&quot;dataChoicesTab&quot; label=&quot;&amp;dataChoicesTab.label;&quot;/&gt;</span>
<a href="#l14.123"></a><span id="l14.123"> #endif</span>
<a href="#l14.124"></a><span id="l14.124">         &lt;tab id=&quot;networkingTab&quot; label=&quot;&amp;itemNetworking.label;&quot;/&gt;</span>
<a href="#l14.125"></a><span id="l14.125"> #ifdef MOZ_UPDATER</span>
<a href="#l14.126"></a><span id="l14.126" class="difflineat">@@ -357,19 +256,19 @@</span>
<a href="#l14.127"></a><span id="l14.127">                        onsynctopreference=&quot;return gAdvancedPane.writeCacheSize();&quot;</span>
<a href="#l14.128"></a><span id="l14.128">                        aria-labelledby=&quot;useCacheBefore cacheSize useCacheAfter&quot;/&gt;</span>
<a href="#l14.129"></a><span id="l14.129">               &lt;label id=&quot;useCacheAfter&quot; flex=&quot;1&quot;&gt;&amp;useCacheAfter.label;&lt;/label&gt;</span>
<a href="#l14.130"></a><span id="l14.130">             &lt;/hbox&gt;</span>
<a href="#l14.131"></a><span id="l14.131">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l14.132"></a><span id="l14.132">                 &lt;checkbox id=&quot;offlineCompactFolder&quot;</span>
<a href="#l14.133"></a><span id="l14.133">                           label=&quot;&amp;offlineCompactFolders.label;&quot;</span>
<a href="#l14.134"></a><span id="l14.134">                           accesskey=&quot;&amp;offlineCompactFolders.accesskey;&quot;</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineminus">-                          command=&quot;cmd_toggleCompact&quot;</span>
<a href="#l14.136"></a><span id="l14.136">                           aria-labelledby=&quot;offlineCompactFolder offlineCompactFolderMin compactFolderMB&quot;</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineminus">-                          preference=&quot;mail.prompt_purge_threshhold&quot;/&gt;</span>
<a href="#l14.138"></a><span id="l14.138" class="difflineplus">+                          preference=&quot;mail.prompt_purge_threshhold&quot;</span>
<a href="#l14.139"></a><span id="l14.139" class="difflineplus">+                          oncommand=&quot;gAdvancedPane.updateCompactOptions(this.checked);&quot;/&gt;</span>
<a href="#l14.140"></a><span id="l14.140">                 &lt;textbox id=&quot;offlineCompactFolderMin&quot; size=&quot;4&quot; value=&quot;20&quot;</span>
<a href="#l14.141"></a><span id="l14.141">                          type=&quot;number&quot; min=&quot;1&quot; max=&quot;2048&quot; increment=&quot;10&quot;</span>
<a href="#l14.142"></a><span id="l14.142">                          preference=&quot;mail.purge_threshhold_mb&quot;</span>
<a href="#l14.143"></a><span id="l14.143">                          aria-labelledby=&quot;offlineCompactFolder offlineCompactFolderMin compactFolderMB&quot;/&gt;</span>
<a href="#l14.144"></a><span id="l14.144">                 &lt;label id=&quot;compactFolderMB&quot; value=&quot;&amp;offlineCompactFoldersMB.label;&quot;/&gt;</span>
<a href="#l14.145"></a><span id="l14.145">             &lt;/hbox&gt;</span>
<a href="#l14.146"></a><span id="l14.146">           &lt;/groupbox&gt;</span>
<a href="#l14.147"></a><span id="l14.147">         &lt;/tabpanel&gt;</span>
<a href="#l14.148"></a><span id="l14.148" class="difflineat">@@ -550,9 +449,8 @@</span>
<a href="#l14.149"></a><span id="l14.149">                     oncommand=&quot;gAdvancedPane.showSecurityDevices();&quot;</span>
<a href="#l14.150"></a><span id="l14.150">                     preference=&quot;security.disable_button.openDeviceManager&quot;/&gt;</span>
<a href="#l14.151"></a><span id="l14.151">           &lt;/hbox&gt;</span>
<a href="#l14.152"></a><span id="l14.152">         &lt;/tabpanel&gt;</span>
<a href="#l14.153"></a><span id="l14.153">       &lt;/tabpanels&gt;</span>
<a href="#l14.154"></a><span id="l14.154">     &lt;/tabbox&gt;</span>
<a href="#l14.155"></a><span id="l14.155">     &lt;separator/&gt;</span>
<a href="#l14.156"></a><span id="l14.156">   &lt;/prefpane&gt;</span>
<a href="#l14.157"></a><span id="l14.157" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/components/preferences/advanced.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/components/preferences/advanced.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -11,21 +11,56 @@</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5"> // Load DownloadUtils module for convertByteUnits</span>
<a href="#l15.6"></a><span id="l15.6"> var {DownloadUtils} = ChromeUtils.import(&quot;resource://gre/modules/DownloadUtils.jsm&quot;);</span>
<a href="#l15.7"></a><span id="l15.7"> var {XPCOMUtils} = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l15.8"></a><span id="l15.8"> var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l15.9"></a><span id="l15.9"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l15.10"></a><span id="l15.10"> var {L10nRegistry} = ChromeUtils.import(&quot;resource://gre/modules/L10nRegistry.jsm&quot;);</span>
<a href="#l15.11"></a><span id="l15.11"> var {Localization} = ChromeUtils.import(&quot;resource://gre/modules/Localization.jsm&quot;);</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-ChromeUtils.defineModuleGetter(this, &quot;UpdateUtils&quot;,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-  &quot;resource://gre/modules/UpdateUtils.jsm&quot;);</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+var {UpdateUtils} = ChromeUtils.import(&quot;resource://gre/modules/UpdateUtils.jsm&quot;);</span>
<a href="#l15.15"></a><span id="l15.15"> </span>
<a href="#l15.16"></a><span id="l15.16"> const AUTO_UPDATE_CHANGED_TOPIC = &quot;auto-update-config-change&quot;;</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+Preferences.addAll([</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+  { id: &quot;mail.preferences.advanced.selectedTabIndex&quot;, type: &quot;int&quot; },</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+  { id: &quot;general.autoScroll&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+  { id: &quot;general.smoothScroll&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+  { id: &quot;intl.regional_prefs.use_os_locales&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+  { id: &quot;mailnews.database.global.indexer.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+  { id: &quot;layers.acceleration.disabled&quot;, type: &quot;bool&quot;, inverted: true },</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+  { id: &quot;searchintegration.enable&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+  { id: &quot;mail.prompt_purge_threshhold&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineplus">+  { id: &quot;mail.purge_threshhold_mb&quot;, type: &quot;int&quot; },</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+  { id: &quot;browser.cache.disk.capacity&quot;, type: &quot;int&quot; },</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+  { id: &quot;browser.cache.disk.smart_size.enabled&quot;, inverted: true, type: &quot;bool&quot; },</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+  { id: &quot;security.default_personal_cert&quot;, type: &quot;string&quot; },</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineplus">+  { id: &quot;security.disable_button.openCertManager&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+  { id: &quot;security.disable_button.openDeviceManager&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+  { id: &quot;security.OCSP.enabled&quot;, type: &quot;int&quot; },</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+]);</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+if (AppConstants.HAVE_SHELL_SERVICE) {</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+  Preferences.addAll([</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+    { id: &quot;mail.shell.checkDefaultClient&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+    { id: &quot;pref.general.disable_button.default_mail&quot;, type: &quot;bool&quot; },</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+  ]);</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+}</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+if (AppConstants.MOZ_TELEMETRY_REPORTING) {</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+  Preferences.add({ id: &quot;toolkit.telemetry.enabled&quot;, type: &quot;bool&quot; });</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+}</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+if (AppConstants.MOZ_UPDATER) {</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+  Preferences.add({ id: &quot;app.update.disable_button.showUpdateHistory&quot;, type: &quot;bool&quot; });</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+  if (AppConstants.MOZ_MAINTENANCE_SERVICE) {</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+    Preferences.add({ id: &quot;app.update.service.enabled&quot;, type: &quot;bool&quot; });</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+  }</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+}</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+</span>
<a href="#l15.54"></a><span id="l15.54"> document.getElementById(&quot;paneAdvanced&quot;)</span>
<a href="#l15.55"></a><span id="l15.55">         .addEventListener(&quot;paneload&quot;, function() { gAdvancedPane.init(); });</span>
<a href="#l15.56"></a><span id="l15.56"> </span>
<a href="#l15.57"></a><span id="l15.57"> var gAdvancedPane = {</span>
<a href="#l15.58"></a><span id="l15.58">   mPane: null,</span>
<a href="#l15.59"></a><span id="l15.59">   mInitialized: false,</span>
<a href="#l15.60"></a><span id="l15.60">   mShellServiceWorking: false,</span>
<a href="#l15.61"></a><span id="l15.61">   mBundle: null,</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineat">@@ -43,17 +78,17 @@ var gAdvancedPane = {</span>
<a href="#l15.63"></a><span id="l15.63">     this.formatLocaleSetLabels();</span>
<a href="#l15.64"></a><span id="l15.64"> </span>
<a href="#l15.65"></a><span id="l15.65">     if (Services.prefs.getBoolPref(&quot;intl.multilingual.enabled&quot;)) {</span>
<a href="#l15.66"></a><span id="l15.66">       this.initMessengerLocale();</span>
<a href="#l15.67"></a><span id="l15.67">     }</span>
<a href="#l15.68"></a><span id="l15.68"> </span>
<a href="#l15.69"></a><span id="l15.69">     if (!((&quot;arguments&quot; in window) &amp;&amp; window.arguments[1])) {</span>
<a href="#l15.70"></a><span id="l15.70">       // If no tab was specified, select the last used tab.</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineminus">-      let preference = document.getElementById(&quot;mail.preferences.advanced.selectedTabIndex&quot;);</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+      let preference = Preferences.get(&quot;mail.preferences.advanced.selectedTabIndex&quot;);</span>
<a href="#l15.73"></a><span id="l15.73">       if (preference.value)</span>
<a href="#l15.74"></a><span id="l15.74">         document.getElementById(&quot;advancedPrefs&quot;).selectedIndex = preference.value;</span>
<a href="#l15.75"></a><span id="l15.75">     }</span>
<a href="#l15.76"></a><span id="l15.76">     if (AppConstants.MOZ_UPDATER)</span>
<a href="#l15.77"></a><span id="l15.77">       this.updateReadPrefs();</span>
<a href="#l15.78"></a><span id="l15.78"> </span>
<a href="#l15.79"></a><span id="l15.79">     // Default store type initialization.</span>
<a href="#l15.80"></a><span id="l15.80">     let storeTypeElement = document.getElementById(&quot;storeTypeMenulist&quot;);</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineat">@@ -80,17 +115,17 @@ var gAdvancedPane = {</span>
<a href="#l15.82"></a><span id="l15.82">       hideSearchUI = true;</span>
<a href="#l15.83"></a><span id="l15.83">     }</span>
<a href="#l15.84"></a><span id="l15.84"> </span>
<a href="#l15.85"></a><span id="l15.85">     if (hideSearchUI) {</span>
<a href="#l15.86"></a><span id="l15.86">       document.getElementById(&quot;searchIntegrationContainer&quot;).hidden = true;</span>
<a href="#l15.87"></a><span id="l15.87">     } else if (disableSearchUI) {</span>
<a href="#l15.88"></a><span id="l15.88">       let searchCheckbox = document.getElementById(&quot;searchIntegration&quot;);</span>
<a href="#l15.89"></a><span id="l15.89">       searchCheckbox.checked = false;</span>
<a href="#l15.90"></a><span id="l15.90" class="difflineminus">-      document.getElementById(&quot;searchintegration.enable&quot;).disabled = true;</span>
<a href="#l15.91"></a><span id="l15.91" class="difflineplus">+      Preferences.get(&quot;searchintegration.enable&quot;).disabled = true;</span>
<a href="#l15.92"></a><span id="l15.92">     }</span>
<a href="#l15.93"></a><span id="l15.93"> </span>
<a href="#l15.94"></a><span id="l15.94">     // If the shell service is not working, disable the &quot;Check now&quot; button</span>
<a href="#l15.95"></a><span id="l15.95">     // and &quot;perform check at startup&quot; checkbox.</span>
<a href="#l15.96"></a><span id="l15.96">     try {</span>
<a href="#l15.97"></a><span id="l15.97">       Cc[&quot;@mozilla.org/mail/shell-service;1&quot;].getService(Ci.nsIShellService);</span>
<a href="#l15.98"></a><span id="l15.98">       this.mShellServiceWorking = true;</span>
<a href="#l15.99"></a><span id="l15.99">     } catch (ex) {</span>
<a href="#l15.100"></a><span id="l15.100" class="difflineat">@@ -207,18 +242,18 @@ var gAdvancedPane = {</span>
<a href="#l15.101"></a><span id="l15.101">       Services.obs.addObserver(this, AUTO_UPDATE_CHANGED_TOPIC);</span>
<a href="#l15.102"></a><span id="l15.102">     }</span>
<a href="#l15.103"></a><span id="l15.103"> </span>
<a href="#l15.104"></a><span id="l15.104">     this.mInitialized = true;</span>
<a href="#l15.105"></a><span id="l15.105">   },</span>
<a href="#l15.106"></a><span id="l15.106"> </span>
<a href="#l15.107"></a><span id="l15.107">   tabSelectionChanged() {</span>
<a href="#l15.108"></a><span id="l15.108">     if (this.mInitialized) {</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineminus">-      document.getElementById(&quot;mail.preferences.advanced.selectedTabIndex&quot;)</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineminus">-              .valueFromPreferences = document.getElementById(&quot;advancedPrefs&quot;).selectedIndex;</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineplus">+      Preferences.get(&quot;mail.preferences.advanced.selectedTabIndex&quot;)</span>
<a href="#l15.112"></a><span id="l15.112" class="difflineplus">+                 .valueFromPreferences = document.getElementById(&quot;advancedPrefs&quot;).selectedIndex;</span>
<a href="#l15.113"></a><span id="l15.113">     }</span>
<a href="#l15.114"></a><span id="l15.114">   },</span>
<a href="#l15.115"></a><span id="l15.115"> </span>
<a href="#l15.116"></a><span id="l15.116">   /**</span>
<a href="#l15.117"></a><span id="l15.117">    * Checks whether Thunderbird is currently registered with the operating</span>
<a href="#l15.118"></a><span id="l15.118">    * system as the default app for mail, rss and news.  If Thunderbird is not</span>
<a href="#l15.119"></a><span id="l15.119">    * currently the default app, the user is given the option of making it the</span>
<a href="#l15.120"></a><span id="l15.120">    * default for each type; otherwise, the user is informed that Thunderbird is</span>
<a href="#l15.121"></a><span id="l15.121" class="difflineat">@@ -287,26 +322,26 @@ var gAdvancedPane = {</span>
<a href="#l15.122"></a><span id="l15.122">     document.getElementById(&quot;useCacheBefore&quot;).disabled = smartSizeEnabled;</span>
<a href="#l15.123"></a><span id="l15.123">     document.getElementById(&quot;cacheSize&quot;).disabled = smartSizeEnabled;</span>
<a href="#l15.124"></a><span id="l15.124">     document.getElementById(&quot;useCacheAfter&quot;).disabled = smartSizeEnabled;</span>
<a href="#l15.125"></a><span id="l15.125">   },</span>
<a href="#l15.126"></a><span id="l15.126"> </span>
<a href="#l15.127"></a><span id="l15.127">   readSmartSizeEnabled() {</span>
<a href="#l15.128"></a><span id="l15.128">     // The smart_size.enabled preference element is inverted=&quot;true&quot;, so its</span>
<a href="#l15.129"></a><span id="l15.129">     // value is the opposite of the actual pref value</span>
<a href="#l15.130"></a><span id="l15.130" class="difflineminus">-    var disabled = document.getElementById(&quot;browser.cache.disk.smart_size.enabled&quot;).value;</span>
<a href="#l15.131"></a><span id="l15.131" class="difflineplus">+    var disabled = Preferences.get(&quot;browser.cache.disk.smart_size.enabled&quot;).value;</span>
<a href="#l15.132"></a><span id="l15.132">     this.updateCacheSizeUI(!disabled);</span>
<a href="#l15.133"></a><span id="l15.133">   },</span>
<a href="#l15.134"></a><span id="l15.134"> </span>
<a href="#l15.135"></a><span id="l15.135">   /**</span>
<a href="#l15.136"></a><span id="l15.136">    * Converts the cache size from units of KB to units of MB and returns that</span>
<a href="#l15.137"></a><span id="l15.137">    * value.</span>
<a href="#l15.138"></a><span id="l15.138">    */</span>
<a href="#l15.139"></a><span id="l15.139">   readCacheSize() {</span>
<a href="#l15.140"></a><span id="l15.140" class="difflineminus">-    var preference = document.getElementById(&quot;browser.cache.disk.capacity&quot;);</span>
<a href="#l15.141"></a><span id="l15.141" class="difflineplus">+    var preference = Preferences.get(&quot;browser.cache.disk.capacity&quot;);</span>
<a href="#l15.142"></a><span id="l15.142">     return preference.value / 1024;</span>
<a href="#l15.143"></a><span id="l15.143">   },</span>
<a href="#l15.144"></a><span id="l15.144"> </span>
<a href="#l15.145"></a><span id="l15.145">   /**</span>
<a href="#l15.146"></a><span id="l15.146">    * Converts the cache size as specified in UI (in MB) to KB and returns that</span>
<a href="#l15.147"></a><span id="l15.147">    * value.</span>
<a href="#l15.148"></a><span id="l15.148">    */</span>
<a href="#l15.149"></a><span id="l15.149">   writeCacheSize() {</span>
<a href="#l15.150"></a><span id="l15.150" class="difflineat">@@ -375,20 +410,20 @@ var gAdvancedPane = {</span>
<a href="#l15.151"></a><span id="l15.151">     Services.prompt.confirmEx(window, title, message, buttonFlags,</span>
<a href="#l15.152"></a><span id="l15.152">                               null, null, null, null, {});</span>
<a href="#l15.153"></a><span id="l15.153">   },</span>
<a href="#l15.154"></a><span id="l15.154"> </span>
<a href="#l15.155"></a><span id="l15.155">   showUpdates() {</span>
<a href="#l15.156"></a><span id="l15.156">     gSubDialog.open(&quot;chrome://mozapps/content/update/history.xul&quot;);</span>
<a href="#l15.157"></a><span id="l15.157">   },</span>
<a href="#l15.158"></a><span id="l15.158"> </span>
<a href="#l15.159"></a><span id="l15.159" class="difflineminus">-  updateCompactOptions(aCompactEnabled) {</span>
<a href="#l15.160"></a><span id="l15.160" class="difflineplus">+  updateCompactOptions() {</span>
<a href="#l15.161"></a><span id="l15.161">     document.getElementById(&quot;offlineCompactFolderMin&quot;).disabled =</span>
<a href="#l15.162"></a><span id="l15.162" class="difflineminus">-      !document.getElementById(&quot;offlineCompactFolder&quot;).checked ||</span>
<a href="#l15.163"></a><span id="l15.163" class="difflineminus">-      document.getElementById(&quot;mail.purge_threshhold_mb&quot;).locked;</span>
<a href="#l15.164"></a><span id="l15.164" class="difflineplus">+      !Preferences.get(&quot;mail.prompt_purge_threshhold&quot;).value ||</span>
<a href="#l15.165"></a><span id="l15.165" class="difflineplus">+      Preferences.get(&quot;mail.purge_threshhold_mb&quot;).locked;</span>
<a href="#l15.166"></a><span id="l15.166">   },</span>
<a href="#l15.167"></a><span id="l15.167"> </span>
<a href="#l15.168"></a><span id="l15.168">   updateSubmitCrashReports(aChecked) {</span>
<a href="#l15.169"></a><span id="l15.169">     Cc[&quot;@mozilla.org/toolkit/crash-reporter;1&quot;]</span>
<a href="#l15.170"></a><span id="l15.170">       .getService(Ci.nsICrashReporter)</span>
<a href="#l15.171"></a><span id="l15.171">       .submitReports = aChecked;</span>
<a href="#l15.172"></a><span id="l15.172">   },</span>
<a href="#l15.173"></a><span id="l15.173">   /**</span>
<a href="#l15.174"></a><span id="l15.174" class="difflineat">@@ -422,17 +457,17 @@ var gAdvancedPane = {</span>
<a href="#l15.175"></a><span id="l15.175">     gSubDialog.open(&quot;chrome://pippki/content/certManager.xul&quot;);</span>
<a href="#l15.176"></a><span id="l15.176">   },</span>
<a href="#l15.177"></a><span id="l15.177"> </span>
<a href="#l15.178"></a><span id="l15.178">   /**</span>
<a href="#l15.179"></a><span id="l15.179">    * security.OCSP.enabled is an integer value for legacy reasons.</span>
<a href="#l15.180"></a><span id="l15.180">    * A value of 1 means OCSP is enabled. Any other value means it is disabled.</span>
<a href="#l15.181"></a><span id="l15.181">    */</span>
<a href="#l15.182"></a><span id="l15.182">   readEnableOCSP() {</span>
<a href="#l15.183"></a><span id="l15.183" class="difflineminus">-    var preference = document.getElementById(&quot;security.OCSP.enabled&quot;);</span>
<a href="#l15.184"></a><span id="l15.184" class="difflineplus">+    var preference = Preferences.get(&quot;security.OCSP.enabled&quot;);</span>
<a href="#l15.185"></a><span id="l15.185">     // This is the case if the preference is the default value.</span>
<a href="#l15.186"></a><span id="l15.186">     if (preference.value === undefined) {</span>
<a href="#l15.187"></a><span id="l15.187">       return true;</span>
<a href="#l15.188"></a><span id="l15.188">     }</span>
<a href="#l15.189"></a><span id="l15.189">     return preference.value == 1;</span>
<a href="#l15.190"></a><span id="l15.190">   },</span>
<a href="#l15.191"></a><span id="l15.191"> </span>
<a href="#l15.192"></a><span id="l15.192">   /**</span>
<a href="#l15.193"></a><span id="l15.193" class="difflineat">@@ -448,20 +483,23 @@ var gAdvancedPane = {</span>
<a href="#l15.194"></a><span id="l15.194">    */</span>
<a href="#l15.195"></a><span id="l15.195">   showSecurityDevices() {</span>
<a href="#l15.196"></a><span id="l15.196">     gSubDialog.open(&quot;chrome://pippki/content/device_manager.xul&quot;);</span>
<a href="#l15.197"></a><span id="l15.197">   },</span>
<a href="#l15.198"></a><span id="l15.198"> </span>
<a href="#l15.199"></a><span id="l15.199">   /**</span>
<a href="#l15.200"></a><span id="l15.200">    * When the user toggles the layers.acceleration.disabled pref,</span>
<a href="#l15.201"></a><span id="l15.201">    * sync its new value to the gfx.direct2d.disabled pref too.</span>
<a href="#l15.202"></a><span id="l15.202" class="difflineplus">+   * Note that layers.acceleration.disabled is inverted.</span>
<a href="#l15.203"></a><span id="l15.203">    */</span>
<a href="#l15.204"></a><span id="l15.204" class="difflineminus">-  updateHardwareAcceleration(aVal) {</span>
<a href="#l15.205"></a><span id="l15.205" class="difflineminus">-    if (AppConstants.platforms == &quot;win&quot;)</span>
<a href="#l15.206"></a><span id="l15.206" class="difflineminus">-      Services.prefs.setBoolPref(&quot;gfx.direct2d.disabled&quot;, !aVal);</span>
<a href="#l15.207"></a><span id="l15.207" class="difflineplus">+  updateHardwareAcceleration() {</span>
<a href="#l15.208"></a><span id="l15.208" class="difflineplus">+    if (AppConstants.platform == &quot;win&quot;) {</span>
<a href="#l15.209"></a><span id="l15.209" class="difflineplus">+      let preference = Preferences.get(&quot;layers.acceleration.disabled&quot;);</span>
<a href="#l15.210"></a><span id="l15.210" class="difflineplus">+      Services.prefs.setBoolPref(&quot;gfx.direct2d.disabled&quot;, !preference.value);</span>
<a href="#l15.211"></a><span id="l15.211" class="difflineplus">+    }</span>
<a href="#l15.212"></a><span id="l15.212">   },</span>
<a href="#l15.213"></a><span id="l15.213"> </span>
<a href="#l15.214"></a><span id="l15.214">   // DATA CHOICES TAB</span>
<a href="#l15.215"></a><span id="l15.215"> </span>
<a href="#l15.216"></a><span id="l15.216">   /**</span>
<a href="#l15.217"></a><span id="l15.217">    * Open a text link.</span>
<a href="#l15.218"></a><span id="l15.218">    */</span>
<a href="#l15.219"></a><span id="l15.219">   openTextLink(evt) {</span>
<a href="#l15.220"></a><span id="l15.220" class="difflineat">@@ -746,8 +784,11 @@ var gAdvancedPane = {</span>
<a href="#l15.221"></a><span id="l15.221"> </span>
<a href="#l15.222"></a><span id="l15.222">   handleEvent(aEvent) {</span>
<a href="#l15.223"></a><span id="l15.223">     if (aEvent.type == &quot;unload&quot;) {</span>
<a href="#l15.224"></a><span id="l15.224">       this.destroy();</span>
<a href="#l15.225"></a><span id="l15.225">     }</span>
<a href="#l15.226"></a><span id="l15.226">   },</span>
<a href="#l15.227"></a><span id="l15.227"> </span>
<a href="#l15.228"></a><span id="l15.228"> };</span>
<a href="#l15.229"></a><span id="l15.229" class="difflineplus">+</span>
<a href="#l15.230"></a><span id="l15.230" class="difflineplus">+Preferences.get(&quot;layers.acceleration.disabled&quot;).on(&quot;change&quot;, gAdvancedPane.updateHardwareAcceleration);</span>
<a href="#l15.231"></a><span id="l15.231" class="difflineplus">+Preferences.get(&quot;mail.prompt_purge_threshhold&quot;).on(&quot;change&quot;, gAdvancedPane.updateCompactOptions);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/components/preferences/applications.inc.xul</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/components/preferences/applications.inc.xul</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -7,50 +7,16 @@</span>
<a href="#l16.4"></a><span id="l16.4">     &lt;![CDATA[</span>
<a href="#l16.5"></a><span id="l16.5"> #ifdef MOZ_WIDGET_GTK</span>
<a href="#l16.6"></a><span id="l16.6">       var ICON_URL_APP      = &quot;moz-icon://dummy.exe?size=16&quot;;</span>
<a href="#l16.7"></a><span id="l16.7"> #else</span>
<a href="#l16.8"></a><span id="l16.8">       var ICON_URL_APP      = &quot;chrome://messenger/skin/preferences/application.png&quot;;</span>
<a href="#l16.9"></a><span id="l16.9"> #endif</span>
<a href="#l16.10"></a><span id="l16.10">     ]]&gt;</span>
<a href="#l16.11"></a><span id="l16.11">     &lt;/script&gt;</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-    &lt;preferences id=&quot;applicationsPreferences&quot;&gt;</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineminus">-      &lt;preference id=&quot;mail.preferences.applications.selectedTabIndex&quot;</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineminus">-                  name=&quot;mail.preferences.applications.selectedTabIndex&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineminus">-</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineminus">-    &lt;preferences id=&quot;downloadDirPreferences&quot;&gt;</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-      &lt;preference id=&quot;browser.download.useDownloadDir&quot;</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineminus">-                  name=&quot;browser.download.useDownloadDir&quot;</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineminus">-      &lt;preference id=&quot;browser.download.folderList&quot;</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineminus">-                  name=&quot;browser.download.folderList&quot;</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineminus">-      &lt;preference id=&quot;browser.download.downloadDir&quot;</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineminus">-                  name=&quot;browser.download.downloadDir&quot;</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineminus">-                  type=&quot;file&quot;/&gt;</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineminus">-      &lt;preference id=&quot;browser.download.dir&quot;</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineminus">-                  name=&quot;browser.download.dir&quot;</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-                  type=&quot;file&quot;</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-                  onchange=&quot;gDownloadDirSection.readDownloadDirPref();&quot;/&gt;</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineminus">-      &lt;preference id=&quot;pref.downloads.disable_button.edit_actions&quot;</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-                  name=&quot;pref.downloads.disable_button.edit_actions&quot;</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l16.36"></a><span id="l16.36" class="difflineminus">-</span>
<a href="#l16.37"></a><span id="l16.37" class="difflineminus">-    &lt;preferences id=&quot;cloudFilePreferences&quot;&gt;</span>
<a href="#l16.38"></a><span id="l16.38" class="difflineminus">-      &lt;preference id=&quot;mail.compose.big_attachments.notify&quot;</span>
<a href="#l16.39"></a><span id="l16.39" class="difflineminus">-                  name=&quot;mail.compose.big_attachments.notify&quot;</span>
<a href="#l16.40"></a><span id="l16.40" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineminus">-      &lt;preference id=&quot;mail.compose.big_attachments.threshold_kb&quot;</span>
<a href="#l16.42"></a><span id="l16.42" class="difflineminus">-                  name=&quot;mail.compose.big_attachments.threshold_kb&quot;</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l16.44"></a><span id="l16.44" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l16.45"></a><span id="l16.45" class="difflineminus">-</span>
<a href="#l16.46"></a><span id="l16.46">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l16.47"></a><span id="l16.47">             src=&quot;chrome://messenger/content/preferences/applications.js&quot;/&gt;</span>
<a href="#l16.48"></a><span id="l16.48"> </span>
<a href="#l16.49"></a><span id="l16.49">     &lt;commandset id=&quot;appPaneCommandSet&quot;&gt;</span>
<a href="#l16.50"></a><span id="l16.50">       &lt;command id=&quot;cmd_delete&quot;</span>
<a href="#l16.51"></a><span id="l16.51">                oncommand=&quot;gApplicationsPane.onDelete();&quot;/&gt;</span>
<a href="#l16.52"></a><span id="l16.52">     &lt;/commandset&gt;</span>
<a href="#l16.53"></a><span id="l16.53"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/components/preferences/applications.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/components/preferences/applications.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -26,16 +26,22 @@ var {Services} = ChromeUtils.import(&quot;res</span>
<a href="#l17.4"></a><span id="l17.4"> var {XPCOMUtils} = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l17.5"></a><span id="l17.5"> var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7"> XPCOMUtils.defineLazyServiceGetters(this, {</span>
<a href="#l17.8"></a><span id="l17.8">   gHandlerService: [&quot;@mozilla.org/uriloader/handler-service;1&quot;, &quot;nsIHandlerService&quot;],</span>
<a href="#l17.9"></a><span id="l17.9">   gMIMEService: [&quot;@mozilla.org/mime;1&quot;, &quot;nsIMIMEService&quot;],</span>
<a href="#l17.10"></a><span id="l17.10"> });</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  { id: &quot;mail.preferences.applications.selectedTabIndex&quot;, type: &quot;int&quot; },</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+  { id: &quot;mail.compose.big_attachments.notify&quot;, type: &quot;bool&quot; },</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+  { id: &quot;mail.compose.big_attachments.threshold_kb&quot;, type: &quot;int&quot; },</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+]);</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+</span>
<a href="#l17.18"></a><span id="l17.18"> document.getElementById(&quot;paneApplications&quot;)</span>
<a href="#l17.19"></a><span id="l17.19">         .addEventListener(&quot;paneload&quot;, function() { gApplicationsTabController.init(); });</span>
<a href="#l17.20"></a><span id="l17.20"> </span>
<a href="#l17.21"></a><span id="l17.21"> // ---------</span>
<a href="#l17.22"></a><span id="l17.22"> // Utilities</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24"> function getDisplayNameForFile(aFile) {</span>
<a href="#l17.25"></a><span id="l17.25">   if (AppConstants.platform == &quot;win&quot;) {</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineat">@@ -474,31 +480,31 @@ var gApplicationsTabController = {</span>
<a href="#l17.27"></a><span id="l17.27">     }</span>
<a href="#l17.28"></a><span id="l17.28"> </span>
<a href="#l17.29"></a><span id="l17.29">     gCloudFileTab.init();</span>
<a href="#l17.30"></a><span id="l17.30">     this.paneSelectionChanged = this.paneSelectionChanged.bind(this);</span>
<a href="#l17.31"></a><span id="l17.31">     window.addEventListener(&quot;paneSelected&quot;, this.paneSelectionChanged);</span>
<a href="#l17.32"></a><span id="l17.32"> </span>
<a href="#l17.33"></a><span id="l17.33">     if (!((&quot;arguments&quot; in window) &amp;&amp; window.arguments[1])) {</span>
<a href="#l17.34"></a><span id="l17.34">       // If no tab was specified, select the last used tab.</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineminus">-      let preference = document.getElementById(&quot;mail.preferences.applications.selectedTabIndex&quot;);</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineplus">+      let preference = Preferences.get(&quot;mail.preferences.applications.selectedTabIndex&quot;);</span>
<a href="#l17.37"></a><span id="l17.37">       this.mTabBox.selectedIndex = preference.value != null ? preference.value : this.mDefaultIndex;</span>
<a href="#l17.38"></a><span id="l17.38">     }</span>
<a href="#l17.39"></a><span id="l17.39"> </span>
<a href="#l17.40"></a><span id="l17.40">     this.mInitialized = true;</span>
<a href="#l17.41"></a><span id="l17.41">   },</span>
<a href="#l17.42"></a><span id="l17.42"> </span>
<a href="#l17.43"></a><span id="l17.43">   paneSelectionChanged() {</span>
<a href="#l17.44"></a><span id="l17.44">     gCloudFileTab.init();</span>
<a href="#l17.45"></a><span id="l17.45">   },</span>
<a href="#l17.46"></a><span id="l17.46"> </span>
<a href="#l17.47"></a><span id="l17.47">   tabSelectionChanged() {</span>
<a href="#l17.48"></a><span id="l17.48">     if (this.mInitialized) {</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineminus">-      document.getElementById(&quot;mail.preferences.applications.selectedTabIndex&quot;)</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineminus">-              .valueFromPreferences = this.mTabBox.selectedIndex;</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineplus">+      Preferences.get(&quot;mail.preferences.applications.selectedTabIndex&quot;)</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineplus">+                 .valueFromPreferences = this.mTabBox.selectedIndex;</span>
<a href="#l17.53"></a><span id="l17.53">     }</span>
<a href="#l17.54"></a><span id="l17.54"> </span>
<a href="#l17.55"></a><span id="l17.55">     gCloudFileTab.init();</span>
<a href="#l17.56"></a><span id="l17.56">   },</span>
<a href="#l17.57"></a><span id="l17.57"> };</span>
<a href="#l17.58"></a><span id="l17.58"> </span>
<a href="#l17.59"></a><span id="l17.59"> var gCloudFileTab = {</span>
<a href="#l17.60"></a><span id="l17.60">   _initialized: false,</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineat">@@ -821,17 +827,17 @@ var gCloudFileTab = {</span>
<a href="#l17.62"></a><span id="l17.62"> </span>
<a href="#l17.63"></a><span id="l17.63">           aEvent.preventDefault();</span>
<a href="#l17.64"></a><span id="l17.64">         }</span>
<a href="#l17.65"></a><span id="l17.65">       }</span>
<a href="#l17.66"></a><span id="l17.66">     }</span>
<a href="#l17.67"></a><span id="l17.67">   },</span>
<a href="#l17.68"></a><span id="l17.68"> </span>
<a href="#l17.69"></a><span id="l17.69">   readThreshold() {</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineminus">-    let pref = document.getElementById(&quot;mail.compose.big_attachments.threshold_kb&quot;);</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineplus">+    let pref = Preferences.get(&quot;mail.compose.big_attachments.threshold_kb&quot;);</span>
<a href="#l17.72"></a><span id="l17.72">     return pref.value / 1024;</span>
<a href="#l17.73"></a><span id="l17.73">   },</span>
<a href="#l17.74"></a><span id="l17.74"> </span>
<a href="#l17.75"></a><span id="l17.75">   writeThreshold() {</span>
<a href="#l17.76"></a><span id="l17.76">     let threshold = document.getElementById(&quot;cloudFileThreshold&quot;);</span>
<a href="#l17.77"></a><span id="l17.77">     let intValue = parseInt(threshold.value, 10);</span>
<a href="#l17.78"></a><span id="l17.78">     return isNaN(intValue) ? 0 : intValue * 1024;</span>
<a href="#l17.79"></a><span id="l17.79">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mail/components/preferences/attachmentReminder.xul</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mail/components/preferences/attachmentReminder.xul</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,30 +1,30 @@</span>
<a href="#l18.4"></a><span id="l18.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l18.5"></a><span id="l18.5"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l18.6"></a><span id="l18.6">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.7"></a><span id="l18.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.8"></a><span id="l18.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l18.9"></a><span id="l18.9"> </span>
<a href="#l18.10"></a><span id="l18.10"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l18.11"></a><span id="l18.11"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l18.14"></a><span id="l18.14"> &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span>
<a href="#l18.15"></a><span id="l18.15"> %brandDTD;</span>
<a href="#l18.16"></a><span id="l18.16"> &lt;!ENTITY % sendOptionsDTD SYSTEM &quot;chrome://messenger/locale/preferences/attachmentReminder.dtd&quot;&gt;</span>
<a href="#l18.17"></a><span id="l18.17"> %sendOptionsDTD;</span>
<a href="#l18.18"></a><span id="l18.18"> ]&gt;</span>
<a href="#l18.19"></a><span id="l18.19"> </span>
<a href="#l18.20"></a><span id="l18.20" class="difflineminus">-&lt;prefwindow id=&quot;attachmentReminderOptionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineminus">-            dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineminus">-            title=&quot;&amp;attachmentReminderDialog.title;&quot;</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineminus">-            onload=&quot;gAttachmentReminderOptionsDialog.init();&quot;</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">-            ondialogaccept=&quot;gAttachmentReminderOptionsDialog.saveKeywords();&quot;</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">-            style=&quot;width:38em;&quot;&gt;</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+&lt;dialog id=&quot;attachmentReminderOptionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+        dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+        title=&quot;&amp;attachmentReminderDialog.title;&quot;</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+        onload=&quot;gAttachmentReminderOptionsDialog.init();&quot;</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+        ondialogaccept=&quot;gAttachmentReminderOptionsDialog.saveKeywords();&quot;</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+        style=&quot;width:38em;&quot;&gt;</span>
<a href="#l18.34"></a><span id="l18.34"> </span>
<a href="#l18.35"></a><span id="l18.35">   &lt;prefpane id=&quot;attachmentReminderOptionsDialogPane&quot;&gt;</span>
<a href="#l18.36"></a><span id="l18.36">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/attachmentReminder.js&quot;/&gt;</span>
<a href="#l18.37"></a><span id="l18.37">     &lt;stringbundle id=&quot;bundlePreferences&quot; src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l18.38"></a><span id="l18.38"> </span>
<a href="#l18.39"></a><span id="l18.39">     &lt;groupbox&gt;</span>
<a href="#l18.40"></a><span id="l18.40">       &lt;label control=&quot;keywordList&quot;&gt;&amp;attachKeywordText.label;&lt;/label&gt;</span>
<a href="#l18.41"></a><span id="l18.41">       &lt;hbox&gt;</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineat">@@ -36,9 +36,9 @@</span>
<a href="#l18.43"></a><span id="l18.43">           &lt;button label=&quot;&amp;editKeywordButton1.label;&quot; accesskey=&quot;&amp;editKeywordButton1.accesskey;&quot;</span>
<a href="#l18.44"></a><span id="l18.44">                   oncommand=&quot;gAttachmentReminderOptionsDialog.editKeyword();&quot;/&gt;</span>
<a href="#l18.45"></a><span id="l18.45">           &lt;button label=&quot;&amp;removeKeywordButton.label;&quot; accesskey=&quot;&amp;removeKeywordButton.accesskey;&quot;</span>
<a href="#l18.46"></a><span id="l18.46">                   oncommand=&quot;gAttachmentReminderOptionsDialog.removeKeyword();&quot;/&gt;</span>
<a href="#l18.47"></a><span id="l18.47">         &lt;/vbox&gt;</span>
<a href="#l18.48"></a><span id="l18.48">       &lt;/hbox&gt;</span>
<a href="#l18.49"></a><span id="l18.49">     &lt;/groupbox&gt;</span>
<a href="#l18.50"></a><span id="l18.50">   &lt;/prefpane&gt;</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/components/preferences/chat.inc.xul</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/components/preferences/chat.inc.xul</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1,41 +1,15 @@</span>
<a href="#l19.4"></a><span id="l19.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.5"></a><span id="l19.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.6"></a><span id="l19.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l19.7"></a><span id="l19.7">   &lt;prefpane id=&quot;paneChat&quot; label=&quot;&amp;paneChat.title;&quot;&gt;</span>
<a href="#l19.8"></a><span id="l19.8">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/chat.js&quot;/&gt;</span>
<a href="#l19.9"></a><span id="l19.9">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/messagestyle.js&quot;/&gt;</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11" class="difflineminus">-    &lt;preferences id=&quot;chatPreferences&quot;&gt;</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-      &lt;preference id=&quot;mail.preferences.chat.selectedTabIndex&quot;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-                  name=&quot;mail.preferences.chat.selectedTabIndex&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-      &lt;preference id=&quot;messenger.startup.action&quot;            name=&quot;messenger.startup.action&quot;     type=&quot;int&quot;/&gt;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-      &lt;preference id=&quot;purple.conversations.im.send_typing&quot; name=&quot;purple.conversations.im.send_typing&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-      &lt;preference id=&quot;messenger.status.reportIdle&quot;         name=&quot;messenger.status.reportIdle&quot;         type=&quot;bool&quot;</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineminus">-                  onchange=&quot;gChatPane.updateDisabledState();&quot;/&gt;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineminus">-      &lt;preference id=&quot;messenger.status.timeBeforeIdle&quot;     name=&quot;messenger.status.timeBeforeIdle&quot;     type=&quot;int&quot;/&gt;</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineminus">-      &lt;preference id=&quot;messenger.status.awayWhenIdle&quot;       name=&quot;messenger.status.awayWhenIdle&quot;       type=&quot;bool&quot;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineminus">-                  onchange=&quot;gChatPane.updateMessageDisabledState();&quot;/&gt;</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineminus">-      &lt;preference id=&quot;messenger.status.defaultIdleAwayMessage&quot; name=&quot;messenger.status.defaultIdleAwayMessage&quot; type=&quot;wstring&quot;/&gt;</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-      &lt;preference id=&quot;purple.logging.log_chats&quot;            name=&quot;purple.logging.log_chats&quot;            type=&quot;bool&quot;/&gt;</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-      &lt;preference id=&quot;purple.logging.log_ims&quot;              name=&quot;purple.logging.log_ims&quot;              type=&quot;bool&quot;/&gt;</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-      &lt;preference id=&quot;purple.logging.log_system&quot;           name=&quot;purple.logging.log_system&quot;           type=&quot;bool&quot;/&gt;</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineminus">-      &lt;preference id=&quot;pref.privacy.disable_button.view_passwords&quot; name=&quot;pref.privacy.disable_button.view_passwords&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineminus">-      &lt;preference id=&quot;mail.chat.show_desktop_notifications&quot; name=&quot;mail.chat.show_desktop_notifications&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineminus">-      &lt;preference id=&quot;mail.chat.notification_info&quot; name=&quot;mail.chat.notification_info&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineminus">-      &lt;preference id=&quot;mail.chat.play_sound&quot; name=&quot;mail.chat.play_sound&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineminus">-      &lt;preference id=&quot;mail.chat.play_sound.type&quot; name=&quot;mail.chat.play_sound.type&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-      &lt;preference id=&quot;mail.chat.play_sound.url&quot; name=&quot;mail.chat.play_sound.url&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-      &lt;preference id=&quot;messenger.options.getAttentionOnNewMessages&quot; name=&quot;messenger.options.getAttentionOnNewMessages&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-      &lt;preference id=&quot;messenger.options.messagesStyle.theme&quot;      name=&quot;messenger.options.messagesStyle.theme&quot;      type=&quot;string&quot;/&gt;</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineminus">-      &lt;preference id=&quot;messenger.options.messagesStyle.variant&quot;    name=&quot;messenger.options.messagesStyle.variant&quot;    type=&quot;string&quot;/&gt;</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-      &lt;preference id=&quot;messenger.options.messagesStyle.showHeader&quot; name=&quot;messenger.options.messagesStyle.showHeader&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineminus">-</span>
<a href="#l19.37"></a><span id="l19.37">     &lt;stringbundle id=&quot;themesBundle&quot;</span>
<a href="#l19.38"></a><span id="l19.38">                   src=&quot;chrome://messenger/locale/preferences/messagestyle.properties&quot;/&gt;</span>
<a href="#l19.39"></a><span id="l19.39"> </span>
<a href="#l19.40"></a><span id="l19.40">     &lt;tabbox id=&quot;chatPrefs&quot; flex=&quot;1&quot; onselect=&quot;gChatPane.tabSelectionChanged();&quot;&gt;</span>
<a href="#l19.41"></a><span id="l19.41">       &lt;tabs id=&quot;chatPrefsTabs&quot;&gt;</span>
<a href="#l19.42"></a><span id="l19.42">         &lt;tab id=&quot;chatGeneralTab&quot;       label=&quot;&amp;generalTab.label;&quot;/&gt;</span>
<a href="#l19.43"></a><span id="l19.43">         &lt;tab id=&quot;chatMessageStylesTab&quot; label=&quot;&amp;messageStyleTab.title;&quot;/&gt;</span>
<a href="#l19.44"></a><span id="l19.44">       &lt;/tabs&gt;</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineat">@@ -60,17 +34,17 @@</span>
<a href="#l19.46"></a><span id="l19.46">           &lt;!-- Status --&gt;</span>
<a href="#l19.47"></a><span id="l19.47">           &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l19.48"></a><span id="l19.48">             &lt;checkbox id=&quot;reportIdle&quot; label=&quot;&amp;reportIdleAfter.label;&quot;</span>
<a href="#l19.49"></a><span id="l19.49">                       accesskey=&quot;&amp;reportIdleAfter.accesskey;&quot;</span>
<a href="#l19.50"></a><span id="l19.50">                       preference=&quot;messenger.status.reportIdle&quot;/&gt;</span>
<a href="#l19.51"></a><span id="l19.51">             &lt;textbox id=&quot;timeBeforeAway&quot; type=&quot;number&quot; min=&quot;1&quot; max=&quot;720&quot;</span>
<a href="#l19.52"></a><span id="l19.52">                      class=&quot;idle-reporting-enabled&quot;</span>
<a href="#l19.53"></a><span id="l19.53">                      preference=&quot;messenger.status.timeBeforeIdle&quot;</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineminus">-                     onsyncfrompreference=&quot;var elt = document.getElementById(this.getAttribute('preference'));</span>
<a href="#l19.55"></a><span id="l19.55" class="difflineplus">+                     onsyncfrompreference=&quot;var elt = Preferences.get(this.getAttribute('preference'));</span>
<a href="#l19.56"></a><span id="l19.56">                                            return (elt.instantApply ? elt.valueFromPreferences : elt.value) / 60;&quot;</span>
<a href="#l19.57"></a><span id="l19.57">                      onsynctopreference=&quot;return this.value * 60;&quot;/&gt;</span>
<a href="#l19.58"></a><span id="l19.58">             &lt;label value=&quot;&amp;idleTime;&quot; control=&quot;timeBeforeAway&quot;/&gt;</span>
<a href="#l19.59"></a><span id="l19.59">           &lt;/hbox&gt;</span>
<a href="#l19.60"></a><span id="l19.60">           &lt;vbox class=&quot;indent&quot;&gt;</span>
<a href="#l19.61"></a><span id="l19.61">             &lt;hbox&gt;</span>
<a href="#l19.62"></a><span id="l19.62">               &lt;checkbox id=&quot;autoAway&quot;</span>
<a href="#l19.63"></a><span id="l19.63">                         label=&quot;&amp;andSetStatusToAway.label;&quot;</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineat">@@ -117,27 +91,25 @@</span>
<a href="#l19.65"></a><span id="l19.65">                       label=&quot;&amp;getAttentionMac.label;&quot;</span>
<a href="#l19.66"></a><span id="l19.66">                       accesskey=&quot;&amp;getAttentionMac.accesskey;&quot;</span>
<a href="#l19.67"></a><span id="l19.67"> #endif</span>
<a href="#l19.68"></a><span id="l19.68">                       preference=&quot;messenger.options.getAttentionOnNewMessages&quot;/&gt;</span>
<a href="#l19.69"></a><span id="l19.69">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l19.70"></a><span id="l19.70">               &lt;checkbox id=&quot;chatNotification&quot;</span>
<a href="#l19.71"></a><span id="l19.71">                         label=&quot;&amp;chatSound.label;&quot;</span>
<a href="#l19.72"></a><span id="l19.72">                         accesskey=&quot;&amp;chatSound.accesskey;&quot;</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineminus">-                        preference=&quot;mail.chat.play_sound&quot;</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineminus">-                        oncommand=&quot;gChatPane.updatePlaySound();&quot;/&gt;</span>
<a href="#l19.75"></a><span id="l19.75" class="difflineplus">+                        preference=&quot;mail.chat.play_sound&quot;/&gt;</span>
<a href="#l19.76"></a><span id="l19.76">               &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l19.77"></a><span id="l19.77">               &lt;button id=&quot;playChatSound&quot; label=&quot;&amp;play.label;&quot; accesskey=&quot;&amp;play.accesskey;&quot;</span>
<a href="#l19.78"></a><span id="l19.78">                       oncommand=&quot;gChatPane.previewSound();&quot;/&gt;</span>
<a href="#l19.79"></a><span id="l19.79">             &lt;/hbox&gt;</span>
<a href="#l19.80"></a><span id="l19.80">             &lt;radiogroup id=&quot;chatSoundType&quot;</span>
<a href="#l19.81"></a><span id="l19.81">                         class=&quot;indent&quot;</span>
<a href="#l19.82"></a><span id="l19.82">                         orient=&quot;vertical&quot;</span>
<a href="#l19.83"></a><span id="l19.83">                         preference=&quot;mail.chat.play_sound.type&quot;</span>
<a href="#l19.84"></a><span id="l19.84" class="difflineminus">-                        oncommand=&quot;gChatPane.updatePlaySound();&quot;</span>
<a href="#l19.85"></a><span id="l19.85">                         aria-labelledby=&quot;chatNotification&quot;&gt;</span>
<a href="#l19.86"></a><span id="l19.86">               &lt;hbox&gt;</span>
<a href="#l19.87"></a><span id="l19.87">                 &lt;radio id=&quot;chatSoundSystemSound&quot;</span>
<a href="#l19.88"></a><span id="l19.88">                        label=&quot;&amp;systemSound.label;&quot;</span>
<a href="#l19.89"></a><span id="l19.89">                        value=&quot;0&quot;</span>
<a href="#l19.90"></a><span id="l19.90">                        accesskey=&quot;&amp;systemSound.accesskey;&quot;/&gt;</span>
<a href="#l19.91"></a><span id="l19.91">                 &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l19.92"></a><span id="l19.92">               &lt;/hbox&gt;</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineat">@@ -219,10 +191,9 @@</span>
<a href="#l19.94"></a><span id="l19.94">           &lt;/hbox&gt;</span>
<a href="#l19.95"></a><span id="l19.95">           &lt;checkbox id=&quot;showHeaderCheckbox&quot; label=&quot;&amp;messageStyleShowHeader.label;&quot;</span>
<a href="#l19.96"></a><span id="l19.96">                     accesskey=&quot;&amp;messageStyleShowHeader.accesskey;&quot;</span>
<a href="#l19.97"></a><span id="l19.97">                     preference=&quot;messenger.options.messagesStyle.showHeader&quot;/&gt;</span>
<a href="#l19.98"></a><span id="l19.98"> </span>
<a href="#l19.99"></a><span id="l19.99">         &lt;/tabpanel&gt;</span>
<a href="#l19.100"></a><span id="l19.100">       &lt;/tabpanels&gt;</span>
<a href="#l19.101"></a><span id="l19.101">     &lt;/tabbox&gt;</span>
<a href="#l19.102"></a><span id="l19.102" class="difflineminus">-</span>
<a href="#l19.103"></a><span id="l19.103">   &lt;/prefpane&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/components/preferences/chat.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/components/preferences/chat.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -3,43 +3,66 @@</span>
<a href="#l20.4"></a><span id="l20.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.5"></a><span id="l20.5"> </span>
<a href="#l20.6"></a><span id="l20.6"> &quot;use strict&quot;;</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8"> /* import-globals-from preferences.js */</span>
<a href="#l20.9"></a><span id="l20.9"> // messagestyle.js</span>
<a href="#l20.10"></a><span id="l20.10"> /* globals previewObserver */</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+  { id: &quot;mail.preferences.chat.selectedTabIndex&quot;, type: &quot;int&quot; },</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+  { id: &quot;messenger.startup.action&quot;, type: &quot;int&quot; },</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+  { id: &quot;purple.conversations.im.send_typing&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+  { id: &quot;messenger.status.reportIdle&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+  { id: &quot;messenger.status.timeBeforeIdle&quot;, type: &quot;int&quot; },</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+  { id: &quot;messenger.status.awayWhenIdle&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineplus">+  { id: &quot;messenger.status.defaultIdleAwayMessage&quot;, type: &quot;wstring&quot; },</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+  { id: &quot;purple.logging.log_chats&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+  { id: &quot;purple.logging.log_ims&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+  { id: &quot;purple.logging.log_system&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+  { id: &quot;mail.chat.show_desktop_notifications&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+  { id: &quot;mail.chat.notification_info&quot;, type: &quot;int&quot; },</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineplus">+  { id: &quot;mail.chat.play_sound&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+  { id: &quot;mail.chat.play_sound.type&quot;, type: &quot;int&quot; },</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineplus">+  { id: &quot;mail.chat.play_sound.url&quot;, type: &quot;string&quot; },</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineplus">+  { id: &quot;messenger.options.getAttentionOnNewMessages&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineplus">+  { id: &quot;messenger.options.messagesStyle.theme&quot;, type: &quot;string&quot; },</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineplus">+  { id: &quot;messenger.options.messagesStyle.variant&quot;, type: &quot;string&quot; },</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+  { id: &quot;messenger.options.messagesStyle.showHeader&quot;, type: &quot;bool&quot; },</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+]);</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+</span>
<a href="#l20.34"></a><span id="l20.34"> document.getElementById(&quot;paneChat&quot;)</span>
<a href="#l20.35"></a><span id="l20.35">         .addEventListener(&quot;paneload&quot;, function() { gChatPane.init(); });</span>
<a href="#l20.36"></a><span id="l20.36"> </span>
<a href="#l20.37"></a><span id="l20.37"> var gChatPane = {</span>
<a href="#l20.38"></a><span id="l20.38">   mInitialized: false,</span>
<a href="#l20.39"></a><span id="l20.39"> </span>
<a href="#l20.40"></a><span id="l20.40">   init() {</span>
<a href="#l20.41"></a><span id="l20.41">     this.updateDisabledState();</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineplus">+    this.updateMessageDisabledState();</span>
<a href="#l20.43"></a><span id="l20.43">     this.updatePlaySound();</span>
<a href="#l20.44"></a><span id="l20.44"> </span>
<a href="#l20.45"></a><span id="l20.45" class="difflineminus">-    let preference = document.getElementById(&quot;mail.preferences.chat.selectedTabIndex&quot;);</span>
<a href="#l20.46"></a><span id="l20.46" class="difflineplus">+    let preference = Preferences.get(&quot;mail.preferences.chat.selectedTabIndex&quot;);</span>
<a href="#l20.47"></a><span id="l20.47">     this.mTabBox = document.getElementById(&quot;chatPrefs&quot;);</span>
<a href="#l20.48"></a><span id="l20.48">     this.mTabBox.selectedIndex = preference.value != null ? preference.value : 0;</span>
<a href="#l20.49"></a><span id="l20.49"> </span>
<a href="#l20.50"></a><span id="l20.50">     window.addEventListener(&quot;paneSelected&quot;, this.paneSelectionChanged);</span>
<a href="#l20.51"></a><span id="l20.51"> </span>
<a href="#l20.52"></a><span id="l20.52">     this.mInitialized = true;</span>
<a href="#l20.53"></a><span id="l20.53">   },</span>
<a href="#l20.54"></a><span id="l20.54"> </span>
<a href="#l20.55"></a><span id="l20.55">   paneSelectionChanged() {</span>
<a href="#l20.56"></a><span id="l20.56">     gChatPane.initPreview(); // Can't use &quot;this&quot;, as it's probably not gChatPane.</span>
<a href="#l20.57"></a><span id="l20.57">   },</span>
<a href="#l20.58"></a><span id="l20.58"> </span>
<a href="#l20.59"></a><span id="l20.59">   tabSelectionChanged() {</span>
<a href="#l20.60"></a><span id="l20.60">     if (this.mInitialized) {</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineminus">-      document.getElementById(&quot;mail.preferences.chat.selectedTabIndex&quot;)</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineminus">-              .valueFromPreferences = this.mTabBox.selectedIndex;</span>
<a href="#l20.63"></a><span id="l20.63" class="difflineplus">+      Preferences.get(&quot;mail.preferences.chat.selectedTabIndex&quot;)</span>
<a href="#l20.64"></a><span id="l20.64" class="difflineplus">+                 .valueFromPreferences = this.mTabBox.selectedIndex;</span>
<a href="#l20.65"></a><span id="l20.65">     }</span>
<a href="#l20.66"></a><span id="l20.66"> </span>
<a href="#l20.67"></a><span id="l20.67">     this.initPreview();</span>
<a href="#l20.68"></a><span id="l20.68">   },</span>
<a href="#l20.69"></a><span id="l20.69"> </span>
<a href="#l20.70"></a><span id="l20.70">   initPreview() {</span>
<a href="#l20.71"></a><span id="l20.71">     // We add this browser only when really necessary.</span>
<a href="#l20.72"></a><span id="l20.72">     let previewDeck = document.getElementById(&quot;previewDeck&quot;);</span>
<a href="#l20.73"></a><span id="l20.73" class="difflineat">@@ -60,25 +83,25 @@ var gChatPane = {</span>
<a href="#l20.74"></a><span id="l20.74">     browser.setAttribute(&quot;type&quot;, &quot;content&quot;);</span>
<a href="#l20.75"></a><span id="l20.75">     browser.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l20.76"></a><span id="l20.76">     browser.setAttribute(&quot;tooltip&quot;, &quot;aHTMLTooltip&quot;);</span>
<a href="#l20.77"></a><span id="l20.77">     previewDeck.appendChild(browser);</span>
<a href="#l20.78"></a><span id="l20.78">     previewObserver.load();</span>
<a href="#l20.79"></a><span id="l20.79">   },</span>
<a href="#l20.80"></a><span id="l20.80"> </span>
<a href="#l20.81"></a><span id="l20.81">   updateDisabledState() {</span>
<a href="#l20.82"></a><span id="l20.82" class="difflineminus">-    let checked = document.getElementById(&quot;messenger.status.reportIdle&quot;).value;</span>
<a href="#l20.83"></a><span id="l20.83" class="difflineplus">+    let checked = Preferences.get(&quot;messenger.status.reportIdle&quot;).value;</span>
<a href="#l20.84"></a><span id="l20.84">     document.querySelectorAll(&quot;.idle-reporting-enabled&quot;).forEach(e =&gt; {</span>
<a href="#l20.85"></a><span id="l20.85">       e.disabled = !checked;</span>
<a href="#l20.86"></a><span id="l20.86">     });</span>
<a href="#l20.87"></a><span id="l20.87">   },</span>
<a href="#l20.88"></a><span id="l20.88"> </span>
<a href="#l20.89"></a><span id="l20.89">   updateMessageDisabledState() {</span>
<a href="#l20.90"></a><span id="l20.90">     let textbox = document.getElementById(&quot;defaultIdleAwayMessage&quot;);</span>
<a href="#l20.91"></a><span id="l20.91" class="difflineminus">-    if (document.getElementById(&quot;messenger.status.awayWhenIdle&quot;).value)</span>
<a href="#l20.92"></a><span id="l20.92" class="difflineplus">+    if (Preferences.get(&quot;messenger.status.awayWhenIdle&quot;).value)</span>
<a href="#l20.93"></a><span id="l20.93">       textbox.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l20.94"></a><span id="l20.94">     else</span>
<a href="#l20.95"></a><span id="l20.95">       textbox.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l20.96"></a><span id="l20.96">   },</span>
<a href="#l20.97"></a><span id="l20.97"> </span>
<a href="#l20.98"></a><span id="l20.98">   convertURLToLocalFile(aFileURL) {</span>
<a href="#l20.99"></a><span id="l20.99">     // convert the file url into a nsIFile</span>
<a href="#l20.100"></a><span id="l20.100">     if (aFileURL) {</span>
<a href="#l20.101"></a><span id="l20.101" class="difflineat">@@ -86,17 +109,17 @@ var gChatPane = {</span>
<a href="#l20.102"></a><span id="l20.102">                         .QueryInterface(Ci.nsIFileProtocolHandler)</span>
<a href="#l20.103"></a><span id="l20.103">                         .getFileFromURLSpec(aFileURL);</span>
<a href="#l20.104"></a><span id="l20.104">     }</span>
<a href="#l20.105"></a><span id="l20.105">     return null;</span>
<a href="#l20.106"></a><span id="l20.106">   },</span>
<a href="#l20.107"></a><span id="l20.107"> </span>
<a href="#l20.108"></a><span id="l20.108">   readSoundLocation() {</span>
<a href="#l20.109"></a><span id="l20.109">     let chatSoundUrlLocation = document.getElementById(&quot;chatSoundUrlLocation&quot;);</span>
<a href="#l20.110"></a><span id="l20.110" class="difflineminus">-    chatSoundUrlLocation.value = document.getElementById(&quot;mail.chat.play_sound.url&quot;).value;</span>
<a href="#l20.111"></a><span id="l20.111" class="difflineplus">+    chatSoundUrlLocation.value = Preferences.get(&quot;mail.chat.play_sound.url&quot;).value;</span>
<a href="#l20.112"></a><span id="l20.112">     if (chatSoundUrlLocation.value) {</span>
<a href="#l20.113"></a><span id="l20.113">       chatSoundUrlLocation.label = this.convertURLToLocalFile(chatSoundUrlLocation.value).leafName;</span>
<a href="#l20.114"></a><span id="l20.114">       chatSoundUrlLocation.style.backgroundImage = &quot;url(moz-icon://&quot; + chatSoundUrlLocation.label + &quot;?size=16)&quot;;</span>
<a href="#l20.115"></a><span id="l20.115">     }</span>
<a href="#l20.116"></a><span id="l20.116">   },</span>
<a href="#l20.117"></a><span id="l20.117"> </span>
<a href="#l20.118"></a><span id="l20.118">   previewSound() {</span>
<a href="#l20.119"></a><span id="l20.119">     let sound = Cc[&quot;@mozilla.org/sound;1&quot;].createInstance(Ci.nsISound);</span>
<a href="#l20.120"></a><span id="l20.120" class="difflineat">@@ -142,26 +165,31 @@ var gChatPane = {</span>
<a href="#l20.121"></a><span id="l20.121">       fp.appendFilter(soundFilesText, &quot;*.wav&quot;);</span>
<a href="#l20.122"></a><span id="l20.122"> </span>
<a href="#l20.123"></a><span id="l20.123">     fp.open(rv =&gt; {</span>
<a href="#l20.124"></a><span id="l20.124">       if (rv != nsIFilePicker.returnOK) {</span>
<a href="#l20.125"></a><span id="l20.125">         return;</span>
<a href="#l20.126"></a><span id="l20.126">       }</span>
<a href="#l20.127"></a><span id="l20.127"> </span>
<a href="#l20.128"></a><span id="l20.128">       // convert the nsIFile into a nsIFile url</span>
<a href="#l20.129"></a><span id="l20.129" class="difflineminus">-      document.getElementById(&quot;mail.chat.play_sound.url&quot;).value = fp.fileURL.spec;</span>
<a href="#l20.130"></a><span id="l20.130" class="difflineplus">+      Preferences.get(&quot;mail.chat.play_sound.url&quot;).value = fp.fileURL.spec;</span>
<a href="#l20.131"></a><span id="l20.131">       this.readSoundLocation(); // XXX We shouldn't have to be doing this by hand</span>
<a href="#l20.132"></a><span id="l20.132">       this.updatePlaySound();</span>
<a href="#l20.133"></a><span id="l20.133">     });</span>
<a href="#l20.134"></a><span id="l20.134">   },</span>
<a href="#l20.135"></a><span id="l20.135"> </span>
<a href="#l20.136"></a><span id="l20.136">   updatePlaySound() {</span>
<a href="#l20.137"></a><span id="l20.137" class="difflineminus">-    // update the sound type radio buttons based on the state of the play sound checkbox</span>
<a href="#l20.138"></a><span id="l20.138" class="difflineminus">-    let soundsDisabled = !document.getElementById(&quot;chatNotification&quot;).checked;</span>
<a href="#l20.139"></a><span id="l20.139" class="difflineminus">-    let soundTypeEl = document.getElementById(&quot;chatSoundType&quot;);</span>
<a href="#l20.140"></a><span id="l20.140" class="difflineminus">-    let chatSoundUrlLocation = document.getElementById(&quot;chatSoundUrlLocation&quot;).value;</span>
<a href="#l20.141"></a><span id="l20.141" class="difflineminus">-    soundTypeEl.disabled = soundsDisabled;</span>
<a href="#l20.142"></a><span id="l20.142" class="difflineplus">+    let soundsEnabled = Preferences.get(&quot;mail.chat.play_sound&quot;).value;</span>
<a href="#l20.143"></a><span id="l20.143" class="difflineplus">+    let soundTypeValue = Preferences.get(&quot;mail.chat.play_sound.type&quot;).value;</span>
<a href="#l20.144"></a><span id="l20.144" class="difflineplus">+    let soundUrlLocation = Preferences.get(&quot;mail.chat.play_sound.url&quot;).value;</span>
<a href="#l20.145"></a><span id="l20.145" class="difflineplus">+</span>
<a href="#l20.146"></a><span id="l20.146" class="difflineplus">+    document.getElementById(&quot;chatSoundType&quot;).disabled = !soundsEnabled;</span>
<a href="#l20.147"></a><span id="l20.147">     document.getElementById(&quot;chatSoundUrlLocation&quot;).disabled =</span>
<a href="#l20.148"></a><span id="l20.148" class="difflineminus">-      soundsDisabled || (soundTypeEl.value != 1);</span>
<a href="#l20.149"></a><span id="l20.149" class="difflineplus">+      !soundsEnabled || (soundTypeValue != 1);</span>
<a href="#l20.150"></a><span id="l20.150">     document.getElementById(&quot;playChatSound&quot;).disabled =</span>
<a href="#l20.151"></a><span id="l20.151" class="difflineminus">-      soundsDisabled || (!chatSoundUrlLocation &amp;&amp; soundTypeEl.value != 0);</span>
<a href="#l20.152"></a><span id="l20.152" class="difflineplus">+      !soundsEnabled || (!soundUrlLocation &amp;&amp; soundTypeValue != 0);</span>
<a href="#l20.153"></a><span id="l20.153">   },</span>
<a href="#l20.154"></a><span id="l20.154"> };</span>
<a href="#l20.155"></a><span id="l20.155" class="difflineplus">+</span>
<a href="#l20.156"></a><span id="l20.156" class="difflineplus">+Preferences.get(&quot;messenger.status.reportIdle&quot;).on(&quot;change&quot;, gChatPane.updateDisabledState);</span>
<a href="#l20.157"></a><span id="l20.157" class="difflineplus">+Preferences.get(&quot;messenger.status.awayWhenIdle&quot;).on(&quot;change&quot;, gChatPane.updateMessageDisabledState);</span>
<a href="#l20.158"></a><span id="l20.158" class="difflineplus">+Preferences.get(&quot;mail.chat.play_sound&quot;).on(&quot;change&quot;, gChatPane.updatePlaySound);</span>
<a href="#l20.159"></a><span id="l20.159" class="difflineplus">+Preferences.get(&quot;mail.chat.play_sound.type&quot;).on(&quot;change&quot;, gChatPane.updatePlaySound);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">new file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- /dev/null</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ b/mail/components/preferences/colors.js</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -0,0 +1,15 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineplus">+ * file, you can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineplus">+</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineplus">+Preferences.addAll([</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+  { id: &quot;browser.display.document_color_use&quot;, type: &quot;int&quot; },</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+  { id: &quot;browser.anchor_color&quot;, type: &quot;string&quot; },</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+  { id: &quot;browser.visited_color&quot;, type: &quot;string&quot; },</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+  { id: &quot;browser.underline_anchors&quot;, type: &quot;bool&quot; },</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+  { id: &quot;browser.display.foreground_color&quot;, type: &quot;string&quot; },</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+  { id: &quot;browser.display.background_color&quot;, type: &quot;string&quot; },</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+  { id: &quot;browser.display.use_system_colors&quot;, type: &quot;bool&quot; },</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/components/preferences/colors.xul</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/components/preferences/colors.xul</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -3,55 +3,29 @@</span>
<a href="#l22.4"></a><span id="l22.4"> # -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l22.5"></a><span id="l22.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.6"></a><span id="l22.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.7"></a><span id="l22.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l22.10"></a><span id="l22.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l22.11"></a><span id="l22.11"> </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-&lt;!DOCTYPE prefwindow SYSTEM &quot;chrome://messenger/locale/preferences/colors.dtd&quot; &gt;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-&lt;prefwindow id=&quot;ColorsDialog&quot; type=&quot;child&quot;</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineminus">-            xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineminus">-            title=&quot;&amp;colorsDialog.title;&quot;</span>
<a href="#l22.18"></a><span id="l22.18" class="difflineminus">-            dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l22.19"></a><span id="l22.19" class="difflineminus">-            onload=&quot;init()&quot;</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineminus">-#ifdef XP_MACOSX</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineminus">-            style=&quot;width: &amp;window.macWidth; !important;&quot;&gt;</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineminus">-#else</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineminus">-            style=&quot;width: &amp;window.width; !important;&quot;&gt;</span>
<a href="#l22.24"></a><span id="l22.24" class="difflineminus">-#endif</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineplus">+&lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/preferences/colors.dtd&quot; &gt;</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://communicator/content/utilityOverlay.js&quot;/&gt;</span>
<a href="#l22.28"></a><span id="l22.28" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot;&gt;&lt;![CDATA[</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-    function init() {</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-      document.getElementById(&quot;foregroundtextmenu&quot;).value =</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-        document.getElementById(&quot;browser.display.foreground_color&quot;).value;</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineminus">-      document.getElementById(&quot;backgroundmenu&quot;).value =</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">-        document.getElementById(&quot;browser.display.background_color&quot;).value;</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-      document.getElementById(&quot;unvisitedlinkmenu&quot;).value =</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">-        document.getElementById(&quot;browser.anchor_color&quot;).value;</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineminus">-      document.getElementById(&quot;visitedlinkmenu&quot;).value =</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineminus">-        document.getElementById(&quot;browser.visited_color&quot;).value;</span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">-    }</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-  ]]&gt;&lt;/script&gt;</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineplus">+&lt;dialog id=&quot;ColorsDialog&quot; type=&quot;child&quot;</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineplus">+        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineplus">+        title=&quot;&amp;colorsDialog.title;&quot;</span>
<a href="#l22.44"></a><span id="l22.44" class="difflineplus">+        dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineplus">+#ifdef XP_MACOSX</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineplus">+        style=&quot;width: &amp;window.macWidth; !important;&quot;&gt;</span>
<a href="#l22.47"></a><span id="l22.47" class="difflineplus">+#else</span>
<a href="#l22.48"></a><span id="l22.48" class="difflineplus">+        style=&quot;width: &amp;window.width; !important;&quot;&gt;</span>
<a href="#l22.49"></a><span id="l22.49" class="difflineplus">+#endif</span>
<a href="#l22.50"></a><span id="l22.50">   &lt;prefpane id=&quot;ColorsDialogPane&quot;&gt;</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineminus">-    &lt;preferences&gt;</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineminus">-      &lt;preference id=&quot;browser.display.document_color_use&quot;   name=&quot;browser.display.document_color_use&quot;   type=&quot;int&quot;/&gt;</span>
<a href="#l22.54"></a><span id="l22.54" class="difflineminus">-      &lt;preference id=&quot;browser.anchor_color&quot;                 name=&quot;browser.anchor_color&quot;                 type=&quot;string&quot;/&gt;</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineminus">-      &lt;preference id=&quot;browser.visited_color&quot;                name=&quot;browser.visited_color&quot;                type=&quot;string&quot;/&gt;</span>
<a href="#l22.56"></a><span id="l22.56" class="difflineminus">-      &lt;preference id=&quot;browser.underline_anchors&quot;            name=&quot;browser.underline_anchors&quot;            type=&quot;bool&quot;/&gt;</span>
<a href="#l22.57"></a><span id="l22.57" class="difflineminus">-      &lt;preference id=&quot;browser.display.foreground_color&quot;     name=&quot;browser.display.foreground_color&quot;     type=&quot;string&quot;/&gt;</span>
<a href="#l22.58"></a><span id="l22.58" class="difflineminus">-      &lt;preference id=&quot;browser.display.background_color&quot;     name=&quot;browser.display.background_color&quot;     type=&quot;string&quot;/&gt;</span>
<a href="#l22.59"></a><span id="l22.59" class="difflineminus">-      &lt;preference id=&quot;browser.display.use_system_colors&quot;    name=&quot;browser.display.use_system_colors&quot;    type=&quot;bool&quot;/&gt;</span>
<a href="#l22.60"></a><span id="l22.60" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l22.61"></a><span id="l22.61" class="difflineminus">-</span>
<a href="#l22.62"></a><span id="l22.62">     &lt;hbox&gt;</span>
<a href="#l22.63"></a><span id="l22.63">       &lt;groupbox flex=&quot;1&quot;&gt;</span>
<a href="#l22.64"></a><span id="l22.64">         &lt;label&gt;&lt;html:h2&gt;&amp;color;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l22.65"></a><span id="l22.65">         &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l22.66"></a><span id="l22.66">           &lt;label value=&quot;&amp;textColor.label;&quot; accesskey=&quot;&amp;textColor.accesskey;&quot; control=&quot;foregroundtextmenu&quot;/&gt;</span>
<a href="#l22.67"></a><span id="l22.67">           &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l22.68"></a><span id="l22.68">           &lt;html:input type=&quot;color&quot; id=&quot;foregroundtextmenu&quot; preference=&quot;browser.display.foreground_color&quot;/&gt;</span>
<a href="#l22.69"></a><span id="l22.69">         &lt;/hbox&gt;</span>
<a href="#l22.70"></a><span id="l22.70" class="difflineat">@@ -101,9 +75,12 @@</span>
<a href="#l22.71"></a><span id="l22.71">           &lt;menuitem label=&quot;&amp;overridePageColors.auto.label;&quot;</span>
<a href="#l22.72"></a><span id="l22.72">                     value=&quot;0&quot; id=&quot;documentColorAutomatic&quot;/&gt;</span>
<a href="#l22.73"></a><span id="l22.73">           &lt;menuitem label=&quot;&amp;overridePageColors.never.label;&quot;</span>
<a href="#l22.74"></a><span id="l22.74">                     value=&quot;1&quot; id=&quot;documentColorNever&quot;/&gt;</span>
<a href="#l22.75"></a><span id="l22.75">         &lt;/menupopup&gt;</span>
<a href="#l22.76"></a><span id="l22.76">       &lt;/menulist&gt;</span>
<a href="#l22.77"></a><span id="l22.77">     &lt;/vbox&gt;</span>
<a href="#l22.78"></a><span id="l22.78">   &lt;/prefpane&gt;</span>
<a href="#l22.79"></a><span id="l22.79" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l22.80"></a><span id="l22.80" class="difflineplus">+</span>
<a href="#l22.81"></a><span id="l22.81" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l22.82"></a><span id="l22.82" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/colors.js&quot;/&gt;</span>
<a href="#l22.83"></a><span id="l22.83" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/components/preferences/compose.inc.xul</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/components/preferences/compose.inc.xul</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -3,57 +3,16 @@</span>
<a href="#l23.4"></a><span id="l23.4"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l23.5"></a><span id="l23.5">   &lt;prefpane id=&quot;paneCompose&quot; label=&quot;&amp;paneComposition.title;&quot;&gt;</span>
<a href="#l23.6"></a><span id="l23.6">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/compose.js&quot;/&gt;</span>
<a href="#l23.7"></a><span id="l23.7">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/contentAreaUtils.js&quot;/&gt;</span>
<a href="#l23.8"></a><span id="l23.8">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://communicator/content/utilityOverlay.js&quot;/&gt;</span>
<a href="#l23.9"></a><span id="l23.9"> </span>
<a href="#l23.10"></a><span id="l23.10">     &lt;stringbundle id=&quot;bundle_addressBook&quot; src=&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;/&gt;</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-    &lt;preferences id=&quot;composePreferences&quot;&gt;</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-      &lt;preference id=&quot;mail.preferences.compose.selectedTabIndex&quot; name=&quot;mail.preferences.compose.selectedTabIndex&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">-      &lt;preference id=&quot;mail.forward_message_mode&quot; name=&quot;mail.forward_message_mode&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">-      &lt;preference id=&quot;mail.forward_add_extension&quot; name=&quot;mail.forward_add_extension&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-      &lt;preference id=&quot;mail.SpellCheckBeforeSend&quot; name=&quot;mail.SpellCheckBeforeSend&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-      &lt;preference id=&quot;mail.spellcheck.inline&quot; name=&quot;mail.spellcheck.inline&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineminus">-      &lt;preference id=&quot;mail.warn_on_send_accel_key&quot; name=&quot;mail.warn_on_send_accel_key&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineminus">-      &lt;preference id=&quot;mail.compose.autosave&quot; name=&quot;mail.compose.autosave&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineminus">-      &lt;preference id=&quot;mail.compose.autosaveinterval&quot; name=&quot;mail.compose.autosaveinterval&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineminus">-      &lt;preference id=&quot;mail.enable_autocomplete&quot; name=&quot;mail.enable_autocomplete&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">-      &lt;preference id=&quot;ldap_2.autoComplete.useDirectory&quot;</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineminus">-                  name=&quot;ldap_2.autoComplete.useDirectory&quot;</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineminus">-                  onchange=&quot;gComposePane.enableAutocomplete();&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineminus">-      &lt;preference id=&quot;ldap_2.autoComplete.directoryServer&quot; name=&quot;ldap_2.autoComplete.directoryServer&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineminus">-      &lt;preference id=&quot;pref.ldap.disable_button.edit_directories&quot;</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineminus">-                  name=&quot;pref.ldap.disable_button.edit_directories&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-      &lt;preference id=&quot;mail.collect_email_address_outgoing&quot; name=&quot;mail.collect_email_address_outgoing&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineminus">-      &lt;preference id=&quot;mail.collect_addressbook&quot; name=&quot;mail.collect_addressbook&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-      &lt;preference id=&quot;spellchecker.dictionary&quot;  name=&quot;spellchecker.dictionary&quot;   type=&quot;unichar&quot;/&gt;</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-      &lt;preference id=&quot;msgcompose.default_colors&quot; name=&quot;msgcompose.default_colors&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-      &lt;preference id=&quot;msgcompose.font_face&quot;      name=&quot;msgcompose.font_face&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineminus">-      &lt;preference id=&quot;msgcompose.font_size&quot;      name=&quot;msgcompose.font_size&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineminus">-      &lt;preference id=&quot;msgcompose.text_color&quot;     name=&quot;msgcompose.text_color&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineminus">-      &lt;preference id=&quot;msgcompose.background_color&quot; name=&quot;msgcompose.background_color&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineminus">-      &lt;preference id=&quot;mail.compose.attachment_reminder&quot;</span>
<a href="#l23.37"></a><span id="l23.37" class="difflineminus">-                  name=&quot;mail.compose.attachment_reminder&quot;</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineminus">-      &lt;preference id=&quot;mail.compose.default_to_paragraph&quot;</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineminus">-                  name=&quot;mail.compose.default_to_paragraph&quot;</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineminus">-</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineminus">-    &lt;commandset id=&quot;compositionGeneralCommandSet&quot;&gt;</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineminus">-      &lt;command id=&quot;cmd_toggleAutosave&quot;</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineminus">-               oncommand=&quot;gComposePane.updateAutosave();&quot;/&gt;</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineminus">-      &lt;command id=&quot;cmd_toggleAttachmentCheck&quot;</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-               oncommand=&quot;gComposePane.updateAttachmentCheck();&quot;/&gt;</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-      &lt;command id=&quot;cmd_toggleUseReaderDefaults&quot;</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-               oncommand=&quot;gComposePane.updateUseReaderDefaults();&quot;/&gt;</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-    &lt;/commandset&gt;</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-</span>
<a href="#l23.53"></a><span id="l23.53">     &lt;tabbox id=&quot;composePrefs&quot; flex=&quot;1&quot; onselect=&quot;gComposePane.tabSelectionChanged();&quot;&gt;</span>
<a href="#l23.54"></a><span id="l23.54">       &lt;tabs id=&quot;composePrefsTabs&quot;&gt;</span>
<a href="#l23.55"></a><span id="l23.55">         &lt;tab id=&quot;generalTab&quot; label=&quot;&amp;itemGeneral.label;&quot;/&gt;</span>
<a href="#l23.56"></a><span id="l23.56">         &lt;tab id=&quot;addressingTab&quot; label=&quot;&amp;itemAutoComplete.label;&quot;/&gt;</span>
<a href="#l23.57"></a><span id="l23.57">         &lt;tab id=&quot;spellingTab&quot; label=&quot;&amp;itemSpellCheck.label;&quot;/&gt;</span>
<a href="#l23.58"></a><span id="l23.58">       &lt;/tabs&gt;</span>
<a href="#l23.59"></a><span id="l23.59"> </span>
<a href="#l23.60"></a><span id="l23.60">       &lt;tabpanels id=&quot;composePrefsPanels&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineat">@@ -71,17 +30,17 @@</span>
<a href="#l23.62"></a><span id="l23.62">               &lt;checkbox id=&quot;addExtension&quot; label=&quot;&amp;addExtension.label;&quot; preference=&quot;mail.forward_add_extension&quot;</span>
<a href="#l23.63"></a><span id="l23.63">                         accesskey=&quot;&amp;addExtension.accesskey;&quot;/&gt;</span>
<a href="#l23.64"></a><span id="l23.64">             &lt;/hbox&gt;</span>
<a href="#l23.65"></a><span id="l23.65"> </span>
<a href="#l23.66"></a><span id="l23.66">             &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l23.67"></a><span id="l23.67"> </span>
<a href="#l23.68"></a><span id="l23.68">             &lt;hbox align=&quot;center&quot; pack=&quot;start&quot;&gt;</span>
<a href="#l23.69"></a><span id="l23.69">               &lt;checkbox id=&quot;autoSave&quot; label=&quot;&amp;autoSave.label;&quot; preference=&quot;mail.compose.autosave&quot;</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-                        accesskey=&quot;&amp;autoSave.accesskey;&quot; command=&quot;cmd_toggleAutosave&quot;/&gt;</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineplus">+                        accesskey=&quot;&amp;autoSave.accesskey;&quot;/&gt;</span>
<a href="#l23.72"></a><span id="l23.72">               &lt;textbox id=&quot;autoSaveInterval&quot;</span>
<a href="#l23.73"></a><span id="l23.73">                        size=&quot;2&quot; type=&quot;number&quot; min=&quot;1&quot; max=&quot;35790&quot;</span>
<a href="#l23.74"></a><span id="l23.74">                        preference=&quot;mail.compose.autosaveinterval&quot;</span>
<a href="#l23.75"></a><span id="l23.75">                        aria-labelledby=&quot;autoSave autoSaveInterval autoSaveEnd&quot;/&gt;</span>
<a href="#l23.76"></a><span id="l23.76">               &lt;label id=&quot;autoSaveEnd&quot; value=&quot;&amp;autoSaveEnd.label;&quot;/&gt;</span>
<a href="#l23.77"></a><span id="l23.77">             &lt;/hbox&gt;</span>
<a href="#l23.78"></a><span id="l23.78">             &lt;hbox&gt;</span>
<a href="#l23.79"></a><span id="l23.79">               &lt;checkbox id=&quot;mailWarnOnSendAccelKey&quot;</span>
<a href="#l23.80"></a><span id="l23.80" class="difflineat">@@ -89,18 +48,17 @@</span>
<a href="#l23.81"></a><span id="l23.81">                         preference=&quot;mail.warn_on_send_accel_key&quot;</span>
<a href="#l23.82"></a><span id="l23.82">                         accesskey=&quot;&amp;warnOnSendAccelKey.accesskey;&quot;/&gt;</span>
<a href="#l23.83"></a><span id="l23.83">               &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l23.84"></a><span id="l23.84">             &lt;/hbox&gt;</span>
<a href="#l23.85"></a><span id="l23.85">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l23.86"></a><span id="l23.86">               &lt;checkbox id=&quot;attachment_reminder_label&quot;</span>
<a href="#l23.87"></a><span id="l23.87">                         label=&quot;&amp;attachmentReminder.label;&quot;</span>
<a href="#l23.88"></a><span id="l23.88">                         accesskey=&quot;&amp;attachmentReminder.accesskey;&quot;</span>
<a href="#l23.89"></a><span id="l23.89" class="difflineminus">-                        preference=&quot;mail.compose.attachment_reminder&quot;</span>
<a href="#l23.90"></a><span id="l23.90" class="difflineminus">-                        command=&quot;cmd_toggleAttachmentCheck&quot;/&gt;</span>
<a href="#l23.91"></a><span id="l23.91" class="difflineplus">+                        preference=&quot;mail.compose.attachment_reminder&quot;/&gt;</span>
<a href="#l23.92"></a><span id="l23.92">               &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l23.93"></a><span id="l23.93">               &lt;button id=&quot;attachment_reminder_button&quot;</span>
<a href="#l23.94"></a><span id="l23.94">                       label=&quot;&amp;attachmentReminderOptions.label;&quot;</span>
<a href="#l23.95"></a><span id="l23.95">                       accesskey=&quot;&amp;attachmentReminderOptions.accesskey;&quot;</span>
<a href="#l23.96"></a><span id="l23.96">                       oncommand=&quot;gComposePane.attachmentReminderOptionsDialog();&quot;/&gt;</span>
<a href="#l23.97"></a><span id="l23.97">             &lt;/hbox&gt;</span>
<a href="#l23.98"></a><span id="l23.98"> </span>
<a href="#l23.99"></a><span id="l23.99">           &lt;/groupbox&gt;</span>
<a href="#l23.100"></a><span id="l23.100" class="difflineat">@@ -136,18 +94,17 @@</span>
<a href="#l23.101"></a><span id="l23.101">             &lt;/hbox&gt;</span>
<a href="#l23.102"></a><span id="l23.102"> </span>
<a href="#l23.103"></a><span id="l23.103">             &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l23.104"></a><span id="l23.104"> </span>
<a href="#l23.105"></a><span id="l23.105">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l23.106"></a><span id="l23.106">               &lt;checkbox id=&quot;useReaderDefaults&quot;</span>
<a href="#l23.107"></a><span id="l23.107">                         label=&quot;&amp;useReaderDefaults.label;&quot;</span>
<a href="#l23.108"></a><span id="l23.108">                         accesskey=&quot;&amp;useReaderDefaults.accesskey;&quot;</span>
<a href="#l23.109"></a><span id="l23.109" class="difflineminus">-                        preference=&quot;msgcompose.default_colors&quot;</span>
<a href="#l23.110"></a><span id="l23.110" class="difflineminus">-                        command=&quot;cmd_toggleUseReaderDefaults&quot;/&gt;</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineplus">+                        preference=&quot;msgcompose.default_colors&quot;/&gt;</span>
<a href="#l23.112"></a><span id="l23.112">             &lt;/hbox&gt;</span>
<a href="#l23.113"></a><span id="l23.113">             &lt;hbox align=&quot;center&quot; class=&quot;indent&quot;&gt;</span>
<a href="#l23.114"></a><span id="l23.114">               &lt;label id=&quot;textColorLabel&quot;</span>
<a href="#l23.115"></a><span id="l23.115">                      control=&quot;textColorButton&quot;</span>
<a href="#l23.116"></a><span id="l23.116">                      value=&quot;&amp;fontColor.label;&quot;</span>
<a href="#l23.117"></a><span id="l23.117">                      accesskey=&quot;&amp;fontColor.accesskey;&quot;/&gt;</span>
<a href="#l23.118"></a><span id="l23.118">               &lt;html:input type=&quot;color&quot; id=&quot;textColorButton&quot; preference=&quot;msgcompose.text_color&quot;/&gt;</span>
<a href="#l23.119"></a><span id="l23.119">               &lt;separator orient=&quot;vertical&quot; class=&quot;thin&quot;/&gt;</span>
<a href="#l23.120"></a><span id="l23.120" class="difflineat">@@ -212,18 +169,17 @@</span>
<a href="#l23.121"></a><span id="l23.121">               &lt;/hbox&gt;</span>
<a href="#l23.122"></a><span id="l23.122">             &lt;/groupbox&gt;</span>
<a href="#l23.123"></a><span id="l23.123"> </span>
<a href="#l23.124"></a><span id="l23.124">             &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l23.125"></a><span id="l23.125"> </span>
<a href="#l23.126"></a><span id="l23.126">             &lt;hbox align=&quot;center&quot; pack=&quot;start&quot;&gt;</span>
<a href="#l23.127"></a><span id="l23.127">               &lt;checkbox id=&quot;emailCollectionOutgoing&quot; label=&quot;&amp;emailCollectionPicker.label;&quot;</span>
<a href="#l23.128"></a><span id="l23.128">                         accesskey=&quot;&amp;emailCollectionPicker.accesskey;&quot;</span>
<a href="#l23.129"></a><span id="l23.129" class="difflineminus">-                        preference=&quot;mail.collect_email_address_outgoing&quot;</span>
<a href="#l23.130"></a><span id="l23.130" class="difflineminus">-                        oncommand=&quot;gComposePane.updateEmailCollection();&quot;/&gt;</span>
<a href="#l23.131"></a><span id="l23.131" class="difflineplus">+                        preference=&quot;mail.collect_email_address_outgoing&quot;/&gt;</span>
<a href="#l23.132"></a><span id="l23.132">               &lt;menulist id=&quot;localDirectoriesList&quot; flex=&quot;1&quot;</span>
<a href="#l23.133"></a><span id="l23.133">                         preference=&quot;mail.collect_addressbook&quot;</span>
<a href="#l23.134"></a><span id="l23.134">                         aria-labelledby=&quot;emailCollectionOutgoing&quot;&gt;</span>
<a href="#l23.135"></a><span id="l23.135">                 &lt;menupopup id=&quot;abPopup-menupopup&quot; class=&quot;addrbooksPopup&quot;</span>
<a href="#l23.136"></a><span id="l23.136">                            localonly=&quot;true&quot; writable=&quot;true&quot;/&gt;</span>
<a href="#l23.137"></a><span id="l23.137">               &lt;/menulist&gt;</span>
<a href="#l23.138"></a><span id="l23.138">             &lt;/hbox&gt;</span>
<a href="#l23.139"></a><span id="l23.139"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mail/components/preferences/compose.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mail/components/preferences/compose.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -5,16 +5,41 @@</span>
<a href="#l24.4"></a><span id="l24.4"> </span>
<a href="#l24.5"></a><span id="l24.5"> &quot;use strict&quot;;</span>
<a href="#l24.6"></a><span id="l24.6"> </span>
<a href="#l24.7"></a><span id="l24.7"> /* import-globals-from preferences.js */</span>
<a href="#l24.8"></a><span id="l24.8"> /* import-globals-from subdialogs.js */</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10"> var {InlineSpellChecker} = ChromeUtils.import(&quot;resource://gre/modules/InlineSpellChecker.jsm&quot;);</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+  { id: &quot;mail.preferences.compose.selectedTabIndex&quot;, type: &quot;int&quot; },</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+  { id: &quot;mail.forward_message_mode&quot;, type: &quot;int&quot; },</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+  { id: &quot;mail.forward_add_extension&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+  { id: &quot;mail.SpellCheckBeforeSend&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+  { id: &quot;mail.spellcheck.inline&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+  { id: &quot;mail.warn_on_send_accel_key&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+  { id: &quot;mail.compose.autosave&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+  { id: &quot;mail.compose.autosaveinterval&quot;, type: &quot;int&quot; },</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+  { id: &quot;mail.enable_autocomplete&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+  { id: &quot;ldap_2.autoComplete.useDirectory&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineplus">+  { id: &quot;ldap_2.autoComplete.directoryServer&quot;, type: &quot;string&quot; },</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+  { id: &quot;pref.ldap.disable_button.edit_directories&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+  { id: &quot;mail.collect_email_address_outgoing&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+  { id: &quot;mail.collect_addressbook&quot;, type: &quot;string&quot; },</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+  { id: &quot;spellchecker.dictionary&quot;, type: &quot;unichar&quot; },</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineplus">+  { id: &quot;msgcompose.default_colors&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineplus">+  { id: &quot;msgcompose.font_face&quot;, type: &quot;string&quot; },</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineplus">+  { id: &quot;msgcompose.font_size&quot;, type: &quot;string&quot; },</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+  { id: &quot;msgcompose.text_color&quot;, type: &quot;string&quot; },</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+  { id: &quot;msgcompose.background_color&quot;, type: &quot;string&quot; },</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineplus">+  { id: &quot;mail.compose.attachment_reminder&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+  { id: &quot;mail.compose.default_to_paragraph&quot;, type: &quot;bool&quot; },</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineplus">+]);</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineplus">+</span>
<a href="#l24.37"></a><span id="l24.37"> document.getElementById(&quot;paneCompose&quot;)</span>
<a href="#l24.38"></a><span id="l24.38">         .addEventListener(&quot;paneload&quot;, function() { gComposePane.init(); });</span>
<a href="#l24.39"></a><span id="l24.39"> </span>
<a href="#l24.40"></a><span id="l24.40"> var gComposePane = {</span>
<a href="#l24.41"></a><span id="l24.41">   mInitialized: false,</span>
<a href="#l24.42"></a><span id="l24.42">   mSpellChecker: null,</span>
<a href="#l24.43"></a><span id="l24.43">   mDictCount: 0,</span>
<a href="#l24.44"></a><span id="l24.44"> </span>
<a href="#l24.45"></a><span id="l24.45" class="difflineat">@@ -34,79 +59,87 @@ var gComposePane = {</span>
<a href="#l24.46"></a><span id="l24.46">     this.updateEmailCollection();</span>
<a href="#l24.47"></a><span id="l24.47"> </span>
<a href="#l24.48"></a><span id="l24.48">     this.initAbDefaultStartupDir();</span>
<a href="#l24.49"></a><span id="l24.49"> </span>
<a href="#l24.50"></a><span id="l24.50">     this.setButtonColors();</span>
<a href="#l24.51"></a><span id="l24.51"> </span>
<a href="#l24.52"></a><span id="l24.52">     if (!((&quot;arguments&quot; in window) &amp;&amp; window.arguments[1])) {</span>
<a href="#l24.53"></a><span id="l24.53">       // If no tab was specified, select the last used tab.</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineminus">-      let preference = document.getElementById(&quot;mail.preferences.compose.selectedTabIndex&quot;);</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineplus">+      let preference = Preferences.get(&quot;mail.preferences.compose.selectedTabIndex&quot;);</span>
<a href="#l24.56"></a><span id="l24.56">       if (preference.value)</span>
<a href="#l24.57"></a><span id="l24.57">         document.getElementById(&quot;composePrefs&quot;).selectedIndex = preference.value;</span>
<a href="#l24.58"></a><span id="l24.58">     }</span>
<a href="#l24.59"></a><span id="l24.59"> </span>
<a href="#l24.60"></a><span id="l24.60">     this.mInitialized = true;</span>
<a href="#l24.61"></a><span id="l24.61">   },</span>
<a href="#l24.62"></a><span id="l24.62"> </span>
<a href="#l24.63"></a><span id="l24.63">   tabSelectionChanged() {</span>
<a href="#l24.64"></a><span id="l24.64">     if (this.mInitialized) {</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineminus">-      var preference = document.getElementById(&quot;mail.preferences.compose.selectedTabIndex&quot;);</span>
<a href="#l24.66"></a><span id="l24.66" class="difflineplus">+      var preference = Preferences.get(&quot;mail.preferences.compose.selectedTabIndex&quot;);</span>
<a href="#l24.67"></a><span id="l24.67">       preference.valueFromPreferences = document.getElementById(&quot;composePrefs&quot;).selectedIndex;</span>
<a href="#l24.68"></a><span id="l24.68">     }</span>
<a href="#l24.69"></a><span id="l24.69">   },</span>
<a href="#l24.70"></a><span id="l24.70"> </span>
<a href="#l24.71"></a><span id="l24.71">   sendOptionsDialog() {</span>
<a href="#l24.72"></a><span id="l24.72">     gSubDialog.open(&quot;chrome://messenger/content/preferences/sendoptions.xul&quot;);</span>
<a href="#l24.73"></a><span id="l24.73">   },</span>
<a href="#l24.74"></a><span id="l24.74"> </span>
<a href="#l24.75"></a><span id="l24.75">   attachmentReminderOptionsDialog() {</span>
<a href="#l24.76"></a><span id="l24.76">     gSubDialog.open(&quot;chrome://messenger/content/preferences/attachmentReminder.xul&quot;,</span>
<a href="#l24.77"></a><span id="l24.77">                     &quot;resizable=no&quot;);</span>
<a href="#l24.78"></a><span id="l24.78">   },</span>
<a href="#l24.79"></a><span id="l24.79"> </span>
<a href="#l24.80"></a><span id="l24.80">   updateAutosave() {</span>
<a href="#l24.81"></a><span id="l24.81" class="difflineminus">-    this.enableElement(document.getElementById(&quot;autoSaveInterval&quot;),</span>
<a href="#l24.82"></a><span id="l24.82" class="difflineminus">-      document.getElementById(&quot;autoSave&quot;).checked);</span>
<a href="#l24.83"></a><span id="l24.83" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.84"></a><span id="l24.84" class="difflineplus">+      document.getElementById(&quot;autoSaveInterval&quot;),</span>
<a href="#l24.85"></a><span id="l24.85" class="difflineplus">+      Preferences.get(&quot;mail.compose.autosave&quot;).value</span>
<a href="#l24.86"></a><span id="l24.86" class="difflineplus">+    );</span>
<a href="#l24.87"></a><span id="l24.87">   },</span>
<a href="#l24.88"></a><span id="l24.88"> </span>
<a href="#l24.89"></a><span id="l24.89">   updateUseReaderDefaults() {</span>
<a href="#l24.90"></a><span id="l24.90" class="difflineminus">-    let useReaderDefaultsChecked = document.getElementById(&quot;useReaderDefaults&quot;).checked;</span>
<a href="#l24.91"></a><span id="l24.91" class="difflineminus">-    this.enableElement(document.getElementById(&quot;textColorLabel&quot;),</span>
<a href="#l24.92"></a><span id="l24.92" class="difflineminus">-      !useReaderDefaultsChecked);</span>
<a href="#l24.93"></a><span id="l24.93" class="difflineminus">-    this.enableElement(document.getElementById(&quot;backgroundColorLabel&quot;),</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineminus">-      !useReaderDefaultsChecked);</span>
<a href="#l24.95"></a><span id="l24.95" class="difflineminus">-    this.enableElement(document.getElementById(&quot;textColorButton&quot;),</span>
<a href="#l24.96"></a><span id="l24.96" class="difflineminus">-      !useReaderDefaultsChecked);</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineminus">-    this.enableElement(document.getElementById(&quot;backgroundColorButton&quot;),</span>
<a href="#l24.98"></a><span id="l24.98" class="difflineminus">-      !useReaderDefaultsChecked);</span>
<a href="#l24.99"></a><span id="l24.99" class="difflineplus">+    let useReaderDefaultsChecked = Preferences.get(&quot;msgcompose.default_colors&quot;).value;</span>
<a href="#l24.100"></a><span id="l24.100" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.101"></a><span id="l24.101" class="difflineplus">+      document.getElementById(&quot;textColorLabel&quot;), !useReaderDefaultsChecked</span>
<a href="#l24.102"></a><span id="l24.102" class="difflineplus">+    );</span>
<a href="#l24.103"></a><span id="l24.103" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.104"></a><span id="l24.104" class="difflineplus">+      document.getElementById(&quot;backgroundColorLabel&quot;), !useReaderDefaultsChecked</span>
<a href="#l24.105"></a><span id="l24.105" class="difflineplus">+    );</span>
<a href="#l24.106"></a><span id="l24.106" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.107"></a><span id="l24.107" class="difflineplus">+      document.getElementById(&quot;textColorButton&quot;), !useReaderDefaultsChecked</span>
<a href="#l24.108"></a><span id="l24.108" class="difflineplus">+    );</span>
<a href="#l24.109"></a><span id="l24.109" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.110"></a><span id="l24.110" class="difflineplus">+      document.getElementById(&quot;backgroundColorButton&quot;), !useReaderDefaultsChecked</span>
<a href="#l24.111"></a><span id="l24.111" class="difflineplus">+    );</span>
<a href="#l24.112"></a><span id="l24.112">   },</span>
<a href="#l24.113"></a><span id="l24.113"> </span>
<a href="#l24.114"></a><span id="l24.114">   updateAttachmentCheck() {</span>
<a href="#l24.115"></a><span id="l24.115" class="difflineminus">-    this.enableElement(document.getElementById(&quot;attachment_reminder_button&quot;),</span>
<a href="#l24.116"></a><span id="l24.116" class="difflineminus">-      document.getElementById(&quot;attachment_reminder_label&quot;).checked);</span>
<a href="#l24.117"></a><span id="l24.117" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.118"></a><span id="l24.118" class="difflineplus">+      document.getElementById(&quot;attachment_reminder_button&quot;),</span>
<a href="#l24.119"></a><span id="l24.119" class="difflineplus">+      Preferences.get(&quot;mail.compose.attachment_reminder&quot;).value</span>
<a href="#l24.120"></a><span id="l24.120" class="difflineplus">+    );</span>
<a href="#l24.121"></a><span id="l24.121">   },</span>
<a href="#l24.122"></a><span id="l24.122"> </span>
<a href="#l24.123"></a><span id="l24.123">   updateEmailCollection() {</span>
<a href="#l24.124"></a><span id="l24.124" class="difflineminus">-    this.enableElement(document.getElementById(&quot;localDirectoriesList&quot;),</span>
<a href="#l24.125"></a><span id="l24.125" class="difflineminus">-      document.getElementById(&quot;emailCollectionOutgoing&quot;).checked);</span>
<a href="#l24.126"></a><span id="l24.126" class="difflineplus">+    gComposePane.enableElement(</span>
<a href="#l24.127"></a><span id="l24.127" class="difflineplus">+      document.getElementById(&quot;localDirectoriesList&quot;),</span>
<a href="#l24.128"></a><span id="l24.128" class="difflineplus">+      Preferences.get(&quot;mail.collect_email_address_outgoing&quot;).value</span>
<a href="#l24.129"></a><span id="l24.129" class="difflineplus">+    );</span>
<a href="#l24.130"></a><span id="l24.130">   },</span>
<a href="#l24.131"></a><span id="l24.131"> </span>
<a href="#l24.132"></a><span id="l24.132">   enableElement(aElement, aEnable) {</span>
<a href="#l24.133"></a><span id="l24.133">     let pref = aElement.getAttribute(&quot;preference&quot;);</span>
<a href="#l24.134"></a><span id="l24.134" class="difflineminus">-    let prefIsLocked = pref ? document.getElementById(pref).locked : false;</span>
<a href="#l24.135"></a><span id="l24.135" class="difflineplus">+    let prefIsLocked = pref ? Preferences.get(pref).locked : false;</span>
<a href="#l24.136"></a><span id="l24.136">     aElement.disabled = !aEnable || prefIsLocked;</span>
<a href="#l24.137"></a><span id="l24.137">   },</span>
<a href="#l24.138"></a><span id="l24.138"> </span>
<a href="#l24.139"></a><span id="l24.139">   enableAutocomplete() {</span>
<a href="#l24.140"></a><span id="l24.140" class="difflineminus">-    var acLDAPPref = document.getElementById(&quot;ldap_2.autoComplete.useDirectory&quot;)</span>
<a href="#l24.141"></a><span id="l24.141" class="difflineminus">-                             .value;</span>
<a href="#l24.142"></a><span id="l24.142" class="difflineminus">-</span>
<a href="#l24.143"></a><span id="l24.143" class="difflineminus">-    this.enableElement(document.getElementById(&quot;directoriesList&quot;), acLDAPPref);</span>
<a href="#l24.144"></a><span id="l24.144" class="difflineminus">-    this.enableElement(document.getElementById(&quot;editButton&quot;), acLDAPPref);</span>
<a href="#l24.145"></a><span id="l24.145" class="difflineplus">+    let acLDAPPref = Preferences.get(&quot;ldap_2.autoComplete.useDirectory&quot;).value;</span>
<a href="#l24.146"></a><span id="l24.146" class="difflineplus">+    gComposePane.enableElement(document.getElementById(&quot;directoriesList&quot;), acLDAPPref);</span>
<a href="#l24.147"></a><span id="l24.147" class="difflineplus">+    gComposePane.enableElement(document.getElementById(&quot;editButton&quot;), acLDAPPref);</span>
<a href="#l24.148"></a><span id="l24.148">   },</span>
<a href="#l24.149"></a><span id="l24.149"> </span>
<a href="#l24.150"></a><span id="l24.150">   editDirectories() {</span>
<a href="#l24.151"></a><span id="l24.151">     gSubDialog.open(&quot;chrome://messenger/content/addressbook/pref-editdirectories.xul&quot;);</span>
<a href="#l24.152"></a><span id="l24.152">   },</span>
<a href="#l24.153"></a><span id="l24.153"> </span>
<a href="#l24.154"></a><span id="l24.154">   initAbDefaultStartupDir() {</span>
<a href="#l24.155"></a><span id="l24.155">     if (!this.startupDirListener.inited)</span>
<a href="#l24.156"></a><span id="l24.156" class="difflineat">@@ -127,19 +160,19 @@ var gComposePane = {</span>
<a href="#l24.157"></a><span id="l24.157">     } else {</span>
<a href="#l24.158"></a><span id="l24.158">       // Choose item meaning there is no default startup directory any more.</span>
<a href="#l24.159"></a><span id="l24.159">       dirList.value = &quot;&quot;;</span>
<a href="#l24.160"></a><span id="l24.160">     }</span>
<a href="#l24.161"></a><span id="l24.161">   },</span>
<a href="#l24.162"></a><span id="l24.162"> </span>
<a href="#l24.163"></a><span id="l24.163">   setButtonColors() {</span>
<a href="#l24.164"></a><span id="l24.164">     document.getElementById(&quot;textColorButton&quot;).value =</span>
<a href="#l24.165"></a><span id="l24.165" class="difflineminus">-      document.getElementById(&quot;msgcompose.text_color&quot;).value;</span>
<a href="#l24.166"></a><span id="l24.166" class="difflineplus">+      Preferences.get(&quot;msgcompose.text_color&quot;).value;</span>
<a href="#l24.167"></a><span id="l24.167">     document.getElementById(&quot;backgroundColorButton&quot;).value =</span>
<a href="#l24.168"></a><span id="l24.168" class="difflineminus">-      document.getElementById(&quot;msgcompose.background_color&quot;).value;</span>
<a href="#l24.169"></a><span id="l24.169" class="difflineplus">+      Preferences.get(&quot;msgcompose.background_color&quot;).value;</span>
<a href="#l24.170"></a><span id="l24.170">   },</span>
<a href="#l24.171"></a><span id="l24.171"> </span>
<a href="#l24.172"></a><span id="l24.172">   setDefaultStartupDir(aDirURI) {</span>
<a href="#l24.173"></a><span id="l24.173">     if (aDirURI) {</span>
<a href="#l24.174"></a><span id="l24.174">       // Some AB directory was selected. Set prefs to make this directory</span>
<a href="#l24.175"></a><span id="l24.175">       // the default view when starting up the main AB.</span>
<a href="#l24.176"></a><span id="l24.176">       Services.prefs.setCharPref(&quot;mail.addr_book.view.startupURI&quot;, aDirURI);</span>
<a href="#l24.177"></a><span id="l24.177">       Services.prefs.setBoolPref(&quot;mail.addr_book.view.startupURIisDefault&quot;, true);</span>
<a href="#l24.178"></a><span id="l24.178" class="difflineat">@@ -196,41 +229,41 @@ var gComposePane = {</span>
<a href="#l24.179"></a><span id="l24.179">       for (let i = 0; i &lt; localFonts.length; ++i) {</span>
<a href="#l24.180"></a><span id="l24.180">         // Remove Linux system generic fonts that collide with CSS generic fonts.</span>
<a href="#l24.181"></a><span id="l24.181">         if (localFonts[i] != &quot;&quot; &amp;&amp; localFonts[i] != &quot;serif&quot; &amp;&amp;</span>
<a href="#l24.182"></a><span id="l24.182">             localFonts[i] != &quot;sans-serif&quot; &amp;&amp; localFonts[i] != &quot;monospace&quot;)</span>
<a href="#l24.183"></a><span id="l24.183">           fontsList.appendItem(localFonts[i], localFonts[i]);</span>
<a href="#l24.184"></a><span id="l24.184">       }</span>
<a href="#l24.185"></a><span id="l24.185">     } catch (e) { }</span>
<a href="#l24.186"></a><span id="l24.186">     // Choose the item after the list is completely generated.</span>
<a href="#l24.187"></a><span id="l24.187" class="difflineminus">-    var preference = document.getElementById(fontsList.getAttribute(&quot;preference&quot;));</span>
<a href="#l24.188"></a><span id="l24.188" class="difflineplus">+    var preference = Preferences.get(fontsList.getAttribute(&quot;preference&quot;));</span>
<a href="#l24.189"></a><span id="l24.189">     fontsList.value = preference.value;</span>
<a href="#l24.190"></a><span id="l24.190">   },</span>
<a href="#l24.191"></a><span id="l24.191"> </span>
<a href="#l24.192"></a><span id="l24.192">    restoreHTMLDefaults() {</span>
<a href="#l24.193"></a><span id="l24.193">      // reset throws an exception if the pref value is already the default so</span>
<a href="#l24.194"></a><span id="l24.194">      // work around that with some try/catch exception handling</span>
<a href="#l24.195"></a><span id="l24.195">      try {</span>
<a href="#l24.196"></a><span id="l24.196" class="difflineminus">-       document.getElementById(&quot;msgcompose.font_face&quot;).reset();</span>
<a href="#l24.197"></a><span id="l24.197" class="difflineplus">+       Preferences.get(&quot;msgcompose.font_face&quot;).reset();</span>
<a href="#l24.198"></a><span id="l24.198">      } catch (ex) {}</span>
<a href="#l24.199"></a><span id="l24.199"> </span>
<a href="#l24.200"></a><span id="l24.200">      try {</span>
<a href="#l24.201"></a><span id="l24.201" class="difflineminus">-       document.getElementById(&quot;msgcompose.font_size&quot;).reset();</span>
<a href="#l24.202"></a><span id="l24.202" class="difflineplus">+       Preferences.get(&quot;msgcompose.font_size&quot;).reset();</span>
<a href="#l24.203"></a><span id="l24.203">      } catch (ex) {}</span>
<a href="#l24.204"></a><span id="l24.204"> </span>
<a href="#l24.205"></a><span id="l24.205">      try {</span>
<a href="#l24.206"></a><span id="l24.206" class="difflineminus">-       document.getElementById(&quot;msgcompose.text_color&quot;).reset();</span>
<a href="#l24.207"></a><span id="l24.207" class="difflineplus">+       Preferences.get(&quot;msgcompose.text_color&quot;).reset();</span>
<a href="#l24.208"></a><span id="l24.208">      } catch (ex) {}</span>
<a href="#l24.209"></a><span id="l24.209"> </span>
<a href="#l24.210"></a><span id="l24.210">      try {</span>
<a href="#l24.211"></a><span id="l24.211" class="difflineminus">-       document.getElementById(&quot;msgcompose.background_color&quot;).reset();</span>
<a href="#l24.212"></a><span id="l24.212" class="difflineplus">+       Preferences.get(&quot;msgcompose.background_color&quot;).reset();</span>
<a href="#l24.213"></a><span id="l24.213">      } catch (ex) {}</span>
<a href="#l24.214"></a><span id="l24.214"> </span>
<a href="#l24.215"></a><span id="l24.215">      try {</span>
<a href="#l24.216"></a><span id="l24.216" class="difflineminus">-       document.getElementById(&quot;msgcompose.default_colors&quot;).reset();</span>
<a href="#l24.217"></a><span id="l24.217" class="difflineplus">+       Preferences.get(&quot;msgcompose.default_colors&quot;).reset();</span>
<a href="#l24.218"></a><span id="l24.218">      } catch (ex) {}</span>
<a href="#l24.219"></a><span id="l24.219"> </span>
<a href="#l24.220"></a><span id="l24.220">      this.updateUseReaderDefaults();</span>
<a href="#l24.221"></a><span id="l24.221">      this.setButtonColors();</span>
<a href="#l24.222"></a><span id="l24.222">   },</span>
<a href="#l24.223"></a><span id="l24.223"> </span>
<a href="#l24.224"></a><span id="l24.224">   startupDirListener: {</span>
<a href="#l24.225"></a><span id="l24.225">     inited: false,</span>
<a href="#l24.226"></a><span id="l24.226" class="difflineat">@@ -252,8 +285,14 @@ var gComposePane = {</span>
<a href="#l24.227"></a><span id="l24.227">     },</span>
<a href="#l24.228"></a><span id="l24.228"> </span>
<a href="#l24.229"></a><span id="l24.229">     unload(event) {</span>
<a href="#l24.230"></a><span id="l24.230">       Services.prefs.removeObserver(gComposePane.startupDirListener.domain,</span>
<a href="#l24.231"></a><span id="l24.231">                                     gComposePane.startupDirListener);</span>
<a href="#l24.232"></a><span id="l24.232">     },</span>
<a href="#l24.233"></a><span id="l24.233">   },</span>
<a href="#l24.234"></a><span id="l24.234"> };</span>
<a href="#l24.235"></a><span id="l24.235" class="difflineplus">+</span>
<a href="#l24.236"></a><span id="l24.236" class="difflineplus">+Preferences.get(&quot;mail.compose.autosave&quot;).on(&quot;change&quot;, gComposePane.updateAutosave);</span>
<a href="#l24.237"></a><span id="l24.237" class="difflineplus">+Preferences.get(&quot;mail.compose.attachment_reminder&quot;).on(&quot;change&quot;, gComposePane.updateAttachmentCheck);</span>
<a href="#l24.238"></a><span id="l24.238" class="difflineplus">+Preferences.get(&quot;msgcompose.default_colors&quot;).on(&quot;change&quot;, gComposePane.updateUseReaderDefaults);</span>
<a href="#l24.239"></a><span id="l24.239" class="difflineplus">+Preferences.get(&quot;ldap_2.autoComplete.useDirectory&quot;).on(&quot;change&quot;, gComposePane.enableAutocomplete);</span>
<a href="#l24.240"></a><span id="l24.240" class="difflineplus">+Preferences.get(&quot;mail.collect_email_address_outgoing&quot;).on(&quot;change&quot;, gComposePane.updateEmailCollection);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mail/components/preferences/connection.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mail/components/preferences/connection.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -1,199 +1,225 @@</span>
<a href="#l25.4"></a><span id="l25.4"> /* -*- Mode: Javascript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l25.5"></a><span id="l25.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.6"></a><span id="l25.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.7"></a><span id="l25.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineplus">+</span>
<a href="#l25.11"></a><span id="l25.11"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l25.12"></a><span id="l25.12"> </span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+Preferences.addAll([</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+  { id: &quot;network.proxy.type&quot;, type: &quot;int&quot; },</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+  { id: &quot;network.proxy.http&quot;, type: &quot;string&quot; },</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+  { id: &quot;network.proxy.http_port&quot;, type: &quot;int&quot; },</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+  { id: &quot;network.proxy.ssl&quot;, type: &quot;string&quot; },</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+  { id: &quot;network.proxy.ssl_port&quot;, type: &quot;int&quot; },</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+  { id: &quot;network.proxy.socks&quot;, type: &quot;string&quot; },</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+  { id: &quot;network.proxy.socks_port&quot;, type: &quot;int&quot; },</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+  { id: &quot;network.proxy.socks_version&quot;, type: &quot;int&quot; },</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineplus">+  { id: &quot;network.proxy.no_proxies_on&quot;, type: &quot;string&quot; },</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+  { id: &quot;network.proxy.autoconfig_url&quot;, type: &quot;string&quot; },</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineplus">+  { id: &quot;network.proxy.share_proxy_settings&quot;, type: &quot;bool&quot; },</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineplus">+  { id: &quot;pref.advanced.proxies.disable_button.reload&quot;, type: &quot;bool&quot; },</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineplus">+  { id: &quot;network.proxy.backup.ssl&quot;, type: &quot;string&quot; },</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineplus">+  { id: &quot;network.proxy.backup.ssl_port&quot;, type: &quot;int&quot; },</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineplus">+  { id: &quot;network.proxy.backup.socks&quot;, type: &quot;string&quot; },</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineplus">+  { id: &quot;network.proxy.backup.socks_port&quot;, type: &quot;int&quot; },</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineplus">+  { id: &quot;network.proxy.socks_remote_dns&quot;, type: &quot;bool&quot; },</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineplus">+  { id: &quot;network.trr.mode&quot;, type: &quot;int&quot; },</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+  { id: &quot;network.trr.uri&quot;, type: &quot;string&quot; },</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineplus">+  { id: &quot;network.trr.custom_uri&quot;, type: &quot;string&quot; },</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+  { id: &quot;signon.autologin.proxy&quot;, type: &quot;bool&quot; },</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+]);</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+</span>
<a href="#l25.37"></a><span id="l25.37"> var gConnectionsDialog = {</span>
<a href="#l25.38"></a><span id="l25.38">   beforeAccept() {</span>
<a href="#l25.39"></a><span id="l25.39">     if (document.getElementById(&quot;customDnsOverHttpsUrlRadio&quot;).selected) {</span>
<a href="#l25.40"></a><span id="l25.40">       Services.prefs.setStringPref(&quot;network.trr.uri&quot;, document.getElementById(&quot;customDnsOverHttpsInput&quot;).value);</span>
<a href="#l25.41"></a><span id="l25.41">     }</span>
<a href="#l25.42"></a><span id="l25.42"> </span>
<a href="#l25.43"></a><span id="l25.43" class="difflineminus">-    var proxyTypePref = document.getElementById(&quot;network.proxy.type&quot;);</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+    var proxyTypePref = Preferences.get(&quot;network.proxy.type&quot;);</span>
<a href="#l25.45"></a><span id="l25.45">     if (proxyTypePref.value == 2) {</span>
<a href="#l25.46"></a><span id="l25.46">       this.doAutoconfigURLFixup();</span>
<a href="#l25.47"></a><span id="l25.47">       return true;</span>
<a href="#l25.48"></a><span id="l25.48">     }</span>
<a href="#l25.49"></a><span id="l25.49"> </span>
<a href="#l25.50"></a><span id="l25.50">     if (proxyTypePref.value != 1)</span>
<a href="#l25.51"></a><span id="l25.51">       return true;</span>
<a href="#l25.52"></a><span id="l25.52"> </span>
<a href="#l25.53"></a><span id="l25.53" class="difflineminus">-    var httpProxyURLPref = document.getElementById(&quot;network.proxy.http&quot;);</span>
<a href="#l25.54"></a><span id="l25.54" class="difflineminus">-    var httpProxyPortPref = document.getElementById(&quot;network.proxy.http_port&quot;);</span>
<a href="#l25.55"></a><span id="l25.55" class="difflineminus">-    var shareProxiesPref = document.getElementById(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.56"></a><span id="l25.56" class="difflineplus">+    var httpProxyURLPref = Preferences.get(&quot;network.proxy.http&quot;);</span>
<a href="#l25.57"></a><span id="l25.57" class="difflineplus">+    var httpProxyPortPref = Preferences.get(&quot;network.proxy.http_port&quot;);</span>
<a href="#l25.58"></a><span id="l25.58" class="difflineplus">+    var shareProxiesPref = Preferences.get(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.59"></a><span id="l25.59">     if (shareProxiesPref.value) {</span>
<a href="#l25.60"></a><span id="l25.60">       var proxyPrefs = [&quot;ssl&quot;, &quot;socks&quot;];</span>
<a href="#l25.61"></a><span id="l25.61">       for (var i = 0; i &lt; proxyPrefs.length; ++i) {</span>
<a href="#l25.62"></a><span id="l25.62" class="difflineminus">-        var proxyServerURLPref = document.getElementById(&quot;network.proxy.&quot; + proxyPrefs[i]);</span>
<a href="#l25.63"></a><span id="l25.63" class="difflineminus">-        var proxyPortPref = document.getElementById(&quot;network.proxy.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.64"></a><span id="l25.64" class="difflineminus">-        var backupServerURLPref = document.getElementById(&quot;network.proxy.backup.&quot; + proxyPrefs[i]);</span>
<a href="#l25.65"></a><span id="l25.65" class="difflineminus">-        var backupPortPref = document.getElementById(&quot;network.proxy.backup.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.66"></a><span id="l25.66" class="difflineplus">+        var proxyServerURLPref = Preferences.get(&quot;network.proxy.&quot; + proxyPrefs[i]);</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineplus">+        var proxyPortPref = Preferences.get(&quot;network.proxy.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.68"></a><span id="l25.68" class="difflineplus">+        var backupServerURLPref = Preferences.get(&quot;network.proxy.backup.&quot; + proxyPrefs[i]);</span>
<a href="#l25.69"></a><span id="l25.69" class="difflineplus">+        var backupPortPref = Preferences.get(&quot;network.proxy.backup.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.70"></a><span id="l25.70">         backupServerURLPref.value = proxyServerURLPref.value;</span>
<a href="#l25.71"></a><span id="l25.71">         backupPortPref.value = proxyPortPref.value;</span>
<a href="#l25.72"></a><span id="l25.72">         proxyServerURLPref.value = httpProxyURLPref.value;</span>
<a href="#l25.73"></a><span id="l25.73">         proxyPortPref.value = httpProxyPortPref.value;</span>
<a href="#l25.74"></a><span id="l25.74">       }</span>
<a href="#l25.75"></a><span id="l25.75">     }</span>
<a href="#l25.76"></a><span id="l25.76"> </span>
<a href="#l25.77"></a><span id="l25.77" class="difflineminus">-    var noProxiesPref = document.getElementById(&quot;network.proxy.no_proxies_on&quot;);</span>
<a href="#l25.78"></a><span id="l25.78" class="difflineplus">+    var noProxiesPref = Preferences.get(&quot;network.proxy.no_proxies_on&quot;);</span>
<a href="#l25.79"></a><span id="l25.79">     noProxiesPref.value = noProxiesPref.value.replace(/[;]/g, &quot;,&quot;);</span>
<a href="#l25.80"></a><span id="l25.80"> </span>
<a href="#l25.81"></a><span id="l25.81">     return true;</span>
<a href="#l25.82"></a><span id="l25.82">   },</span>
<a href="#l25.83"></a><span id="l25.83"> </span>
<a href="#l25.84"></a><span id="l25.84">   checkForSystemProxy() {</span>
<a href="#l25.85"></a><span id="l25.85">     if (&quot;@mozilla.org/system-proxy-settings;1&quot; in Cc)</span>
<a href="#l25.86"></a><span id="l25.86">       document.getElementById(&quot;systemPref&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l25.87"></a><span id="l25.87">   },</span>
<a href="#l25.88"></a><span id="l25.88"> </span>
<a href="#l25.89"></a><span id="l25.89">   proxyTypeChanged() {</span>
<a href="#l25.90"></a><span id="l25.90" class="difflineminus">-    var proxyTypePref = document.getElementById(&quot;network.proxy.type&quot;);</span>
<a href="#l25.91"></a><span id="l25.91" class="difflineplus">+    var proxyTypePref = Preferences.get(&quot;network.proxy.type&quot;);</span>
<a href="#l25.92"></a><span id="l25.92"> </span>
<a href="#l25.93"></a><span id="l25.93">     // Update http</span>
<a href="#l25.94"></a><span id="l25.94" class="difflineminus">-    var httpProxyURLPref = document.getElementById(&quot;network.proxy.http&quot;);</span>
<a href="#l25.95"></a><span id="l25.95" class="difflineplus">+    var httpProxyURLPref = Preferences.get(&quot;network.proxy.http&quot;);</span>
<a href="#l25.96"></a><span id="l25.96">     httpProxyURLPref.disabled = proxyTypePref.value != 1;</span>
<a href="#l25.97"></a><span id="l25.97" class="difflineminus">-    var httpProxyPortPref = document.getElementById(&quot;network.proxy.http_port&quot;);</span>
<a href="#l25.98"></a><span id="l25.98" class="difflineplus">+    var httpProxyPortPref = Preferences.get(&quot;network.proxy.http_port&quot;);</span>
<a href="#l25.99"></a><span id="l25.99">     httpProxyPortPref.disabled = proxyTypePref.value != 1;</span>
<a href="#l25.100"></a><span id="l25.100"> </span>
<a href="#l25.101"></a><span id="l25.101">     // Now update the other protocols</span>
<a href="#l25.102"></a><span id="l25.102" class="difflineminus">-    this.updateProtocolPrefs();</span>
<a href="#l25.103"></a><span id="l25.103" class="difflineplus">+    gConnectionsDialog.updateProtocolPrefs();</span>
<a href="#l25.104"></a><span id="l25.104"> </span>
<a href="#l25.105"></a><span id="l25.105" class="difflineminus">-    var shareProxiesPref = document.getElementById(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.106"></a><span id="l25.106" class="difflineplus">+    var shareProxiesPref = Preferences.get(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.107"></a><span id="l25.107">     shareProxiesPref.disabled = proxyTypePref.value != 1;</span>
<a href="#l25.108"></a><span id="l25.108"> </span>
<a href="#l25.109"></a><span id="l25.109" class="difflineminus">-    var autologinProxyPref = document.getElementById(&quot;signon.autologin.proxy&quot;);</span>
<a href="#l25.110"></a><span id="l25.110" class="difflineplus">+    var autologinProxyPref = Preferences.get(&quot;signon.autologin.proxy&quot;);</span>
<a href="#l25.111"></a><span id="l25.111">     autologinProxyPref.disabled = proxyTypePref.value == 0;</span>
<a href="#l25.112"></a><span id="l25.112"> </span>
<a href="#l25.113"></a><span id="l25.113" class="difflineminus">-    var noProxiesPref = document.getElementById(&quot;network.proxy.no_proxies_on&quot;);</span>
<a href="#l25.114"></a><span id="l25.114" class="difflineplus">+    var noProxiesPref = Preferences.get(&quot;network.proxy.no_proxies_on&quot;);</span>
<a href="#l25.115"></a><span id="l25.115">     noProxiesPref.disabled = proxyTypePref.value == 0;</span>
<a href="#l25.116"></a><span id="l25.116"> </span>
<a href="#l25.117"></a><span id="l25.117" class="difflineminus">-    var autoconfigURLPref = document.getElementById(&quot;network.proxy.autoconfig_url&quot;);</span>
<a href="#l25.118"></a><span id="l25.118" class="difflineplus">+    var autoconfigURLPref = Preferences.get(&quot;network.proxy.autoconfig_url&quot;);</span>
<a href="#l25.119"></a><span id="l25.119">     autoconfigURLPref.disabled = proxyTypePref.value != 2;</span>
<a href="#l25.120"></a><span id="l25.120"> </span>
<a href="#l25.121"></a><span id="l25.121" class="difflineminus">-    this.updateReloadButton();</span>
<a href="#l25.122"></a><span id="l25.122" class="difflineplus">+    gConnectionsDialog.updateReloadButton();</span>
<a href="#l25.123"></a><span id="l25.123">   },</span>
<a href="#l25.124"></a><span id="l25.124"> </span>
<a href="#l25.125"></a><span id="l25.125">   updateDNSPref() {</span>
<a href="#l25.126"></a><span id="l25.126" class="difflineminus">-    var socksVersionPref = document.getElementById(&quot;network.proxy.socks_version&quot;);</span>
<a href="#l25.127"></a><span id="l25.127" class="difflineminus">-    var socksDNSPref = document.getElementById(&quot;network.proxy.socks_remote_dns&quot;);</span>
<a href="#l25.128"></a><span id="l25.128" class="difflineminus">-    var proxyTypePref = document.getElementById(&quot;network.proxy.type&quot;);</span>
<a href="#l25.129"></a><span id="l25.129" class="difflineplus">+    var socksVersionPref = Preferences.get(&quot;network.proxy.socks_version&quot;);</span>
<a href="#l25.130"></a><span id="l25.130" class="difflineplus">+    var socksDNSPref = Preferences.get(&quot;network.proxy.socks_remote_dns&quot;);</span>
<a href="#l25.131"></a><span id="l25.131" class="difflineplus">+    var proxyTypePref = Preferences.get(&quot;network.proxy.type&quot;);</span>
<a href="#l25.132"></a><span id="l25.132">     var isDefinitelySocks4 = !socksVersionPref.disabled &amp;&amp; socksVersionPref.value == 4;</span>
<a href="#l25.133"></a><span id="l25.133">     socksDNSPref.disabled = (isDefinitelySocks4 || proxyTypePref.value == 0);</span>
<a href="#l25.134"></a><span id="l25.134">     return undefined;</span>
<a href="#l25.135"></a><span id="l25.135">   },</span>
<a href="#l25.136"></a><span id="l25.136"> </span>
<a href="#l25.137"></a><span id="l25.137">   updateReloadButton() {</span>
<a href="#l25.138"></a><span id="l25.138">     // Disable the &quot;Reload PAC&quot; button if the selected proxy type is not PAC or</span>
<a href="#l25.139"></a><span id="l25.139">     // if the current value of the PAC textbox does not match the value stored</span>
<a href="#l25.140"></a><span id="l25.140">     // in prefs.  Likewise, disable the reload button if PAC is not configured</span>
<a href="#l25.141"></a><span id="l25.141">     // in prefs.</span>
<a href="#l25.142"></a><span id="l25.142"> </span>
<a href="#l25.143"></a><span id="l25.143">     var typedURL = document.getElementById(&quot;networkProxyAutoconfigURL&quot;).value;</span>
<a href="#l25.144"></a><span id="l25.144" class="difflineminus">-    var proxyTypeCur = document.getElementById(&quot;network.proxy.type&quot;).value;</span>
<a href="#l25.145"></a><span id="l25.145" class="difflineplus">+    var proxyTypeCur = Preferences.get(&quot;network.proxy.type&quot;).value;</span>
<a href="#l25.146"></a><span id="l25.146"> </span>
<a href="#l25.147"></a><span id="l25.147">     var pacURL = Services.prefs.getCharPref(&quot;network.proxy.autoconfig_url&quot;);</span>
<a href="#l25.148"></a><span id="l25.148">     var proxyType = Services.prefs.getIntPref(&quot;network.proxy.type&quot;);</span>
<a href="#l25.149"></a><span id="l25.149"> </span>
<a href="#l25.150"></a><span id="l25.150">     var disableReloadPref =</span>
<a href="#l25.151"></a><span id="l25.151" class="difflineminus">-        document.getElementById(&quot;pref.advanced.proxies.disable_button.reload&quot;);</span>
<a href="#l25.152"></a><span id="l25.152" class="difflineplus">+        Preferences.get(&quot;pref.advanced.proxies.disable_button.reload&quot;);</span>
<a href="#l25.153"></a><span id="l25.153">     disableReloadPref.disabled =</span>
<a href="#l25.154"></a><span id="l25.154">         (proxyTypeCur != 2 || proxyType != 2 || typedURL != pacURL);</span>
<a href="#l25.155"></a><span id="l25.155">   },</span>
<a href="#l25.156"></a><span id="l25.156"> </span>
<a href="#l25.157"></a><span id="l25.157">   readProxyType() {</span>
<a href="#l25.158"></a><span id="l25.158">     this.proxyTypeChanged();</span>
<a href="#l25.159"></a><span id="l25.159">     return undefined;</span>
<a href="#l25.160"></a><span id="l25.160">   },</span>
<a href="#l25.161"></a><span id="l25.161"> </span>
<a href="#l25.162"></a><span id="l25.162">   updateProtocolPrefs() {</span>
<a href="#l25.163"></a><span id="l25.163" class="difflineminus">-    var proxyTypePref = document.getElementById(&quot;network.proxy.type&quot;);</span>
<a href="#l25.164"></a><span id="l25.164" class="difflineminus">-    var shareProxiesPref = document.getElementById(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.165"></a><span id="l25.165" class="difflineplus">+    var proxyTypePref = Preferences.get(&quot;network.proxy.type&quot;);</span>
<a href="#l25.166"></a><span id="l25.166" class="difflineplus">+    var shareProxiesPref = Preferences.get(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.167"></a><span id="l25.167">     var proxyPrefs = [&quot;ssl&quot;, &quot;socks&quot;];</span>
<a href="#l25.168"></a><span id="l25.168">     for (var i = 0; i &lt; proxyPrefs.length; ++i) {</span>
<a href="#l25.169"></a><span id="l25.169" class="difflineminus">-      var proxyServerURLPref = document.getElementById(&quot;network.proxy.&quot; + proxyPrefs[i]);</span>
<a href="#l25.170"></a><span id="l25.170" class="difflineminus">-      var proxyPortPref = document.getElementById(&quot;network.proxy.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.171"></a><span id="l25.171" class="difflineplus">+      var proxyServerURLPref = Preferences.get(&quot;network.proxy.&quot; + proxyPrefs[i]);</span>
<a href="#l25.172"></a><span id="l25.172" class="difflineplus">+      var proxyPortPref = Preferences.get(&quot;network.proxy.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.173"></a><span id="l25.173"> </span>
<a href="#l25.174"></a><span id="l25.174">       // Restore previous per-proxy custom settings, if present.</span>
<a href="#l25.175"></a><span id="l25.175">       if (!shareProxiesPref.value) {</span>
<a href="#l25.176"></a><span id="l25.176" class="difflineminus">-        var backupServerURLPref = document.getElementById(&quot;network.proxy.backup.&quot; + proxyPrefs[i]);</span>
<a href="#l25.177"></a><span id="l25.177" class="difflineminus">-        var backupPortPref = document.getElementById(&quot;network.proxy.backup.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.178"></a><span id="l25.178" class="difflineplus">+        var backupServerURLPref = Preferences.get(&quot;network.proxy.backup.&quot; + proxyPrefs[i]);</span>
<a href="#l25.179"></a><span id="l25.179" class="difflineplus">+        var backupPortPref = Preferences.get(&quot;network.proxy.backup.&quot; + proxyPrefs[i] + &quot;_port&quot;);</span>
<a href="#l25.180"></a><span id="l25.180">         if (backupServerURLPref.hasUserValue) {</span>
<a href="#l25.181"></a><span id="l25.181">           proxyServerURLPref.value = backupServerURLPref.value;</span>
<a href="#l25.182"></a><span id="l25.182">           backupServerURLPref.reset();</span>
<a href="#l25.183"></a><span id="l25.183">         }</span>
<a href="#l25.184"></a><span id="l25.184">         if (backupPortPref.hasUserValue) {</span>
<a href="#l25.185"></a><span id="l25.185">           proxyPortPref.value = backupPortPref.value;</span>
<a href="#l25.186"></a><span id="l25.186">           backupPortPref.reset();</span>
<a href="#l25.187"></a><span id="l25.187">         }</span>
<a href="#l25.188"></a><span id="l25.188">       }</span>
<a href="#l25.189"></a><span id="l25.189"> </span>
<a href="#l25.190"></a><span id="l25.190">       proxyServerURLPref.updateElements();</span>
<a href="#l25.191"></a><span id="l25.191">       proxyPortPref.updateElements();</span>
<a href="#l25.192"></a><span id="l25.192">       proxyServerURLPref.disabled = proxyTypePref.value != 1 || shareProxiesPref.value;</span>
<a href="#l25.193"></a><span id="l25.193">       proxyPortPref.disabled = proxyServerURLPref.disabled;</span>
<a href="#l25.194"></a><span id="l25.194">     }</span>
<a href="#l25.195"></a><span id="l25.195" class="difflineminus">-    var socksVersionPref = document.getElementById(&quot;network.proxy.socks_version&quot;);</span>
<a href="#l25.196"></a><span id="l25.196" class="difflineplus">+    var socksVersionPref = Preferences.get(&quot;network.proxy.socks_version&quot;);</span>
<a href="#l25.197"></a><span id="l25.197">     socksVersionPref.disabled = proxyTypePref.value != 1 || shareProxiesPref.value;</span>
<a href="#l25.198"></a><span id="l25.198">     this.updateDNSPref();</span>
<a href="#l25.199"></a><span id="l25.199">     return undefined;</span>
<a href="#l25.200"></a><span id="l25.200">   },</span>
<a href="#l25.201"></a><span id="l25.201"> </span>
<a href="#l25.202"></a><span id="l25.202">   readProxyProtocolPref(aProtocol, aIsPort) {</span>
<a href="#l25.203"></a><span id="l25.203" class="difflineminus">-    var shareProxiesPref = document.getElementById(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.204"></a><span id="l25.204" class="difflineplus">+    var shareProxiesPref = Preferences.get(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.205"></a><span id="l25.205">     if (shareProxiesPref.value) {</span>
<a href="#l25.206"></a><span id="l25.206" class="difflineminus">-      var pref = document.getElementById(&quot;network.proxy.http&quot; + (aIsPort ? &quot;_port&quot; : &quot;&quot;));</span>
<a href="#l25.207"></a><span id="l25.207" class="difflineplus">+      var pref = Preferences.get(&quot;network.proxy.http&quot; + (aIsPort ? &quot;_port&quot; : &quot;&quot;));</span>
<a href="#l25.208"></a><span id="l25.208">       return pref.value;</span>
<a href="#l25.209"></a><span id="l25.209">     }</span>
<a href="#l25.210"></a><span id="l25.210"> </span>
<a href="#l25.211"></a><span id="l25.211" class="difflineminus">-    var backupPref = document.getElementById(&quot;network.proxy.backup.&quot; + aProtocol + (aIsPort ? &quot;_port&quot; : &quot;&quot;));</span>
<a href="#l25.212"></a><span id="l25.212" class="difflineplus">+    var backupPref = Preferences.get(&quot;network.proxy.backup.&quot; + aProtocol + (aIsPort ? &quot;_port&quot; : &quot;&quot;));</span>
<a href="#l25.213"></a><span id="l25.213">     return backupPref.hasUserValue ? backupPref.value : undefined;</span>
<a href="#l25.214"></a><span id="l25.214">   },</span>
<a href="#l25.215"></a><span id="l25.215"> </span>
<a href="#l25.216"></a><span id="l25.216">   reloadPAC() {</span>
<a href="#l25.217"></a><span id="l25.217">     Cc[&quot;@mozilla.org/network/protocol-proxy-service;1&quot;].</span>
<a href="#l25.218"></a><span id="l25.218">         getService().reloadPAC();</span>
<a href="#l25.219"></a><span id="l25.219">   },</span>
<a href="#l25.220"></a><span id="l25.220"> </span>
<a href="#l25.221"></a><span id="l25.221">   doAutoconfigURLFixup() {</span>
<a href="#l25.222"></a><span id="l25.222">     var autoURL = document.getElementById(&quot;networkProxyAutoconfigURL&quot;);</span>
<a href="#l25.223"></a><span id="l25.223" class="difflineminus">-    var autoURLPref = document.getElementById(&quot;network.proxy.autoconfig_url&quot;);</span>
<a href="#l25.224"></a><span id="l25.224" class="difflineplus">+    var autoURLPref = Preferences.get(&quot;network.proxy.autoconfig_url&quot;);</span>
<a href="#l25.225"></a><span id="l25.225">     try {</span>
<a href="#l25.226"></a><span id="l25.226">       autoURLPref.value = autoURL.value = Services.uriFixup.createFixupURI(autoURL.value, 0).spec;</span>
<a href="#l25.227"></a><span id="l25.227">     } catch (ex) {}</span>
<a href="#l25.228"></a><span id="l25.228">   },</span>
<a href="#l25.229"></a><span id="l25.229"> </span>
<a href="#l25.230"></a><span id="l25.230">   readHTTPProxyServer() {</span>
<a href="#l25.231"></a><span id="l25.231" class="difflineminus">-    var shareProxiesPref = document.getElementById(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.232"></a><span id="l25.232" class="difflineplus">+    var shareProxiesPref = Preferences.get(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.233"></a><span id="l25.233">     if (shareProxiesPref.value)</span>
<a href="#l25.234"></a><span id="l25.234">       this.updateProtocolPrefs();</span>
<a href="#l25.235"></a><span id="l25.235">     return undefined;</span>
<a href="#l25.236"></a><span id="l25.236">   },</span>
<a href="#l25.237"></a><span id="l25.237"> </span>
<a href="#l25.238"></a><span id="l25.238">   readHTTPProxyPort() {</span>
<a href="#l25.239"></a><span id="l25.239" class="difflineminus">-    var shareProxiesPref = document.getElementById(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.240"></a><span id="l25.240" class="difflineplus">+    var shareProxiesPref = Preferences.get(&quot;network.proxy.share_proxy_settings&quot;);</span>
<a href="#l25.241"></a><span id="l25.241">     if (shareProxiesPref.value)</span>
<a href="#l25.242"></a><span id="l25.242">       this.updateProtocolPrefs();</span>
<a href="#l25.243"></a><span id="l25.243">     return undefined;</span>
<a href="#l25.244"></a><span id="l25.244">   },</span>
<a href="#l25.245"></a><span id="l25.245"> </span>
<a href="#l25.246"></a><span id="l25.246">   isDnsOverHttpsEnabled() {</span>
<a href="#l25.247"></a><span id="l25.247">     // values outside 1:4 are considered falsey/disabled in this context</span>
<a href="#l25.248"></a><span id="l25.248" class="difflineminus">-    let trrPref = document.getElementById(&quot;network.trr.mode&quot;);</span>
<a href="#l25.249"></a><span id="l25.249" class="difflineplus">+    let trrPref = Preferences.get(&quot;network.trr.mode&quot;);</span>
<a href="#l25.250"></a><span id="l25.250">     let enabled = trrPref.value &gt; 0 &amp;&amp; trrPref.value &lt; 5;</span>
<a href="#l25.251"></a><span id="l25.251">     return enabled;</span>
<a href="#l25.252"></a><span id="l25.252">   },</span>
<a href="#l25.253"></a><span id="l25.253"> </span>
<a href="#l25.254"></a><span id="l25.254">   readDnsOverHttpsMode() {</span>
<a href="#l25.255"></a><span id="l25.255">     // called to update checked element property to reflect current pref value</span>
<a href="#l25.256"></a><span id="l25.256">     let enabled = this.isDnsOverHttpsEnabled();</span>
<a href="#l25.257"></a><span id="l25.257" class="difflineminus">-    let uriPref = document.getElementById(&quot;network.trr.uri&quot;);</span>
<a href="#l25.258"></a><span id="l25.258" class="difflineplus">+    let uriPref = Preferences.get(&quot;network.trr.uri&quot;);</span>
<a href="#l25.259"></a><span id="l25.259">     uriPref.disabled = !enabled;</span>
<a href="#l25.260"></a><span id="l25.260">     return enabled;</span>
<a href="#l25.261"></a><span id="l25.261">   },</span>
<a href="#l25.262"></a><span id="l25.262"> </span>
<a href="#l25.263"></a><span id="l25.263">   writeDnsOverHttpsMode() {</span>
<a href="#l25.264"></a><span id="l25.264">     // called to update pref with user change</span>
<a href="#l25.265"></a><span id="l25.265">     let trrModeCheckbox = document.getElementById(&quot;networkDnsOverHttps&quot;);</span>
<a href="#l25.266"></a><span id="l25.266">     // we treat checked/enabled as mode 2</span>
<a href="#l25.267"></a><span id="l25.267" class="difflineat">@@ -208,16 +234,18 @@ var gConnectionsDialog = {</span>
<a href="#l25.268"></a><span id="l25.268">     let customDnsOverHttpsUrlRadio = document.getElementById(&quot;customDnsOverHttpsUrlRadio&quot;);</span>
<a href="#l25.269"></a><span id="l25.269">     let customDnsOverHttpsInput = document.getElementById(&quot;customDnsOverHttpsInput&quot;);</span>
<a href="#l25.270"></a><span id="l25.270">     customDnsOverHttpsInput.disabled = !parentCheckbox.checked || !customDnsOverHttpsUrlRadio.selected;</span>
<a href="#l25.271"></a><span id="l25.271">     customDnsOverHttpsUrlRadio.disabled = !parentCheckbox.checked;</span>
<a href="#l25.272"></a><span id="l25.272">   },</span>
<a href="#l25.273"></a><span id="l25.273"> </span>
<a href="#l25.274"></a><span id="l25.274">   initDnsOverHttpsUI() {</span>
<a href="#l25.275"></a><span id="l25.275">     let defaultDnsOverHttpsUrlRadio = document.getElementById(&quot;defaultDnsOverHttpsUrlRadio&quot;);</span>
<a href="#l25.276"></a><span id="l25.276" class="difflineminus">-    let defaultPrefUrl = document.getElementById(&quot;network.trr.uri&quot;).defaultValue;</span>
<a href="#l25.277"></a><span id="l25.277" class="difflineplus">+    let defaultPrefUrl = Preferences.get(&quot;network.trr.uri&quot;).defaultValue;</span>
<a href="#l25.278"></a><span id="l25.278">     document.getElementById(&quot;defaultDnsOverHttpsUrlLabel&quot;).setAttribute(&quot;value&quot;, &quot;(&quot; + defaultPrefUrl + &quot;)&quot;);</span>
<a href="#l25.279"></a><span id="l25.279">     defaultDnsOverHttpsUrlRadio.value = defaultPrefUrl;</span>
<a href="#l25.280"></a><span id="l25.280">     let radioGroup = document.getElementById(&quot;DnsOverHttpsUrlRadioGroup&quot;);</span>
<a href="#l25.281"></a><span id="l25.281" class="difflineminus">-    radioGroup.selectedIndex = document.getElementById(&quot;network.trr.uri&quot;).hasUserValue ? 1 : 0;</span>
<a href="#l25.282"></a><span id="l25.282" class="difflineplus">+    radioGroup.selectedIndex = Preferences.get(&quot;network.trr.uri&quot;).hasUserValue ? 1 : 0;</span>
<a href="#l25.283"></a><span id="l25.283">     this.updateDnsOverHttpsUI();</span>
<a href="#l25.284"></a><span id="l25.284">   },</span>
<a href="#l25.285"></a><span id="l25.285"> };</span>
<a href="#l25.286"></a><span id="l25.286" class="difflineplus">+</span>
<a href="#l25.287"></a><span id="l25.287" class="difflineplus">+Preferences.get(&quot;network.proxy.type&quot;).on(&quot;change&quot;, gConnectionsDialog.proxyTypeChanged);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/components/preferences/connection.xul</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/components/preferences/connection.xul</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1,64 +1,35 @@</span>
<a href="#l26.4"></a><span id="l26.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l26.5"></a><span id="l26.5"> </span>
<a href="#l26.6"></a><span id="l26.6"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l26.7"></a><span id="l26.7">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.8"></a><span id="l26.8">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.9"></a><span id="l26.9">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l26.10"></a><span id="l26.10"> </span>
<a href="#l26.11"></a><span id="l26.11" class="difflineminus">-&lt;!DOCTYPE prefwindow SYSTEM &quot;chrome://messenger/locale/preferences/connection.dtd&quot;&gt;</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineplus">+&lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/preferences/connection.dtd&quot;&gt;</span>
<a href="#l26.13"></a><span id="l26.13"> </span>
<a href="#l26.14"></a><span id="l26.14"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l26.15"></a><span id="l26.15"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l26.16"></a><span id="l26.16"> </span>
<a href="#l26.17"></a><span id="l26.17" class="difflineminus">-&lt;prefwindow id=&quot;ConnectionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineminus">-            xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineminus">-            title=&quot;&amp;connectionsDialog.title;&quot;</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineminus">-            dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineminus">-            onbeforeaccept=&quot;return gConnectionsDialog.beforeAccept();&quot;</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineminus">-            onload=&quot;gConnectionsDialog.checkForSystemProxy(); gConnectionsDialog.initDnsOverHttpsUI();&quot;</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineplus">+&lt;dialog id=&quot;ConnectionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineplus">+        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineplus">+        title=&quot;&amp;connectionsDialog.title;&quot;</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineplus">+        dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineplus">+        onbeforeaccept=&quot;return gConnectionsDialog.beforeAccept();&quot;</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineplus">+        onload=&quot;gConnectionsDialog.checkForSystemProxy(); gConnectionsDialog.initDnsOverHttpsUI();&quot;</span>
<a href="#l26.31"></a><span id="l26.31"> #ifdef XP_MACOSX</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineminus">-            style=&quot;width: &amp;window.macWidth; !important;&quot;&gt;</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineplus">+        style=&quot;width: &amp;window.macWidth; !important;&quot;&gt;</span>
<a href="#l26.34"></a><span id="l26.34"> #else</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineminus">-            style=&quot;width: &amp;window.width; !important;&quot;&gt;</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineplus">+        style=&quot;width: &amp;window.width; !important;&quot;&gt;</span>
<a href="#l26.37"></a><span id="l26.37"> #endif</span>
<a href="#l26.38"></a><span id="l26.38"> </span>
<a href="#l26.39"></a><span id="l26.39">   &lt;prefpane id=&quot;ConnectionsDialogPane&quot;&gt;</span>
<a href="#l26.40"></a><span id="l26.40" class="difflineminus">-    &lt;preferences id=&quot;ConnectionPreferences&quot;&gt;</span>
<a href="#l26.41"></a><span id="l26.41" class="difflineminus">-      &lt;preference id=&quot;network.proxy.type&quot;         name=&quot;network.proxy.type&quot;         type=&quot;int&quot; onchange=&quot;gConnectionsDialog.proxyTypeChanged();&quot;/&gt;</span>
<a href="#l26.42"></a><span id="l26.42" class="difflineminus">-      &lt;preference id=&quot;network.proxy.http&quot;         name=&quot;network.proxy.http&quot;         type=&quot;string&quot;/&gt;</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineminus">-      &lt;preference id=&quot;network.proxy.http_port&quot;    name=&quot;network.proxy.http_port&quot;    type=&quot;int&quot;/&gt;</span>
<a href="#l26.44"></a><span id="l26.44" class="difflineminus">-      &lt;preference id=&quot;network.proxy.ssl&quot;          name=&quot;network.proxy.ssl&quot;          type=&quot;string&quot;/&gt;</span>
<a href="#l26.45"></a><span id="l26.45" class="difflineminus">-      &lt;preference id=&quot;network.proxy.ssl_port&quot;     name=&quot;network.proxy.ssl_port&quot;     type=&quot;int&quot;/&gt;</span>
<a href="#l26.46"></a><span id="l26.46" class="difflineminus">-      &lt;preference id=&quot;network.proxy.socks&quot;        name=&quot;network.proxy.socks&quot;        type=&quot;string&quot;/&gt;</span>
<a href="#l26.47"></a><span id="l26.47" class="difflineminus">-      &lt;preference id=&quot;network.proxy.socks_port&quot;   name=&quot;network.proxy.socks_port&quot;   type=&quot;int&quot;/&gt;</span>
<a href="#l26.48"></a><span id="l26.48" class="difflineminus">-      &lt;preference id=&quot;network.proxy.socks_version&quot;  name=&quot;network.proxy.socks_version&quot;  type=&quot;int&quot;/&gt;</span>
<a href="#l26.49"></a><span id="l26.49" class="difflineminus">-      &lt;preference id=&quot;network.proxy.no_proxies_on&quot;  name=&quot;network.proxy.no_proxies_on&quot;  type=&quot;string&quot;/&gt;</span>
<a href="#l26.50"></a><span id="l26.50" class="difflineminus">-      &lt;preference id=&quot;network.proxy.autoconfig_url&quot; name=&quot;network.proxy.autoconfig_url&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l26.51"></a><span id="l26.51" class="difflineminus">-      &lt;preference id=&quot;network.proxy.share_proxy_settings&quot;</span>
<a href="#l26.52"></a><span id="l26.52" class="difflineminus">-                  name=&quot;network.proxy.share_proxy_settings&quot;</span>
<a href="#l26.53"></a><span id="l26.53" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineminus">-</span>
<a href="#l26.55"></a><span id="l26.55" class="difflineminus">-      &lt;preference id=&quot;pref.advanced.proxies.disable_button.reload&quot;</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineminus">-                  name=&quot;pref.advanced.proxies.disable_button.reload&quot;</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l26.58"></a><span id="l26.58" class="difflineminus">-</span>
<a href="#l26.59"></a><span id="l26.59" class="difflineminus">-      &lt;preference id=&quot;network.proxy.backup.ssl&quot;          name=&quot;network.proxy.backup.ssl&quot;          type=&quot;string&quot;/&gt;</span>
<a href="#l26.60"></a><span id="l26.60" class="difflineminus">-      &lt;preference id=&quot;network.proxy.backup.ssl_port&quot;     name=&quot;network.proxy.backup.ssl_port&quot;     type=&quot;int&quot;/&gt;</span>
<a href="#l26.61"></a><span id="l26.61" class="difflineminus">-      &lt;preference id=&quot;network.proxy.backup.socks&quot;        name=&quot;network.proxy.backup.socks&quot;        type=&quot;string&quot;/&gt;</span>
<a href="#l26.62"></a><span id="l26.62" class="difflineminus">-      &lt;preference id=&quot;network.proxy.backup.socks_port&quot;   name=&quot;network.proxy.backup.socks_port&quot;   type=&quot;int&quot;/&gt;</span>
<a href="#l26.63"></a><span id="l26.63" class="difflineminus">-      &lt;preference id=&quot;network.proxy.socks_remote_dns&quot;    name=&quot;network.proxy.socks_remote_dns&quot;    type=&quot;bool&quot;/&gt;</span>
<a href="#l26.64"></a><span id="l26.64" class="difflineminus">-      &lt;preference id=&quot;network.trr.mode&quot;                  name=&quot;network.trr.mode&quot;                  type=&quot;int&quot;/&gt;</span>
<a href="#l26.65"></a><span id="l26.65" class="difflineminus">-      &lt;preference id=&quot;network.trr.uri&quot;                   name=&quot;network.trr.uri&quot;                   type=&quot;string&quot;/&gt;</span>
<a href="#l26.66"></a><span id="l26.66" class="difflineminus">-      &lt;preference id=&quot;network.trr.custom_uri&quot;            name=&quot;network.trr.custom_uri&quot;            type=&quot;string&quot;/&gt;</span>
<a href="#l26.67"></a><span id="l26.67" class="difflineminus">-      &lt;preference id=&quot;signon.autologin.proxy&quot;            name=&quot;signon.autologin.proxy&quot;            type=&quot;bool&quot;/&gt;</span>
<a href="#l26.68"></a><span id="l26.68" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l26.69"></a><span id="l26.69" class="difflineminus">-</span>
<a href="#l26.70"></a><span id="l26.70" class="difflineplus">+    &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l26.71"></a><span id="l26.71">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/connection.js&quot;/&gt;</span>
<a href="#l26.72"></a><span id="l26.72"> </span>
<a href="#l26.73"></a><span id="l26.73">     &lt;groupbox&gt;</span>
<a href="#l26.74"></a><span id="l26.74">       &lt;label&gt;&lt;html:h2&gt;&amp;proxyTitle.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l26.75"></a><span id="l26.75"> </span>
<a href="#l26.76"></a><span id="l26.76">       &lt;radiogroup id=&quot;networkProxyType&quot; preference=&quot;network.proxy.type&quot;</span>
<a href="#l26.77"></a><span id="l26.77">                   onsyncfrompreference=&quot;return gConnectionsDialog.readProxyType();&quot;&gt;</span>
<a href="#l26.78"></a><span id="l26.78">         &lt;radio value=&quot;0&quot; label=&quot;&amp;noProxyTypeRadio.label;&quot; accesskey=&quot;&amp;noProxyTypeRadio.accesskey;&quot;/&gt;</span>
<a href="#l26.79"></a><span id="l26.79" class="difflineat">@@ -185,9 +156,9 @@</span>
<a href="#l26.80"></a><span id="l26.80">           &lt;textbox id=&quot;customDnsOverHttpsInput&quot;</span>
<a href="#l26.81"></a><span id="l26.81">                    flex=&quot;1&quot;</span>
<a href="#l26.82"></a><span id="l26.82">                    preference=&quot;network.trr.custom_uri&quot;/&gt;</span>
<a href="#l26.83"></a><span id="l26.83">         &lt;/hbox&gt;</span>
<a href="#l26.84"></a><span id="l26.84">       &lt;/radiogroup&gt;</span>
<a href="#l26.85"></a><span id="l26.85">     &lt;/vbox&gt;</span>
<a href="#l26.86"></a><span id="l26.86">     &lt;separator/&gt;</span>
<a href="#l26.87"></a><span id="l26.87">   &lt;/prefpane&gt;</span>
<a href="#l26.88"></a><span id="l26.88" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l26.89"></a><span id="l26.89" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/components/preferences/display.inc.xul</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/components/preferences/display.inc.xul</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -2,52 +2,16 @@</span>
<a href="#l27.4"></a><span id="l27.4"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.5"></a><span id="l27.5"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l27.6"></a><span id="l27.6">   &lt;prefpane id=&quot;paneDisplay&quot; label=&quot;&amp;paneDisplay.title;&quot;&gt;</span>
<a href="#l27.7"></a><span id="l27.7">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l27.8"></a><span id="l27.8">             src=&quot;chrome://mozapps/content/preferences/fontbuilder.js&quot;/&gt;</span>
<a href="#l27.9"></a><span id="l27.9">     &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l27.10"></a><span id="l27.10">             src=&quot;chrome://messenger/content/preferences/display.js&quot;/&gt;</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    &lt;preferences id=&quot;displayPreferences&quot;&gt;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-      &lt;preference id=&quot;mail.preferences.display.selectedTabIndex&quot; name=&quot;mail.preferences.display.selectedTabIndex&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-      &lt;preference id=&quot;mail.fixed_width_messages&quot; name=&quot;mail.fixed_width_messages&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineminus">-      &lt;preference id=&quot;mail.quoted_style&quot; name=&quot;mail.quoted_style&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineminus">-      &lt;preference id=&quot;mail.quoted_size&quot; name=&quot;mail.quoted_size&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineminus">-      &lt;preference id=&quot;mail.citation_color&quot; name=&quot;mail.citation_color&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-      &lt;preference id=&quot;mail.display_glyph&quot; name=&quot;mail.display_glyph&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.description.1&quot; name=&quot;mailnews.labels.description.1&quot; type=&quot;wstring&quot;/&gt;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.color.1&quot; name=&quot;mailnews.labels.color.1&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.description.2&quot; name=&quot;mailnews.labels.description.2&quot; type=&quot;wstring&quot;/&gt;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.color.2&quot; name=&quot;mailnews.labels.color.2&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.description.3&quot; name=&quot;mailnews.labels.description.3&quot; type=&quot;wstring&quot;/&gt;</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.color.3&quot; name=&quot;mailnews.labels.color.3&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.description.4&quot; name=&quot;mailnews.labels.description.4&quot; type=&quot;wstring&quot;/&gt;</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.color.4&quot; name=&quot;mailnews.labels.color.4&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.description.5&quot; name=&quot;mailnews.labels.description.5&quot; type=&quot;wstring&quot;/&gt;</span>
<a href="#l27.28"></a><span id="l27.28" class="difflineminus">-      &lt;preference id=&quot;mailnews.labels.color.5&quot; name=&quot;mailnews.labels.color.5&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l27.29"></a><span id="l27.29" class="difflineminus">-</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineminus">-      &lt;!-- FONTS --&gt;</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineminus">-      &lt;preference id=&quot;font.language.group&quot; name=&quot;font.language.group&quot;</span>
<a href="#l27.32"></a><span id="l27.32" class="difflineminus">-                  type=&quot;wstring&quot; onchange=&quot;gDisplayPane._rebuildFonts();&quot;/&gt;</span>
<a href="#l27.33"></a><span id="l27.33" class="difflineminus">-</span>
<a href="#l27.34"></a><span id="l27.34" class="difflineminus">-      &lt;!-- Advanced --&gt;</span>
<a href="#l27.35"></a><span id="l27.35" class="difflineminus">-      &lt;preference id=&quot;mail.showCondensedAddresses&quot; name=&quot;mail.showCondensedAddresses&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l27.36"></a><span id="l27.36" class="difflineminus">-      &lt;preference id=&quot;mailnews.mark_message_read.auto&quot;</span>
<a href="#l27.37"></a><span id="l27.37" class="difflineminus">-                  name=&quot;mailnews.mark_message_read.auto&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l27.38"></a><span id="l27.38" class="difflineminus">-      &lt;preference id=&quot;mailnews.mark_message_read.delay&quot;</span>
<a href="#l27.39"></a><span id="l27.39" class="difflineminus">-                  name=&quot;mailnews.mark_message_read.delay&quot; type=&quot;bool&quot;</span>
<a href="#l27.40"></a><span id="l27.40" class="difflineminus">-                  onchange=&quot;gDisplayPane.updateMarkAsReadTextbox(this.value);&quot;/&gt;</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineminus">-      &lt;preference id=&quot;mailnews.mark_message_read.delay.interval&quot;</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineminus">-                  name=&quot;mailnews.mark_message_read.delay.interval&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l27.43"></a><span id="l27.43" class="difflineminus">-      &lt;preference id=&quot;mail.openMessageBehavior&quot; name=&quot;mail.openMessageBehavior&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l27.44"></a><span id="l27.44" class="difflineminus">-      &lt;preference id=&quot;mail.close_message_window.on_delete&quot;</span>
<a href="#l27.45"></a><span id="l27.45" class="difflineminus">-                  name=&quot;mail.close_message_window.on_delete&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l27.46"></a><span id="l27.46" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l27.47"></a><span id="l27.47" class="difflineminus">-</span>
<a href="#l27.48"></a><span id="l27.48">     &lt;tabbox id=&quot;displayPrefs&quot; flex=&quot;1&quot; onselect=&quot;gDisplayPane.tabSelectionChanged();&quot;&gt;</span>
<a href="#l27.49"></a><span id="l27.49">       &lt;tabs id=&quot;displayPrefsTabs&quot;&gt;</span>
<a href="#l27.50"></a><span id="l27.50">         &lt;tab id=&quot;formattingTab&quot; label=&quot;&amp;itemFormatting.label;&quot;/&gt;</span>
<a href="#l27.51"></a><span id="l27.51">         &lt;tab id=&quot;tagTab&quot; label=&quot;&amp;itemTags.label;&quot;/&gt;</span>
<a href="#l27.52"></a><span id="l27.52">         &lt;tab id=&quot;displayTab&quot; label=&quot;&amp;itemAdvanced.label;&quot;/&gt;</span>
<a href="#l27.53"></a><span id="l27.53">       &lt;/tabs&gt;</span>
<a href="#l27.54"></a><span id="l27.54"> </span>
<a href="#l27.55"></a><span id="l27.55">       &lt;tabpanels id=&quot;displayPrefsPanels&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l27.56"></a><span id="l27.56" class="difflineat">@@ -186,18 +150,17 @@</span>
<a href="#l27.57"></a><span id="l27.57">           &lt;groupbox&gt;</span>
<a href="#l27.58"></a><span id="l27.58">             &lt;label&gt;&lt;html:h2&gt;&amp;reading.caption;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l27.59"></a><span id="l27.59"> </span>
<a href="#l27.60"></a><span id="l27.60">             &lt;vbox&gt;</span>
<a href="#l27.61"></a><span id="l27.61">               &lt;hbox&gt;</span>
<a href="#l27.62"></a><span id="l27.62">                 &lt;checkbox id=&quot;automaticallyMarkAsRead&quot;</span>
<a href="#l27.63"></a><span id="l27.63">                           preference=&quot;mailnews.mark_message_read.auto&quot;</span>
<a href="#l27.64"></a><span id="l27.64">                           label=&quot;&amp;autoMarkAsRead.label;&quot;</span>
<a href="#l27.65"></a><span id="l27.65" class="difflineminus">-                          accesskey=&quot;&amp;autoMarkAsRead.accesskey;&quot;</span>
<a href="#l27.66"></a><span id="l27.66" class="difflineminus">-                          oncommand=&quot;gDisplayPane.updateMarkAsReadOptions(this.checked)&quot;/&gt;</span>
<a href="#l27.67"></a><span id="l27.67" class="difflineplus">+                          accesskey=&quot;&amp;autoMarkAsRead.accesskey;&quot;/&gt;</span>
<a href="#l27.68"></a><span id="l27.68">               &lt;/hbox&gt;</span>
<a href="#l27.69"></a><span id="l27.69"> </span>
<a href="#l27.70"></a><span id="l27.70">               &lt;radiogroup id=&quot;markAsReadAutoPreferences&quot; orient=&quot;vertical&quot;</span>
<a href="#l27.71"></a><span id="l27.71">                           class=&quot;indent&quot;</span>
<a href="#l27.72"></a><span id="l27.72">                           align=&quot;start&quot;</span>
<a href="#l27.73"></a><span id="l27.73">                           preference=&quot;mailnews.mark_message_read.delay&quot;&gt;</span>
<a href="#l27.74"></a><span id="l27.74">                 &lt;radio id=&quot;mark_read_immediately&quot;</span>
<a href="#l27.75"></a><span id="l27.75">                        label=&quot;&amp;markAsReadNoDelay.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mail/components/preferences/display.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mail/components/preferences/display.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -5,60 +5,87 @@</span>
<a href="#l28.4"></a><span id="l28.4"> </span>
<a href="#l28.5"></a><span id="l28.5"> &quot;use strict&quot;;</span>
<a href="#l28.6"></a><span id="l28.6"> </span>
<a href="#l28.7"></a><span id="l28.7"> /* import-globals-from ../../../../toolkit/mozapps/preferences/fontbuilder.js */</span>
<a href="#l28.8"></a><span id="l28.8"> /* import-globals-from preferences.js */</span>
<a href="#l28.9"></a><span id="l28.9"> /* import-globals-from subdialogs.js */</span>
<a href="#l28.10"></a><span id="l28.10"> var {TagUtils} = ChromeUtils.import(&quot;resource:///modules/TagUtils.jsm&quot;);</span>
<a href="#l28.11"></a><span id="l28.11"> </span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+  { id: &quot;mail.preferences.display.selectedTabIndex&quot;, type: &quot;int&quot; },</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+  { id: &quot;mail.fixed_width_messages&quot;, type: &quot;bool&quot; },</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+  { id: &quot;mail.quoted_style&quot;, type: &quot;int&quot; },</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineplus">+  { id: &quot;mail.quoted_size&quot;, type: &quot;int&quot; },</span>
<a href="#l28.17"></a><span id="l28.17" class="difflineplus">+  { id: &quot;mail.citation_color&quot;, type: &quot;string&quot; },</span>
<a href="#l28.18"></a><span id="l28.18" class="difflineplus">+  { id: &quot;mail.display_glyph&quot;, type: &quot;bool&quot; },</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineplus">+  { id: &quot;mailnews.labels.description.1&quot;, type: &quot;wstring&quot; },</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineplus">+  { id: &quot;mailnews.labels.color.1&quot;, type: &quot;string&quot; },</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineplus">+  { id: &quot;mailnews.labels.description.2&quot;, type: &quot;wstring&quot; },</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineplus">+  { id: &quot;mailnews.labels.color.2&quot;, type: &quot;string&quot; },</span>
<a href="#l28.23"></a><span id="l28.23" class="difflineplus">+  { id: &quot;mailnews.labels.description.3&quot;, type: &quot;wstring&quot; },</span>
<a href="#l28.24"></a><span id="l28.24" class="difflineplus">+  { id: &quot;mailnews.labels.color.3&quot;, type: &quot;string&quot; },</span>
<a href="#l28.25"></a><span id="l28.25" class="difflineplus">+  { id: &quot;mailnews.labels.description.4&quot;, type: &quot;wstring&quot; },</span>
<a href="#l28.26"></a><span id="l28.26" class="difflineplus">+  { id: &quot;mailnews.labels.color.4&quot;, type: &quot;string&quot; },</span>
<a href="#l28.27"></a><span id="l28.27" class="difflineplus">+  { id: &quot;mailnews.labels.description.5&quot;, type: &quot;wstring&quot; },</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineplus">+  { id: &quot;mailnews.labels.color.5&quot;, type: &quot;string&quot; },</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineplus">+  { id: &quot;font.language.group&quot;, type: &quot;wstring&quot; },</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineplus">+  { id: &quot;mail.showCondensedAddresses&quot;, type: &quot;bool&quot; },</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+  { id: &quot;mailnews.mark_message_read.auto&quot;, type: &quot;bool&quot; },</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+  { id: &quot;mailnews.mark_message_read.delay&quot;, type: &quot;bool&quot; },</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineplus">+  { id: &quot;mailnews.mark_message_read.delay.interval&quot;, type: &quot;int&quot; },</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineplus">+  { id: &quot;mail.openMessageBehavior&quot;, type: &quot;int&quot; },</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineplus">+  { id: &quot;mail.close_message_window.on_delete&quot;, type: &quot;bool&quot; },</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+]);</span>
<a href="#l28.37"></a><span id="l28.37" class="difflineplus">+</span>
<a href="#l28.38"></a><span id="l28.38"> document.getElementById(&quot;paneDisplay&quot;)</span>
<a href="#l28.39"></a><span id="l28.39">         .addEventListener(&quot;paneload&quot;, function() { gDisplayPane.init(); });</span>
<a href="#l28.40"></a><span id="l28.40"> </span>
<a href="#l28.41"></a><span id="l28.41"> var gDisplayPane = {</span>
<a href="#l28.42"></a><span id="l28.42">   mInitialized: false,</span>
<a href="#l28.43"></a><span id="l28.43">   mTagListBox:  null,</span>
<a href="#l28.44"></a><span id="l28.44"> </span>
<a href="#l28.45"></a><span id="l28.45">   init() {</span>
<a href="#l28.46"></a><span id="l28.46">     if (!((&quot;arguments&quot; in window) &amp;&amp; window.arguments[1])) {</span>
<a href="#l28.47"></a><span id="l28.47">       // If no tab was specified, select the last used tab.</span>
<a href="#l28.48"></a><span id="l28.48" class="difflineminus">-      let preference = document.getElementById(&quot;mail.preferences.display.selectedTabIndex&quot;);</span>
<a href="#l28.49"></a><span id="l28.49" class="difflineplus">+      let preference = Preferences.get(&quot;mail.preferences.display.selectedTabIndex&quot;);</span>
<a href="#l28.50"></a><span id="l28.50">       if (preference.value)</span>
<a href="#l28.51"></a><span id="l28.51">         document.getElementById(&quot;displayPrefs&quot;).selectedIndex = preference.value;</span>
<a href="#l28.52"></a><span id="l28.52">     }</span>
<a href="#l28.53"></a><span id="l28.53">     this._rebuildFonts();</span>
<a href="#l28.54"></a><span id="l28.54" class="difflineminus">-    this.updateMarkAsReadOptions(document.getElementById(&quot;automaticallyMarkAsRead&quot;).checked);</span>
<a href="#l28.55"></a><span id="l28.55" class="difflineplus">+    this.updateMarkAsReadOptions();</span>
<a href="#l28.56"></a><span id="l28.56" class="difflineplus">+</span>
<a href="#l28.57"></a><span id="l28.57">     var menulist = document.getElementById(&quot;defaultFont&quot;);</span>
<a href="#l28.58"></a><span id="l28.58">     if (menulist.selectedIndex == -1) {</span>
<a href="#l28.59"></a><span id="l28.59">       // Prepend menuitem with empty name and value.</span>
<a href="#l28.60"></a><span id="l28.60">       let item = document.createElementNS(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;, &quot;menuitem&quot;);</span>
<a href="#l28.61"></a><span id="l28.61">       item.setAttribute(&quot;label&quot;, &quot;&quot;);</span>
<a href="#l28.62"></a><span id="l28.62">       item.setAttribute(&quot;value&quot;, &quot;&quot;);</span>
<a href="#l28.63"></a><span id="l28.63">       menulist.menupopup.insertBefore(item, menulist.menupopup.firstChild);</span>
<a href="#l28.64"></a><span id="l28.64">       menulist.selectedIndex = 0;</span>
<a href="#l28.65"></a><span id="l28.65">     }</span>
<a href="#l28.66"></a><span id="l28.66"> </span>
<a href="#l28.67"></a><span id="l28.67">     this.mInitialized = true;</span>
<a href="#l28.68"></a><span id="l28.68"> </span>
<a href="#l28.69"></a><span id="l28.69">     document.getElementById(&quot;citationmenu&quot;).value =</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineminus">-      document.getElementById(&quot;mail.citation_color&quot;).value;</span>
<a href="#l28.71"></a><span id="l28.71" class="difflineplus">+      Preferences.get(&quot;mail.citation_color&quot;).value;</span>
<a href="#l28.72"></a><span id="l28.72"> </span>
<a href="#l28.73"></a><span id="l28.73">     this.mTagListBox = document.getElementById(&quot;tagList&quot;);</span>
<a href="#l28.74"></a><span id="l28.74">     this.buildTagList();</span>
<a href="#l28.75"></a><span id="l28.75">   },</span>
<a href="#l28.76"></a><span id="l28.76"> </span>
<a href="#l28.77"></a><span id="l28.77">   // FONTS</span>
<a href="#l28.78"></a><span id="l28.78"> </span>
<a href="#l28.79"></a><span id="l28.79">   /**</span>
<a href="#l28.80"></a><span id="l28.80">    * Populates the default font list in UI.</span>
<a href="#l28.81"></a><span id="l28.81">    */</span>
<a href="#l28.82"></a><span id="l28.82">   _rebuildFonts() {</span>
<a href="#l28.83"></a><span id="l28.83" class="difflineminus">-    var langGroupPref = document.getElementById(&quot;font.language.group&quot;);</span>
<a href="#l28.84"></a><span id="l28.84" class="difflineminus">-    var isSerif = this._readDefaultFontTypeForLanguage(langGroupPref.value) == &quot;serif&quot;;</span>
<a href="#l28.85"></a><span id="l28.85" class="difflineminus">-    this._selectDefaultLanguageGroup(langGroupPref.value, isSerif);</span>
<a href="#l28.86"></a><span id="l28.86" class="difflineplus">+    var langGroupPref = Preferences.get(&quot;font.language.group&quot;);</span>
<a href="#l28.87"></a><span id="l28.87" class="difflineplus">+    var isSerif = gDisplayPane._readDefaultFontTypeForLanguage(langGroupPref.value) == &quot;serif&quot;;</span>
<a href="#l28.88"></a><span id="l28.88" class="difflineplus">+    gDisplayPane._selectDefaultLanguageGroup(langGroupPref.value, isSerif);</span>
<a href="#l28.89"></a><span id="l28.89">   },</span>
<a href="#l28.90"></a><span id="l28.90"> </span>
<a href="#l28.91"></a><span id="l28.91">   /**</span>
<a href="#l28.92"></a><span id="l28.92">    * Select the default language group.</span>
<a href="#l28.93"></a><span id="l28.93">    */</span>
<a href="#l28.94"></a><span id="l28.94">   _selectDefaultLanguageGroupPromise: Promise.resolve(),</span>
<a href="#l28.95"></a><span id="l28.95"> </span>
<a href="#l28.96"></a><span id="l28.96">   _selectDefaultLanguageGroup(aLanguageGroup, aIsSerif) {</span>
<a href="#l28.97"></a><span id="l28.97" class="difflineat">@@ -88,33 +115,23 @@ var gDisplayPane = {</span>
<a href="#l28.98"></a><span id="l28.98">                     type: &quot;fontname&quot;,</span>
<a href="#l28.99"></a><span id="l28.99">                     element: &quot;defaultFont&quot;,</span>
<a href="#l28.100"></a><span id="l28.100">                     fonttype: aIsSerif ? &quot;serif&quot; : &quot;sans-serif&quot; },</span>
<a href="#l28.101"></a><span id="l28.101">                    {format: kFontSizeFmtVariable,</span>
<a href="#l28.102"></a><span id="l28.102">                     type: &quot;int&quot;,</span>
<a href="#l28.103"></a><span id="l28.103">                     element: &quot;defaultFontSize&quot;,</span>
<a href="#l28.104"></a><span id="l28.104">                     fonttype: null }];</span>
<a href="#l28.105"></a><span id="l28.105"> </span>
<a href="#l28.106"></a><span id="l28.106" class="difflineminus">-      var preferences = document.getElementById(&quot;displayPreferences&quot;);</span>
<a href="#l28.107"></a><span id="l28.107">       for (var i = 0; i &lt; prefs.length; ++i) {</span>
<a href="#l28.108"></a><span id="l28.108" class="difflineminus">-        var preference = document.getElementById(prefs[i].format.replace(/%LANG%/,</span>
<a href="#l28.109"></a><span id="l28.109" class="difflineminus">-                                                                 aLanguageGroup));</span>
<a href="#l28.110"></a><span id="l28.110" class="difflineplus">+        var preference = Preferences.get(prefs[i].format.replace(/%LANG%/, aLanguageGroup));</span>
<a href="#l28.111"></a><span id="l28.111">         if (!preference) {</span>
<a href="#l28.112"></a><span id="l28.112" class="difflineminus">-          preference = document.createElement(&quot;preference&quot;);</span>
<a href="#l28.113"></a><span id="l28.113" class="difflineminus">-          var name = prefs[i].format.replace(/%LANG%/, aLanguageGroup);</span>
<a href="#l28.114"></a><span id="l28.114" class="difflineminus">-          preference.id = name;</span>
<a href="#l28.115"></a><span id="l28.115" class="difflineminus">-          preference.setAttribute(&quot;name&quot;, name);</span>
<a href="#l28.116"></a><span id="l28.116" class="difflineminus">-          preference.setAttribute(&quot;type&quot;, prefs[i].type);</span>
<a href="#l28.117"></a><span id="l28.117" class="difflineminus">-          preferences.appendChild(preference);</span>
<a href="#l28.118"></a><span id="l28.118" class="difflineminus">-</span>
<a href="#l28.119"></a><span id="l28.119" class="difflineminus">-          if (!(&quot;setElementValue&quot; in preference)) {</span>
<a href="#l28.120"></a><span id="l28.120" class="difflineminus">-            await new Promise((resolve) =&gt; {</span>
<a href="#l28.121"></a><span id="l28.121" class="difflineminus">-              preference.addEventListener(&quot;bindingattached&quot;, resolve, { once: true });</span>
<a href="#l28.122"></a><span id="l28.122" class="difflineminus">-            });</span>
<a href="#l28.123"></a><span id="l28.123" class="difflineminus">-          }</span>
<a href="#l28.124"></a><span id="l28.124" class="difflineplus">+          preference = Preferences.add({</span>
<a href="#l28.125"></a><span id="l28.125" class="difflineplus">+            id: prefs[i].format.replace(/%LANG%/, aLanguageGroup),</span>
<a href="#l28.126"></a><span id="l28.126" class="difflineplus">+            type: prefs[i].type,</span>
<a href="#l28.127"></a><span id="l28.127" class="difflineplus">+          });</span>
<a href="#l28.128"></a><span id="l28.128">         }</span>
<a href="#l28.129"></a><span id="l28.129"> </span>
<a href="#l28.130"></a><span id="l28.130">         if (!prefs[i].element)</span>
<a href="#l28.131"></a><span id="l28.131">           continue;</span>
<a href="#l28.132"></a><span id="l28.132"> </span>
<a href="#l28.133"></a><span id="l28.133">         var element = document.getElementById(prefs[i].element);</span>
<a href="#l28.134"></a><span id="l28.134">         if (element) {</span>
<a href="#l28.135"></a><span id="l28.135">           // Make sure we have the font list ready for readFontSelection below to</span>
<a href="#l28.136"></a><span id="l28.136" class="difflineat">@@ -134,71 +151,69 @@ var gDisplayPane = {</span>
<a href="#l28.137"></a><span id="l28.137"> </span>
<a href="#l28.138"></a><span id="l28.138">   /**</span>
<a href="#l28.139"></a><span id="l28.139">    * Returns the type of the current default font for the language denoted by</span>
<a href="#l28.140"></a><span id="l28.140">    * aLanguageGroup.</span>
<a href="#l28.141"></a><span id="l28.141">    */</span>
<a href="#l28.142"></a><span id="l28.142">   _readDefaultFontTypeForLanguage(aLanguageGroup) {</span>
<a href="#l28.143"></a><span id="l28.143">     const kDefaultFontType = &quot;font.default.%LANG%&quot;;</span>
<a href="#l28.144"></a><span id="l28.144">     var defaultFontTypePref = kDefaultFontType.replace(/%LANG%/, aLanguageGroup);</span>
<a href="#l28.145"></a><span id="l28.145" class="difflineminus">-    var preference = document.getElementById(defaultFontTypePref);</span>
<a href="#l28.146"></a><span id="l28.146" class="difflineplus">+    var preference = Preferences.get(defaultFontTypePref);</span>
<a href="#l28.147"></a><span id="l28.147">     if (!preference) {</span>
<a href="#l28.148"></a><span id="l28.148" class="difflineminus">-      preference = document.createElementNS(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;, &quot;preference&quot;);</span>
<a href="#l28.149"></a><span id="l28.149" class="difflineminus">-      preference.id = defaultFontTypePref;</span>
<a href="#l28.150"></a><span id="l28.150" class="difflineminus">-      preference.type = &quot;string&quot;;</span>
<a href="#l28.151"></a><span id="l28.151" class="difflineminus">-      preference.name = defaultFontTypePref;</span>
<a href="#l28.152"></a><span id="l28.152" class="difflineminus">-      preference.setAttribute(&quot;onchange&quot;, &quot;gDisplayPane._rebuildFonts();&quot;);</span>
<a href="#l28.153"></a><span id="l28.153" class="difflineminus">-      document.getElementById(&quot;displayPreferences&quot;).appendChild(preference);</span>
<a href="#l28.154"></a><span id="l28.154" class="difflineplus">+      Preferences.add({</span>
<a href="#l28.155"></a><span id="l28.155" class="difflineplus">+        id: defaultFontTypePref,</span>
<a href="#l28.156"></a><span id="l28.156" class="difflineplus">+        type: &quot;string&quot;,</span>
<a href="#l28.157"></a><span id="l28.157" class="difflineplus">+        name: defaultFontTypePref,</span>
<a href="#l28.158"></a><span id="l28.158" class="difflineplus">+      }).on(&quot;change&quot;, gDisplayPane._rebuildFonts);</span>
<a href="#l28.159"></a><span id="l28.159">     }</span>
<a href="#l28.160"></a><span id="l28.160"> </span>
<a href="#l28.161"></a><span id="l28.161">     // We should return preference.value here, but we can't wait for the binding to load,</span>
<a href="#l28.162"></a><span id="l28.162">     // or things get really messy. Fortunately this will give the same answer.</span>
<a href="#l28.163"></a><span id="l28.163">     return Services.prefs.getCharPref(defaultFontTypePref);</span>
<a href="#l28.164"></a><span id="l28.164">   },</span>
<a href="#l28.165"></a><span id="l28.165"> </span>
<a href="#l28.166"></a><span id="l28.166">   /**</span>
<a href="#l28.167"></a><span id="l28.167">    * Determine the appropriate value to select for defaultFont, for the</span>
<a href="#l28.168"></a><span id="l28.168">    * following cases:</span>
<a href="#l28.169"></a><span id="l28.169">    * - there is no setting</span>
<a href="#l28.170"></a><span id="l28.170">    * - the font selected by the user is no longer present (e.g. deleted from</span>
<a href="#l28.171"></a><span id="l28.171">    *   fonts folder)</span>
<a href="#l28.172"></a><span id="l28.172">    */</span>
<a href="#l28.173"></a><span id="l28.173">   readFontSelection() {</span>
<a href="#l28.174"></a><span id="l28.174">     let element = document.getElementById(&quot;defaultFont&quot;);</span>
<a href="#l28.175"></a><span id="l28.175" class="difflineminus">-    let preference = document.getElementById(element.getAttribute(&quot;preference&quot;));</span>
<a href="#l28.176"></a><span id="l28.176" class="difflineplus">+    let preference = Preferences.get(element.getAttribute(&quot;preference&quot;));</span>
<a href="#l28.177"></a><span id="l28.177">     if (preference.value) {</span>
<a href="#l28.178"></a><span id="l28.178">       let fontItem = element.querySelector('[value=&quot;' + preference.value + '&quot;]');</span>
<a href="#l28.179"></a><span id="l28.179"> </span>
<a href="#l28.180"></a><span id="l28.180">       // There is a setting that actually is in the list. Respect it.</span>
<a href="#l28.181"></a><span id="l28.181">       if (fontItem)</span>
<a href="#l28.182"></a><span id="l28.182">         return undefined;</span>
<a href="#l28.183"></a><span id="l28.183">     }</span>
<a href="#l28.184"></a><span id="l28.184"> </span>
<a href="#l28.185"></a><span id="l28.185">     let defaultValue = element.firstChild.firstChild.getAttribute(&quot;value&quot;);</span>
<a href="#l28.186"></a><span id="l28.186" class="difflineminus">-    let languagePref = document.getElementById(&quot;font.language.group&quot;);</span>
<a href="#l28.187"></a><span id="l28.187" class="difflineplus">+    let languagePref = Preferences.get(&quot;font.language.group&quot;);</span>
<a href="#l28.188"></a><span id="l28.188">     let defaultType = this._readDefaultFontTypeForLanguage(languagePref.value);</span>
<a href="#l28.189"></a><span id="l28.189" class="difflineminus">-    let listPref = document.getElementById(&quot;font.name-list.&quot; + defaultType +</span>
<a href="#l28.190"></a><span id="l28.190" class="difflineminus">-                                           &quot;.&quot; + languagePref.value);</span>
<a href="#l28.191"></a><span id="l28.191" class="difflineplus">+    let listPref = Preferences.get(&quot;font.name-list.&quot; + defaultType + &quot;.&quot; + languagePref.value);</span>
<a href="#l28.192"></a><span id="l28.192">     if (!listPref)</span>
<a href="#l28.193"></a><span id="l28.193">       return defaultValue;</span>
<a href="#l28.194"></a><span id="l28.194"> </span>
<a href="#l28.195"></a><span id="l28.195">     let fontNames = listPref.value.split(&quot;,&quot;);</span>
<a href="#l28.196"></a><span id="l28.196"> </span>
<a href="#l28.197"></a><span id="l28.197">     for (let fontName of fontNames) {</span>
<a href="#l28.198"></a><span id="l28.198">       let fontItem = element.querySelector('[value=&quot;' + fontName.trim() + '&quot;]');</span>
<a href="#l28.199"></a><span id="l28.199">       if (fontItem)</span>
<a href="#l28.200"></a><span id="l28.200">         return fontItem.getAttribute(&quot;value&quot;);</span>
<a href="#l28.201"></a><span id="l28.201">     }</span>
<a href="#l28.202"></a><span id="l28.202">     return defaultValue;</span>
<a href="#l28.203"></a><span id="l28.203">   },</span>
<a href="#l28.204"></a><span id="l28.204"> </span>
<a href="#l28.205"></a><span id="l28.205">   tabSelectionChanged() {</span>
<a href="#l28.206"></a><span id="l28.206">     if (this.mInitialized)</span>
<a href="#l28.207"></a><span id="l28.207" class="difflineminus">-      document.getElementById(&quot;mail.preferences.display.selectedTabIndex&quot;)</span>
<a href="#l28.208"></a><span id="l28.208" class="difflineminus">-              .valueFromPreferences = document.getElementById(&quot;displayPrefs&quot;).selectedIndex;</span>
<a href="#l28.209"></a><span id="l28.209" class="difflineplus">+      Preferences.get(&quot;mail.preferences.display.selectedTabIndex&quot;)</span>
<a href="#l28.210"></a><span id="l28.210" class="difflineplus">+                 .valueFromPreferences = document.getElementById(&quot;displayPrefs&quot;).selectedIndex;</span>
<a href="#l28.211"></a><span id="l28.211">   },</span>
<a href="#l28.212"></a><span id="l28.212"> </span>
<a href="#l28.213"></a><span id="l28.213">   /**</span>
<a href="#l28.214"></a><span id="l28.214">    * Displays the fonts dialog, where web page font names and sizes can be</span>
<a href="#l28.215"></a><span id="l28.215">    * configured.</span>
<a href="#l28.216"></a><span id="l28.216">    */</span>
<a href="#l28.217"></a><span id="l28.217">   configureFonts() {</span>
<a href="#l28.218"></a><span id="l28.218">     gSubDialog.open(&quot;chrome://messenger/content/preferences/fonts.xul&quot;);</span>
<a href="#l28.219"></a><span id="l28.219" class="difflineat">@@ -267,43 +282,40 @@ var gDisplayPane = {</span>
<a href="#l28.220"></a><span id="l28.220">       btnEdit.disabled = true;</span>
<a href="#l28.221"></a><span id="l28.221"> </span>
<a href="#l28.222"></a><span id="l28.222">     document.getElementById(&quot;removeTagButton&quot;).disabled = btnEdit.disabled;</span>
<a href="#l28.223"></a><span id="l28.223">   },</span>
<a href="#l28.224"></a><span id="l28.224"> </span>
<a href="#l28.225"></a><span id="l28.225">   /**</span>
<a href="#l28.226"></a><span id="l28.226">    * Enable/disable the options of automatic marking as read depending on the</span>
<a href="#l28.227"></a><span id="l28.227">    * state of the automatic marking feature.</span>
<a href="#l28.228"></a><span id="l28.228" class="difflineminus">-   *</span>
<a href="#l28.229"></a><span id="l28.229" class="difflineminus">-   * @param aEnableRadioGroup  Boolean value indicating whether the feature is enabled.</span>
<a href="#l28.230"></a><span id="l28.230">    */</span>
<a href="#l28.231"></a><span id="l28.231" class="difflineminus">-  updateMarkAsReadOptions(aEnableRadioGroup) {</span>
<a href="#l28.232"></a><span id="l28.232" class="difflineminus">-    let autoMarkAsPref = document.getElementById(&quot;mailnews.mark_message_read.delay&quot;);</span>
<a href="#l28.233"></a><span id="l28.233" class="difflineminus">-    let autoMarkDisabled = !aEnableRadioGroup || autoMarkAsPref.locked;</span>
<a href="#l28.234"></a><span id="l28.234" class="difflineplus">+  updateMarkAsReadOptions() {</span>
<a href="#l28.235"></a><span id="l28.235" class="difflineplus">+    let enableRadioGroup = Preferences.get(&quot;mailnews.mark_message_read.auto&quot;).value;</span>
<a href="#l28.236"></a><span id="l28.236" class="difflineplus">+    let autoMarkAsPref = Preferences.get(&quot;mailnews.mark_message_read.delay&quot;);</span>
<a href="#l28.237"></a><span id="l28.237" class="difflineplus">+    let autoMarkDisabled = !enableRadioGroup || autoMarkAsPref.locked;</span>
<a href="#l28.238"></a><span id="l28.238">     document.getElementById(&quot;markAsReadAutoPreferences&quot;).disabled = autoMarkDisabled;</span>
<a href="#l28.239"></a><span id="l28.239">     document.getElementById(&quot;secondsLabel&quot;).disabled = autoMarkDisabled;</span>
<a href="#l28.240"></a><span id="l28.240" class="difflineminus">-    this.updateMarkAsReadTextbox();</span>
<a href="#l28.241"></a><span id="l28.241" class="difflineplus">+    gDisplayPane.updateMarkAsReadTextbox();</span>
<a href="#l28.242"></a><span id="l28.242">   },</span>
<a href="#l28.243"></a><span id="l28.243"> </span>
<a href="#l28.244"></a><span id="l28.244">   /**</span>
<a href="#l28.245"></a><span id="l28.245">    * Automatically enable/disable delay textbox depending on state of the</span>
<a href="#l28.246"></a><span id="l28.246">    * Mark As Read On Delay feature.</span>
<a href="#l28.247"></a><span id="l28.247" class="difflineminus">-   *</span>
<a href="#l28.248"></a><span id="l28.248" class="difflineminus">-   * @param aFocusTextBox  Boolean value whether Mark As Read On Delay</span>
<a href="#l28.249"></a><span id="l28.249" class="difflineminus">-   *                       option was selected and the textbox should be focused.</span>
<a href="#l28.250"></a><span id="l28.250">    */</span>
<a href="#l28.251"></a><span id="l28.251" class="difflineminus">-  updateMarkAsReadTextbox(aFocusTextBox) {</span>
<a href="#l28.252"></a><span id="l28.252" class="difflineminus">-    let globalCheckbox = document.getElementById(&quot;automaticallyMarkAsRead&quot;);</span>
<a href="#l28.253"></a><span id="l28.253" class="difflineminus">-    let delayRadioOption = document.getElementById(&quot;markAsReadAfterDelay&quot;);</span>
<a href="#l28.254"></a><span id="l28.254" class="difflineplus">+  updateMarkAsReadTextbox() {</span>
<a href="#l28.255"></a><span id="l28.255" class="difflineplus">+    let radioGroupEnabled = Preferences.get(&quot;mailnews.mark_message_read.auto&quot;).value;</span>
<a href="#l28.256"></a><span id="l28.256" class="difflineplus">+    let textBoxEnabled = Preferences.get(&quot;mailnews.mark_message_read.delay&quot;).value;</span>
<a href="#l28.257"></a><span id="l28.257" class="difflineplus">+    let intervalPref = Preferences.get(&quot;mailnews.mark_message_read.delay.interval&quot;);</span>
<a href="#l28.258"></a><span id="l28.258" class="difflineplus">+</span>
<a href="#l28.259"></a><span id="l28.259">     let delayTextbox = document.getElementById(&quot;markAsReadDelay&quot;);</span>
<a href="#l28.260"></a><span id="l28.260" class="difflineminus">-    let intervalPref = document.getElementById(&quot;mailnews.mark_message_read.delay.interval&quot;);</span>
<a href="#l28.261"></a><span id="l28.261" class="difflineminus">-    delayTextbox.disabled = !globalCheckbox.checked ||</span>
<a href="#l28.262"></a><span id="l28.262" class="difflineminus">-                            !delayRadioOption.selected || intervalPref.locked;</span>
<a href="#l28.263"></a><span id="l28.263" class="difflineminus">-    if (!delayTextbox.disabled &amp;&amp; aFocusTextBox)</span>
<a href="#l28.264"></a><span id="l28.264" class="difflineplus">+    delayTextbox.disabled = !radioGroupEnabled || !textBoxEnabled || intervalPref.locked;</span>
<a href="#l28.265"></a><span id="l28.265" class="difflineplus">+    if (document.activeElement.id == &quot;markAsReadAutoPreferences&quot;) {</span>
<a href="#l28.266"></a><span id="l28.266">       delayTextbox.focus();</span>
<a href="#l28.267"></a><span id="l28.267" class="difflineplus">+    }</span>
<a href="#l28.268"></a><span id="l28.268">   },</span>
<a href="#l28.269"></a><span id="l28.269"> };</span>
<a href="#l28.270"></a><span id="l28.270"> </span>
<a href="#l28.271"></a><span id="l28.271"> function addTagCallback(aName, aColor) {</span>
<a href="#l28.272"></a><span id="l28.272">   MailServices.tags.addTag(aName, aColor, &quot;&quot;);</span>
<a href="#l28.273"></a><span id="l28.273"> </span>
<a href="#l28.274"></a><span id="l28.274">   // Add to style sheet.</span>
<a href="#l28.275"></a><span id="l28.275">   let key = MailServices.tags.getKeyForTag(aName);</span>
<a href="#l28.276"></a><span id="l28.276" class="difflineat">@@ -329,8 +341,12 @@ function editTagCallback() {</span>
<a href="#l28.277"></a><span id="l28.277">   // update the color and label elements</span>
<a href="#l28.278"></a><span id="l28.278">   tagElToEdit.setAttribute(&quot;label&quot;, MailServices.tags.getTagForKey(key));</span>
<a href="#l28.279"></a><span id="l28.279">   tagElToEdit.style.color = color;</span>
<a href="#l28.280"></a><span id="l28.280"> </span>
<a href="#l28.281"></a><span id="l28.281">   // Add to style sheet. We simply add the new color, the rule is added at the</span>
<a href="#l28.282"></a><span id="l28.282">   // end and will overrule the previous rule.</span>
<a href="#l28.283"></a><span id="l28.283">   TagUtils.addTagToAllDocumentSheets(key, color);</span>
<a href="#l28.284"></a><span id="l28.284"> }</span>
<a href="#l28.285"></a><span id="l28.285" class="difflineplus">+</span>
<a href="#l28.286"></a><span id="l28.286" class="difflineplus">+Preferences.get(&quot;font.language.group&quot;).on(&quot;change&quot;, gDisplayPane._rebuildFonts);</span>
<a href="#l28.287"></a><span id="l28.287" class="difflineplus">+Preferences.get(&quot;mailnews.mark_message_read.auto&quot;).on(&quot;change&quot;, gDisplayPane.updateMarkAsReadOptions);</span>
<a href="#l28.288"></a><span id="l28.288" class="difflineplus">+Preferences.get(&quot;mailnews.mark_message_read.delay&quot;).on(&quot;change&quot;, gDisplayPane.updateMarkAsReadTextbox);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">new file mode 100644</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineminus">--- /dev/null</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineplus">+++ b/mail/components/preferences/dockoptions.js</span>
<a href="#l29.4"></a><span id="l29.4" class="difflineat">@@ -0,0 +1,10 @@</span>
<a href="#l29.5"></a><span id="l29.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.6"></a><span id="l29.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.7"></a><span id="l29.7" class="difflineplus">+ * file, you can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l29.8"></a><span id="l29.8" class="difflineplus">+</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineplus">+</span>
<a href="#l29.11"></a><span id="l29.11" class="difflineplus">+Preferences.addAll([</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineplus">+  { id: &quot;mail.biff.animate_dock_icon&quot;, type: &quot;bool&quot; },</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+  { id: &quot;mail.biff.use_new_count_in_mac_dock&quot;, type: &quot;bool&quot; },</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/components/preferences/dockoptions.xul</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/components/preferences/dockoptions.xul</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -2,33 +2,24 @@</span>
<a href="#l30.4"></a><span id="l30.4"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l30.5"></a><span id="l30.5">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l30.6"></a><span id="l30.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l30.7"></a><span id="l30.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l30.8"></a><span id="l30.8"> </span>
<a href="#l30.9"></a><span id="l30.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l30.10"></a><span id="l30.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-&lt;!DOCTYPE prefwindow SYSTEM &quot;chrome://messenger/locale/preferences/dockoptions.dtd&quot;&gt;</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+&lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/preferences/dockoptions.dtd&quot;&gt;</span>
<a href="#l30.14"></a><span id="l30.14"> </span>
<a href="#l30.15"></a><span id="l30.15" class="difflineminus">-&lt;prefwindow id=&quot;DockOptionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineminus">-            xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l30.18"></a><span id="l30.18" class="difflineminus">-            title=&quot;&amp;dockOptionsDialog.title;&quot; dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l30.19"></a><span id="l30.19" class="difflineminus">-            style=&quot;width: &amp;window.macWidth;&quot;&gt;</span>
<a href="#l30.20"></a><span id="l30.20" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineminus">-          src=&quot;chrome://communicator/content/utilityOverlay.js&quot;/&gt;</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineplus">+&lt;dialog id=&quot;DockOptionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineplus">+        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineplus">+        title=&quot;&amp;dockOptionsDialog.title;&quot; dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l30.26"></a><span id="l30.26" class="difflineplus">+        style=&quot;width: &amp;window.macWidth;&quot;&gt;</span>
<a href="#l30.27"></a><span id="l30.27">   &lt;prefpane id=&quot;DockOptionsDialogPane&quot;&gt;</span>
<a href="#l30.28"></a><span id="l30.28" class="difflineminus">-    &lt;preferences&gt;</span>
<a href="#l30.29"></a><span id="l30.29" class="difflineminus">-      &lt;preference id=&quot;mail.biff.animate_dock_icon&quot;</span>
<a href="#l30.30"></a><span id="l30.30" class="difflineminus">-                  name=&quot;mail.biff.animate_dock_icon&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l30.31"></a><span id="l30.31" class="difflineminus">-      &lt;preference id=&quot;mail.biff.use_new_count_in_mac_dock&quot;</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineminus">-                  name=&quot;mail.biff.use_new_count_in_mac_dock&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineminus">-</span>
<a href="#l30.35"></a><span id="l30.35">     &lt;hbox orient=&quot;vertical&quot;&gt;</span>
<a href="#l30.36"></a><span id="l30.36">       &lt;checkbox id=&quot;newMailNotificationBounce&quot;</span>
<a href="#l30.37"></a><span id="l30.37">                 label=&quot;&amp;bounceSystemDockIcon.label;&quot;</span>
<a href="#l30.38"></a><span id="l30.38">                 preference=&quot;mail.biff.animate_dock_icon&quot;</span>
<a href="#l30.39"></a><span id="l30.39">                 accesskey=&quot;&amp;bounceSystemDockIcon.accesskey;&quot;/&gt;</span>
<a href="#l30.40"></a><span id="l30.40">       &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l30.41"></a><span id="l30.41">       &lt;groupbox flex=&quot;1&quot;&gt;</span>
<a href="#l30.42"></a><span id="l30.42">         &lt;label&gt;&lt;html:h2&gt;&amp;dockIconBadge.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineat">@@ -44,9 +35,12 @@</span>
<a href="#l30.44"></a><span id="l30.44">                  label=&quot;&amp;newMessagesCountDock.label;&quot;</span>
<a href="#l30.45"></a><span id="l30.45">                  accesskey=&quot;&amp;newMessagesCountDock.label;&quot;/&gt;</span>
<a href="#l30.46"></a><span id="l30.46">         &lt;/radiogroup&gt;</span>
<a href="#l30.47"></a><span id="l30.47">       &lt;/groupbox&gt;</span>
<a href="#l30.48"></a><span id="l30.48">       &lt;separator/&gt;</span>
<a href="#l30.49"></a><span id="l30.49">       &lt;description class=&quot;bold&quot;&gt;&amp;directNotificationSettings.label;&lt;/description&gt;</span>
<a href="#l30.50"></a><span id="l30.50">     &lt;/hbox&gt;</span>
<a href="#l30.51"></a><span id="l30.51">   &lt;/prefpane&gt;</span>
<a href="#l30.52"></a><span id="l30.52" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l30.53"></a><span id="l30.53" class="difflineplus">+</span>
<a href="#l30.54"></a><span id="l30.54" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l30.55"></a><span id="l30.55" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/dockoptions.js&quot;/&gt;</span>
<a href="#l30.56"></a><span id="l30.56" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mail/components/preferences/doctype.inc.xul</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mail/components/preferences/doctype.inc.xul</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l31.4"></a><span id="l31.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l31.5"></a><span id="l31.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l31.6"></a><span id="l31.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineplus">+&lt;!DOCTYPE preftab [</span>
<a href="#l31.10"></a><span id="l31.10"> &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span>
<a href="#l31.11"></a><span id="l31.11"> %brandDTD;</span>
<a href="#l31.12"></a><span id="l31.12"> &lt;!ENTITY % preferencesDTD SYSTEM &quot;chrome://messenger/locale/preferences/preferences.dtd&quot;&gt;</span>
<a href="#l31.13"></a><span id="l31.13"> %preferencesDTD;</span>
<a href="#l31.14"></a><span id="l31.14"> &lt;!ENTITY % generalDTD SYSTEM &quot;chrome://messenger/locale/preferences/general.dtd&quot; &gt;</span>
<a href="#l31.15"></a><span id="l31.15"> %generalDTD;</span>
<a href="#l31.16"></a><span id="l31.16"> &lt;!ENTITY % displayDTD SYSTEM &quot;chrome://messenger/locale/preferences/display.dtd&quot; &gt;</span>
<a href="#l31.17"></a><span id="l31.17"> %displayDTD;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/components/preferences/downloads.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/components/preferences/downloads.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -3,46 +3,54 @@</span>
<a href="#l32.4"></a><span id="l32.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.5"></a><span id="l32.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.6"></a><span id="l32.6"> </span>
<a href="#l32.7"></a><span id="l32.7"> /* import-globals-from preferences.js */</span>
<a href="#l32.8"></a><span id="l32.8"> </span>
<a href="#l32.9"></a><span id="l32.9"> var {Downloads} = ChromeUtils.import(&quot;resource://gre/modules/Downloads.jsm&quot;);</span>
<a href="#l32.10"></a><span id="l32.10"> var {FileUtils} = ChromeUtils.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);</span>
<a href="#l32.11"></a><span id="l32.11"> </span>
<a href="#l32.12"></a><span id="l32.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+  { id: &quot;browser.download.useDownloadDir&quot;, type: &quot;bool&quot; },</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineplus">+  { id: &quot;browser.download.folderList&quot;, type: &quot;int&quot; },</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineplus">+  { id: &quot;browser.download.downloadDir&quot;, type: &quot;file&quot; },</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineplus">+  { id: &quot;browser.download.dir&quot;, type: &quot;file&quot; },</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+  { id: &quot;pref.downloads.disable_button.edit_actions&quot;, type: &quot;bool&quot; },</span>
<a href="#l32.18"></a><span id="l32.18" class="difflineplus">+]);</span>
<a href="#l32.19"></a><span id="l32.19" class="difflineplus">+</span>
<a href="#l32.20"></a><span id="l32.20"> var gDownloadDirSection = {</span>
<a href="#l32.21"></a><span id="l32.21">   async chooseFolder() {</span>
<a href="#l32.22"></a><span id="l32.22">     var fp = Cc[&quot;@mozilla.org/filepicker;1&quot;]</span>
<a href="#l32.23"></a><span id="l32.23">                .createInstance(Ci.nsIFilePicker);</span>
<a href="#l32.24"></a><span id="l32.24">     var bundlePreferences = document.getElementById(&quot;bundlePreferences&quot;);</span>
<a href="#l32.25"></a><span id="l32.25">     var title = bundlePreferences.getString(&quot;chooseAttachmentsFolderTitle&quot;);</span>
<a href="#l32.26"></a><span id="l32.26">     fp.init(window, title, Ci.nsIFilePicker.modeGetFolder);</span>
<a href="#l32.27"></a><span id="l32.27"> </span>
<a href="#l32.28"></a><span id="l32.28" class="difflineminus">-    var customDirPref = document.getElementById(&quot;browser.download.dir&quot;);</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineplus">+    var customDirPref = Preferences.get(&quot;browser.download.dir&quot;);</span>
<a href="#l32.30"></a><span id="l32.30">     if (customDirPref.value)</span>
<a href="#l32.31"></a><span id="l32.31">       fp.displayDirectory = customDirPref.value;</span>
<a href="#l32.32"></a><span id="l32.32">     fp.appendFilters(Ci.nsIFilePicker.filterAll);</span>
<a href="#l32.33"></a><span id="l32.33"> </span>
<a href="#l32.34"></a><span id="l32.34">     let rv = await new Promise(resolve =&gt; fp.open(resolve));</span>
<a href="#l32.35"></a><span id="l32.35">     if (rv != Ci.nsIFilePicker.returnOK || !fp.file) {</span>
<a href="#l32.36"></a><span id="l32.36">       return;</span>
<a href="#l32.37"></a><span id="l32.37">     }</span>
<a href="#l32.38"></a><span id="l32.38"> </span>
<a href="#l32.39"></a><span id="l32.39">     let file = fp.file.QueryInterface(Ci.nsIFile);</span>
<a href="#l32.40"></a><span id="l32.40" class="difflineminus">-    let currentDirPref = document.getElementById(&quot;browser.download.downloadDir&quot;);</span>
<a href="#l32.41"></a><span id="l32.41" class="difflineplus">+    let currentDirPref = Preferences.get(&quot;browser.download.downloadDir&quot;);</span>
<a href="#l32.42"></a><span id="l32.42">     customDirPref.value = currentDirPref.value = file;</span>
<a href="#l32.43"></a><span id="l32.43" class="difflineminus">-    let folderListPref = document.getElementById(&quot;browser.download.folderList&quot;);</span>
<a href="#l32.44"></a><span id="l32.44" class="difflineplus">+    let folderListPref = Preferences.get(&quot;browser.download.folderList&quot;);</span>
<a href="#l32.45"></a><span id="l32.45">     folderListPref.value = await this._fileToIndex(file);</span>
<a href="#l32.46"></a><span id="l32.46">   },</span>
<a href="#l32.47"></a><span id="l32.47"> </span>
<a href="#l32.48"></a><span id="l32.48">   onReadUseDownloadDir() {</span>
<a href="#l32.49"></a><span id="l32.49">     this.readDownloadDirPref();</span>
<a href="#l32.50"></a><span id="l32.50">     var downloadFolder = document.getElementById(&quot;downloadFolder&quot;);</span>
<a href="#l32.51"></a><span id="l32.51">     var chooseFolder = document.getElementById(&quot;chooseFolder&quot;);</span>
<a href="#l32.52"></a><span id="l32.52" class="difflineminus">-    var preference = document.getElementById(&quot;browser.download.useDownloadDir&quot;);</span>
<a href="#l32.53"></a><span id="l32.53" class="difflineplus">+    var preference = Preferences.get(&quot;browser.download.useDownloadDir&quot;);</span>
<a href="#l32.54"></a><span id="l32.54">     downloadFolder.disabled = !preference.value;</span>
<a href="#l32.55"></a><span id="l32.55">     chooseFolder.disabled = !preference.value;</span>
<a href="#l32.56"></a><span id="l32.56">     return undefined;</span>
<a href="#l32.57"></a><span id="l32.57">   },</span>
<a href="#l32.58"></a><span id="l32.58"> </span>
<a href="#l32.59"></a><span id="l32.59">   async _fileToIndex(aFile) {</span>
<a href="#l32.60"></a><span id="l32.60">     if (!aFile || aFile.equals(await this._getDownloadsFolder(&quot;Desktop&quot;)))</span>
<a href="#l32.61"></a><span id="l32.61">       return 0;</span>
<a href="#l32.62"></a><span id="l32.62" class="difflineat">@@ -53,48 +61,50 @@ var gDownloadDirSection = {</span>
<a href="#l32.63"></a><span id="l32.63"> </span>
<a href="#l32.64"></a><span id="l32.64">   async _indexToFile(aIndex) {</span>
<a href="#l32.65"></a><span id="l32.65">     switch (aIndex) {</span>
<a href="#l32.66"></a><span id="l32.66">     case 0:</span>
<a href="#l32.67"></a><span id="l32.67">       return this._getDownloadsFolder(&quot;Desktop&quot;);</span>
<a href="#l32.68"></a><span id="l32.68">     case 1:</span>
<a href="#l32.69"></a><span id="l32.69">       return this._getDownloadsFolder(&quot;Downloads&quot;);</span>
<a href="#l32.70"></a><span id="l32.70">     }</span>
<a href="#l32.71"></a><span id="l32.71" class="difflineminus">-    var customDirPref = document.getElementById(&quot;browser.download.dir&quot;);</span>
<a href="#l32.72"></a><span id="l32.72" class="difflineplus">+    var customDirPref = Preferences.get(&quot;browser.download.dir&quot;);</span>
<a href="#l32.73"></a><span id="l32.73">     return customDirPref.value;</span>
<a href="#l32.74"></a><span id="l32.74">   },</span>
<a href="#l32.75"></a><span id="l32.75"> </span>
<a href="#l32.76"></a><span id="l32.76">   async _getDownloadsFolder(aFolder) {</span>
<a href="#l32.77"></a><span id="l32.77">     switch (aFolder) {</span>
<a href="#l32.78"></a><span id="l32.78">       case &quot;Desktop&quot;:</span>
<a href="#l32.79"></a><span id="l32.79">         return Services.dirsvc.get(&quot;Desk&quot;, Ci.nsIFile);</span>
<a href="#l32.80"></a><span id="l32.80">       case &quot;Downloads&quot;:</span>
<a href="#l32.81"></a><span id="l32.81">         let downloadsDir = await Downloads.getSystemDownloadsDirectory();</span>
<a href="#l32.82"></a><span id="l32.82">         return new FileUtils.File(downloadsDir);</span>
<a href="#l32.83"></a><span id="l32.83">     }</span>
<a href="#l32.84"></a><span id="l32.84">     throw new Error(&quot;ASSERTION FAILED: folder type should be 'Desktop' or 'Downloads'&quot;);</span>
<a href="#l32.85"></a><span id="l32.85">   },</span>
<a href="#l32.86"></a><span id="l32.86"> </span>
<a href="#l32.87"></a><span id="l32.87">   async readDownloadDirPref() {</span>
<a href="#l32.88"></a><span id="l32.88" class="difflineminus">-    var folderListPref = document.getElementById(&quot;browser.download.folderList&quot;);</span>
<a href="#l32.89"></a><span id="l32.89" class="difflineplus">+    var folderListPref = Preferences.get(&quot;browser.download.folderList&quot;);</span>
<a href="#l32.90"></a><span id="l32.90">     var bundlePreferences = document.getElementById(&quot;bundlePreferences&quot;);</span>
<a href="#l32.91"></a><span id="l32.91">     var downloadFolder = document.getElementById(&quot;downloadFolder&quot;);</span>
<a href="#l32.92"></a><span id="l32.92"> </span>
<a href="#l32.93"></a><span id="l32.93" class="difflineminus">-    var customDirPref = document.getElementById(&quot;browser.download.dir&quot;);</span>
<a href="#l32.94"></a><span id="l32.94" class="difflineplus">+    var customDirPref = Preferences.get(&quot;browser.download.dir&quot;);</span>
<a href="#l32.95"></a><span id="l32.95">     var customIndex = customDirPref.value ? await this._fileToIndex(customDirPref.value) : 0;</span>
<a href="#l32.96"></a><span id="l32.96">     if (customIndex == 0)</span>
<a href="#l32.97"></a><span id="l32.97">       downloadFolder.value = bundlePreferences.getString(&quot;desktopFolderName&quot;);</span>
<a href="#l32.98"></a><span id="l32.98">     else if (customIndex == 1)</span>
<a href="#l32.99"></a><span id="l32.99">       downloadFolder.value = bundlePreferences.getString(&quot;myDownloadsFolderName&quot;);</span>
<a href="#l32.100"></a><span id="l32.100">     else</span>
<a href="#l32.101"></a><span id="l32.101">       downloadFolder.value = customDirPref.value ? customDirPref.value.path : &quot;&quot;;</span>
<a href="#l32.102"></a><span id="l32.102"> </span>
<a href="#l32.103"></a><span id="l32.103" class="difflineminus">-    var currentDirPref = document.getElementById(&quot;browser.download.downloadDir&quot;);</span>
<a href="#l32.104"></a><span id="l32.104" class="difflineplus">+    var currentDirPref = Preferences.get(&quot;browser.download.downloadDir&quot;);</span>
<a href="#l32.105"></a><span id="l32.105">     var downloadDir = currentDirPref.value || await this._indexToFile(folderListPref.value);</span>
<a href="#l32.106"></a><span id="l32.106">     let urlSpec = Services.io.getProtocolHandler(&quot;file&quot;)</span>
<a href="#l32.107"></a><span id="l32.107">       .QueryInterface(Ci.nsIFileProtocolHandler)</span>
<a href="#l32.108"></a><span id="l32.108">       .getURLSpecFromFile(downloadDir);</span>
<a href="#l32.109"></a><span id="l32.109"> </span>
<a href="#l32.110"></a><span id="l32.110">     downloadFolder.style.backgroundImage = &quot;url(moz-icon://&quot; + urlSpec + &quot;?size=16)&quot;;</span>
<a href="#l32.111"></a><span id="l32.111"> </span>
<a href="#l32.112"></a><span id="l32.112">     return undefined;</span>
<a href="#l32.113"></a><span id="l32.113">   },</span>
<a href="#l32.114"></a><span id="l32.114"> };</span>
<a href="#l32.115"></a><span id="l32.115" class="difflineplus">+</span>
<a href="#l32.116"></a><span id="l32.116" class="difflineplus">+Preferences.get(&quot;browser.download.dir&quot;).on(&quot;change&quot;, gDownloadDirSection.readDownloadDirPref);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mail/components/preferences/fonts.xul</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mail/components/preferences/fonts.xul</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -3,17 +3,17 @@</span>
<a href="#l33.4"></a><span id="l33.4">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.5"></a><span id="l33.5">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l33.6"></a><span id="l33.6">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l33.9"></a><span id="l33.9"> &lt;?xml-stylesheet href=&quot;chrome://messenger/content/charsetList.css&quot;?&gt;</span>
<a href="#l33.10"></a><span id="l33.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l33.14"></a><span id="l33.14"> &lt;!ENTITY % fontsDTD SYSTEM &quot;chrome://messenger/locale/preferences/fonts.dtd&quot; &gt;</span>
<a href="#l33.15"></a><span id="l33.15"> %fontsDTD;</span>
<a href="#l33.16"></a><span id="l33.16"> ]&gt;</span>
<a href="#l33.17"></a><span id="l33.17"> </span>
<a href="#l33.18"></a><span id="l33.18"> &lt;dialog id=&quot;FontsDialog&quot; type=&quot;child&quot; class=&quot;prefwindow&quot;</span>
<a href="#l33.19"></a><span id="l33.19">             xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l33.20"></a><span id="l33.20">             xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l33.21"></a><span id="l33.21">             title=&quot;&amp;fontsAndEncodingsDialog.title;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mail/components/preferences/general.inc.xul</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mail/components/preferences/general.inc.xul</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,38 +1,23 @@</span>
<a href="#l34.4"></a><span id="l34.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.5"></a><span id="l34.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.6"></a><span id="l34.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l34.7"></a><span id="l34.7">   &lt;prefpane id=&quot;paneGeneral&quot; label=&quot;&amp;paneGeneral.title;&quot;&gt;</span>
<a href="#l34.8"></a><span id="l34.8">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://communicator/content/utilityOverlay.js&quot;/&gt;</span>
<a href="#l34.9"></a><span id="l34.9">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/general.js&quot;/&gt;</span>
<a href="#l34.10"></a><span id="l34.10"> </span>
<a href="#l34.11"></a><span id="l34.11" class="difflineminus">-    &lt;preferences id=&quot;generalPreferences&quot;&gt;</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-      &lt;preference id=&quot;mail.pane_config.dynamic&quot; name=&quot;mail.pane_config.dynamic&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineminus">-      &lt;preference id=&quot;mailnews.reuse_message_window&quot; name=&quot;mailnews.reuse_message_window&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineminus">-      &lt;preference id=&quot;mailnews.start_page.enabled&quot; name=&quot;mailnews.start_page.enabled&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l34.15"></a><span id="l34.15" class="difflineminus">-      &lt;preference id=&quot;mailnews.start_page.url&quot; name=&quot;mailnews.start_page.url&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineminus">-#ifndef XP_MACOSX</span>
<a href="#l34.17"></a><span id="l34.17" class="difflineminus">-      &lt;preference id=&quot;mail.biff.show_alert&quot; name=&quot;mail.biff.show_alert&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l34.18"></a><span id="l34.18" class="difflineminus">-#endif</span>
<a href="#l34.19"></a><span id="l34.19" class="difflineminus">-      &lt;preference id=&quot;mail.biff.show_tray_icon&quot; name=&quot;mail.biff.show_tray_icon&quot; type=&quot;bool&quot; /&gt;</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineminus">-      &lt;preference id=&quot;mail.biff.play_sound&quot; name=&quot;mail.biff.play_sound&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineminus">-      &lt;preference id=&quot;mail.biff.play_sound.type&quot; name=&quot;mail.biff.play_sound.type&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineminus">-      &lt;preference id=&quot;mail.biff.play_sound.url&quot; name=&quot;mail.biff.play_sound.url&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineminus">-</span>
<a href="#l34.25"></a><span id="l34.25">     &lt;stringbundle id=&quot;bundlePreferences&quot; src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l34.26"></a><span id="l34.26"> </span>
<a href="#l34.27"></a><span id="l34.27">     &lt;groupbox&gt;</span>
<a href="#l34.28"></a><span id="l34.28">       &lt;label&gt;&lt;html:h2&gt;&amp;messengerStartPage.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l34.29"></a><span id="l34.29">         &lt;hbox align=&quot;start&quot;&gt;</span>
<a href="#l34.30"></a><span id="l34.30">           &lt;checkbox id=&quot;mailnewsStartPageEnabled&quot; label=&quot;&amp;enableStartPage.label;&quot;</span>
<a href="#l34.31"></a><span id="l34.31">                     preference=&quot;mailnews.start_page.enabled&quot;</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineminus">-                    accesskey=&quot;&amp;enableStartPage.accesskey;&quot;</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineminus">-                    oncommand=&quot;gGeneralPane.updateStartPage();&quot;/&gt;</span>
<a href="#l34.34"></a><span id="l34.34" class="difflineplus">+                    accesskey=&quot;&amp;enableStartPage.accesskey;&quot;/&gt;</span>
<a href="#l34.35"></a><span id="l34.35">         &lt;/hbox&gt;</span>
<a href="#l34.36"></a><span id="l34.36">         &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l34.37"></a><span id="l34.37">           &lt;label value=&quot;&amp;location.label;&quot; accesskey=&quot;&amp;location1.accesskey;&quot; control=&quot;mailnewsStartPageUrl&quot;/&gt;</span>
<a href="#l34.38"></a><span id="l34.38">           &lt;textbox id=&quot;mailnewsStartPageUrl&quot; flex=&quot;1&quot; class=&quot;uri-element&quot;</span>
<a href="#l34.39"></a><span id="l34.39">                    preference=&quot;mailnews.start_page.url&quot;</span>
<a href="#l34.40"></a><span id="l34.40">                    onsyncfrompreference=&quot;return gGeneralPane.readStartPageUrl();&quot;</span>
<a href="#l34.41"></a><span id="l34.41">                    onsynctopreference=&quot;return gGeneralPane.writeStartPageUrl();&quot;/&gt;</span>
<a href="#l34.42"></a><span id="l34.42">           &lt;button label=&quot;&amp;useDefault.label;&quot; accesskey=&quot;&amp;useDefault.accesskey;&quot;</span>
<a href="#l34.43"></a><span id="l34.43" class="difflineat">@@ -61,18 +46,17 @@</span>
<a href="#l34.44"></a><span id="l34.44">                 oncommand=&quot;gGeneralPane.configureDockOptions();&quot;/&gt;</span>
<a href="#l34.45"></a><span id="l34.45">       &lt;/hbox&gt;</span>
<a href="#l34.46"></a><span id="l34.46">       &lt;description class=&quot;bold&quot;&gt;&amp;notificationAlertSettings2.label;&lt;/description&gt;</span>
<a href="#l34.47"></a><span id="l34.47"> #else</span>
<a href="#l34.48"></a><span id="l34.48">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l34.49"></a><span id="l34.49">         &lt;checkbox id=&quot;newMailNotificationAlert&quot;</span>
<a href="#l34.50"></a><span id="l34.50">                   label=&quot;&amp;showAnimatedAlert.label;&quot;</span>
<a href="#l34.51"></a><span id="l34.51">                   accesskey=&quot;&amp;showAnimatedAlert.accesskey;&quot;</span>
<a href="#l34.52"></a><span id="l34.52" class="difflineminus">-                  preference=&quot;mail.biff.show_alert&quot;</span>
<a href="#l34.53"></a><span id="l34.53" class="difflineminus">-                  oncommand=&quot;gGeneralPane.updateCustomizeAlert();&quot;/&gt;</span>
<a href="#l34.54"></a><span id="l34.54" class="difflineplus">+                  preference=&quot;mail.biff.show_alert&quot;/&gt;</span>
<a href="#l34.55"></a><span id="l34.55">         &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l34.56"></a><span id="l34.56">         &lt;button id=&quot;customizeMailAlert&quot; label=&quot;&amp;customizeMailAlert.label;&quot; accesskey=&quot;&amp;customizeMailAlert.accesskey;&quot;</span>
<a href="#l34.57"></a><span id="l34.57">                 oncommand=&quot;gGeneralPane.customizeMailAlert();&quot;/&gt;</span>
<a href="#l34.58"></a><span id="l34.58">       &lt;/hbox&gt;</span>
<a href="#l34.59"></a><span id="l34.59">       &lt;hbox&gt;</span>
<a href="#l34.60"></a><span id="l34.60">         &lt;checkbox id=&quot;newMailNotificationTrayIcon&quot; label=&quot;&amp;showTrayIcon.label;&quot;</span>
<a href="#l34.61"></a><span id="l34.61"> #ifndef XP_WIN</span>
<a href="#l34.62"></a><span id="l34.62">                   hidden=&quot;true&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/components/preferences/general.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/components/preferences/general.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -3,46 +3,68 @@</span>
<a href="#l35.4"></a><span id="l35.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.5"></a><span id="l35.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.6"></a><span id="l35.6"> </span>
<a href="#l35.7"></a><span id="l35.7"> &quot;use strict&quot;;</span>
<a href="#l35.8"></a><span id="l35.8"> </span>
<a href="#l35.9"></a><span id="l35.9"> /* import-globals-from preferences.js */</span>
<a href="#l35.10"></a><span id="l35.10"> /* import-globals-from subdialogs.js */</span>
<a href="#l35.11"></a><span id="l35.11"> </span>
<a href="#l35.12"></a><span id="l35.12" class="difflineplus">+var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+Preferences.addAll([</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineplus">+  { id: &quot;mail.pane_config.dynamic&quot;, type: &quot;int&quot; },</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineplus">+  { id: &quot;mailnews.reuse_message_window&quot;, type: &quot;bool&quot; },</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineplus">+  { id: &quot;mailnews.start_page.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineplus">+  { id: &quot;mailnews.start_page.url&quot;, type: &quot;string&quot; },</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineplus">+  { id: &quot;mail.biff.show_tray_icon&quot;, type: &quot;bool&quot;  },</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineplus">+  { id: &quot;mail.biff.play_sound&quot;, type: &quot;bool&quot; },</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineplus">+  { id: &quot;mail.biff.play_sound.type&quot;, type: &quot;int&quot; },</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineplus">+  { id: &quot;mail.biff.play_sound.url&quot;, type: &quot;string&quot; },</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineplus">+]);</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineplus">+if (AppConstants.platform != &quot;macosx&quot;) {</span>
<a href="#l35.25"></a><span id="l35.25" class="difflineplus">+  Preferences.add({ id: &quot;mail.biff.show_alert&quot;, type: &quot;bool&quot; });</span>
<a href="#l35.26"></a><span id="l35.26" class="difflineplus">+}</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+</span>
<a href="#l35.28"></a><span id="l35.28"> document.getElementById(&quot;paneGeneral&quot;)</span>
<a href="#l35.29"></a><span id="l35.29">         .addEventListener(&quot;paneload&quot;, function() { gGeneralPane.init(); });</span>
<a href="#l35.30"></a><span id="l35.30"> </span>
<a href="#l35.31"></a><span id="l35.31"> var gGeneralPane = {</span>
<a href="#l35.32"></a><span id="l35.32">   mPane: null,</span>
<a href="#l35.33"></a><span id="l35.33">   mStartPageUrl: &quot;&quot;,</span>
<a href="#l35.34"></a><span id="l35.34"> </span>
<a href="#l35.35"></a><span id="l35.35">   init() {</span>
<a href="#l35.36"></a><span id="l35.36">     this.mPane = document.getElementById(&quot;paneGeneral&quot;);</span>
<a href="#l35.37"></a><span id="l35.37"> </span>
<a href="#l35.38"></a><span id="l35.38">     this.updateStartPage();</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineminus">-    this.updatePlaySound();</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineminus">-    this.updateCustomizeAlert();</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineplus">+    this.updatePlaySound(</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineplus">+      !Preferences.get(&quot;mail.biff.play_sound&quot;).value,</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+      Preferences.get(&quot;mail.biff.play_sound.url&quot;).value,</span>
<a href="#l35.44"></a><span id="l35.44" class="difflineplus">+      Preferences.get(&quot;mail.biff.play_sound.type&quot;).value</span>
<a href="#l35.45"></a><span id="l35.45" class="difflineplus">+    );</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineplus">+    if (AppConstants.platform != &quot;macosx&quot;) {</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineplus">+      this.updateCustomizeAlert();</span>
<a href="#l35.48"></a><span id="l35.48" class="difflineplus">+    }</span>
<a href="#l35.49"></a><span id="l35.49">     this.updateWebSearch();</span>
<a href="#l35.50"></a><span id="l35.50">   },</span>
<a href="#l35.51"></a><span id="l35.51"> </span>
<a href="#l35.52"></a><span id="l35.52">   /**</span>
<a href="#l35.53"></a><span id="l35.53">    * Restores the default start page as the user's start page</span>
<a href="#l35.54"></a><span id="l35.54">    */</span>
<a href="#l35.55"></a><span id="l35.55">   restoreDefaultStartPage() {</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineminus">-    var startPage = document.getElementById(&quot;mailnews.start_page.url&quot;);</span>
<a href="#l35.57"></a><span id="l35.57" class="difflineplus">+    var startPage = Preferences.get(&quot;mailnews.start_page.url&quot;);</span>
<a href="#l35.58"></a><span id="l35.58">     startPage.value = startPage.defaultValue;</span>
<a href="#l35.59"></a><span id="l35.59">   },</span>
<a href="#l35.60"></a><span id="l35.60"> </span>
<a href="#l35.61"></a><span id="l35.61">   /**</span>
<a href="#l35.62"></a><span id="l35.62">    * Returns a formatted url corresponding to the value of mailnews.start_page.url</span>
<a href="#l35.63"></a><span id="l35.63">    * Stores the original value of mailnews.start_page.url</span>
<a href="#l35.64"></a><span id="l35.64">    */</span>
<a href="#l35.65"></a><span id="l35.65">   readStartPageUrl() {</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineminus">-    var pref = document.getElementById(&quot;mailnews.start_page.url&quot;);</span>
<a href="#l35.67"></a><span id="l35.67" class="difflineplus">+    var pref = Preferences.get(&quot;mailnews.start_page.url&quot;);</span>
<a href="#l35.68"></a><span id="l35.68">     this.mStartPageUrl = pref.value;</span>
<a href="#l35.69"></a><span id="l35.69">     return Services.urlFormatter.formatURL(this.mStartPageUrl);</span>
<a href="#l35.70"></a><span id="l35.70">   },</span>
<a href="#l35.71"></a><span id="l35.71"> </span>
<a href="#l35.72"></a><span id="l35.72">   /**</span>
<a href="#l35.73"></a><span id="l35.73">    * Returns the value of the mailnews start page url represented by the UI.</span>
<a href="#l35.74"></a><span id="l35.74">    * If the url matches the formatted version of our stored value, then</span>
<a href="#l35.75"></a><span id="l35.75">    * return the unformatted url.</span>
<a href="#l35.76"></a><span id="l35.76" class="difflineat">@@ -70,17 +92,17 @@ var gGeneralPane = {</span>
<a href="#l35.77"></a><span id="l35.77">                      .QueryInterface(Ci.nsIFileProtocolHandler)</span>
<a href="#l35.78"></a><span id="l35.78">                      .getFileFromURLSpec(aFileURL);</span>
<a href="#l35.79"></a><span id="l35.79">     }</span>
<a href="#l35.80"></a><span id="l35.80">     return null;</span>
<a href="#l35.81"></a><span id="l35.81">   },</span>
<a href="#l35.82"></a><span id="l35.82"> </span>
<a href="#l35.83"></a><span id="l35.83">   readSoundLocation() {</span>
<a href="#l35.84"></a><span id="l35.84">     var soundUrlLocation = document.getElementById(&quot;soundUrlLocation&quot;);</span>
<a href="#l35.85"></a><span id="l35.85" class="difflineminus">-    soundUrlLocation.value = document.getElementById(&quot;mail.biff.play_sound.url&quot;).value;</span>
<a href="#l35.86"></a><span id="l35.86" class="difflineplus">+    soundUrlLocation.value = Preferences.get(&quot;mail.biff.play_sound.url&quot;).value;</span>
<a href="#l35.87"></a><span id="l35.87">     if (soundUrlLocation.value) {</span>
<a href="#l35.88"></a><span id="l35.88">       soundUrlLocation.label = this.convertURLToLocalFile(soundUrlLocation.value).leafName;</span>
<a href="#l35.89"></a><span id="l35.89">       soundUrlLocation.style.backgroundImage = &quot;url(moz-icon://&quot; + soundUrlLocation.label + &quot;?size=16)&quot;;</span>
<a href="#l35.90"></a><span id="l35.90">     }</span>
<a href="#l35.91"></a><span id="l35.91">     return undefined;</span>
<a href="#l35.92"></a><span id="l35.92">   },</span>
<a href="#l35.93"></a><span id="l35.93"> </span>
<a href="#l35.94"></a><span id="l35.94">   previewSound() {</span>
<a href="#l35.95"></a><span id="l35.95" class="difflineat">@@ -126,62 +148,67 @@ var gGeneralPane = {</span>
<a href="#l35.96"></a><span id="l35.96">     else</span>
<a href="#l35.97"></a><span id="l35.97">       fp.appendFilter(soundFilesText, &quot;*.wav&quot;);</span>
<a href="#l35.98"></a><span id="l35.98"> </span>
<a href="#l35.99"></a><span id="l35.99">     fp.open(rv =&gt; {</span>
<a href="#l35.100"></a><span id="l35.100">       if (rv != nsIFilePicker.returnOK || !fp.file) {</span>
<a href="#l35.101"></a><span id="l35.101">         return;</span>
<a href="#l35.102"></a><span id="l35.102">       }</span>
<a href="#l35.103"></a><span id="l35.103">       // convert the nsIFile into a nsIFile url</span>
<a href="#l35.104"></a><span id="l35.104" class="difflineminus">-      document.getElementById(&quot;mail.biff.play_sound.url&quot;).value = fp.fileURL.spec;</span>
<a href="#l35.105"></a><span id="l35.105" class="difflineplus">+      Preferences.get(&quot;mail.biff.play_sound.url&quot;).value = fp.fileURL.spec;</span>
<a href="#l35.106"></a><span id="l35.106">       this.readSoundLocation(); // XXX We shouldn't have to be doing this by hand</span>
<a href="#l35.107"></a><span id="l35.107">       this.updatePlaySound();</span>
<a href="#l35.108"></a><span id="l35.108">     });</span>
<a href="#l35.109"></a><span id="l35.109">   },</span>
<a href="#l35.110"></a><span id="l35.110"> </span>
<a href="#l35.111"></a><span id="l35.111" class="difflineminus">-  updatePlaySound() {</span>
<a href="#l35.112"></a><span id="l35.112" class="difflineplus">+  updatePlaySound(soundsDisabled, soundUrlLocation, soundType) {</span>
<a href="#l35.113"></a><span id="l35.113">     // Update the sound type radio buttons based on the state of the</span>
<a href="#l35.114"></a><span id="l35.114">     // play sound checkbox.</span>
<a href="#l35.115"></a><span id="l35.115" class="difflineminus">-    var soundsDisabled = !document.getElementById(&quot;newMailNotification&quot;).checked;</span>
<a href="#l35.116"></a><span id="l35.116" class="difflineminus">-    var soundUrlLocation = document.getElementById(&quot;soundUrlLocation&quot;).value;</span>
<a href="#l35.117"></a><span id="l35.117" class="difflineplus">+    if (soundsDisabled === undefined) {</span>
<a href="#l35.118"></a><span id="l35.118" class="difflineplus">+      soundsDisabled = !document.getElementById(&quot;newMailNotification&quot;).checked;</span>
<a href="#l35.119"></a><span id="l35.119" class="difflineplus">+      soundUrlLocation = document.getElementById(&quot;soundUrlLocation&quot;).value;</span>
<a href="#l35.120"></a><span id="l35.120" class="difflineplus">+    }</span>
<a href="#l35.121"></a><span id="l35.121"> </span>
<a href="#l35.122"></a><span id="l35.122">     // The UI is different on OS X as the user can only choose between letting</span>
<a href="#l35.123"></a><span id="l35.123">     // the system play a default sound or setting a custom one. Therefore,</span>
<a href="#l35.124"></a><span id="l35.124">     // &quot;soundTypeEl&quot; does not exist on OS X.</span>
<a href="#l35.125"></a><span id="l35.125">     if (AppConstants.platform != &quot;macosx&quot;) {</span>
<a href="#l35.126"></a><span id="l35.126">       var soundTypeEl = document.getElementById(&quot;soundType&quot;);</span>
<a href="#l35.127"></a><span id="l35.127" class="difflineplus">+      if (soundType === undefined) {</span>
<a href="#l35.128"></a><span id="l35.128" class="difflineplus">+        soundType = soundTypeEl.value;</span>
<a href="#l35.129"></a><span id="l35.129" class="difflineplus">+      }</span>
<a href="#l35.130"></a><span id="l35.130" class="difflineplus">+</span>
<a href="#l35.131"></a><span id="l35.131">       soundTypeEl.disabled = soundsDisabled;</span>
<a href="#l35.132"></a><span id="l35.132">       document.getElementById(&quot;soundUrlLocation&quot;).disabled =</span>
<a href="#l35.133"></a><span id="l35.133" class="difflineminus">-        soundsDisabled || soundTypeEl.value != 1;</span>
<a href="#l35.134"></a><span id="l35.134" class="difflineplus">+        soundsDisabled || soundType != 1;</span>
<a href="#l35.135"></a><span id="l35.135">       document.getElementById(&quot;playSound&quot;).disabled =</span>
<a href="#l35.136"></a><span id="l35.136" class="difflineminus">-        soundsDisabled || (!soundUrlLocation &amp;&amp; soundTypeEl.value != 0);</span>
<a href="#l35.137"></a><span id="l35.137" class="difflineplus">+        soundsDisabled || (!soundUrlLocation &amp;&amp; soundType != 0);</span>
<a href="#l35.138"></a><span id="l35.138">     } else {</span>
<a href="#l35.139"></a><span id="l35.139">       // On OS X, if there is no selected custom sound then default one will</span>
<a href="#l35.140"></a><span id="l35.140">       // be played. We keep consistency by disabling the &quot;Play sound&quot; checkbox</span>
<a href="#l35.141"></a><span id="l35.141">       // if the user hasn't selected a custom sound file yet.</span>
<a href="#l35.142"></a><span id="l35.142">       document.getElementById(&quot;newMailNotification&quot;).disabled = !soundUrlLocation;</span>
<a href="#l35.143"></a><span id="l35.143">       document.getElementById(&quot;playSound&quot;).disabled = !soundUrlLocation;</span>
<a href="#l35.144"></a><span id="l35.144">       // The sound type radiogroup is hidden, but we have to keep the</span>
<a href="#l35.145"></a><span id="l35.145">       // play_sound.type pref set appropriately.</span>
<a href="#l35.146"></a><span id="l35.146" class="difflineminus">-      document.getElementById(&quot;mail.biff.play_sound.type&quot;).value =</span>
<a href="#l35.147"></a><span id="l35.147" class="difflineplus">+      Preferences.get(&quot;mail.biff.play_sound.type&quot;).value =</span>
<a href="#l35.148"></a><span id="l35.148">         (!soundsDisabled &amp;&amp; soundUrlLocation) ? 1 : 0;</span>
<a href="#l35.149"></a><span id="l35.149">     }</span>
<a href="#l35.150"></a><span id="l35.150">   },</span>
<a href="#l35.151"></a><span id="l35.151"> </span>
<a href="#l35.152"></a><span id="l35.152">   updateStartPage() {</span>
<a href="#l35.153"></a><span id="l35.153">     document.getElementById(&quot;mailnewsStartPageUrl&quot;).disabled =</span>
<a href="#l35.154"></a><span id="l35.154" class="difflineminus">-      !document.getElementById(&quot;mailnewsStartPageEnabled&quot;).checked;</span>
<a href="#l35.155"></a><span id="l35.155" class="difflineplus">+      !Preferences.get(&quot;mailnews.start_page.enabled&quot;).value;</span>
<a href="#l35.156"></a><span id="l35.156">   },</span>
<a href="#l35.157"></a><span id="l35.157"> </span>
<a href="#l35.158"></a><span id="l35.158">   updateCustomizeAlert() {</span>
<a href="#l35.159"></a><span id="l35.159">     // The button does not exist on all platforms.</span>
<a href="#l35.160"></a><span id="l35.160">     let customizeAlertButton = document.getElementById(&quot;customizeMailAlert&quot;);</span>
<a href="#l35.161"></a><span id="l35.161">     if (customizeAlertButton) {</span>
<a href="#l35.162"></a><span id="l35.162" class="difflineminus">-      customizeAlertButton.disabled =</span>
<a href="#l35.163"></a><span id="l35.163" class="difflineminus">-        !document.getElementById(&quot;newMailNotificationAlert&quot;).checked;</span>
<a href="#l35.164"></a><span id="l35.164" class="difflineplus">+      customizeAlertButton.disabled = !Preferences.get(&quot;mail.biff.show_alert&quot;).value;</span>
<a href="#l35.165"></a><span id="l35.165">     }</span>
<a href="#l35.166"></a><span id="l35.166">   },</span>
<a href="#l35.167"></a><span id="l35.167"> </span>
<a href="#l35.168"></a><span id="l35.168">   updateWebSearch() {</span>
<a href="#l35.169"></a><span id="l35.169">     Services.search.init().then(async () =&gt; {</span>
<a href="#l35.170"></a><span id="l35.170">       let defaultEngine = await Services.search.getDefault();</span>
<a href="#l35.171"></a><span id="l35.171">       let engineList = document.getElementById(&quot;defaultWebSearch&quot;);</span>
<a href="#l35.172"></a><span id="l35.172">       for (let engine of await Services.search.getVisibleEngines()) {</span>
<a href="#l35.173"></a><span id="l35.173" class="difflineat">@@ -197,8 +224,13 @@ var gGeneralPane = {</span>
<a href="#l35.174"></a><span id="l35.174">       }</span>
<a href="#l35.175"></a><span id="l35.175"> </span>
<a href="#l35.176"></a><span id="l35.176">       engineList.addEventListener(&quot;command&quot;, () =&gt; {</span>
<a href="#l35.177"></a><span id="l35.177">         Services.search.setDefault(engineList.selectedItem.engine);</span>
<a href="#l35.178"></a><span id="l35.178">       });</span>
<a href="#l35.179"></a><span id="l35.179">     });</span>
<a href="#l35.180"></a><span id="l35.180">   },</span>
<a href="#l35.181"></a><span id="l35.181"> };</span>
<a href="#l35.182"></a><span id="l35.182" class="difflineplus">+</span>
<a href="#l35.183"></a><span id="l35.183" class="difflineplus">+Preferences.get(&quot;mailnews.start_page.enabled&quot;).on(&quot;change&quot;, gGeneralPane.updateStartPage);</span>
<a href="#l35.184"></a><span id="l35.184" class="difflineplus">+if (AppConstants.platform != &quot;macosx&quot;) {</span>
<a href="#l35.185"></a><span id="l35.185" class="difflineplus">+  Preferences.get(&quot;mail.biff.show_alert&quot;).on(&quot;change&quot;, gGeneralPane.updateCustomizeAlert);</span>
<a href="#l35.186"></a><span id="l35.186" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mail/components/preferences/jar.mn</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mail/components/preferences/jar.mn</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,27 +1,29 @@</span>
<a href="#l36.4"></a><span id="l36.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l36.5"></a><span id="l36.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l36.6"></a><span id="l36.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8"> messenger.jar:</span>
<a href="#l36.9"></a><span id="l36.9"> *   content/messenger/preferences/aboutPreferences.xul</span>
<a href="#l36.10"></a><span id="l36.10">     content/messenger/preferences/preferences.css</span>
<a href="#l36.11"></a><span id="l36.11">     content/messenger/preferences/preferences.js</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-*   content/messenger/preferences/preferences.xml       (../../../common/bindings/preferences.xml)</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+    content/messenger/preferences/preferences.xml</span>
<a href="#l36.14"></a><span id="l36.14">     content/messenger/preferences/preferencesTab.js</span>
<a href="#l36.15"></a><span id="l36.15">     content/messenger/preferences/general.js</span>
<a href="#l36.16"></a><span id="l36.16"> #ifdef XP_MACOSX</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineplus">+    content/messenger/preferences/dockoptions.js</span>
<a href="#l36.18"></a><span id="l36.18">     content/messenger/preferences/dockoptions.xul</span>
<a href="#l36.19"></a><span id="l36.19"> #endif</span>
<a href="#l36.20"></a><span id="l36.20">     content/messenger/preferences/display.js</span>
<a href="#l36.21"></a><span id="l36.21">     content/messenger/preferences/chat.js</span>
<a href="#l36.22"></a><span id="l36.22">     content/messenger/preferences/messagestyle.js</span>
<a href="#l36.23"></a><span id="l36.23">     content/messenger/preferences/messengerLanguages.js</span>
<a href="#l36.24"></a><span id="l36.24">     content/messenger/preferences/messengerLanguages.xul</span>
<a href="#l36.25"></a><span id="l36.25" class="difflineplus">+    content/messenger/preferences/colors.js</span>
<a href="#l36.26"></a><span id="l36.26"> *   content/messenger/preferences/colors.xul</span>
<a href="#l36.27"></a><span id="l36.27">     content/messenger/preferences/compose.js</span>
<a href="#l36.28"></a><span id="l36.28">     content/messenger/preferences/privacy.js</span>
<a href="#l36.29"></a><span id="l36.29">     content/messenger/preferences/sendoptions.xul</span>
<a href="#l36.30"></a><span id="l36.30">     content/messenger/preferences/sendoptions.js</span>
<a href="#l36.31"></a><span id="l36.31">     content/messenger/preferences/security.js</span>
<a href="#l36.32"></a><span id="l36.32">     content/messenger/preferences/advanced.js</span>
<a href="#l36.33"></a><span id="l36.33">     content/messenger/preferences/receipts.js</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineat">@@ -34,16 +36,17 @@ messenger.jar:</span>
<a href="#l36.35"></a><span id="l36.35">     content/messenger/preferences/applications.js</span>
<a href="#l36.36"></a><span id="l36.36">     content/messenger/preferences/applicationManager.xul</span>
<a href="#l36.37"></a><span id="l36.37">     content/messenger/preferences/applicationManager.js</span>
<a href="#l36.38"></a><span id="l36.38">     content/messenger/preferences/handlers.css</span>
<a href="#l36.39"></a><span id="l36.39">     content/messenger/preferences/actionsshared.js</span>
<a href="#l36.40"></a><span id="l36.40">     content/messenger/preferences/fonts.js</span>
<a href="#l36.41"></a><span id="l36.41">     content/messenger/preferences/fonts.xul</span>
<a href="#l36.42"></a><span id="l36.42"> #ifndef XP_MACOSX</span>
<a href="#l36.43"></a><span id="l36.43" class="difflineplus">+    content/messenger/preferences/notifications.js</span>
<a href="#l36.44"></a><span id="l36.44">     content/messenger/preferences/notifications.xul</span>
<a href="#l36.45"></a><span id="l36.45"> #endif</span>
<a href="#l36.46"></a><span id="l36.46">     content/messenger/preferences/offline.js</span>
<a href="#l36.47"></a><span id="l36.47">     content/messenger/preferences/offline.xul</span>
<a href="#l36.48"></a><span id="l36.48">     content/messenger/preferences/cookies.js</span>
<a href="#l36.49"></a><span id="l36.49"> *   content/messenger/preferences/cookies.xul</span>
<a href="#l36.50"></a><span id="l36.50">     content/messenger/preferences/permissions.js</span>
<a href="#l36.51"></a><span id="l36.51">     content/messenger/preferences/permissions.xul</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mail/components/preferences/messagestyle.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mail/components/preferences/messagestyle.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -59,18 +59,24 @@ var previewObserver = {</span>
<a href="#l37.4"></a><span id="l37.4">     ];</span>
<a href="#l37.5"></a><span id="l37.5">     previewObserver.conv = conv;</span>
<a href="#l37.6"></a><span id="l37.6"> </span>
<a href="#l37.7"></a><span id="l37.7">     let themeName = document.getElementById(&quot;messagestyle-themename&quot;);</span>
<a href="#l37.8"></a><span id="l37.8">     previewObserver.browser = document.getElementById(&quot;previewbrowser&quot;);</span>
<a href="#l37.9"></a><span id="l37.9">     document.getElementById(&quot;showHeaderCheckbox&quot;)</span>
<a href="#l37.10"></a><span id="l37.10">             .addEventListener(&quot;CheckboxStateChange&quot;,</span>
<a href="#l37.11"></a><span id="l37.11">                               previewObserver.showHeaderChanged);</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-    previewObserver.displayTheme(themeName.value);</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-    this._loaded = true;</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+</span>
<a href="#l37.15"></a><span id="l37.15" class="difflineplus">+    // If the preferences tab is opened straight to the message styles,</span>
<a href="#l37.16"></a><span id="l37.16" class="difflineplus">+    // loading the preview fails. Pushing this to back of the event queue</span>
<a href="#l37.17"></a><span id="l37.17" class="difflineplus">+    // prevents that failure.</span>
<a href="#l37.18"></a><span id="l37.18" class="difflineplus">+    setTimeout(() =&gt; {</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineplus">+      previewObserver.displayTheme(themeName.value);</span>
<a href="#l37.20"></a><span id="l37.20" class="difflineplus">+      this._loaded = true;</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineplus">+    });</span>
<a href="#l37.22"></a><span id="l37.22">   },</span>
<a href="#l37.23"></a><span id="l37.23"> </span>
<a href="#l37.24"></a><span id="l37.24">   showHeaderChanged() {</span>
<a href="#l37.25"></a><span id="l37.25">     if (!previewObserver._loaded)</span>
<a href="#l37.26"></a><span id="l37.26">       return;</span>
<a href="#l37.27"></a><span id="l37.27"> </span>
<a href="#l37.28"></a><span id="l37.28">     previewObserver.theme.showHeader = this.checked;</span>
<a href="#l37.29"></a><span id="l37.29">     previewObserver.reloadPreview();</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineat">@@ -104,18 +110,18 @@ var previewObserver = {</span>
<a href="#l37.31"></a><span id="l37.31">     try {</span>
<a href="#l37.32"></a><span id="l37.32">       this.theme = getThemeByName(aTheme);</span>
<a href="#l37.33"></a><span id="l37.33">     } catch (e) {</span>
<a href="#l37.34"></a><span id="l37.34">       document.getElementById(&quot;previewDeck&quot;).selectedIndex = 0;</span>
<a href="#l37.35"></a><span id="l37.35">       return;</span>
<a href="#l37.36"></a><span id="l37.36">     }</span>
<a href="#l37.37"></a><span id="l37.37"> </span>
<a href="#l37.38"></a><span id="l37.38">     let menulist = document.getElementById(&quot;themevariant&quot;);</span>
<a href="#l37.39"></a><span id="l37.39" class="difflineminus">-    if (menulist.firstChild)</span>
<a href="#l37.40"></a><span id="l37.40" class="difflineminus">-      menulist.firstChild.remove();</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineplus">+    if (menulist.menupopup)</span>
<a href="#l37.42"></a><span id="l37.42" class="difflineplus">+      menulist.menupopup.remove();</span>
<a href="#l37.43"></a><span id="l37.43">     let popup = menulist.appendChild(document.createElement(&quot;menupopup&quot;));</span>
<a href="#l37.44"></a><span id="l37.44">     let variants = getThemeVariants(this.theme);</span>
<a href="#l37.45"></a><span id="l37.45"> </span>
<a href="#l37.46"></a><span id="l37.46">     let defaultVariant = &quot;&quot;;</span>
<a href="#l37.47"></a><span id="l37.47">     if ((&quot;DefaultVariant&quot; in this.theme.metadata) &amp;&amp;</span>
<a href="#l37.48"></a><span id="l37.48">         variants.includes(this.theme.metadata.DefaultVariant))</span>
<a href="#l37.49"></a><span id="l37.49">       defaultVariant = this.theme.metadata.DefaultVariant.replace(/_/g, &quot; &quot;);</span>
<a href="#l37.50"></a><span id="l37.50"> </span>
<a href="#l37.51"></a><span id="l37.51" class="difflineat">@@ -141,17 +147,17 @@ var previewObserver = {</span>
<a href="#l37.52"></a><span id="l37.52">         popup.appendChild(menuitem);</span>
<a href="#l37.53"></a><span id="l37.53">       }</span>
<a href="#l37.54"></a><span id="l37.54">     });</span>
<a href="#l37.55"></a><span id="l37.55">     this._ignoreVariantChange = true;</span>
<a href="#l37.56"></a><span id="l37.56">     if (!this._loaded) {</span>
<a href="#l37.57"></a><span id="l37.57">       menulist.value = this.theme.variant = menulist.value;</span>
<a href="#l37.58"></a><span id="l37.58">     } else {</span>
<a href="#l37.59"></a><span id="l37.59">       menulist.value = this.theme.variant; // (reset to &quot;default&quot;)</span>
<a href="#l37.60"></a><span id="l37.60" class="difflineminus">-      document.getElementById(&quot;paneChat&quot;).userChangedValue(menulist);</span>
<a href="#l37.61"></a><span id="l37.61" class="difflineplus">+      Preferences.userChangedValue(menulist);</span>
<a href="#l37.62"></a><span id="l37.62">     }</span>
<a href="#l37.63"></a><span id="l37.63">     this._ignoreVariantChange = false;</span>
<a href="#l37.64"></a><span id="l37.64"> </span>
<a href="#l37.65"></a><span id="l37.65">     // disable the variant menulist if there's no variant, or only one</span>
<a href="#l37.66"></a><span id="l37.66">     // which is the default</span>
<a href="#l37.67"></a><span id="l37.67">     menulist.disabled = variants.length == 0 ||</span>
<a href="#l37.68"></a><span id="l37.68">                         variants.length == 1 &amp;&amp; defaultVariant;</span>
<a href="#l37.69"></a><span id="l37.69"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1">new file mode 100644</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineminus">--- /dev/null</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineplus">+++ b/mail/components/preferences/notifications.js</span>
<a href="#l38.4"></a><span id="l38.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l38.5"></a><span id="l38.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l38.6"></a><span id="l38.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l38.7"></a><span id="l38.7" class="difflineplus">+ * file, you can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l38.8"></a><span id="l38.8" class="difflineplus">+</span>
<a href="#l38.9"></a><span id="l38.9" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l38.10"></a><span id="l38.10" class="difflineplus">+</span>
<a href="#l38.11"></a><span id="l38.11" class="difflineplus">+Preferences.addAll([</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineplus">+  { id: &quot;mail.biff.alert.show_preview&quot;, type: &quot;bool&quot; },</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+  { id: &quot;mail.biff.alert.show_subject&quot;, type: &quot;bool&quot; },</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+  { id: &quot;mail.biff.alert.show_sender&quot;, type: &quot;bool&quot; },</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineplus">+  { id: &quot;alerts.totalOpenTime&quot;, type: &quot;int&quot; },</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineplus">+]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mail/components/preferences/notifications.xul</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mail/components/preferences/notifications.xul</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -3,47 +3,41 @@</span>
<a href="#l39.4"></a><span id="l39.4"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l39.5"></a><span id="l39.5">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l39.6"></a><span id="l39.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l39.7"></a><span id="l39.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l39.8"></a><span id="l39.8"> </span>
<a href="#l39.9"></a><span id="l39.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l39.10"></a><span id="l39.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l39.14"></a><span id="l39.14">   &lt;!ENTITY % notificationsDTD SYSTEM &quot;chrome://messenger/locale/preferences/notifications.dtd&quot;&gt;</span>
<a href="#l39.15"></a><span id="l39.15">   %notificationsDTD;</span>
<a href="#l39.16"></a><span id="l39.16"> ]&gt;</span>
<a href="#l39.17"></a><span id="l39.17"> </span>
<a href="#l39.18"></a><span id="l39.18" class="difflineminus">-&lt;prefwindow id=&quot;NotificationsDialog&quot; type=&quot;child&quot;</span>
<a href="#l39.19"></a><span id="l39.19" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l39.20"></a><span id="l39.20" class="difflineminus">-            dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l39.21"></a><span id="l39.21" class="difflineminus">-            title=&quot;&amp;notificationsDialog2.title;&quot;&gt;</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineminus">-</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineplus">+&lt;dialog id=&quot;NotificationsDialog&quot; type=&quot;child&quot;</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineplus">+        dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineplus">+        title=&quot;&amp;notificationsDialog2.title;&quot;&gt;</span>
<a href="#l39.27"></a><span id="l39.27">   &lt;prefpane id=&quot;NotificationsDialogPane&quot;&gt;</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineminus">-    &lt;preferences id=&quot;NotificationsPreferences&quot;&gt;</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineminus">-      &lt;preference id=&quot;mail.biff.alert.show_preview&quot; name=&quot;mail.biff.alert.show_preview&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineminus">-      &lt;preference id=&quot;mail.biff.alert.show_subject&quot; name=&quot;mail.biff.alert.show_subject&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-      &lt;preference id=&quot;mail.biff.alert.show_sender&quot; name=&quot;mail.biff.alert.show_sender&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineminus">-      &lt;preference id=&quot;alerts.totalOpenTime&quot; name=&quot;alerts.totalOpenTime&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineminus">-</span>
<a href="#l39.35"></a><span id="l39.35">     &lt;description&gt;&amp;alertCustomization.intro;&lt;/description&gt;</span>
<a href="#l39.36"></a><span id="l39.36">     &lt;checkbox id=&quot;previewText&quot; class=&quot;indent&quot; label=&quot;&amp;previewText.label;&quot; accesskey=&quot;&amp;previewText.accesskey;&quot; preference=&quot;mail.biff.alert.show_preview&quot;/&gt;</span>
<a href="#l39.37"></a><span id="l39.37">     &lt;checkbox id=&quot;subject&quot; class=&quot;indent&quot; label=&quot;&amp;subject.label;&quot; accesskey=&quot;&amp;subject.accesskey;&quot; preference=&quot;mail.biff.alert.show_subject&quot;/&gt;</span>
<a href="#l39.38"></a><span id="l39.38">     &lt;checkbox id=&quot;sender&quot;  class=&quot;indent&quot; label=&quot;&amp;sender.label;&quot; accesskey=&quot;&amp;sender.accesskey;&quot; preference=&quot;mail.biff.alert.show_sender&quot;/&gt;</span>
<a href="#l39.39"></a><span id="l39.39"> </span>
<a href="#l39.40"></a><span id="l39.40">     &lt;separator/&gt;</span>
<a href="#l39.41"></a><span id="l39.41">     &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l39.42"></a><span id="l39.42">       &lt;label id=&quot;totalOpenTimeBefore&quot;</span>
<a href="#l39.43"></a><span id="l39.43">              control=&quot;totalOpenTime&quot;</span>
<a href="#l39.44"></a><span id="l39.44">              value=&quot;&amp;totalOpenTimeBefore.label;&quot;</span>
<a href="#l39.45"></a><span id="l39.45">              accesskey=&quot;&amp;totalOpenTimeBefore.accesskey;&quot;/&gt;</span>
<a href="#l39.46"></a><span id="l39.46">       &lt;textbox id=&quot;totalOpenTime&quot; type=&quot;number&quot; size=&quot;3&quot; min=&quot;1&quot; max=&quot;3600&quot; increment=&quot;1&quot;</span>
<a href="#l39.47"></a><span id="l39.47">                preference=&quot;alerts.totalOpenTime&quot;</span>
<a href="#l39.48"></a><span id="l39.48" class="difflineminus">-               onsyncfrompreference=&quot;return document.getElementById(this.getAttribute('preference')).value / 1000;&quot;</span>
<a href="#l39.49"></a><span id="l39.49" class="difflineplus">+               onsyncfrompreference=&quot;return Preferences.get(this.getAttribute('preference')).value / 1000;&quot;</span>
<a href="#l39.50"></a><span id="l39.50">                onsynctopreference=&quot;return this.value * 1000;&quot;/&gt;</span>
<a href="#l39.51"></a><span id="l39.51">       &lt;label id=&quot;totalOpenTimeEnd&quot; value=&quot;&amp;totalOpenTimeEnd.label;&quot;/&gt;</span>
<a href="#l39.52"></a><span id="l39.52">     &lt;/hbox&gt;</span>
<a href="#l39.53"></a><span id="l39.53">     &lt;separator/&gt;</span>
<a href="#l39.54"></a><span id="l39.54" class="difflineplus">+  &lt;/prefpane&gt;</span>
<a href="#l39.55"></a><span id="l39.55"> </span>
<a href="#l39.56"></a><span id="l39.56" class="difflineminus">-  &lt;/prefpane&gt;</span>
<a href="#l39.57"></a><span id="l39.57" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l39.58"></a><span id="l39.58" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l39.59"></a><span id="l39.59" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/notifications.js&quot;/&gt;</span>
<a href="#l39.60"></a><span id="l39.60" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mail/components/preferences/offline.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mail/components/preferences/offline.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -1,20 +1,31 @@</span>
<a href="#l40.4"></a><span id="l40.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l40.5"></a><span id="l40.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l40.6"></a><span id="l40.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l40.7"></a><span id="l40.7"> </span>
<a href="#l40.8"></a><span id="l40.8" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l40.9"></a><span id="l40.9" class="difflineplus">+</span>
<a href="#l40.10"></a><span id="l40.10" class="difflineplus">+Preferences.addAll([</span>
<a href="#l40.11"></a><span id="l40.11" class="difflineplus">+  { id: &quot;offline.autoDetect&quot;, type: &quot;bool&quot; },</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineplus">+  { id: &quot;offline.startup_state&quot;, type: &quot;int&quot; },</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+  { id: &quot;offline.send.unsent_messages&quot;, type: &quot;int&quot; },</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+  { id: &quot;offline.download.download_messages&quot;, type: &quot;int&quot; },</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+]);</span>
<a href="#l40.16"></a><span id="l40.16" class="difflineplus">+</span>
<a href="#l40.17"></a><span id="l40.17"> var kAutomatic         = 4;</span>
<a href="#l40.18"></a><span id="l40.18"> var kRememberLastState = 0;</span>
<a href="#l40.19"></a><span id="l40.19"> </span>
<a href="#l40.20"></a><span id="l40.20"> var gOfflineDialog = {</span>
<a href="#l40.21"></a><span id="l40.21">   dialogSetup() {</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineminus">-    let offlineAutoDetection = document.getElementById(&quot;offline.autoDetect&quot;);</span>
<a href="#l40.23"></a><span id="l40.23" class="difflineminus">-    let offlineStartupStatePref = document.getElementById(&quot;offline.startup_state&quot;);</span>
<a href="#l40.24"></a><span id="l40.24" class="difflineplus">+    let offlineAutoDetection = Preferences.get(&quot;offline.autoDetect&quot;);</span>
<a href="#l40.25"></a><span id="l40.25" class="difflineplus">+    let offlineStartupStatePref = Preferences.get(&quot;offline.startup_state&quot;);</span>
<a href="#l40.26"></a><span id="l40.26"> </span>
<a href="#l40.27"></a><span id="l40.27">     offlineStartupStatePref.disabled = offlineAutoDetection.value;</span>
<a href="#l40.28"></a><span id="l40.28">     if (offlineStartupStatePref.disabled) {</span>
<a href="#l40.29"></a><span id="l40.29">       offlineStartupStatePref.value = kAutomatic;</span>
<a href="#l40.30"></a><span id="l40.30">     } else if (offlineStartupStatePref.value == kAutomatic) {</span>
<a href="#l40.31"></a><span id="l40.31">       offlineStartupStatePref.value = kRememberLastState;</span>
<a href="#l40.32"></a><span id="l40.32">     }</span>
<a href="#l40.33"></a><span id="l40.33">   },</span>
<a href="#l40.34"></a><span id="l40.34"> };</span>
<a href="#l40.35"></a><span id="l40.35" class="difflineplus">+</span>
<a href="#l40.36"></a><span id="l40.36" class="difflineplus">+Preferences.get(&quot;offline.autoDetect&quot;).on(&quot;change&quot;, gOfflineDialog.dialogSetup);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/components/preferences/offline.xul</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/components/preferences/offline.xul</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -2,46 +2,30 @@</span>
<a href="#l41.4"></a><span id="l41.4"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l41.5"></a><span id="l41.5">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l41.6"></a><span id="l41.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l41.7"></a><span id="l41.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l41.8"></a><span id="l41.8"> </span>
<a href="#l41.9"></a><span id="l41.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l41.10"></a><span id="l41.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l41.14"></a><span id="l41.14">   &lt;!ENTITY % offlineDTD SYSTEM &quot;chrome://messenger/locale/preferences/offline.dtd&quot;&gt;</span>
<a href="#l41.15"></a><span id="l41.15">   %offlineDTD;</span>
<a href="#l41.16"></a><span id="l41.16"> ]&gt;</span>
<a href="#l41.17"></a><span id="l41.17"> </span>
<a href="#l41.18"></a><span id="l41.18" class="difflineminus">-&lt;prefwindow id=&quot;OfflineSettingsDialog&quot; type=&quot;child&quot;</span>
<a href="#l41.19"></a><span id="l41.19" class="difflineplus">+&lt;dialog id=&quot;OfflineSettingsDialog&quot; type=&quot;child&quot;</span>
<a href="#l41.20"></a><span id="l41.20">             xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l41.21"></a><span id="l41.21">             onload=&quot;gOfflineDialog.dialogSetup();&quot;</span>
<a href="#l41.22"></a><span id="l41.22">             dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l41.23"></a><span id="l41.23">             title=&quot;&amp;offlineDialog.title;&quot;&gt;</span>
<a href="#l41.24"></a><span id="l41.24"> </span>
<a href="#l41.25"></a><span id="l41.25">   &lt;prefpane id=&quot;OfflineSettingsDialogPane&quot;&gt;</span>
<a href="#l41.26"></a><span id="l41.26" class="difflineminus">-    &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineminus">-            src=&quot;chrome://messenger/content/preferences/offline.js&quot;/&gt;</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineminus">-</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineminus">-    &lt;preferences id=&quot;OfflineSettingsPreferences&quot;&gt;</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineminus">-      &lt;preference id=&quot;offline.autoDetect&quot;</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineminus">-                  name=&quot;offline.autoDetect&quot;</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineminus">-                  type=&quot;bool&quot;</span>
<a href="#l41.33"></a><span id="l41.33" class="difflineminus">-                  onchange=&quot;gOfflineDialog.dialogSetup();&quot;/&gt;</span>
<a href="#l41.34"></a><span id="l41.34" class="difflineminus">-      &lt;preference id=&quot;offline.startup_state&quot;</span>
<a href="#l41.35"></a><span id="l41.35" class="difflineminus">-                  name=&quot;offline.startup_state&quot;</span>
<a href="#l41.36"></a><span id="l41.36" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l41.37"></a><span id="l41.37" class="difflineminus">-      &lt;preference id=&quot;offline.send.unsent_messages&quot;</span>
<a href="#l41.38"></a><span id="l41.38" class="difflineminus">-                  name=&quot;offline.send.unsent_messages&quot;</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l41.40"></a><span id="l41.40" class="difflineminus">-      &lt;preference id=&quot;offline.download.download_messages&quot;</span>
<a href="#l41.41"></a><span id="l41.41" class="difflineminus">-                  name=&quot;offline.download.download_messages&quot;</span>
<a href="#l41.42"></a><span id="l41.42" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l41.43"></a><span id="l41.43" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l41.44"></a><span id="l41.44" class="difflineplus">+    &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l41.45"></a><span id="l41.45" class="difflineplus">+    &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/offline.js&quot;/&gt;</span>
<a href="#l41.46"></a><span id="l41.46"> </span>
<a href="#l41.47"></a><span id="l41.47">     &lt;checkbox label=&quot;&amp;checkAutoDetect.label;&quot;</span>
<a href="#l41.48"></a><span id="l41.48">               accesskey=&quot;&amp;checkAutoDetect.accesskey;&quot;</span>
<a href="#l41.49"></a><span id="l41.49">               preference=&quot;offline.autoDetect&quot;/&gt;</span>
<a href="#l41.50"></a><span id="l41.50"> </span>
<a href="#l41.51"></a><span id="l41.51">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l41.52"></a><span id="l41.52"> </span>
<a href="#l41.53"></a><span id="l41.53">     &lt;label value=&quot;&amp;titleStartUp;&quot; control=&quot;whenStartingUp&quot;/&gt;</span>
<a href="#l41.54"></a><span id="l41.54" class="difflineat">@@ -56,26 +40,26 @@</span>
<a href="#l41.55"></a><span id="l41.55">              accesskey=&quot;&amp;radioAlwaysOffline.accesskey;&quot;/&gt;</span>
<a href="#l41.56"></a><span id="l41.56">       &lt;radio value=&quot;4&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l41.57"></a><span id="l41.57">     &lt;/radiogroup&gt;</span>
<a href="#l41.58"></a><span id="l41.58"> </span>
<a href="#l41.59"></a><span id="l41.59">     &lt;separator/&gt;</span>
<a href="#l41.60"></a><span id="l41.60"> </span>
<a href="#l41.61"></a><span id="l41.61">     &lt;label value=&quot;&amp;textGoingOnline;&quot; control=&quot;whengoingOnlinestate&quot;/&gt;</span>
<a href="#l41.62"></a><span id="l41.62">     &lt;radiogroup id=&quot;whengoingOnlinestate&quot; orient=&quot;horizontal&quot; class=&quot;indent&quot;</span>
<a href="#l41.63"></a><span id="l41.63" class="difflineminus">-                preference =&quot;offline.send.unsent_messages&quot;&gt;</span>
<a href="#l41.64"></a><span id="l41.64" class="difflineplus">+                preference=&quot;offline.send.unsent_messages&quot;&gt;</span>
<a href="#l41.65"></a><span id="l41.65">       &lt;radio value=&quot;1&quot; label=&quot;&amp;radioAutoSend.label;&quot;  accesskey=&quot;&amp;radioAutoSend.accesskey;&quot;/&gt;</span>
<a href="#l41.66"></a><span id="l41.66">       &lt;radio value=&quot;2&quot; label=&quot;&amp;radioNotSend.label;&quot;   accesskey=&quot;&amp;radioNotSend.accesskey;&quot;/&gt;</span>
<a href="#l41.67"></a><span id="l41.67">       &lt;radio value=&quot;0&quot; label=&quot;&amp;radioAskUnsent.label;&quot; accesskey=&quot;&amp;radioAskUnsent.accesskey;&quot;/&gt;</span>
<a href="#l41.68"></a><span id="l41.68">     &lt;/radiogroup&gt;</span>
<a href="#l41.69"></a><span id="l41.69"> </span>
<a href="#l41.70"></a><span id="l41.70">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l41.71"></a><span id="l41.71"> </span>
<a href="#l41.72"></a><span id="l41.72">     &lt;label value=&quot;&amp;textGoingOffline;&quot; control=&quot;whengoingOfflinestate&quot;/&gt;</span>
<a href="#l41.73"></a><span id="l41.73">     &lt;radiogroup id=&quot;whengoingOfflinestate&quot; orient=&quot;horizontal&quot; class=&quot;indent&quot;</span>
<a href="#l41.74"></a><span id="l41.74">                 preference=&quot;offline.download.download_messages&quot;&gt;</span>
<a href="#l41.75"></a><span id="l41.75">       &lt;radio value=&quot;1&quot; label=&quot;&amp;radioAutoDownload.label;&quot; accesskey=&quot;&amp;radioAutoDownload.accesskey;&quot;/&gt;</span>
<a href="#l41.76"></a><span id="l41.76">       &lt;radio value=&quot;2&quot; label=&quot;&amp;radioNotDownload.label;&quot;  accesskey=&quot;&amp;radioNotDownload.accesskey;&quot;/&gt;</span>
<a href="#l41.77"></a><span id="l41.77">       &lt;radio value=&quot;0&quot; label=&quot;&amp;radioAskDownload.label;&quot;  accesskey=&quot;&amp;radioAskDownload.accesskey;&quot;/&gt;</span>
<a href="#l41.78"></a><span id="l41.78">     &lt;/radiogroup&gt;</span>
<a href="#l41.79"></a><span id="l41.79">     &lt;separator/&gt;</span>
<a href="#l41.80"></a><span id="l41.80">   &lt;/prefpane&gt;</span>
<a href="#l41.81"></a><span id="l41.81" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l41.82"></a><span id="l41.82" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/components/preferences/preferences.css</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/components/preferences/preferences.css</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -1,50 +1,11 @@</span>
<a href="#l42.4"></a><span id="l42.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l42.5"></a><span id="l42.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l42.6"></a><span id="l42.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8" class="difflineminus">-prefwindow,</span>
<a href="#l42.9"></a><span id="l42.9" class="difflineminus">-prefwindow:root /* override :root */ {</span>
<a href="#l42.10"></a><span id="l42.10" class="difflineplus">+prefpane {</span>
<a href="#l42.11"></a><span id="l42.11">   -moz-box-orient: vertical;</span>
<a href="#l42.12"></a><span id="l42.12"> }</span>
<a href="#l42.13"></a><span id="l42.13"> </span>
<a href="#l42.14"></a><span id="l42.14" class="difflineminus">-prefpane {</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/preferences/preferences.xml#prefpane&quot;);</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineminus">-  -moz-box-orient: vertical;</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineminus">-}</span>
<a href="#l42.18"></a><span id="l42.18" class="difflineminus">-</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineminus">-prefwindow &gt; .paneDeckContainer {</span>
<a href="#l42.20"></a><span id="l42.20" class="difflineminus">-  overflow: hidden;</span>
<a href="#l42.21"></a><span id="l42.21" class="difflineminus">-}</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineminus">-</span>
<a href="#l42.23"></a><span id="l42.23"> prefpane &gt; .content-box {</span>
<a href="#l42.24"></a><span id="l42.24">   overflow: hidden;</span>
<a href="#l42.25"></a><span id="l42.25"> }</span>
<a href="#l42.26"></a><span id="l42.26" class="difflineminus">-</span>
<a href="#l42.27"></a><span id="l42.27" class="difflineminus">-prefwindow[type=&quot;child&quot;] &gt; .paneDeckContainer {</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineminus">-  overflow: -moz-hidden-unscrollable;</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineminus">-}</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineminus">-</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineminus">-prefwindow[type=&quot;child&quot;] &gt; prefpane &gt; .content-box {</span>
<a href="#l42.32"></a><span id="l42.32" class="difflineminus">-  -moz-box-flex: 1;</span>
<a href="#l42.33"></a><span id="l42.33" class="difflineminus">-  overflow: -moz-hidden-unscrollable;</span>
<a href="#l42.34"></a><span id="l42.34" class="difflineminus">-}</span>
<a href="#l42.35"></a><span id="l42.35" class="difflineminus">-</span>
<a href="#l42.36"></a><span id="l42.36" class="difflineminus">-preferences {</span>
<a href="#l42.37"></a><span id="l42.37" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/preferences/preferences.xml#preferences&quot;);</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineminus">-  visibility: collapse;</span>
<a href="#l42.39"></a><span id="l42.39" class="difflineminus">-}</span>
<a href="#l42.40"></a><span id="l42.40" class="difflineminus">-</span>
<a href="#l42.41"></a><span id="l42.41" class="difflineminus">-preference {</span>
<a href="#l42.42"></a><span id="l42.42" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/preferences/preferences.xml#preference&quot;);</span>
<a href="#l42.43"></a><span id="l42.43" class="difflineminus">-  visibility: collapse;</span>
<a href="#l42.44"></a><span id="l42.44" class="difflineminus">-}</span>
<a href="#l42.45"></a><span id="l42.45" class="difflineminus">-</span>
<a href="#l42.46"></a><span id="l42.46" class="difflineminus">-radio[pane] {</span>
<a href="#l42.47"></a><span id="l42.47" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/preferences/preferences.xml#panebutton&quot;) !important;</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineminus">-  -moz-box-orient: vertical;</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineminus">-  -moz-box-align: center;</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineminus">-}</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineminus">-</span>
<a href="#l42.52"></a><span id="l42.52" class="difflineminus">-prefwindow[chromehidden~=&quot;toolbar&quot;] .chromeclass-toolbar {</span>
<a href="#l42.53"></a><span id="l42.53" class="difflineminus">-  display: none;</span>
<a href="#l42.54"></a><span id="l42.54" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mail/components/preferences/preferences.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mail/components/preferences/preferences.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l43.4"></a><span id="l43.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l43.5"></a><span id="l43.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l43.6"></a><span id="l43.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l43.7"></a><span id="l43.7"> </span>
<a href="#l43.8"></a><span id="l43.8" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l43.9"></a><span id="l43.9" class="difflineplus">+</span>
<a href="#l43.10"></a><span id="l43.10" class="difflineplus">+Preferences.forceEnableInstantApply();</span>
<a href="#l43.11"></a><span id="l43.11" class="difflineplus">+</span>
<a href="#l43.12"></a><span id="l43.12"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l43.13"></a><span id="l43.13"> var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l43.14"></a><span id="l43.14"> var {MailServices} = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l43.15"></a><span id="l43.15"> var {ExtensionSupport} = ChromeUtils.import(&quot;resource:///modules/ExtensionSupport.jsm&quot;);</span>
<a href="#l43.16"></a><span id="l43.16"> </span>
<a href="#l43.17"></a><span id="l43.17"> var paneDeck = document.getElementById(&quot;paneDeck&quot;);</span>
<a href="#l43.18"></a><span id="l43.18"> var prefPanes = [...document.getElementsByTagName(&quot;prefpane&quot;)];</span>
<a href="#l43.19"></a><span id="l43.19"> var selector = document.getElementById(&quot;selector&quot;);</span>
<a href="#l43.20"></a><span id="l43.20" class="difflineat">@@ -92,30 +96,20 @@ function showPane(paneID) {</span>
<a href="#l43.21"></a><span id="l43.21">  * @param prefWindow          the prefwindow element to operate on</span>
<a href="#l43.22"></a><span id="l43.22">  * @param paneID              ID of prefpane to select</span>
<a href="#l43.23"></a><span id="l43.23">  * @param tabID               ID of tab to select on the prefpane</span>
<a href="#l43.24"></a><span id="l43.24">  * @param otherArgs.subdialog ID of button to activate, opening a subdialog</span>
<a href="#l43.25"></a><span id="l43.25">  */</span>
<a href="#l43.26"></a><span id="l43.26"> function selectPaneAndTab(prefWindow, paneID, tabID, otherArgs) {</span>
<a href="#l43.27"></a><span id="l43.27">   if (paneID) {</span>
<a href="#l43.28"></a><span id="l43.28">     let prefPane = document.getElementById(paneID);</span>
<a href="#l43.29"></a><span id="l43.29" class="difflineminus">-    let tabOnEvent = false;</span>
<a href="#l43.30"></a><span id="l43.30" class="difflineminus">-    // The prefwindow element selects the pane specified in window.arguments[0]</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineminus">-    // automatically. But let's check it and if the prefs window was already</span>
<a href="#l43.32"></a><span id="l43.32" class="difflineminus">-    // open, the current prefpane may not be the wanted one.</span>
<a href="#l43.33"></a><span id="l43.33" class="difflineminus">-    if (getCurrentPaneID() != prefPane.id) {</span>
<a href="#l43.34"></a><span id="l43.34" class="difflineminus">-      if (tabID &amp;&amp; !prefPane.loaded) {</span>
<a href="#l43.35"></a><span id="l43.35" class="difflineminus">-        prefPane.addEventListener(&quot;paneload&quot;, function() {</span>
<a href="#l43.36"></a><span id="l43.36" class="difflineminus">-          showTab(prefPane, tabID);</span>
<a href="#l43.37"></a><span id="l43.37" class="difflineminus">-        }, {once: true});</span>
<a href="#l43.38"></a><span id="l43.38" class="difflineminus">-        tabOnEvent = true;</span>
<a href="#l43.39"></a><span id="l43.39" class="difflineminus">-      }</span>
<a href="#l43.40"></a><span id="l43.40" class="difflineminus">-      showPane(prefPane.id);</span>
<a href="#l43.41"></a><span id="l43.41" class="difflineplus">+    if (getCurrentPaneID() != paneID) {</span>
<a href="#l43.42"></a><span id="l43.42" class="difflineplus">+      showPane(paneID);</span>
<a href="#l43.43"></a><span id="l43.43">     }</span>
<a href="#l43.44"></a><span id="l43.44" class="difflineminus">-    if (tabID &amp;&amp; !tabOnEvent) {</span>
<a href="#l43.45"></a><span id="l43.45" class="difflineplus">+    if (tabID) {</span>
<a href="#l43.46"></a><span id="l43.46">       showTab(prefPane, tabID, otherArgs ? otherArgs.subdialog : undefined);</span>
<a href="#l43.47"></a><span id="l43.47">     }</span>
<a href="#l43.48"></a><span id="l43.48">   }</span>
<a href="#l43.49"></a><span id="l43.49"> }</span>
<a href="#l43.50"></a><span id="l43.50"> </span>
<a href="#l43.51"></a><span id="l43.51"> /**</span>
<a href="#l43.52"></a><span id="l43.52">  * Select the specified tab</span>
<a href="#l43.53"></a><span id="l43.53">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1">rename from common/bindings/preferences.xml</span>
<a href="#l44.2"></a><span id="l44.2">rename to mail/components/preferences/preferences.xml</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineminus">--- a/common/bindings/preferences.xml</span>
<a href="#l44.4"></a><span id="l44.4" class="difflineplus">+++ b/mail/components/preferences/preferences.xml</span>
<a href="#l44.5"></a><span id="l44.5" class="difflineat">@@ -1,821 +1,16 @@</span>
<a href="#l44.6"></a><span id="l44.6"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l44.7"></a><span id="l44.7"> </span>
<a href="#l44.8"></a><span id="l44.8" class="difflineminus">-&lt;!DOCTYPE bindings [</span>
<a href="#l44.9"></a><span id="l44.9" class="difflineminus">-#ifdef MOZ_SUITE</span>
<a href="#l44.10"></a><span id="l44.10" class="difflineminus">-  &lt;!ENTITY % preferencesDTD SYSTEM &quot;chrome://communicator/locale/pref/preferences.dtd&quot;&gt;</span>
<a href="#l44.11"></a><span id="l44.11" class="difflineminus">-#else</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-  &lt;!ENTITY % preferencesDTD SYSTEM &quot;chrome://messenger/locale/preferences/preferences.dtd&quot;&gt;</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineminus">-#endif</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineminus">-  %preferencesDTD;</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineminus">-  &lt;!ENTITY % globalKeysDTD SYSTEM &quot;chrome://global/locale/globalKeys.dtd&quot;&gt;</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineminus">-  %globalKeysDTD;</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineminus">-]&gt;</span>
<a href="#l44.18"></a><span id="l44.18" class="difflineminus">-</span>
<a href="#l44.19"></a><span id="l44.19"> &lt;bindings id=&quot;preferencesBindings&quot;</span>
<a href="#l44.20"></a><span id="l44.20">           xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l44.21"></a><span id="l44.21">           xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l44.22"></a><span id="l44.22">           xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l44.23"></a><span id="l44.23"> </span>
<a href="#l44.24"></a><span id="l44.24" class="difflineminus">-#</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineminus">-# = Preferences Window Framework</span>
<a href="#l44.26"></a><span id="l44.26" class="difflineminus">-#</span>
<a href="#l44.27"></a><span id="l44.27" class="difflineminus">-#   The syntax for use looks something like:</span>
<a href="#l44.28"></a><span id="l44.28" class="difflineminus">-#</span>
<a href="#l44.29"></a><span id="l44.29" class="difflineminus">-#   &lt;prefwindow&gt;</span>
<a href="#l44.30"></a><span id="l44.30" class="difflineminus">-#     &lt;prefpane id=&quot;prefPaneA&quot;&gt;</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineminus">-#       &lt;preferences&gt;</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineminus">-#         &lt;preference id=&quot;preference1&quot; name=&quot;app.preference1&quot; type=&quot;bool&quot; onchange=&quot;foo();&quot;/&gt;</span>
<a href="#l44.33"></a><span id="l44.33" class="difflineminus">-#         &lt;preference id=&quot;preference2&quot; name=&quot;app.preference2&quot; type=&quot;bool&quot; useDefault=&quot;true&quot;/&gt;</span>
<a href="#l44.34"></a><span id="l44.34" class="difflineminus">-#       &lt;/preferences&gt;</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineminus">-#       &lt;checkbox label=&quot;Preference&quot; preference=&quot;preference1&quot;/&gt;</span>
<a href="#l44.36"></a><span id="l44.36" class="difflineminus">-#     &lt;/prefpane&gt;</span>
<a href="#l44.37"></a><span id="l44.37" class="difflineminus">-#   &lt;/prefwindow&gt;</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineminus">-#</span>
<a href="#l44.39"></a><span id="l44.39" class="difflineminus">-</span>
<a href="#l44.40"></a><span id="l44.40" class="difflineminus">-  &lt;binding id=&quot;preferences&quot;&gt;</span>
<a href="#l44.41"></a><span id="l44.41" class="difflineminus">-    &lt;implementation implements=&quot;nsIObserver&quot;&gt;</span>
<a href="#l44.42"></a><span id="l44.42" class="difflineminus">-      &lt;method name=&quot;_constructAfterChildren&quot;&gt;</span>
<a href="#l44.43"></a><span id="l44.43" class="difflineminus">-      &lt;body&gt;</span>
<a href="#l44.44"></a><span id="l44.44" class="difflineminus">-      &lt;![CDATA[</span>
<a href="#l44.45"></a><span id="l44.45" class="difflineminus">-      // This method will be called after the last of the child</span>
<a href="#l44.46"></a><span id="l44.46" class="difflineminus">-      // &lt;preference&gt; elements is constructed. Its purpose is to propagate</span>
<a href="#l44.47"></a><span id="l44.47" class="difflineminus">-      // the values to the associated form elements. Sometimes the code for</span>
<a href="#l44.48"></a><span id="l44.48" class="difflineminus">-      // some &lt;preference&gt; initializers depend on other &lt;preference&gt; elements</span>
<a href="#l44.49"></a><span id="l44.49" class="difflineminus">-      // being initialized so we wait and call updateElements on all of them</span>
<a href="#l44.50"></a><span id="l44.50" class="difflineminus">-      // once the last one has been constructed. See bugs 997570 and 992185.</span>
<a href="#l44.51"></a><span id="l44.51" class="difflineminus">-</span>
<a href="#l44.52"></a><span id="l44.52" class="difflineminus">-      var elements = this.getElementsByTagName(&quot;preference&quot;);</span>
<a href="#l44.53"></a><span id="l44.53" class="difflineminus">-      for (let element of elements) {</span>
<a href="#l44.54"></a><span id="l44.54" class="difflineminus">-        element.updateElements();</span>
<a href="#l44.55"></a><span id="l44.55" class="difflineminus">-      }</span>
<a href="#l44.56"></a><span id="l44.56" class="difflineminus">-</span>
<a href="#l44.57"></a><span id="l44.57" class="difflineminus">-      this._constructAfterChildrenCalled = true;</span>
<a href="#l44.58"></a><span id="l44.58" class="difflineminus">-      ]]&gt;</span>
<a href="#l44.59"></a><span id="l44.59" class="difflineminus">-      &lt;/body&gt;</span>
<a href="#l44.60"></a><span id="l44.60" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.61"></a><span id="l44.61" class="difflineminus">-      &lt;method name=&quot;observe&quot;&gt;</span>
<a href="#l44.62"></a><span id="l44.62" class="difflineminus">-        &lt;parameter name=&quot;aSubject&quot;/&gt;</span>
<a href="#l44.63"></a><span id="l44.63" class="difflineminus">-        &lt;parameter name=&quot;aTopic&quot;/&gt;</span>
<a href="#l44.64"></a><span id="l44.64" class="difflineminus">-        &lt;parameter name=&quot;aData&quot;/&gt;</span>
<a href="#l44.65"></a><span id="l44.65" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.66"></a><span id="l44.66" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.67"></a><span id="l44.67" class="difflineminus">-          for (var i = 0; i &lt; this.childNodes.length; ++i) {</span>
<a href="#l44.68"></a><span id="l44.68" class="difflineminus">-            var preference = this.childNodes[i];</span>
<a href="#l44.69"></a><span id="l44.69" class="difflineminus">-            if (preference.name == aData) {</span>
<a href="#l44.70"></a><span id="l44.70" class="difflineminus">-              preference.value = preference.valueFromPreferences;</span>
<a href="#l44.71"></a><span id="l44.71" class="difflineminus">-            }</span>
<a href="#l44.72"></a><span id="l44.72" class="difflineminus">-          }</span>
<a href="#l44.73"></a><span id="l44.73" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.74"></a><span id="l44.74" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.75"></a><span id="l44.75" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.76"></a><span id="l44.76" class="difflineminus">-</span>
<a href="#l44.77"></a><span id="l44.77" class="difflineminus">-      &lt;method name=&quot;fireChangedEvent&quot;&gt;</span>
<a href="#l44.78"></a><span id="l44.78" class="difflineminus">-        &lt;parameter name=&quot;aPreference&quot;/&gt;</span>
<a href="#l44.79"></a><span id="l44.79" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.80"></a><span id="l44.80" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.81"></a><span id="l44.81" class="difflineminus">-          // Value changed, synthesize an event</span>
<a href="#l44.82"></a><span id="l44.82" class="difflineminus">-          try {</span>
<a href="#l44.83"></a><span id="l44.83" class="difflineminus">-            var event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l44.84"></a><span id="l44.84" class="difflineminus">-            event.initEvent(&quot;change&quot;, true, true);</span>
<a href="#l44.85"></a><span id="l44.85" class="difflineminus">-            aPreference.dispatchEvent(event);</span>
<a href="#l44.86"></a><span id="l44.86" class="difflineminus">-          } catch (e) {</span>
<a href="#l44.87"></a><span id="l44.87" class="difflineminus">-            Cu.reportError(e);</span>
<a href="#l44.88"></a><span id="l44.88" class="difflineminus">-          }</span>
<a href="#l44.89"></a><span id="l44.89" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.90"></a><span id="l44.90" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.91"></a><span id="l44.91" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.92"></a><span id="l44.92" class="difflineminus">-</span>
<a href="#l44.93"></a><span id="l44.93" class="difflineminus">-      &lt;field name=&quot;service&quot;&gt;</span>
<a href="#l44.94"></a><span id="l44.94" class="difflineminus">-        Cc[&quot;@mozilla.org/preferences-service;1&quot;].getService(Ci.nsIPrefService);</span>
<a href="#l44.95"></a><span id="l44.95" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l44.96"></a><span id="l44.96" class="difflineminus">-      &lt;field name=&quot;rootBranch&quot;&gt;</span>
<a href="#l44.97"></a><span id="l44.97" class="difflineminus">-        Cc[&quot;@mozilla.org/preferences-service;1&quot;].getService(Ci.nsIPrefBranch);</span>
<a href="#l44.98"></a><span id="l44.98" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l44.99"></a><span id="l44.99" class="difflineminus">-      &lt;field name=&quot;defaultBranch&quot;&gt;</span>
<a href="#l44.100"></a><span id="l44.100" class="difflineminus">-        this.service.getDefaultBranch(&quot;&quot;);</span>
<a href="#l44.101"></a><span id="l44.101" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l44.102"></a><span id="l44.102" class="difflineminus">-      &lt;field name=&quot;rootBranchInternal&quot;&gt;</span>
<a href="#l44.103"></a><span id="l44.103" class="difflineminus">-        Cc[&quot;@mozilla.org/preferences-service;1&quot;].getService(Ci.nsIPrefBranch);</span>
<a href="#l44.104"></a><span id="l44.104" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l44.105"></a><span id="l44.105" class="difflineminus">-      &lt;property name=&quot;type&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l44.106"></a><span id="l44.106" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.107"></a><span id="l44.107" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l44.108"></a><span id="l44.108" class="difflineminus">-            return document.documentElement.type || &quot;&quot;;</span>
<a href="#l44.109"></a><span id="l44.109" class="difflineminus">-          ]]&gt;</span>
<a href="#l44.110"></a><span id="l44.110" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.111"></a><span id="l44.111" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.112"></a><span id="l44.112" class="difflineminus">-      &lt;property name=&quot;instantApply&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l44.113"></a><span id="l44.113" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.114"></a><span id="l44.114" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l44.115"></a><span id="l44.115" class="difflineminus">-            var doc = document.documentElement;</span>
<a href="#l44.116"></a><span id="l44.116" class="difflineminus">-            return this.type == &quot;child&quot; ? doc.instantApply</span>
<a href="#l44.117"></a><span id="l44.117" class="difflineminus">-                                        : doc.instantApply || this.rootBranch.getBoolPref(&quot;browser.preferences.instantApply&quot;);</span>
<a href="#l44.118"></a><span id="l44.118" class="difflineminus">-          ]]&gt;</span>
<a href="#l44.119"></a><span id="l44.119" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.120"></a><span id="l44.120" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.121"></a><span id="l44.121" class="difflineminus">-</span>
<a href="#l44.122"></a><span id="l44.122" class="difflineminus">-      &lt;!-- We want to call _constructAfterChildren after all child</span>
<a href="#l44.123"></a><span id="l44.123" class="difflineminus">-           &lt;preference&gt; elements have been constructed. To do this, we get</span>
<a href="#l44.124"></a><span id="l44.124" class="difflineminus">-           and store the node list of all child &lt;preference&gt; elements in the</span>
<a href="#l44.125"></a><span id="l44.125" class="difflineminus">-           constructor, and maintain a count which is incremented in the</span>
<a href="#l44.126"></a><span id="l44.126" class="difflineminus">-           constructor of &lt;preference&gt;. _constructAfterChildren is called</span>
<a href="#l44.127"></a><span id="l44.127" class="difflineminus">-           when the count matches the length of the list. --&gt;</span>
<a href="#l44.128"></a><span id="l44.128" class="difflineminus">-      &lt;field name=&quot;_constructedChildrenCount&quot;&gt;0&lt;/field&gt;</span>
<a href="#l44.129"></a><span id="l44.129" class="difflineminus">-      &lt;field name=&quot;_preferenceChildren&quot;&gt;null&lt;/field&gt;</span>
<a href="#l44.130"></a><span id="l44.130" class="difflineminus">-      &lt;!-- Some &lt;preference&gt; elements are added dynamically after</span>
<a href="#l44.131"></a><span id="l44.131" class="difflineminus">-           _constructAfterChildren has already been called - we want to</span>
<a href="#l44.132"></a><span id="l44.132" class="difflineminus">-           avoid looping over all of them again in this case so we remember</span>
<a href="#l44.133"></a><span id="l44.133" class="difflineminus">-           if we already called it. --&gt;</span>
<a href="#l44.134"></a><span id="l44.134" class="difflineminus">-      &lt;field name=&quot;_constructAfterChildrenCalled&quot;&gt;false&lt;/field&gt;</span>
<a href="#l44.135"></a><span id="l44.135" class="difflineminus">-      &lt;constructor&gt;</span>
<a href="#l44.136"></a><span id="l44.136" class="difflineminus">-      &lt;![CDATA[</span>
<a href="#l44.137"></a><span id="l44.137" class="difflineminus">-        this._preferenceChildren = this.getElementsByTagName(&quot;preference&quot;);</span>
<a href="#l44.138"></a><span id="l44.138" class="difflineminus">-      ]]&gt;</span>
<a href="#l44.139"></a><span id="l44.139" class="difflineminus">-      &lt;/constructor&gt;</span>
<a href="#l44.140"></a><span id="l44.140" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l44.141"></a><span id="l44.141" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l44.142"></a><span id="l44.142" class="difflineminus">-</span>
<a href="#l44.143"></a><span id="l44.143" class="difflineminus">-  &lt;binding id=&quot;preference&quot;&gt;</span>
<a href="#l44.144"></a><span id="l44.144" class="difflineminus">-    &lt;implementation&gt;</span>
<a href="#l44.145"></a><span id="l44.145" class="difflineminus">-      &lt;constructor&gt;</span>
<a href="#l44.146"></a><span id="l44.146" class="difflineminus">-      &lt;![CDATA[</span>
<a href="#l44.147"></a><span id="l44.147" class="difflineminus">-        // if the element has been inserted without the name attribute set,</span>
<a href="#l44.148"></a><span id="l44.148" class="difflineminus">-        // we have nothing to do here</span>
<a href="#l44.149"></a><span id="l44.149" class="difflineminus">-        if (!this.name)</span>
<a href="#l44.150"></a><span id="l44.150" class="difflineminus">-          return;</span>
<a href="#l44.151"></a><span id="l44.151" class="difflineminus">-</span>
<a href="#l44.152"></a><span id="l44.152" class="difflineminus">-        this.preferences.rootBranchInternal</span>
<a href="#l44.153"></a><span id="l44.153" class="difflineminus">-            .addObserver(this.name, this.preferences);</span>
<a href="#l44.154"></a><span id="l44.154" class="difflineminus">-        // In non-instant apply mode, we must try and use the last saved state</span>
<a href="#l44.155"></a><span id="l44.155" class="difflineminus">-        // from any previous opens of a child dialog instead of the value from</span>
<a href="#l44.156"></a><span id="l44.156" class="difflineminus">-        // preferences, to pick up any edits a user may have made.</span>
<a href="#l44.157"></a><span id="l44.157" class="difflineminus">-</span>
<a href="#l44.158"></a><span id="l44.158" class="difflineminus">-        var secMan = Cc[&quot;@mozilla.org/scriptsecuritymanager;1&quot;]</span>
<a href="#l44.159"></a><span id="l44.159" class="difflineminus">-                    .getService(Ci.nsIScriptSecurityManager);</span>
<a href="#l44.160"></a><span id="l44.160" class="difflineminus">-        if (this.preferences.type == &quot;child&quot; &amp;&amp;</span>
<a href="#l44.161"></a><span id="l44.161" class="difflineminus">-            !this.instantApply &amp;&amp; window.opener &amp;&amp;</span>
<a href="#l44.162"></a><span id="l44.162" class="difflineminus">-            secMan.isSystemPrincipal(window.opener.document.nodePrincipal)) {</span>
<a href="#l44.163"></a><span id="l44.163" class="difflineminus">-          var pdoc = window.opener.document;</span>
<a href="#l44.164"></a><span id="l44.164" class="difflineminus">-</span>
<a href="#l44.165"></a><span id="l44.165" class="difflineminus">-          // Try to find a preference element for the same preference.</span>
<a href="#l44.166"></a><span id="l44.166" class="difflineminus">-          var preference = null;</span>
<a href="#l44.167"></a><span id="l44.167" class="difflineminus">-          var parentPreferences = pdoc.getElementsByTagName(&quot;preferences&quot;);</span>
<a href="#l44.168"></a><span id="l44.168" class="difflineminus">-          for (var k = 0; (k &lt; parentPreferences.length &amp;&amp; !preference); ++k) {</span>
<a href="#l44.169"></a><span id="l44.169" class="difflineminus">-            var parentPrefs = parentPreferences[k]</span>
<a href="#l44.170"></a><span id="l44.170" class="difflineminus">-                                    .getElementsByAttribute(&quot;name&quot;, this.name);</span>
<a href="#l44.171"></a><span id="l44.171" class="difflineminus">-            for (var l = 0; (l &lt; parentPrefs.length &amp;&amp; !preference); ++l) {</span>
<a href="#l44.172"></a><span id="l44.172" class="difflineminus">-              if (parentPrefs[l].localName == &quot;preference&quot;)</span>
<a href="#l44.173"></a><span id="l44.173" class="difflineminus">-                preference = parentPrefs[l];</span>
<a href="#l44.174"></a><span id="l44.174" class="difflineminus">-            }</span>
<a href="#l44.175"></a><span id="l44.175" class="difflineminus">-          }</span>
<a href="#l44.176"></a><span id="l44.176" class="difflineminus">-</span>
<a href="#l44.177"></a><span id="l44.177" class="difflineminus">-          // Don't use the value setter here, we don't want updateElements to be prematurely fired.</span>
<a href="#l44.178"></a><span id="l44.178" class="difflineminus">-          this._value = preference ? preference.value : this.valueFromPreferences;</span>
<a href="#l44.179"></a><span id="l44.179" class="difflineminus">-        } else {</span>
<a href="#l44.180"></a><span id="l44.180" class="difflineminus">-          this._value = this.valueFromPreferences;</span>
<a href="#l44.181"></a><span id="l44.181" class="difflineminus">-        }</span>
<a href="#l44.182"></a><span id="l44.182" class="difflineminus">-        if (this.preferences._constructAfterChildrenCalled) {</span>
<a href="#l44.183"></a><span id="l44.183" class="difflineminus">-          // This &lt;preference&gt; was added after _constructAfterChildren() was already called.</span>
<a href="#l44.184"></a><span id="l44.184" class="difflineminus">-          // We can directly call updateElements().</span>
<a href="#l44.185"></a><span id="l44.185" class="difflineminus">-          this.updateElements();</span>
<a href="#l44.186"></a><span id="l44.186" class="difflineminus">-        } else {</span>
<a href="#l44.187"></a><span id="l44.187" class="difflineminus">-          this.preferences._constructedChildrenCount++;</span>
<a href="#l44.188"></a><span id="l44.188" class="difflineminus">-          if (this.preferences._constructedChildrenCount ==</span>
<a href="#l44.189"></a><span id="l44.189" class="difflineminus">-              this.preferences._preferenceChildren.length) {</span>
<a href="#l44.190"></a><span id="l44.190" class="difflineminus">-            // This is the last &lt;preference&gt;, time to updateElements() on all of them.</span>
<a href="#l44.191"></a><span id="l44.191" class="difflineminus">-            this.preferences._constructAfterChildren();</span>
<a href="#l44.192"></a><span id="l44.192" class="difflineminus">-          }</span>
<a href="#l44.193"></a><span id="l44.193" class="difflineminus">-        }</span>
<a href="#l44.194"></a><span id="l44.194" class="difflineminus">-</span>
<a href="#l44.195"></a><span id="l44.195" class="difflineminus">-        this.dispatchEvent(new CustomEvent(&quot;bindingattached&quot;, { bubbles: false }));</span>
<a href="#l44.196"></a><span id="l44.196" class="difflineminus">-      ]]&gt;</span>
<a href="#l44.197"></a><span id="l44.197" class="difflineminus">-      &lt;/constructor&gt;</span>
<a href="#l44.198"></a><span id="l44.198" class="difflineminus">-      &lt;destructor&gt;</span>
<a href="#l44.199"></a><span id="l44.199" class="difflineminus">-        this.preferences.rootBranchInternal</span>
<a href="#l44.200"></a><span id="l44.200" class="difflineminus">-            .removeObserver(this.name, this.preferences);</span>
<a href="#l44.201"></a><span id="l44.201" class="difflineminus">-      &lt;/destructor&gt;</span>
<a href="#l44.202"></a><span id="l44.202" class="difflineminus">-      &lt;field name=&quot;_constructed&quot;&gt;false&lt;/field&gt;</span>
<a href="#l44.203"></a><span id="l44.203" class="difflineminus">-      &lt;property name=&quot;instantApply&quot;&gt;</span>
<a href="#l44.204"></a><span id="l44.204" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.205"></a><span id="l44.205" class="difflineminus">-          if (this.getAttribute(&quot;instantApply&quot;) == &quot;false&quot;)</span>
<a href="#l44.206"></a><span id="l44.206" class="difflineminus">-            return false;</span>
<a href="#l44.207"></a><span id="l44.207" class="difflineminus">-          return this.getAttribute(&quot;instantApply&quot;) == &quot;true&quot; || this.preferences.instantApply;</span>
<a href="#l44.208"></a><span id="l44.208" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.209"></a><span id="l44.209" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.210"></a><span id="l44.210" class="difflineminus">-</span>
<a href="#l44.211"></a><span id="l44.211" class="difflineminus">-      &lt;property name=&quot;preferences&quot; onget=&quot;return this.parentNode&quot;/&gt;</span>
<a href="#l44.212"></a><span id="l44.212" class="difflineminus">-      &lt;property name=&quot;name&quot; onget=&quot;return this.getAttribute('name');&quot;&gt;</span>
<a href="#l44.213"></a><span id="l44.213" class="difflineminus">-        &lt;setter&gt;</span>
<a href="#l44.214"></a><span id="l44.214" class="difflineminus">-          if (val == this.name)</span>
<a href="#l44.215"></a><span id="l44.215" class="difflineminus">-            return val;</span>
<a href="#l44.216"></a><span id="l44.216" class="difflineminus">-</span>
<a href="#l44.217"></a><span id="l44.217" class="difflineminus">-          this.preferences.rootBranchInternal</span>
<a href="#l44.218"></a><span id="l44.218" class="difflineminus">-              .removeObserver(this.name, this.preferences);</span>
<a href="#l44.219"></a><span id="l44.219" class="difflineminus">-          this.setAttribute(&quot;name&quot;, val);</span>
<a href="#l44.220"></a><span id="l44.220" class="difflineminus">-          this.preferences.rootBranchInternal</span>
<a href="#l44.221"></a><span id="l44.221" class="difflineminus">-              .addObserver(val, this.preferences);</span>
<a href="#l44.222"></a><span id="l44.222" class="difflineminus">-</span>
<a href="#l44.223"></a><span id="l44.223" class="difflineminus">-          return val;</span>
<a href="#l44.224"></a><span id="l44.224" class="difflineminus">-        &lt;/setter&gt;</span>
<a href="#l44.225"></a><span id="l44.225" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.226"></a><span id="l44.226" class="difflineminus">-      &lt;property name=&quot;type&quot; onget=&quot;return this.getAttribute('type');&quot;</span>
<a href="#l44.227"></a><span id="l44.227" class="difflineminus">-                            onset=&quot;this.setAttribute('type', val); return val;&quot;/&gt;</span>
<a href="#l44.228"></a><span id="l44.228" class="difflineminus">-      &lt;property name=&quot;inverted&quot; onget=&quot;return this.getAttribute('inverted') == 'true';&quot;</span>
<a href="#l44.229"></a><span id="l44.229" class="difflineminus">-                                onset=&quot;this.setAttribute('inverted', val); return val;&quot;/&gt;</span>
<a href="#l44.230"></a><span id="l44.230" class="difflineminus">-      &lt;property name=&quot;readonly&quot; onget=&quot;return this.getAttribute('readonly') == 'true';&quot;</span>
<a href="#l44.231"></a><span id="l44.231" class="difflineminus">-                                onset=&quot;this.setAttribute('readonly', val); return val;&quot;/&gt;</span>
<a href="#l44.232"></a><span id="l44.232" class="difflineminus">-</span>
<a href="#l44.233"></a><span id="l44.233" class="difflineminus">-      &lt;field name=&quot;_value&quot;&gt;null&lt;/field&gt;</span>
<a href="#l44.234"></a><span id="l44.234" class="difflineminus">-      &lt;method name=&quot;_setValue&quot;&gt;</span>
<a href="#l44.235"></a><span id="l44.235" class="difflineminus">-        &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l44.236"></a><span id="l44.236" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.237"></a><span id="l44.237" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.238"></a><span id="l44.238" class="difflineminus">-          if (this.value !== aValue) {</span>
<a href="#l44.239"></a><span id="l44.239" class="difflineminus">-            this._value = aValue;</span>
<a href="#l44.240"></a><span id="l44.240" class="difflineminus">-            if (this.instantApply)</span>
<a href="#l44.241"></a><span id="l44.241" class="difflineminus">-              this.valueFromPreferences = aValue;</span>
<a href="#l44.242"></a><span id="l44.242" class="difflineminus">-            this.preferences.fireChangedEvent(this);</span>
<a href="#l44.243"></a><span id="l44.243" class="difflineminus">-          }</span>
<a href="#l44.244"></a><span id="l44.244" class="difflineminus">-          return aValue;</span>
<a href="#l44.245"></a><span id="l44.245" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.246"></a><span id="l44.246" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.247"></a><span id="l44.247" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.248"></a><span id="l44.248" class="difflineminus">-      &lt;property name=&quot;value&quot; onget=&quot;return this._value&quot; onset=&quot;return this._setValue(val);&quot;/&gt;</span>
<a href="#l44.249"></a><span id="l44.249" class="difflineminus">-</span>
<a href="#l44.250"></a><span id="l44.250" class="difflineminus">-      &lt;property name=&quot;locked&quot;&gt;</span>
<a href="#l44.251"></a><span id="l44.251" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.252"></a><span id="l44.252" class="difflineminus">-          return this.preferences.rootBranch.prefIsLocked(this.name);</span>
<a href="#l44.253"></a><span id="l44.253" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.254"></a><span id="l44.254" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.255"></a><span id="l44.255" class="difflineminus">-</span>
<a href="#l44.256"></a><span id="l44.256" class="difflineminus">-      &lt;property name=&quot;disabled&quot;&gt;</span>
<a href="#l44.257"></a><span id="l44.257" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.258"></a><span id="l44.258" class="difflineminus">-          return this.getAttribute(&quot;disabled&quot;) == &quot;true&quot;;</span>
<a href="#l44.259"></a><span id="l44.259" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.260"></a><span id="l44.260" class="difflineminus">-        &lt;setter&gt;</span>
<a href="#l44.261"></a><span id="l44.261" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.262"></a><span id="l44.262" class="difflineminus">-          if (val)</span>
<a href="#l44.263"></a><span id="l44.263" class="difflineminus">-            this.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l44.264"></a><span id="l44.264" class="difflineminus">-          else</span>
<a href="#l44.265"></a><span id="l44.265" class="difflineminus">-            this.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l44.266"></a><span id="l44.266" class="difflineminus">-</span>
<a href="#l44.267"></a><span id="l44.267" class="difflineminus">-          if (!this.id)</span>
<a href="#l44.268"></a><span id="l44.268" class="difflineminus">-            return val;</span>
<a href="#l44.269"></a><span id="l44.269" class="difflineminus">-</span>
<a href="#l44.270"></a><span id="l44.270" class="difflineminus">-          var elements = document.getElementsByAttribute(&quot;preference&quot;, this.id);</span>
<a href="#l44.271"></a><span id="l44.271" class="difflineminus">-          for (var i = 0; i &lt; elements.length; ++i) {</span>
<a href="#l44.272"></a><span id="l44.272" class="difflineminus">-            elements[i].disabled = val;</span>
<a href="#l44.273"></a><span id="l44.273" class="difflineminus">-</span>
<a href="#l44.274"></a><span id="l44.274" class="difflineminus">-            var labels = document.getElementsByAttribute(&quot;control&quot;, elements[i].id);</span>
<a href="#l44.275"></a><span id="l44.275" class="difflineminus">-            for (var j = 0; j &lt; labels.length; ++j)</span>
<a href="#l44.276"></a><span id="l44.276" class="difflineminus">-              labels[j].disabled = val;</span>
<a href="#l44.277"></a><span id="l44.277" class="difflineminus">-          }</span>
<a href="#l44.278"></a><span id="l44.278" class="difflineminus">-</span>
<a href="#l44.279"></a><span id="l44.279" class="difflineminus">-          return val;</span>
<a href="#l44.280"></a><span id="l44.280" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.281"></a><span id="l44.281" class="difflineminus">-        &lt;/setter&gt;</span>
<a href="#l44.282"></a><span id="l44.282" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.283"></a><span id="l44.283" class="difflineminus">-</span>
<a href="#l44.284"></a><span id="l44.284" class="difflineminus">-      &lt;property name=&quot;tabIndex&quot;&gt;</span>
<a href="#l44.285"></a><span id="l44.285" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.286"></a><span id="l44.286" class="difflineminus">-          return parseInt(this.getAttribute(&quot;tabindex&quot;));</span>
<a href="#l44.287"></a><span id="l44.287" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.288"></a><span id="l44.288" class="difflineminus">-        &lt;setter&gt;</span>
<a href="#l44.289"></a><span id="l44.289" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.290"></a><span id="l44.290" class="difflineminus">-          if (val)</span>
<a href="#l44.291"></a><span id="l44.291" class="difflineminus">-            this.setAttribute(&quot;tabindex&quot;, val);</span>
<a href="#l44.292"></a><span id="l44.292" class="difflineminus">-          else</span>
<a href="#l44.293"></a><span id="l44.293" class="difflineminus">-            this.removeAttribute(&quot;tabindex&quot;);</span>
<a href="#l44.294"></a><span id="l44.294" class="difflineminus">-</span>
<a href="#l44.295"></a><span id="l44.295" class="difflineminus">-          if (!this.id)</span>
<a href="#l44.296"></a><span id="l44.296" class="difflineminus">-            return val;</span>
<a href="#l44.297"></a><span id="l44.297" class="difflineminus">-</span>
<a href="#l44.298"></a><span id="l44.298" class="difflineminus">-          var elements = document.getElementsByAttribute(&quot;preference&quot;, this.id);</span>
<a href="#l44.299"></a><span id="l44.299" class="difflineminus">-          for (var i = 0; i &lt; elements.length; ++i) {</span>
<a href="#l44.300"></a><span id="l44.300" class="difflineminus">-            elements[i].tabIndex = val;</span>
<a href="#l44.301"></a><span id="l44.301" class="difflineminus">-</span>
<a href="#l44.302"></a><span id="l44.302" class="difflineminus">-            var labels = document.getElementsByAttribute(&quot;control&quot;, elements[i].id);</span>
<a href="#l44.303"></a><span id="l44.303" class="difflineminus">-            for (var j = 0; j &lt; labels.length; ++j)</span>
<a href="#l44.304"></a><span id="l44.304" class="difflineminus">-              labels[j].tabIndex = val;</span>
<a href="#l44.305"></a><span id="l44.305" class="difflineminus">-          }</span>
<a href="#l44.306"></a><span id="l44.306" class="difflineminus">-</span>
<a href="#l44.307"></a><span id="l44.307" class="difflineminus">-          return val;</span>
<a href="#l44.308"></a><span id="l44.308" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.309"></a><span id="l44.309" class="difflineminus">-        &lt;/setter&gt;</span>
<a href="#l44.310"></a><span id="l44.310" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.311"></a><span id="l44.311" class="difflineminus">-</span>
<a href="#l44.312"></a><span id="l44.312" class="difflineminus">-      &lt;property name=&quot;hasUserValue&quot;&gt;</span>
<a href="#l44.313"></a><span id="l44.313" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.314"></a><span id="l44.314" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.315"></a><span id="l44.315" class="difflineminus">-          return this.preferences.rootBranch.prefHasUserValue(this.name) &amp;&amp;</span>
<a href="#l44.316"></a><span id="l44.316" class="difflineminus">-                 this.value !== undefined;</span>
<a href="#l44.317"></a><span id="l44.317" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.318"></a><span id="l44.318" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.319"></a><span id="l44.319" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.320"></a><span id="l44.320" class="difflineminus">-</span>
<a href="#l44.321"></a><span id="l44.321" class="difflineminus">-      &lt;method name=&quot;reset&quot;&gt;</span>
<a href="#l44.322"></a><span id="l44.322" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.323"></a><span id="l44.323" class="difflineminus">-          // defer reset until preference update</span>
<a href="#l44.324"></a><span id="l44.324" class="difflineminus">-          this.value = undefined;</span>
<a href="#l44.325"></a><span id="l44.325" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.326"></a><span id="l44.326" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.327"></a><span id="l44.327" class="difflineminus">-</span>
<a href="#l44.328"></a><span id="l44.328" class="difflineminus">-      &lt;field name=&quot;_useDefault&quot;&gt;false&lt;/field&gt;</span>
<a href="#l44.329"></a><span id="l44.329" class="difflineminus">-      &lt;property name=&quot;defaultValue&quot;&gt;</span>
<a href="#l44.330"></a><span id="l44.330" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.331"></a><span id="l44.331" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.332"></a><span id="l44.332" class="difflineminus">-          this._useDefault = true;</span>
<a href="#l44.333"></a><span id="l44.333" class="difflineminus">-          var val = this.valueFromPreferences;</span>
<a href="#l44.334"></a><span id="l44.334" class="difflineminus">-          this._useDefault = false;</span>
<a href="#l44.335"></a><span id="l44.335" class="difflineminus">-          return val;</span>
<a href="#l44.336"></a><span id="l44.336" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.337"></a><span id="l44.337" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.338"></a><span id="l44.338" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.339"></a><span id="l44.339" class="difflineminus">-</span>
<a href="#l44.340"></a><span id="l44.340" class="difflineminus">-      &lt;property name=&quot;_branch&quot;&gt;</span>
<a href="#l44.341"></a><span id="l44.341" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.342"></a><span id="l44.342" class="difflineminus">-          return this._useDefault ? this.preferences.defaultBranch : this.preferences.rootBranch;</span>
<a href="#l44.343"></a><span id="l44.343" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.344"></a><span id="l44.344" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.345"></a><span id="l44.345" class="difflineminus">-</span>
<a href="#l44.346"></a><span id="l44.346" class="difflineminus">-      &lt;field name=&quot;batching&quot;&gt;false&lt;/field&gt;</span>
<a href="#l44.347"></a><span id="l44.347" class="difflineminus">-</span>
<a href="#l44.348"></a><span id="l44.348" class="difflineminus">-      &lt;method name=&quot;_reportUnknownType&quot;&gt;</span>
<a href="#l44.349"></a><span id="l44.349" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.350"></a><span id="l44.350" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.351"></a><span id="l44.351" class="difflineminus">-          var consoleService = Cc[&quot;@mozilla.org/consoleservice;1&quot;]</span>
<a href="#l44.352"></a><span id="l44.352" class="difflineminus">-                                 .getService(Ci.nsIConsoleService);</span>
<a href="#l44.353"></a><span id="l44.353" class="difflineminus">-          var msg = &quot;&lt;preference&gt; with id='&quot; + this.id + &quot;' and name='&quot; +</span>
<a href="#l44.354"></a><span id="l44.354" class="difflineminus">-                    this.name + &quot;' has unknown type '&quot; + this.type + &quot;'.&quot;;</span>
<a href="#l44.355"></a><span id="l44.355" class="difflineminus">-          consoleService.logStringMessage(msg);</span>
<a href="#l44.356"></a><span id="l44.356" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.357"></a><span id="l44.357" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.358"></a><span id="l44.358" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.359"></a><span id="l44.359" class="difflineminus">-</span>
<a href="#l44.360"></a><span id="l44.360" class="difflineminus">-      &lt;property name=&quot;valueFromPreferences&quot;&gt;</span>
<a href="#l44.361"></a><span id="l44.361" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.362"></a><span id="l44.362" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.363"></a><span id="l44.363" class="difflineminus">-          try {</span>
<a href="#l44.364"></a><span id="l44.364" class="difflineminus">-            // Force a resync of value with preferences.</span>
<a href="#l44.365"></a><span id="l44.365" class="difflineminus">-            switch (this.type) {</span>
<a href="#l44.366"></a><span id="l44.366" class="difflineminus">-            case &quot;int&quot;:</span>
<a href="#l44.367"></a><span id="l44.367" class="difflineminus">-              return this._branch.getIntPref(this.name);</span>
<a href="#l44.368"></a><span id="l44.368" class="difflineminus">-            case &quot;bool&quot;:</span>
<a href="#l44.369"></a><span id="l44.369" class="difflineminus">-              var val = this._branch.getBoolPref(this.name);</span>
<a href="#l44.370"></a><span id="l44.370" class="difflineminus">-              return this.inverted ? !val : val;</span>
<a href="#l44.371"></a><span id="l44.371" class="difflineminus">-            case &quot;wstring&quot;:</span>
<a href="#l44.372"></a><span id="l44.372" class="difflineminus">-              return this._branch</span>
<a href="#l44.373"></a><span id="l44.373" class="difflineminus">-                         .getComplexValue(this.name, Ci.nsIPrefLocalizedString)</span>
<a href="#l44.374"></a><span id="l44.374" class="difflineminus">-                         .data;</span>
<a href="#l44.375"></a><span id="l44.375" class="difflineminus">-            case &quot;string&quot;:</span>
<a href="#l44.376"></a><span id="l44.376" class="difflineminus">-            case &quot;unichar&quot;:</span>
<a href="#l44.377"></a><span id="l44.377" class="difflineminus">-              return this._branch.getStringPref(this.name);</span>
<a href="#l44.378"></a><span id="l44.378" class="difflineminus">-            case &quot;fontname&quot;:</span>
<a href="#l44.379"></a><span id="l44.379" class="difflineminus">-              var family = this._branch.getStringPref(this.name);</span>
<a href="#l44.380"></a><span id="l44.380" class="difflineminus">-              var fontEnumerator = Cc[&quot;@mozilla.org/gfx/fontenumerator;1&quot;]</span>
<a href="#l44.381"></a><span id="l44.381" class="difflineminus">-                                     .createInstance(Ci.nsIFontEnumerator);</span>
<a href="#l44.382"></a><span id="l44.382" class="difflineminus">-              return fontEnumerator.getStandardFamilyName(family);</span>
<a href="#l44.383"></a><span id="l44.383" class="difflineminus">-            case &quot;file&quot;:</span>
<a href="#l44.384"></a><span id="l44.384" class="difflineminus">-              var f = this._branch</span>
<a href="#l44.385"></a><span id="l44.385" class="difflineminus">-                          .getComplexValue(this.name, Ci.nsIFile);</span>
<a href="#l44.386"></a><span id="l44.386" class="difflineminus">-              return f;</span>
<a href="#l44.387"></a><span id="l44.387" class="difflineminus">-            default:</span>
<a href="#l44.388"></a><span id="l44.388" class="difflineminus">-              this._reportUnknownType();</span>
<a href="#l44.389"></a><span id="l44.389" class="difflineminus">-            }</span>
<a href="#l44.390"></a><span id="l44.390" class="difflineminus">-          } catch (e) { }</span>
<a href="#l44.391"></a><span id="l44.391" class="difflineminus">-          return null;</span>
<a href="#l44.392"></a><span id="l44.392" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.393"></a><span id="l44.393" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.394"></a><span id="l44.394" class="difflineminus">-        &lt;setter&gt;</span>
<a href="#l44.395"></a><span id="l44.395" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.396"></a><span id="l44.396" class="difflineminus">-          // Exit early if nothing to do.</span>
<a href="#l44.397"></a><span id="l44.397" class="difflineminus">-          if (this.readonly || this.valueFromPreferences == val)</span>
<a href="#l44.398"></a><span id="l44.398" class="difflineminus">-            return val;</span>
<a href="#l44.399"></a><span id="l44.399" class="difflineminus">-</span>
<a href="#l44.400"></a><span id="l44.400" class="difflineminus">-          // The special value undefined means 'reset preference to default'.</span>
<a href="#l44.401"></a><span id="l44.401" class="difflineminus">-          if (val === undefined) {</span>
<a href="#l44.402"></a><span id="l44.402" class="difflineminus">-            this.preferences.rootBranch.clearUserPref(this.name);</span>
<a href="#l44.403"></a><span id="l44.403" class="difflineminus">-            return val;</span>
<a href="#l44.404"></a><span id="l44.404" class="difflineminus">-          }</span>
<a href="#l44.405"></a><span id="l44.405" class="difflineminus">-</span>
<a href="#l44.406"></a><span id="l44.406" class="difflineminus">-          // Force a resync of preferences with value.</span>
<a href="#l44.407"></a><span id="l44.407" class="difflineminus">-          switch (this.type) {</span>
<a href="#l44.408"></a><span id="l44.408" class="difflineminus">-          case &quot;int&quot;:</span>
<a href="#l44.409"></a><span id="l44.409" class="difflineminus">-            this.preferences.rootBranch.setIntPref(this.name, val);</span>
<a href="#l44.410"></a><span id="l44.410" class="difflineminus">-            break;</span>
<a href="#l44.411"></a><span id="l44.411" class="difflineminus">-          case &quot;bool&quot;:</span>
<a href="#l44.412"></a><span id="l44.412" class="difflineminus">-            this.preferences.rootBranch.setBoolPref(this.name, this.inverted ? !val : val);</span>
<a href="#l44.413"></a><span id="l44.413" class="difflineminus">-            break;</span>
<a href="#l44.414"></a><span id="l44.414" class="difflineminus">-          case &quot;wstring&quot;:</span>
<a href="#l44.415"></a><span id="l44.415" class="difflineminus">-            var pls = Cc[&quot;@mozilla.org/pref-localizedstring;1&quot;]</span>
<a href="#l44.416"></a><span id="l44.416" class="difflineminus">-                        .createInstance(Ci.nsIPrefLocalizedString);</span>
<a href="#l44.417"></a><span id="l44.417" class="difflineminus">-            pls.data = val;</span>
<a href="#l44.418"></a><span id="l44.418" class="difflineminus">-            this.preferences.rootBranch</span>
<a href="#l44.419"></a><span id="l44.419" class="difflineminus">-                .setComplexValue(this.name, Ci.nsIPrefLocalizedString, pls);</span>
<a href="#l44.420"></a><span id="l44.420" class="difflineminus">-            break;</span>
<a href="#l44.421"></a><span id="l44.421" class="difflineminus">-          case &quot;string&quot;:</span>
<a href="#l44.422"></a><span id="l44.422" class="difflineminus">-          case &quot;unichar&quot;:</span>
<a href="#l44.423"></a><span id="l44.423" class="difflineminus">-          case &quot;fontname&quot;:</span>
<a href="#l44.424"></a><span id="l44.424" class="difflineminus">-            this.preferences.rootBranch.setStringPref(this.name, val);</span>
<a href="#l44.425"></a><span id="l44.425" class="difflineminus">-            break;</span>
<a href="#l44.426"></a><span id="l44.426" class="difflineminus">-          case &quot;file&quot;:</span>
<a href="#l44.427"></a><span id="l44.427" class="difflineminus">-            var lf;</span>
<a href="#l44.428"></a><span id="l44.428" class="difflineminus">-            if (typeof(val) == &quot;string&quot;) {</span>
<a href="#l44.429"></a><span id="l44.429" class="difflineminus">-              lf = Cc[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l44.430"></a><span id="l44.430" class="difflineminus">-                     .createInstance(Ci.nsIFile);</span>
<a href="#l44.431"></a><span id="l44.431" class="difflineminus">-              lf.persistentDescriptor = val;</span>
<a href="#l44.432"></a><span id="l44.432" class="difflineminus">-              if (!lf.exists())</span>
<a href="#l44.433"></a><span id="l44.433" class="difflineminus">-                lf.initWithPath(val);</span>
<a href="#l44.434"></a><span id="l44.434" class="difflineminus">-            } else {</span>
<a href="#l44.435"></a><span id="l44.435" class="difflineminus">-              lf = val.QueryInterface(Ci.nsIFile);</span>
<a href="#l44.436"></a><span id="l44.436" class="difflineminus">-            }</span>
<a href="#l44.437"></a><span id="l44.437" class="difflineminus">-            this.preferences.rootBranch</span>
<a href="#l44.438"></a><span id="l44.438" class="difflineminus">-                .setComplexValue(this.name, Ci.nsIFile, lf);</span>
<a href="#l44.439"></a><span id="l44.439" class="difflineminus">-            break;</span>
<a href="#l44.440"></a><span id="l44.440" class="difflineminus">-          default:</span>
<a href="#l44.441"></a><span id="l44.441" class="difflineminus">-            this._reportUnknownType();</span>
<a href="#l44.442"></a><span id="l44.442" class="difflineminus">-          }</span>
<a href="#l44.443"></a><span id="l44.443" class="difflineminus">-          if (!this.batching)</span>
<a href="#l44.444"></a><span id="l44.444" class="difflineminus">-            this.preferences.service.savePrefFile(null);</span>
<a href="#l44.445"></a><span id="l44.445" class="difflineminus">-          return val;</span>
<a href="#l44.446"></a><span id="l44.446" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.447"></a><span id="l44.447" class="difflineminus">-        &lt;/setter&gt;</span>
<a href="#l44.448"></a><span id="l44.448" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.449"></a><span id="l44.449" class="difflineminus">-</span>
<a href="#l44.450"></a><span id="l44.450" class="difflineminus">-      &lt;method name=&quot;setElementValue&quot;&gt;</span>
<a href="#l44.451"></a><span id="l44.451" class="difflineminus">-        &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l44.452"></a><span id="l44.452" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.453"></a><span id="l44.453" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.454"></a><span id="l44.454" class="difflineminus">-          if (this.locked)</span>
<a href="#l44.455"></a><span id="l44.455" class="difflineminus">-            aElement.disabled = true;</span>
<a href="#l44.456"></a><span id="l44.456" class="difflineminus">-</span>
<a href="#l44.457"></a><span id="l44.457" class="difflineminus">-          if (!this.isElementEditable(aElement))</span>
<a href="#l44.458"></a><span id="l44.458" class="difflineminus">-            return;</span>
<a href="#l44.459"></a><span id="l44.459" class="difflineminus">-</span>
<a href="#l44.460"></a><span id="l44.460" class="difflineminus">-          var rv = undefined;</span>
<a href="#l44.461"></a><span id="l44.461" class="difflineminus">-          if (aElement.hasAttribute(&quot;onsyncfrompreference&quot;)) {</span>
<a href="#l44.462"></a><span id="l44.462" class="difflineminus">-            // Value changed, synthesize an event</span>
<a href="#l44.463"></a><span id="l44.463" class="difflineminus">-            try {</span>
<a href="#l44.464"></a><span id="l44.464" class="difflineminus">-              var event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l44.465"></a><span id="l44.465" class="difflineminus">-              event.initEvent(&quot;syncfrompreference&quot;, true, true);</span>
<a href="#l44.466"></a><span id="l44.466" class="difflineminus">-              var f = new Function(&quot;event&quot;,</span>
<a href="#l44.467"></a><span id="l44.467" class="difflineminus">-                                   aElement.getAttribute(&quot;onsyncfrompreference&quot;));</span>
<a href="#l44.468"></a><span id="l44.468" class="difflineminus">-              rv = f.call(aElement, event);</span>
<a href="#l44.469"></a><span id="l44.469" class="difflineminus">-            } catch (e) {</span>
<a href="#l44.470"></a><span id="l44.470" class="difflineminus">-              Cu.reportError(e);</span>
<a href="#l44.471"></a><span id="l44.471" class="difflineminus">-            }</span>
<a href="#l44.472"></a><span id="l44.472" class="difflineminus">-          }</span>
<a href="#l44.473"></a><span id="l44.473" class="difflineminus">-          var val = rv;</span>
<a href="#l44.474"></a><span id="l44.474" class="difflineminus">-          if (val === undefined)</span>
<a href="#l44.475"></a><span id="l44.475" class="difflineminus">-            val = this.instantApply ? this.valueFromPreferences : this.value;</span>
<a href="#l44.476"></a><span id="l44.476" class="difflineminus">-          // if the preference is marked for reset, show default value in UI</span>
<a href="#l44.477"></a><span id="l44.477" class="difflineminus">-          if (val === undefined)</span>
<a href="#l44.478"></a><span id="l44.478" class="difflineminus">-            val = this.defaultValue;</span>
<a href="#l44.479"></a><span id="l44.479" class="difflineminus">-</span>
<a href="#l44.480"></a><span id="l44.480" class="difflineminus">-          /**</span>
<a href="#l44.481"></a><span id="l44.481" class="difflineminus">-           * Initialize a UI element property with a value. Handles the case</span>
<a href="#l44.482"></a><span id="l44.482" class="difflineminus">-           * where an element has not yet had a XBL binding attached for it and</span>
<a href="#l44.483"></a><span id="l44.483" class="difflineminus">-           * the property setter does not yet exist by setting the same attribute</span>
<a href="#l44.484"></a><span id="l44.484" class="difflineminus">-           * on the XUL element using DOM apis and assuming the element's</span>
<a href="#l44.485"></a><span id="l44.485" class="difflineminus">-           * constructor or property getters appropriately handle this state.</span>
<a href="#l44.486"></a><span id="l44.486" class="difflineminus">-           */</span>
<a href="#l44.487"></a><span id="l44.487" class="difflineminus">-          function setValue(element, attribute, value) {</span>
<a href="#l44.488"></a><span id="l44.488" class="difflineminus">-            if (attribute in element)</span>
<a href="#l44.489"></a><span id="l44.489" class="difflineminus">-              element[attribute] = value;</span>
<a href="#l44.490"></a><span id="l44.490" class="difflineminus">-            else</span>
<a href="#l44.491"></a><span id="l44.491" class="difflineminus">-              element.setAttribute(attribute, value);</span>
<a href="#l44.492"></a><span id="l44.492" class="difflineminus">-          }</span>
<a href="#l44.493"></a><span id="l44.493" class="difflineminus">-          if (aElement.localName == &quot;checkbox&quot;) {</span>
<a href="#l44.494"></a><span id="l44.494" class="difflineminus">-            setValue(aElement, &quot;checked&quot;, val);</span>
<a href="#l44.495"></a><span id="l44.495" class="difflineminus">-          } else if (aElement.localName == &quot;colorpicker&quot;) {</span>
<a href="#l44.496"></a><span id="l44.496" class="difflineminus">-            setValue(aElement, &quot;color&quot;, val);</span>
<a href="#l44.497"></a><span id="l44.497" class="difflineminus">-          } else if (aElement.localName == &quot;textbox&quot;) {</span>
<a href="#l44.498"></a><span id="l44.498" class="difflineminus">-            // XXXmano Bug 303998: Avoid a caret placement issue if either the</span>
<a href="#l44.499"></a><span id="l44.499" class="difflineminus">-            // preference observer or its setter calls updateElements as a result</span>
<a href="#l44.500"></a><span id="l44.500" class="difflineminus">-            // of the input event handler.</span>
<a href="#l44.501"></a><span id="l44.501" class="difflineminus">-            if (aElement.value !== val)</span>
<a href="#l44.502"></a><span id="l44.502" class="difflineminus">-              setValue(aElement, &quot;value&quot;, val);</span>
<a href="#l44.503"></a><span id="l44.503" class="difflineminus">-          } else {</span>
<a href="#l44.504"></a><span id="l44.504" class="difflineminus">-            setValue(aElement, &quot;value&quot;, val);</span>
<a href="#l44.505"></a><span id="l44.505" class="difflineminus">-          }</span>
<a href="#l44.506"></a><span id="l44.506" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.507"></a><span id="l44.507" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.508"></a><span id="l44.508" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.509"></a><span id="l44.509" class="difflineminus">-</span>
<a href="#l44.510"></a><span id="l44.510" class="difflineminus">-      &lt;method name=&quot;getElementValue&quot;&gt;</span>
<a href="#l44.511"></a><span id="l44.511" class="difflineminus">-        &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l44.512"></a><span id="l44.512" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.513"></a><span id="l44.513" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.514"></a><span id="l44.514" class="difflineminus">-          if (aElement.hasAttribute(&quot;onsynctopreference&quot;)) {</span>
<a href="#l44.515"></a><span id="l44.515" class="difflineminus">-            // Value changed, synthesize an event</span>
<a href="#l44.516"></a><span id="l44.516" class="difflineminus">-            try {</span>
<a href="#l44.517"></a><span id="l44.517" class="difflineminus">-              var event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l44.518"></a><span id="l44.518" class="difflineminus">-              event.initEvent(&quot;synctopreference&quot;, true, true);</span>
<a href="#l44.519"></a><span id="l44.519" class="difflineminus">-              var f = new Function(&quot;event&quot;,</span>
<a href="#l44.520"></a><span id="l44.520" class="difflineminus">-                                   aElement.getAttribute(&quot;onsynctopreference&quot;));</span>
<a href="#l44.521"></a><span id="l44.521" class="difflineminus">-              var rv = f.call(aElement, event);</span>
<a href="#l44.522"></a><span id="l44.522" class="difflineminus">-              if (rv !== undefined)</span>
<a href="#l44.523"></a><span id="l44.523" class="difflineminus">-                return rv;</span>
<a href="#l44.524"></a><span id="l44.524" class="difflineminus">-            } catch (e) {</span>
<a href="#l44.525"></a><span id="l44.525" class="difflineminus">-              Cu.reportError(e);</span>
<a href="#l44.526"></a><span id="l44.526" class="difflineminus">-            }</span>
<a href="#l44.527"></a><span id="l44.527" class="difflineminus">-          }</span>
<a href="#l44.528"></a><span id="l44.528" class="difflineminus">-</span>
<a href="#l44.529"></a><span id="l44.529" class="difflineminus">-          /**</span>
<a href="#l44.530"></a><span id="l44.530" class="difflineminus">-           * Read the value of an attribute from an element, assuming the</span>
<a href="#l44.531"></a><span id="l44.531" class="difflineminus">-           * attribute is a property on the element's node API. If the property</span>
<a href="#l44.532"></a><span id="l44.532" class="difflineminus">-           * is not present in the API, then assume its value is contained in</span>
<a href="#l44.533"></a><span id="l44.533" class="difflineminus">-           * an attribute, as is the case before a binding has been attached.</span>
<a href="#l44.534"></a><span id="l44.534" class="difflineminus">-           */</span>
<a href="#l44.535"></a><span id="l44.535" class="difflineminus">-          function getValue(element, attribute) {</span>
<a href="#l44.536"></a><span id="l44.536" class="difflineminus">-            if (attribute in element)</span>
<a href="#l44.537"></a><span id="l44.537" class="difflineminus">-              return element[attribute];</span>
<a href="#l44.538"></a><span id="l44.538" class="difflineminus">-            return element.getAttribute(attribute);</span>
<a href="#l44.539"></a><span id="l44.539" class="difflineminus">-          }</span>
<a href="#l44.540"></a><span id="l44.540" class="difflineminus">-          if (aElement.localName == &quot;checkbox&quot;)</span>
<a href="#l44.541"></a><span id="l44.541" class="difflineminus">-            var value = getValue(aElement, &quot;checked&quot;);</span>
<a href="#l44.542"></a><span id="l44.542" class="difflineminus">-          else if (aElement.localName == &quot;colorpicker&quot;)</span>
<a href="#l44.543"></a><span id="l44.543" class="difflineminus">-            value = getValue(aElement, &quot;color&quot;);</span>
<a href="#l44.544"></a><span id="l44.544" class="difflineminus">-          else</span>
<a href="#l44.545"></a><span id="l44.545" class="difflineminus">-            value = getValue(aElement, &quot;value&quot;);</span>
<a href="#l44.546"></a><span id="l44.546" class="difflineminus">-</span>
<a href="#l44.547"></a><span id="l44.547" class="difflineminus">-          switch (this.type) {</span>
<a href="#l44.548"></a><span id="l44.548" class="difflineminus">-          case &quot;int&quot;:</span>
<a href="#l44.549"></a><span id="l44.549" class="difflineminus">-            return parseInt(value, 10) || 0;</span>
<a href="#l44.550"></a><span id="l44.550" class="difflineminus">-          case &quot;bool&quot;:</span>
<a href="#l44.551"></a><span id="l44.551" class="difflineminus">-            return typeof(value) == &quot;boolean&quot; ? value : value == &quot;true&quot;;</span>
<a href="#l44.552"></a><span id="l44.552" class="difflineminus">-          }</span>
<a href="#l44.553"></a><span id="l44.553" class="difflineminus">-          return value;</span>
<a href="#l44.554"></a><span id="l44.554" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.555"></a><span id="l44.555" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.556"></a><span id="l44.556" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.557"></a><span id="l44.557" class="difflineminus">-</span>
<a href="#l44.558"></a><span id="l44.558" class="difflineminus">-      &lt;method name=&quot;isElementEditable&quot;&gt;</span>
<a href="#l44.559"></a><span id="l44.559" class="difflineminus">-        &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l44.560"></a><span id="l44.560" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.561"></a><span id="l44.561" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.562"></a><span id="l44.562" class="difflineminus">-          switch (aElement.localName) {</span>
<a href="#l44.563"></a><span id="l44.563" class="difflineminus">-          case &quot;checkbox&quot;:</span>
<a href="#l44.564"></a><span id="l44.564" class="difflineminus">-          case &quot;colorpicker&quot;:</span>
<a href="#l44.565"></a><span id="l44.565" class="difflineminus">-          case &quot;radiogroup&quot;:</span>
<a href="#l44.566"></a><span id="l44.566" class="difflineminus">-          case &quot;textbox&quot;:</span>
<a href="#l44.567"></a><span id="l44.567" class="difflineminus">-          case &quot;richlistitem&quot;:</span>
<a href="#l44.568"></a><span id="l44.568" class="difflineminus">-          case &quot;richlistbox&quot;:</span>
<a href="#l44.569"></a><span id="l44.569" class="difflineminus">-          case &quot;menulist&quot;:</span>
<a href="#l44.570"></a><span id="l44.570" class="difflineminus">-            return true;</span>
<a href="#l44.571"></a><span id="l44.571" class="difflineminus">-          }</span>
<a href="#l44.572"></a><span id="l44.572" class="difflineminus">-          return aElement.getAttribute(&quot;preference-editable&quot;) == &quot;true&quot;;</span>
<a href="#l44.573"></a><span id="l44.573" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.574"></a><span id="l44.574" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.575"></a><span id="l44.575" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.576"></a><span id="l44.576" class="difflineminus">-</span>
<a href="#l44.577"></a><span id="l44.577" class="difflineminus">-      &lt;method name=&quot;updateElements&quot;&gt;</span>
<a href="#l44.578"></a><span id="l44.578" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.579"></a><span id="l44.579" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.580"></a><span id="l44.580" class="difflineminus">-          if (!this.id)</span>
<a href="#l44.581"></a><span id="l44.581" class="difflineminus">-            return;</span>
<a href="#l44.582"></a><span id="l44.582" class="difflineminus">-</span>
<a href="#l44.583"></a><span id="l44.583" class="difflineminus">-          // This &quot;change&quot; event handler tracks changes made to preferences by</span>
<a href="#l44.584"></a><span id="l44.584" class="difflineminus">-          // sources other than the user in this window.</span>
<a href="#l44.585"></a><span id="l44.585" class="difflineminus">-          var elements = document.getElementsByAttribute(&quot;preference&quot;, this.id);</span>
<a href="#l44.586"></a><span id="l44.586" class="difflineminus">-          for (var i = 0; i &lt; elements.length; ++i)</span>
<a href="#l44.587"></a><span id="l44.587" class="difflineminus">-            this.setElementValue(elements[i]);</span>
<a href="#l44.588"></a><span id="l44.588" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.589"></a><span id="l44.589" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.590"></a><span id="l44.590" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.591"></a><span id="l44.591" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l44.592"></a><span id="l44.592" class="difflineminus">-</span>
<a href="#l44.593"></a><span id="l44.593" class="difflineminus">-    &lt;handlers&gt;</span>
<a href="#l44.594"></a><span id="l44.594" class="difflineminus">-      &lt;handler event=&quot;change&quot;&gt;</span>
<a href="#l44.595"></a><span id="l44.595" class="difflineminus">-        this.updateElements();</span>
<a href="#l44.596"></a><span id="l44.596" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l44.597"></a><span id="l44.597" class="difflineminus">-    &lt;/handlers&gt;</span>
<a href="#l44.598"></a><span id="l44.598" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l44.599"></a><span id="l44.599" class="difflineminus">-</span>
<a href="#l44.600"></a><span id="l44.600" class="difflineminus">-  &lt;binding id=&quot;prefpane&quot;&gt;</span>
<a href="#l44.601"></a><span id="l44.601" class="difflineminus">-    &lt;implementation&gt;</span>
<a href="#l44.602"></a><span id="l44.602" class="difflineminus">-      &lt;method name=&quot;writePreferences&quot;&gt;</span>
<a href="#l44.603"></a><span id="l44.603" class="difflineminus">-        &lt;parameter name=&quot;aFlushToDisk&quot;/&gt;</span>
<a href="#l44.604"></a><span id="l44.604" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.605"></a><span id="l44.605" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.606"></a><span id="l44.606" class="difflineminus">-          // Write all values to preferences.</span>
<a href="#l44.607"></a><span id="l44.607" class="difflineminus">-          if (this._deferredValueUpdateElements.size) {</span>
<a href="#l44.608"></a><span id="l44.608" class="difflineminus">-            this._finalizeDeferredElements();</span>
<a href="#l44.609"></a><span id="l44.609" class="difflineminus">-          }</span>
<a href="#l44.610"></a><span id="l44.610" class="difflineminus">-</span>
<a href="#l44.611"></a><span id="l44.611" class="difflineminus">-          var preferences = this.preferences;</span>
<a href="#l44.612"></a><span id="l44.612" class="difflineminus">-          for (var i = 0; i &lt; preferences.length; ++i) {</span>
<a href="#l44.613"></a><span id="l44.613" class="difflineminus">-            var preference = preferences[i];</span>
<a href="#l44.614"></a><span id="l44.614" class="difflineminus">-            preference.batching = true;</span>
<a href="#l44.615"></a><span id="l44.615" class="difflineminus">-            preference.valueFromPreferences = preference.value;</span>
<a href="#l44.616"></a><span id="l44.616" class="difflineminus">-            preference.batching = false;</span>
<a href="#l44.617"></a><span id="l44.617" class="difflineminus">-          }</span>
<a href="#l44.618"></a><span id="l44.618" class="difflineminus">-          if (aFlushToDisk) {</span>
<a href="#l44.619"></a><span id="l44.619" class="difflineminus">-            var psvc = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l44.620"></a><span id="l44.620" class="difflineminus">-                         .getService(Ci.nsIPrefService);</span>
<a href="#l44.621"></a><span id="l44.621" class="difflineminus">-            psvc.savePrefFile(null);</span>
<a href="#l44.622"></a><span id="l44.622" class="difflineminus">-          }</span>
<a href="#l44.623"></a><span id="l44.623" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.624"></a><span id="l44.624" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.625"></a><span id="l44.625" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.626"></a><span id="l44.626" class="difflineminus">-</span>
<a href="#l44.627"></a><span id="l44.627" class="difflineminus">-      &lt;property name=&quot;src&quot;</span>
<a href="#l44.628"></a><span id="l44.628" class="difflineminus">-                onget=&quot;return this.getAttribute('src');&quot;</span>
<a href="#l44.629"></a><span id="l44.629" class="difflineminus">-                onset=&quot;this.setAttribute('src', val); return val;&quot;/&gt;</span>
<a href="#l44.630"></a><span id="l44.630" class="difflineminus">-      &lt;property name=&quot;selected&quot;</span>
<a href="#l44.631"></a><span id="l44.631" class="difflineminus">-                onget=&quot;return this.getAttribute('selected') == 'true';&quot;</span>
<a href="#l44.632"></a><span id="l44.632" class="difflineminus">-                onset=&quot;this.setAttribute('selected', val); return val;&quot;/&gt;</span>
<a href="#l44.633"></a><span id="l44.633" class="difflineminus">-      &lt;property name=&quot;image&quot;</span>
<a href="#l44.634"></a><span id="l44.634" class="difflineminus">-                onget=&quot;return this.getAttribute('image');&quot;</span>
<a href="#l44.635"></a><span id="l44.635" class="difflineminus">-                onset=&quot;this.setAttribute('image', val); return val;&quot;/&gt;</span>
<a href="#l44.636"></a><span id="l44.636" class="difflineminus">-      &lt;property name=&quot;label&quot;</span>
<a href="#l44.637"></a><span id="l44.637" class="difflineminus">-                onget=&quot;return this.getAttribute('label');&quot;</span>
<a href="#l44.638"></a><span id="l44.638" class="difflineminus">-                onset=&quot;this.setAttribute('label', val); return val;&quot;/&gt;</span>
<a href="#l44.639"></a><span id="l44.639" class="difflineminus">-</span>
<a href="#l44.640"></a><span id="l44.640" class="difflineminus">-      &lt;property name=&quot;preferenceElements&quot;</span>
<a href="#l44.641"></a><span id="l44.641" class="difflineminus">-                onget=&quot;return this.getElementsByAttribute('preference', '*');&quot;/&gt;</span>
<a href="#l44.642"></a><span id="l44.642" class="difflineminus">-      &lt;property name=&quot;preferences&quot;</span>
<a href="#l44.643"></a><span id="l44.643" class="difflineminus">-                onget=&quot;return this.getElementsByTagName('preference');&quot;/&gt;</span>
<a href="#l44.644"></a><span id="l44.644" class="difflineminus">-</span>
<a href="#l44.645"></a><span id="l44.645" class="difflineminus">-      &lt;property name=&quot;helpTopic&quot;&gt;</span>
<a href="#l44.646"></a><span id="l44.646" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.647"></a><span id="l44.647" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.648"></a><span id="l44.648" class="difflineminus">-          // if there are tabs, and the selected tab provides a helpTopic, return that</span>
<a href="#l44.649"></a><span id="l44.649" class="difflineminus">-          var box = this.getElementsByTagName(&quot;tabbox&quot;);</span>
<a href="#l44.650"></a><span id="l44.650" class="difflineminus">-          if (box[0]) {</span>
<a href="#l44.651"></a><span id="l44.651" class="difflineminus">-            var tab = box[0].selectedTab;</span>
<a href="#l44.652"></a><span id="l44.652" class="difflineminus">-            if (tab &amp;&amp; tab.hasAttribute(&quot;helpTopic&quot;))</span>
<a href="#l44.653"></a><span id="l44.653" class="difflineminus">-              return tab.getAttribute(&quot;helpTopic&quot;);</span>
<a href="#l44.654"></a><span id="l44.654" class="difflineminus">-          }</span>
<a href="#l44.655"></a><span id="l44.655" class="difflineminus">-</span>
<a href="#l44.656"></a><span id="l44.656" class="difflineminus">-          // otherwise, return the helpTopic of the current panel</span>
<a href="#l44.657"></a><span id="l44.657" class="difflineminus">-          return this.getAttribute(&quot;helpTopic&quot;);</span>
<a href="#l44.658"></a><span id="l44.658" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.659"></a><span id="l44.659" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.660"></a><span id="l44.660" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.661"></a><span id="l44.661" class="difflineminus">-</span>
<a href="#l44.662"></a><span id="l44.662" class="difflineminus">-      &lt;field name=&quot;_loaded&quot;&gt;false&lt;/field&gt;</span>
<a href="#l44.663"></a><span id="l44.663" class="difflineminus">-      &lt;property name=&quot;loaded&quot;</span>
<a href="#l44.664"></a><span id="l44.664" class="difflineminus">-                onget=&quot;return !this.src ? true : this._loaded;&quot;</span>
<a href="#l44.665"></a><span id="l44.665" class="difflineminus">-                onset=&quot;this._loaded = val; return val;&quot;/&gt;</span>
<a href="#l44.666"></a><span id="l44.666" class="difflineminus">-</span>
<a href="#l44.667"></a><span id="l44.667" class="difflineminus">-      &lt;method name=&quot;preferenceForElement&quot;&gt;</span>
<a href="#l44.668"></a><span id="l44.668" class="difflineminus">-        &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l44.669"></a><span id="l44.669" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.670"></a><span id="l44.670" class="difflineminus">-          return document.getElementById(aElement.getAttribute(&quot;preference&quot;));</span>
<a href="#l44.671"></a><span id="l44.671" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.672"></a><span id="l44.672" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.673"></a><span id="l44.673" class="difflineminus">-</span>
<a href="#l44.674"></a><span id="l44.674" class="difflineminus">-      &lt;method name=&quot;getPreferenceElement&quot;&gt;</span>
<a href="#l44.675"></a><span id="l44.675" class="difflineminus">-        &lt;parameter name=&quot;aStartElement&quot;/&gt;</span>
<a href="#l44.676"></a><span id="l44.676" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.677"></a><span id="l44.677" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.678"></a><span id="l44.678" class="difflineminus">-          var temp = aStartElement;</span>
<a href="#l44.679"></a><span id="l44.679" class="difflineminus">-          while (temp &amp;&amp; temp.nodeType == Node.ELEMENT_NODE &amp;&amp;</span>
<a href="#l44.680"></a><span id="l44.680" class="difflineminus">-                 !temp.hasAttribute(&quot;preference&quot;))</span>
<a href="#l44.681"></a><span id="l44.681" class="difflineminus">-            temp = temp.parentNode;</span>
<a href="#l44.682"></a><span id="l44.682" class="difflineminus">-          return temp &amp;&amp; temp.nodeType == Node.ELEMENT_NODE ?</span>
<a href="#l44.683"></a><span id="l44.683" class="difflineminus">-                 temp : aStartElement;</span>
<a href="#l44.684"></a><span id="l44.684" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.685"></a><span id="l44.685" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.686"></a><span id="l44.686" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.687"></a><span id="l44.687" class="difflineminus">-</span>
<a href="#l44.688"></a><span id="l44.688" class="difflineminus">-      &lt;property name=&quot;DeferredTask&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l44.689"></a><span id="l44.689" class="difflineminus">-        &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l44.690"></a><span id="l44.690" class="difflineminus">-          let module = {};</span>
<a href="#l44.691"></a><span id="l44.691" class="difflineminus">-          ChromeUtils.import(&quot;resource://gre/modules/DeferredTask.jsm&quot;, module);</span>
<a href="#l44.692"></a><span id="l44.692" class="difflineminus">-          Object.defineProperty(this, &quot;DeferredTask&quot;, {</span>
<a href="#l44.693"></a><span id="l44.693" class="difflineminus">-            configurable: true,</span>
<a href="#l44.694"></a><span id="l44.694" class="difflineminus">-            enumerable: true,</span>
<a href="#l44.695"></a><span id="l44.695" class="difflineminus">-            writable: true,</span>
<a href="#l44.696"></a><span id="l44.696" class="difflineminus">-            value: module.DeferredTask,</span>
<a href="#l44.697"></a><span id="l44.697" class="difflineminus">-          });</span>
<a href="#l44.698"></a><span id="l44.698" class="difflineminus">-          return module.DeferredTask;</span>
<a href="#l44.699"></a><span id="l44.699" class="difflineminus">-        ]]&gt;&lt;/getter&gt;</span>
<a href="#l44.700"></a><span id="l44.700" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.701"></a><span id="l44.701" class="difflineminus">-      &lt;method name=&quot;_deferredValueUpdate&quot;&gt;</span>
<a href="#l44.702"></a><span id="l44.702" class="difflineminus">-        &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l44.703"></a><span id="l44.703" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.704"></a><span id="l44.704" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.705"></a><span id="l44.705" class="difflineminus">-          delete aElement._deferredValueUpdateTask;</span>
<a href="#l44.706"></a><span id="l44.706" class="difflineminus">-          let preference = document.getElementById(aElement.getAttribute(&quot;preference&quot;));</span>
<a href="#l44.707"></a><span id="l44.707" class="difflineminus">-          let prefVal = preference.getElementValue(aElement);</span>
<a href="#l44.708"></a><span id="l44.708" class="difflineminus">-          preference.value = prefVal;</span>
<a href="#l44.709"></a><span id="l44.709" class="difflineminus">-          this._deferredValueUpdateElements.delete(aElement);</span>
<a href="#l44.710"></a><span id="l44.710" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.711"></a><span id="l44.711" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.712"></a><span id="l44.712" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.713"></a><span id="l44.713" class="difflineminus">-      &lt;field name=&quot;_deferredValueUpdateElements&quot;&gt;</span>
<a href="#l44.714"></a><span id="l44.714" class="difflineminus">-        new Set();</span>
<a href="#l44.715"></a><span id="l44.715" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l44.716"></a><span id="l44.716" class="difflineminus">-      &lt;method name=&quot;_finalizeDeferredElements&quot;&gt;</span>
<a href="#l44.717"></a><span id="l44.717" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.718"></a><span id="l44.718" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.719"></a><span id="l44.719" class="difflineminus">-          for (let el of this._deferredValueUpdateElements) {</span>
<a href="#l44.720"></a><span id="l44.720" class="difflineminus">-            if (el._deferredValueUpdateTask) {</span>
<a href="#l44.721"></a><span id="l44.721" class="difflineminus">-              el._deferredValueUpdateTask.finalize();</span>
<a href="#l44.722"></a><span id="l44.722" class="difflineminus">-            }</span>
<a href="#l44.723"></a><span id="l44.723" class="difflineminus">-          }</span>
<a href="#l44.724"></a><span id="l44.724" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.725"></a><span id="l44.725" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.726"></a><span id="l44.726" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.727"></a><span id="l44.727" class="difflineminus">-      &lt;method name=&quot;userChangedValue&quot;&gt;</span>
<a href="#l44.728"></a><span id="l44.728" class="difflineminus">-        &lt;parameter name=&quot;aElement&quot;/&gt;</span>
<a href="#l44.729"></a><span id="l44.729" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l44.730"></a><span id="l44.730" class="difflineminus">-        &lt;![CDATA[</span>
<a href="#l44.731"></a><span id="l44.731" class="difflineminus">-          let element = this.getPreferenceElement(aElement);</span>
<a href="#l44.732"></a><span id="l44.732" class="difflineminus">-          if (element.hasAttribute(&quot;preference&quot;)) {</span>
<a href="#l44.733"></a><span id="l44.733" class="difflineminus">-            if (element.getAttribute(&quot;delayprefsave&quot;) != &quot;true&quot;) {</span>
<a href="#l44.734"></a><span id="l44.734" class="difflineminus">-              var preference = document.getElementById(element.getAttribute(&quot;preference&quot;));</span>
<a href="#l44.735"></a><span id="l44.735" class="difflineminus">-              var prefVal = preference.getElementValue(element);</span>
<a href="#l44.736"></a><span id="l44.736" class="difflineminus">-              preference.value = prefVal;</span>
<a href="#l44.737"></a><span id="l44.737" class="difflineminus">-            } else {</span>
<a href="#l44.738"></a><span id="l44.738" class="difflineminus">-              if (!element._deferredValueUpdateTask) {</span>
<a href="#l44.739"></a><span id="l44.739" class="difflineminus">-                element._deferredValueUpdateTask = new this.DeferredTask(this._deferredValueUpdate.bind(this, element), 1000);</span>
<a href="#l44.740"></a><span id="l44.740" class="difflineminus">-                this._deferredValueUpdateElements.add(element);</span>
<a href="#l44.741"></a><span id="l44.741" class="difflineminus">-              } else {</span>
<a href="#l44.742"></a><span id="l44.742" class="difflineminus">-                // Each time the preference is changed, restart the delay.</span>
<a href="#l44.743"></a><span id="l44.743" class="difflineminus">-                element._deferredValueUpdateTask.disarm();</span>
<a href="#l44.744"></a><span id="l44.744" class="difflineminus">-              }</span>
<a href="#l44.745"></a><span id="l44.745" class="difflineminus">-              element._deferredValueUpdateTask.arm();</span>
<a href="#l44.746"></a><span id="l44.746" class="difflineminus">-            }</span>
<a href="#l44.747"></a><span id="l44.747" class="difflineminus">-          }</span>
<a href="#l44.748"></a><span id="l44.748" class="difflineminus">-        ]]&gt;</span>
<a href="#l44.749"></a><span id="l44.749" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l44.750"></a><span id="l44.750" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l44.751"></a><span id="l44.751" class="difflineminus">-</span>
<a href="#l44.752"></a><span id="l44.752" class="difflineminus">-      &lt;property name=&quot;contentHeight&quot;&gt;</span>
<a href="#l44.753"></a><span id="l44.753" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l44.754"></a><span id="l44.754" class="difflineminus">-          var targetHeight = parseInt(window.getComputedStyle(this).height);</span>
<a href="#l44.755"></a><span id="l44.755" class="difflineminus">-          targetHeight += parseInt(window.getComputedStyle(this).marginTop);</span>
<a href="#l44.756"></a><span id="l44.756" class="difflineminus">-          targetHeight += parseInt(window.getComputedStyle(this).marginBottom);</span>
<a href="#l44.757"></a><span id="l44.757" class="difflineminus">-          return targetHeight;</span>
<a href="#l44.758"></a><span id="l44.758" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l44.759"></a><span id="l44.759" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l44.760"></a><span id="l44.760" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l44.761"></a><span id="l44.761" class="difflineminus">-    &lt;handlers&gt;</span>
<a href="#l44.762"></a><span id="l44.762" class="difflineminus">-      &lt;handler event=&quot;command&quot;&gt;</span>
<a href="#l44.763"></a><span id="l44.763" class="difflineminus">-        // This &quot;command&quot; event handler tracks changes made to preferences by</span>
<a href="#l44.764"></a><span id="l44.764" class="difflineminus">-        // the user in this window.</span>
<a href="#l44.765"></a><span id="l44.765" class="difflineminus">-        if (event.sourceEvent)</span>
<a href="#l44.766"></a><span id="l44.766" class="difflineminus">-          event = event.sourceEvent;</span>
<a href="#l44.767"></a><span id="l44.767" class="difflineminus">-        this.userChangedValue(event.target);</span>
<a href="#l44.768"></a><span id="l44.768" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l44.769"></a><span id="l44.769" class="difflineminus">-      &lt;handler event=&quot;select&quot;&gt;</span>
<a href="#l44.770"></a><span id="l44.770" class="difflineminus">-        // This &quot;select&quot; event handler tracks changes made to colorpicker</span>
<a href="#l44.771"></a><span id="l44.771" class="difflineminus">-        // preferences by the user in this window.</span>
<a href="#l44.772"></a><span id="l44.772" class="difflineminus">-        if (event.target.localName == &quot;colorpicker&quot;)</span>
<a href="#l44.773"></a><span id="l44.773" class="difflineminus">-          this.userChangedValue(event.target);</span>
<a href="#l44.774"></a><span id="l44.774" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l44.775"></a><span id="l44.775" class="difflineminus">-      &lt;handler event=&quot;change&quot;&gt;</span>
<a href="#l44.776"></a><span id="l44.776" class="difflineminus">-        // This &quot;change&quot; event handler tracks changes made to preferences by</span>
<a href="#l44.777"></a><span id="l44.777" class="difflineminus">-        // the user in this window.</span>
<a href="#l44.778"></a><span id="l44.778" class="difflineminus">-        this.userChangedValue(event.target);</span>
<a href="#l44.779"></a><span id="l44.779" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l44.780"></a><span id="l44.780" class="difflineminus">-      &lt;handler event=&quot;input&quot;&gt;</span>
<a href="#l44.781"></a><span id="l44.781" class="difflineminus">-        // This &quot;input&quot; event handler tracks changes made to preferences by</span>
<a href="#l44.782"></a><span id="l44.782" class="difflineminus">-        // the user in this window.</span>
<a href="#l44.783"></a><span id="l44.783" class="difflineminus">-        this.userChangedValue(event.target);</span>
<a href="#l44.784"></a><span id="l44.784" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l44.785"></a><span id="l44.785" class="difflineminus">-      &lt;handler event=&quot;paneload&quot;&gt;</span>
<a href="#l44.786"></a><span id="l44.786" class="difflineminus">-      &lt;![CDATA[</span>
<a href="#l44.787"></a><span id="l44.787" class="difflineminus">-        // Initialize all values from preferences.</span>
<a href="#l44.788"></a><span id="l44.788" class="difflineminus">-        var elements = this.preferenceElements;</span>
<a href="#l44.789"></a><span id="l44.789" class="difflineminus">-        for (var i = 0; i &lt; elements.length; ++i) {</span>
<a href="#l44.790"></a><span id="l44.790" class="difflineminus">-          try {</span>
<a href="#l44.791"></a><span id="l44.791" class="difflineminus">-            var preference = this.preferenceForElement(elements[i]);</span>
<a href="#l44.792"></a><span id="l44.792" class="difflineminus">-            preference.setElementValue(elements[i]);</span>
<a href="#l44.793"></a><span id="l44.793" class="difflineminus">-          } catch (e) {</span>
<a href="#l44.794"></a><span id="l44.794" class="difflineminus">-            dump(&quot;*** No preference found for &quot; + elements[i].getAttribute(&quot;preference&quot;) + &quot;\n&quot;);</span>
<a href="#l44.795"></a><span id="l44.795" class="difflineminus">-          }</span>
<a href="#l44.796"></a><span id="l44.796" class="difflineminus">-        }</span>
<a href="#l44.797"></a><span id="l44.797" class="difflineminus">-      ]]&gt;</span>
<a href="#l44.798"></a><span id="l44.798" class="difflineminus">-      &lt;/handler&gt;</span>
<a href="#l44.799"></a><span id="l44.799" class="difflineminus">-    &lt;/handlers&gt;</span>
<a href="#l44.800"></a><span id="l44.800" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l44.801"></a><span id="l44.801" class="difflineminus">-</span>
<a href="#l44.802"></a><span id="l44.802">   &lt;binding id=&quot;panebutton&quot; role=&quot;listitem&quot;</span>
<a href="#l44.803"></a><span id="l44.803">            extends=&quot;chrome://global/content/bindings/radio.xml#radio&quot;&gt;</span>
<a href="#l44.804"></a><span id="l44.804">     &lt;content&gt;</span>
<a href="#l44.805"></a><span id="l44.805">       &lt;xul:image class=&quot;paneButtonIcon&quot; xbl:inherits=&quot;src&quot;/&gt;</span>
<a href="#l44.806"></a><span id="l44.806">       &lt;xul:label class=&quot;paneButtonLabel&quot; xbl:inherits=&quot;value=label&quot;/&gt;</span>
<a href="#l44.807"></a><span id="l44.807">     &lt;/content&gt;</span>
<a href="#l44.808"></a><span id="l44.808">   &lt;/binding&gt;</span>
<a href="#l44.809"></a><span id="l44.809"> </span>
<a href="#l44.810"></a><span id="l44.810"> &lt;/bindings&gt;</span>
<a href="#l44.811"></a><span id="l44.811" class="difflineminus">-</span>
<a href="#l44.812"></a><span id="l44.812" class="difflineminus">-# -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l44.813"></a><span id="l44.813" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l44.814"></a><span id="l44.814" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l44.815"></a><span id="l44.815" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l44.816"></a><span id="l44.816" class="difflineminus">-</span>
<a href="#l44.817"></a><span id="l44.817" class="difflineminus">-#</span>
<a href="#l44.818"></a><span id="l44.818" class="difflineminus">-# This is PrefWindow 6. The Code Could Well Be Ready, Are You?</span>
<a href="#l44.819"></a><span id="l44.819" class="difflineminus">-#</span>
<a href="#l44.820"></a><span id="l44.820" class="difflineminus">-#    Historical References:</span>
<a href="#l44.821"></a><span id="l44.821" class="difflineminus">-#    PrefWindow V   (February 1, 2003)</span>
<a href="#l44.822"></a><span id="l44.822" class="difflineminus">-#    PrefWindow IV  (April 24, 2000)</span>
<a href="#l44.823"></a><span id="l44.823" class="difflineminus">-#    PrefWindow III (January 6, 2000)</span>
<a href="#l44.824"></a><span id="l44.824" class="difflineminus">-#    PrefWindow II  (???)</span>
<a href="#l44.825"></a><span id="l44.825" class="difflineminus">-#    PrefWindow I   (June 4, 1999)</span>
<a href="#l44.826"></a><span id="l44.826" class="difflineminus">-#</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mail/components/preferences/privacy.inc.xul</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mail/components/preferences/privacy.inc.xul</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -1,54 +1,16 @@</span>
<a href="#l45.4"></a><span id="l45.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l45.5"></a><span id="l45.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l45.6"></a><span id="l45.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l45.7"></a><span id="l45.7">   &lt;prefpane id=&quot;panePrivacy&quot; label=&quot;&amp;panePrivacy.title;&quot;&gt;</span>
<a href="#l45.8"></a><span id="l45.8">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/privacy.js&quot;/&gt;</span>
<a href="#l45.9"></a><span id="l45.9"> </span>
<a href="#l45.10"></a><span id="l45.10">     &lt;stringbundle id=&quot;bundlePreferences&quot; src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l45.11"></a><span id="l45.11"> </span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-    &lt;preferences id=&quot;privacyPreferences&quot;&gt;</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineminus">-</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineminus">-      &lt;!-- XXX button prefs --&gt;</span>
<a href="#l45.15"></a><span id="l45.15" class="difflineminus">-      &lt;preference id=&quot;pref.privacy.disable_button.cookie_exceptions&quot;</span>
<a href="#l45.16"></a><span id="l45.16" class="difflineminus">-                  name=&quot;pref.privacy.disable_button.cookie_exceptions&quot;</span>
<a href="#l45.17"></a><span id="l45.17" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineminus">-      &lt;preference id=&quot;pref.privacy.disable_button.view_cookies&quot;</span>
<a href="#l45.19"></a><span id="l45.19" class="difflineminus">-                  name=&quot;pref.privacy.disable_button.view_cookies&quot;</span>
<a href="#l45.20"></a><span id="l45.20" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l45.21"></a><span id="l45.21" class="difflineminus">-</span>
<a href="#l45.22"></a><span id="l45.22" class="difflineminus">-      &lt;!-- Remote Content --&gt;</span>
<a href="#l45.23"></a><span id="l45.23" class="difflineminus">-      &lt;preference id=&quot;mailnews.message_display.disable_remote_image&quot;</span>
<a href="#l45.24"></a><span id="l45.24" class="difflineminus">-                  name=&quot;mailnews.message_display.disable_remote_image&quot;</span>
<a href="#l45.25"></a><span id="l45.25" class="difflineminus">-                  type=&quot;bool&quot; inverted=&quot;true&quot;</span>
<a href="#l45.26"></a><span id="l45.26" class="difflineminus">-                  onchange=&quot;gPrivacyPane.reloadMessageInOpener();&quot;/&gt;</span>
<a href="#l45.27"></a><span id="l45.27" class="difflineminus">-</span>
<a href="#l45.28"></a><span id="l45.28" class="difflineminus">-      &lt;!-- History --&gt;</span>
<a href="#l45.29"></a><span id="l45.29" class="difflineminus">-      &lt;preference id=&quot;places.history.enabled&quot;</span>
<a href="#l45.30"></a><span id="l45.30" class="difflineminus">-                  name=&quot;places.history.enabled&quot;</span>
<a href="#l45.31"></a><span id="l45.31" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineminus">-</span>
<a href="#l45.33"></a><span id="l45.33" class="difflineminus">-      &lt;!-- Cookies --&gt;</span>
<a href="#l45.34"></a><span id="l45.34" class="difflineminus">-      &lt;preference id=&quot;network.cookie.cookieBehavior&quot;</span>
<a href="#l45.35"></a><span id="l45.35" class="difflineminus">-                  name=&quot;network.cookie.cookieBehavior&quot;</span>
<a href="#l45.36"></a><span id="l45.36" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l45.37"></a><span id="l45.37" class="difflineminus">-      &lt;preference id=&quot;network.cookie.lifetimePolicy&quot;</span>
<a href="#l45.38"></a><span id="l45.38" class="difflineminus">-                  name=&quot;network.cookie.lifetimePolicy&quot;</span>
<a href="#l45.39"></a><span id="l45.39" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l45.40"></a><span id="l45.40" class="difflineminus">-      &lt;preference id=&quot;network.cookie.blockFutureCookies&quot;</span>
<a href="#l45.41"></a><span id="l45.41" class="difflineminus">-                  name=&quot;network.cookie.blockFutureCookies&quot;</span>
<a href="#l45.42"></a><span id="l45.42" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l45.43"></a><span id="l45.43" class="difflineminus">-</span>
<a href="#l45.44"></a><span id="l45.44" class="difflineminus">-      &lt;!-- Tracking --&gt;</span>
<a href="#l45.45"></a><span id="l45.45" class="difflineminus">-      &lt;preference id=&quot;privacy.donottrackheader.enabled&quot;</span>
<a href="#l45.46"></a><span id="l45.46" class="difflineminus">-                  name=&quot;privacy.donottrackheader.enabled&quot;</span>
<a href="#l45.47"></a><span id="l45.47" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l45.48"></a><span id="l45.48" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l45.49"></a><span id="l45.49" class="difflineminus">-</span>
<a href="#l45.50"></a><span id="l45.50">     &lt;!-- Mail Content --&gt;</span>
<a href="#l45.51"></a><span id="l45.51">     &lt;groupbox id=&quot;mailContentGroup&quot;&gt;</span>
<a href="#l45.52"></a><span id="l45.52">       &lt;label&gt;&lt;html:h2&gt;&amp;captionMailContent.label;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l45.53"></a><span id="l45.53">       &lt;hbox id=&quot;remoteContentBox&quot;&gt;</span>
<a href="#l45.54"></a><span id="l45.54">         &lt;checkbox id=&quot;acceptRemoteContent&quot;</span>
<a href="#l45.55"></a><span id="l45.55">                   preference=&quot;mailnews.message_display.disable_remote_image&quot;</span>
<a href="#l45.56"></a><span id="l45.56">                   label=&quot;&amp;acceptRemoteContent.label;&quot;</span>
<a href="#l45.57"></a><span id="l45.57">                   accesskey=&quot;&amp;acceptRemoteContent.accesskey;&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mail/components/preferences/privacy.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mail/components/preferences/privacy.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -3,16 +3,27 @@</span>
<a href="#l46.4"></a><span id="l46.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l46.5"></a><span id="l46.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l46.6"></a><span id="l46.6"> </span>
<a href="#l46.7"></a><span id="l46.7"> &quot;use strict&quot;;</span>
<a href="#l46.8"></a><span id="l46.8"> </span>
<a href="#l46.9"></a><span id="l46.9"> /* import-globals-from preferences.js */</span>
<a href="#l46.10"></a><span id="l46.10"> /* import-globals-from subdialogs.js */</span>
<a href="#l46.11"></a><span id="l46.11"> </span>
<a href="#l46.12"></a><span id="l46.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+  { id: &quot;pref.privacy.disable_button.cookie_exceptions&quot;, type: &quot;bool&quot; },</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineplus">+  { id: &quot;pref.privacy.disable_button.view_cookies&quot;, type: &quot;bool&quot; },</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineplus">+  { id: &quot;mailnews.message_display.disable_remote_image&quot;, type: &quot;bool&quot;, inverted: &quot;true&quot; },</span>
<a href="#l46.16"></a><span id="l46.16" class="difflineplus">+  { id: &quot;places.history.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l46.17"></a><span id="l46.17" class="difflineplus">+  { id: &quot;network.cookie.cookieBehavior&quot;, type: &quot;int&quot; },</span>
<a href="#l46.18"></a><span id="l46.18" class="difflineplus">+  { id: &quot;network.cookie.lifetimePolicy&quot;, type: &quot;int&quot; },</span>
<a href="#l46.19"></a><span id="l46.19" class="difflineplus">+  { id: &quot;network.cookie.blockFutureCookies&quot;, type: &quot;bool&quot; },</span>
<a href="#l46.20"></a><span id="l46.20" class="difflineplus">+  { id: &quot;privacy.donottrackheader.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l46.21"></a><span id="l46.21" class="difflineplus">+]);</span>
<a href="#l46.22"></a><span id="l46.22" class="difflineplus">+</span>
<a href="#l46.23"></a><span id="l46.23"> document.getElementById(&quot;panePrivacy&quot;)</span>
<a href="#l46.24"></a><span id="l46.24">         .addEventListener(&quot;paneload&quot;, function() { gPrivacyPane.init(); });</span>
<a href="#l46.25"></a><span id="l46.25"> </span>
<a href="#l46.26"></a><span id="l46.26"> var gPrivacyPane = {</span>
<a href="#l46.27"></a><span id="l46.27"> </span>
<a href="#l46.28"></a><span id="l46.28">   init() {</span>
<a href="#l46.29"></a><span id="l46.29">   },</span>
<a href="#l46.30"></a><span id="l46.30"> </span>
<a href="#l46.31"></a><span id="l46.31" class="difflineat">@@ -27,17 +38,17 @@ var gPrivacyPane = {</span>
<a href="#l46.32"></a><span id="l46.32">   },</span>
<a href="#l46.33"></a><span id="l46.33"> </span>
<a href="#l46.34"></a><span id="l46.34">   /**</span>
<a href="#l46.35"></a><span id="l46.35">    * Reads the network.cookie.cookieBehavior preference value and</span>
<a href="#l46.36"></a><span id="l46.36">    * enables/disables the rest of the cookie UI accordingly, returning true</span>
<a href="#l46.37"></a><span id="l46.37">    * if cookies are enabled.</span>
<a href="#l46.38"></a><span id="l46.38">    */</span>
<a href="#l46.39"></a><span id="l46.39">   readAcceptCookies() {</span>
<a href="#l46.40"></a><span id="l46.40" class="difflineminus">-    let pref = document.getElementById(&quot;network.cookie.cookieBehavior&quot;);</span>
<a href="#l46.41"></a><span id="l46.41" class="difflineplus">+    let pref = Preferences.get(&quot;network.cookie.cookieBehavior&quot;);</span>
<a href="#l46.42"></a><span id="l46.42">     let acceptThirdPartyLabel = document.getElementById(&quot;acceptThirdPartyLabel&quot;);</span>
<a href="#l46.43"></a><span id="l46.43">     let acceptThirdPartyMenu = document.getElementById(&quot;acceptThirdPartyMenu&quot;);</span>
<a href="#l46.44"></a><span id="l46.44">     let keepUntil = document.getElementById(&quot;keepUntil&quot;);</span>
<a href="#l46.45"></a><span id="l46.45">     let menu = document.getElementById(&quot;keepCookiesUntil&quot;);</span>
<a href="#l46.46"></a><span id="l46.46"> </span>
<a href="#l46.47"></a><span id="l46.47">     // enable the rest of the UI for anything other than &quot;disable all cookies&quot;</span>
<a href="#l46.48"></a><span id="l46.48">     let acceptCookies = (pref.value != 2);</span>
<a href="#l46.49"></a><span id="l46.49"> </span>
<a href="#l46.50"></a><span id="l46.50" class="difflineat">@@ -87,17 +98,17 @@ var gPrivacyPane = {</span>
<a href="#l46.51"></a><span id="l46.51">   showCookies(aCategory) {</span>
<a href="#l46.52"></a><span id="l46.52">     gSubDialog.open(&quot;chrome://messenger/content/preferences/cookies.xul&quot;);</span>
<a href="#l46.53"></a><span id="l46.53">   },</span>
<a href="#l46.54"></a><span id="l46.54"> </span>
<a href="#l46.55"></a><span id="l46.55">   /**</span>
<a href="#l46.56"></a><span id="l46.56">    * Converts between network.cookie.cookieBehavior and the third-party cookie UI</span>
<a href="#l46.57"></a><span id="l46.57">    */</span>
<a href="#l46.58"></a><span id="l46.58">   readAcceptThirdPartyCookies() {</span>
<a href="#l46.59"></a><span id="l46.59" class="difflineminus">-    let pref = document.getElementById(&quot;network.cookie.cookieBehavior&quot;);</span>
<a href="#l46.60"></a><span id="l46.60" class="difflineplus">+    let pref = Preferences.get(&quot;network.cookie.cookieBehavior&quot;);</span>
<a href="#l46.61"></a><span id="l46.61">     switch (pref.value) {</span>
<a href="#l46.62"></a><span id="l46.62">       case 0:</span>
<a href="#l46.63"></a><span id="l46.63">         return &quot;always&quot;;</span>
<a href="#l46.64"></a><span id="l46.64">       case 1:</span>
<a href="#l46.65"></a><span id="l46.65">         return &quot;never&quot;;</span>
<a href="#l46.66"></a><span id="l46.66">       case 2:</span>
<a href="#l46.67"></a><span id="l46.67">         return &quot;never&quot;;</span>
<a href="#l46.68"></a><span id="l46.68">       case 3:</span>
<a href="#l46.69"></a><span id="l46.69" class="difflineat">@@ -136,8 +147,10 @@ var gPrivacyPane = {</span>
<a href="#l46.70"></a><span id="l46.70">       permissionType: &quot;image&quot;,</span>
<a href="#l46.71"></a><span id="l46.71">       windowTitle: bundle.getString(&quot;imagepermissionstitle&quot;),</span>
<a href="#l46.72"></a><span id="l46.72">       introText: bundle.getString(&quot;imagepermissionstext&quot;),</span>
<a href="#l46.73"></a><span id="l46.73">     };</span>
<a href="#l46.74"></a><span id="l46.74">     gSubDialog.open(&quot;chrome://messenger/content/preferences/permissions.xul&quot;,</span>
<a href="#l46.75"></a><span id="l46.75">                     null, params);</span>
<a href="#l46.76"></a><span id="l46.76">   },</span>
<a href="#l46.77"></a><span id="l46.77"> };</span>
<a href="#l46.78"></a><span id="l46.78" class="difflineplus">+</span>
<a href="#l46.79"></a><span id="l46.79" class="difflineplus">+Preferences.get(&quot;mailnews.message_display.disable_remote_image&quot;).on(&quot;change&quot;, gPrivacyPane.reloadMessageInOpener);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mail/components/preferences/receipts.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mail/components/preferences/receipts.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -1,13 +1,24 @@</span>
<a href="#l47.4"></a><span id="l47.4"> /* -*- Mode: Javascript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l47.5"></a><span id="l47.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l47.6"></a><span id="l47.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l47.7"></a><span id="l47.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l47.8"></a><span id="l47.8"> </span>
<a href="#l47.9"></a><span id="l47.9" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l47.10"></a><span id="l47.10" class="difflineplus">+</span>
<a href="#l47.11"></a><span id="l47.11" class="difflineplus">+Preferences.addAll([</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineplus">+  { id: &quot;mail.receipt.request_return_receipt_on&quot;, type: &quot;bool&quot; },</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+  { id: &quot;mail.incorporate.return_receipt&quot;, type: &quot;int&quot; },</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineplus">+  { id: &quot;mail.mdn.report.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l47.15"></a><span id="l47.15" class="difflineplus">+  { id: &quot;mail.mdn.report.not_in_to_cc&quot;, type: &quot;int&quot; },</span>
<a href="#l47.16"></a><span id="l47.16" class="difflineplus">+  { id: &quot;mail.mdn.report.outside_domain&quot;, type: &quot;int&quot; },</span>
<a href="#l47.17"></a><span id="l47.17" class="difflineplus">+  { id: &quot;mail.mdn.report.other&quot;, type: &quot;int&quot; },</span>
<a href="#l47.18"></a><span id="l47.18" class="difflineplus">+]);</span>
<a href="#l47.19"></a><span id="l47.19" class="difflineplus">+</span>
<a href="#l47.20"></a><span id="l47.20"> /**</span>
<a href="#l47.21"></a><span id="l47.21">  * Enables/disables the labels and menulists depending whether</span>
<a href="#l47.22"></a><span id="l47.22">  * sending of return receipts is enabled.</span>
<a href="#l47.23"></a><span id="l47.23">  */</span>
<a href="#l47.24"></a><span id="l47.24"> function enableDisableAllowedReceipts() {</span>
<a href="#l47.25"></a><span id="l47.25">   let enable = (document.getElementById(&quot;receiptSend&quot;).value === &quot;true&quot;);</span>
<a href="#l47.26"></a><span id="l47.26">   enableElement(document.getElementById(&quot;notInToCcLabel&quot;), enable);</span>
<a href="#l47.27"></a><span id="l47.27">   enableElement(document.getElementById(&quot;notInToCcPref&quot;), enable);</span>
<a href="#l47.28"></a><span id="l47.28" class="difflineat">@@ -17,11 +28,11 @@ function enableDisableAllowedReceipts() </span>
<a href="#l47.29"></a><span id="l47.29">   enableElement(document.getElementById(&quot;otherCasesPref&quot;), enable);</span>
<a href="#l47.30"></a><span id="l47.30"> }</span>
<a href="#l47.31"></a><span id="l47.31"> </span>
<a href="#l47.32"></a><span id="l47.32"> /**</span>
<a href="#l47.33"></a><span id="l47.33">  * Set disabled state of aElement, unless its associated pref is locked.</span>
<a href="#l47.34"></a><span id="l47.34">  */</span>
<a href="#l47.35"></a><span id="l47.35"> function enableElement(aElement, aEnable) {</span>
<a href="#l47.36"></a><span id="l47.36">   let pref = aElement.getAttribute(&quot;preference&quot;);</span>
<a href="#l47.37"></a><span id="l47.37" class="difflineminus">-  let prefIsLocked = pref ? document.getElementById(pref).locked : false;</span>
<a href="#l47.38"></a><span id="l47.38" class="difflineplus">+  let prefIsLocked = pref ? Preferences.get(pref).locked : false;</span>
<a href="#l47.39"></a><span id="l47.39">   aElement.disabled = !aEnable || prefIsLocked;</span>
<a href="#l47.40"></a><span id="l47.40"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mail/components/preferences/receipts.xul</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mail/components/preferences/receipts.xul</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -2,39 +2,31 @@</span>
<a href="#l48.4"></a><span id="l48.4"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l48.5"></a><span id="l48.5">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l48.6"></a><span id="l48.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l48.7"></a><span id="l48.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l48.8"></a><span id="l48.8"> </span>
<a href="#l48.9"></a><span id="l48.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l48.10"></a><span id="l48.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l48.11"></a><span id="l48.11"> </span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l48.14"></a><span id="l48.14"> &lt;!ENTITY % receiptsDTD SYSTEM &quot;chrome://messenger/locale/preferences/receipts.dtd&quot;&gt;</span>
<a href="#l48.15"></a><span id="l48.15"> %receiptsDTD;</span>
<a href="#l48.16"></a><span id="l48.16"> ]&gt;</span>
<a href="#l48.17"></a><span id="l48.17"> </span>
<a href="#l48.18"></a><span id="l48.18" class="difflineminus">-&lt;prefwindow id=&quot;ReturnReceiptsDialog&quot; type=&quot;child&quot;</span>
<a href="#l48.19"></a><span id="l48.19" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l48.20"></a><span id="l48.20" class="difflineminus">-            dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l48.21"></a><span id="l48.21" class="difflineminus">-            title=&quot;&amp;dialog.title;&quot;</span>
<a href="#l48.22"></a><span id="l48.22" class="difflineminus">-            onload=&quot;enableDisableAllowedReceipts();&quot;&gt;</span>
<a href="#l48.23"></a><span id="l48.23" class="difflineplus">+&lt;dialog id=&quot;ReturnReceiptsDialog&quot; type=&quot;child&quot;</span>
<a href="#l48.24"></a><span id="l48.24" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l48.25"></a><span id="l48.25" class="difflineplus">+        dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l48.26"></a><span id="l48.26" class="difflineplus">+        title=&quot;&amp;dialog.title;&quot;</span>
<a href="#l48.27"></a><span id="l48.27" class="difflineplus">+        onload=&quot;enableDisableAllowedReceipts();&quot;&gt;</span>
<a href="#l48.28"></a><span id="l48.28"> </span>
<a href="#l48.29"></a><span id="l48.29">   &lt;prefpane id=&quot;ReturnReceiptsDialogPane&quot;&gt;</span>
<a href="#l48.30"></a><span id="l48.30" class="difflineplus">+    &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l48.31"></a><span id="l48.31">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/receipts.js&quot;/&gt;</span>
<a href="#l48.32"></a><span id="l48.32"> </span>
<a href="#l48.33"></a><span id="l48.33" class="difflineminus">-    &lt;preferences id=&quot;ReturnReceiptsPreferences&quot;&gt;</span>
<a href="#l48.34"></a><span id="l48.34" class="difflineminus">-      &lt;preference id=&quot;mail.receipt.request_return_receipt_on&quot; name=&quot;mail.receipt.request_return_receipt_on&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l48.35"></a><span id="l48.35" class="difflineminus">-      &lt;preference id=&quot;mail.incorporate.return_receipt&quot; name=&quot;mail.incorporate.return_receipt&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l48.36"></a><span id="l48.36" class="difflineminus">-      &lt;preference id=&quot;mail.mdn.report.enabled&quot;     name=&quot;mail.mdn.report.enabled&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l48.37"></a><span id="l48.37" class="difflineminus">-      &lt;preference id=&quot;mail.mdn.report.not_in_to_cc&quot; name=&quot;mail.mdn.report.not_in_to_cc&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l48.38"></a><span id="l48.38" class="difflineminus">-      &lt;preference id=&quot;mail.mdn.report.outside_domain&quot; name=&quot;mail.mdn.report.outside_domain&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l48.39"></a><span id="l48.39" class="difflineminus">-      &lt;preference id=&quot;mail.mdn.report.other&quot; name=&quot;mail.mdn.report.other&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l48.40"></a><span id="l48.40" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l48.41"></a><span id="l48.41" class="difflineminus">-</span>
<a href="#l48.42"></a><span id="l48.42">     &lt;vbox id=&quot;returnReceiptSettings&quot; align=&quot;start&quot;&gt;</span>
<a href="#l48.43"></a><span id="l48.43">       &lt;checkbox id=&quot;alwaysRequest&quot; label=&quot;&amp;requestReceipt.label;&quot;</span>
<a href="#l48.44"></a><span id="l48.44">                 preference=&quot;mail.receipt.request_return_receipt_on&quot;</span>
<a href="#l48.45"></a><span id="l48.45">                 accesskey=&quot;&amp;requestReceipt.accesskey;&quot;/&gt;</span>
<a href="#l48.46"></a><span id="l48.46">     &lt;/vbox&gt;</span>
<a href="#l48.47"></a><span id="l48.47"> </span>
<a href="#l48.48"></a><span id="l48.48">     &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l48.49"></a><span id="l48.49">     &lt;separator class=&quot;groove&quot;/&gt;</span>
<a href="#l48.50"></a><span id="l48.50" class="difflineat">@@ -94,9 +86,9 @@</span>
<a href="#l48.51"></a><span id="l48.51">               &lt;/menupopup&gt;</span>
<a href="#l48.52"></a><span id="l48.52">             &lt;/menulist&gt;</span>
<a href="#l48.53"></a><span id="l48.53">           &lt;/row&gt;</span>
<a href="#l48.54"></a><span id="l48.54">         &lt;/rows&gt;</span>
<a href="#l48.55"></a><span id="l48.55">       &lt;/grid&gt;</span>
<a href="#l48.56"></a><span id="l48.56">     &lt;/radiogroup&gt;</span>
<a href="#l48.57"></a><span id="l48.57">     &lt;separator/&gt;</span>
<a href="#l48.58"></a><span id="l48.58">   &lt;/prefpane&gt;</span>
<a href="#l48.59"></a><span id="l48.59" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l48.60"></a><span id="l48.60" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mail/components/preferences/security.inc.xul</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mail/components/preferences/security.inc.xul</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -2,46 +2,16 @@</span>
<a href="#l49.4"></a><span id="l49.4"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l49.5"></a><span id="l49.5"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l49.6"></a><span id="l49.6">   &lt;prefpane id=&quot;paneSecurity&quot; label=&quot;&amp;paneSecurity.title;&quot;&gt;</span>
<a href="#l49.7"></a><span id="l49.7">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/security.js&quot;/&gt;</span>
<a href="#l49.8"></a><span id="l49.8"> </span>
<a href="#l49.9"></a><span id="l49.9">     &lt;stringbundle id=&quot;bundlePreferences&quot; src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l49.10"></a><span id="l49.10">     &lt;stringbundle id=&quot;bundleMasterPwPreferences&quot; src=&quot;chrome://mozapps/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l49.11"></a><span id="l49.11"> </span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-    &lt;preferences id=&quot;securityPreferences&quot;&gt;</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineminus">-      &lt;preference id=&quot;mail.preferences.security.selectedTabIndex&quot;</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineminus">-                  name=&quot;mail.preferences.security.selectedTabIndex&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineminus">-      &lt;preference id=&quot;mail.spam.manualMark&quot;</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineminus">-                  name=&quot;mail.spam.manualMark&quot;</span>
<a href="#l49.17"></a><span id="l49.17" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l49.18"></a><span id="l49.18" class="difflineminus">-      &lt;preference id=&quot;mail.spam.manualMarkMode&quot;</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineminus">-                  name=&quot;mail.spam.manualMarkMode&quot;</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineminus">-                  type=&quot;int&quot;/&gt;</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineminus">-      &lt;preference id=&quot;mail.spam.markAsReadOnSpam&quot;</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineminus">-                  name=&quot;mail.spam.markAsReadOnSpam&quot;</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineminus">-      &lt;preference id=&quot;mail.spam.logging.enabled&quot;</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineminus">-                  name=&quot;mail.spam.logging.enabled&quot;</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineminus">-      &lt;preference id=&quot;mail.phishing.detection.enabled&quot;</span>
<a href="#l49.28"></a><span id="l49.28" class="difflineminus">-                  name=&quot;mail.phishing.detection.enabled&quot;</span>
<a href="#l49.29"></a><span id="l49.29" class="difflineminus">-                  type=&quot;bool&quot;</span>
<a href="#l49.30"></a><span id="l49.30" class="difflineminus">-                  onchange=&quot;gSecurityPane.reloadMessageInOpener();&quot;/&gt;</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineminus">-      &lt;preference id=&quot;browser.safebrowsing.enabled&quot;</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineminus">-                  name=&quot;browser.safebrowsing.enabled&quot;</span>
<a href="#l49.33"></a><span id="l49.33" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l49.34"></a><span id="l49.34" class="difflineminus">-      &lt;preference id=&quot;mailnews.downloadToTempFile&quot;</span>
<a href="#l49.35"></a><span id="l49.35" class="difflineminus">-                  name=&quot;mailnews.downloadToTempFile&quot;</span>
<a href="#l49.36"></a><span id="l49.36" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l49.37"></a><span id="l49.37" class="difflineminus">-      &lt;preference id=&quot;pref.privacy.disable_button.view_passwords&quot;</span>
<a href="#l49.38"></a><span id="l49.38" class="difflineminus">-                  name=&quot;pref.privacy.disable_button.view_passwords&quot;</span>
<a href="#l49.39"></a><span id="l49.39" class="difflineminus">-                  type=&quot;bool&quot;/&gt;</span>
<a href="#l49.40"></a><span id="l49.40" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l49.41"></a><span id="l49.41" class="difflineminus">-</span>
<a href="#l49.42"></a><span id="l49.42">     &lt;tabbox id=&quot;securityPrefs&quot; flex=&quot;1&quot; onselect=&quot;gSecurityPane.tabSelectionChanged();&quot;&gt;</span>
<a href="#l49.43"></a><span id="l49.43">       &lt;tabs id=&quot;securityPrefsTabs&quot;&gt;</span>
<a href="#l49.44"></a><span id="l49.44">         &lt;tab id=&quot;junkTab&quot; label=&quot;&amp;itemJunk.label;&quot;/&gt;</span>
<a href="#l49.45"></a><span id="l49.45">         &lt;tab id=&quot;phishingTab&quot; label=&quot;&amp;itemPhishing.label;&quot;/&gt;</span>
<a href="#l49.46"></a><span id="l49.46">         &lt;tab id=&quot;antiVirusTab&quot; label=&quot;&amp;itemAntiVirus.label;&quot;/&gt;</span>
<a href="#l49.47"></a><span id="l49.47">         &lt;tab id=&quot;passwordsTab&quot; label=&quot;&amp;itemPasswords.label;&quot;/&gt;</span>
<a href="#l49.48"></a><span id="l49.48">       &lt;/tabs&gt;</span>
<a href="#l49.49"></a><span id="l49.49"> </span>
<a href="#l49.50"></a><span id="l49.50" class="difflineat">@@ -158,10 +128,9 @@</span>
<a href="#l49.51"></a><span id="l49.51">                     oncommand=&quot;gSecurityPane.changeMasterPassword();&quot;/&gt;</span>
<a href="#l49.52"></a><span id="l49.52">           &lt;/hbox&gt;</span>
<a href="#l49.53"></a><span id="l49.53">           &lt;separator flex=&quot;1&quot;/&gt;</span>
<a href="#l49.54"></a><span id="l49.54">         &lt;/tabpanel&gt;</span>
<a href="#l49.55"></a><span id="l49.55">       &lt;/tabpanels&gt;</span>
<a href="#l49.56"></a><span id="l49.56">     &lt;/tabbox&gt;</span>
<a href="#l49.57"></a><span id="l49.57"> </span>
<a href="#l49.58"></a><span id="l49.58">     &lt;separator/&gt;</span>
<a href="#l49.59"></a><span id="l49.59" class="difflineminus">-</span>
<a href="#l49.60"></a><span id="l49.60">   &lt;/prefpane&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mail/components/preferences/security.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mail/components/preferences/security.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -5,48 +5,60 @@</span>
<a href="#l50.4"></a><span id="l50.4"> </span>
<a href="#l50.5"></a><span id="l50.5"> &quot;use strict&quot;;</span>
<a href="#l50.6"></a><span id="l50.6"> </span>
<a href="#l50.7"></a><span id="l50.7"> /* import-globals-from preferences.js */</span>
<a href="#l50.8"></a><span id="l50.8"> /* import-globals-from subdialogs.js */</span>
<a href="#l50.9"></a><span id="l50.9"> </span>
<a href="#l50.10"></a><span id="l50.10"> ChromeUtils.defineModuleGetter(this, &quot;LoginHelper&quot;, &quot;resource://gre/modules/LoginHelper.jsm&quot;);</span>
<a href="#l50.11"></a><span id="l50.11"> </span>
<a href="#l50.12"></a><span id="l50.12" class="difflineplus">+Preferences.addAll([</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+  { id: &quot;mail.preferences.security.selectedTabIndex&quot;, type: &quot;int&quot; },</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineplus">+  { id: &quot;mail.spam.manualMark&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineplus">+  { id: &quot;mail.spam.manualMarkMode&quot;, type: &quot;int&quot; },</span>
<a href="#l50.16"></a><span id="l50.16" class="difflineplus">+  { id: &quot;mail.spam.markAsReadOnSpam&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.17"></a><span id="l50.17" class="difflineplus">+  { id: &quot;mail.spam.logging.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.18"></a><span id="l50.18" class="difflineplus">+  { id: &quot;mail.phishing.detection.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.19"></a><span id="l50.19" class="difflineplus">+  { id: &quot;browser.safebrowsing.enabled&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.20"></a><span id="l50.20" class="difflineplus">+  { id: &quot;mailnews.downloadToTempFile&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.21"></a><span id="l50.21" class="difflineplus">+  { id: &quot;pref.privacy.disable_button.view_passwords&quot;, type: &quot;bool&quot; },</span>
<a href="#l50.22"></a><span id="l50.22" class="difflineplus">+]);</span>
<a href="#l50.23"></a><span id="l50.23" class="difflineplus">+</span>
<a href="#l50.24"></a><span id="l50.24"> document.getElementById(&quot;paneSecurity&quot;)</span>
<a href="#l50.25"></a><span id="l50.25">         .addEventListener(&quot;paneload&quot;, function() { gSecurityPane.init(); });</span>
<a href="#l50.26"></a><span id="l50.26"> </span>
<a href="#l50.27"></a><span id="l50.27"> var gSecurityPane = {</span>
<a href="#l50.28"></a><span id="l50.28">   mPane: null,</span>
<a href="#l50.29"></a><span id="l50.29">   mInitialized: false,</span>
<a href="#l50.30"></a><span id="l50.30"> </span>
<a href="#l50.31"></a><span id="l50.31">   init() {</span>
<a href="#l50.32"></a><span id="l50.32">     this.mPane = document.getElementById(&quot;paneSecurity&quot;);</span>
<a href="#l50.33"></a><span id="l50.33"> </span>
<a href="#l50.34"></a><span id="l50.34" class="difflineminus">-    this.updateManualMarkMode(document.getElementById(&quot;manualMark&quot;).checked);</span>
<a href="#l50.35"></a><span id="l50.35" class="difflineminus">-    this.updateJunkLogButton(document.getElementById(&quot;enableJunkLogging&quot;).checked);</span>
<a href="#l50.36"></a><span id="l50.36" class="difflineplus">+    this.updateManualMarkMode(Preferences.get(&quot;mail.spam.manualMark&quot;).value);</span>
<a href="#l50.37"></a><span id="l50.37" class="difflineplus">+    this.updateJunkLogButton(Preferences.get(&quot;mail.spam.logging.enabled&quot;).value);</span>
<a href="#l50.38"></a><span id="l50.38"> </span>
<a href="#l50.39"></a><span id="l50.39">     this._initMasterPasswordUI();</span>
<a href="#l50.40"></a><span id="l50.40"> </span>
<a href="#l50.41"></a><span id="l50.41">     // update the checkbox for downloading phishing url tables</span>
<a href="#l50.42"></a><span id="l50.42">     // this.updateDownloadedPhishingListState();</span>
<a href="#l50.43"></a><span id="l50.43"> </span>
<a href="#l50.44"></a><span id="l50.44">     if (!((&quot;arguments&quot; in window) &amp;&amp; window.arguments[1])) {</span>
<a href="#l50.45"></a><span id="l50.45">       // If no tab was specified, select the last used tab.</span>
<a href="#l50.46"></a><span id="l50.46" class="difflineminus">-      let preference = document.getElementById(&quot;mail.preferences.security.selectedTabIndex&quot;);</span>
<a href="#l50.47"></a><span id="l50.47" class="difflineplus">+      let preference = Preferences.get(&quot;mail.preferences.security.selectedTabIndex&quot;);</span>
<a href="#l50.48"></a><span id="l50.48">       if (preference.value)</span>
<a href="#l50.49"></a><span id="l50.49">         document.getElementById(&quot;securityPrefs&quot;).selectedIndex = preference.value;</span>
<a href="#l50.50"></a><span id="l50.50">     }</span>
<a href="#l50.51"></a><span id="l50.51"> </span>
<a href="#l50.52"></a><span id="l50.52">     this.mInitialized = true;</span>
<a href="#l50.53"></a><span id="l50.53">   },</span>
<a href="#l50.54"></a><span id="l50.54"> </span>
<a href="#l50.55"></a><span id="l50.55">   tabSelectionChanged() {</span>
<a href="#l50.56"></a><span id="l50.56">     if (this.mInitialized)</span>
<a href="#l50.57"></a><span id="l50.57" class="difflineminus">-      document.getElementById(&quot;mail.preferences.security.selectedTabIndex&quot;)</span>
<a href="#l50.58"></a><span id="l50.58" class="difflineminus">-              .valueFromPreferences = document.getElementById(&quot;securityPrefs&quot;).selectedIndex;</span>
<a href="#l50.59"></a><span id="l50.59" class="difflineplus">+      Preferences.get(&quot;mail.preferences.security.selectedTabIndex&quot;)</span>
<a href="#l50.60"></a><span id="l50.60" class="difflineplus">+                 .valueFromPreferences = document.getElementById(&quot;securityPrefs&quot;).selectedIndex;</span>
<a href="#l50.61"></a><span id="l50.61">   },</span>
<a href="#l50.62"></a><span id="l50.62"> </span>
<a href="#l50.63"></a><span id="l50.63">   updateManualMarkMode(aEnableRadioGroup) {</span>
<a href="#l50.64"></a><span id="l50.64">     document.getElementById(&quot;manualMarkMode&quot;).disabled = !aEnableRadioGroup;</span>
<a href="#l50.65"></a><span id="l50.65">   },</span>
<a href="#l50.66"></a><span id="l50.66"> </span>
<a href="#l50.67"></a><span id="l50.67">   updateJunkLogButton(aEnableButton) {</span>
<a href="#l50.68"></a><span id="l50.68">     document.getElementById(&quot;openJunkLogButton&quot;).disabled = !aEnableButton;</span>
<a href="#l50.69"></a><span id="l50.69" class="difflineat">@@ -156,8 +168,10 @@ var gSecurityPane = {</span>
<a href="#l50.70"></a><span id="l50.70">   },</span>
<a href="#l50.71"></a><span id="l50.71"> </span>
<a href="#l50.72"></a><span id="l50.72">   updateDownloadedPhishingListState() {</span>
<a href="#l50.73"></a><span id="l50.73">     document.getElementById(&quot;useDownloadedList&quot;).disabled =</span>
<a href="#l50.74"></a><span id="l50.74">       !document.getElementById(&quot;enablePhishingDetector&quot;).checked;</span>
<a href="#l50.75"></a><span id="l50.75">   },</span>
<a href="#l50.76"></a><span id="l50.76"> </span>
<a href="#l50.77"></a><span id="l50.77"> };</span>
<a href="#l50.78"></a><span id="l50.78" class="difflineplus">+</span>
<a href="#l50.79"></a><span id="l50.79" class="difflineplus">+Preferences.get(&quot;mail.phishing.detection.enabled&quot;).on(&quot;change&quot;, gSecurityPane.reloadMessageInOpener);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mail/components/preferences/sendoptions.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mail/components/preferences/sendoptions.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -1,28 +1,37 @@</span>
<a href="#l51.4"></a><span id="l51.4"> /* -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l51.5"></a><span id="l51.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l51.6"></a><span id="l51.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l51.7"></a><span id="l51.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l51.8"></a><span id="l51.8"> </span>
<a href="#l51.9"></a><span id="l51.9" class="difflineplus">+/* import-globals-from ../../../../toolkit/content/preferencesBindings.js */</span>
<a href="#l51.10"></a><span id="l51.10" class="difflineplus">+</span>
<a href="#l51.11"></a><span id="l51.11"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l51.12"></a><span id="l51.12"> </span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+Preferences.addAll([</span>
<a href="#l51.14"></a><span id="l51.14" class="difflineplus">+  { id: &quot;mailnews.sendformat.auto_downgrade&quot;, type: &quot;bool&quot; },</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineplus">+  { id: &quot;mail.default_html_action&quot;, type: &quot;int&quot; },</span>
<a href="#l51.16"></a><span id="l51.16" class="difflineplus">+  { id: &quot;mailnews.html_domains&quot;, type: &quot;string&quot; },</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineplus">+  { id: &quot;mailnews.plaintext_domains&quot;, type: &quot;string&quot; },</span>
<a href="#l51.18"></a><span id="l51.18" class="difflineplus">+]);</span>
<a href="#l51.19"></a><span id="l51.19" class="difflineplus">+</span>
<a href="#l51.20"></a><span id="l51.20"> var gSendOptionsDialog = {</span>
<a href="#l51.21"></a><span id="l51.21">   mPrefsBundle: null,</span>
<a href="#l51.22"></a><span id="l51.22">   mHTMLListBox: null,</span>
<a href="#l51.23"></a><span id="l51.23">   mPlainTextListBox: null,</span>
<a href="#l51.24"></a><span id="l51.24"> </span>
<a href="#l51.25"></a><span id="l51.25">   init() {</span>
<a href="#l51.26"></a><span id="l51.26">     this.mPrefsBundle = document.getElementById(&quot;bundlePreferences&quot;);</span>
<a href="#l51.27"></a><span id="l51.27">     this.mHTMLListBox = document.getElementById(&quot;html_domains&quot;);</span>
<a href="#l51.28"></a><span id="l51.28">     this.mPlainTextListBox = document.getElementById(&quot;plaintext_domains&quot;);</span>
<a href="#l51.29"></a><span id="l51.29"> </span>
<a href="#l51.30"></a><span id="l51.30" class="difflineminus">-    this.loadDomains(document.getElementById(&quot;mailnews.html_domains&quot;).value,</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineplus">+    this.loadDomains(Preferences.get(&quot;mailnews.html_domains&quot;).value,</span>
<a href="#l51.32"></a><span id="l51.32">                      this.mHTMLListBox);</span>
<a href="#l51.33"></a><span id="l51.33" class="difflineminus">-    this.loadDomains(document.getElementById(&quot;mailnews.plaintext_domains&quot;).value,</span>
<a href="#l51.34"></a><span id="l51.34" class="difflineplus">+    this.loadDomains(Preferences.get(&quot;mailnews.plaintext_domains&quot;).value,</span>
<a href="#l51.35"></a><span id="l51.35">                      this.mPlainTextListBox);</span>
<a href="#l51.36"></a><span id="l51.36">   },</span>
<a href="#l51.37"></a><span id="l51.37"> </span>
<a href="#l51.38"></a><span id="l51.38">   saveDomainPref(aHTML) {</span>
<a href="#l51.39"></a><span id="l51.39">     var listbox = aHTML ? this.mHTMLListBox : this.mPlainTextListBox;</span>
<a href="#l51.40"></a><span id="l51.40">     var num_domains = 0;</span>
<a href="#l51.41"></a><span id="l51.41">     var pref_string = &quot;&quot;;</span>
<a href="#l51.42"></a><span id="l51.42"> </span>
<a href="#l51.43"></a><span id="l51.43" class="difflineat">@@ -53,31 +62,31 @@ var gSendOptionsDialog = {</span>
<a href="#l51.44"></a><span id="l51.44"> </span>
<a href="#l51.45"></a><span id="l51.45">   removeDomains(aHTML) {</span>
<a href="#l51.46"></a><span id="l51.46">     let listbox = aHTML ? this.mHTMLListBox : this.mPlainTextListBox;</span>
<a href="#l51.47"></a><span id="l51.47"> </span>
<a href="#l51.48"></a><span id="l51.48">     let selectedCount = listbox.selectedItems.length;</span>
<a href="#l51.49"></a><span id="l51.49">     for (let i = selectedCount - 1; i &gt;= 0; i--)</span>
<a href="#l51.50"></a><span id="l51.50">       listbox.selectedItems[i].remove();</span>
<a href="#l51.51"></a><span id="l51.51"> </span>
<a href="#l51.52"></a><span id="l51.52" class="difflineminus">-    document.getElementById(&quot;SendOptionsDialogPane&quot;).userChangedValue(listbox);</span>
<a href="#l51.53"></a><span id="l51.53" class="difflineplus">+    Preferences.userChangedValue(listbox);</span>
<a href="#l51.54"></a><span id="l51.54">   },</span>
<a href="#l51.55"></a><span id="l51.55"> </span>
<a href="#l51.56"></a><span id="l51.56">   addDomain(aHTML) {</span>
<a href="#l51.57"></a><span id="l51.57">     var listbox = aHTML ? this.mHTMLListBox : this.mPlainTextListBox;</span>
<a href="#l51.58"></a><span id="l51.58"> </span>
<a href="#l51.59"></a><span id="l51.59">     var domainName;</span>
<a href="#l51.60"></a><span id="l51.60">     var result = {value: null};</span>
<a href="#l51.61"></a><span id="l51.61">     if (Services.prompt.prompt(window, this.mPrefsBundle.getString(listbox.id + &quot;AddDomainTitle&quot;),</span>
<a href="#l51.62"></a><span id="l51.62">                                this.mPrefsBundle.getString(listbox.id + &quot;AddDomain&quot;), result, null, {value: 0}))</span>
<a href="#l51.63"></a><span id="l51.63">       domainName = result.value.replace(/ /g, &quot;&quot;);</span>
<a href="#l51.64"></a><span id="l51.64"> </span>
<a href="#l51.65"></a><span id="l51.65">     if (domainName &amp;&amp; !this.domainAlreadyPresent(domainName)) {</span>
<a href="#l51.66"></a><span id="l51.66">       this.addItemToDomainList(listbox, domainName);</span>
<a href="#l51.67"></a><span id="l51.67" class="difflineminus">-      document.getElementById(&quot;SendOptionsDialogPane&quot;).userChangedValue(listbox);</span>
<a href="#l51.68"></a><span id="l51.68" class="difflineplus">+      Preferences.userChangedValue(listbox);</span>
<a href="#l51.69"></a><span id="l51.69">     }</span>
<a href="#l51.70"></a><span id="l51.70">   },</span>
<a href="#l51.71"></a><span id="l51.71"> </span>
<a href="#l51.72"></a><span id="l51.72">   domainAlreadyPresent(aDomainName) {</span>
<a href="#l51.73"></a><span id="l51.73">     let matchingDomains = this.mHTMLListBox.querySelectorAll('[value=&quot;' + aDomainName + '&quot;]');</span>
<a href="#l51.74"></a><span id="l51.74"> </span>
<a href="#l51.75"></a><span id="l51.75">     if (!matchingDomains.length)</span>
<a href="#l51.76"></a><span id="l51.76">       matchingDomains = this.mPlainTextListBox.querySelectorAll('[value=&quot;' + aDomainName + '&quot;]');</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mail/components/preferences/sendoptions.xul</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mail/components/preferences/sendoptions.xul</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -2,43 +2,37 @@</span>
<a href="#l52.4"></a><span id="l52.4"> &lt;!-- -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l52.5"></a><span id="l52.5">    - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l52.6"></a><span id="l52.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l52.7"></a><span id="l52.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l52.8"></a><span id="l52.8"> </span>
<a href="#l52.9"></a><span id="l52.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot;?&gt;</span>
<a href="#l52.10"></a><span id="l52.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/preferences/preferences.css&quot;?&gt;</span>
<a href="#l52.11"></a><span id="l52.11"> </span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l52.14"></a><span id="l52.14"> &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot; &gt;</span>
<a href="#l52.15"></a><span id="l52.15"> %brandDTD;</span>
<a href="#l52.16"></a><span id="l52.16"> &lt;!ENTITY % sendOptionsDTD SYSTEM &quot;chrome://messenger/locale/preferences/sendoptions.dtd&quot; &gt;</span>
<a href="#l52.17"></a><span id="l52.17"> %sendOptionsDTD;</span>
<a href="#l52.18"></a><span id="l52.18"> ]&gt;</span>
<a href="#l52.19"></a><span id="l52.19"> </span>
<a href="#l52.20"></a><span id="l52.20" class="difflineminus">-&lt;prefwindow id=&quot;SendOptionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l52.21"></a><span id="l52.21" class="difflineminus">-            xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineminus">-            xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l52.23"></a><span id="l52.23" class="difflineminus">-            dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l52.24"></a><span id="l52.24" class="difflineminus">-            style=&quot;min-height: 33em;&quot;</span>
<a href="#l52.25"></a><span id="l52.25" class="difflineminus">-            title=&quot;&amp;dialog.title;&quot;</span>
<a href="#l52.26"></a><span id="l52.26" class="difflineminus">-            onload=&quot;gSendOptionsDialog.init();&quot;&gt;</span>
<a href="#l52.27"></a><span id="l52.27" class="difflineplus">+&lt;dialog id=&quot;SendOptionsDialog&quot; type=&quot;child&quot;</span>
<a href="#l52.28"></a><span id="l52.28" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l52.29"></a><span id="l52.29" class="difflineplus">+        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l52.30"></a><span id="l52.30" class="difflineplus">+        dlgbuttons=&quot;accept,cancel&quot;</span>
<a href="#l52.31"></a><span id="l52.31" class="difflineplus">+        style=&quot;min-height: 33em;&quot;</span>
<a href="#l52.32"></a><span id="l52.32" class="difflineplus">+        title=&quot;&amp;dialog.title;&quot;</span>
<a href="#l52.33"></a><span id="l52.33" class="difflineplus">+        onload=&quot;gSendOptionsDialog.init();&quot;&gt;</span>
<a href="#l52.34"></a><span id="l52.34"> </span>
<a href="#l52.35"></a><span id="l52.35">   &lt;prefpane id=&quot;SendOptionsDialogPane&quot;&gt;</span>
<a href="#l52.36"></a><span id="l52.36" class="difflineplus">+    &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/preferencesBindings.js&quot;/&gt;</span>
<a href="#l52.37"></a><span id="l52.37">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/preferences/sendoptions.js&quot;/&gt;</span>
<a href="#l52.38"></a><span id="l52.38"> </span>
<a href="#l52.39"></a><span id="l52.39">     &lt;stringbundle id=&quot;bundlePreferences&quot; src=&quot;chrome://messenger/locale/preferences/preferences.properties&quot;/&gt;</span>
<a href="#l52.40"></a><span id="l52.40"> </span>
<a href="#l52.41"></a><span id="l52.41" class="difflineminus">-    &lt;preferences id=&quot;SendOptionsPreferences&quot;&gt;</span>
<a href="#l52.42"></a><span id="l52.42" class="difflineminus">-      &lt;preference id=&quot;mailnews.sendformat.auto_downgrade&quot; name=&quot;mailnews.sendformat.auto_downgrade&quot; type=&quot;bool&quot;/&gt;</span>
<a href="#l52.43"></a><span id="l52.43" class="difflineminus">-      &lt;preference id=&quot;mail.default_html_action&quot;      name=&quot;mail.default_html_action&quot; type=&quot;int&quot;/&gt;</span>
<a href="#l52.44"></a><span id="l52.44" class="difflineminus">-      &lt;preference id=&quot;mailnews.html_domains&quot;         name=&quot;mailnews.html_domains&quot; type=&quot;string&quot;/&gt;</span>
<a href="#l52.45"></a><span id="l52.45" class="difflineminus">-      &lt;preference id=&quot;mailnews.plaintext_domains&quot;    name=&quot;mailnews.plaintext_domains&quot;    type=&quot;string&quot;/&gt;</span>
<a href="#l52.46"></a><span id="l52.46" class="difflineminus">-    &lt;/preferences&gt;</span>
<a href="#l52.47"></a><span id="l52.47" class="difflineminus">-</span>
<a href="#l52.48"></a><span id="l52.48">     &lt;groupbox&gt;</span>
<a href="#l52.49"></a><span id="l52.49">       &lt;label&gt;&lt;html:h2&gt;&amp;sendMail.title;&lt;/html:h2&gt;&lt;/label&gt;</span>
<a href="#l52.50"></a><span id="l52.50"> </span>
<a href="#l52.51"></a><span id="l52.51">       &lt;checkbox id=&quot;autoDowngrade&quot;</span>
<a href="#l52.52"></a><span id="l52.52">                 label=&quot;&amp;autoDowngrade.label;&quot;</span>
<a href="#l52.53"></a><span id="l52.53">                 accesskey=&quot;&amp;autoDowngrade.accesskey;&quot;</span>
<a href="#l52.54"></a><span id="l52.54">                 preference=&quot;mailnews.sendformat.auto_downgrade&quot;/&gt;</span>
<a href="#l52.55"></a><span id="l52.55"> </span>
<a href="#l52.56"></a><span id="l52.56" class="difflineat">@@ -102,9 +96,9 @@</span>
<a href="#l52.57"></a><span id="l52.57">           &lt;/hbox&gt;</span>
<a href="#l52.58"></a><span id="l52.58">         &lt;/vbox&gt;</span>
<a href="#l52.59"></a><span id="l52.59"> </span>
<a href="#l52.60"></a><span id="l52.60">       &lt;/tabpanels&gt;</span>
<a href="#l52.61"></a><span id="l52.61">     &lt;/tabbox&gt;</span>
<a href="#l52.62"></a><span id="l52.62"> </span>
<a href="#l52.63"></a><span id="l52.63">     &lt;separator/&gt;</span>
<a href="#l52.64"></a><span id="l52.64">   &lt;/prefpane&gt;</span>
<a href="#l52.65"></a><span id="l52.65" class="difflineminus">-&lt;/prefwindow&gt;</span>
<a href="#l52.66"></a><span id="l52.66" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mail/themes/linux/mail/preferences/preferences.css</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mail/themes/linux/mail/preferences/preferences.css</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -2,46 +2,16 @@</span>
<a href="#l53.4"></a><span id="l53.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l53.5"></a><span id="l53.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l53.6"></a><span id="l53.6"> </span>
<a href="#l53.7"></a><span id="l53.7"> @import url(&quot;chrome://messenger/content/bindings.css&quot;);</span>
<a href="#l53.8"></a><span id="l53.8"> @import url(&quot;chrome://messenger/content/preferences/preferences.css&quot;);</span>
<a href="#l53.9"></a><span id="l53.9"> </span>
<a href="#l53.10"></a><span id="l53.10"> /* Global Styles */</span>
<a href="#l53.11"></a><span id="l53.11"> </span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-prefwindow {</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineminus">-  -moz-appearance: window;</span>
<a href="#l53.14"></a><span id="l53.14" class="difflineminus">-  background-color: -moz-Dialog;</span>
<a href="#l53.15"></a><span id="l53.15" class="difflineminus">-  color: -moz-DialogText;</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">-  font: message-box;</span>
<a href="#l53.17"></a><span id="l53.17" class="difflineminus">-  padding: 0;</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-}</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineminus">-</span>
<a href="#l53.20"></a><span id="l53.20" class="difflineminus">-prefpane {</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineminus">-  padding: 8px;</span>
<a href="#l53.22"></a><span id="l53.22" class="difflineminus">-}</span>
<a href="#l53.23"></a><span id="l53.23" class="difflineminus">-</span>
<a href="#l53.24"></a><span id="l53.24" class="difflineminus">-prefwindow[type=&quot;child&quot;] {</span>
<a href="#l53.25"></a><span id="l53.25" class="difflineminus">-  padding: 8px;</span>
<a href="#l53.26"></a><span id="l53.26" class="difflineminus">-}</span>
<a href="#l53.27"></a><span id="l53.27" class="difflineminus">-</span>
<a href="#l53.28"></a><span id="l53.28" class="difflineminus">-prefwindow[type=&quot;child&quot;] &gt; prefpane {</span>
<a href="#l53.29"></a><span id="l53.29" class="difflineminus">-  padding: 0;</span>
<a href="#l53.30"></a><span id="l53.30" class="difflineminus">-}</span>
<a href="#l53.31"></a><span id="l53.31" class="difflineminus">-</span>
<a href="#l53.32"></a><span id="l53.32" class="difflineminus">-.prefWindow-dlgbuttons {</span>
<a href="#l53.33"></a><span id="l53.33" class="difflineminus">-  padding-bottom: 8px;</span>
<a href="#l53.34"></a><span id="l53.34" class="difflineminus">-  padding-inline-start: 8px;</span>
<a href="#l53.35"></a><span id="l53.35" class="difflineminus">-  padding-inline-end: 8px;</span>
<a href="#l53.36"></a><span id="l53.36" class="difflineminus">-}</span>
<a href="#l53.37"></a><span id="l53.37" class="difflineminus">-</span>
<a href="#l53.38"></a><span id="l53.38" class="difflineminus">-prefwindow[type=&quot;child&quot;] .prefWindow-dlgbuttons {</span>
<a href="#l53.39"></a><span id="l53.39" class="difflineminus">-  padding: 0;</span>
<a href="#l53.40"></a><span id="l53.40" class="difflineminus">-}</span>
<a href="#l53.41"></a><span id="l53.41" class="difflineminus">-</span>
<a href="#l53.42"></a><span id="l53.42"> radio[pane] {</span>
<a href="#l53.43"></a><span id="l53.43">   -moz-appearance: none;</span>
<a href="#l53.44"></a><span id="l53.44">   min-width: 4.5em;</span>
<a href="#l53.45"></a><span id="l53.45">   margin: 0;</span>
<a href="#l53.46"></a><span id="l53.46">   padding: 3px;</span>
<a href="#l53.47"></a><span id="l53.47">   color: -moz-FieldText;</span>
<a href="#l53.48"></a><span id="l53.48"> }</span>
<a href="#l53.49"></a><span id="l53.49"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mail/themes/osx/mail/preferences/dialog.css</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mail/themes/osx/mail/preferences/dialog.css</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -1,15 +1,14 @@</span>
<a href="#l54.4"></a><span id="l54.4"> /* - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l54.5"></a><span id="l54.5">    - License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l54.6"></a><span id="l54.6">    - You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l54.7"></a><span id="l54.7"> </span>
<a href="#l54.8"></a><span id="l54.8"> @import url(&quot;chrome://messenger/skin/shared/in-content/dialog.css&quot;);</span>
<a href="#l54.9"></a><span id="l54.9"> </span>
<a href="#l54.10"></a><span id="l54.10" class="difflineminus">-prefwindow,</span>
<a href="#l54.11"></a><span id="l54.11"> .windowDialog {</span>
<a href="#l54.12"></a><span id="l54.12">   font: message-box !important;</span>
<a href="#l54.13"></a><span id="l54.13"> }</span>
<a href="#l54.14"></a><span id="l54.14"> </span>
<a href="#l54.15"></a><span id="l54.15"> :root &gt; * {</span>
<a href="#l54.16"></a><span id="l54.16">   font-size: 1.18em;</span>
<a href="#l54.17"></a><span id="l54.17"> }</span>
<a href="#l54.18"></a><span id="l54.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mail/themes/osx/mail/preferences/preferences.css</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mail/themes/osx/mail/preferences/preferences.css</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -2,44 +2,16 @@</span>
<a href="#l55.4"></a><span id="l55.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l55.5"></a><span id="l55.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l55.6"></a><span id="l55.6"> </span>
<a href="#l55.7"></a><span id="l55.7"> @import url(&quot;chrome://messenger/content/bindings.css&quot;);</span>
<a href="#l55.8"></a><span id="l55.8"> @import url(&quot;chrome://messenger/content/preferences/preferences.css&quot;);</span>
<a href="#l55.9"></a><span id="l55.9"> </span>
<a href="#l55.10"></a><span id="l55.10"> /* Global Styles */</span>
<a href="#l55.11"></a><span id="l55.11"> </span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-prefwindow {</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineminus">-  -moz-appearance: dialog;</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineminus">-  background-color: #ffffff;</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineminus">-  color: -moz-DialogText;</span>
<a href="#l55.16"></a><span id="l55.16" class="difflineminus">-  font: -moz-dialog;</span>
<a href="#l55.17"></a><span id="l55.17" class="difflineminus">-  padding: 0;</span>
<a href="#l55.18"></a><span id="l55.18" class="difflineminus">-}</span>
<a href="#l55.19"></a><span id="l55.19" class="difflineminus">-</span>
<a href="#l55.20"></a><span id="l55.20" class="difflineminus">-prefwindow[type=&quot;child&quot;] {</span>
<a href="#l55.21"></a><span id="l55.21" class="difflineminus">-  padding-top: 18px;</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineminus">-  padding-bottom: 15px;</span>
<a href="#l55.23"></a><span id="l55.23" class="difflineminus">-  padding-inline-start: 18px;</span>
<a href="#l55.24"></a><span id="l55.24" class="difflineminus">-  padding-inline-end: 20px;</span>
<a href="#l55.25"></a><span id="l55.25" class="difflineminus">-}</span>
<a href="#l55.26"></a><span id="l55.26" class="difflineminus">-</span>
<a href="#l55.27"></a><span id="l55.27" class="difflineminus">-prefpane {</span>
<a href="#l55.28"></a><span id="l55.28" class="difflineminus">-  padding: 12px;</span>
<a href="#l55.29"></a><span id="l55.29" class="difflineminus">-}</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineminus">-</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineminus">-prefwindow[type=&quot;child&quot;] &gt; prefpane {</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineminus">-  padding: 0;</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineminus">-}</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineminus">-</span>
<a href="#l55.35"></a><span id="l55.35" class="difflineminus">-.prefWindow-dlgbuttons {</span>
<a href="#l55.36"></a><span id="l55.36" class="difflineminus">-  margin: 0 12px 12px;</span>
<a href="#l55.37"></a><span id="l55.37" class="difflineminus">-  padding-top: 0 !important;</span>
<a href="#l55.38"></a><span id="l55.38" class="difflineminus">-}</span>
<a href="#l55.39"></a><span id="l55.39" class="difflineminus">-</span>
<a href="#l55.40"></a><span id="l55.40"> .paneButtonLabel {</span>
<a href="#l55.41"></a><span id="l55.41">   margin: 0 !important;</span>
<a href="#l55.42"></a><span id="l55.42"> }</span>
<a href="#l55.43"></a><span id="l55.43"> </span>
<a href="#l55.44"></a><span id="l55.44"> .windowDialog {</span>
<a href="#l55.45"></a><span id="l55.45">   padding: 12px;</span>
<a href="#l55.46"></a><span id="l55.46">   font: -moz-dialog;</span>
<a href="#l55.47"></a><span id="l55.47"> }</span>
<a href="#l55.48"></a><span id="l55.48" class="difflineat">@@ -50,20 +22,16 @@ prefwindow[type=&quot;child&quot;] &gt; prefpane {</span>
<a href="#l55.49"></a><span id="l55.49">   line-height: 1.3em;</span>
<a href="#l55.50"></a><span id="l55.50">   margin-bottom: 4px !important;</span>
<a href="#l55.51"></a><span id="l55.51"> }</span>
<a href="#l55.52"></a><span id="l55.52"> </span>
<a href="#l55.53"></a><span id="l55.53"> menulist &gt; menupopup &gt; menuitem {</span>
<a href="#l55.54"></a><span id="l55.54">   font: -moz-pull-down-menu;</span>
<a href="#l55.55"></a><span id="l55.55"> }</span>
<a href="#l55.56"></a><span id="l55.56"> </span>
<a href="#l55.57"></a><span id="l55.57" class="difflineminus">-prefwindow:not([type=&quot;child&quot;]) {</span>
<a href="#l55.58"></a><span id="l55.58" class="difflineminus">-  padding: 0 !important;</span>
<a href="#l55.59"></a><span id="l55.59" class="difflineminus">-}</span>
<a href="#l55.60"></a><span id="l55.60" class="difflineminus">-</span>
<a href="#l55.61"></a><span id="l55.61"> /* Attachments Pane */</span>
<a href="#l55.62"></a><span id="l55.62"> #handlersView {</span>
<a href="#l55.63"></a><span id="l55.63">   -moz-box-flex: 1;</span>
<a href="#l55.64"></a><span id="l55.64"> }</span>
<a href="#l55.65"></a><span id="l55.65"> </span>
<a href="#l55.66"></a><span id="l55.66"> #browserStartupHomepage {</span>
<a href="#l55.67"></a><span id="l55.67">   padding-top: 2px;</span>
<a href="#l55.68"></a><span id="l55.68">   padding-bottom: 3px;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mail/themes/shared/mail/incontentprefs/aboutPreferences.css</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mail/themes/shared/mail/incontentprefs/aboutPreferences.css</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -6,21 +6,16 @@</span>
<a href="#l56.4"></a><span id="l56.4"> </span>
<a href="#l56.5"></a><span id="l56.5"> #MailPreferences {</span>
<a href="#l56.6"></a><span id="l56.6">   -moz-appearance: none;</span>
<a href="#l56.7"></a><span id="l56.7">   font: message-box;</span>
<a href="#l56.8"></a><span id="l56.8">   background-color: var(--in-content-page-background);</span>
<a href="#l56.9"></a><span id="l56.9">   color: var(--in-content-page-color);</span>
<a href="#l56.10"></a><span id="l56.10"> }</span>
<a href="#l56.11"></a><span id="l56.11"> </span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-/* Don't show the Close button on tab content */</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineminus">-#MailPreferences &gt; .prefWindow-dlgbuttons {</span>
<a href="#l56.14"></a><span id="l56.14" class="difflineminus">-  display: none;</span>
<a href="#l56.15"></a><span id="l56.15" class="difflineminus">-}</span>
<a href="#l56.16"></a><span id="l56.16" class="difflineminus">-</span>
<a href="#l56.17"></a><span id="l56.17"> #prefBox {</span>
<a href="#l56.18"></a><span id="l56.18">   position: relative;</span>
<a href="#l56.19"></a><span id="l56.19"> }</span>
<a href="#l56.20"></a><span id="l56.20"> </span>
<a href="#l56.21"></a><span id="l56.21"> #pref-category-box {</span>
<a href="#l56.22"></a><span id="l56.22">   background-color: #ebebef;</span>
<a href="#l56.23"></a><span id="l56.23">   width: 240px;</span>
<a href="#l56.24"></a><span id="l56.24"> }</span>
<a href="#l56.25"></a><span id="l56.25" class="difflineat">@@ -62,17 +57,18 @@ tabpanel &gt; hbox &gt; description {</span>
<a href="#l56.26"></a><span id="l56.26">   background-image: none;</span>
<a href="#l56.27"></a><span id="l56.27">   border-bottom: none;</span>
<a href="#l56.28"></a><span id="l56.28">   padding: 54px 0 0;</span>
<a href="#l56.29"></a><span id="l56.29">   margin: 0;</span>
<a href="#l56.30"></a><span id="l56.30"> }</span>
<a href="#l56.31"></a><span id="l56.31"> </span>
<a href="#l56.32"></a><span id="l56.32"> radio[pane] {</span>
<a href="#l56.33"></a><span id="l56.33">   -moz-box-orient: horizontal;</span>
<a href="#l56.34"></a><span id="l56.34" class="difflineminus">-  -moz-binding: url(&quot;chrome://global/content/bindings/radio.xml#radio&quot;) !important;</span>
<a href="#l56.35"></a><span id="l56.35" class="difflineplus">+  -moz-box-align: center;</span>
<a href="#l56.36"></a><span id="l56.36" class="difflineplus">+  -moz-binding: url(&quot;chrome://global/content/bindings/radio.xml#radio&quot;);</span>
<a href="#l56.37"></a><span id="l56.37">   -moz-appearance: none;</span>
<a href="#l56.38"></a><span id="l56.38">   width: 240px;</span>
<a href="#l56.39"></a><span id="l56.39">   color: var(--in-content-text-color);</span>
<a href="#l56.40"></a><span id="l56.40">   border-right-width: 0;</span>
<a href="#l56.41"></a><span id="l56.41">   border-left-width: 0;</span>
<a href="#l56.42"></a><span id="l56.42">   border-radius: 2px;</span>
<a href="#l56.43"></a><span id="l56.43">   margin-top: 0;</span>
<a href="#l56.44"></a><span id="l56.44">   margin-bottom: 0;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mail/themes/shared/mail/incontentprefs/dialog.css</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mail/themes/shared/mail/incontentprefs/dialog.css</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -1,16 +1,15 @@</span>
<a href="#l57.4"></a><span id="l57.4"> /* - This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l57.5"></a><span id="l57.5">    - License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l57.6"></a><span id="l57.6">    - You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l57.7"></a><span id="l57.7"> </span>
<a href="#l57.8"></a><span id="l57.8"> dialog,</span>
<a href="#l57.9"></a><span id="l57.9"> window,</span>
<a href="#l57.10"></a><span id="l57.10"> prefpane,</span>
<a href="#l57.11"></a><span id="l57.11" class="difflineminus">-prefwindow,</span>
<a href="#l57.12"></a><span id="l57.12"> .windowDialog {</span>
<a href="#l57.13"></a><span id="l57.13">   -moz-appearance: none;</span>
<a href="#l57.14"></a><span id="l57.14">   background-color: #fbfbfb;</span>
<a href="#l57.15"></a><span id="l57.15">   color: #424e5a;</span>
<a href="#l57.16"></a><span id="l57.16">   margin: 0;</span>
<a href="#l57.17"></a><span id="l57.17">   padding: 0;</span>
<a href="#l57.18"></a><span id="l57.18"> }</span>
<a href="#l57.19"></a><span id="l57.19"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mail/themes/windows/mail/preferences/preferences.css</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mail/themes/windows/mail/preferences/preferences.css</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -2,52 +2,16 @@</span>
<a href="#l58.4"></a><span id="l58.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l58.5"></a><span id="l58.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l58.6"></a><span id="l58.6"> </span>
<a href="#l58.7"></a><span id="l58.7"> @import url(&quot;chrome://messenger/content/bindings.css&quot;);</span>
<a href="#l58.8"></a><span id="l58.8"> @import url(&quot;chrome://messenger/content/preferences/preferences.css&quot;);</span>
<a href="#l58.9"></a><span id="l58.9"> </span>
<a href="#l58.10"></a><span id="l58.10"> /* Global Styles */</span>
<a href="#l58.11"></a><span id="l58.11"> </span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-prefwindow {</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineminus">-  -moz-appearance: window;</span>
<a href="#l58.14"></a><span id="l58.14" class="difflineminus">-  background-color: -moz-Dialog;</span>
<a href="#l58.15"></a><span id="l58.15" class="difflineminus">-  color: -moz-DialogText;</span>
<a href="#l58.16"></a><span id="l58.16" class="difflineminus">-  font: message-box;</span>
<a href="#l58.17"></a><span id="l58.17" class="difflineminus">-  padding: 0;</span>
<a href="#l58.18"></a><span id="l58.18" class="difflineminus">-}</span>
<a href="#l58.19"></a><span id="l58.19" class="difflineminus">-</span>
<a href="#l58.20"></a><span id="l58.20" class="difflineminus">-prefpane {</span>
<a href="#l58.21"></a><span id="l58.21" class="difflineminus">-  padding-top: 8px;</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineminus">-  padding-bottom: 10px;</span>
<a href="#l58.23"></a><span id="l58.23" class="difflineminus">-  padding-inline-start: 8px;</span>
<a href="#l58.24"></a><span id="l58.24" class="difflineminus">-  padding-inline-end: 10px;</span>
<a href="#l58.25"></a><span id="l58.25" class="difflineminus">-}</span>
<a href="#l58.26"></a><span id="l58.26" class="difflineminus">-</span>
<a href="#l58.27"></a><span id="l58.27" class="difflineminus">-prefwindow[type=&quot;child&quot;] {</span>
<a href="#l58.28"></a><span id="l58.28" class="difflineminus">-  padding-top: 8px;</span>
<a href="#l58.29"></a><span id="l58.29" class="difflineminus">-  padding-bottom: 10px;</span>
<a href="#l58.30"></a><span id="l58.30" class="difflineminus">-  padding-inline-start: 8px;</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineminus">-  padding-inline-end: 10px;</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineminus">-}</span>
<a href="#l58.33"></a><span id="l58.33" class="difflineminus">-</span>
<a href="#l58.34"></a><span id="l58.34" class="difflineminus">-prefwindow[type=&quot;child&quot;] &gt; prefpane {</span>
<a href="#l58.35"></a><span id="l58.35" class="difflineminus">-  padding: 0;</span>
<a href="#l58.36"></a><span id="l58.36" class="difflineminus">-}</span>
<a href="#l58.37"></a><span id="l58.37" class="difflineminus">-</span>
<a href="#l58.38"></a><span id="l58.38" class="difflineminus">-.prefWindow-dlgbuttons {</span>
<a href="#l58.39"></a><span id="l58.39" class="difflineminus">-  padding-bottom: 10px;</span>
<a href="#l58.40"></a><span id="l58.40" class="difflineminus">-  padding-inline-start: 8px;</span>
<a href="#l58.41"></a><span id="l58.41" class="difflineminus">-  padding-inline-end: 10px;</span>
<a href="#l58.42"></a><span id="l58.42" class="difflineminus">-}</span>
<a href="#l58.43"></a><span id="l58.43" class="difflineminus">-</span>
<a href="#l58.44"></a><span id="l58.44" class="difflineminus">-prefwindow[type=&quot;child&quot;] .prefWindow-dlgbuttons {</span>
<a href="#l58.45"></a><span id="l58.45" class="difflineminus">-  padding: 0;</span>
<a href="#l58.46"></a><span id="l58.46" class="difflineminus">-}</span>
<a href="#l58.47"></a><span id="l58.47" class="difflineminus">-</span>
<a href="#l58.48"></a><span id="l58.48"> .paneSelector {</span>
<a href="#l58.49"></a><span id="l58.49">   border-bottom: 2px groove ThreeDFace;</span>
<a href="#l58.50"></a><span id="l58.50">   margin: 0;</span>
<a href="#l58.51"></a><span id="l58.51">   padding-inline-start: 0;</span>
<a href="#l58.52"></a><span id="l58.52">   background-color: -moz-Field;</span>
<a href="#l58.53"></a><span id="l58.53">   color: -moz-FieldText;</span>
<a href="#l58.54"></a><span id="l58.54"> }</span>
<a href="#l58.55"></a><span id="l58.55"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:31Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

