<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 12840:7836bd5fcf41f6810ef8ef2934e2ec03004baaab</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 7836bd5fcf41f6810ef8ef2934e2ec03004baaab" />
<meta property="og:url" content="/comm-central/rev/7836bd5fcf41f6810ef8ef2934e2ec03004baaab" />
<meta property="og:description" content="Bug 900881 Make localAccountUtils.js into a testing module - Part 2. Move most of the globals into the object. r=jcranmer" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 7836bd5fcf41f6810ef8ef2934e2ec03004baaab 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/7836bd5fcf41f6810ef8ef2934e2ec03004baaab">shortlog</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/7836bd5fcf41f6810ef8ef2934e2ec03004baaab">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab">files</a> |
changeset |
<a href="/comm-central/raw-rev/7836bd5fcf41f6810ef8ef2934e2ec03004baaab">raw</a>  | <a href="/comm-central/archive/7836bd5fcf41f6810ef8ef2934e2ec03004baaab.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=900881">Bug 900881</a> Make localAccountUtils.js into a testing module - Part 2. Move most of the globals into the object. r=jcranmer
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#114;&#107;&#32;&#66;&#97;&#110;&#110;&#101;&#114;&#32;&#60;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#64;&#115;&#116;&#97;&#110;&#100;&#97;&#114;&#100;&#56;&#46;&#112;&#108;&#117;&#115;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 02 Aug 2013 18:11:12 +0100</td></tr>

<tr>
 <td>changeset 12840</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/7836bd5fcf41f6810ef8ef2934e2ec03004baaab">7836bd5fcf41f6810ef8ef2934e2ec03004baaab</a></td>
</tr>



<tr>
<td>parent 12839</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/c42b6328a83058d4929b9751ddc7870121b1a7a5">c42b6328a83058d4929b9751ddc7870121b1a7a5</a>
</td>
</tr>

<tr>
<td>child 12841</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5cdbadd8d714ab09c5180b59a9c457bc26746f64">5cdbadd8d714ab09c5180b59a9c457bc26746f64</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=7836bd5fcf41f6810ef8ef2934e2ec03004baaab">9382</a></td></tr>
<tr><td>push user</td><td>bugzilla@standard8.plus.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 02 Aug 2013 17:36:36 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@099f9cfcdec5 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=099f9cfcdec5354e78f8590c6264629e4cdd6e19">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=099f9cfcdec5354e78f8590c6264629e4cdd6e19&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=099f9cfcdec5354e78f8590c6264629e4cdd6e19&newProject=comm-central&newRevision=c42b6328a83058d4929b9751ddc7870121b1a7a5&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=099f9cfcdec5354e78f8590c6264629e4cdd6e19&newProject=comm-central&newRevision=c42b6328a83058d4929b9751ddc7870121b1a7a5&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=099f9cfcdec5354e78f8590c6264629e4cdd6e19&newProject=comm-central&newRevision=c42b6328a83058d4929b9751ddc7870121b1a7a5&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28jcranmer%29&revcount=50">jcranmer</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=900881">900881</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=900881">Bug 900881</a> Make localAccountUtils.js into a testing module - Part 2. Move most of the globals into the object. r=jcranmer</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mail/components/test/unit/test_about_support.js">mail/components/test/unit/test_about_support.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mail/components/test/unit/test_about_support.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mail/components/test/unit/test_about_support.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mail/components/test/unit/test_about_support.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mail/components/test/unit/test_about_support.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mail/components/test/unit/test_about_support.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug428427.js">mailnews/base/test/unit/test_bug428427.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug428427.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug428427.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug428427.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug428427.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug428427.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug434810.js">mailnews/base/test/unit/test_bug434810.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug434810.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug434810.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug434810.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug434810.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_bug434810.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_compactColumnSave.js">mailnews/base/test/unit/test_compactColumnSave.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_compactColumnSave.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_compactColumnSave.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_compactColumnSave.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_compactColumnSave.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_compactColumnSave.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyChaining.js">mailnews/base/test/unit/test_copyChaining.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyChaining.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyChaining.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyChaining.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyChaining.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyChaining.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyThenMoveManual.js">mailnews/base/test/unit/test_copyThenMoveManual.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyThenMoveManual.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyThenMoveManual.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyThenMoveManual.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyThenMoveManual.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_copyThenMoveManual.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_emptyTrash.js">mailnews/base/test/unit/test_emptyTrash.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_emptyTrash.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_emptyTrash.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_emptyTrash.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_emptyTrash.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_emptyTrash.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_folderCompact.js">mailnews/base/test/unit/test_folderCompact.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_folderCompact.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_folderCompact.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_folderCompact.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_folderCompact.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_folderCompact.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_getMsgTextFromStream.js">mailnews/base/test/unit/test_getMsgTextFromStream.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_getMsgTextFromStream.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_getMsgTextFromStream.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_getMsgTextFromStream.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_getMsgTextFromStream.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_getMsgTextFromStream.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_inheritedFolderProperties.js">mailnews/base/test/unit/test_inheritedFolderProperties.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_inheritedFolderProperties.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_inheritedFolderProperties.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_inheritedFolderProperties.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_inheritedFolderProperties.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_inheritedFolderProperties.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_junkWhitelisting.js">mailnews/base/test/unit/test_junkWhitelisting.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_junkWhitelisting.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_junkWhitelisting.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_junkWhitelisting.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_junkWhitelisting.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_junkWhitelisting.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_loadVirtualFolders.js">mailnews/base/test/unit/test_loadVirtualFolders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_loadVirtualFolders.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_loadVirtualFolders.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_loadVirtualFolders.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_loadVirtualFolders.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_loadVirtualFolders.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_postPluginFilters.js">mailnews/base/test/unit/test_postPluginFilters.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_postPluginFilters.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_postPluginFilters.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_postPluginFilters.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_postPluginFilters.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_postPluginFilters.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_quarantineFilterMove.js">mailnews/base/test/unit/test_quarantineFilterMove.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_quarantineFilterMove.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_quarantineFilterMove.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_quarantineFilterMove.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_quarantineFilterMove.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_quarantineFilterMove.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_searchChaining.js">mailnews/base/test/unit/test_searchChaining.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_searchChaining.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_searchChaining.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_searchChaining.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_searchChaining.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/base/test/unit/test_searchChaining.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/head_compose.js">mailnews/compose/test/unit/head_compose.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/head_compose.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/head_compose.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/head_compose.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/head_compose.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/head_compose.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug235432.js">mailnews/compose/test/unit/test_bug235432.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug235432.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug235432.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug235432.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug235432.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug235432.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug474774.js">mailnews/compose/test/unit/test_bug474774.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug474774.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug474774.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug474774.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug474774.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_bug474774.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendBackground.js">mailnews/compose/test/unit/test_sendBackground.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendBackground.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendBackground.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendBackground.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendBackground.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendBackground.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMailAddressIDN.js">mailnews/compose/test/unit/test_sendMailAddressIDN.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMailAddressIDN.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMailAddressIDN.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMailAddressIDN.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMailAddressIDN.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMailAddressIDN.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageFile.js">mailnews/compose/test/unit/test_sendMessageFile.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageFile.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageFile.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageFile.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageFile.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageFile.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater.js">mailnews/compose/test/unit/test_sendMessageLater.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater2.js">mailnews/compose/test/unit/test_sendMessageLater2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater2.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater2.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater2.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater2.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater2.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater3.js">mailnews/compose/test/unit/test_sendMessageLater3.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater3.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater3.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater3.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater3.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_sendMessageLater3.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_temporaryFilesRemoved.js">mailnews/compose/test/unit/test_temporaryFilesRemoved.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_temporaryFilesRemoved.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_temporaryFilesRemoved.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_temporaryFilesRemoved.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_temporaryFilesRemoved.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/compose/test/unit/test_temporaryFilesRemoved.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/db/msgdb/test/unit/test_maildb.js">mailnews/db/msgdb/test/unit/test_maildb.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/db/msgdb/test/unit/test_maildb.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/db/msgdb/test/unit/test_maildb.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/db/msgdb/test/unit/test_maildb.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/db/msgdb/test/unit/test_maildb.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/db/msgdb/test/unit/test_maildb.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_askuser.js">mailnews/extensions/mdn/test/unit/test_askuser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_askuser.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_askuser.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_askuser.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_askuser.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_askuser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">mailnews/extensions/mdn/test/unit/test_mdnFlags.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_copyThenMove.js">mailnews/imap/test/unit/test_copyThenMove.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_copyThenMove.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_copyThenMove.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_copyThenMove.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_copyThenMove.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_copyThenMove.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_dontStatNoSelect.js">mailnews/imap/test/unit/test_dontStatNoSelect.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_dontStatNoSelect.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_dontStatNoSelect.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_dontStatNoSelect.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_dontStatNoSelect.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_dontStatNoSelect.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFilterActions.js">mailnews/imap/test/unit/test_imapFilterActions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFilterActions.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFilterActions.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFilterActions.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFilterActions.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFilterActions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFolderCopy.js">mailnews/imap/test/unit/test_imapFolderCopy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFolderCopy.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFolderCopy.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFolderCopy.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFolderCopy.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapFolderCopy.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapHighWater.js">mailnews/imap/test/unit/test_imapHighWater.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapHighWater.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapHighWater.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapHighWater.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapHighWater.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_imapHighWater.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_localToImapFilter.js">mailnews/imap/test/unit/test_localToImapFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_localToImapFilter.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_localToImapFilter.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_localToImapFilter.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_localToImapFilter.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_localToImapFilter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_fileName.js">mailnews/local/test/unit/test_fileName.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_fileName.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_fileName.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_fileName.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_fileName.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_fileName.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_folderLoaded.js">mailnews/local/test/unit/test_folderLoaded.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_folderLoaded.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_folderLoaded.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_folderLoaded.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_folderLoaded.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_folderLoaded.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_msgIDParsing.js">mailnews/local/test/unit/test_msgIDParsing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_msgIDParsing.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_msgIDParsing.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_msgIDParsing.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_msgIDParsing.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_msgIDParsing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_over2GBMailboxes.js">mailnews/local/test/unit/test_over2GBMailboxes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_over2GBMailboxes.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_over2GBMailboxes.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_over2GBMailboxes.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_over2GBMailboxes.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_over2GBMailboxes.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3FilterActions.js">mailnews/local/test/unit/test_pop3FilterActions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3FilterActions.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3FilterActions.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3FilterActions.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3FilterActions.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3FilterActions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter.js">mailnews/local/test/unit/test_pop3MoveFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter2.js">mailnews/local/test/unit/test_pop3MoveFilter2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter2.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter2.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter2.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter2.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3MoveFilter2.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3Password2.js">mailnews/local/test/unit/test_pop3Password2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3Password2.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3Password2.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3Password2.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3Password2.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_pop3Password2.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_undoDelete.js">mailnews/local/test/unit/test_undoDelete.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_undoDelete.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_undoDelete.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_undoDelete.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_undoDelete.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/local/test/unit/test_undoDelete.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/IMAPpump.js">mailnews/test/resources/IMAPpump.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/IMAPpump.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/IMAPpump.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/IMAPpump.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/IMAPpump.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/IMAPpump.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/localAccountUtils.js">mailnews/test/resources/localAccountUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/localAccountUtils.js">file</a> |
<a href="/comm-central/annotate/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/localAccountUtils.js">annotate</a> |
<a href="/comm-central/diff/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/localAccountUtils.js">diff</a> |
<a href="/comm-central/comparison/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/localAccountUtils.js">comparison</a> |
<a href="/comm-central/log/7836bd5fcf41f6810ef8ef2934e2ec03004baaab/mailnews/test/resources/localAccountUtils.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/test/unit/test_about_support.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/test/unit/test_about_support.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -157,17 +157,17 @@ function test_get_account_details() {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">   // Our first check is to see that no sensitive data has crept in</span>
<a href="#l1.6"></a><span id="l1.6">   for (let [, data] in Iterator(gSensitiveData))</span>
<a href="#l1.7"></a><span id="l1.7">     do_check_false(accountDetailsText.contains(data));</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">   for (let [, details] in Iterator(accountDetails)) {</span>
<a href="#l1.10"></a><span id="l1.10">     // We're going to make one exception: for the local folders server. We don't</span>
<a href="#l1.11"></a><span id="l1.11">     // care too much about its details.</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    if (details.key == gLocalMsgAccount.key)</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    if (details.key == localAccountUtils.msgAccount.key)</span>
<a href="#l1.14"></a><span id="l1.14">       continue;</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">     // Check that we're expecting to see this server</span>
<a href="#l1.17"></a><span id="l1.17">     let toSeeIndex = accountsToSee.indexOf(details.key);</span>
<a href="#l1.18"></a><span id="l1.18">     do_check_neq(toSeeIndex, -1);</span>
<a href="#l1.19"></a><span id="l1.19">     accountsToSee.splice(toSeeIndex, 1);</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21">     verify_account_details(details);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug428427.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug428427.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -84,17 +84,17 @@ function setupVirtualFolder()</span>
<a href="#l2.4"></a><span id="l2.4">     messages3to4.appendElement(hdrs[i], false);</span>
<a href="#l2.5"></a><span id="l2.5">   gLocalInboxFolder.markMessagesRead(messages3to4, true);</span>
<a href="#l2.6"></a><span id="l2.6"> </span>
<a href="#l2.7"></a><span id="l2.7">   // search will look for tag tag1 in the inbox folder</span>
<a href="#l2.8"></a><span id="l2.8">   var searchTerm = makeSearchTerm(gLocalInboxFolder, tag1, </span>
<a href="#l2.9"></a><span id="l2.9">     Ci.nsMsgSearchAttrib.Keywords, Ci.nsMsgSearchOp.Contains);</span>
<a href="#l2.10"></a><span id="l2.10">     </span>
<a href="#l2.11"></a><span id="l2.11">   dump(&quot;creating virtual folder\n&quot;);</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  var rootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  var rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l2.14"></a><span id="l2.14">   virtualFolder = CreateVirtualFolder(&quot;VfTest&quot;, rootFolder, gLocalInboxFolder.URI, searchTerm, false);</span>
<a href="#l2.15"></a><span id="l2.15">   var count= new Object;</span>
<a href="#l2.16"></a><span id="l2.16">   // Setup search session. Execution continues with testVirtualFolder()</span>
<a href="#l2.17"></a><span id="l2.17">   // after search is done.</span>
<a href="#l2.18"></a><span id="l2.18">   </span>
<a href="#l2.19"></a><span id="l2.19">   var searchSession = Cc[&quot;@mozilla.org/messenger/searchSession;1&quot;]</span>
<a href="#l2.20"></a><span id="l2.20">                         .createInstance(Ci.nsIMsgSearchSession);</span>
<a href="#l2.21"></a><span id="l2.21">   searchSession.addScopeTerm(Ci.nsMsgSearchScope.offlineMail, gLocalInboxFolder);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug434810.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug434810.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -5,17 +5,17 @@</span>
<a href="#l3.4"></a><span id="l3.4"> // Test of setup of localMailFolders</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> function run_test()</span>
<a href="#l3.9"></a><span id="l3.9"> {</span>
<a href="#l3.10"></a><span id="l3.10">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  var rootFolder = gLocalIncomingServer.rootFolder;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  var rootFolder = localAccountUtils.incomingServer.rootFolder;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">   var msgProps = Services.strings.createBundle(&quot;chrome://messenger/locale/messenger.properties&quot;);</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17">   var expectedFolders = [ &quot;Inbox&quot; ]; // Inbox hard-coded in localAccountUtils.js</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19">   // These two MailNews adds by default</span>
<a href="#l3.20"></a><span id="l3.20">   expectedFolders.push(msgProps.GetStringFromName(&quot;outboxFolderName&quot;));</span>
<a href="#l3.21"></a><span id="l3.21">   expectedFolders.push(msgProps.GetStringFromName(&quot;trashFolderName&quot;));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/base/test/unit/test_compactColumnSave.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_compactColumnSave.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -148,17 +148,17 @@ function run_test()</span>
<a href="#l4.4"></a><span id="l4.4"> {</span>
<a href="#l4.5"></a><span id="l4.5">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l4.6"></a><span id="l4.6">   // Load up some messages so that we can copy them in later.</span>
<a href="#l4.7"></a><span id="l4.7">   gMsgFile1 = do_get_file(&quot;../../../data/bugmail10&quot;);</span>
<a href="#l4.8"></a><span id="l4.8">   gMsgFile2 = do_get_file(&quot;../../../data/bugmail11&quot;);</span>
<a href="#l4.9"></a><span id="l4.9">   gMsgFile3 = do_get_file(&quot;../../../data/draft1&quot;);</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">   // Create another folder to move and copy messages around, and force initialization.</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  gLocalFolder2 = gLocalRootFolder.createLocalSubfolder(&quot;folder2&quot;);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  gLocalFolder2 = localAccountUtils.rootFolder.createLocalSubfolder(&quot;folder2&quot;);</span>
<a href="#l4.14"></a><span id="l4.14">   let folderName = gLocalFolder2.prettiestName;</span>
<a href="#l4.15"></a><span id="l4.15">   setColumnStates(gLocalFolder2);</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of all the operations.</span>
<a href="#l4.18"></a><span id="l4.18">   do_test_pending();</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20"> //  do_test_finished();</span>
<a href="#l4.21"></a><span id="l4.21">   // Do the test.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/base/test/unit/test_copyChaining.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_copyChaining.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -57,17 +57,18 @@ function run_test()</span>
<a href="#l5.4"></a><span id="l5.4">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of</span>
<a href="#l5.5"></a><span id="l5.5">   // all the operations.</span>
<a href="#l5.6"></a><span id="l5.6">   do_test_pending();</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8">   gCopyDest = gLocalInboxFolder.createLocalSubfolder(&quot;copyDest&quot;);</span>
<a href="#l5.9"></a><span id="l5.9">   // build up a diverse list of messages</span>
<a href="#l5.10"></a><span id="l5.10">   let messages = [];</span>
<a href="#l5.11"></a><span id="l5.11">   messages = messages.concat(scenarioFactory.directReply(10));</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-  gCopySource = gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;copySource&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+  gCopySource = localAccountUtils.incomingServer</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+                                 .rootMsgFolder.createLocalSubfolder(&quot;copySource&quot;);</span>
<a href="#l5.15"></a><span id="l5.15">   addMessagesToFolder(messages, gCopySource);</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17">   mailTestUtils.updateFolderAndNotify(gCopySource, doTest);</span>
<a href="#l5.18"></a><span id="l5.18">   return true;</span>
<a href="#l5.19"></a><span id="l5.19"> }</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21"> function doTest()</span>
<a href="#l5.22"></a><span id="l5.22"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/base/test/unit/test_copyThenMoveManual.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_copyThenMoveManual.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -14,17 +14,17 @@ var gCopyFolder;</span>
<a href="#l6.4"></a><span id="l6.4"> var gMoveFolder;</span>
<a href="#l6.5"></a><span id="l6.5"> var gFilter; // the test filter</span>
<a href="#l6.6"></a><span id="l6.6"> var gFilterList;</span>
<a href="#l6.7"></a><span id="l6.7"> var gCurTestNum = 1;</span>
<a href="#l6.8"></a><span id="l6.8"> const gTestArray =</span>
<a href="#l6.9"></a><span id="l6.9"> [</span>
<a href="#l6.10"></a><span id="l6.10">   function createFilters() {</span>
<a href="#l6.11"></a><span id="l6.11">     // setup manual copy then move mail filters on the inbox</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    gFilterList = gLocalIncomingServer.getFilterList(null);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    gFilterList = localAccountUtils.incomingServer.getFilterList(null);</span>
<a href="#l6.14"></a><span id="l6.14">     gFilter = gFilterList.createFilter(&quot;copyThenMoveAll&quot;);</span>
<a href="#l6.15"></a><span id="l6.15">     let searchTerm = gFilter.createTerm();</span>
<a href="#l6.16"></a><span id="l6.16">     searchTerm.matchAll = true;</span>
<a href="#l6.17"></a><span id="l6.17">     gFilter.appendTerm(searchTerm);</span>
<a href="#l6.18"></a><span id="l6.18">     let copyAction = gFilter.createAction();</span>
<a href="#l6.19"></a><span id="l6.19">     copyAction.type = Ci.nsMsgFilterAction.CopyToFolder;</span>
<a href="#l6.20"></a><span id="l6.20">     copyAction.targetFolderUri = gCopyFolder.URI;</span>
<a href="#l6.21"></a><span id="l6.21">     gFilter.appendAction(copyAction);</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineat">@@ -103,18 +103,20 @@ function folderCount(folder)</span>
<a href="#l6.23"></a><span id="l6.23">   return count;</span>
<a href="#l6.24"></a><span id="l6.24"> }</span>
<a href="#l6.25"></a><span id="l6.25"> </span>
<a href="#l6.26"></a><span id="l6.26"> function run_test()</span>
<a href="#l6.27"></a><span id="l6.27"> {</span>
<a href="#l6.28"></a><span id="l6.28">   if (!gLocalInboxFolder)</span>
<a href="#l6.29"></a><span id="l6.29">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l6.30"></a><span id="l6.30"> </span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-  gCopyFolder = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;CopyFolder&quot;);</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-  gMoveFolder = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+  gCopyFolder = localAccountUtils.incomingServer</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+                                 .rootFolder.createLocalSubfolder(&quot;CopyFolder&quot;);</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+  gMoveFolder = localAccountUtils.incomingServer</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+                                 .rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l6.37"></a><span id="l6.37"> </span>
<a href="#l6.38"></a><span id="l6.38">   MailServices.mailSession.AddFolderListener(FolderListener, Ci.nsIFolderListener.event |</span>
<a href="#l6.39"></a><span id="l6.39">                                                              Ci.nsIFolderListener.added |</span>
<a href="#l6.40"></a><span id="l6.40">                                                              Ci.nsIFolderListener.removed);</span>
<a href="#l6.41"></a><span id="l6.41"> </span>
<a href="#l6.42"></a><span id="l6.42">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of</span>
<a href="#l6.43"></a><span id="l6.43">   // all the operations.</span>
<a href="#l6.44"></a><span id="l6.44">   do_test_pending();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/test/unit/test_emptyTrash.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_emptyTrash.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -96,17 +96,17 @@ const gTestArray =</span>
<a href="#l7.4"></a><span id="l7.4">     let inboxDB = gLocalInboxFolder.msgDatabase;</span>
<a href="#l7.5"></a><span id="l7.5">     gMsgHdrs[0].hdr = inboxDB.getMsgHdrForMessageID(gMsgHdrs[0].ID);</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7">     // Now delete the message</span>
<a href="#l7.8"></a><span id="l7.8">     deleteMessages(gLocalInboxFolder, [gMsgHdrs[0].hdr], false, false);</span>
<a href="#l7.9"></a><span id="l7.9">   },</span>
<a href="#l7.10"></a><span id="l7.10">   function emptyTrash()</span>
<a href="#l7.11"></a><span id="l7.11">   {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    gRootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    gRootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l7.14"></a><span id="l7.14">     gLocalTrashFolder = gRootFolder.getChildNamed(&quot;Trash&quot;);</span>
<a href="#l7.15"></a><span id="l7.15">     // hold onto a db to make sure that empty trash deals with the case</span>
<a href="#l7.16"></a><span id="l7.16">     // of someone holding onto the db, but the trash folder has a null db.</span>
<a href="#l7.17"></a><span id="l7.17">     let gLocalTrashDB = gLocalTrashFolder.msgDatabase;</span>
<a href="#l7.18"></a><span id="l7.18">     gLocalTrashFolder.msgDatabase = null;</span>
<a href="#l7.19"></a><span id="l7.19">     // this is synchronous</span>
<a href="#l7.20"></a><span id="l7.20">     gLocalTrashFolder.emptyTrash(null, null);</span>
<a href="#l7.21"></a><span id="l7.21">     // check that the trash folder is 0 size, that the db has a 0 message count</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/test/unit/test_folderCompact.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_folderCompact.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -204,20 +204,20 @@ function run_test()</span>
<a href="#l8.4"></a><span id="l8.4"> {</span>
<a href="#l8.5"></a><span id="l8.5">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l8.6"></a><span id="l8.6">   // Load up some messages so that we can copy them in later.</span>
<a href="#l8.7"></a><span id="l8.7">   gMsgFile1 = do_get_file(&quot;../../../data/bugmail10&quot;);</span>
<a href="#l8.8"></a><span id="l8.8">   gMsgFile2 = do_get_file(&quot;../../../data/bugmail11&quot;);</span>
<a href="#l8.9"></a><span id="l8.9">   gMsgFile3 = do_get_file(&quot;../../../data/draft1&quot;);</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11">   // Create another folder to move and copy messages around, and force initialization.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  gLocalFolder2 = gLocalRootFolder.createLocalSubfolder(&quot;folder2&quot;);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+  gLocalFolder2 = localAccountUtils.rootFolder.createLocalSubfolder(&quot;folder2&quot;);</span>
<a href="#l8.14"></a><span id="l8.14">   let folderName = gLocalFolder2.prettiestName;</span>
<a href="#l8.15"></a><span id="l8.15">   // Create a third folder for more testing.</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-  gLocalFolder3 = gLocalRootFolder.createLocalSubfolder(&quot;folder3&quot;);</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+  gLocalFolder3 = localAccountUtils.rootFolder.createLocalSubfolder(&quot;folder3&quot;);</span>
<a href="#l8.18"></a><span id="l8.18">   folderName = gLocalFolder3.prettiestName;</span>
<a href="#l8.19"></a><span id="l8.19"> </span>
<a href="#l8.20"></a><span id="l8.20">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of all the operations.</span>
<a href="#l8.21"></a><span id="l8.21">   do_test_pending();</span>
<a href="#l8.22"></a><span id="l8.22"> </span>
<a href="#l8.23"></a><span id="l8.23"> //  do_test_finished();</span>
<a href="#l8.24"></a><span id="l8.24">   // Do the test.</span>
<a href="#l8.25"></a><span id="l8.25">   doTest(1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/test/unit/test_getMsgTextFromStream.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_getMsgTextFromStream.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -49,17 +49,17 @@ const gTestFiles =</span>
<a href="#l9.4"></a><span id="l9.4">   create(&quot;multipart-complex1&quot;, 1024, false, true, &quot;text/html&quot;), // Things get more complex here</span>
<a href="#l9.5"></a><span id="l9.5">   create(&quot;multipart-complex2&quot;, 1024, false, false, &quot;text/plain&quot;),</span>
<a href="#l9.6"></a><span id="l9.6">   create(&quot;multipart-complex2&quot;, 1024, false, true, &quot;text/plain&quot;),</span>
<a href="#l9.7"></a><span id="l9.7"> ]</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> function run_test()</span>
<a href="#l9.10"></a><span id="l9.10"> {</span>
<a href="#l9.11"></a><span id="l9.11">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  var folder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+  var folder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15">   gTestFiles.forEach(function (test)</span>
<a href="#l9.16"></a><span id="l9.16">   {</span>
<a href="#l9.17"></a><span id="l9.17">     dump(&quot;Testing &quot;+test.name+&quot;\n&quot;);</span>
<a href="#l9.18"></a><span id="l9.18">     var inFile = do_get_file(kDataRoot + test.name);</span>
<a href="#l9.19"></a><span id="l9.19">     var inStream = Cc[&quot;@mozilla.org/network/file-input-stream;1&quot;]</span>
<a href="#l9.20"></a><span id="l9.20">                      .createInstance(Ci.nsIFileInputStream);</span>
<a href="#l9.21"></a><span id="l9.21">     inStream.init(inFile, -1, -1, Ci.nsIFileInputStream.CLOSE_ON_EOF);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/test/unit/test_inheritedFolderProperties.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_inheritedFolderProperties.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5"> /*</span>
<a href="#l10.6"></a><span id="l10.6">  * Testing of inherited folder properties</span>
<a href="#l10.7"></a><span id="l10.7">  */</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9"> function run_test()</span>
<a href="#l10.10"></a><span id="l10.10"> { </span>
<a href="#l10.11"></a><span id="l10.11">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  var rootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+  var rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l10.14"></a><span id="l10.14"> </span>
<a href="#l10.15"></a><span id="l10.15">   // add subfolders to the inbox</span>
<a href="#l10.16"></a><span id="l10.16">   const subFolder11 = gLocalInboxFolder.createLocalSubfolder(&quot;subfolder11&quot;)</span>
<a href="#l10.17"></a><span id="l10.17">                          .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l10.18"></a><span id="l10.18">   const subFolder12 = gLocalInboxFolder.createLocalSubfolder(&quot;subfolder12&quot;)</span>
<a href="#l10.19"></a><span id="l10.19">                          .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l10.20"></a><span id="l10.20">   const subFolder21 = subFolder11.createLocalSubfolder(&quot;subfolder21&quot;);</span>
<a href="#l10.21"></a><span id="l10.21">   const subFolder22 = subFolder12.createLocalSubfolder(&quot;subfolder22&quot;);</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -41,17 +41,17 @@ function run_test()</span>
<a href="#l10.23"></a><span id="l10.23">   subFolder11.setStringProperty(propertyName, folderValue);</span>
<a href="#l10.24"></a><span id="l10.24">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), globalValue);</span>
<a href="#l10.25"></a><span id="l10.25">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.26"></a><span id="l10.26">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), globalValue);</span>
<a href="#l10.27"></a><span id="l10.27">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.28"></a><span id="l10.28">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), globalValue);</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30">   // set a root folder value and check</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-  gLocalIncomingServer.setCharValue(propertyName, rootValue);</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+  localAccountUtils.incomingServer.setCharValue(propertyName, rootValue);</span>
<a href="#l10.33"></a><span id="l10.33">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.34"></a><span id="l10.34">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.35"></a><span id="l10.35">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.36"></a><span id="l10.36">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.37"></a><span id="l10.37">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39">   // force an empty string</span>
<a href="#l10.40"></a><span id="l10.40">   subFolder12.setForcePropertyEmpty(propertyName, true);</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineat">@@ -66,43 +66,43 @@ function run_test()</span>
<a href="#l10.42"></a><span id="l10.42">   subFolder12.setStringProperty(propertyName, &quot;&quot;);</span>
<a href="#l10.43"></a><span id="l10.43">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.44"></a><span id="l10.44">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.45"></a><span id="l10.45">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.46"></a><span id="l10.46">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.47"></a><span id="l10.47">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">   // force an empty string on the server</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-  gLocalIncomingServer.setForcePropertyEmpty(propertyName, true);</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+  localAccountUtils.incomingServer.setForcePropertyEmpty(propertyName, true);</span>
<a href="#l10.52"></a><span id="l10.52">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), &quot;&quot;);</span>
<a href="#l10.53"></a><span id="l10.53">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.54"></a><span id="l10.54">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), &quot;&quot;);</span>
<a href="#l10.55"></a><span id="l10.55">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.56"></a><span id="l10.56">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), &quot;&quot;);</span>
<a href="#l10.57"></a><span id="l10.57"> </span>
<a href="#l10.58"></a><span id="l10.58">   // reset a server to allow inheritance from the global</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineminus">-  gLocalIncomingServer.setCharValue(propertyName, &quot;&quot;);</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineminus">-  gLocalIncomingServer.setForcePropertyEmpty(propertyName, false);</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+  localAccountUtils.incomingServer.setCharValue(propertyName, &quot;&quot;);</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineplus">+  localAccountUtils.incomingServer.setForcePropertyEmpty(propertyName, false);</span>
<a href="#l10.63"></a><span id="l10.63">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), globalValue);</span>
<a href="#l10.64"></a><span id="l10.64">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.65"></a><span id="l10.65">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), globalValue);</span>
<a href="#l10.66"></a><span id="l10.66">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.67"></a><span id="l10.67">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), globalValue);</span>
<a href="#l10.68"></a><span id="l10.68"> </span>
<a href="#l10.69"></a><span id="l10.69">   // check with all levels populated</span>
<a href="#l10.70"></a><span id="l10.70">   subFolder21.setStringProperty(propertyName, folderValue2);</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineminus">-  gLocalIncomingServer.setCharValue(propertyName, rootValue);</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineplus">+  localAccountUtils.incomingServer.setCharValue(propertyName, rootValue);</span>
<a href="#l10.73"></a><span id="l10.73">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.74"></a><span id="l10.74">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.75"></a><span id="l10.75">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.76"></a><span id="l10.76">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue2);</span>
<a href="#l10.77"></a><span id="l10.77">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l10.78"></a><span id="l10.78">   </span>
<a href="#l10.79"></a><span id="l10.79">   // clear the global value and the root value</span>
<a href="#l10.80"></a><span id="l10.80">   Services.prefs.clearUserPref(globalPref);</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineminus">-  gLocalIncomingServer.setCharValue(propertyName, &quot;&quot;);</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineplus">+  localAccountUtils.incomingServer.setCharValue(propertyName, &quot;&quot;);</span>
<a href="#l10.83"></a><span id="l10.83">   do_check_eq(rootFolder.getInheritedStringProperty(propertyName), null);</span>
<a href="#l10.84"></a><span id="l10.84">   do_check_eq(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l10.85"></a><span id="l10.85">   do_check_eq(subFolder12.getInheritedStringProperty(propertyName), null);</span>
<a href="#l10.86"></a><span id="l10.86">   do_check_eq(subFolder21.getInheritedStringProperty(propertyName), folderValue2);</span>
<a href="#l10.87"></a><span id="l10.87">   do_check_eq(subFolder22.getInheritedStringProperty(propertyName), null);</span>
<a href="#l10.88"></a><span id="l10.88"> </span>
<a href="#l10.89"></a><span id="l10.89"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/test/unit/test_junkWhitelisting.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_junkWhitelisting.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -58,17 +58,17 @@ function run_test()</span>
<a href="#l11.4"></a><span id="l11.4"> function continueTest()</span>
<a href="#l11.5"></a><span id="l11.5"> {</span>
<a href="#l11.6"></a><span id="l11.6">   // get the message headers</span>
<a href="#l11.7"></a><span id="l11.7">   let headerEnum = gLocalInboxFolder.messages;</span>
<a href="#l11.8"></a><span id="l11.8">   while (headerEnum.hasMoreElements())</span>
<a href="#l11.9"></a><span id="l11.9">     hdrs.push(headerEnum.getNext().QueryInterface(Ci.nsIMsgDBHdr));</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11">   // check with spam properties set on the local server</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  doChecks(gLocalIncomingServer);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  doChecks(localAccountUtils.incomingServer);</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15">   // Free our globals</span>
<a href="#l11.16"></a><span id="l11.16">   hdrs = null;</span>
<a href="#l11.17"></a><span id="l11.17">   gPOP3Pump = null;</span>
<a href="#l11.18"></a><span id="l11.18">   do_test_finished();</span>
<a href="#l11.19"></a><span id="l11.19"> }</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21"> function doChecks(server)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/test/unit/test_loadVirtualFolders.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_loadVirtualFolders.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -23,15 +23,17 @@ function run_test()</span>
<a href="#l12.4"></a><span id="l12.4">   localMailDir.append(&quot;Mail&quot;);</span>
<a href="#l12.5"></a><span id="l12.5">   localMailDir.append(&quot;Local Folders&quot;);</span>
<a href="#l12.6"></a><span id="l12.6">   localMailDir.append(&quot;unread-local&quot;);</span>
<a href="#l12.7"></a><span id="l12.7">   localMailDir.create(Ci.nsIFile.NORMAL_FILE_TYPE, parseInt(&quot;0644&quot;, 8));</span>
<a href="#l12.8"></a><span id="l12.8">   localMailDir.leafName = &quot;invalidserver-local&quot;;</span>
<a href="#l12.9"></a><span id="l12.9">   localMailDir.create(Ci.nsIFile.NORMAL_FILE_TYPE, parseInt(&quot;0644&quot;, 8));</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11">   MailServices.accounts.loadVirtualFolders();</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  let unreadLocal = gLocalIncomingServer.rootMsgFolder.getChildNamed(&quot;unread-local&quot;);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  let unreadLocal = localAccountUtils.incomingServer</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+                                     .rootMsgFolder.getChildNamed(&quot;unread-local&quot;);</span>
<a href="#l12.15"></a><span id="l12.15">   let searchScope = unreadLocal.msgDatabase.dBFolderInfo.getCharProperty(&quot;searchFolderUri&quot;);</span>
<a href="#l12.16"></a><span id="l12.16">   do_check_eq(searchScope, &quot;mailbox://nobody@Local%20Folders/Inbox|mailbox://nobody@Local%20Folders/Trash&quot;);</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-  let invalidServer = gLocalIncomingServer.rootMsgFolder.getChildNamed(&quot;invalidserver-local&quot;);</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  let searchScope = invalidServer.msgDatabase.dBFolderInfo.getCharProperty(&quot;searchFolderUri&quot;);</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  let invalidServer = localAccountUtils.incomingServer</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+                                       .rootMsgFolder.getChildNamed(&quot;invalidserver-local&quot;);</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+  searchScope = invalidServer.msgDatabase.dBFolderInfo.getCharProperty(&quot;searchFolderUri&quot;);</span>
<a href="#l12.22"></a><span id="l12.22">   do_check_eq(searchScope, &quot;mailbox://nobody@Local%20Folders/Inbox&quot;);</span>
<a href="#l12.23"></a><span id="l12.23"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -285,17 +285,17 @@ function run_test()</span>
<a href="#l13.4"></a><span id="l13.4">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l13.5"></a><span id="l13.5"> </span>
<a href="#l13.6"></a><span id="l13.6">   // Load up some messages so that we can copy them in later.</span>
<a href="#l13.7"></a><span id="l13.7">   gMsgFile1 = do_get_file(&quot;../../../data/bugmail10&quot;);</span>
<a href="#l13.8"></a><span id="l13.8">   gMsgFile2 = do_get_file(&quot;../../../data/bugmail11&quot;);</span>
<a href="#l13.9"></a><span id="l13.9">   gMsgFile3 = do_get_file(&quot;../../../data/draft1&quot;);</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">   // &quot;Trash&quot; folder</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  gRootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  gRootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l13.14"></a><span id="l13.14">   gLocalTrashFolder = gRootFolder.getChildNamed(&quot;Trash&quot;);</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of all the operations.</span>
<a href="#l13.17"></a><span id="l13.17">   do_test_pending();</span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19">   // Do the test.</span>
<a href="#l13.20"></a><span id="l13.20">   doTest(1);</span>
<a href="#l13.21"></a><span id="l13.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/test/unit/test_postPluginFilters.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_postPluginFilters.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -61,17 +61,17 @@ var gTests =</span>
<a href="#l14.4"></a><span id="l14.4"> </span>
<a href="#l14.5"></a><span id="l14.5"> // main test</span>
<a href="#l14.6"></a><span id="l14.6"> function run_test()</span>
<a href="#l14.7"></a><span id="l14.7"> {</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">   // Setup some incoming filters, setting junk priority low, and good high.</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">   // Can't use the fake server, must use the deferredTo local server!</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  let filterList = gLocalIncomingServer.getFilterList(null);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  let filterList = localAccountUtils.incomingServer.getFilterList(null);</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15">   // junkIsLow filter</span>
<a href="#l14.16"></a><span id="l14.16">   let filter = filterList.createFilter(&quot;junkIsLow&quot;);</span>
<a href="#l14.17"></a><span id="l14.17">   let searchTerm = filter.createTerm();</span>
<a href="#l14.18"></a><span id="l14.18">   searchTerm.attrib = Ci.nsMsgSearchAttrib.JunkStatus;</span>
<a href="#l14.19"></a><span id="l14.19">   let value = searchTerm.value;</span>
<a href="#l14.20"></a><span id="l14.20">   value.attrib = Ci.nsMsgSearchAttrib.JunkStatus;</span>
<a href="#l14.21"></a><span id="l14.21">   value.junkStatus = MailServices.junk.JUNK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/test/unit/test_quarantineFilterMove.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_quarantineFilterMove.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -110,19 +110,19 @@ function run_test()</span>
<a href="#l15.4"></a><span id="l15.4">   //  return;</span>
<a href="#l15.5"></a><span id="l15.5">   /**/</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7">   // quarantine messages</span>
<a href="#l15.8"></a><span id="l15.8">   Services.prefs.setBoolPref(&quot;mailnews.downloadToTempFile&quot;, true);</span>
<a href="#l15.9"></a><span id="l15.9">   if (!gLocalInboxFolder)</span>
<a href="#l15.10"></a><span id="l15.10">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  gMoveFolder = gLocalIncomingServer.rootMsgFolder</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  gMoveFolder = localAccountUtils.incomingServer.rootMsgFolder</span>
<a href="#l15.14"></a><span id="l15.14">                   .createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-  gMoveFolder2 = gLocalIncomingServer.rootMsgFolder</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+  gMoveFolder2 = localAccountUtils.incomingServer.rootMsgFolder</span>
<a href="#l15.17"></a><span id="l15.17">                   .createLocalSubfolder(&quot;MoveFolder2&quot;);</span>
<a href="#l15.18"></a><span id="l15.18"> </span>
<a href="#l15.19"></a><span id="l15.19">   MailServices.mailSession.AddFolderListener(FolderListener, Ci.nsIFolderListener.event |</span>
<a href="#l15.20"></a><span id="l15.20">                                                              Ci.nsIFolderListener.added |</span>
<a href="#l15.21"></a><span id="l15.21">                                                              Ci.nsIFolderListener.removed);</span>
<a href="#l15.22"></a><span id="l15.22"> </span>
<a href="#l15.23"></a><span id="l15.23">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of</span>
<a href="#l15.24"></a><span id="l15.24">   // all the operations.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchChaining.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchChaining.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -31,17 +31,17 @@ function run_test()</span>
<a href="#l16.4"></a><span id="l16.4">   gIMAPIncomingServer = createLocalIMAPServer();</span>
<a href="#l16.5"></a><span id="l16.5">   gIMAPIncomingServer.maximumConnectionsNumber = 1;</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7">   // We need an identity so that updateFolder doesn't fail</span>
<a href="#l16.8"></a><span id="l16.8">   let localAccount = MailServices.accounts.createAccount();</span>
<a href="#l16.9"></a><span id="l16.9">   let identity = MailServices.accounts.createIdentity();</span>
<a href="#l16.10"></a><span id="l16.10">   localAccount.addIdentity(identity);</span>
<a href="#l16.11"></a><span id="l16.11">   localAccount.defaultIdentity = identity;</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  localAccount.incomingServer = gLocalIncomingServer;</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  localAccount.incomingServer = localAccountUtils.incomingServer;</span>
<a href="#l16.14"></a><span id="l16.14">   MailServices.accounts.defaultAccount = localAccount;</span>
<a href="#l16.15"></a><span id="l16.15">   </span>
<a href="#l16.16"></a><span id="l16.16">   // Let's also have another account, using the same identity</span>
<a href="#l16.17"></a><span id="l16.17">   let imapAccount = MailServices.accounts.createAccount();</span>
<a href="#l16.18"></a><span id="l16.18">   imapAccount.addIdentity(identity);</span>
<a href="#l16.19"></a><span id="l16.19">   imapAccount.defaultIdentity = identity;</span>
<a href="#l16.20"></a><span id="l16.20">   imapAccount.incomingServer = gIMAPIncomingServer;</span>
<a href="#l16.21"></a><span id="l16.21">   </span>
<a href="#l16.22"></a><span id="l16.22" class="difflineat">@@ -84,17 +84,18 @@ var UrlListener =</span>
<a href="#l16.23"></a><span id="l16.23">     do_check_eq(rc, 0);</span>
<a href="#l16.24"></a><span id="l16.24">     searchTest();</span>
<a href="#l16.25"></a><span id="l16.25">   }</span>
<a href="#l16.26"></a><span id="l16.26"> };</span>
<a href="#l16.27"></a><span id="l16.27"> </span>
<a href="#l16.28"></a><span id="l16.28"> function searchTest()</span>
<a href="#l16.29"></a><span id="l16.29"> {</span>
<a href="#l16.30"></a><span id="l16.30">   // Get the IMAP inbox...</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-  var emptyLocal1 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+  var emptyLocal1 = localAccountUtils.incomingServer</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineplus">+                                     .rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l16.34"></a><span id="l16.34"> </span>
<a href="#l16.35"></a><span id="l16.35">   let searchSession = Cc[&quot;@mozilla.org/messenger/searchSession;1&quot;]</span>
<a href="#l16.36"></a><span id="l16.36">                         .createInstance(Ci.nsIMsgSearchSession);</span>
<a href="#l16.37"></a><span id="l16.37"> </span>
<a href="#l16.38"></a><span id="l16.38">   let searchTerm = searchSession.createTerm();</span>
<a href="#l16.39"></a><span id="l16.39">   searchTerm.matchAll = true;</span>
<a href="#l16.40"></a><span id="l16.40">   searchSession.appendTerm(searchTerm);</span>
<a href="#l16.41"></a><span id="l16.41">   searchSession.addScopeTerm(Ci.nsMsgSearchScope.offlineMail, emptyLocal1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/compose/test/unit/head_compose.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/compose/test/unit/head_compose.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -127,17 +127,17 @@ function createMessage(aAttachment) {</span>
<a href="#l17.4"></a><span id="l17.4">                  .createInstance(Ci.nsIMsgCompFields);</span>
<a href="#l17.5"></a><span id="l17.5">   let params = Cc[&quot;@mozilla.org/messengercompose/composeparams;1&quot;]</span>
<a href="#l17.6"></a><span id="l17.6">                  .createInstance(Ci.nsIMsgComposeParams);</span>
<a href="#l17.7"></a><span id="l17.7">   params.composeFields = fields;</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9">   let msgCompose = MailServices.compose.initCompose(params);</span>
<a href="#l17.10"></a><span id="l17.10">   let identity = getSmtpIdentity(null, getBasicSmtpServer());</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-  let rootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  let rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l17.14"></a><span id="l17.14">   gDraftFolder = null;</span>
<a href="#l17.15"></a><span id="l17.15">   // Make sure the drafts folder is empty</span>
<a href="#l17.16"></a><span id="l17.16">   try {</span>
<a href="#l17.17"></a><span id="l17.17">     gDraftFolder = rootFolder.getChildNamed(&quot;Drafts&quot;);</span>
<a href="#l17.18"></a><span id="l17.18">     // try to delete</span>
<a href="#l17.19"></a><span id="l17.19">     rootFolder.propagateDelete(gDraftFolder, true, null);</span>
<a href="#l17.20"></a><span id="l17.20">   } catch (e) {</span>
<a href="#l17.21"></a><span id="l17.21">     // we don't have to remove the folder because it doen't exist yet</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_bug235432.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_bug235432.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -107,17 +107,17 @@ function run_test() {</span>
<a href="#l18.4"></a><span id="l18.4"> </span>
<a href="#l18.5"></a><span id="l18.5"> function send_message_later(aMessageHeaderKeys, aStatus) {</span>
<a href="#l18.6"></a><span id="l18.6">   let compFields = Cc[&quot;@mozilla.org/messengercompose/composefields;1&quot;]</span>
<a href="#l18.7"></a><span id="l18.7">                      .createInstance(Ci.nsIMsgCompFields);</span>
<a href="#l18.8"></a><span id="l18.8">   let params = Cc[&quot;@mozilla.org/messengercompose/composeparams;1&quot;]</span>
<a href="#l18.9"></a><span id="l18.9">                  .createInstance(Ci.nsIMsgComposeParams);</span>
<a href="#l18.10"></a><span id="l18.10">   params.composeFields = compFields;</span>
<a href="#l18.11"></a><span id="l18.11">   let msgCompose = MailServices.compose.initCompose(params);</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-  let rootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+  let rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l18.14"></a><span id="l18.14">   rootFolder.createLocalSubfolder(&quot;Drafts&quot;);</span>
<a href="#l18.15"></a><span id="l18.15"> </span>
<a href="#l18.16"></a><span id="l18.16">   let smtpServer = getBasicSmtpServer();</span>
<a href="#l18.17"></a><span id="l18.17">   let identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l18.18"></a><span id="l18.18"> </span>
<a href="#l18.19"></a><span id="l18.19">   compFields.from = identity.email;</span>
<a href="#l18.20"></a><span id="l18.20">   compFields.to = kTo;</span>
<a href="#l18.21"></a><span id="l18.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_bug474774.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_bug474774.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -182,17 +182,17 @@ function run_test() {</span>
<a href="#l19.4"></a><span id="l19.4"> </span>
<a href="#l19.5"></a><span id="l19.5">   var smtpServer = getBasicSmtpServer();</span>
<a href="#l19.6"></a><span id="l19.6">   identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8">   account.addIdentity(identity);</span>
<a href="#l19.9"></a><span id="l19.9">   account.defaultIdentity = identity;</span>
<a href="#l19.10"></a><span id="l19.10">   account.incomingServer = incomingServer;</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  sentFolder = gLocalRootFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  sentFolder = localAccountUtils.rootFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l19.14"></a><span id="l19.14"> </span>
<a href="#l19.15"></a><span id="l19.15">   identity.doFcc = false;</span>
<a href="#l19.16"></a><span id="l19.16"> </span>
<a href="#l19.17"></a><span id="l19.17">   // Now prepare to actually &quot;send&quot; the message later, i.e. dump it in the</span>
<a href="#l19.18"></a><span id="l19.18">   // unsent messages folder.</span>
<a href="#l19.19"></a><span id="l19.19"> </span>
<a href="#l19.20"></a><span id="l19.20">   var compFields = Cc[&quot;@mozilla.org/messengercompose/composefields;1&quot;]</span>
<a href="#l19.21"></a><span id="l19.21">                      .createInstance(Ci.nsIMsgCompFields);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendBackground.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendBackground.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -106,17 +106,18 @@ function run_test() {</span>
<a href="#l20.4"></a><span id="l20.4"> </span>
<a href="#l20.5"></a><span id="l20.5">   var smtpServer = getBasicSmtpServer();</span>
<a href="#l20.6"></a><span id="l20.6">   identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8">   account.addIdentity(identity);</span>
<a href="#l20.9"></a><span id="l20.9">   account.defaultIdentity = identity;</span>
<a href="#l20.10"></a><span id="l20.10">   account.incomingServer = incomingServer;</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-  sentFolder = gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+  sentFolder = localAccountUtils.incomingServer</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+                                .rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l20.15"></a><span id="l20.15"> </span>
<a href="#l20.16"></a><span id="l20.16">   do_check_eq(identity.doFcc, true);</span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18">   // Now prepare to actually &quot;send&quot; the message later, i.e. dump it in the</span>
<a href="#l20.19"></a><span id="l20.19">   // unsent messages folder.</span>
<a href="#l20.20"></a><span id="l20.20"> </span>
<a href="#l20.21"></a><span id="l20.21">   var compFields = Cc[&quot;@mozilla.org/messengercompose/composefields;1&quot;]</span>
<a href="#l20.22"></a><span id="l20.22">                      .createInstance(Ci.nsIMsgCompFields);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMailAddressIDN.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMailAddressIDN.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -175,17 +175,18 @@ function run_test()</span>
<a href="#l21.4"></a><span id="l21.4">   registerAlertTestUtils();</span>
<a href="#l21.5"></a><span id="l21.5">   var composeProps = Services.strings.createBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;);</span>
<a href="#l21.6"></a><span id="l21.6">   expectedAlertMessage = composeProps.GetStringFromName(&quot;errorIllegalLocalPart&quot;)</span>
<a href="#l21.7"></a><span id="l21.7">                                      .replace(&quot;%s&quot;, kToInvalid);</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9">   // Ensure we have at least one mail account</span>
<a href="#l21.10"></a><span id="l21.10">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l21.11"></a><span id="l21.11">   MailServices.accounts.setSpecialFolders();</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-  sentFolder = gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+  sentFolder = localAccountUtils.incomingServer</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+                                .rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16">   // Test 1:</span>
<a href="#l21.17"></a><span id="l21.17">   // Plain ASCII recipient address.</span>
<a href="#l21.18"></a><span id="l21.18">   test = kToASCII;</span>
<a href="#l21.19"></a><span id="l21.19">   DoSendTest(kToASCII, kToASCII, 0);</span>
<a href="#l21.20"></a><span id="l21.20"> </span>
<a href="#l21.21"></a><span id="l21.21">   // Test 2:</span>
<a href="#l21.22"></a><span id="l21.22">   // The recipient's domain part contains a non-ASCII character, hence the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageFile.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageFile.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -114,17 +114,18 @@ function run_test() {</span>
<a href="#l22.4"></a><span id="l22.4">   // Ensure we have at least one mail account</span>
<a href="#l22.5"></a><span id="l22.5">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l22.6"></a><span id="l22.6"> </span>
<a href="#l22.7"></a><span id="l22.7">   MailServices.accounts.setSpecialFolders();</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9">   var smtpServer = getBasicSmtpServer();</span>
<a href="#l22.10"></a><span id="l22.10">   var identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l22.11"></a><span id="l22.11"> </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-  sentFolder = gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+  sentFolder = localAccountUtils.incomingServer</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineplus">+                                .rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16">   do_check_eq(identity.doFcc, true);</span>
<a href="#l22.17"></a><span id="l22.17"> </span>
<a href="#l22.18"></a><span id="l22.18">   var msgSend = Cc[&quot;@mozilla.org/messengercompose/send;1&quot;]</span>
<a href="#l22.19"></a><span id="l22.19">                   .createInstance(Ci.nsIMsgSend);</span>
<a href="#l22.20"></a><span id="l22.20"> </span>
<a href="#l22.21"></a><span id="l22.21">   // Handle the server in a try/catch/finally loop so that we always will stop</span>
<a href="#l22.22"></a><span id="l22.22">   // the server if something fails.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageLater.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageLater.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -189,17 +189,18 @@ function run_test() {</span>
<a href="#l23.4"></a><span id="l23.4"> </span>
<a href="#l23.5"></a><span id="l23.5">   var smtpServer = getBasicSmtpServer();</span>
<a href="#l23.6"></a><span id="l23.6">   identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8">   account.addIdentity(identity);</span>
<a href="#l23.9"></a><span id="l23.9">   account.defaultIdentity = identity;</span>
<a href="#l23.10"></a><span id="l23.10">   account.incomingServer = incomingServer;</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-  sentFolder = gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  sentFolder = localAccountUtils.incomingServer</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+                                .rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l23.15"></a><span id="l23.15"> </span>
<a href="#l23.16"></a><span id="l23.16">   do_check_eq(identity.doFcc, true);</span>
<a href="#l23.17"></a><span id="l23.17"> </span>
<a href="#l23.18"></a><span id="l23.18">   // Now prepare to actually &quot;send&quot; the message later, i.e. dump it in the</span>
<a href="#l23.19"></a><span id="l23.19">   // unsent messages folder.</span>
<a href="#l23.20"></a><span id="l23.20"> </span>
<a href="#l23.21"></a><span id="l23.21">   var compFields = Cc[&quot;@mozilla.org/messengercompose/composefields;1&quot;]</span>
<a href="#l23.22"></a><span id="l23.22">                      .createInstance(Ci.nsIMsgCompFields);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageLater2.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageLater2.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -232,17 +232,17 @@ function run_test() {</span>
<a href="#l24.4"></a><span id="l24.4"> </span>
<a href="#l24.5"></a><span id="l24.5">   var smtpServer = getBasicSmtpServer();</span>
<a href="#l24.6"></a><span id="l24.6">   identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l24.7"></a><span id="l24.7"> </span>
<a href="#l24.8"></a><span id="l24.8">   account.addIdentity(identity);</span>
<a href="#l24.9"></a><span id="l24.9">   account.defaultIdentity = identity;</span>
<a href="#l24.10"></a><span id="l24.10">   account.incomingServer = incomingServer;</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-  gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+  localAccountUtils.incomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l24.14"></a><span id="l24.14"> </span>
<a href="#l24.15"></a><span id="l24.15">   gSentFolder = msgSendLater.getUnsentMessagesFolder(identity);</span>
<a href="#l24.16"></a><span id="l24.16"> </span>
<a href="#l24.17"></a><span id="l24.17">   // Don't copy messages to sent folder for this test</span>
<a href="#l24.18"></a><span id="l24.18">   identity.doFcc = false;</span>
<a href="#l24.19"></a><span id="l24.19"> </span>
<a href="#l24.20"></a><span id="l24.20">   // Create and add a listener</span>
<a href="#l24.21"></a><span id="l24.21">   var messageListener = new msll();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageLater3.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageLater3.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -136,17 +136,18 @@ function run_test() {</span>
<a href="#l25.4"></a><span id="l25.4"> </span>
<a href="#l25.5"></a><span id="l25.5">   var smtpServer = getBasicSmtpServer();</span>
<a href="#l25.6"></a><span id="l25.6">   identity = getSmtpIdentity(kSender, smtpServer);</span>
<a href="#l25.7"></a><span id="l25.7"> </span>
<a href="#l25.8"></a><span id="l25.8">   account.addIdentity(identity);</span>
<a href="#l25.9"></a><span id="l25.9">   account.defaultIdentity = identity;</span>
<a href="#l25.10"></a><span id="l25.10">   account.incomingServer = incomingServer;</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-  sentFolder = gLocalIncomingServer.rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+  sentFolder = localAccountUtils.incomingServer</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+                                .rootMsgFolder.createLocalSubfolder(&quot;Sent&quot;);</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16">   identity.doFcc = false;</span>
<a href="#l25.17"></a><span id="l25.17"> </span>
<a href="#l25.18"></a><span id="l25.18">   // Now prepare to actually &quot;send&quot; the message later, i.e. dump it in the</span>
<a href="#l25.19"></a><span id="l25.19">   // unsent messages folder.</span>
<a href="#l25.20"></a><span id="l25.20"> </span>
<a href="#l25.21"></a><span id="l25.21">   var compFields = Cc[&quot;@mozilla.org/messengercompose/composefields;1&quot;]</span>
<a href="#l25.22"></a><span id="l25.22">                      .createInstance(Ci.nsIMsgCompFields);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_temporaryFilesRemoved.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_temporaryFilesRemoved.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -90,17 +90,17 @@ function run_test() {</span>
<a href="#l26.4"></a><span id="l26.4"> </span>
<a href="#l26.5"></a><span id="l26.5">   params.composeFields = fields;</span>
<a href="#l26.6"></a><span id="l26.6">   params.format = Ci.nsIMsgCompFormat.HTML;</span>
<a href="#l26.7"></a><span id="l26.7"> </span>
<a href="#l26.8"></a><span id="l26.8">   gMsgCompose.initialize(params, null, null);</span>
<a href="#l26.9"></a><span id="l26.9"> </span>
<a href="#l26.10"></a><span id="l26.10">   let identity = getSmtpIdentity(null, getBasicSmtpServer());</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-  let rootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+  let rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l26.14"></a><span id="l26.14">   let draftFolder = rootFolder.createLocalSubfolder(&quot;Drafts&quot;);</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16">   let progress = Cc[&quot;@mozilla.org/messenger/progress;1&quot;]</span>
<a href="#l26.17"></a><span id="l26.17">                    .createInstance(Ci.nsIMsgProgress);</span>
<a href="#l26.18"></a><span id="l26.18">   progress.registerListener(progressListener);</span>
<a href="#l26.19"></a><span id="l26.19"> </span>
<a href="#l26.20"></a><span id="l26.20">   do_test_pending();</span>
<a href="#l26.21"></a><span id="l26.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/db/msgdb/test/unit/test_maildb.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/db/msgdb/test/unit/test_maildb.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -11,17 +11,17 @@ var gCurTestNum = 0;</span>
<a href="#l27.4"></a><span id="l27.4"> const kNumTestMessages = 10;</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6"> const gTestArray =</span>
<a href="#l27.7"></a><span id="l27.7"> [</span>
<a href="#l27.8"></a><span id="l27.8">   function test_db_open() {</span>
<a href="#l27.9"></a><span id="l27.9">     dbService = Components.classes[&quot;@mozilla.org/msgDatabase/msgDBService;1&quot;]</span>
<a href="#l27.10"></a><span id="l27.10">                             .getService(Components.interfaces.nsIMsgDBService);</span>
<a href="#l27.11"></a><span id="l27.11">     // Get the root folder</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    let root = gLocalIncomingServer.rootFolder;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+    let root = localAccountUtils.incomingServer.rootFolder;</span>
<a href="#l27.14"></a><span id="l27.14">     root.createSubfolder(&quot;dbTest&quot;, null);</span>
<a href="#l27.15"></a><span id="l27.15">     gTestFolder = root.getChildNamed(&quot;dbTest&quot;);</span>
<a href="#l27.16"></a><span id="l27.16">     let db = dbService.openFolderDB(gTestFolder, true);</span>
<a href="#l27.17"></a><span id="l27.17">     do_check_neq(db, null);</span>
<a href="#l27.18"></a><span id="l27.18">     db.dBFolderInfo.highWater = 10;</span>
<a href="#l27.19"></a><span id="l27.19">     db.Close(true);</span>
<a href="#l27.20"></a><span id="l27.20">     db = dbService.openFolderDB(gTestFolder, true);</span>
<a href="#l27.21"></a><span id="l27.21">     do_check_neq(db, null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/extensions/mdn/test/unit/test_askuser.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/extensions/mdn/test/unit/test_askuser.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,14 +1,15 @@</span>
<a href="#l28.4"></a><span id="l28.4"> var gMessenger = Cc[&quot;@mozilla.org/messenger;1&quot;].</span>
<a href="#l28.5"></a><span id="l28.5">                    createInstance(Ci.nsIMessenger);</span>
<a href="#l28.6"></a><span id="l28.6"> </span>
<a href="#l28.7"></a><span id="l28.7"> localAccountUtils.loadLocalMailAccount();</span>
<a href="#l28.8"></a><span id="l28.8"> </span>
<a href="#l28.9"></a><span id="l28.9" class="difflineminus">-let localAccount = MailServices.accounts.FindAccountForServer(gLocalIncomingServer);</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineplus">+let localAccount = MailServices.accounts</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineplus">+                               .FindAccountForServer(localAccountUtils.incomingServer);</span>
<a href="#l28.12"></a><span id="l28.12"> let identity = MailServices.accounts.createIdentity();</span>
<a href="#l28.13"></a><span id="l28.13"> identity.email = &quot;bob@t2.example.net&quot;;</span>
<a href="#l28.14"></a><span id="l28.14"> localAccount.addIdentity(identity);</span>
<a href="#l28.15"></a><span id="l28.15"> localAccount.defaultIdentity = identity;</span>
<a href="#l28.16"></a><span id="l28.16"> </span>
<a href="#l28.17"></a><span id="l28.17"> function run_test()</span>
<a href="#l28.18"></a><span id="l28.18"> {</span>
<a href="#l28.19"></a><span id="l28.19">   var headers = </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/extensions/mdn/test/unit/test_mdnFlags.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -3,17 +3,18 @@</span>
<a href="#l29.4"></a><span id="l29.4">  * reprompt when the user re-selects a message.</span>
<a href="#l29.5"></a><span id="l29.5">  */</span>
<a href="#l29.6"></a><span id="l29.6"> </span>
<a href="#l29.7"></a><span id="l29.7"> var gMessenger = Cc[&quot;@mozilla.org/messenger;1&quot;].</span>
<a href="#l29.8"></a><span id="l29.8">                    createInstance(Ci.nsIMessenger);</span>
<a href="#l29.9"></a><span id="l29.9"> </span>
<a href="#l29.10"></a><span id="l29.10"> localAccountUtils.loadLocalMailAccount();</span>
<a href="#l29.11"></a><span id="l29.11"> </span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-let localAccount = MailServices.accounts.FindAccountForServer(gLocalIncomingServer);</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+let localAccount = MailServices.accounts</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+                               .FindAccountForServer(localAccountUtils.incomingServer);</span>
<a href="#l29.15"></a><span id="l29.15"> let identity = MailServices.accounts.createIdentity();</span>
<a href="#l29.16"></a><span id="l29.16"> identity.email = &quot;bob@t2.example.net&quot;;</span>
<a href="#l29.17"></a><span id="l29.17"> localAccount.addIdentity(identity);</span>
<a href="#l29.18"></a><span id="l29.18"> localAccount.defaultIdentity = identity;</span>
<a href="#l29.19"></a><span id="l29.19"> </span>
<a href="#l29.20"></a><span id="l29.20"> </span>
<a href="#l29.21"></a><span id="l29.21"> </span>
<a href="#l29.22"></a><span id="l29.22"> function run_test()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_copyThenMove.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_copyThenMove.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -105,18 +105,20 @@ function setup() {</span>
<a href="#l30.4"></a><span id="l30.4">   // fetching messages is invoked after copying the messages.</span>
<a href="#l30.5"></a><span id="l30.5">   // (i.e. The fetching process will be invoked after OnStopCopy)</span>
<a href="#l30.6"></a><span id="l30.6">   // It will cause crash with an assertion</span>
<a href="#l30.7"></a><span id="l30.7">   // (ASSERTION: tried to add duplicate listener: 'index == -1') on teardown.</span>
<a href="#l30.8"></a><span id="l30.8">   Services.prefs.setBoolPref(&quot;mail.server.default.autosync_offline_stores&quot;, false);</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10">   setupIMAPPump();</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-  gEmptyLocal1 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-  gEmptyLocal2 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+  gEmptyLocal1 = localAccountUtils.incomingServer.rootFolder</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+                                  .createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineplus">+  gEmptyLocal2 = localAccountUtils.incomingServer</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+                                  .rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l30.18"></a><span id="l30.18"> </span>
<a href="#l30.19"></a><span id="l30.19">   // these hacks are required because we've created the inbox before</span>
<a href="#l30.20"></a><span id="l30.20">   // running initial folder discovery, and adding the folder bails</span>
<a href="#l30.21"></a><span id="l30.21">   // out before we set it as verified online, so we bail out, and</span>
<a href="#l30.22"></a><span id="l30.22">   // then remove the INBOX folder since it's not verified.</span>
<a href="#l30.23"></a><span id="l30.23">   gIMAPInbox.hierarchyDelimiter = '/';</span>
<a href="#l30.24"></a><span id="l30.24">   gIMAPInbox.verifiedAsOnlineFolder = true;</span>
<a href="#l30.25"></a><span id="l30.25"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_dontStatNoSelect.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_dontStatNoSelect.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -34,17 +34,17 @@ function run_test() {</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l31.6"></a><span id="l31.6"> </span>
<a href="#l31.7"></a><span id="l31.7">   // We need an identity so that updateFolder doesn't fail</span>
<a href="#l31.8"></a><span id="l31.8">   let localAccount = MailServices.accounts.createAccount();</span>
<a href="#l31.9"></a><span id="l31.9">   let identity = MailServices.accounts.createIdentity();</span>
<a href="#l31.10"></a><span id="l31.10">   localAccount.addIdentity(identity);</span>
<a href="#l31.11"></a><span id="l31.11">   localAccount.defaultIdentity = identity;</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-  localAccount.incomingServer = gLocalIncomingServer;</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+  localAccount.incomingServer = localAccountUtils.incomingServer;</span>
<a href="#l31.14"></a><span id="l31.14">   MailServices.accounts.defaultAccount = localAccount;</span>
<a href="#l31.15"></a><span id="l31.15"> </span>
<a href="#l31.16"></a><span id="l31.16">   // Let's also have another account, using the same identity</span>
<a href="#l31.17"></a><span id="l31.17">   let imapAccount = MailServices.accounts.createAccount();</span>
<a href="#l31.18"></a><span id="l31.18">   imapAccount.addIdentity(identity);</span>
<a href="#l31.19"></a><span id="l31.19">   imapAccount.defaultIdentity = identity;</span>
<a href="#l31.20"></a><span id="l31.20">   imapAccount.incomingServer = gImapServer;</span>
<a href="#l31.21"></a><span id="l31.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapFilterActions.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapFilterActions.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -332,17 +332,17 @@ function run_test()</span>
<a href="#l32.4"></a><span id="l32.4">   if (!gLocalInboxFolder)</span>
<a href="#l32.5"></a><span id="l32.5">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l32.6"></a><span id="l32.6"> </span>
<a href="#l32.7"></a><span id="l32.7">   // We need an identity so that updateFolder doesn't fail</span>
<a href="#l32.8"></a><span id="l32.8">   let localAccount = MailServices.accounts.createAccount();</span>
<a href="#l32.9"></a><span id="l32.9">   let identity = MailServices.accounts.createIdentity();</span>
<a href="#l32.10"></a><span id="l32.10">   localAccount.addIdentity(identity);</span>
<a href="#l32.11"></a><span id="l32.11">   localAccount.defaultIdentity = identity;</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-  localAccount.incomingServer = gLocalIncomingServer;</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+  localAccount.incomingServer = localAccountUtils.incomingServer;</span>
<a href="#l32.14"></a><span id="l32.14">   MailServices.accounts.defaultAccount = localAccount;</span>
<a href="#l32.15"></a><span id="l32.15"> </span>
<a href="#l32.16"></a><span id="l32.16">   // Let's also have another account, using the same identity</span>
<a href="#l32.17"></a><span id="l32.17">   let imapAccount = MailServices.accounts.createAccount();</span>
<a href="#l32.18"></a><span id="l32.18">   imapAccount.addIdentity(identity);</span>
<a href="#l32.19"></a><span id="l32.19">   imapAccount.defaultIdentity = identity;</span>
<a href="#l32.20"></a><span id="l32.20">   imapAccount.incomingServer = gIMAPIncomingServer;</span>
<a href="#l32.21"></a><span id="l32.21"> </span>
<a href="#l32.22"></a><span id="l32.22" class="difflineat">@@ -350,17 +350,18 @@ function run_test()</span>
<a href="#l32.23"></a><span id="l32.23">   Services.prefs.setIntPref(&quot;mail.server.default.max_cached_connections&quot;, 1);</span>
<a href="#l32.24"></a><span id="l32.24">   // We aren't interested in downloading messages automatically</span>
<a href="#l32.25"></a><span id="l32.25">   Services.prefs.setBoolPref(&quot;mail.server.default.download_on_biff&quot;, false);</span>
<a href="#l32.26"></a><span id="l32.26">   Services.prefs.setBoolPref(&quot;mail.biff.play_sound&quot;, false);</span>
<a href="#l32.27"></a><span id="l32.27">   Services.prefs.setBoolPref(&quot;mail.biff.show_alert&quot;, false);</span>
<a href="#l32.28"></a><span id="l32.28">   Services.prefs.setBoolPref(&quot;mail.biff.show_tray_icon&quot;, false);</span>
<a href="#l32.29"></a><span id="l32.29">   Services.prefs.setBoolPref(&quot;mail.biff.animate_dock_icon&quot;, false);</span>
<a href="#l32.30"></a><span id="l32.30"> </span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-  gSubfolder = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;Subfolder&quot;);</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+  gSubfolder = localAccountUtils.incomingServer</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineplus">+                                .rootFolder.createLocalSubfolder(&quot;Subfolder&quot;);</span>
<a href="#l32.34"></a><span id="l32.34">   gIMAPIncomingServer.performExpand(null);</span>
<a href="#l32.35"></a><span id="l32.35"> </span>
<a href="#l32.36"></a><span id="l32.36">   gRootFolder = gIMAPIncomingServer.rootFolder;</span>
<a href="#l32.37"></a><span id="l32.37">   gIMAPInbox = gRootFolder.getChildNamed(&quot;INBOX&quot;);</span>
<a href="#l32.38"></a><span id="l32.38">   gIMAPMailbox = gIMAPDaemon.getMailbox(&quot;INBOX&quot;);</span>
<a href="#l32.39"></a><span id="l32.39">   dump(&quot;gIMAPInbox uri = &quot; + gIMAPInbox.URI + &quot;\n&quot;);</span>
<a href="#l32.40"></a><span id="l32.40">   let msgImapFolder = gIMAPInbox.QueryInterface(Ci.nsIMsgImapMailFolder);</span>
<a href="#l32.41"></a><span id="l32.41">   // these hacks are required because we've created the inbox before</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapFolderCopy.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapFolderCopy.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -95,20 +95,24 @@ var tests = [</span>
<a href="#l33.4"></a><span id="l33.4">     yield false;</span>
<a href="#l33.5"></a><span id="l33.5">   },</span>
<a href="#l33.6"></a><span id="l33.6">   teardown</span>
<a href="#l33.7"></a><span id="l33.7"> ];</span>
<a href="#l33.8"></a><span id="l33.8"> </span>
<a href="#l33.9"></a><span id="l33.9"> function setup() {</span>
<a href="#l33.10"></a><span id="l33.10">   setupIMAPPump();</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-  gEmptyLocal1 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-  gEmptyLocal2 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-  gEmptyLocal3 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 3&quot;);</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-  gNotEmptyLocal4 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;not empty 4&quot;);</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+  gEmptyLocal1 = localAccountUtils.incomingServer</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineplus">+                                  .rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineplus">+  gEmptyLocal2 = localAccountUtils.incomingServer</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineplus">+                                  .rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineplus">+  gEmptyLocal3 = localAccountUtils.incomingServer</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineplus">+                                  .rootFolder.createLocalSubfolder(&quot;empty 3&quot;);</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineplus">+  gNotEmptyLocal4 = localAccountUtils.incomingServer</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineplus">+                                     .rootFolder.createLocalSubfolder(&quot;not empty 4&quot;);</span>
<a href="#l33.24"></a><span id="l33.24"> </span>
<a href="#l33.25"></a><span id="l33.25">   let messageGenerator = new MessageGenerator();</span>
<a href="#l33.26"></a><span id="l33.26">   let message = messageGenerator.makeMessage();</span>
<a href="#l33.27"></a><span id="l33.27">   gNotEmptyLocal4.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l33.28"></a><span id="l33.28">   gNotEmptyLocal4.addMessage(message.toMboxString());</span>
<a href="#l33.29"></a><span id="l33.29"> </span>
<a href="#l33.30"></a><span id="l33.30">   // these hacks are required because we've created the inbox before</span>
<a href="#l33.31"></a><span id="l33.31">   // running initial folder discovery, and adding the folder bails</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapHighWater.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapHighWater.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -43,17 +43,17 @@ function run_test()</span>
<a href="#l34.4"></a><span id="l34.4">   gIMAPIncomingServer = createLocalIMAPServer();</span>
<a href="#l34.5"></a><span id="l34.5">   gIMAPIncomingServer.maximumConnectionsNumber = 1;</span>
<a href="#l34.6"></a><span id="l34.6"> </span>
<a href="#l34.7"></a><span id="l34.7">   // We need an identity so that updateFolder doesn't fail</span>
<a href="#l34.8"></a><span id="l34.8">   let localAccount = MailServices.accounts.createAccount();</span>
<a href="#l34.9"></a><span id="l34.9">   let identity = MailServices.accounts.createIdentity();</span>
<a href="#l34.10"></a><span id="l34.10">   localAccount.addIdentity(identity);</span>
<a href="#l34.11"></a><span id="l34.11">   localAccount.defaultIdentity = identity;</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-  localAccount.incomingServer = gLocalIncomingServer;</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+  localAccount.incomingServer = localAccountUtils.incomingServer;</span>
<a href="#l34.14"></a><span id="l34.14">   MailServices.accounts.defaultAccount = localAccount;</span>
<a href="#l34.15"></a><span id="l34.15"> </span>
<a href="#l34.16"></a><span id="l34.16">   // Let's also have another account, using the same identity</span>
<a href="#l34.17"></a><span id="l34.17">   let imapAccount = MailServices.accounts.createAccount();</span>
<a href="#l34.18"></a><span id="l34.18">   imapAccount.addIdentity(identity);</span>
<a href="#l34.19"></a><span id="l34.19">   imapAccount.defaultIdentity = identity;</span>
<a href="#l34.20"></a><span id="l34.20">   imapAccount.incomingServer = gIMAPIncomingServer;</span>
<a href="#l34.21"></a><span id="l34.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_localToImapFilter.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_localToImapFilter.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -100,18 +100,20 @@ function folderCount(folder)</span>
<a href="#l35.4"></a><span id="l35.4">     count++;</span>
<a href="#l35.5"></a><span id="l35.5">     let hdr = enumerator.getNext();</span>
<a href="#l35.6"></a><span id="l35.6">   }</span>
<a href="#l35.7"></a><span id="l35.7">   return count;</span>
<a href="#l35.8"></a><span id="l35.8"> }</span>
<a href="#l35.9"></a><span id="l35.9"> </span>
<a href="#l35.10"></a><span id="l35.10"> function setup() {</span>
<a href="#l35.11"></a><span id="l35.11">   setupIMAPPump(); </span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-  gEmptyLocal1 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-  gEmptyLocal2 = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+  gEmptyLocal1 = localAccountUtils.incomingServer</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineplus">+                                  .rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineplus">+  gEmptyLocal2 = localAccountUtils.incomingServer</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineplus">+                                  .rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l35.18"></a><span id="l35.18"> </span>
<a href="#l35.19"></a><span id="l35.19">   // these hacks are required because we've created the inbox before</span>
<a href="#l35.20"></a><span id="l35.20">   // running initial folder discovery, and adding the folder bails</span>
<a href="#l35.21"></a><span id="l35.21">   // out before we set it as verified online, so we bail out, and</span>
<a href="#l35.22"></a><span id="l35.22">   // then remove the INBOX folder since it's not verified.</span>
<a href="#l35.23"></a><span id="l35.23">   gIMAPInbox.hierarchyDelimiter = '/';</span>
<a href="#l35.24"></a><span id="l35.24">   gIMAPInbox.verifiedAsOnlineFolder = true;</span>
<a href="#l35.25"></a><span id="l35.25"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -208,17 +208,17 @@ function run_test()</span>
<a href="#l36.4"></a><span id="l36.4">   // for sent items</span>
<a href="#l36.5"></a><span id="l36.5">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l36.6"></a><span id="l36.6"> </span>
<a href="#l36.7"></a><span id="l36.7">   // We need an identity so that updateFolder doesn't fail</span>
<a href="#l36.8"></a><span id="l36.8">   let localAccount = MailServices.accounts.createAccount();</span>
<a href="#l36.9"></a><span id="l36.9">   let identity = MailServices.accounts.createIdentity();</span>
<a href="#l36.10"></a><span id="l36.10">   localAccount.addIdentity(identity);</span>
<a href="#l36.11"></a><span id="l36.11">   localAccount.defaultIdentity = identity;</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-  localAccount.incomingServer = gLocalIncomingServer;</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+  localAccount.incomingServer = localAccountUtils.incomingServer;</span>
<a href="#l36.14"></a><span id="l36.14">   MailServices.accounts.defaultAccount = localAccount;</span>
<a href="#l36.15"></a><span id="l36.15"> </span>
<a href="#l36.16"></a><span id="l36.16">   // Let's also have another account, using the same identity</span>
<a href="#l36.17"></a><span id="l36.17">   let imapAccount = MailServices.accounts.createAccount();</span>
<a href="#l36.18"></a><span id="l36.18">   imapAccount.addIdentity(identity);</span>
<a href="#l36.19"></a><span id="l36.19">   imapAccount.defaultIdentity = identity;</span>
<a href="#l36.20"></a><span id="l36.20">   imapAccount.incomingServer = gIMAPIncomingServer;</span>
<a href="#l36.21"></a><span id="l36.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mailnews/local/test/unit/test_fileName.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_fileName.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -46,29 +46,29 @@ function run_test() {</span>
<a href="#l37.4"></a><span id="l37.4">                              &quot;[ProfD]Mail/poptest&quot;);</span>
<a href="#l37.5"></a><span id="l37.5">   Services.prefs.setCharPref(&quot;mail.server.server2.hostname&quot;, &quot;poptest&quot;);</span>
<a href="#l37.6"></a><span id="l37.6">   Services.prefs.setCharPref(&quot;mail.server.server2.name&quot;, &quot;poptest&quot;);</span>
<a href="#l37.7"></a><span id="l37.7">   Services.prefs.setCharPref(&quot;mail.server.server2.type&quot;, &quot;pop3&quot;);</span>
<a href="#l37.8"></a><span id="l37.8">   Services.prefs.setCharPref(&quot;mail.server.server2.userName&quot;, &quot;user&quot;);</span>
<a href="#l37.9"></a><span id="l37.9">   // This basically says to ignore the time stamp in the .msf file</span>
<a href="#l37.10"></a><span id="l37.10">   Services.prefs.setIntPref(&quot;mail.db_timestamp_leeway&quot;, 0x7FFFFFFF);</span>
<a href="#l37.11"></a><span id="l37.11">   </span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-  gLocalIncomingServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+  localAccountUtils.incomingServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l37.14"></a><span id="l37.14">   // force load of accounts.</span>
<a href="#l37.15"></a><span id="l37.15">   let defaultAccount = MailServices.accounts.defaultAccount;</span>
<a href="#l37.16"></a><span id="l37.16"> </span>
<a href="#l37.17"></a><span id="l37.17">   let pop3Server = MailServices.accounts.FindServer(&quot;user&quot;, &quot;poptest&quot;, &quot;pop3&quot;);</span>
<a href="#l37.18"></a><span id="l37.18" class="difflineminus">-  var rootFolder = gLocalIncomingServer.rootMsgFolder</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineplus">+  var rootFolder = localAccountUtils.incomingServer.rootMsgFolder</span>
<a href="#l37.20"></a><span id="l37.20">     .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l37.21"></a><span id="l37.21">   let pop3Root = pop3Server.rootMsgFolder;</span>
<a href="#l37.22"></a><span id="l37.22">   </span>
<a href="#l37.23"></a><span id="l37.23">   // Note: Inbox is not created automatically when there is no deferred server,</span>
<a href="#l37.24"></a><span id="l37.24">   // so we need to create it.</span>
<a href="#l37.25"></a><span id="l37.25">   gLocalInboxFolder = rootFolder.createLocalSubfolder(&quot;Inbox&quot;);</span>
<a href="#l37.26"></a><span id="l37.26">   // a local inbox should have a Mail flag!</span>
<a href="#l37.27"></a><span id="l37.27">   gLocalInboxFolder.setFlag(Ci.nsMsgFolderFlags.Mail);</span>
<a href="#l37.28"></a><span id="l37.28">   </span>
<a href="#l37.29"></a><span id="l37.29" class="difflineminus">-  let rootFolder = gLocalIncomingServer.rootMsgFolder;</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineplus">+  let rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l37.31"></a><span id="l37.31">   let bugmail = rootFolder.getChildNamed(&quot;bugmail:1&quot;);</span>
<a href="#l37.32"></a><span id="l37.32">   do_check_eq(bugmail.getTotalMessages(false), 1);</span>
<a href="#l37.33"></a><span id="l37.33">   bugmail = pop3Root.getChildNamed(&quot;bugmail:1&quot;);</span>
<a href="#l37.34"></a><span id="l37.34">   do_check_eq(bugmail.getTotalMessages(false), 1);</span>
<a href="#l37.35"></a><span id="l37.35"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/local/test/unit/test_folderLoaded.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_folderLoaded.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -26,18 +26,18 @@ var tests = [</span>
<a href="#l38.4"></a><span id="l38.4">   {</span>
<a href="#l38.5"></a><span id="l38.5">     do_timeout(5000, function() {</span>
<a href="#l38.6"></a><span id="l38.6">       // should be done by now</span>
<a href="#l38.7"></a><span id="l38.7">       do_check_true(false);</span>
<a href="#l38.8"></a><span id="l38.8">     });</span>
<a href="#l38.9"></a><span id="l38.9">  </span>
<a href="#l38.10"></a><span id="l38.10">     if (typeof gLocalInboxFolder == 'undefined')</span>
<a href="#l38.11"></a><span id="l38.11">       localAccountUtils.loadLocalMailAccount();</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-    gLocalRootFolder.createSubfolder(&quot;target&quot;, null);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-    gTargetFolder = gLocalRootFolder.getChildNamed(&quot;target&quot;);</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+    localAccountUtils.rootFolder.createSubfolder(&quot;target&quot;, null);</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineplus">+    gTargetFolder = localAccountUtils.rootFolder.getChildNamed(&quot;target&quot;);</span>
<a href="#l38.16"></a><span id="l38.16"> </span>
<a href="#l38.17"></a><span id="l38.17">     MailServices.copy.CopyFileMessage(gMsgFile1, gTargetFolder, null, false, 0,</span>
<a href="#l38.18"></a><span id="l38.18">                                       &quot;&quot;, asyncCopyListener, null);</span>
<a href="#l38.19"></a><span id="l38.19">     yield false;</span>
<a href="#l38.20"></a><span id="l38.20"> </span>
<a href="#l38.21"></a><span id="l38.21">     MailServices.copy.CopyFileMessage(gMsgFile2, gTargetFolder, null, false, 0,</span>
<a href="#l38.22"></a><span id="l38.22">                                       &quot;&quot;, asyncCopyListener, null);</span>
<a href="#l38.23"></a><span id="l38.23">     yield false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/local/test/unit/test_msgIDParsing.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_msgIDParsing.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -5,17 +5,18 @@</span>
<a href="#l39.4"></a><span id="l39.4"> </span>
<a href="#l39.5"></a><span id="l39.5"> Components.utils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l39.6"></a><span id="l39.6"> </span>
<a href="#l39.7"></a><span id="l39.7"> var gMessenger = Cc[&quot;@mozilla.org/messenger;1&quot;].</span>
<a href="#l39.8"></a><span id="l39.8">                    createInstance(Ci.nsIMessenger);</span>
<a href="#l39.9"></a><span id="l39.9"> </span>
<a href="#l39.10"></a><span id="l39.10"> localAccountUtils.loadLocalMailAccount();</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-let localAccount = MailServices.accounts.FindAccountForServer(gLocalIncomingServer);</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+let localAccount = MailServices.accounts</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+                               .FindAccountForServer(localAccountUtils.incomingServer);</span>
<a href="#l39.15"></a><span id="l39.15"> let identity = MailServices.accounts.createIdentity();</span>
<a href="#l39.16"></a><span id="l39.16"> identity.email = &quot;bob@t2.example.net&quot;;</span>
<a href="#l39.17"></a><span id="l39.17"> localAccount.addIdentity(identity);</span>
<a href="#l39.18"></a><span id="l39.18"> localAccount.defaultIdentity = identity;</span>
<a href="#l39.19"></a><span id="l39.19"> </span>
<a href="#l39.20"></a><span id="l39.20"> function run_test()</span>
<a href="#l39.21"></a><span id="l39.21"> {</span>
<a href="#l39.22"></a><span id="l39.22">   var headers = </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mailnews/local/test/unit/test_over2GBMailboxes.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_over2GBMailboxes.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -29,17 +29,18 @@ function run_test()</span>
<a href="#l40.4"></a><span id="l40.4">              &quot; free space to run. Aborting.&quot;);</span>
<a href="#l40.5"></a><span id="l40.5">     todo_check_true(false);</span>
<a href="#l40.6"></a><span id="l40.6"> </span>
<a href="#l40.7"></a><span id="l40.7">     endTest();</span>
<a href="#l40.8"></a><span id="l40.8">     return;</span>
<a href="#l40.9"></a><span id="l40.9">   }</span>
<a href="#l40.10"></a><span id="l40.10"> </span>
<a href="#l40.11"></a><span id="l40.11">   // &quot;Trash&quot; folder</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-  gLocalTrashFolder = gLocalIncomingServer.rootMsgFolder.getChildNamed(&quot;Trash&quot;);</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+  gLocalTrashFolder = localAccountUtils.incomingServer</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+                                       .rootMsgFolder.getChildNamed(&quot;Trash&quot;);</span>
<a href="#l40.15"></a><span id="l40.15"> </span>
<a href="#l40.16"></a><span id="l40.16">   // Extend local folder to over 2 GiB.</span>
<a href="#l40.17"></a><span id="l40.17">   let outputStream = Cc[&quot;@mozilla.org/network/file-output-stream;1&quot;]</span>
<a href="#l40.18"></a><span id="l40.18">                        .createInstance(Ci.nsIFileOutputStream)</span>
<a href="#l40.19"></a><span id="l40.19">                        .QueryInterface(Ci.nsISeekableStream);</span>
<a href="#l40.20"></a><span id="l40.20">   // Open in write-only mode, no truncate.</span>
<a href="#l40.21"></a><span id="l40.21">   outputStream.init(inboxFile, 0x02, -1, 0);</span>
<a href="#l40.22"></a><span id="l40.22">   // seek past 2GB.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mailnews/local/test/unit/test_pop3FilterActions.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_pop3FilterActions.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -118,17 +118,18 @@ function folderCount(folder)</span>
<a href="#l41.4"></a><span id="l41.4"> </span>
<a href="#l41.5"></a><span id="l41.5"> function run_test()</span>
<a href="#l41.6"></a><span id="l41.6"> {</span>
<a href="#l41.7"></a><span id="l41.7">   // Make sure we're not quarantining messages</span>
<a href="#l41.8"></a><span id="l41.8">   Services.prefs.setBoolPref(&quot;mailnews.downloadToTempFile&quot;, false);</span>
<a href="#l41.9"></a><span id="l41.9">   if (!gLocalInboxFolder)</span>
<a href="#l41.10"></a><span id="l41.10">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  gMoveFolder = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+  gMoveFolder = localAccountUtils.incomingServer</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineplus">+                                 .rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l41.15"></a><span id="l41.15"> </span>
<a href="#l41.16"></a><span id="l41.16">   MailServices.mailSession.AddFolderListener(FolderListener,</span>
<a href="#l41.17"></a><span id="l41.17">                                              Ci.nsIFolderListener.event |</span>
<a href="#l41.18"></a><span id="l41.18">                                                Ci.nsIFolderListener.added |</span>
<a href="#l41.19"></a><span id="l41.19">                                                Ci.nsIFolderListener.removed);</span>
<a href="#l41.20"></a><span id="l41.20"> </span>
<a href="#l41.21"></a><span id="l41.21">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of</span>
<a href="#l41.22"></a><span id="l41.22">   // all the operations.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mailnews/local/test/unit/test_pop3MoveFilter.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_pop3MoveFilter.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -110,17 +110,18 @@ function folderCount(folder)</span>
<a href="#l42.4"></a><span id="l42.4"> </span>
<a href="#l42.5"></a><span id="l42.5"> function run_test()</span>
<a href="#l42.6"></a><span id="l42.6"> {</span>
<a href="#l42.7"></a><span id="l42.7">   // Make sure we're not quarantining messages</span>
<a href="#l42.8"></a><span id="l42.8">   Services.prefs.setBoolPref(&quot;mailnews.downloadToTempFile&quot;, false);</span>
<a href="#l42.9"></a><span id="l42.9">   if (!gLocalInboxFolder)</span>
<a href="#l42.10"></a><span id="l42.10">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-  gMoveFolder = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+  gMoveFolder = localAccountUtils.incomingServer</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineplus">+                                 .rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l42.15"></a><span id="l42.15"> </span>
<a href="#l42.16"></a><span id="l42.16">   MailServices.mailSession.AddFolderListener(FolderListener,</span>
<a href="#l42.17"></a><span id="l42.17">                                              Ci.nsIFolderListener.event |</span>
<a href="#l42.18"></a><span id="l42.18">                                                Ci.nsIFolderListener.added |</span>
<a href="#l42.19"></a><span id="l42.19">                                                Ci.nsIFolderListener.removed);</span>
<a href="#l42.20"></a><span id="l42.20"> </span>
<a href="#l42.21"></a><span id="l42.21">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of</span>
<a href="#l42.22"></a><span id="l42.22">   // all the operations.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mailnews/local/test/unit/test_pop3MoveFilter2.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_pop3MoveFilter2.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -99,17 +99,18 @@ function folderCount(folder)</span>
<a href="#l43.4"></a><span id="l43.4"> </span>
<a href="#l43.5"></a><span id="l43.5"> function run_test()</span>
<a href="#l43.6"></a><span id="l43.6"> {</span>
<a href="#l43.7"></a><span id="l43.7">   // Make sure we're not quarantining messages</span>
<a href="#l43.8"></a><span id="l43.8">   Services.prefs.setBoolPref(&quot;mailnews.downloadToTempFile&quot;, false);</span>
<a href="#l43.9"></a><span id="l43.9">   if (!gLocalInboxFolder)</span>
<a href="#l43.10"></a><span id="l43.10">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l43.11"></a><span id="l43.11"> </span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-  gMoveFolder = gLocalIncomingServer.rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+  gMoveFolder = localAccountUtils.incomingServer</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineplus">+                                 .rootFolder.createLocalSubfolder(&quot;MoveFolder&quot;);</span>
<a href="#l43.15"></a><span id="l43.15"> </span>
<a href="#l43.16"></a><span id="l43.16">   MailServices.mailSession.AddFolderListener(FolderListener,</span>
<a href="#l43.17"></a><span id="l43.17">                                              Ci.nsIFolderListener.event |</span>
<a href="#l43.18"></a><span id="l43.18">                                                Ci.nsIFolderListener.added |</span>
<a href="#l43.19"></a><span id="l43.19">                                                Ci.nsIFolderListener.removed);</span>
<a href="#l43.20"></a><span id="l43.20"> </span>
<a href="#l43.21"></a><span id="l43.21">   // &quot;Master&quot; do_test_pending(), paired with a do_test_finished() at the end of</span>
<a href="#l43.22"></a><span id="l43.22">   // all the operations.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mailnews/local/test/unit/test_pop3Password2.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_pop3Password2.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -159,19 +159,20 @@ function run_test() {</span>
<a href="#l44.4"></a><span id="l44.4">   var handler = serverArray[2];</span>
<a href="#l44.5"></a><span id="l44.5"> </span>
<a href="#l44.6"></a><span id="l44.6">   // Set the server expected username &amp; password to what we have in signons.txt</span>
<a href="#l44.7"></a><span id="l44.7">   handler.kUsername = &quot;testpop3&quot;;</span>
<a href="#l44.8"></a><span id="l44.8">   handler.kPassword = &quot;pop3test&quot;;</span>
<a href="#l44.9"></a><span id="l44.9"> </span>
<a href="#l44.10"></a><span id="l44.10">   MailServices.accounts.LoadAccounts();</span>
<a href="#l44.11"></a><span id="l44.11"> </span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-  gLocalIncomingServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+  localAccountUtils.incomingServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l44.14"></a><span id="l44.14"> </span>
<a href="#l44.15"></a><span id="l44.15" class="difflineminus">-  var rootFolder = gLocalIncomingServer.rootMsgFolder.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineplus">+  var rootFolder = localAccountUtils.incomingServer</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineplus">+                                    .rootMsgFolder.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l44.18"></a><span id="l44.18"> </span>
<a href="#l44.19"></a><span id="l44.19">   // Note: Inbox is not created automatically when there is no deferred server,</span>
<a href="#l44.20"></a><span id="l44.20">   // so we need to create it.</span>
<a href="#l44.21"></a><span id="l44.21">   gLocalInboxFolder = rootFolder.createLocalSubfolder(&quot;Inbox&quot;);</span>
<a href="#l44.22"></a><span id="l44.22">   // a local inbox should have a Mail flag!</span>
<a href="#l44.23"></a><span id="l44.23">   gLocalInboxFolder.setFlag(Ci.nsMsgFolderFlags.Mail);</span>
<a href="#l44.24"></a><span id="l44.24"> </span>
<a href="#l44.25"></a><span id="l44.25">   // Create the incoming server with &quot;original&quot; details.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mailnews/local/test/unit/test_undoDelete.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_undoDelete.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -127,12 +127,12 @@ var URLListener =</span>
<a href="#l45.4"></a><span id="l45.4"> </span>
<a href="#l45.5"></a><span id="l45.5"> function endTest()</span>
<a href="#l45.6"></a><span id="l45.6"> {</span>
<a href="#l45.7"></a><span id="l45.7">   // Cleanup, null out everything</span>
<a href="#l45.8"></a><span id="l45.8">   gMessages.clear();</span>
<a href="#l45.9"></a><span id="l45.9">   gMsgWindow.closeWindow();</span>
<a href="#l45.10"></a><span id="l45.10">   gMsgWindow = null;</span>
<a href="#l45.11"></a><span id="l45.11">   gLocalInboxFolder = null;</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-  gLocalIncomingServer = null;</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+  localAccountUtils.incomingServer = null;</span>
<a href="#l45.14"></a><span id="l45.14"> </span>
<a href="#l45.15"></a><span id="l45.15">   do_test_finished(); // for the one in run_test()</span>
<a href="#l45.16"></a><span id="l45.16"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mailnews/test/resources/IMAPpump.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mailnews/test/resources/IMAPpump.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -85,17 +85,17 @@ function setupIMAPPump(extensions)</span>
<a href="#l46.4"></a><span id="l46.4">   if (!this.gLocalInboxFolder)</span>
<a href="#l46.5"></a><span id="l46.5">     localAccountUtils.loadLocalMailAccount();</span>
<a href="#l46.6"></a><span id="l46.6"> </span>
<a href="#l46.7"></a><span id="l46.7">   // We need an identity so that updateFolder doesn't fail</span>
<a href="#l46.8"></a><span id="l46.8">   let localAccount = MailServices.accounts.createAccount();</span>
<a href="#l46.9"></a><span id="l46.9">   let identity = MailServices.accounts.createIdentity();</span>
<a href="#l46.10"></a><span id="l46.10">   localAccount.addIdentity(identity);</span>
<a href="#l46.11"></a><span id="l46.11">   localAccount.defaultIdentity = identity;</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-  localAccount.incomingServer = gLocalIncomingServer;</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+  localAccount.incomingServer = localAccountUtils.incomingServer;</span>
<a href="#l46.14"></a><span id="l46.14">   MailServices.accounts.defaultAccount = localAccount;</span>
<a href="#l46.15"></a><span id="l46.15"> </span>
<a href="#l46.16"></a><span id="l46.16">   // Let's also have another account, using the same identity</span>
<a href="#l46.17"></a><span id="l46.17">   let imapAccount = MailServices.accounts.createAccount();</span>
<a href="#l46.18"></a><span id="l46.18">   imapAccount.addIdentity(identity);</span>
<a href="#l46.19"></a><span id="l46.19">   imapAccount.defaultIdentity = identity;</span>
<a href="#l46.20"></a><span id="l46.20">   imapAccount.incomingServer = gIMAPIncomingServer;</span>
<a href="#l46.21"></a><span id="l46.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mailnews/test/resources/localAccountUtils.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mailnews/test/resources/localAccountUtils.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -4,48 +4,50 @@</span>
<a href="#l47.4"></a><span id="l47.4"> </span>
<a href="#l47.5"></a><span id="l47.5"> // Make sure we execute this file exactly once</span>
<a href="#l47.6"></a><span id="l47.6"> var gLocalAccountUtils_js__;</span>
<a href="#l47.7"></a><span id="l47.7"> if (!gLocalAccountUtils_js__) {</span>
<a href="#l47.8"></a><span id="l47.8"> gLocalAccountUtils_js__ = true;</span>
<a href="#l47.9"></a><span id="l47.9"> </span>
<a href="#l47.10"></a><span id="l47.10"> // Local Mail Folders. Requires prior setup of profile directory</span>
<a href="#l47.11"></a><span id="l47.11"> </span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-var gLocalIncomingServer;</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineminus">-var gLocalRootFolder;</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineminus">-var gLocalMsgAccount;</span>
<a href="#l47.15"></a><span id="l47.15"> var gLocalInboxFolder;</span>
<a href="#l47.16"></a><span id="l47.16" class="difflineminus">-var _localAccountInitialized = false;</span>
<a href="#l47.17"></a><span id="l47.17"> </span>
<a href="#l47.18"></a><span id="l47.18"> var localAccountUtils = {</span>
<a href="#l47.19"></a><span id="l47.19" class="difflineplus">+  incomingServer: undefined,</span>
<a href="#l47.20"></a><span id="l47.20" class="difflineplus">+  rootFolder: undefined,</span>
<a href="#l47.21"></a><span id="l47.21" class="difflineplus">+  msgAccount: undefined,</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineplus">+</span>
<a href="#l47.23"></a><span id="l47.23" class="difflineplus">+  _localAccountInitialized: false,</span>
<a href="#l47.24"></a><span id="l47.24" class="difflineplus">+</span>
<a href="#l47.25"></a><span id="l47.25">   loadLocalMailAccount: function() {</span>
<a href="#l47.26"></a><span id="l47.26">     // This function is idempotent</span>
<a href="#l47.27"></a><span id="l47.27" class="difflineminus">-    if (_localAccountInitialized)</span>
<a href="#l47.28"></a><span id="l47.28" class="difflineplus">+    if (this._localAccountInitialized)</span>
<a href="#l47.29"></a><span id="l47.29">       return;</span>
<a href="#l47.30"></a><span id="l47.30"> </span>
<a href="#l47.31"></a><span id="l47.31">     MailServices.accounts.createLocalMailAccount();</span>
<a href="#l47.32"></a><span id="l47.32"> </span>
<a href="#l47.33"></a><span id="l47.33" class="difflineminus">-    gLocalIncomingServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l47.34"></a><span id="l47.34" class="difflineminus">-    gLocalMsgAccount = MailServices.accounts.FindAccountForServer(</span>
<a href="#l47.35"></a><span id="l47.35" class="difflineminus">-      gLocalIncomingServer);</span>
<a href="#l47.36"></a><span id="l47.36" class="difflineplus">+    this.incomingServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l47.37"></a><span id="l47.37" class="difflineplus">+    this.msgAccount = MailServices.accounts.FindAccountForServer(</span>
<a href="#l47.38"></a><span id="l47.38" class="difflineplus">+      this.incomingServer);</span>
<a href="#l47.39"></a><span id="l47.39"> </span>
<a href="#l47.40"></a><span id="l47.40" class="difflineminus">-    gLocalRootFolder = gLocalIncomingServer.rootMsgFolder</span>
<a href="#l47.41"></a><span id="l47.41" class="difflineminus">-                       .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l47.42"></a><span id="l47.42" class="difflineplus">+    this.rootFolder = this.incomingServer.rootMsgFolder</span>
<a href="#l47.43"></a><span id="l47.43" class="difflineplus">+                        .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l47.44"></a><span id="l47.44"> </span>
<a href="#l47.45"></a><span id="l47.45">     // Note: Inbox is not created automatically when there is no deferred server,</span>
<a href="#l47.46"></a><span id="l47.46">     // so we need to create it.</span>
<a href="#l47.47"></a><span id="l47.47" class="difflineminus">-    gLocalInboxFolder = gLocalRootFolder.createLocalSubfolder(&quot;Inbox&quot;)</span>
<a href="#l47.48"></a><span id="l47.48" class="difflineplus">+    gLocalInboxFolder = this.rootFolder.createLocalSubfolder(&quot;Inbox&quot;)</span>
<a href="#l47.49"></a><span id="l47.49">                          .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l47.50"></a><span id="l47.50">     // a local inbox should have a Mail flag!</span>
<a href="#l47.51"></a><span id="l47.51">     gLocalInboxFolder.setFlag(Ci.nsMsgFolderFlags.Mail);</span>
<a href="#l47.52"></a><span id="l47.52"> </span>
<a href="#l47.53"></a><span id="l47.53">     // Force an initialization of the Inbox folder database.</span>
<a href="#l47.54"></a><span id="l47.54">     var folderName = gLocalInboxFolder.prettiestName;</span>
<a href="#l47.55"></a><span id="l47.55"> </span>
<a href="#l47.56"></a><span id="l47.56" class="difflineminus">-    _localAccountInitialized = true;</span>
<a href="#l47.57"></a><span id="l47.57" class="difflineplus">+    this._localAccountInitialized = true;</span>
<a href="#l47.58"></a><span id="l47.58">   },</span>
<a href="#l47.59"></a><span id="l47.59"> </span>
<a href="#l47.60"></a><span id="l47.60">   /**</span>
<a href="#l47.61"></a><span id="l47.61">    * Create an nsIMsgIncomingServer and an nsIMsgAccount to go with it.</span>
<a href="#l47.62"></a><span id="l47.62">    *</span>
<a href="#l47.63"></a><span id="l47.63">    * @param aType The type of the server (pop3, imap etc).</span>
<a href="#l47.64"></a><span id="l47.64">    * @param aPort The port the server is on.</span>
<a href="#l47.65"></a><span id="l47.65">    * @param aUsername The username for the server.</span>
<a href="#l47.66"></a><span id="l47.66" class="difflineat">@@ -65,17 +67,17 @@ var localAccountUtils = {</span>
<a href="#l47.67"></a><span id="l47.67"> </span>
<a href="#l47.68"></a><span id="l47.68">     let account = MailServices.accounts.createAccount();</span>
<a href="#l47.69"></a><span id="l47.69">     account.incomingServer = server;</span>
<a href="#l47.70"></a><span id="l47.70">     if (aType == &quot;pop3&quot;) {</span>
<a href="#l47.71"></a><span id="l47.71">       // Several tests expect that mail is deferred to the local folders account,</span>
<a href="#l47.72"></a><span id="l47.72">       // so do that.</span>
<a href="#l47.73"></a><span id="l47.73">       this.loadLocalMailAccount();</span>
<a href="#l47.74"></a><span id="l47.74">       server.QueryInterface(Ci.nsIPop3IncomingServer);</span>
<a href="#l47.75"></a><span id="l47.75" class="difflineminus">-      server.deferredToAccount = gLocalMsgAccount.key;</span>
<a href="#l47.76"></a><span id="l47.76" class="difflineplus">+      server.deferredToAccount = this.msgAccount.key;</span>
<a href="#l47.77"></a><span id="l47.77">     }</span>
<a href="#l47.78"></a><span id="l47.78">     server.valid = true;</span>
<a href="#l47.79"></a><span id="l47.79"> </span>
<a href="#l47.80"></a><span id="l47.80">     return server;</span>
<a href="#l47.81"></a><span id="l47.81">   },</span>
<a href="#l47.82"></a><span id="l47.82"> </span>
<a href="#l47.83"></a><span id="l47.83">   /**</span>
<a href="#l47.84"></a><span id="l47.84">    * Create an outgoing nsISmtpServer with the given parameters.</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

