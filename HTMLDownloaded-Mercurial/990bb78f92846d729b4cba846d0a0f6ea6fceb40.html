<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 18416:990bb78f92846d729b4cba846d0a0f6ea6fceb40</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 990bb78f92846d729b4cba846d0a0f6ea6fceb40" />
<meta property="og:url" content="/comm-central/rev/990bb78f92846d729b4cba846d0a0f6ea6fceb40" />
<meta property="og:description" content="Bug 1198412 - Use Array.includes in calendar. r=Fallen" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 990bb78f92846d729b4cba846d0a0f6ea6fceb40 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/990bb78f92846d729b4cba846d0a0f6ea6fceb40">shortlog</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/990bb78f92846d729b4cba846d0a0f6ea6fceb40">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40">files</a> |
changeset |
<a href="/comm-central/raw-rev/990bb78f92846d729b4cba846d0a0f6ea6fceb40">raw</a>  | <a href="/comm-central/archive/990bb78f92846d729b4cba846d0a0f6ea6fceb40.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1198412">Bug 1198412</a> - Use Array.includes in calendar. r=Fallen
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#83;&#101;&#98;&#97;&#115;&#116;&#105;&#97;&#110;&#32;&#72;&#101;&#110;&#103;&#115;&#116;&#32;&#60;&#97;&#114;&#99;&#104;&#97;&#101;&#111;&#112;&#116;&#101;&#114;&#121;&#120;&#64;&#99;&#111;&#111;&#108;&#101;&#45;&#102;&#105;&#108;&#101;&#115;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 22 Sep 2015 10:51:50 +0200</td></tr>

<tr>
 <td>changeset 18416</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/990bb78f92846d729b4cba846d0a0f6ea6fceb40">990bb78f92846d729b4cba846d0a0f6ea6fceb40</a></td>
</tr>



<tr>
<td>parent 18415</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5e95881b6b2511415a53c349b65c08513979f582">5e95881b6b2511415a53c349b65c08513979f582</a>
</td>
</tr>

<tr>
<td>child 18417</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e326fb651da9c16bfd64f77c19b72c92d1d4c214">e326fb651da9c16bfd64f77c19b72c92d1d4c214</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=990bb78f92846d729b4cba846d0a0f6ea6fceb40">11278</a></td></tr>
<tr><td>push user</td><td>archaeopteryx@coole-files.de</td></tr>
<tr><td>push date</td><td class="date age">Tue, 22 Sep 2015 09:21:25 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@e326fb651da9 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=e326fb651da9c16bfd64f77c19b72c92d1d4c214">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=e326fb651da9c16bfd64f77c19b72c92d1d4c214&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=e326fb651da9c16bfd64f77c19b72c92d1d4c214&newProject=comm-central&newRevision=990bb78f92846d729b4cba846d0a0f6ea6fceb40&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=e326fb651da9c16bfd64f77c19b72c92d1d4c214&newProject=comm-central&newRevision=990bb78f92846d729b4cba846d0a0f6ea6fceb40&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=e326fb651da9c16bfd64f77c19b72c92d1d4c214&newProject=comm-central&newRevision=990bb78f92846d729b4cba846d0a0f6ea6fceb40&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Fallen%29&revcount=50">Fallen</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1198412">1198412</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1198412">Bug 1198412</a> - Use Array.includes in calendar. r=Fallen</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-dnd-listener.js">calendar/base/content/calendar-dnd-listener.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-dnd-listener.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-dnd-listener.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-dnd-listener.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-dnd-listener.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-dnd-listener.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-dialog-utils.js">calendar/base/content/dialogs/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog.js">calendar/base/content/dialogs/calendar-event-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/dialogs/calendar-event-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/import-export.js">calendar/base/content/import-export.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/import-export.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/import-export.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/import-export.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/import-export.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/import-export.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/alarms.js">calendar/base/content/preferences/alarms.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/alarms.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/alarms.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/alarms.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/alarms.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/alarms.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/general.js">calendar/base/content/preferences/general.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/general.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/general.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/general.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/general.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/preferences/general.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/widgets/calendar-widgets.xml">calendar/base/content/widgets/calendar-widgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/widgets/calendar-widgets.xml">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/widgets/calendar-widgets.xml">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/widgets/calendar-widgets.xml">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/widgets/calendar-widgets.xml">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/content/widgets/calendar-widgets.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calAlarmUtils.jsm">calendar/base/modules/calAlarmUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calAlarmUtils.jsm">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calAlarmUtils.jsm">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calAlarmUtils.jsm">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calAlarmUtils.jsm">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calAlarmUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calExtract.jsm">calendar/base/modules/calExtract.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calExtract.jsm">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calExtract.jsm">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calExtract.jsm">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calExtract.jsm">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/modules/calExtract.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calApplicationUtils.js">calendar/base/src/calApplicationUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calApplicationUtils.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calApplicationUtils.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calApplicationUtils.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calApplicationUtils.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calApplicationUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calFilter.js">calendar/base/src/calFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calFilter.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calFilter.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calFilter.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calFilter.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calFilter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calTimezoneService.js">calendar/base/src/calTimezoneService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calTimezoneService.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calTimezoneService.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calTimezoneService.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calTimezoneService.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calTimezoneService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/lightning/components/calItipProtocolHandler.js">calendar/lightning/components/calItipProtocolHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/lightning/components/calItipProtocolHandler.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/lightning/components/calItipProtocolHandler.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/lightning/components/calItipProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/lightning/components/calItipProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/lightning/components/calItipProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavRequestHandlers.js">calendar/providers/caldav/calDavRequestHandlers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavRequestHandlers.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavRequestHandlers.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavRequestHandlers.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavRequestHandlers.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/caldav/calDavRequestHandlers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataRequest.jsm">calendar/providers/gdata/modules/gdataRequest.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataRequest.jsm">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataRequest.jsm">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataRequest.jsm">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataRequest.jsm">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataRequest.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataSession.jsm">calendar/providers/gdata/modules/gdataSession.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataSession.jsm">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataSession.jsm">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataSession.jsm">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataSession.jsm">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/gdataSession.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/shim/Loader.jsm">calendar/providers/gdata/modules/shim/Loader.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/shim/Loader.jsm">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/shim/Loader.jsm">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/shim/Loader.jsm">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/shim/Loader.jsm">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/gdata/modules/shim/Loader.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/wcap/calWcapCalendarItems.js">calendar/providers/wcap/calWcapCalendarItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/wcap/calWcapCalendarItems.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/wcap/calWcapCalendarItems.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/wcap/calWcapCalendarItems.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/wcap/calWcapCalendarItems.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/providers/wcap/calWcapCalendarItems.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/eventDialog/testEventDialog.js">calendar/test/mozmill/eventDialog/testEventDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/eventDialog/testEventDialog.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/eventDialog/testEventDialog.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/eventDialog/testEventDialog.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/eventDialog/testEventDialog.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/eventDialog/testEventDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/shared-modules/calendar-utils.js">calendar/test/mozmill/shared-modules/calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/shared-modules/calendar-utils.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/shared-modules/calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/shared-modules/calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/shared-modules/calendar-utils.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/shared-modules/calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/testLocalICS.js">calendar/test/mozmill/testLocalICS.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/testLocalICS.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/testLocalICS.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/testLocalICS.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/testLocalICS.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/mozmill/testLocalICS.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_alarm.js">calendar/test/unit/test_alarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_alarm.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_alarm.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_alarm.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_alarm.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_alarm.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_attendee.js">calendar/test/unit/test_attendee.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_attendee.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_attendee.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_attendee.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_attendee.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_attendee.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_bug668222.js">calendar/test/unit/test_bug668222.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_bug668222.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_bug668222.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_bug668222.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_bug668222.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_bug668222.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_recur.js">calendar/test/unit/test_recur.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_recur.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_recur.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_recur.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_recur.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_recur.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_relation.js">calendar/test/unit/test_relation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_relation.js">file</a> |
<a href="/comm-central/annotate/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_relation.js">annotate</a> |
<a href="/comm-central/diff/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_relation.js">diff</a> |
<a href="/comm-central/comparison/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_relation.js">comparison</a> |
<a href="/comm-central/log/990bb78f92846d729b4cba846d0a0f6ea6fceb40/calendar/test/unit/test_relation.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -615,17 +615,17 @@</span>
<a href="#l1.4"></a><span id="l1.4">       &lt;!-- A preference handler which is called by the preference observer.</span>
<a href="#l1.5"></a><span id="l1.5">            Can be overwritten in derived bindings. --&gt;</span>
<a href="#l1.6"></a><span id="l1.6">       &lt;method name=&quot;handleCommonPreference&quot;&gt;</span>
<a href="#l1.7"></a><span id="l1.7">         &lt;parameter name=&quot;aSubject&quot;/&gt;</span>
<a href="#l1.8"></a><span id="l1.8">         &lt;parameter name=&quot;aTopic&quot;/&gt;</span>
<a href="#l1.9"></a><span id="l1.9">         &lt;parameter name=&quot;aPreference&quot;/&gt;</span>
<a href="#l1.10"></a><span id="l1.10">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l1.11"></a><span id="l1.11">            // refresh view if categories seem to have changed</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-           if (aPreference.indexOf(&quot;calendar.category.color&quot;) == 0) {</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+           if (aPreference.startsWith(&quot;calendar.category.color&quot;)) {</span>
<a href="#l1.14"></a><span id="l1.14">                this.refreshView();</span>
<a href="#l1.15"></a><span id="l1.15">                return;</span>
<a href="#l1.16"></a><span id="l1.16">            }</span>
<a href="#l1.17"></a><span id="l1.17">            switch (aPreference) {</span>
<a href="#l1.18"></a><span id="l1.18">                case &quot;calendar.week.d0sundaysoff&quot;:</span>
<a href="#l1.19"></a><span id="l1.19">                case &quot;calendar.week.d1mondaysoff&quot;:</span>
<a href="#l1.20"></a><span id="l1.20">                case &quot;calendar.week.d2tuesdaysoff&quot;:</span>
<a href="#l1.21"></a><span id="l1.21">                case &quot;calendar.week.d3wednesdaysoff&quot;:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-dnd-listener.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-dnd-listener.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -228,17 +228,17 @@ calDNDBaseObserver.prototype = {</span>
<a href="#l2.4"></a><span id="l2.4">         try {</span>
<a href="#l2.5"></a><span id="l2.5">             data = data.value.QueryInterface(Components.interfaces.nsISupportsString);</span>
<a href="#l2.6"></a><span id="l2.6">         } catch (exc) {</span>
<a href="#l2.7"></a><span id="l2.7">             // we currently only supports strings:</span>
<a href="#l2.8"></a><span id="l2.8">             return;</span>
<a href="#l2.9"></a><span id="l2.9">         }</span>
<a href="#l2.10"></a><span id="l2.10"> </span>
<a href="#l2.11"></a><span id="l2.11">         // Treat unicode data with VEVENT in it as text/calendar</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        if (bestFlavor.value == &quot;text/unicode&quot; &amp;&amp; data.toString().indexOf(&quot;VEVENT&quot;) != -1) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        if (bestFlavor.value == &quot;text/unicode&quot; &amp;&amp; data.toString().includes(&quot;VEVENT&quot;)) {</span>
<a href="#l2.14"></a><span id="l2.14">             bestFlavor.value = &quot;text/calendar&quot;;</span>
<a href="#l2.15"></a><span id="l2.15">         }</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17">         var destCal = getSelectedCalendar();</span>
<a href="#l2.18"></a><span id="l2.18">         switch (bestFlavor.value) {</span>
<a href="#l2.19"></a><span id="l2.19">             case &quot;text/calendar&quot;:</span>
<a href="#l2.20"></a><span id="l2.20"> #ifdef XP_MACOSX</span>
<a href="#l2.21"></a><span id="l2.21">                 // Mac likes to convert all \r to \n, we need to reverse this.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -106,17 +106,17 @@ function setDefaultItemValues(aItem, aCa</span>
<a href="#l3.4"></a><span id="l3.4">         } else {</span>
<a href="#l3.5"></a><span id="l3.5">             let defaultStart = Preferences.get(&quot;calendar.task.defaultstart&quot;, &quot;none&quot;);</span>
<a href="#l3.6"></a><span id="l3.6">             if (Preferences.get(&quot;calendar.alarms.onfortodos&quot;, 0) == 1 &amp;&amp; defaultStart == &quot;none&quot;) {</span>
<a href="#l3.7"></a><span id="l3.7">                 // start date is required if we want to set an alarm</span>
<a href="#l3.8"></a><span id="l3.8">                 defaultStart = &quot;offsetcurrent&quot;;</span>
<a href="#l3.9"></a><span id="l3.9">             }</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">             let units = Preferences.get(&quot;calendar.task.defaultstartoffsetunits&quot;, &quot;minutes&quot;);</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-            if ([&quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;].indexOf(units) &lt; 0) {</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+            if (![&quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;].includes(units)) {</span>
<a href="#l3.14"></a><span id="l3.14">                 units = &quot;minutes&quot;;</span>
<a href="#l3.15"></a><span id="l3.15">             }</span>
<a href="#l3.16"></a><span id="l3.16">             let startOffset = cal.createDuration();</span>
<a href="#l3.17"></a><span id="l3.17">             startOffset[units] = Preferences.get(&quot;calendar.task.defaultstartoffset&quot;, 0);</span>
<a href="#l3.18"></a><span id="l3.18">             let start;</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20">             switch (defaultStart) {</span>
<a href="#l3.21"></a><span id="l3.21">                 case &quot;none&quot;:</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -151,17 +151,17 @@ function setDefaultItemValues(aItem, aCa</span>
<a href="#l3.23"></a><span id="l3.23">         }</span>
<a href="#l3.24"></a><span id="l3.24"> </span>
<a href="#l3.25"></a><span id="l3.25">         if (aEndDate) {</span>
<a href="#l3.26"></a><span id="l3.26">             aItem.dueDate = aEndDate.clone();</span>
<a href="#l3.27"></a><span id="l3.27">         } else {</span>
<a href="#l3.28"></a><span id="l3.28">             let defaultDue = Preferences.get(&quot;calendar.task.defaultdue&quot;, &quot;none&quot;);</span>
<a href="#l3.29"></a><span id="l3.29"> </span>
<a href="#l3.30"></a><span id="l3.30">             let units = Preferences.get(&quot;calendar.task.defaultdueoffsetunits&quot;, &quot;minutes&quot;);</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-            if ([&quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;].indexOf(units) &lt; 0) {</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+            if (![&quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;].includes(units)) {</span>
<a href="#l3.33"></a><span id="l3.33">                 units = &quot;minutes&quot;;</span>
<a href="#l3.34"></a><span id="l3.34">             }</span>
<a href="#l3.35"></a><span id="l3.35">             let dueOffset = cal.createDuration();</span>
<a href="#l3.36"></a><span id="l3.36">             dueOffset[units] = Preferences.get(&quot;calendar.task.defaultdueoffset&quot;, 0);</span>
<a href="#l3.37"></a><span id="l3.37"> </span>
<a href="#l3.38"></a><span id="l3.38">             let start = aItem.entryDate ? aItem.entryDate.clone() : initDate.clone();</span>
<a href="#l3.39"></a><span id="l3.39">             let due;</span>
<a href="#l3.40"></a><span id="l3.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -923,17 +923,17 @@</span>
<a href="#l4.4"></a><span id="l4.4">       &lt;/method&gt;</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">       &lt;method name=&quot;hideDaysOff&quot;&gt;</span>
<a href="#l4.7"></a><span id="l4.7">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.8"></a><span id="l4.8">           var columns = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;monthgridcolumns&quot;).childNodes;</span>
<a href="#l4.9"></a><span id="l4.9">           let headerkids = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;labeldaybox&quot;).childNodes;</span>
<a href="#l4.10"></a><span id="l4.10">           for (var i in columns) {</span>
<a href="#l4.11"></a><span id="l4.11">             var dayForColumn = (Number(i) + this.mWeekStartOffset) % 7;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-            var dayOff = (this.mDaysOffArray.indexOf(dayForColumn) != -1);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+            var dayOff = this.mDaysOffArray.includes(dayForColumn);</span>
<a href="#l4.14"></a><span id="l4.14">             columns[i].collapsed = dayOff &amp;&amp; !this.mDisplayDaysOff;</span>
<a href="#l4.15"></a><span id="l4.15">             headerkids[i].collapsed = dayOff &amp;&amp; !this.mDisplayDaysOff;</span>
<a href="#l4.16"></a><span id="l4.16">           }</span>
<a href="#l4.17"></a><span id="l4.17">         ]]&gt;&lt;/body&gt;</span>
<a href="#l4.18"></a><span id="l4.18">       &lt;/method&gt;</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20">       &lt;method name=&quot;findDayBoxForDate&quot;&gt;</span>
<a href="#l4.21"></a><span id="l4.21">         &lt;parameter name=&quot;aDate&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -3253,17 +3253,17 @@</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5">           let computedDateList = new Array();</span>
<a href="#l5.6"></a><span id="l5.6">           let startDate = this.mStartDate.clone();</span>
<a href="#l5.7"></a><span id="l5.7">           while (startDate.compare(this.mEndDate) &lt;= 0) {</span>
<a href="#l5.8"></a><span id="l5.8">               let workday = startDate.clone();</span>
<a href="#l5.9"></a><span id="l5.9">               workday.makeImmutable();</span>
<a href="#l5.10"></a><span id="l5.10">               if (this.mDisplayDaysOff) {</span>
<a href="#l5.11"></a><span id="l5.11">                   computedDateList.push(workday);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-              } else if (this.mDaysOffArray.indexOf(startDate.weekday) == -1) {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+              } else if (!this.mDaysOffArray.includes(startDate.weekday)) {</span>
<a href="#l5.14"></a><span id="l5.14">                   computedDateList.push(workday);</span>
<a href="#l5.15"></a><span id="l5.15">               }</span>
<a href="#l5.16"></a><span id="l5.16">               startDate.day += 1;</span>
<a href="#l5.17"></a><span id="l5.17">           }</span>
<a href="#l5.18"></a><span id="l5.18">           this.mDateList = computedDateList;</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">           // unselect previous selected event upon switch views, otherwise those</span>
<a href="#l5.21"></a><span id="l5.21">           // events will stay selected forever, if select other events after</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -333,17 +333,17 @@ function saveReminder(item) {</span>
<a href="#l6.4"></a><span id="l6.4">  * first alarm action the calendar supports.</span>
<a href="#l6.5"></a><span id="l6.5">  *</span>
<a href="#l6.6"></a><span id="l6.6">  * @return      The default alarm type.</span>
<a href="#l6.7"></a><span id="l6.7">  */</span>
<a href="#l6.8"></a><span id="l6.8"> function getDefaultAlarmType() {</span>
<a href="#l6.9"></a><span id="l6.9">     let calendar = getCurrentCalendar();</span>
<a href="#l6.10"></a><span id="l6.10">     let alarmCaps = calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) ||</span>
<a href="#l6.11"></a><span id="l6.11">                     [&quot;DISPLAY&quot;];</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    return (alarmCaps.indexOf(&quot;DISPLAY&quot;) &lt; 0 ? alarmCaps[0] : &quot;DISPLAY&quot;);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    return (alarmCaps.includes(&quot;DISPLAY&quot;) ? &quot;DISPLAY&quot; : alarmCaps[0]);</span>
<a href="#l6.14"></a><span id="l6.14"> }</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16"> /**</span>
<a href="#l6.17"></a><span id="l6.17">  * Get the currently selected calendar. For dialogs with a menulist of</span>
<a href="#l6.18"></a><span id="l6.18">  * calendars, this is the currently chosen calendar, otherwise its the fixed</span>
<a href="#l6.19"></a><span id="l6.19">  * calendar from the window's item.</span>
<a href="#l6.20"></a><span id="l6.20">  *</span>
<a href="#l6.21"></a><span id="l6.21">  * @return      The currently selected calendar.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -509,17 +509,17 @@</span>
<a href="#l7.4"></a><span id="l7.4">             }</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6">             let addressLists = mailingList.addressLists;</span>
<a href="#l7.7"></a><span id="l7.7">             for (var i=0;i&lt;addressLists.length;i++) {</span>
<a href="#l7.8"></a><span id="l7.8">               let abCard = addressLists.queryElementAt(i, Components.interfaces.nsIAbCard);</span>
<a href="#l7.9"></a><span id="l7.9">               let thisId = abCard.primaryEmail;</span>
<a href="#l7.10"></a><span id="l7.10">               if (abCard.displayName.length &gt; 0) {</span>
<a href="#l7.11"></a><span id="l7.11">                   let rCn = abCard.displayName;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-                  if (rCn.indexOf(&quot;,&quot;) &gt;= 0) {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+                  if (rCn.includes(&quot;,&quot;)) {</span>
<a href="#l7.14"></a><span id="l7.14">                       rCn = '&quot;' + rCn + '&quot;';</span>
<a href="#l7.15"></a><span id="l7.15">                   }</span>
<a href="#l7.16"></a><span id="l7.16">                   thisId = rCn + &quot; &lt;&quot; + thisId + &quot;&gt;&quot;;</span>
<a href="#l7.17"></a><span id="l7.17">               }</span>
<a href="#l7.18"></a><span id="l7.18">               if (in_list(attendees, thisId)) continue;</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20">               if (abCard.displayName.length &gt; 0) {</span>
<a href="#l7.21"></a><span id="l7.21">                 let ml = this._findListInAddrBooks(abCard.displayName);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1607,17 +1607,17 @@ function updatePrivacy() {</span>
<a href="#l8.4"></a><span id="l8.4">             for (var i = 0; i &lt; numChilds; i++) {</span>
<a href="#l8.5"></a><span id="l8.5">                 var node = menupopup.childNodes[i];</span>
<a href="#l8.6"></a><span id="l8.6">                 if (node.hasAttribute(&quot;privacy&quot;)) {</span>
<a href="#l8.7"></a><span id="l8.7">                     var currentPrivacyValue = node.getAttribute(&quot;privacy&quot;);</span>
<a href="#l8.8"></a><span id="l8.8">                     // Collapsed state</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10">                     // Hide the toolbar if the value is unsupported or is for a</span>
<a href="#l8.11"></a><span id="l8.11">                     // specific provider and doesn't belong to the current provider.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-                    if (privacyValues.indexOf(currentPrivacyValue) &lt; 0 ||</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+                    if (!privacyValues.includes(currentPrivacyValue) ||</span>
<a href="#l8.14"></a><span id="l8.14">                         (currentProvider &amp;&amp; currentProvider != calendar.type)) {</span>
<a href="#l8.15"></a><span id="l8.15">                         node.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l8.16"></a><span id="l8.16">                     } else {</span>
<a href="#l8.17"></a><span id="l8.17">                         node.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l8.18"></a><span id="l8.18">                     }</span>
<a href="#l8.19"></a><span id="l8.19"> </span>
<a href="#l8.20"></a><span id="l8.20">                     // Checked state</span>
<a href="#l8.21"></a><span id="l8.21">                     if (gPrivacy == currentPrivacyValue) {</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -1636,17 +1636,17 @@ function updatePrivacy() {</span>
<a href="#l8.23"></a><span id="l8.23">             var node = menupopup.childNodes[i];</span>
<a href="#l8.24"></a><span id="l8.24">             var currentProvider = node.getAttribute(&quot;provider&quot;);</span>
<a href="#l8.25"></a><span id="l8.25">             if (node.hasAttribute(&quot;privacy&quot;)) {</span>
<a href="#l8.26"></a><span id="l8.26">                 var currentPrivacyValue = node.getAttribute(&quot;privacy&quot;);</span>
<a href="#l8.27"></a><span id="l8.27">                 // Collapsed state</span>
<a href="#l8.28"></a><span id="l8.28"> </span>
<a href="#l8.29"></a><span id="l8.29">                 // Hide the menu if the value is unsupported or is for a</span>
<a href="#l8.30"></a><span id="l8.30">                 // specific provider and doesn't belong to the current provider.</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-                if (privacyValues.indexOf(currentPrivacyValue) &lt; 0 ||</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+                if (!privacyValues.includes(currentPrivacyValue) ||</span>
<a href="#l8.33"></a><span id="l8.33">                     (currentProvider &amp;&amp; currentProvider != calendar.type)) {</span>
<a href="#l8.34"></a><span id="l8.34">                     node.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l8.35"></a><span id="l8.35">                 } else {</span>
<a href="#l8.36"></a><span id="l8.36">                     node.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l8.37"></a><span id="l8.37">                 }</span>
<a href="#l8.38"></a><span id="l8.38"> </span>
<a href="#l8.39"></a><span id="l8.39">                 // Checked state</span>
<a href="#l8.40"></a><span id="l8.40">                 if (gPrivacy == currentPrivacyValue) {</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineat">@@ -1665,17 +1665,17 @@ function updatePrivacy() {</span>
<a href="#l8.42"></a><span id="l8.42">             var node = privacyPanel.childNodes[i];</span>
<a href="#l8.43"></a><span id="l8.43">             var currentProvider = node.getAttribute(&quot;provider&quot;);</span>
<a href="#l8.44"></a><span id="l8.44">             if (node.hasAttribute(&quot;privacy&quot;)) {</span>
<a href="#l8.45"></a><span id="l8.45">                 var currentPrivacyValue = node.getAttribute(&quot;privacy&quot;);</span>
<a href="#l8.46"></a><span id="l8.46"> </span>
<a href="#l8.47"></a><span id="l8.47">                 // Hide the panel if the value is unsupported or is for a</span>
<a href="#l8.48"></a><span id="l8.48">                 // specific provider and doesn't belong to the current provider,</span>
<a href="#l8.49"></a><span id="l8.49">                 // or is not the items privacy value</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-                if (privacyValues.indexOf(currentPrivacyValue) &lt; 0 ||</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+                if (!privacyValues.includes(currentPrivacyValue) ||</span>
<a href="#l8.52"></a><span id="l8.52">                     (currentProvider &amp;&amp; currentProvider != calendar.type) ||</span>
<a href="#l8.53"></a><span id="l8.53">                     gPrivacy != currentPrivacyValue) {</span>
<a href="#l8.54"></a><span id="l8.54">                     node.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l8.55"></a><span id="l8.55">                 } else {</span>
<a href="#l8.56"></a><span id="l8.56">                     node.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l8.57"></a><span id="l8.57">                     hasAnyPrivacyValue = true;</span>
<a href="#l8.58"></a><span id="l8.58">                 }</span>
<a href="#l8.59"></a><span id="l8.59">             }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/import-export.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/import-export.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -274,17 +274,17 @@ function saveEventsToFile(calendarEventA</span>
<a href="#l9.4"></a><span id="l9.4">             // For some reason the wrong filter was selected, assume default extension</span>
<a href="#l9.5"></a><span id="l9.5">             filterIndex = defaultCIDIndex;</span>
<a href="#l9.6"></a><span id="l9.6">         }</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">         let exporter = Components.classes[contractids[filterIndex]]</span>
<a href="#l9.9"></a><span id="l9.9">                                  .getService(Components.interfaces.calIExporter);</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">         let filePath = fp.file.path;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-        if (filePath.indexOf(&quot;.&quot;) == -1) {</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+        if (!filePath.includes(&quot;.&quot;)) {</span>
<a href="#l9.14"></a><span id="l9.14">             filePath += &quot;.&quot;+exporter.getFileTypes({})[0].defaultExtension;</span>
<a href="#l9.15"></a><span id="l9.15">         }</span>
<a href="#l9.16"></a><span id="l9.16"> </span>
<a href="#l9.17"></a><span id="l9.17">         const nsILocalFile = Components.interfaces.nsILocalFile;</span>
<a href="#l9.18"></a><span id="l9.18">         const nsIFileOutputStream = Components.interfaces.nsIFileOutputStream;</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20">         let outputStream;</span>
<a href="#l9.21"></a><span id="l9.21">         let localFileInstance = Components.classes[&quot;@mozilla.org/file/local;1&quot;]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/preferences/alarms.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/preferences/alarms.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -44,17 +44,17 @@ var gAlarmsPane = {</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5">     /**</span>
<a href="#l10.6"></a><span id="l10.6">      * Handler function to be called when the calendar.alarms.soundURL pref has</span>
<a href="#l10.7"></a><span id="l10.7">      * changed. Updates the label in the dialog.</span>
<a href="#l10.8"></a><span id="l10.8">      */</span>
<a href="#l10.9"></a><span id="l10.9">     readSoundLocation: function gAP_readSoundLocation() {</span>
<a href="#l10.10"></a><span id="l10.10">         var soundUrl = document.getElementById(&quot;alarmSoundFileField&quot;);</span>
<a href="#l10.11"></a><span id="l10.11">         soundUrl.value = document.getElementById(&quot;calendar.alarms.soundURL&quot;).value;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-        if (soundUrl.value.indexOf(&quot;file://&quot;) == 0) {</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+        if (soundUrl.value.startsWith(&quot;file://&quot;)) {</span>
<a href="#l10.14"></a><span id="l10.14">             soundUrl.label = this.convertURLToLocalFile(soundUrl.value).leafName;</span>
<a href="#l10.15"></a><span id="l10.15">         } else {</span>
<a href="#l10.16"></a><span id="l10.16">             soundUrl.label = soundUrl.value;</span>
<a href="#l10.17"></a><span id="l10.17">         }</span>
<a href="#l10.18"></a><span id="l10.18">         soundUrl.image = &quot;moz-icon://&quot; + soundUrl.label + &quot;?size=16&quot;;</span>
<a href="#l10.19"></a><span id="l10.19">         return undefined;</span>
<a href="#l10.20"></a><span id="l10.20">     },</span>
<a href="#l10.21"></a><span id="l10.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/preferences/general.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/preferences/general.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -65,19 +65,19 @@ var gCalendarGeneralPane = {</span>
<a href="#l11.4"></a><span id="l11.4">     },</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6">     updateDefaultTodoDates: function gCGP_updateDefaultTodoDates() {</span>
<a href="#l11.7"></a><span id="l11.7">         let defaultDue = document.getElementById(&quot;default_task_due&quot;).value;</span>
<a href="#l11.8"></a><span id="l11.8">         let defaultStart = document.getElementById(&quot;default_task_start&quot;).value;</span>
<a href="#l11.9"></a><span id="l11.9">         let offsetValues = [&quot;offsetcurrent&quot;, &quot;offsetnexthour&quot;];</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11">         document.getElementById(&quot;default_task_due_offset&quot;)</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-                .style.visibility = offsetValues.indexOf(defaultDue) &gt; -1 ? &quot;&quot; : &quot;hidden&quot;;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+                .style.visibility = offsetValues.includes(defaultDue) ? &quot;&quot; : &quot;hidden&quot;;</span>
<a href="#l11.14"></a><span id="l11.14">         document.getElementById(&quot;default_task_start_offset&quot;)</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-                .style.visibility = offsetValues.indexOf(defaultStart) &gt; -1 ? &quot;&quot; : &quot;hidden&quot;;</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+                .style.visibility = offsetValues.includes(defaultStart) ? &quot;&quot; : &quot;hidden&quot;;</span>
<a href="#l11.17"></a><span id="l11.17"> </span>
<a href="#l11.18"></a><span id="l11.18">         updateMenuLabelsPlural(&quot;default_task_start_offset_text&quot;, &quot;default_task_start_offset_units&quot;);</span>
<a href="#l11.19"></a><span id="l11.19">         updateMenuLabelsPlural(&quot;default_task_due_offset_text&quot;, &quot;default_task_due_offset_units&quot;);</span>
<a href="#l11.20"></a><span id="l11.20">     },</span>
<a href="#l11.21"></a><span id="l11.21"> </span>
<a href="#l11.22"></a><span id="l11.22">     updateItemtypeDeck: function() {</span>
<a href="#l11.23"></a><span id="l11.23">         let panelId = document.getElementById(&quot;defaults-itemtype-menulist&quot;).value;</span>
<a href="#l11.24"></a><span id="l11.24">         let panel = document.getElementById(panelId);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-widgets.xml</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-widgets.xml</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -337,18 +337,17 @@</span>
<a href="#l12.4"></a><span id="l12.4">       &lt;method name=&quot;isVisible&quot;&gt;</span>
<a href="#l12.5"></a><span id="l12.5">         &lt;parameter name=&quot;aMode&quot;/&gt;</span>
<a href="#l12.6"></a><span id="l12.6">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l12.7"></a><span id="l12.7">             var lMode = aMode || this.currentMode;</span>
<a href="#l12.8"></a><span id="l12.8">             if (!this.isVisibleInMode(lMode)) {</span>
<a href="#l12.9"></a><span id="l12.9">                 return false;</span>
<a href="#l12.10"></a><span id="l12.10">             }</span>
<a href="#l12.11"></a><span id="l12.11">             var collapsedModes = this.getAttribute(&quot;collapsedinmodes&quot;).split(&quot;,&quot;);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-            var modeIndex = collapsedModes.indexOf(lMode);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-            return (modeIndex == -1);</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+            return (!collapsedModes.includes(lMode));</span>
<a href="#l12.15"></a><span id="l12.15">         ]]&gt;&lt;/body&gt;</span>
<a href="#l12.16"></a><span id="l12.16">       &lt;/method&gt;</span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18">       &lt;method name=&quot;setModeAttribute&quot;&gt; </span>
<a href="#l12.19"></a><span id="l12.19">         &lt;parameter name=&quot;aModeAttribute&quot;/&gt;</span>
<a href="#l12.20"></a><span id="l12.20">         &lt;parameter name=&quot;aModeValue&quot;/&gt;</span>
<a href="#l12.21"></a><span id="l12.21">         &lt;parameter name=&quot;amode&quot;/&gt;</span>
<a href="#l12.22"></a><span id="l12.22">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineat">@@ -440,17 +439,17 @@</span>
<a href="#l12.24"></a><span id="l12.24">             var lMode = aMode || this.currentMode;</span>
<a href="#l12.25"></a><span id="l12.25">             var display = true;</span>
<a href="#l12.26"></a><span id="l12.26">             var lModes = new Array();</span>
<a href="#l12.27"></a><span id="l12.27">             if (this.hasAttribute(&quot;mode&quot;)) {</span>
<a href="#l12.28"></a><span id="l12.28">                 var modeString = this.getAttribute(&quot;mode&quot;);</span>
<a href="#l12.29"></a><span id="l12.29">                 lModes = modeString.split(&quot;,&quot;);</span>
<a href="#l12.30"></a><span id="l12.30">             }</span>
<a href="#l12.31"></a><span id="l12.31">             if (lModes &amp;&amp; lModes.length &gt; 0) {</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-                display = lModes.indexOf(lMode) &gt; -1;</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+                display = lModes.includes(lMode);</span>
<a href="#l12.34"></a><span id="l12.34">             }</span>
<a href="#l12.35"></a><span id="l12.35">             return display;</span>
<a href="#l12.36"></a><span id="l12.36">         ]]&gt;&lt;/body&gt;</span>
<a href="#l12.37"></a><span id="l12.37">       &lt;/method&gt;</span>
<a href="#l12.38"></a><span id="l12.38"> </span>
<a href="#l12.39"></a><span id="l12.39">       &lt;method name=&quot;onModeModified&quot;&gt;</span>
<a href="#l12.40"></a><span id="l12.40">         &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l12.41"></a><span id="l12.41">         &lt;parameter name=&quot;aBinding&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/modules/calAlarmUtils.jsm</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/modules/calAlarmUtils.jsm</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -17,17 +17,17 @@ cal.alarms = {</span>
<a href="#l13.4"></a><span id="l13.4">     setDefaultValues: function cal_alarm_setDefaultValues(aItem) {</span>
<a href="#l13.5"></a><span id="l13.5">         let type = cal.isEvent(aItem) ? &quot;event&quot; : &quot;todo&quot;;</span>
<a href="#l13.6"></a><span id="l13.6">         if (Preferences.get(&quot;calendar.alarms.onfor&quot; + type + &quot;s&quot;, 0) == 1) {</span>
<a href="#l13.7"></a><span id="l13.7">             let alarmOffset = cal.createDuration();</span>
<a href="#l13.8"></a><span id="l13.8">             let alarm = cal.createAlarm();</span>
<a href="#l13.9"></a><span id="l13.9">             let units = Preferences.get(&quot;calendar.alarms.&quot; + type + &quot;alarmunit&quot;, &quot;minutes&quot;);</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">             // Make sure the alarm pref is valid, default to minutes otherwise</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-            if ([&quot;weeks&quot;, &quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;, &quot;seconds&quot;].indexOf(units) &lt; 0) {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+            if (![&quot;weeks&quot;, &quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;, &quot;seconds&quot;].includes(units)) {</span>
<a href="#l13.14"></a><span id="l13.14">                 units = &quot;minutes&quot;;</span>
<a href="#l13.15"></a><span id="l13.15">             }</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17">             alarmOffset[units] = Preferences.get(&quot;calendar.alarms.&quot; + type + &quot;alarmlen&quot;, 0);</span>
<a href="#l13.18"></a><span id="l13.18">             alarmOffset.normalize();</span>
<a href="#l13.19"></a><span id="l13.19">             alarmOffset.isNegative = true;</span>
<a href="#l13.20"></a><span id="l13.20">             if (type == &quot;todo&quot; &amp;&amp; !aItem.entryDate) {</span>
<a href="#l13.21"></a><span id="l13.21">                 // You can't have an alarm if the entryDate doesn't exist.</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -37,17 +37,17 @@ cal.alarms = {</span>
<a href="#l13.23"></a><span id="l13.23">             alarm.offset = alarmOffset;</span>
<a href="#l13.24"></a><span id="l13.24"> </span>
<a href="#l13.25"></a><span id="l13.25">             // Default to a display alarm, unless the calendar doesn't support</span>
<a href="#l13.26"></a><span id="l13.26">             // it or we have no calendar yet. (Man this is hard to wrap)</span>
<a href="#l13.27"></a><span id="l13.27">             let actionValues = ((aItem.calendar &amp;&amp;</span>
<a href="#l13.28"></a><span id="l13.28">                                  aItem.calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;)) ||</span>
<a href="#l13.29"></a><span id="l13.29">                                 [&quot;DISPLAY&quot;]);</span>
<a href="#l13.30"></a><span id="l13.30"> </span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-            alarm.action = (actionValues.indexOf(&quot;DISPLAY&quot;) &lt; 0 ? actionValues[0] : &quot;DISPLAY&quot;);</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+            alarm.action = (actionValues.includes(&quot;DISPLAY&quot;) ? &quot;DISPLAY&quot; : actionValues[0]);</span>
<a href="#l13.33"></a><span id="l13.33">             aItem.addAlarm(alarm);</span>
<a href="#l13.34"></a><span id="l13.34">         }</span>
<a href="#l13.35"></a><span id="l13.35">     },</span>
<a href="#l13.36"></a><span id="l13.36"> </span>
<a href="#l13.37"></a><span id="l13.37">     /**</span>
<a href="#l13.38"></a><span id="l13.38">      * Calculate the alarm date for a calIAlarm.</span>
<a href="#l13.39"></a><span id="l13.39">      *</span>
<a href="#l13.40"></a><span id="l13.40">      * @param aItem     The item used to calculate the alarm date.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/modules/calExtract.jsm</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/modules/calExtract.jsm</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -398,17 +398,17 @@ Extractor.prototype = {</span>
<a href="#l14.4"></a><span id="l14.4">             while ((res = re.exec(this.email)) != null) {</span>
<a href="#l14.5"></a><span id="l14.5">                 if (!this.limitNums(res, this.email) &amp;&amp; !this.limitChars(res, this.email)) {</span>
<a href="#l14.6"></a><span id="l14.6">                     let day = parseInt(res[positions[1]], 10);</span>
<a href="#l14.7"></a><span id="l14.7">                     let month = res[positions[2]];</span>
<a href="#l14.8"></a><span id="l14.8">                     let year = parseInt(this.normalizeYear(res[positions[3]]), 10);</span>
<a href="#l14.9"></a><span id="l14.9"> </span>
<a href="#l14.10"></a><span id="l14.10">                     if (this.isValidDay(day)) {</span>
<a href="#l14.11"></a><span id="l14.11">                         for (let i = 0; i &lt; 12; i++) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-                            if (this.months[i].split(&quot;|&quot;).indexOf(month.toLowerCase()) != -1) {</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+                            if (this.months[i].split(&quot;|&quot;).includes(month.toLowerCase())) {</span>
<a href="#l14.14"></a><span id="l14.14">                                 let rev = this.prefixSuffixStartEnd(res, relation, this.email);</span>
<a href="#l14.15"></a><span id="l14.15">                                 this.guess(year, i + 1, day, null, null,</span>
<a href="#l14.16"></a><span id="l14.16">                                            rev.start, rev.end, rev.pattern, rev.relation, pattern);</span>
<a href="#l14.17"></a><span id="l14.17">                                 break;</span>
<a href="#l14.18"></a><span id="l14.18">                             }</span>
<a href="#l14.19"></a><span id="l14.19">                         }</span>
<a href="#l14.20"></a><span id="l14.20">                     }</span>
<a href="#l14.21"></a><span id="l14.21">                 }</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -443,17 +443,17 @@ Extractor.prototype = {</span>
<a href="#l14.23"></a><span id="l14.23">             while ((res = re.exec(this.email)) != null) {</span>
<a href="#l14.24"></a><span id="l14.24">                 if (!this.limitNums(res, this.email) &amp;&amp; !this.limitChars(res, this.email)) {</span>
<a href="#l14.25"></a><span id="l14.25">                     let day = this.parseNumber(res[positions[1]], this.numbers);</span>
<a href="#l14.26"></a><span id="l14.26">                     let month = res[positions[2]];</span>
<a href="#l14.27"></a><span id="l14.27"> </span>
<a href="#l14.28"></a><span id="l14.28">                     if (this.isValidDay(day)) {</span>
<a href="#l14.29"></a><span id="l14.29">                         for (let i = 0; i &lt; 12; i++) {</span>
<a href="#l14.30"></a><span id="l14.30">                             let ms = this.months[i].unescape().split(&quot;|&quot;);</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-                            if (ms.indexOf(month.toLowerCase()) != -1) {</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+                            if (ms.includes(month.toLowerCase())) {</span>
<a href="#l14.33"></a><span id="l14.33">                                 let date = {year: this.now.getFullYear(), month: i + 1, day: day};</span>
<a href="#l14.34"></a><span id="l14.34">                                 if (this.isPastDate(date, this.now)) {</span>
<a href="#l14.35"></a><span id="l14.35">                                     // find next such date</span>
<a href="#l14.36"></a><span id="l14.36">                                     let item = new Date(this.now.getTime());</span>
<a href="#l14.37"></a><span id="l14.37">                                     while (true) {</span>
<a href="#l14.38"></a><span id="l14.38">                                         item.setDate(item.getDate() + 1);</span>
<a href="#l14.39"></a><span id="l14.39">                                         if (item.getMonth() == date.month - 1 &amp;&amp;</span>
<a href="#l14.40"></a><span id="l14.40">                                             item.getDate() == date.day) {</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -1247,17 +1247,17 @@ Extractor.prototype = {</span>
<a href="#l14.42"></a><span id="l14.42">     parseNumber: function parseNumber(number, numbers) {</span>
<a href="#l14.43"></a><span id="l14.43">         let r = parseInt(number, 10);</span>
<a href="#l14.44"></a><span id="l14.44">         // number comes in as plain text, numbers are already adjusted for usage</span>
<a href="#l14.45"></a><span id="l14.45">         // in regular expression</span>
<a href="#l14.46"></a><span id="l14.46">         number = this.cleanPatterns(number);</span>
<a href="#l14.47"></a><span id="l14.47">         if (isNaN(r)) {</span>
<a href="#l14.48"></a><span id="l14.48">             for (let i = 0; i &lt;= 31; i++) {</span>
<a href="#l14.49"></a><span id="l14.49">                 let ns = numbers[i].split(&quot;|&quot;);</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-                if (ns.indexOf(number.toLowerCase()) != -1) {</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+                if (ns.includes(number.toLowerCase())) {</span>
<a href="#l14.52"></a><span id="l14.52">                     return i;</span>
<a href="#l14.53"></a><span id="l14.53">                 }</span>
<a href="#l14.54"></a><span id="l14.54">             }</span>
<a href="#l14.55"></a><span id="l14.55">             return -1;</span>
<a href="#l14.56"></a><span id="l14.56">         } else {</span>
<a href="#l14.57"></a><span id="l14.57">             return r;</span>
<a href="#l14.58"></a><span id="l14.58">         }</span>
<a href="#l14.59"></a><span id="l14.59">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/src/calApplicationUtils.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/src/calApplicationUtils.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -18,17 +18,17 @@ function launchBrowser(url, event)</span>
<a href="#l15.4"></a><span id="l15.4">   if (!url || (event &amp;&amp; event.button != 0)) {</span>
<a href="#l15.5"></a><span id="l15.5">     return;</span>
<a href="#l15.6"></a><span id="l15.6">   }</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8">   // 0. Prevent people from trying to launch URLs such as javascript:foo();</span>
<a href="#l15.9"></a><span id="l15.9">   //    by only allowing URLs starting with http or https.</span>
<a href="#l15.10"></a><span id="l15.10">   // XXX: We likely will want to do this using nsIURLs in the future to</span>
<a href="#l15.11"></a><span id="l15.11">   //      prevent sneaky nasty escaping issues, but this is fine for now.</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  if (url.indexOf(&quot;http&quot;) != 0) {</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  if (!url.startsWith(&quot;http&quot;)) {</span>
<a href="#l15.14"></a><span id="l15.14">     Components.utils.reportError (&quot;launchBrowser: &quot; +</span>
<a href="#l15.15"></a><span id="l15.15">                                   &quot;Invalid URL provided: &quot; + url +</span>
<a href="#l15.16"></a><span id="l15.16">                                   &quot; Only http:// and https:// URLs are valid.&quot;);</span>
<a href="#l15.17"></a><span id="l15.17">     return;</span>
<a href="#l15.18"></a><span id="l15.18">   }</span>
<a href="#l15.19"></a><span id="l15.19"> </span>
<a href="#l15.20"></a><span id="l15.20">   Components.classes[&quot;@mozilla.org/uriloader/external-protocol-service;1&quot;]</span>
<a href="#l15.21"></a><span id="l15.21">             .getService(Components.interfaces.nsIExternalProtocolService)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -145,17 +145,17 @@ calCalendarManager.prototype = {</span>
<a href="#l16.4"></a><span id="l16.4">                 // client is used for access, so add our UA String to each</span>
<a href="#l16.5"></a><span id="l16.5">                 // request.</span>
<a href="#l16.6"></a><span id="l16.6">                 let httpChannel = aSubject.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l16.7"></a><span id="l16.7">                 try {</span>
<a href="#l16.8"></a><span id="l16.8">                     // NOTE: For some reason, this observer call doesn't have</span>
<a href="#l16.9"></a><span id="l16.9">                     // the &quot;cal&quot; namespace defined</span>
<a href="#l16.10"></a><span id="l16.10">                     let ua = httpChannel.getRequestHeader(&quot;User-Agent&quot;);</span>
<a href="#l16.11"></a><span id="l16.11">                     let calUAString = Preferences.get(&quot;calendar.useragent.extra&quot;);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-                    if (calUAString &amp;&amp; ua.indexOf(calUAString) &lt; 0) {</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+                    if (calUAString &amp;&amp; !ua.includes(calUAString)) {</span>
<a href="#l16.14"></a><span id="l16.14">                         // User-Agent is not a mergeable header. We need to</span>
<a href="#l16.15"></a><span id="l16.15">                         // merge the user agent ourselves.</span>
<a href="#l16.16"></a><span id="l16.16">                         httpChannel.setRequestHeader(&quot;User-Agent&quot;,</span>
<a href="#l16.17"></a><span id="l16.17">                                                      ua + &quot; &quot; + calUAString,</span>
<a href="#l16.18"></a><span id="l16.18">                                                      false);</span>
<a href="#l16.19"></a><span id="l16.19">                     }</span>
<a href="#l16.20"></a><span id="l16.20">                 } catch (e if e.result == Components.results.NS_ERROR_NOT_AVAILABLE) {</span>
<a href="#l16.21"></a><span id="l16.21">                     // We swallow this error since it means the User Agent</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/src/calFilter.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/src/calFilter.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -350,25 +350,25 @@ calFilter.prototype = {</span>
<a href="#l17.4"></a><span id="l17.4"> </span>
<a href="#l17.5"></a><span id="l17.5">         let searchText = this.mFilterText.toLowerCase();</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7">         if (!searchText.length || searchText.match(/^\s*$/)) {</span>
<a href="#l17.8"></a><span id="l17.8">             return true;</span>
<a href="#l17.9"></a><span id="l17.9">         }</span>
<a href="#l17.10"></a><span id="l17.10"> </span>
<a href="#l17.11"></a><span id="l17.11">         //XXX TODO: Support specifying which fields to search on</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-        for each (let field in [&quot;SUMMARY&quot;, &quot;DESCRIPTION&quot;, &quot;LOCATION&quot;, &quot;URL&quot;]) {</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+        for (let field of [&quot;SUMMARY&quot;, &quot;DESCRIPTION&quot;, &quot;LOCATION&quot;, &quot;URL&quot;]) {</span>
<a href="#l17.14"></a><span id="l17.14">             let val = aItem.getProperty(field);</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-            if (val &amp;&amp; val.toLowerCase().indexOf(searchText) != -1) {</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+            if (val &amp;&amp; val.toLowerCase().includes(searchText)) {</span>
<a href="#l17.17"></a><span id="l17.17">                 return true;</span>
<a href="#l17.18"></a><span id="l17.18">             }</span>
<a href="#l17.19"></a><span id="l17.19">         }</span>
<a href="#l17.20"></a><span id="l17.20"> </span>
<a href="#l17.21"></a><span id="l17.21">         return aItem.getCategories({}).some(function(cat) {</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineminus">-            return (cat.toLowerCase().indexOf(searchText) != -1);</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+            return cat.toLowerCase().includes(searchText);</span>
<a href="#l17.24"></a><span id="l17.24">         });</span>
<a href="#l17.25"></a><span id="l17.25">     },</span>
<a href="#l17.26"></a><span id="l17.26"> </span>
<a href="#l17.27"></a><span id="l17.27">     /**</span>
<a href="#l17.28"></a><span id="l17.28">      * Checks if the item matches the current filter date range.</span>
<a href="#l17.29"></a><span id="l17.29">      *</span>
<a href="#l17.30"></a><span id="l17.30">      * @param aItem               The item to check.</span>
<a href="#l17.31"></a><span id="l17.31">      * @return                    Returns true if the item falls within the date range</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineat">@@ -416,17 +416,17 @@ calFilter.prototype = {</span>
<a href="#l17.33"></a><span id="l17.33">             let cats = [];</span>
<a href="#l17.34"></a><span id="l17.34"> </span>
<a href="#l17.35"></a><span id="l17.35">             if (typeof(props.category) == &quot;string&quot;) {</span>
<a href="#l17.36"></a><span id="l17.36">                 cats.push(props.category);</span>
<a href="#l17.37"></a><span id="l17.37">             } else if (Array.isArray(props.category)) {</span>
<a href="#l17.38"></a><span id="l17.38">                 cats = props.category;</span>
<a href="#l17.39"></a><span id="l17.39">             }</span>
<a href="#l17.40"></a><span id="l17.40">             result = cats.some(function(cat) {</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineminus">-                return aItem.getCategories({}).indexOf(cat) &gt; -1;</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineplus">+                return aItem.getCategories({}).includes(cat);</span>
<a href="#l17.43"></a><span id="l17.43">             });</span>
<a href="#l17.44"></a><span id="l17.44">         }</span>
<a href="#l17.45"></a><span id="l17.45"> </span>
<a href="#l17.46"></a><span id="l17.46">         // test the status property. Only applies to tasks.</span>
<a href="#l17.47"></a><span id="l17.47">         if (result &amp;&amp; props.status != null &amp;&amp; cal.isToDo(aItem)) {</span>
<a href="#l17.48"></a><span id="l17.48">             let completed = aItem.isCompleted;</span>
<a href="#l17.49"></a><span id="l17.49">             let current = !aItem.completedDate || today.compare(aItem.completedDate) &lt;= 0;</span>
<a href="#l17.50"></a><span id="l17.50">             let percent = aItem.percentComplete || 0;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/src/calTimezoneService.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/src/calTimezoneService.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -179,17 +179,17 @@ calTimezoneService.prototype = {</span>
<a href="#l18.4"></a><span id="l18.4">     },</span>
<a href="#l18.5"></a><span id="l18.5"> </span>
<a href="#l18.6"></a><span id="l18.6">     // calITimezoneProvider:</span>
<a href="#l18.7"></a><span id="l18.7">     getTimezone: function calTimezoneService_getTimezone(tzid) {</span>
<a href="#l18.8"></a><span id="l18.8">         if (!tzid) {</span>
<a href="#l18.9"></a><span id="l18.9">             cal.ERROR(&quot;Unknown timezone requested\n&quot; + cal.STACK(10));</span>
<a href="#l18.10"></a><span id="l18.10">             return null;</span>
<a href="#l18.11"></a><span id="l18.11">         }</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-        if (tzid.indexOf(&quot;/mozilla.org/&quot;) == 0) {</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+        if (tzid.startsWith(&quot;/mozilla.org/&quot;)) {</span>
<a href="#l18.14"></a><span id="l18.14">             // We know that our former tzids look like &quot;/mozilla.org/&lt;dtstamp&gt;/continent/...&quot;</span>
<a href="#l18.15"></a><span id="l18.15">             // The ending of the mozilla prefix is the index of that slash before the</span>
<a href="#l18.16"></a><span id="l18.16">             // continent. Therefore, we start looking for the prefix-ending slash</span>
<a href="#l18.17"></a><span id="l18.17">             // after position 13.</span>
<a href="#l18.18"></a><span id="l18.18">             tzid = tzid.substring(tzid.indexOf(&quot;/&quot;, 13) + 1);</span>
<a href="#l18.19"></a><span id="l18.19">         }</span>
<a href="#l18.20"></a><span id="l18.20"> </span>
<a href="#l18.21"></a><span id="l18.21">         let tz = this.mZones.get(tzid);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -123,17 +123,17 @@ function calendarDefaultTimezone() {</span>
<a href="#l19.4"></a><span id="l19.4">  *</span>
<a href="#l19.5"></a><span id="l19.5">  * @param aTzid     The timezone id to add</span>
<a href="#l19.6"></a><span id="l19.6">  */</span>
<a href="#l19.7"></a><span id="l19.7"> function saveRecentTimezone(aTzid) {</span>
<a href="#l19.8"></a><span id="l19.8">     let recentTimezones = getRecentTimezones();</span>
<a href="#l19.9"></a><span id="l19.9">     const MAX_RECENT_TIMEZONES = 5; // We don't need a pref for *everything*.</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11">     if (aTzid != calendarDefaultTimezone().tzid &amp;&amp;</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-        recentTimezones.indexOf(aTzid) &lt; 0) {</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+        !recentTimezones.includes(aTzid)) {</span>
<a href="#l19.14"></a><span id="l19.14">         // Add the timezone if its not already the default timezone</span>
<a href="#l19.15"></a><span id="l19.15">         recentTimezones.unshift(aTzid);</span>
<a href="#l19.16"></a><span id="l19.16">         recentTimezones.splice(MAX_RECENT_TIMEZONES);</span>
<a href="#l19.17"></a><span id="l19.17">         Preferences.set(&quot;calendar.timezone.recent&quot;, JSON.stringify(recentTimezones));</span>
<a href="#l19.18"></a><span id="l19.18">     }</span>
<a href="#l19.19"></a><span id="l19.19"> }</span>
<a href="#l19.20"></a><span id="l19.20"> </span>
<a href="#l19.21"></a><span id="l19.21"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/lightning/components/calItipProtocolHandler.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/lightning/components/calItipProtocolHandler.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -106,17 +106,17 @@ ItipContentHandler.prototype = {</span>
<a href="#l20.4"></a><span id="l20.4">         contractID: &quot;@mozilla.org/uriloader/content-handler;1?type=&quot; + ITIP_HANDLER_MIMETYPE,</span>
<a href="#l20.5"></a><span id="l20.5">         classDescription: &quot;Lightning text/calendar content handler&quot;,</span>
<a href="#l20.6"></a><span id="l20.6">         interfaces: ItipContentHandlerInterfaces</span>
<a href="#l20.7"></a><span id="l20.7">     }),</span>
<a href="#l20.8"></a><span id="l20.8"> </span>
<a href="#l20.9"></a><span id="l20.9">     handleContent: function (contentType, windowTarget, request) {</span>
<a href="#l20.10"></a><span id="l20.10">         let channel = request.QueryInterface(CI.nsIChannel);</span>
<a href="#l20.11"></a><span id="l20.11">         let uri = channel.URI.spec;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-        if (uri.indexOf(ITIP_HANDLER_PROTOCOL + &quot;:&quot;) != 0) {</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+        if (!uri.startsWith(ITIP_HANDLER_PROTOCOL + &quot;:&quot;)) {</span>
<a href="#l20.14"></a><span id="l20.14">             cal.ERROR(&quot;Unexpected iTIP uri: &quot; + uri + &quot;\n&quot;);</span>
<a href="#l20.15"></a><span id="l20.15">             return Components.results.NS_ERROR_FAILURE;</span>
<a href="#l20.16"></a><span id="l20.16">         }</span>
<a href="#l20.17"></a><span id="l20.17">         // moz-cal-handle-itip:///?</span>
<a href="#l20.18"></a><span id="l20.18">         let paramString = uri.substring(ITIP_HANDLER_PROTOCOL.length + 4);</span>
<a href="#l20.19"></a><span id="l20.19">         let paramArray = paramString.split(&quot;&amp;&quot;);</span>
<a href="#l20.20"></a><span id="l20.20">         let paramBlock = { };</span>
<a href="#l20.21"></a><span id="l20.21">         paramArray.forEach(function (v) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -560,19 +560,19 @@ calDavCalendar.prototype = {</span>
<a href="#l21.4"></a><span id="l21.4">             case &quot;organizerCN&quot;:</span>
<a href="#l21.5"></a><span id="l21.5">                 return null; // xxx todo</span>
<a href="#l21.6"></a><span id="l21.6">             case &quot;itip.transport&quot;:</span>
<a href="#l21.7"></a><span id="l21.7">                 if (this.hasAutoScheduling || this.hasScheduling) {</span>
<a href="#l21.8"></a><span id="l21.8">                     return this.QueryInterface(Components.interfaces.calIItipTransport);</span>
<a href="#l21.9"></a><span id="l21.9">                 } // else use outbound email-based iTIP (from cal.ProviderBase)</span>
<a href="#l21.10"></a><span id="l21.10">                 break;</span>
<a href="#l21.11"></a><span id="l21.11">             case &quot;capabilities.tasks.supported&quot;:</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-                return (this.supportedItemTypes.indexOf(&quot;VTODO&quot;) &gt; -1);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+                return (this.supportedItemTypes.includes(&quot;VTODO&quot;));</span>
<a href="#l21.14"></a><span id="l21.14">             case &quot;capabilities.events.supported&quot;:</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-                return (this.supportedItemTypes.indexOf(&quot;VEVENT&quot;) &gt; -1);</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+                return (this.supportedItemTypes.includes(&quot;VEVENT&quot;));</span>
<a href="#l21.17"></a><span id="l21.17">             case &quot;capabilities.autoschedule.supported&quot;:</span>
<a href="#l21.18"></a><span id="l21.18">                 return this.hasAutoScheduling;</span>
<a href="#l21.19"></a><span id="l21.19">         }</span>
<a href="#l21.20"></a><span id="l21.20">         return this.__proto__.__proto__.getProperty.apply(this, arguments);</span>
<a href="#l21.21"></a><span id="l21.21">     },</span>
<a href="#l21.22"></a><span id="l21.22"> </span>
<a href="#l21.23"></a><span id="l21.23">     promptOverwrite: function caldav_promptOverwrite(aMethod, aItem, aListener, aOldItem) {</span>
<a href="#l21.24"></a><span id="l21.24">         let overwrite = cal.promptOverwrite(aMethod, aItem, aListener, aOldItem);</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineat">@@ -1838,17 +1838,17 @@ calDavCalendar.prototype = {</span>
<a href="#l21.26"></a><span id="l21.26"> </span>
<a href="#l21.27"></a><span id="l21.27">             // Use supported-calendar-component-set if the server supports it; some do not</span>
<a href="#l21.28"></a><span id="l21.28">             // Accept name attribute from all namespaces to workaround Cosmo bug see bug 605378 comment 6</span>
<a href="#l21.29"></a><span id="l21.29">             let supportedComponents = caldavXPath(multistatus,</span>
<a href="#l21.30"></a><span id="l21.30">                 &quot;/D:multistatus/D:response/D:propstat/D:prop/C:supported-calendar-component-set/C:comp/@*[local-name()='name']&quot;);</span>
<a href="#l21.31"></a><span id="l21.31">             if (supportedComponents &amp;&amp; supportedComponents.length) {</span>
<a href="#l21.32"></a><span id="l21.32">                 thisCalendar.mSupportedItemTypes = [ compName</span>
<a href="#l21.33"></a><span id="l21.33">                     for each (compName in supportedComponents)</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineminus">-                    if (thisCalendar.mGenerallySupportedItemTypes.indexOf(compName) &gt;= 0)</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+                    if (thisCalendar.mGenerallySupportedItemTypes.includes(compName))</span>
<a href="#l21.36"></a><span id="l21.36">                 ];</span>
<a href="#l21.37"></a><span id="l21.37">                 cal.LOG(&quot;Adding supported items: &quot; + thisCalendar.mSupportedItemTypes.join(&quot;,&quot;) + &quot; for calendar: &quot; + thisCalendar.name);</span>
<a href="#l21.38"></a><span id="l21.38">             }</span>
<a href="#l21.39"></a><span id="l21.39"> </span>
<a href="#l21.40"></a><span id="l21.40">             // check if owner is specified; might save some work</span>
<a href="#l21.41"></a><span id="l21.41">             let owner = caldavXPathFirst(multistatus, &quot;/D:multistatus/D:response/D:propstat/D:prop/D:owner/D:href/text()&quot;);</span>
<a href="#l21.42"></a><span id="l21.42">             let cuprincipal = caldavXPathFirst(multistatus, &quot;/D:multistatus/D:response/D:propstat/D:prop/D:current-user-principal/D:href/text()&quot;);</span>
<a href="#l21.43"></a><span id="l21.43">             if (cuprincipal) {</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineat">@@ -1963,32 +1963,32 @@ calDavCalendar.prototype = {</span>
<a href="#l21.45"></a><span id="l21.45">             // Google does not yet support OPTIONS but does support scheduling</span>
<a href="#l21.46"></a><span id="l21.46">             // so we'll spoof the DAV header until Google gets fixed</span>
<a href="#l21.47"></a><span id="l21.47">             if (thisCalendar.calendarUri.host == &quot;www.google.com&quot;) {</span>
<a href="#l21.48"></a><span id="l21.48">                 dav = &quot;calendar-schedule&quot;;</span>
<a href="#l21.49"></a><span id="l21.49">                 // Google also reports an inbox URL distinct from the calendar</span>
<a href="#l21.50"></a><span id="l21.50">                 // URL but a) doesn't use it and b) 405s on etag queries to it</span>
<a href="#l21.51"></a><span id="l21.51">                 thisCalendar.mShouldPollInbox = false;</span>
<a href="#l21.52"></a><span id="l21.52">             }</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineminus">-            if (dav &amp;&amp; dav.indexOf(&quot;calendar-auto-schedule&quot;) != -1) {</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineplus">+            if (dav &amp;&amp; dav.includes(&quot;calendar-auto-schedule&quot;)) {</span>
<a href="#l21.55"></a><span id="l21.55">                 if (thisCalendar.verboseLogging()) {</span>
<a href="#l21.56"></a><span id="l21.56">                     cal.LOG(&quot;CalDAV: Calendar &quot; + thisCalendar.name +</span>
<a href="#l21.57"></a><span id="l21.57">                             &quot; supports calendar-auto-schedule&quot;);</span>
<a href="#l21.58"></a><span id="l21.58">                 }</span>
<a href="#l21.59"></a><span id="l21.59">                 thisCalendar.hasAutoScheduling = true;</span>
<a href="#l21.60"></a><span id="l21.60">                 // leave outbound inbox/outbox scheduling off</span>
<a href="#l21.61"></a><span id="l21.61" class="difflineminus">-            } else if (dav &amp;&amp; dav.indexOf(&quot;calendar-schedule&quot;) != -1) {</span>
<a href="#l21.62"></a><span id="l21.62" class="difflineplus">+            } else if (dav &amp;&amp; dav.includes(&quot;calendar-schedule&quot;)) {</span>
<a href="#l21.63"></a><span id="l21.63">                 if (thisCalendar.verboseLogging()) {</span>
<a href="#l21.64"></a><span id="l21.64">                     cal.LOG(&quot;CalDAV: Calendar &quot; + thisCalendar.name +</span>
<a href="#l21.65"></a><span id="l21.65">                             &quot; generally supports calendar-schedule&quot;);</span>
<a href="#l21.66"></a><span id="l21.66">                 }</span>
<a href="#l21.67"></a><span id="l21.67">                 thisCalendar.hasScheduling = true;</span>
<a href="#l21.68"></a><span id="l21.68">             }</span>
<a href="#l21.69"></a><span id="l21.69"> </span>
<a href="#l21.70"></a><span id="l21.70" class="difflineminus">-            if (thisCalendar.hasAutoScheduling || (dav &amp;&amp; dav.indexOf(&quot;calendar-schedule&quot;) != -1)) {</span>
<a href="#l21.71"></a><span id="l21.71" class="difflineplus">+            if (thisCalendar.hasAutoScheduling || (dav &amp;&amp; dav.includes(&quot;calendar-schedule&quot;))) {</span>
<a href="#l21.72"></a><span id="l21.72">                 // XXX - we really shouldn't register with the fb service</span>
<a href="#l21.73"></a><span id="l21.73">                 // if another calendar with the same principal-URL has already</span>
<a href="#l21.74"></a><span id="l21.74">                 // done so. We also shouldn't register with the fb service if we</span>
<a href="#l21.75"></a><span id="l21.75">                 // don't have an outbox.</span>
<a href="#l21.76"></a><span id="l21.76">                 if (!thisCalendar.hasFreeBusy) {</span>
<a href="#l21.77"></a><span id="l21.77">                     // This may have already been set by fetchCachedMetaData,</span>
<a href="#l21.78"></a><span id="l21.78">                     // we only want to add the freebusy provider once.</span>
<a href="#l21.79"></a><span id="l21.79">                     thisCalendar.hasFreeBusy = true;</span>
<a href="#l21.80"></a><span id="l21.80" class="difflineat">@@ -2606,17 +2606,17 @@ calDavCalendar.prototype = {</span>
<a href="#l21.81"></a><span id="l21.81">         }</span>
<a href="#l21.82"></a><span id="l21.82">         return uriComponents.join(&quot;/&quot;);</span>
<a href="#l21.83"></a><span id="l21.83">     },</span>
<a href="#l21.84"></a><span id="l21.84">     isInbox: function caldav_isInbox(aString) {</span>
<a href="#l21.85"></a><span id="l21.85">         // Note: If you change this, make sure it really returns a boolean</span>
<a href="#l21.86"></a><span id="l21.86">         // value and not null!</span>
<a href="#l21.87"></a><span id="l21.87">         return ((this.hasScheduling || this.hasAutoScheduling) &amp;&amp;</span>
<a href="#l21.88"></a><span id="l21.88">                 (this.mInboxUrl != null) &amp;&amp;</span>
<a href="#l21.89"></a><span id="l21.89" class="difflineminus">-                aString.indexOf(this.mInboxUrl.spec) == 0);</span>
<a href="#l21.90"></a><span id="l21.90" class="difflineplus">+                aString.startsWith(this.mInboxUrl.spec));</span>
<a href="#l21.91"></a><span id="l21.91">     },</span>
<a href="#l21.92"></a><span id="l21.92"> </span>
<a href="#l21.93"></a><span id="l21.93">     /**</span>
<a href="#l21.94"></a><span id="l21.94">      * Query contents of scheduling inbox</span>
<a href="#l21.95"></a><span id="l21.95">      *</span>
<a href="#l21.96"></a><span id="l21.96">      */</span>
<a href="#l21.97"></a><span id="l21.97">     pollInbox: function caldav_pollInbox() {</span>
<a href="#l21.98"></a><span id="l21.98">         // If polling the inbox was switched off, no need to poll the inbox.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -540,18 +540,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l22.4"></a><span id="l22.4">             case &quot;sync-response&quot;: // WebDAV Sync draft 0,1,2</span>
<a href="#l22.5"></a><span id="l22.5">                 let r = this.currentResponse;</span>
<a href="#l22.6"></a><span id="l22.6">                 if (r.href &amp;&amp; r.href.length) {</span>
<a href="#l22.7"></a><span id="l22.7">                     r.href = this.calendar.ensureDecodedPath(r.href);</span>
<a href="#l22.8"></a><span id="l22.8">                 }</span>
<a href="#l22.9"></a><span id="l22.9"> </span>
<a href="#l22.10"></a><span id="l22.10">                 if ((!r.getcontenttype || r.getcontenttype == &quot;text/plain&quot;)  &amp;&amp;</span>
<a href="#l22.11"></a><span id="l22.11">                     r.href &amp;&amp;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-                    r.href.length &gt;= 4 &amp;&amp;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-                    r.href.substr(r.href.length - 4,4) == &quot;.ics&quot;) {</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineplus">+                    r.href.endsWith(&quot;.ics&quot;)) {</span>
<a href="#l22.15"></a><span id="l22.15">                   // If there is no content-type (iCloud) or text/plain was passed</span>
<a href="#l22.16"></a><span id="l22.16">                   // (iCal Server) for the resource but its name ends with &quot;.ics&quot;</span>
<a href="#l22.17"></a><span id="l22.17">                   // assume the content type to be text/calendar. Apple</span>
<a href="#l22.18"></a><span id="l22.18">                   // iCloud/iCal Server interoperability fix.</span>
<a href="#l22.19"></a><span id="l22.19">                   r.getcontenttype = &quot;text/calendar&quot;;</span>
<a href="#l22.20"></a><span id="l22.20">                 }</span>
<a href="#l22.21"></a><span id="l22.21"> </span>
<a href="#l22.22"></a><span id="l22.22">                 // Deleted item</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineat">@@ -580,17 +579,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l22.24"></a><span id="l22.24">                     let itemId = this.calendar.mHrefIndex[r.href];</span>
<a href="#l22.25"></a><span id="l22.25">                     let oldEtag = (itemId &amp;&amp; this.calendar.mItemInfoCache[itemId].etag);</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27">                     if (!oldEtag || oldEtag != r.getetag) {</span>
<a href="#l22.28"></a><span id="l22.28">                         // Etag mismatch, getting new/updated item.</span>
<a href="#l22.29"></a><span id="l22.29">                         this.itemsNeedFetching.push(r.href);</span>
<a href="#l22.30"></a><span id="l22.30">                     }</span>
<a href="#l22.31"></a><span id="l22.31">                 } else if (r.status &amp;&amp;</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineminus">-                            r.status.indexOf(&quot; 507&quot;) &gt; -1) {</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineplus">+                           r.status.includes(&quot; 507&quot;)) {</span>
<a href="#l22.34"></a><span id="l22.34">                     // webdav-sync says that if a 507 is encountered and the</span>
<a href="#l22.35"></a><span id="l22.35">                     // url matches the request, the current token should be</span>
<a href="#l22.36"></a><span id="l22.36">                     // saved and another request should be made. We don't</span>
<a href="#l22.37"></a><span id="l22.37">                     // actually compare the URL, its too easy to get this</span>
<a href="#l22.38"></a><span id="l22.38">                     // wrong.</span>
<a href="#l22.39"></a><span id="l22.39"> </span>
<a href="#l22.40"></a><span id="l22.40">                     // The 507 doesn't mean the data received is invalid, so</span>
<a href="#l22.41"></a><span id="l22.41">                     // continue processing.</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineat">@@ -599,19 +598,19 @@ webDavSyncHandler.prototype = {</span>
<a href="#l22.43"></a><span id="l22.43">                            r.status.indexOf(&quot; 200&quot;) &amp;&amp;</span>
<a href="#l22.44"></a><span id="l22.44">                            r.href &amp;&amp;</span>
<a href="#l22.45"></a><span id="l22.45">                            r.href.endsWith(&quot;/&quot;)) {</span>
<a href="#l22.46"></a><span id="l22.46">                     // iCloud returns status responses for directories too</span>
<a href="#l22.47"></a><span id="l22.47">                     // so we just ignore them if they have status code 200. We</span>
<a href="#l22.48"></a><span id="l22.48">                     // want to make sure these are not counted as unhandled</span>
<a href="#l22.49"></a><span id="l22.49">                     // errors in the next block</span>
<a href="#l22.50"></a><span id="l22.50">                 } else if ((r.getcontenttype &amp;&amp;</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-                            r.getcontenttype.substr(0,13) == &quot;text/calendar&quot;) ||</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineplus">+                            r.getcontenttype.startsWith(&quot;text/calendar&quot;) ||</span>
<a href="#l22.53"></a><span id="l22.53">                            (r.status &amp;&amp;</span>
<a href="#l22.54"></a><span id="l22.54" class="difflineminus">-                            r.status.indexOf(&quot; 404&quot;) == -1)) {</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineplus">+                            !r.status.includes(&quot; 404&quot;))) {</span>
<a href="#l22.56"></a><span id="l22.56">                     // If the response element is still not handled, log an</span>
<a href="#l22.57"></a><span id="l22.57">                     // error only if the content-type is text/calendar or the</span>
<a href="#l22.58"></a><span id="l22.58">                     // response status is different than 404 not found.  We</span>
<a href="#l22.59"></a><span id="l22.59">                     // don't care about response elements on non-calendar</span>
<a href="#l22.60"></a><span id="l22.60">                     // resources or whose status is not indicating a deleted</span>
<a href="#l22.61"></a><span id="l22.61">                     // resource.</span>
<a href="#l22.62"></a><span id="l22.62">                     cal.WARN(&quot;CalDAV: Unexpected response, status: &quot; + r.status + &quot;, href: &quot; + r.href);</span>
<a href="#l22.63"></a><span id="l22.63">                     this.unhandledErrors++;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/providers/gdata/modules/gdataRequest.jsm</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/providers/gdata/modules/gdataRequest.jsm</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -125,17 +125,17 @@ calGoogleRequest.prototype = {</span>
<a href="#l23.4"></a><span id="l23.4">      * attribute type</span>
<a href="#l23.5"></a><span id="l23.5">      * The type of this reqest. Must be one of</span>
<a href="#l23.6"></a><span id="l23.6">      * GET, ADD, MODIFY, DELETE</span>
<a href="#l23.7"></a><span id="l23.7">      */</span>
<a href="#l23.8"></a><span id="l23.8">     get type() { return this.method; },</span>
<a href="#l23.9"></a><span id="l23.9"> </span>
<a href="#l23.10"></a><span id="l23.10">     set type(v) {</span>
<a href="#l23.11"></a><span id="l23.11">         let valid = [this.GET, this.ADD, this.MODIFY, this.PATCH, this.DELETE];</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-        if (valid.indexOf(v) &lt; 0) {</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+        if (!valid.includes(v)) {</span>
<a href="#l23.14"></a><span id="l23.14">             throw new Components.Exception(&quot;Invalid request type: &quot; + v,</span>
<a href="#l23.15"></a><span id="l23.15">                                             Components.results.NS_ERROR_ILLEGAL_VALUE);</span>
<a href="#l23.16"></a><span id="l23.16">         }</span>
<a href="#l23.17"></a><span id="l23.17">         return (this.method = v);</span>
<a href="#l23.18"></a><span id="l23.18">     },</span>
<a href="#l23.19"></a><span id="l23.19"> </span>
<a href="#l23.20"></a><span id="l23.20">     /**</span>
<a href="#l23.21"></a><span id="l23.21">      * setUploadData</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/providers/gdata/modules/gdataSession.jsm</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/providers/gdata/modules/gdataSession.jsm</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -401,17 +401,17 @@ calGoogleSession.prototype = {</span>
<a href="#l24.4"></a><span id="l24.4">             cal.LOG(&quot;[calGoogleCalendar] Freebusy query for &quot; + aCalId +</span>
<a href="#l24.5"></a><span id="l24.5">                     &quot; failed (&quot; + aStatus + &quot;): &quot; + aMessage);</span>
<a href="#l24.6"></a><span id="l24.6"> </span>
<a href="#l24.7"></a><span id="l24.7">             // Usually we would notify with a result, but this causes trouble</span>
<a href="#l24.8"></a><span id="l24.8">             // with Lightning 3.9 and older.</span>
<a href="#l24.9"></a><span id="l24.9">             aListener.onResult({ status: aStatus }, null);</span>
<a href="#l24.10"></a><span id="l24.10">         }.bind(this);</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-        if (aCalId.indexOf(&quot;@&quot;) &lt; 0 || aCalId.indexOf(&quot;.&quot;) &lt; 0 ||</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+        if (!aCalId.includes(&quot;@&quot;) || !aCalId.includes(&quot;.&quot;) ||</span>
<a href="#l24.14"></a><span id="l24.14">             !aCalId.toLowerCase().startsWith(&quot;mailto:&quot;)) {</span>
<a href="#l24.15"></a><span id="l24.15">             // No valid email, screw it</span>
<a href="#l24.16"></a><span id="l24.16">             return failSync(Components.results.NS_ERROR_FAILURE, null);</span>
<a href="#l24.17"></a><span id="l24.17">         }</span>
<a href="#l24.18"></a><span id="l24.18"> </span>
<a href="#l24.19"></a><span id="l24.19">         if (aRangeStart) {</span>
<a href="#l24.20"></a><span id="l24.20">             aRangeStart = aRangeStart.getInTimezone(cal.UTC());</span>
<a href="#l24.21"></a><span id="l24.21">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/providers/gdata/modules/shim/Loader.jsm</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/providers/gdata/modules/shim/Loader.jsm</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -79,16 +79,25 @@ function shimIt(global) {</span>
<a href="#l25.4"></a><span id="l25.4">         Object.defineProperty(global.String.prototype, 'includes', {</span>
<a href="#l25.5"></a><span id="l25.5">           enumerable: false,</span>
<a href="#l25.6"></a><span id="l25.6">           configurable: true,</span>
<a href="#l25.7"></a><span id="l25.7">           writable: false,</span>
<a href="#l25.8"></a><span id="l25.8">           value: StringContains</span>
<a href="#l25.9"></a><span id="l25.9">         });</span>
<a href="#l25.10"></a><span id="l25.10">     }</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+    if (!global.Array.prototype.includes) {</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+        Object.defineProperty(global.Array.prototype, 'includes', {</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+          enumerable: false,</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+          configurable: true,</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+          writable: false,</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+          value: ArrayIncludes</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+        });</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+    }</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+</span>
<a href="#l25.21"></a><span id="l25.21">     if (!global.Map) {</span>
<a href="#l25.22"></a><span id="l25.22">         global.Map = Map;</span>
<a href="#l25.23"></a><span id="l25.23">     }</span>
<a href="#l25.24"></a><span id="l25.24">     if (!global.Set) {</span>
<a href="#l25.25"></a><span id="l25.25">         global.Set = Set;</span>
<a href="#l25.26"></a><span id="l25.26">     }</span>
<a href="#l25.27"></a><span id="l25.27"> </span>
<a href="#l25.28"></a><span id="l25.28">     if (typeof global.Map.prototype.forEach !== &quot;function&quot;) {</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineat">@@ -112,16 +121,23 @@ function shimIt(global) {</span>
<a href="#l25.30"></a><span id="l25.30"> /**</span>
<a href="#l25.31"></a><span id="l25.31">  * Implementation for String.prototype.includes/contains.</span>
<a href="#l25.32"></a><span id="l25.32">  */</span>
<a href="#l25.33"></a><span id="l25.33"> function StringContains() {</span>
<a href="#l25.34"></a><span id="l25.34">     return String.prototype.indexOf.apply(this, arguments) !== -1;</span>
<a href="#l25.35"></a><span id="l25.35"> }</span>
<a href="#l25.36"></a><span id="l25.36"> </span>
<a href="#l25.37"></a><span id="l25.37"> /**</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineplus">+ * Implementation for Array.prototype.includes.</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineplus">+ */</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineplus">+function ArrayIncludes() {</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineplus">+    return Array.prototype.indexOf.apply(this, arguments) !== -1;</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineplus">+}</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineplus">+</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+/**</span>
<a href="#l25.45"></a><span id="l25.45">  * forEach implementation for Map and Set, for Thunderbird 24</span>
<a href="#l25.46"></a><span id="l25.46">  */</span>
<a href="#l25.47"></a><span id="l25.47"> function MapSetForEach(cb) {</span>
<a href="#l25.48"></a><span id="l25.48">     let iter = this.entries();</span>
<a href="#l25.49"></a><span id="l25.49">     while (1) {</span>
<a href="#l25.50"></a><span id="l25.50">         let k, v;</span>
<a href="#l25.51"></a><span id="l25.51">         try {</span>
<a href="#l25.52"></a><span id="l25.52">             [k,v] = iter.next();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -661,19 +661,17 @@ calICSCalendar.prototype = {</span>
<a href="#l26.4"></a><span id="l26.4">             dailyBackupFile = null;</span>
<a href="#l26.5"></a><span id="l26.5"> </span>
<a href="#l26.6"></a><span id="l26.6">             return dailyBackupFileName;</span>
<a href="#l26.7"></a><span id="l26.7">         }</span>
<a href="#l26.8"></a><span id="l26.8"> </span>
<a href="#l26.9"></a><span id="l26.9">         function purgeBackupsByType(files, type) {</span>
<a href="#l26.10"></a><span id="l26.10">             // filter out backups of the type we care about.</span>
<a href="#l26.11"></a><span id="l26.11">             var filteredFiles = files.filter(</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-                function f(v) {</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-                    return (v.name.indexOf(&quot;calBackupData_&quot;+pseudoID+&quot;_&quot;+type) != -1)</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineminus">-                });</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+                v =&gt; v.name.includes(&quot;calBackupData_&quot;+pseudoID+&quot;_&quot;+type));</span>
<a href="#l26.16"></a><span id="l26.16">             // Sort by lastmodifed</span>
<a href="#l26.17"></a><span id="l26.17">             filteredFiles.sort(</span>
<a href="#l26.18"></a><span id="l26.18">                 function s(a,b) {</span>
<a href="#l26.19"></a><span id="l26.19">                     return (a.lastmodified - b.lastmodified);</span>
<a href="#l26.20"></a><span id="l26.20">                 });</span>
<a href="#l26.21"></a><span id="l26.21">             // And delete the oldest files, and keep the desired number of</span>
<a href="#l26.22"></a><span id="l26.22">             // old backups</span>
<a href="#l26.23"></a><span id="l26.23">             var i;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -606,17 +606,17 @@ function calWcapCalendar_tunnelXProps(de</span>
<a href="#l27.4"></a><span id="l27.4">     // tunnel alarm X-MOZ-SNOOZE only if alarm is still set:</span>
<a href="#l27.5"></a><span id="l27.5">     // TODO ALARMSUPPORT still needed when showing alarms as EMAIL for wcap?</span>
<a href="#l27.6"></a><span id="l27.6">     let hasAlarms = destItem.getAlarms({}).length;</span>
<a href="#l27.7"></a><span id="l27.7">     let enumerator = srcItem.propertyEnumerator;</span>
<a href="#l27.8"></a><span id="l27.8">     while (enumerator.hasMoreElements()) {</span>
<a href="#l27.9"></a><span id="l27.9">         try {</span>
<a href="#l27.10"></a><span id="l27.10">             var prop = enumerator.getNext().QueryInterface(Components.interfaces.nsIProperty);</span>
<a href="#l27.11"></a><span id="l27.11">             var name = prop.name;</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-            if (name.indexOf(&quot;X-MOZ-&quot;) == 0) {</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+            if (name.startsWith(&quot;X-MOZ-&quot;)) {</span>
<a href="#l27.14"></a><span id="l27.14">                 switch (name) {</span>
<a href="#l27.15"></a><span id="l27.15">                     // keep snooze stamps for occurrences only and if alarm is still set:</span>
<a href="#l27.16"></a><span id="l27.16">                     case &quot;X-MOZ-SNOOZE-TIME&quot;:</span>
<a href="#l27.17"></a><span id="l27.17">                         if (!hasAlarms) {</span>
<a href="#l27.18"></a><span id="l27.18">                             break; // alarm has been reset</span>
<a href="#l27.19"></a><span id="l27.19">                         }</span>
<a href="#l27.20"></a><span id="l27.20">                         // fallthru intended</span>
<a href="#l27.21"></a><span id="l27.21">                     default:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -155,33 +155,33 @@</span>
<a href="#l28.4"></a><span id="l28.4">                return cal.dateTimeToJsDate(today);</span>
<a href="#l28.5"></a><span id="l28.5">              }</span>
<a href="#l28.6"></a><span id="l28.6">              return null;</span>
<a href="#l28.7"></a><span id="l28.7">            }</span>
<a href="#l28.8"></a><span id="l28.8"> </span>
<a href="#l28.9"></a><span id="l28.9">            // Remove commas</span>
<a href="#l28.10"></a><span id="l28.10">            val = val.replace(',', '');</span>
<a href="#l28.11"></a><span id="l28.11"> </span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-           if (val.indexOf(' ') == -1) {</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+           if (!val.includes(' ')) {</span>
<a href="#l28.14"></a><span id="l28.14">              // Just a single word, or a single date.</span>
<a href="#l28.15"></a><span id="l28.15">              return getDateForDay(val);</span>
<a href="#l28.16"></a><span id="l28.16">            }</span>
<a href="#l28.17"></a><span id="l28.17"> </span>
<a href="#l28.18"></a><span id="l28.18">            // Replace month names with numbers</span>
<a href="#l28.19"></a><span id="l28.19">            for (var i in this.mMonthLongNames) {</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineminus">-             if (val.indexOf(this.mMonthLongNames[i]) != -1) {</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineplus">+             if (val.includes(this.mMonthLongNames[i])) {</span>
<a href="#l28.22"></a><span id="l28.22">                var newVal = val.replace(this.mMonthLongNames[i], Number(i)+1);</span>
<a href="#l28.23"></a><span id="l28.23">                newVal = newVal.replace(' ', '/');</span>
<a href="#l28.24"></a><span id="l28.24">                return this.parseDateTime(newVal);</span>
<a href="#l28.25"></a><span id="l28.25">              }</span>
<a href="#l28.26"></a><span id="l28.26">           }</span>
<a href="#l28.27"></a><span id="l28.27"> </span>
<a href="#l28.28"></a><span id="l28.28">           // Same for short month names</span>
<a href="#l28.29"></a><span id="l28.29">            for (var i in this.mMonthShortNames) {</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineminus">-             if (val.indexOf(this.mMonthShortNames[i]) != -1) {</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+             if (val.includes(this.mMonthShortNames[i])) {</span>
<a href="#l28.32"></a><span id="l28.32">                var newVal = val.replace(this.mMonthShortNames[i], Number(i)+1);</span>
<a href="#l28.33"></a><span id="l28.33">                newVal = newVal.replace(' ', '/');</span>
<a href="#l28.34"></a><span id="l28.34">                return this.parseDateTime(newVal);</span>
<a href="#l28.35"></a><span id="l28.35">              }</span>
<a href="#l28.36"></a><span id="l28.36">           }</span>
<a href="#l28.37"></a><span id="l28.37"> </span>
<a href="#l28.38"></a><span id="l28.38">           // Now for the cool 'next' and 'last'</span>
<a href="#l28.39"></a><span id="l28.39">           var words = val.split(' ');</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineat">@@ -1924,17 +1924,17 @@</span>
<a href="#l28.41"></a><span id="l28.41">             // matches the &quot;p&quot; character so only &quot;m&quot; is matched as ampm suffix.)</span>
<a href="#l28.42"></a><span id="l28.42">             //</span>
<a href="#l28.43"></a><span id="l28.43">             // digitsExpr has 6 captures, so index of first ampmExpr is 1, of last is 8.</span>
<a href="#l28.44"></a><span id="l28.44">             this.parseTimeRegExp =</span>
<a href="#l28.45"></a><span id="l28.45">               new RegExp(&quot;(&quot;+ampmExpr+&quot;)?\\s?&quot;+digitsExpr+&quot;(&quot;+ampmExpr+&quot;)?\\s*$&quot;);</span>
<a href="#l28.46"></a><span id="l28.46">             this.amRegExp = new RegExp(&quot;^(?:&quot;+amExpr+&quot;)$&quot;);</span>
<a href="#l28.47"></a><span id="l28.47">             this.pmRegExp = new RegExp(&quot;^(?:&quot;+pmExpr+&quot;)$&quot;);</span>
<a href="#l28.48"></a><span id="l28.48">             // build time display format that mimics &quot;%x&quot; format without seconds</span>
<a href="#l28.49"></a><span id="l28.49" class="difflineminus">-            var ampmSep = (pmProbeString.indexOf(' ') != -1? &quot; &quot; : &quot;&quot;);</span>
<a href="#l28.50"></a><span id="l28.50" class="difflineplus">+            var ampmSep = (pmProbeString.includes(' ') ? &quot; &quot; : &quot;&quot;);</span>
<a href="#l28.51"></a><span id="l28.51"> 	          if (this.ampmIndex == PRE_INDEX)</span>
<a href="#l28.52"></a><span id="l28.52">               this.kTimeFormatString = &quot;%p&quot; + ampmSep + &quot;%I:%M&quot;;</span>
<a href="#l28.53"></a><span id="l28.53">             else if (this.ampmIndex == POST_INDEX)</span>
<a href="#l28.54"></a><span id="l28.54">               this.kTimeFormatString = &quot;%I:%M&quot; + ampmSep + &quot;%p&quot;;</span>
<a href="#l28.55"></a><span id="l28.55">             else</span>
<a href="#l28.56"></a><span id="l28.56">               this.kTimeFormatString = &quot;%H:%M&quot;;</span>
<a href="#l28.57"></a><span id="l28.57">           ]]&gt;</span>
<a href="#l28.58"></a><span id="l28.58">         &lt;/body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -249,15 +249,15 @@ function checkTooltip(monthView, row, co</span>
<a href="#l29.4"></a><span id="l29.4">     + '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[0]/[1]');</span>
<a href="#l29.5"></a><span id="l29.5">   controller.assertJS(eventName.getNode().textContent == title);</span>
<a href="#l29.6"></a><span id="l29.6">   </span>
<a href="#l29.7"></a><span id="l29.7">   // check date and time</span>
<a href="#l29.8"></a><span id="l29.8">   // date-time string contains strings formatted in operating system language so check numeric values only</span>
<a href="#l29.9"></a><span id="l29.9">   let dateTime = new elementslib.Lookup(controller.window.document,</span>
<a href="#l29.10"></a><span id="l29.10">     '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/'</span>
<a href="#l29.11"></a><span id="l29.11">     + '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[2]/[1]').getNode().textContent + '';</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-  controller.assertJS(dateTime.indexOf(date) != -1 &amp;&amp; dateTime.indexOf(startTime) != -1</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-    &amp;&amp; dateTime.indexOf(endTime) != -1);</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineplus">+  controller.assertJS(dateTime.includes(date) &amp;&amp; dateTime.includes(startTime)</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+    &amp;&amp; dateTime.includes(endTime));</span>
<a href="#l29.16"></a><span id="l29.16"> }</span>
<a href="#l29.17"></a><span id="l29.17"> </span>
<a href="#l29.18"></a><span id="l29.18"> var teardownTest = function(module) {</span>
<a href="#l29.19"></a><span id="l29.19">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l29.20"></a><span id="l29.20"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -418,17 +418,17 @@ function setData(controller, data) {</span>
<a href="#l30.4"></a><span id="l30.4">     dialog + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l30.5"></a><span id="l30.5">     + 'id(&quot;completed-date-picker&quot;)/' + dateInput);</span>
<a href="#l30.6"></a><span id="l30.6">   let percentCompleteInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l30.7"></a><span id="l30.7">     + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l30.8"></a><span id="l30.8">     + 'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/'</span>
<a href="#l30.9"></a><span id="l30.9">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l30.10"></a><span id="l30.10">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l30.11"></a><span id="l30.11">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-  let mac = utils.appInfo.os.toLowerCase().indexOf(&quot;darwin&quot;) != -1;</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+  let mac = utils.appInfo.os.toLowerCase().includes(&quot;darwin&quot;);</span>
<a href="#l30.14"></a><span id="l30.14">   // wait for input elements' values to be populated</span>
<a href="#l30.15"></a><span id="l30.15">   controller.sleep(sleep);</span>
<a href="#l30.16"></a><span id="l30.16">   </span>
<a href="#l30.17"></a><span id="l30.17">   // title</span>
<a href="#l30.18"></a><span id="l30.18">   if (data.title != undefined) {</span>
<a href="#l30.19"></a><span id="l30.19">     if (!mac) {</span>
<a href="#l30.20"></a><span id="l30.20">       controller.keypress(new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l30.21"></a><span id="l30.21">         + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -88,17 +88,17 @@ var testLocalICS = function () {</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5">   fstream.init(file, -1, 0, 0);</span>
<a href="#l31.6"></a><span id="l31.6">   cstream.init(fstream, &quot;UTF-8&quot;, 0, 0);</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8">   let str = {};</span>
<a href="#l31.9"></a><span id="l31.9">   cstream.readString(-1, str);</span>
<a href="#l31.10"></a><span id="l31.10">   cstream.close();</span>
<a href="#l31.11"></a><span id="l31.11"> </span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-  controller.assertJS(str.value.indexOf(&quot;SUMMARY:&quot; + title) != -1);</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+  controller.assertJS(str.value.includes(&quot;SUMMARY:&quot; + title));</span>
<a href="#l31.14"></a><span id="l31.14"> }</span>
<a href="#l31.15"></a><span id="l31.15"> </span>
<a href="#l31.16"></a><span id="l31.16"> var teardownTest = function(module) {</span>
<a href="#l31.17"></a><span id="l31.17">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l31.18"></a><span id="l31.18"> }</span>
<a href="#l31.19"></a><span id="l31.19"> </span>
<a href="#l31.20"></a><span id="l31.20"> function handleNewCalendarWizard(wizard) {</span>
<a href="#l31.21"></a><span id="l31.21">   let docEl = wizard.window.document.documentElement;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/test/unit/test_alarm.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/test/unit/test_alarm.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -153,17 +153,17 @@ function test_audio_alarm() {</span>
<a href="#l32.4"></a><span id="l32.4">     let sound2 = cal.createAttachment();</span>
<a href="#l32.5"></a><span id="l32.5">     sound2.uri = makeURL(&quot;file:///sound2.wav&quot;);</span>
<a href="#l32.6"></a><span id="l32.6"> </span>
<a href="#l32.7"></a><span id="l32.7">     // Adding an attachment should work</span>
<a href="#l32.8"></a><span id="l32.8">     alarm.addAttachment(sound);</span>
<a href="#l32.9"></a><span id="l32.9">     let addedAttachments = alarm.getAttachments({});</span>
<a href="#l32.10"></a><span id="l32.10">     equal(addedAttachments.length, 1);</span>
<a href="#l32.11"></a><span id="l32.11">     equal(addedAttachments[0], sound);</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-    ok(alarm.icalString.indexOf(&quot;ATTACH:file:///sound.wav&quot;) &gt; -1);</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+    ok(alarm.icalString.includes(&quot;ATTACH:file:///sound.wav&quot;));</span>
<a href="#l32.14"></a><span id="l32.14"> </span>
<a href="#l32.15"></a><span id="l32.15">     // Adding twice shouldn't change anything</span>
<a href="#l32.16"></a><span id="l32.16">     alarm.addAttachment(sound);</span>
<a href="#l32.17"></a><span id="l32.17">     addedAttachments = alarm.getAttachments({});</span>
<a href="#l32.18"></a><span id="l32.18">     equal(addedAttachments.length, 1);</span>
<a href="#l32.19"></a><span id="l32.19">     equal(addedAttachments[0], sound);</span>
<a href="#l32.20"></a><span id="l32.20"> </span>
<a href="#l32.21"></a><span id="l32.21">     try {</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineat">@@ -305,20 +305,20 @@ function test_xprop() {</span>
<a href="#l32.23"></a><span id="l32.23"> </span>
<a href="#l32.24"></a><span id="l32.24">     // also check X-MOZ-LASTACK prop</span>
<a href="#l32.25"></a><span id="l32.25">     let dt = cal.createDateTime();</span>
<a href="#l32.26"></a><span id="l32.26">     alarm.setProperty(&quot;X-MOZ-LASTACK&quot;, dt.icalString);</span>
<a href="#l32.27"></a><span id="l32.27">     alarm.action = &quot;DISPLAY&quot;;</span>
<a href="#l32.28"></a><span id="l32.28">     alarm.description = &quot;test&quot;;</span>
<a href="#l32.29"></a><span id="l32.29">     alarm.related = Ci.calIAlarm.ALARM_RELATED_START</span>
<a href="#l32.30"></a><span id="l32.30">     alarm.offset = createDuration(&quot;-PT5M&quot;);</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-    ok(alarm.icalComponent.serializeToICS().indexOf(dt.icalString) &gt; -1);</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+    ok(alarm.icalComponent.serializeToICS().includes(dt.icalString));</span>
<a href="#l32.33"></a><span id="l32.33"> </span>
<a href="#l32.34"></a><span id="l32.34">     alarm.deleteProperty(&quot;X-MOZ-LASTACK&quot;);</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineminus">-    ok(!alarm.icalComponent.serializeToICS().indexOf(dt.icalString) &gt; -1);</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineplus">+    ok(!alarm.icalComponent.serializeToICS().includes(dt.icalString));</span>
<a href="#l32.37"></a><span id="l32.37">     dump(&quot;Done\n&quot;);</span>
<a href="#l32.38"></a><span id="l32.38"> }</span>
<a href="#l32.39"></a><span id="l32.39"> </span>
<a href="#l32.40"></a><span id="l32.40"> function test_dates() {</span>
<a href="#l32.41"></a><span id="l32.41">     dump(&quot;Testing alarm dates...&quot;);</span>
<a href="#l32.42"></a><span id="l32.42">     let passed;</span>
<a href="#l32.43"></a><span id="l32.43">     // Initial value</span>
<a href="#l32.44"></a><span id="l32.44">     let alarm = cal.createAlarm();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/test/unit/test_attendee.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/test/unit/test_attendee.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -16,22 +16,22 @@ function test_values() {</span>
<a href="#l33.4"></a><span id="l33.4">         // Getting all attendees</span>
<a href="#l33.5"></a><span id="l33.5">         let allAttendees = event.getAttendees(countObj);</span>
<a href="#l33.6"></a><span id="l33.6">         equal(countObj.value, allAttendees.length);</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8">         equal(allAttendees.length, expectedAttendees.length);</span>
<a href="#l33.9"></a><span id="l33.9"> </span>
<a href="#l33.10"></a><span id="l33.10">         // Check if all expected attendees are found</span>
<a href="#l33.11"></a><span id="l33.11">         for (let i = 0; i &lt; expectedAttendees.length; i++) {</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-            notEqual(allAttendees.indexOf(expectedAttendees[i]), -1);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+            ok(allAttendees.includes(expectedAttendees[i]));</span>
<a href="#l33.14"></a><span id="l33.14">         }</span>
<a href="#l33.15"></a><span id="l33.15"> </span>
<a href="#l33.16"></a><span id="l33.16">         // Check if all found attendees are expected</span>
<a href="#l33.17"></a><span id="l33.17">         for (let i = 0; i &lt; allAttendees.length; i++) {</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineminus">-            notEqual(expectedAttendees.indexOf(allAttendees[i]), -1);</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineplus">+            ok(expectedAttendees.includes(allAttendees[i]));</span>
<a href="#l33.20"></a><span id="l33.20">         }</span>
<a href="#l33.21"></a><span id="l33.21">     }</span>
<a href="#l33.22"></a><span id="l33.22">     function findById(event, id, a) {</span>
<a href="#l33.23"></a><span id="l33.23">         let foundAttendee = event.getAttendeeById(id);</span>
<a href="#l33.24"></a><span id="l33.24">         equal(foundAttendee, a);</span>
<a href="#l33.25"></a><span id="l33.25">     }</span>
<a href="#l33.26"></a><span id="l33.26">     function testImmutability(a, properties) {</span>
<a href="#l33.27"></a><span id="l33.27">          ok(!a.isMutable);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/test/unit/test_bug668222.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/test/unit/test_bug668222.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -13,10 +13,10 @@ function run_test() {</span>
<a href="#l34.4"></a><span id="l34.4">     // Reserialize the property, this has caused the property to go away</span>
<a href="#l34.5"></a><span id="l34.5">     // in the past.</span>
<a href="#l34.6"></a><span id="l34.6">     attendee.icalProperty = attendee.icalProperty;</span>
<a href="#l34.7"></a><span id="l34.7">     equal(attendee.getProperty(&quot;SCHEDULE-AGENT&quot;), &quot;CLIENT&quot;);</span>
<a href="#l34.8"></a><span id="l34.8"> </span>
<a href="#l34.9"></a><span id="l34.9">     // Also make sure there are no promoted properties set. This does not</span>
<a href="#l34.10"></a><span id="l34.10">     // technically belong to this bug, but I almost caused this error while</span>
<a href="#l34.11"></a><span id="l34.11">     // writing the patch.</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-    ok(attendee.icalProperty.icalString.indexOf(&quot;RSVP&quot;) &lt; 0);</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+    ok(!attendee.icalProperty.icalString.includes(&quot;RSVP&quot;));</span>
<a href="#l34.14"></a><span id="l34.14"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/test/unit/test_recur.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/test/unit/test_recur.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -537,23 +537,23 @@ function test_interface() {</span>
<a href="#l35.4"></a><span id="l35.4">                                  Components.interfaces.calIRecurrenceItem));</span>
<a href="#l35.5"></a><span id="l35.5">     ok(compareObjects(ritems[1],</span>
<a href="#l35.6"></a><span id="l35.6">                                  rinfo.getRecurrenceItemAt(2),</span>
<a href="#l35.7"></a><span id="l35.7">                                  Components.interfaces.calIRecurrenceItem));</span>
<a href="#l35.8"></a><span id="l35.8"> </span>
<a href="#l35.9"></a><span id="l35.9"> </span>
<a href="#l35.10"></a><span id="l35.10">     // deleteRecurrenceItem</span>
<a href="#l35.11"></a><span id="l35.11">     rinfo.deleteRecurrenceItem(ritems[0]);</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-    ok(item.icalString.indexOf(&quot;RRULE&quot;) &lt; 0);</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+    ok(!item.icalString.includes(&quot;RRULE&quot;));</span>
<a href="#l35.14"></a><span id="l35.14"> </span>
<a href="#l35.15"></a><span id="l35.15">     // deleteRecurrenceItemAt</span>
<a href="#l35.16"></a><span id="l35.16">     rinfo.deleteRecurrenceItemAt(1);</span>
<a href="#l35.17"></a><span id="l35.17">     itemString = item.icalString;</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineminus">-    ok(itemString.indexOf(&quot;EXDATE&quot;) &lt; 0);</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineminus">-    ok(!(itemString.indexOf(&quot;RDATE&quot;) &lt; 0));</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineplus">+    ok(!itemString.includes(&quot;EXDATE&quot;));</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineplus">+    ok(itemString.includes(&quot;RDATE&quot;));</span>
<a href="#l35.22"></a><span id="l35.22"> </span>
<a href="#l35.23"></a><span id="l35.23">     // insertRecurrenceItemAt with exdate</span>
<a href="#l35.24"></a><span id="l35.24">     rinfo.insertRecurrenceItemAt(ritems[1], 1);</span>
<a href="#l35.25"></a><span id="l35.25">     ok(compareObjects(ritems[1],</span>
<a href="#l35.26"></a><span id="l35.26">                                  rinfo.getRecurrenceItemAt(1),</span>
<a href="#l35.27"></a><span id="l35.27">                                  Components.interfaces.calIRecurrenceItem));</span>
<a href="#l35.28"></a><span id="l35.28">     rinfo.deleteRecurrenceItem(ritems[1]);</span>
<a href="#l35.29"></a><span id="l35.29"> </span>
<a href="#l35.30"></a><span id="l35.30" class="difflineat">@@ -567,19 +567,19 @@ function test_interface() {</span>
<a href="#l35.31"></a><span id="l35.31">                           &quot;DTEND:20020402T124500Z\n&quot; +</span>
<a href="#l35.32"></a><span id="l35.32">                           &quot;RRULE:FREQ=WEEKLY;BYDAY=TU,WE\n&quot;);</span>
<a href="#l35.33"></a><span id="l35.33">     ok(!item2.recurrenceInfo.isFinite);</span>
<a href="#l35.34"></a><span id="l35.34"> </span>
<a href="#l35.35"></a><span id="l35.35">     // removeOccurrenceAt/restoreOccurreceAt</span>
<a href="#l35.36"></a><span id="l35.36">     let occDate1 = cal.createDateTime(&quot;20020403T114500Z&quot;);</span>
<a href="#l35.37"></a><span id="l35.37">     let occDate2 = cal.createDateTime(&quot;20020404T114500Z&quot;);</span>
<a href="#l35.38"></a><span id="l35.38">     rinfo.removeOccurrenceAt(occDate1);</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineminus">-    ok(!(item.icalString.indexOf(&quot;EXDATE&quot;) &lt; 0));</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineplus">+    ok(item.icalString.includes(&quot;EXDATE&quot;));</span>
<a href="#l35.41"></a><span id="l35.41">     rinfo.restoreOccurrenceAt(occDate1)</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineminus">-    ok(item.icalString.indexOf(&quot;EXDATE&quot;) &lt; 0);</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+    ok(!item.icalString.includes(&quot;EXDATE&quot;));</span>
<a href="#l35.44"></a><span id="l35.44"> </span>
<a href="#l35.45"></a><span id="l35.45">     // modifyException / getExceptionFor</span>
<a href="#l35.46"></a><span id="l35.46">     let occ1 = rinfo.getOccurrenceFor(occDate1);</span>
<a href="#l35.47"></a><span id="l35.47">     occ1.startDate = cal.createDateTime(&quot;20020401T114500&quot;);</span>
<a href="#l35.48"></a><span id="l35.48">     rinfo.modifyException(occ1, true);</span>
<a href="#l35.49"></a><span id="l35.49">     ok(rinfo.getExceptionFor(occDate1) != null);</span>
<a href="#l35.50"></a><span id="l35.50"> </span>
<a href="#l35.51"></a><span id="l35.51">     // modifyException immutable</span>
<a href="#l35.52"></a><span id="l35.52" class="difflineat">@@ -838,48 +838,48 @@ function test_rrule_icalstring() {</span>
<a href="#l35.53"></a><span id="l35.53">     recRule.setComponent(&quot;BYMONTHDAY&quot;, 3, [1, 9, 17]);</span>
<a href="#l35.54"></a><span id="l35.54">     equal(recRule.icalString, &quot;RRULE:FREQ=MONTHLY;BYMONTHDAY=1,9,17\r\n&quot;);</span>
<a href="#l35.55"></a><span id="l35.55">     deepEqual(recRule.getComponent(&quot;BYMONTHDAY&quot;, {}), [1, 9, 17]);</span>
<a href="#l35.56"></a><span id="l35.56"> </span>
<a href="#l35.57"></a><span id="l35.57">     var recRule = createRecurrenceRule();</span>
<a href="#l35.58"></a><span id="l35.58">     recRule.type = &quot;YEARLY&quot;;</span>
<a href="#l35.59"></a><span id="l35.59">     recRule.setComponent(&quot;BYMONTH&quot;, 1, [1]);</span>
<a href="#l35.60"></a><span id="l35.60">     recRule.setComponent(&quot;BYMONTHDAY&quot;, 1, [3]);</span>
<a href="#l35.61"></a><span id="l35.61" class="difflineminus">-    notEqual(-1, [</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineplus">+    ok([</span>
<a href="#l35.63"></a><span id="l35.63">         &quot;RRULE:FREQ=YEARLY;BYMONTHDAY=3;BYMONTH=1\r\n&quot;,</span>
<a href="#l35.64"></a><span id="l35.64">         &quot;RRULE:FREQ=YEARLY;BYMONTH=1;BYMONTHDAY=3\r\n&quot;</span>
<a href="#l35.65"></a><span id="l35.65" class="difflineminus">-    ].indexOf(recRule.icalString));</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineplus">+    ].includes(recRule.icalString));</span>
<a href="#l35.67"></a><span id="l35.67">     deepEqual(recRule.getComponent(&quot;BYMONTH&quot;, {}), [1]);</span>
<a href="#l35.68"></a><span id="l35.68">     deepEqual(recRule.getComponent(&quot;BYMONTHDAY&quot;, {}), [3]);</span>
<a href="#l35.69"></a><span id="l35.69"> </span>
<a href="#l35.70"></a><span id="l35.70">     var recRule = createRecurrenceRule();</span>
<a href="#l35.71"></a><span id="l35.71">     recRule.type = &quot;YEARLY&quot;;</span>
<a href="#l35.72"></a><span id="l35.72">     recRule.setComponent(&quot;BYMONTH&quot;, 1, [4]);</span>
<a href="#l35.73"></a><span id="l35.73">     recRule.setComponent(&quot;BYDAY&quot;, 1, [3]);</span>
<a href="#l35.74"></a><span id="l35.74" class="difflineminus">-    notEqual(-1, [</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineplus">+    ok([</span>
<a href="#l35.76"></a><span id="l35.76">         &quot;RRULE:FREQ=YEARLY;BYDAY=TU;BYMONTH=4\r\n&quot;,</span>
<a href="#l35.77"></a><span id="l35.77">         &quot;RRULE:FREQ=YEARLY;BYMONTH=4;BYDAY=TU\r\n&quot;</span>
<a href="#l35.78"></a><span id="l35.78" class="difflineminus">-    ].indexOf(recRule.icalString));</span>
<a href="#l35.79"></a><span id="l35.79" class="difflineplus">+    ].includes(recRule.icalString));</span>
<a href="#l35.80"></a><span id="l35.80">     deepEqual(recRule.getComponent(&quot;BYMONTH&quot;, {}), [4]);</span>
<a href="#l35.81"></a><span id="l35.81">     deepEqual(recRule.getComponent(&quot;BYDAY&quot;, {}), [3]);</span>
<a href="#l35.82"></a><span id="l35.82"> </span>
<a href="#l35.83"></a><span id="l35.83">     var recRule = createRecurrenceRule();</span>
<a href="#l35.84"></a><span id="l35.84">     recRule.type = &quot;YEARLY&quot;;</span>
<a href="#l35.85"></a><span id="l35.85">     recRule.setComponent(&quot;BYMONTH&quot;, 1, [4]);</span>
<a href="#l35.86"></a><span id="l35.86">     recRule.setComponent(&quot;BYDAY&quot;, 1, [10]);</span>
<a href="#l35.87"></a><span id="l35.87" class="difflineminus">-    notEqual(-1, [</span>
<a href="#l35.88"></a><span id="l35.88" class="difflineplus">+    ok([</span>
<a href="#l35.89"></a><span id="l35.89">         &quot;RRULE:FREQ=YEARLY;BYDAY=1MO;BYMONTH=4\r\n&quot;,</span>
<a href="#l35.90"></a><span id="l35.90">         &quot;RRULE:FREQ=YEARLY;BYMONTH=4;BYDAY=1MO\r\n&quot;</span>
<a href="#l35.91"></a><span id="l35.91" class="difflineminus">-    ].indexOf(recRule.icalString));</span>
<a href="#l35.92"></a><span id="l35.92" class="difflineplus">+    ].includes(recRule.icalString));</span>
<a href="#l35.93"></a><span id="l35.93">     deepEqual(recRule.getComponent(&quot;BYMONTH&quot;, {}), [4]);</span>
<a href="#l35.94"></a><span id="l35.94">     deepEqual(recRule.getComponent(&quot;BYDAY&quot;, {}), [10]);</span>
<a href="#l35.95"></a><span id="l35.95"> </span>
<a href="#l35.96"></a><span id="l35.96">     var recRule = createRecurrenceRule();</span>
<a href="#l35.97"></a><span id="l35.97">     recRule.type = &quot;YEARLY&quot;;</span>
<a href="#l35.98"></a><span id="l35.98">     recRule.setComponent(&quot;BYMONTH&quot;, 1, [4]);</span>
<a href="#l35.99"></a><span id="l35.99">     recRule.setComponent(&quot;BYDAY&quot;, 1, [-22]);</span>
<a href="#l35.100"></a><span id="l35.100" class="difflineminus">-    notEqual(-1, [</span>
<a href="#l35.101"></a><span id="l35.101" class="difflineplus">+    ok([</span>
<a href="#l35.102"></a><span id="l35.102">         &quot;RRULE:FREQ=YEARLY;BYDAY=-2FR;BYMONTH=4\r\n&quot;,</span>
<a href="#l35.103"></a><span id="l35.103">         &quot;RRULE:FREQ=YEARLY;BYMONTH=4;BYDAY=-2FR\r\n&quot;</span>
<a href="#l35.104"></a><span id="l35.104" class="difflineminus">-    ].indexOf(recRule.icalString));</span>
<a href="#l35.105"></a><span id="l35.105" class="difflineplus">+    ].includes(recRule.icalString));</span>
<a href="#l35.106"></a><span id="l35.106">     deepEqual(recRule.getComponent(&quot;BYMONTH&quot;, {}), [4]);</span>
<a href="#l35.107"></a><span id="l35.107">     deepEqual(recRule.getComponent(&quot;BYDAY&quot;, {}), [-22]);</span>
<a href="#l35.108"></a><span id="l35.108"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/test/unit/test_relation.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/test/unit/test_relation.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -44,22 +44,22 @@ function run_test() {</span>
<a href="#l36.4"></a><span id="l36.4"> function checkRelations(event, expRel) {</span>
<a href="#l36.5"></a><span id="l36.5">     let countObj = {};</span>
<a href="#l36.6"></a><span id="l36.6">     let allRel = event.getRelations(countObj);</span>
<a href="#l36.7"></a><span id="l36.7">     equal(countObj.value, allRel.length);</span>
<a href="#l36.8"></a><span id="l36.8">     equal(allRel.length, expRel.length);</span>
<a href="#l36.9"></a><span id="l36.9"> </span>
<a href="#l36.10"></a><span id="l36.10">     // check if all expacted relations are found</span>
<a href="#l36.11"></a><span id="l36.11">     for (let i = 0; i &lt; expRel.length; i++) {</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-        notEqual(allRel.indexOf(expRel[i]), -1);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+        ok(allRel.includes(expRel[i]));</span>
<a href="#l36.14"></a><span id="l36.14">     }</span>
<a href="#l36.15"></a><span id="l36.15"> </span>
<a href="#l36.16"></a><span id="l36.16">     // Check if all found relations are expected</span>
<a href="#l36.17"></a><span id="l36.17">     for (let i = 0; i &lt; allRel.length; i++) {</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineminus">-        notEqual(expRel.indexOf(allRel[i]), -1);</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineplus">+        ok(expRel.includes(allRel[i]));</span>
<a href="#l36.20"></a><span id="l36.20">     }</span>
<a href="#l36.21"></a><span id="l36.21"> }</span>
<a href="#l36.22"></a><span id="l36.22"> </span>
<a href="#l36.23"></a><span id="l36.23"> function modifyRelations(event, oldRel) {</span>
<a href="#l36.24"></a><span id="l36.24">     let allRel = event.getRelations({});</span>
<a href="#l36.25"></a><span id="l36.25">     let rel = allRel[0];</span>
<a href="#l36.26"></a><span id="l36.26"> </span>
<a href="#l36.27"></a><span id="l36.27">     // modify the properties</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

