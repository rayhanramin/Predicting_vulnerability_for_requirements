<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 24110:02830077b19bb5359e3e1db40ce5c564be301e1e</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 02830077b19bb5359e3e1db40ce5c564be301e1e" />
<meta property="og:url" content="/comm-central/rev/02830077b19bb5359e3e1db40ce5c564be301e1e" />
<meta property="og:description" content="Bug 1457087 - Replace use of XPCOMUtils.generateQI where possible. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 02830077b19bb5359e3e1db40ce5c564be301e1e 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/02830077b19bb5359e3e1db40ce5c564be301e1e">shortlog</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/02830077b19bb5359e3e1db40ce5c564be301e1e">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e">files</a> |
changeset |
<a href="/comm-central/raw-rev/02830077b19bb5359e3e1db40ce5c564be301e1e">raw</a>  | <a href="/comm-central/archive/02830077b19bb5359e3e1db40ce5c564be301e1e.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1457087">Bug 1457087</a> - Replace use of XPCOMUtils.generateQI where possible. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#104;&#105;&#108;&#105;&#112;&#112;&#32;&#75;&#101;&#119;&#105;&#115;&#99;&#104;&#32;&#60;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 04 May 2018 13:04:24 +0200</td></tr>

<tr>
 <td>changeset 24110</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/02830077b19bb5359e3e1db40ce5c564be301e1e">02830077b19bb5359e3e1db40ce5c564be301e1e</a></td>
</tr>



<tr>
<td>parent 24109</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/6332ffbfd6518278cf3e49b99b6bcd0b87c1ebbb">6332ffbfd6518278cf3e49b99b6bcd0b87c1ebbb</a>
</td>
</tr>

<tr>
<td>child 24111</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1c4c481c3a1dd77aca58b55f2c7b673503c0dc93">1c4c481c3a1dd77aca58b55f2c7b673503c0dc93</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=02830077b19bb5359e3e1db40ce5c564be301e1e">14538</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 19 Jun 2018 09:44:35 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@d783a688319c [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d783a688319c5c24c12a98dfa4a0f8e1defd5373">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d783a688319c5c24c12a98dfa4a0f8e1defd5373&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d783a688319c5c24c12a98dfa4a0f8e1defd5373&newProject=comm-central&newRevision=02830077b19bb5359e3e1db40ce5c564be301e1e&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d783a688319c5c24c12a98dfa4a0f8e1defd5373&newProject=comm-central&newRevision=02830077b19bb5359e3e1db40ce5c564be301e1e&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d783a688319c5c24c12a98dfa4a0f8e1defd5373&newProject=comm-central&newRevision=02830077b19bb5359e3e1db40ce5c564be301e1e&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1457087">1457087</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1457087">Bug 1457087</a> - Replace use of XPCOMUtils.generateQI where possible. r=MakeMyDay

MozReview-Commit-ID: 1kMFGQDeANj</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/calBackendLoader.js">calendar/base/backend/calBackendLoader.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/calBackendLoader.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/calBackendLoader.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/calBackendLoader.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/calBackendLoader.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/calBackendLoader.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDateTime.js">calendar/base/backend/icaljs/calDateTime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDateTime.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDateTime.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDateTime.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDateTime.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDateTime.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDuration.js">calendar/base/backend/icaljs/calDuration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDuration.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDuration.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDuration.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDuration.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calDuration.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calICSService.js">calendar/base/backend/icaljs/calICSService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calICSService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calICSService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calICSService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calICSService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calICSService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calPeriod.js">calendar/base/backend/icaljs/calPeriod.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calPeriod.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calPeriod.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calPeriod.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calPeriod.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calPeriod.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calRecurrenceRule.js">calendar/base/backend/icaljs/calRecurrenceRule.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calRecurrenceRule.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calRecurrenceRule.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calRecurrenceRule.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calRecurrenceRule.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/backend/icaljs/calRecurrenceRule.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/modules/calUtils.jsm">calendar/base/modules/calUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/modules/calUtils.jsm">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/modules/calUtils.jsm">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/modules/calUtils.jsm">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/modules/calUtils.jsm">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/modules/calUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarm.js">calendar/base/src/calAlarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarm.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarm.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarm.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarm.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarm.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmMonitor.js">calendar/base/src/calAlarmMonitor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmMonitor.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmMonitor.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmMonitor.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmMonitor.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmMonitor.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmService.js">calendar/base/src/calAlarmService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAlarmService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttachment.js">calendar/base/src/calAttachment.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttachment.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttachment.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttachment.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttachment.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttachment.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttendee.js">calendar/base/src/calAttendee.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttendee.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttendee.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttendee.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttendee.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calAttendee.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarSearchService.js">calendar/base/src/calCalendarSearchService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarSearchService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarSearchService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarSearchService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarSearchService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calCalendarSearchService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDateTimeFormatter.js">calendar/base/src/calDateTimeFormatter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDateTimeFormatter.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDateTimeFormatter.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDateTimeFormatter.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDateTimeFormatter.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDateTimeFormatter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDefaultACLManager.js">calendar/base/src/calDefaultACLManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDefaultACLManager.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDefaultACLManager.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDefaultACLManager.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDefaultACLManager.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDefaultACLManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDeletedItems.js">calendar/base/src/calDeletedItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDeletedItems.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDeletedItems.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDeletedItems.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDeletedItems.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calDeletedItems.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calEvent.js">calendar/base/src/calEvent.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calEvent.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calEvent.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calEvent.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calEvent.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calEvent.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calFreeBusyService.js">calendar/base/src/calFreeBusyService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calFreeBusyService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calFreeBusyService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calFreeBusyService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calFreeBusyService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calFreeBusyService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsParser.js">calendar/base/src/calIcsParser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsParser.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsParser.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsParser.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsParser.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsParser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsSerializer.js">calendar/base/src/calIcsSerializer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsSerializer.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsSerializer.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsSerializer.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsSerializer.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calIcsSerializer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calItipItem.js">calendar/base/src/calItipItem.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calItipItem.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calItipItem.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calItipItem.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calItipItem.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calItipItem.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calProtocolHandler.js">calendar/base/src/calProtocolHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calProtocolHandler.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calProtocolHandler.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceDate.js">calendar/base/src/calRecurrenceDate.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceDate.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceDate.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceDate.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceDate.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceDate.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceInfo.js">calendar/base/src/calRecurrenceInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceInfo.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceInfo.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceInfo.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceInfo.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRecurrenceInfo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRelation.js">calendar/base/src/calRelation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRelation.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRelation.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRelation.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRelation.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calRelation.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calSleepMonitor.js">calendar/base/src/calSleepMonitor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calSleepMonitor.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calSleepMonitor.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calSleepMonitor.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calSleepMonitor.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calSleepMonitor.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calStartupService.js">calendar/base/src/calStartupService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calStartupService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calStartupService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calStartupService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calStartupService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calStartupService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezone.js">calendar/base/src/calTimezone.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezone.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezone.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezone.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezone.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezone.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezoneService.js">calendar/base/src/calTimezoneService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezoneService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezoneService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezoneService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezoneService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTimezoneService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTodo.js">calendar/base/src/calTodo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTodo.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTodo.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTodo.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTodo.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTodo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTransactionManager.js">calendar/base/src/calTransactionManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTransactionManager.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTransactionManager.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTransactionManager.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTransactionManager.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calTransactionManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calWeekInfoService.js">calendar/base/src/calWeekInfoService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calWeekInfoService.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calWeekInfoService.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calWeekInfoService.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calWeekInfoService.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/base/src/calWeekInfoService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calHtmlExport.js">calendar/import-export/calHtmlExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calHtmlExport.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calHtmlExport.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calHtmlExport.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calHtmlExport.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calHtmlExport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calIcsImportExport.js">calendar/import-export/calIcsImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calIcsImportExport.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calIcsImportExport.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calIcsImportExport.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calIcsImportExport.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calIcsImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calListFormatter.js">calendar/import-export/calListFormatter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calListFormatter.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calListFormatter.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calListFormatter.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calListFormatter.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calListFormatter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calMonthGridPrinter.js">calendar/import-export/calMonthGridPrinter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calMonthGridPrinter.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calMonthGridPrinter.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calMonthGridPrinter.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calMonthGridPrinter.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calMonthGridPrinter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calOutlookCSVImportExport.js">calendar/import-export/calOutlookCSVImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calOutlookCSVImportExport.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calOutlookCSVImportExport.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calOutlookCSVImportExport.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calOutlookCSVImportExport.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calOutlookCSVImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calWeekPrinter.js">calendar/import-export/calWeekPrinter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calWeekPrinter.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calWeekPrinter.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calWeekPrinter.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calWeekPrinter.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/import-export/calWeekPrinter.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/itip/calItipEmailTransport.js">calendar/itip/calItipEmailTransport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/itip/calItipEmailTransport.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/itip/calItipEmailTransport.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/itip/calItipEmailTransport.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/itip/calItipEmailTransport.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/itip/calItipEmailTransport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/calItipProtocolHandler.js">calendar/lightning/components/calItipProtocolHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/calItipProtocolHandler.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/calItipProtocolHandler.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/calItipProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/calItipProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/calItipProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/lightningTextCalendarConverter.js">calendar/lightning/components/lightningTextCalendarConverter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/lightningTextCalendarConverter.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/lightningTextCalendarConverter.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/lightningTextCalendarConverter.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/lightningTextCalendarConverter.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/lightning/components/lightningTextCalendarConverter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/composite/calCompositeCalendar.js">calendar/providers/composite/calCompositeCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/composite/calCompositeCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/composite/calCompositeCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/composite/calCompositeCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/composite/calCompositeCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/composite/calCompositeCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/components/calGoogleCalendar.js">calendar/providers/gdata/components/calGoogleCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/components/calGoogleCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/components/calGoogleCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/components/calGoogleCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/components/calGoogleCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/components/calGoogleCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/modules/calUtilsShim.jsm">calendar/providers/gdata/modules/calUtilsShim.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/modules/calUtilsShim.jsm">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/modules/calUtilsShim.jsm">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/modules/calUtilsShim.jsm">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/modules/calUtilsShim.jsm">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/gdata/modules/calUtilsShim.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/memory/calMemoryCalendar.js">calendar/providers/memory/calMemoryCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/memory/calMemoryCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/memory/calMemoryCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/memory/calMemoryCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/memory/calMemoryCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/memory/calMemoryCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapCalendar.js">calendar/providers/wcap/calWcapCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapCalendar.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapCalendar.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapCalendar.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapCalendar.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapRequest.js">calendar/providers/wcap/calWcapRequest.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapRequest.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapRequest.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapRequest.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapRequest.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapRequest.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapSession.js">calendar/providers/wcap/calWcapSession.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapSession.js">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapSession.js">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapSession.js">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapSession.js">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/calendar/providers/wcap/calWcapSession.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/mail/config/mozconfigs/common">mail/config/mozconfigs/common</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/02830077b19bb5359e3e1db40ce5c564be301e1e/mail/config/mozconfigs/common">file</a> |
<a href="/comm-central/annotate/02830077b19bb5359e3e1db40ce5c564be301e1e/mail/config/mozconfigs/common">annotate</a> |
<a href="/comm-central/diff/02830077b19bb5359e3e1db40ce5c564be301e1e/mail/config/mozconfigs/common">diff</a> |
<a href="/comm-central/comparison/02830077b19bb5359e3e1db40ce5c564be301e1e/mail/config/mozconfigs/common">comparison</a> |
<a href="/comm-central/log/02830077b19bb5359e3e1db40ce5c564be301e1e/mail/config/mozconfigs/common">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/backend/calBackendLoader.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/backend/calBackendLoader.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -10,28 +10,19 @@ function calBackendLoader() {</span>
<a href="#l1.4"></a><span id="l1.4">     this.wrappedJSObject = this;</span>
<a href="#l1.5"></a><span id="l1.5">     try {</span>
<a href="#l1.6"></a><span id="l1.6">         this.loadBackend();</span>
<a href="#l1.7"></a><span id="l1.7">     } catch (e) {</span>
<a href="#l1.8"></a><span id="l1.8">         dump(`### Error loading backend:${e.filename || e.fileName}:${e.lineNumber}: ${e}\n`);</span>
<a href="#l1.9"></a><span id="l1.9">     }</span>
<a href="#l1.10"></a><span id="l1.10"> }</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-var calBackendLoaderClassID = Components.ID(&quot;{0314c271-7168-40fa-802e-83c8c46a557e}&quot;);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-var calBackendLoaderInterfaces = [Components.interfaces.nsIObserver];</span>
<a href="#l1.14"></a><span id="l1.14"> calBackendLoader.prototype = {</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-    classID: calBackendLoaderClassID,</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calBackendLoaderInterfaces),</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-        classID: calBackendLoaderClassID,</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/backend-loader;1&quot;,</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-        classDescription: &quot;Calendar Backend Loader&quot;,</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-        interfaces: calBackendLoaderInterfaces,</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineminus">-    }),</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+    classID: Components.ID(&quot;{0314c271-7168-40fa-802e-83c8c46a557e}&quot;),</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIObserver]),</span>
<a href="#l1.26"></a><span id="l1.26"> </span>
<a href="#l1.27"></a><span id="l1.27">     loaded: false,</span>
<a href="#l1.28"></a><span id="l1.28"> </span>
<a href="#l1.29"></a><span id="l1.29">     observe: function() {</span>
<a href="#l1.30"></a><span id="l1.30">         // Nothing to do here, just need the entry so this is instanciated</span>
<a href="#l1.31"></a><span id="l1.31">     },</span>
<a href="#l1.32"></a><span id="l1.32"> </span>
<a href="#l1.33"></a><span id="l1.33">     loadBackend: function() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calDateTime.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calDateTime.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,34 +1,25 @@</span>
<a href="#l2.4"></a><span id="l2.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.5"></a><span id="l2.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.6"></a><span id="l2.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8"> ChromeUtils.import(&quot;resource://calendar/modules/ical.js&quot;);</span>
<a href="#l2.9"></a><span id="l2.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12"> var UNIX_TIME_TO_PRTIME = 1000000;</span>
<a href="#l2.13"></a><span id="l2.13"> </span>
<a href="#l2.14"></a><span id="l2.14"> function calDateTime(innerObject) {</span>
<a href="#l2.15"></a><span id="l2.15">     this.wrappedJSObject = this;</span>
<a href="#l2.16"></a><span id="l2.16">     this.innerObject = innerObject || ICAL.Time.epochTime.clone();</span>
<a href="#l2.17"></a><span id="l2.17"> }</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19" class="difflineminus">-var calDateTimeInterfaces = [Components.interfaces.calIDateTime];</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineminus">-var calDateTimeClassID = Components.ID(&quot;{36783242-ec94-4d8a-9248-d2679edd55b9}&quot;);</span>
<a href="#l2.21"></a><span id="l2.21"> calDateTime.prototype = {</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calDateTimeInterfaces),</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineminus">-    classID: calDateTimeClassID,</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/datetime;1&quot;,</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineminus">-        classDescription: &quot;Describes a Date/Time Object&quot;,</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineminus">-        classID: calDateTimeClassID,</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineminus">-        interfaces: calDateTimeInterfaces</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-    }),</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIDateTime]),</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+    classID: Components.ID(&quot;{36783242-ec94-4d8a-9248-d2679edd55b9}&quot;),</span>
<a href="#l2.32"></a><span id="l2.32"> </span>
<a href="#l2.33"></a><span id="l2.33">     isMutable: true,</span>
<a href="#l2.34"></a><span id="l2.34">     makeImmutable: function() { this.isMutable = false; },</span>
<a href="#l2.35"></a><span id="l2.35">     clone: function() { return new calDateTime(this.innerObject.clone()); },</span>
<a href="#l2.36"></a><span id="l2.36"> </span>
<a href="#l2.37"></a><span id="l2.37">     isValid: true,</span>
<a href="#l2.38"></a><span id="l2.38">     innerObject: null,</span>
<a href="#l2.39"></a><span id="l2.39"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calDuration.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calDuration.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,31 +1,22 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> ChromeUtils.import(&quot;resource://calendar/modules/ical.js&quot;);</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11"> function calDuration(innerObject) {</span>
<a href="#l3.12"></a><span id="l3.12">     this.innerObject = innerObject || new ICAL.Duration();</span>
<a href="#l3.13"></a><span id="l3.13">     this.wrappedJSObject = this;</span>
<a href="#l3.14"></a><span id="l3.14"> }</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-var calDurationInterfaces = [Components.interfaces.calIDuration];</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-var calDurationClassID = Components.ID(&quot;{7436f480-c6fc-4085-9655-330b1ee22288}&quot;);</span>
<a href="#l3.18"></a><span id="l3.18"> calDuration.prototype = {</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calDurationInterfaces),</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-    classID: calDurationClassID,</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/duration;1&quot;,</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineminus">-        classDescription: &quot;Calendar Duration Object&quot;,</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineminus">-        classID: calDurationClassID,</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">-        interfaces: calDurationInterfaces</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineminus">-    }),</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIDuration]),</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+    classID: Components.ID(&quot;{7436f480-c6fc-4085-9655-330b1ee22288}&quot;),</span>
<a href="#l3.29"></a><span id="l3.29"> </span>
<a href="#l3.30"></a><span id="l3.30">     get icalDuration() { return this.innerObject; },</span>
<a href="#l3.31"></a><span id="l3.31">     set icalDuration(val) { this.innerObject = val; },</span>
<a href="#l3.32"></a><span id="l3.32"> </span>
<a href="#l3.33"></a><span id="l3.33">     isMutable: true,</span>
<a href="#l3.34"></a><span id="l3.34">     makeImmutable: function() { this.isMutable = false; },</span>
<a href="#l3.35"></a><span id="l3.35">     clone: function() { return new calDuration(this.innerObject.clone()); },</span>
<a href="#l3.36"></a><span id="l3.36"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,32 +1,23 @@</span>
<a href="#l4.4"></a><span id="l4.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.5"></a><span id="l4.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.6"></a><span id="l4.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8"> ChromeUtils.import(&quot;resource://calendar/modules/ical.js&quot;);</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l4.10"></a><span id="l4.10"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12"> function calIcalProperty(innerObject) {</span>
<a href="#l4.13"></a><span id="l4.13">     this.innerObject = innerObject || new ICAL.Property();</span>
<a href="#l4.14"></a><span id="l4.14">     this.wrappedJSObject = this;</span>
<a href="#l4.15"></a><span id="l4.15"> }</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-var calIcalPropertyInterfaces = [Components.interfaces.calIIcalProperty];</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-var calIcalPropertyClassID = Components.ID(&quot;{423ac3f0-f612-48b3-953f-47f7f8fd705b}&quot;);</span>
<a href="#l4.19"></a><span id="l4.19"> calIcalProperty.prototype = {</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calIcalPropertyInterfaces),</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-    classID: calIcalPropertyClassID,</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/ical-property;1&quot;,</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-        classDescription: &quot;Wrapper for a libical property&quot;,</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-        classID: calIcalPropertyClassID,</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-        interfaces: calIcalPropertyInterfaces</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-    }),</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIIcalProperty]),</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+    classID: Components.ID(&quot;{423ac3f0-f612-48b3-953f-47f7f8fd705b}&quot;),</span>
<a href="#l4.30"></a><span id="l4.30"> </span>
<a href="#l4.31"></a><span id="l4.31">     get icalString() { return this.innerObject.toICALString() + ICAL.newLineChar; },</span>
<a href="#l4.32"></a><span id="l4.32">     get icalProperty() { return this.innerObject; },</span>
<a href="#l4.33"></a><span id="l4.33">     set icalProperty(val) { this.innerObject = val; },</span>
<a href="#l4.34"></a><span id="l4.34"> </span>
<a href="#l4.35"></a><span id="l4.35">     get parent() { return this.innerObject.parent; },</span>
<a href="#l4.36"></a><span id="l4.36">     toString: function() { return this.innerObject.toICAL(); },</span>
<a href="#l4.37"></a><span id="l4.37"> </span>
<a href="#l4.38"></a><span id="l4.38" class="difflineat">@@ -208,27 +199,19 @@ calIcalProperty.prototype = {</span>
<a href="#l4.39"></a><span id="l4.39"> };</span>
<a href="#l4.40"></a><span id="l4.40"> </span>
<a href="#l4.41"></a><span id="l4.41"> function calIcalComponent(innerObject) {</span>
<a href="#l4.42"></a><span id="l4.42">     this.innerObject = innerObject || new ICAL.Component();</span>
<a href="#l4.43"></a><span id="l4.43">     this.wrappedJSObject = this;</span>
<a href="#l4.44"></a><span id="l4.44">     this.mReferencedZones = {};</span>
<a href="#l4.45"></a><span id="l4.45"> }</span>
<a href="#l4.46"></a><span id="l4.46"> </span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-var calIcalComponentInterfaces = [Components.interfaces.calIIcalComponent];</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineminus">-var calIcalComponentClassID = Components.ID(&quot;{51ac96fd-1279-4439-a85b-6947b37f4cea}&quot;);</span>
<a href="#l4.49"></a><span id="l4.49"> calIcalComponent.prototype = {</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calIcalComponentInterfaces),</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-    classID: calIcalComponentClassID,</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/ical-component;1&quot;,</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-        classDescription: &quot;Wrapper for a icaljs component&quot;,</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-        classID: calIcalComponentClassID,</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineminus">-        interfaces: calIcalComponentInterfaces</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineminus">-    }),</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIIcalComponent]),</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+    classID: Components.ID(&quot;{51ac96fd-1279-4439-a85b-6947b37f4cea}&quot;),</span>
<a href="#l4.60"></a><span id="l4.60"> </span>
<a href="#l4.61"></a><span id="l4.61">     clone: function() { return new calIcalComponent(new ICAL.Component(this.innerObject.toJSON())); },</span>
<a href="#l4.62"></a><span id="l4.62"> </span>
<a href="#l4.63"></a><span id="l4.63">     get parent() { return wrapGetter(calIcalComponent, this.innerObject.parent); },</span>
<a href="#l4.64"></a><span id="l4.64"> </span>
<a href="#l4.65"></a><span id="l4.65">     get icalTimezone() { return this.innerObject.name == &quot;vtimezone&quot; ? this.innerObject : null; },</span>
<a href="#l4.66"></a><span id="l4.66">     get icalComponent() { return this.innerObject; },</span>
<a href="#l4.67"></a><span id="l4.67">     set icalComponent(val) { this.innerObject = val; },</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineat">@@ -450,27 +433,19 @@ calIcalComponent.prototype = {</span>
<a href="#l4.69"></a><span id="l4.69">         return unicodeConverter.convertToInputStream(this.innerObject.toString());</span>
<a href="#l4.70"></a><span id="l4.70">     }</span>
<a href="#l4.71"></a><span id="l4.71"> };</span>
<a href="#l4.72"></a><span id="l4.72"> </span>
<a href="#l4.73"></a><span id="l4.73"> function calICSService() {</span>
<a href="#l4.74"></a><span id="l4.74">     this.wrappedJSObject = this;</span>
<a href="#l4.75"></a><span id="l4.75"> }</span>
<a href="#l4.76"></a><span id="l4.76"> </span>
<a href="#l4.77"></a><span id="l4.77" class="difflineminus">-var calICSServiceInterfaces = [Components.interfaces.calIICSService];</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineminus">-var calICSServiceClassID = Components.ID(&quot;{c61cb903-4408-41b3-bc22-da0b27efdfe1}&quot;);</span>
<a href="#l4.79"></a><span id="l4.79"> calICSService.prototype = {</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calICSServiceInterfaces),</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineminus">-    classID: calICSServiceClassID,</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/ics-service;1&quot;,</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineminus">-        classDescription: &quot;ICS component and property service&quot;,</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineminus">-        classID: calICSServiceClassID,</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineminus">-        interfaces: [Components.interfaces.calIICSService]</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineminus">-    }),</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIICSService]),</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+    classID: Components.ID(&quot;{c61cb903-4408-41b3-bc22-da0b27efdfe1}&quot;),</span>
<a href="#l4.90"></a><span id="l4.90"> </span>
<a href="#l4.91"></a><span id="l4.91">     parseICS: function(serialized, tzProvider) {</span>
<a href="#l4.92"></a><span id="l4.92">         // TODO ical.js doesn't support tz providers, but this is usually null</span>
<a href="#l4.93"></a><span id="l4.93">         // or our timezone service anyway.</span>
<a href="#l4.94"></a><span id="l4.94">         let comp = ICAL.parse(serialized);</span>
<a href="#l4.95"></a><span id="l4.95">         return new calIcalComponent(new ICAL.Component(comp));</span>
<a href="#l4.96"></a><span id="l4.96">     },</span>
<a href="#l4.97"></a><span id="l4.97"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calPeriod.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calPeriod.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,31 +1,22 @@</span>
<a href="#l5.4"></a><span id="l5.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> ChromeUtils.import(&quot;resource://calendar/modules/ical.js&quot;);</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11"> function calPeriod(innerObject) {</span>
<a href="#l5.12"></a><span id="l5.12">     this.innerObject = innerObject || new ICAL.Period({});</span>
<a href="#l5.13"></a><span id="l5.13">     this.wrappedJSObject = this;</span>
<a href="#l5.14"></a><span id="l5.14"> }</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-var calPeriodInterfaces = [Components.interfaces.calIPeriod];</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-var calPeriodClassID = Components.ID(&quot;{394a281f-7299-45f7-8b1f-cce21258972f}&quot;);</span>
<a href="#l5.18"></a><span id="l5.18"> calPeriod.prototype = {</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calPeriodInterfaces),</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-    classID: calPeriodClassID,</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/period;1&quot;,</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineminus">-        classDescription: &quot;A period between two dates&quot;,</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-        classID: calPeriodClassID,</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-        interfaces: calPeriodInterfaces</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-    }),</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIPeriod]),</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+    classID: Components.ID(&quot;{394a281f-7299-45f7-8b1f-cce21258972f}&quot;),</span>
<a href="#l5.29"></a><span id="l5.29"> </span>
<a href="#l5.30"></a><span id="l5.30">     isMutable: true,</span>
<a href="#l5.31"></a><span id="l5.31">     innerObject: null,</span>
<a href="#l5.32"></a><span id="l5.32"> </span>
<a href="#l5.33"></a><span id="l5.33">     get icalPeriod() { return this.innerObject; },</span>
<a href="#l5.34"></a><span id="l5.34">     set icalPeriod(val) { this.innerObject = val; },</span>
<a href="#l5.35"></a><span id="l5.35"> </span>
<a href="#l5.36"></a><span id="l5.36">     makeImmutable: function() { this.isMutable = false; },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calRecurrenceRule.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calRecurrenceRule.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -6,20 +6,23 @@ ChromeUtils.import(&quot;resource://calendar/</span>
<a href="#l6.4"></a><span id="l6.4"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l6.5"></a><span id="l6.5"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7"> function calRecurrenceRule(innerObject) {</span>
<a href="#l6.8"></a><span id="l6.8">     this.innerObject = innerObject || new ICAL.Recur();</span>
<a href="#l6.9"></a><span id="l6.9">     this.wrappedJSObject = this;</span>
<a href="#l6.10"></a><span id="l6.10"> }</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-var calRecurrenceRuleInterfaces = [Components.interfaces.calIRecurrenceRule];</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+var calRecurrenceRuleInterfaces = [</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+    Components.interfaces.calIRecurrenceRule,</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+    Components.interfaces.calIRecurrenceItem</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+];</span>
<a href="#l6.17"></a><span id="l6.17"> var calRecurrenceRuleClassID = Components.ID(&quot;{df19281a-5389-4146-b941-798cb93a7f0d}&quot;);</span>
<a href="#l6.18"></a><span id="l6.18"> calRecurrenceRule.prototype = {</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calRecurrenceRuleInterfaces),</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+    QueryInterface: cal.generateQI(calRecurrenceRuleInterfaces),</span>
<a href="#l6.21"></a><span id="l6.21">     classID: calRecurrenceRuleClassID,</span>
<a href="#l6.22"></a><span id="l6.22">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l6.23"></a><span id="l6.23">         contractID: &quot;@mozilla.org/calendar/recurrence-rule;1&quot;,</span>
<a href="#l6.24"></a><span id="l6.24">         classDescription: &quot;Calendar Recurrence Rule&quot;,</span>
<a href="#l6.25"></a><span id="l6.25">         classID: calRecurrenceRuleClassID,</span>
<a href="#l6.26"></a><span id="l6.26">         interfaces: calRecurrenceRuleInterfaces</span>
<a href="#l6.27"></a><span id="l6.27">     }),</span>
<a href="#l6.28"></a><span id="l6.28"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/modules/calUtils.jsm</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/modules/calUtils.jsm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -154,28 +154,58 @@ var cal = {</span>
<a href="#l7.4"></a><span id="l7.4">      *</span>
<a href="#l7.5"></a><span id="l7.5">      *     class calThing {</span>
<a href="#l7.6"></a><span id="l7.6">      *       QueryInterface(aIID) { return cal.generateClassQI(this, aIID, [Ci.calIThing]); }</span>
<a href="#l7.7"></a><span id="l7.7">      *</span>
<a href="#l7.8"></a><span id="l7.8">      *       ...</span>
<a href="#l7.9"></a><span id="l7.9">      *     }</span>
<a href="#l7.10"></a><span id="l7.10">      *</span>
<a href="#l7.11"></a><span id="l7.11">      * The function is cached, once this is called QueryInterface is replaced with</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-     * XPCOMUtils.generateQI()'s result.</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+     * cal.generateQI()'s result.</span>
<a href="#l7.14"></a><span id="l7.14">      *</span>
<a href="#l7.15"></a><span id="l7.15">      * @param {Object} aGlobal      The object to define the method on</span>
<a href="#l7.16"></a><span id="l7.16">      * @param {nsIIDRef} aIID       The IID to query for</span>
<a href="#l7.17"></a><span id="l7.17">      * @param {nsIIDRef[]}          The interfaces that this object implements</span>
<a href="#l7.18"></a><span id="l7.18">      * @return {nsQIResult}         The object queried for aIID</span>
<a href="#l7.19"></a><span id="l7.19">      */</span>
<a href="#l7.20"></a><span id="l7.20">     generateClassQI: function(aGlobal, aIID, aInterfaces) {</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-        Object.defineProperty(aGlobal, &quot;QueryInterface&quot;, { value: XPCOMUtils.generateQI(aInterfaces) });</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+        Object.defineProperty(aGlobal, &quot;QueryInterface&quot;, { value: cal.generateQI(aInterfaces) });</span>
<a href="#l7.23"></a><span id="l7.23">         return aGlobal.QueryInterface(aIID);</span>
<a href="#l7.24"></a><span id="l7.24">     },</span>
<a href="#l7.25"></a><span id="l7.25"> </span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+    /**</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+     * Generates the QueryInterface function. This is a replacement for XPCOMUtils.generateQI, which</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+     * is being replaced. Unfortunately Lightning's code depends on some of its classes providing</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+     * nsIClassInfo, which causes xpconnect/xpcom to make all methods available, e.g. for an event</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+     * both calIItemBase and calIEvent.</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+     *</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+     * @param {Array&lt;String|nsIIDRef&gt;} aInterfaces      The interfaces to generate QI for.</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+     * @return {Function}                               The QueryInterface function</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+     */</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+    generateQI: function(aInterfaces) {</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+        if (aInterfaces.length == 1) {</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+            cal.WARN(&quot;When generating QI for one interface, please use ChromeUtils.generateQI&quot;, cal.STACK(10));</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+            return ChromeUtils.generateQI(aInterfaces);</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+        } else {</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+            /* Note that Ci[Ci.x] == Ci.x for all x */</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+            let names = [];</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+            if (aInterfaces) {</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+                for (let i = 0; i &lt; aInterfaces.length; i++) {</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+                    let iface = aInterfaces[i];</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+                    let name = (iface &amp;&amp; iface.name) || String(iface);</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+                    if (name in Ci) {</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+                        names.push(name);</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+                    }</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+                }</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+            }</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+            return makeQI(names);</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+        }</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+    },</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+</span>
<a href="#l7.56"></a><span id="l7.56">     /**</span>
<a href="#l7.57"></a><span id="l7.57">      * Schedules execution of the passed function to the current thread's queue.</span>
<a href="#l7.58"></a><span id="l7.58">      */</span>
<a href="#l7.59"></a><span id="l7.59">     postPone: function(func) {</span>
<a href="#l7.60"></a><span id="l7.60">         if (this.threadingEnabled) {</span>
<a href="#l7.61"></a><span id="l7.61">             Services.tm.currentThread.dispatch({ run: func },</span>
<a href="#l7.62"></a><span id="l7.62">                                                Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l7.63"></a><span id="l7.63">         } else {</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineat">@@ -423,11 +453,35 @@ function shutdownCleanup(obj, prop) {</span>
<a href="#l7.65"></a><span id="l7.65">                 }</span>
<a href="#l7.66"></a><span id="l7.66">             }</span>
<a href="#l7.67"></a><span id="l7.67">             delete shutdownCleanup.mEntries;</span>
<a href="#l7.68"></a><span id="l7.68">         });</span>
<a href="#l7.69"></a><span id="l7.69">     }</span>
<a href="#l7.70"></a><span id="l7.70">     shutdownCleanup.mEntries.push({ mObj: obj, mProp: prop });</span>
<a href="#l7.71"></a><span id="l7.71"> }</span>
<a href="#l7.72"></a><span id="l7.72"> </span>
<a href="#l7.73"></a><span id="l7.73" class="difflineplus">+/**</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineplus">+ * This is the makeQI function from XPCOMUtils.jsm, it is separate to avoid leaks</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineplus">+ *</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineplus">+ * @param {Array&lt;String|nsIIDRef&gt;} aInterfaces      The interfaces to make QI for.</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+ * @return {Function}                               The QueryInterface function.</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineplus">+ */</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineplus">+function makeQI(aInterfaces) {</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineplus">+    return function(iid) {</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineplus">+        if (iid.equals(Ci.nsISupports)) {</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+            return this;</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineplus">+        }</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineplus">+        if (iid.equals(Ci.nsIClassInfo) &amp;&amp; &quot;classInfo&quot; in this) {</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineplus">+            return this.classInfo;</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineplus">+        }</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineplus">+        for (let i = 0; i &lt; aInterfaces.length; i++) {</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+            if (Ci[aInterfaces[i]].equals(iid)) {</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineplus">+                return this;</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineplus">+            }</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineplus">+        }</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineplus">+</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineplus">+        throw Cr.NS_ERROR_NO_INTERFACE;</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineplus">+    };</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineplus">+}</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineplus">+</span>
<a href="#l7.97"></a><span id="l7.97"> // Backwards compatibility for bug 905097. Please remove with Thunderbird 61.</span>
<a href="#l7.98"></a><span id="l7.98"> ChromeUtils.import(&quot;resource://calendar/modules/calUtilsCompat.jsm&quot;);</span>
<a href="#l7.99"></a><span id="l7.99"> injectCalUtilsCompat(cal);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/src/calAlarm.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/src/calAlarm.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,56 +1,46 @@</span>
<a href="#l8.4"></a><span id="l8.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l8.9"></a><span id="l8.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12"> var ALARM_RELATED_ABSOLUTE = Components.interfaces.calIAlarm.ALARM_RELATED_ABSOLUTE;</span>
<a href="#l8.13"></a><span id="l8.13"> var ALARM_RELATED_START = Components.interfaces.calIAlarm.ALARM_RELATED_START;</span>
<a href="#l8.14"></a><span id="l8.14"> var ALARM_RELATED_END = Components.interfaces.calIAlarm.ALARM_RELATED_END;</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16"> function calAlarm() {</span>
<a href="#l8.17"></a><span id="l8.17">     this.wrappedJSObject = this;</span>
<a href="#l8.18"></a><span id="l8.18">     this.mProperties = new cal.data.PropertyMap();</span>
<a href="#l8.19"></a><span id="l8.19">     this.mPropertyParams = {};</span>
<a href="#l8.20"></a><span id="l8.20">     this.mAttendees = [];</span>
<a href="#l8.21"></a><span id="l8.21">     this.mAttachments = [];</span>
<a href="#l8.22"></a><span id="l8.22"> }</span>
<a href="#l8.23"></a><span id="l8.23"> </span>
<a href="#l8.24"></a><span id="l8.24" class="difflineminus">-var calAlarmClassID = Components.ID(&quot;{b8db7c7f-c168-4e11-becb-f26c1c4f5f8f}&quot;);</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-var calAlarmInterfaces = [Components.interfaces.calIAlarm];</span>
<a href="#l8.26"></a><span id="l8.26"> calAlarm.prototype = {</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIAlarm]),</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+    classID: Components.ID(&quot;{b8db7c7f-c168-4e11-becb-f26c1c4f5f8f}&quot;),</span>
<a href="#l8.29"></a><span id="l8.29"> </span>
<a href="#l8.30"></a><span id="l8.30">     mProperties: null,</span>
<a href="#l8.31"></a><span id="l8.31">     mPropertyParams: null,</span>
<a href="#l8.32"></a><span id="l8.32">     mAction: null,</span>
<a href="#l8.33"></a><span id="l8.33">     mAbsoluteDate: null,</span>
<a href="#l8.34"></a><span id="l8.34">     mOffset: null,</span>
<a href="#l8.35"></a><span id="l8.35">     mDuration: null,</span>
<a href="#l8.36"></a><span id="l8.36">     mAttendees: null,</span>
<a href="#l8.37"></a><span id="l8.37">     mAttachments: null,</span>
<a href="#l8.38"></a><span id="l8.38">     mSummary: null,</span>
<a href="#l8.39"></a><span id="l8.39">     mDescription: null,</span>
<a href="#l8.40"></a><span id="l8.40">     mLastAck: null,</span>
<a href="#l8.41"></a><span id="l8.41">     mImmutable: false,</span>
<a href="#l8.42"></a><span id="l8.42">     mRelated: 0,</span>
<a href="#l8.43"></a><span id="l8.43">     mRepeat: 0,</span>
<a href="#l8.44"></a><span id="l8.44"> </span>
<a href="#l8.45"></a><span id="l8.45" class="difflineminus">-    classID: calAlarmClassID,</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calAlarmInterfaces),</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-        classID: calAlarmClassID,</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/alarm;1&quot;,</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-        classDescription: &quot;Describes a VALARM&quot;,</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-        interfaces: calAlarmInterfaces</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-    }),</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-</span>
<a href="#l8.54"></a><span id="l8.54">     /**</span>
<a href="#l8.55"></a><span id="l8.55">      * calIAlarm</span>
<a href="#l8.56"></a><span id="l8.56">      */</span>
<a href="#l8.57"></a><span id="l8.57"> </span>
<a href="#l8.58"></a><span id="l8.58">     ensureMutable: function() {</span>
<a href="#l8.59"></a><span id="l8.59">         if (this.mImmutable) {</span>
<a href="#l8.60"></a><span id="l8.60">             throw Components.results.NS_ERROR_OBJECT_IS_IMMUTABLE;</span>
<a href="#l8.61"></a><span id="l8.61">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/src/calAlarmMonitor.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/src/calAlarmMonitor.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -36,17 +36,17 @@ calAlarmMonitor.prototype = {</span>
<a href="#l9.4"></a><span id="l9.4">     // we call openWindow and when it appears via getMostRecentWindow.  If an</span>
<a href="#l9.5"></a><span id="l9.5">     // alarm is fired in that time-frame, it will actually end up in another window.</span>
<a href="#l9.6"></a><span id="l9.6">     mWindowOpening: null,</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">     // nsISound instance used for playing all sounds</span>
<a href="#l9.9"></a><span id="l9.9">     mSound: null,</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">     classID: calAlarmMonitorClassID,</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calAlarmMonitorInterfaces),</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    QueryInterface: cal.generateQI(calAlarmMonitorInterfaces),</span>
<a href="#l9.14"></a><span id="l9.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l9.15"></a><span id="l9.15">         contractID: &quot;@mozilla.org/calendar/alarm-monitor;1&quot;,</span>
<a href="#l9.16"></a><span id="l9.16">         classDescription: &quot;Calendar Alarm Monitor&quot;,</span>
<a href="#l9.17"></a><span id="l9.17">         classID: calAlarmMonitorClassID,</span>
<a href="#l9.18"></a><span id="l9.18">         interfaces: calAlarmMonitorInterfaces,</span>
<a href="#l9.19"></a><span id="l9.19">         flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l9.20"></a><span id="l9.20">     }),</span>
<a href="#l9.21"></a><span id="l9.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/src/calAlarmService.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/src/calAlarmService.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -27,20 +27,19 @@ function newTimerWithCallback(aCallback,</span>
<a href="#l10.4"></a><span id="l10.4"> function calAlarmService() {</span>
<a href="#l10.5"></a><span id="l10.5">     this.wrappedJSObject = this;</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7">     this.mLoadedCalendars = {};</span>
<a href="#l10.8"></a><span id="l10.8">     this.mTimerMap = {};</span>
<a href="#l10.9"></a><span id="l10.9">     this.mObservers = new cal.data.ListenerSet(Components.interfaces.calIAlarmServiceObserver);</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11">     this.calendarObserver = {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+        QueryInterface: ChromeUtils.generateQI([Components.interfaces.calIObserver]),</span>
<a href="#l10.13"></a><span id="l10.13">         alarmService: this,</span>
<a href="#l10.14"></a><span id="l10.14"> </span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-        QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIObserver]),</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-</span>
<a href="#l10.17"></a><span id="l10.17">         // calIObserver:</span>
<a href="#l10.18"></a><span id="l10.18">         onStartBatch: function() { },</span>
<a href="#l10.19"></a><span id="l10.19">         onEndBatch: function() { },</span>
<a href="#l10.20"></a><span id="l10.20">         onLoad: function(calendar) {</span>
<a href="#l10.21"></a><span id="l10.21">             // ignore any onLoad events until initial getItems() call of startup has finished:</span>
<a href="#l10.22"></a><span id="l10.22">             if (calendar &amp;&amp; this.alarmService.mLoadedCalendars[calendar.id]) {</span>
<a href="#l10.23"></a><span id="l10.23">                 // a refreshed calendar signals that it has been reloaded</span>
<a href="#l10.24"></a><span id="l10.24">                 // (and cannot notify detailed changes), thus reget all alarms of it:</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineat">@@ -73,20 +72,19 @@ function calAlarmService() {</span>
<a href="#l10.26"></a><span id="l10.26">             }</span>
<a href="#l10.27"></a><span id="l10.27">         },</span>
<a href="#l10.28"></a><span id="l10.28">         onPropertyDeleting: function(aCalendar, aName) {</span>
<a href="#l10.29"></a><span id="l10.29">             this.onPropertyChanged(aCalendar, aName);</span>
<a href="#l10.30"></a><span id="l10.30">         }</span>
<a href="#l10.31"></a><span id="l10.31">     };</span>
<a href="#l10.32"></a><span id="l10.32"> </span>
<a href="#l10.33"></a><span id="l10.33">     this.calendarManagerObserver = {</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+        QueryInterface: ChromeUtils.generateQI([Components.interfaces.calICalendarManagerObserver]),</span>
<a href="#l10.35"></a><span id="l10.35">         alarmService: this,</span>
<a href="#l10.36"></a><span id="l10.36"> </span>
<a href="#l10.37"></a><span id="l10.37" class="difflineminus">-        QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calICalendarManagerObserver]),</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineminus">-</span>
<a href="#l10.39"></a><span id="l10.39">         onCalendarRegistered: function(aCalendar) {</span>
<a href="#l10.40"></a><span id="l10.40">             this.alarmService.observeCalendar(aCalendar);</span>
<a href="#l10.41"></a><span id="l10.41">             // initial refresh of alarms for new calendar:</span>
<a href="#l10.42"></a><span id="l10.42">             this.alarmService.initAlarms([aCalendar]);</span>
<a href="#l10.43"></a><span id="l10.43">         },</span>
<a href="#l10.44"></a><span id="l10.44">         onCalendarUnregistering: function(aCalendar) {</span>
<a href="#l10.45"></a><span id="l10.45">             // XXX todo: we need to think about calendar unregistration;</span>
<a href="#l10.46"></a><span id="l10.46">             // there may still be dangling items (-&gt; alarm dialog),</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineat">@@ -107,17 +105,17 @@ calAlarmService.prototype = {</span>
<a href="#l10.48"></a><span id="l10.48">     mRangeEnd: null,</span>
<a href="#l10.49"></a><span id="l10.49">     mUpdateTimer: null,</span>
<a href="#l10.50"></a><span id="l10.50">     mStarted: false,</span>
<a href="#l10.51"></a><span id="l10.51">     mTimerMap: null,</span>
<a href="#l10.52"></a><span id="l10.52">     mObservers: null,</span>
<a href="#l10.53"></a><span id="l10.53">     mTimezone: null,</span>
<a href="#l10.54"></a><span id="l10.54"> </span>
<a href="#l10.55"></a><span id="l10.55">     classID: calAlarmServiceClassID,</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calAlarmServiceInterfaces),</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+    QueryInterface: cal.generateQI(calAlarmServiceInterfaces),</span>
<a href="#l10.58"></a><span id="l10.58">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l10.59"></a><span id="l10.59">         classID: calAlarmServiceClassID,</span>
<a href="#l10.60"></a><span id="l10.60">         contractID: &quot;@mozilla.org/calendar/alarm-service;1&quot;,</span>
<a href="#l10.61"></a><span id="l10.61">         classDescription: &quot;Calendar Alarm Service&quot;,</span>
<a href="#l10.62"></a><span id="l10.62">         interfaces: calAlarmServiceInterfaces,</span>
<a href="#l10.63"></a><span id="l10.63">         flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l10.64"></a><span id="l10.64">     }),</span>
<a href="#l10.65"></a><span id="l10.65"> </span>
<a href="#l10.66"></a><span id="l10.66" class="difflineat">@@ -491,17 +489,17 @@ calAlarmService.prototype = {</span>
<a href="#l10.67"></a><span id="l10.67">                 }</span>
<a href="#l10.68"></a><span id="l10.68">                 delete this.mTimerMap[calendar.id];</span>
<a href="#l10.69"></a><span id="l10.69">             }</span>
<a href="#l10.70"></a><span id="l10.70">         }</span>
<a href="#l10.71"></a><span id="l10.71">     },</span>
<a href="#l10.72"></a><span id="l10.72"> </span>
<a href="#l10.73"></a><span id="l10.73">     findAlarms: function(aCalendars, aStart, aUntil) {</span>
<a href="#l10.74"></a><span id="l10.74">         let getListener = {</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineminus">-            QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineplus">+            QueryInterface: ChromeUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l10.77"></a><span id="l10.77">             alarmService: this,</span>
<a href="#l10.78"></a><span id="l10.78">             addRemovePromise: PromiseUtils.defer(),</span>
<a href="#l10.79"></a><span id="l10.79">             batchCount: 0,</span>
<a href="#l10.80"></a><span id="l10.80">             results: false,</span>
<a href="#l10.81"></a><span id="l10.81">             onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l10.82"></a><span id="l10.82">                 this.addRemovePromise.promise.then((aValue) =&gt; {</span>
<a href="#l10.83"></a><span id="l10.83">                     // calendar has been loaded, so until now, onLoad events can be ignored:</span>
<a href="#l10.84"></a><span id="l10.84">                     this.alarmService.mLoadedCalendars[aCalendar.id] = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/src/calAttachment.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/src/calAttachment.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,40 +1,30 @@</span>
<a href="#l11.4"></a><span id="l11.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.5"></a><span id="l11.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.6"></a><span id="l11.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l11.7"></a><span id="l11.7"> </span>
<a href="#l11.8"></a><span id="l11.8"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">-</span>
<a href="#l11.11"></a><span id="l11.11"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l11.12"></a><span id="l11.12"> </span>
<a href="#l11.13"></a><span id="l11.13"> //</span>
<a href="#l11.14"></a><span id="l11.14"> // calAttachment.js</span>
<a href="#l11.15"></a><span id="l11.15"> //</span>
<a href="#l11.16"></a><span id="l11.16"> function calAttachment() {</span>
<a href="#l11.17"></a><span id="l11.17">     this.wrappedJSObject = this;</span>
<a href="#l11.18"></a><span id="l11.18">     this.mProperties = new cal.data.PropertyMap();</span>
<a href="#l11.19"></a><span id="l11.19"> }</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21" class="difflineminus">-var calAttachmentClassID = Components.ID(&quot;{5f76b352-ab75-4c2b-82c9-9206dbbf8571}&quot;);</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineminus">-var calAttachmentInterfaces = [Components.interfaces.calIAttachment];</span>
<a href="#l11.23"></a><span id="l11.23"> calAttachment.prototype = {</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIAttachment]),</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+    classID: Components.ID(&quot;{5f76b352-ab75-4c2b-82c9-9206dbbf8571}&quot;),</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+</span>
<a href="#l11.27"></a><span id="l11.27">     mData: null,</span>
<a href="#l11.28"></a><span id="l11.28">     mHashId: null,</span>
<a href="#l11.29"></a><span id="l11.29"> </span>
<a href="#l11.30"></a><span id="l11.30" class="difflineminus">-    classID: calAttachmentClassID,</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calAttachmentInterfaces),</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineminus">-        classID: calAttachmentClassID,</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/attachment;1&quot;,</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-        classDescription: &quot;Calendar Item Attachment&quot;,</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">-        interfaces: calAttachmentInterfaces</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">-    }),</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineminus">-</span>
<a href="#l11.39"></a><span id="l11.39">     get hashId() {</span>
<a href="#l11.40"></a><span id="l11.40">         if (!this.mHashId) {</span>
<a href="#l11.41"></a><span id="l11.41">             let cryptoHash = Components.classes[&quot;@mozilla.org/security/hash;1&quot;]</span>
<a href="#l11.42"></a><span id="l11.42">                                        .createInstance(Components.interfaces.nsICryptoHash);</span>
<a href="#l11.43"></a><span id="l11.43"> </span>
<a href="#l11.44"></a><span id="l11.44">             let converter = Components.classes[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;]</span>
<a href="#l11.45"></a><span id="l11.45">                                       .createInstance(Components.interfaces.nsIScriptableUnicodeConverter);</span>
<a href="#l11.46"></a><span id="l11.46">             converter.charset = &quot;UTF-8&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/src/calAttendee.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/src/calAttendee.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,32 +1,22 @@</span>
<a href="#l12.4"></a><span id="l12.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.5"></a><span id="l12.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l12.6"></a><span id="l12.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineminus">-</span>
<a href="#l12.10"></a><span id="l12.10"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12"> function calAttendee() {</span>
<a href="#l12.13"></a><span id="l12.13">     this.wrappedJSObject = this;</span>
<a href="#l12.14"></a><span id="l12.14">     this.mProperties = new cal.data.PropertyMap();</span>
<a href="#l12.15"></a><span id="l12.15"> }</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-var calAttendeeClassID = Components.ID(&quot;{5c8dcaa3-170c-4a73-8142-d531156f664d}&quot;);</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-var calAttendeeInterfaces = [Components.interfaces.calIAttendee];</span>
<a href="#l12.19"></a><span id="l12.19"> calAttendee.prototype = {</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-    classID: calAttendeeClassID,</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calAttendeeInterfaces),</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-        classID: calAttendeeClassID,</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/attendee;1&quot;,</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineminus">-        classDescription: &quot;Calendar Attendee&quot;,</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-        interfaces: calAttendeeInterfaces</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-    }),</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIAttendee]),</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+    classID: Components.ID(&quot;{5c8dcaa3-170c-4a73-8142-d531156f664d}&quot;),</span>
<a href="#l12.30"></a><span id="l12.30"> </span>
<a href="#l12.31"></a><span id="l12.31">     mImmutable: false,</span>
<a href="#l12.32"></a><span id="l12.32">     get isMutable() { return !this.mImmutable; },</span>
<a href="#l12.33"></a><span id="l12.33"> </span>
<a href="#l12.34"></a><span id="l12.34">     modify: function() {</span>
<a href="#l12.35"></a><span id="l12.35">         if (this.mImmutable) {</span>
<a href="#l12.36"></a><span id="l12.36">             throw Components.results.NS_ERROR_OBJECT_IS_IMMUTABLE;</span>
<a href="#l12.37"></a><span id="l12.37">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -21,17 +21,17 @@ function calCalendarManager() {</span>
<a href="#l13.4"></a><span id="l13.4"> var calCalendarManagerClassID = Components.ID(&quot;{f42585e7-e736-4600-985d-9624c1c51992}&quot;);</span>
<a href="#l13.5"></a><span id="l13.5"> var calCalendarManagerInterfaces = [</span>
<a href="#l13.6"></a><span id="l13.6">     Components.interfaces.calICalendarManager,</span>
<a href="#l13.7"></a><span id="l13.7">     Components.interfaces.calIStartupService,</span>
<a href="#l13.8"></a><span id="l13.8">     Components.interfaces.nsIObserver,</span>
<a href="#l13.9"></a><span id="l13.9"> ];</span>
<a href="#l13.10"></a><span id="l13.10"> calCalendarManager.prototype = {</span>
<a href="#l13.11"></a><span id="l13.11">     classID: calCalendarManagerClassID,</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calCalendarManagerInterfaces),</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    QueryInterface: cal.generateQI(calCalendarManagerInterfaces),</span>
<a href="#l13.14"></a><span id="l13.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l13.15"></a><span id="l13.15">         classID: calCalendarManagerClassID,</span>
<a href="#l13.16"></a><span id="l13.16">         contractID: &quot;@mozilla.org/calendar/manager;1&quot;,</span>
<a href="#l13.17"></a><span id="l13.17">         classDescription: &quot;Calendar Manager&quot;,</span>
<a href="#l13.18"></a><span id="l13.18">         interfaces: calCalendarManagerInterfaces,</span>
<a href="#l13.19"></a><span id="l13.19">         flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l13.20"></a><span id="l13.20">     }),</span>
<a href="#l13.21"></a><span id="l13.21"> </span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -803,17 +803,17 @@ function calMgrCalendarObserver(calendar</span>
<a href="#l13.23"></a><span id="l13.23">     this.calMgr = calMgr;</span>
<a href="#l13.24"></a><span id="l13.24"> }</span>
<a href="#l13.25"></a><span id="l13.25"> </span>
<a href="#l13.26"></a><span id="l13.26"> calMgrCalendarObserver.prototype = {</span>
<a href="#l13.27"></a><span id="l13.27">     calendar: null,</span>
<a href="#l13.28"></a><span id="l13.28">     storedReadOnly: null,</span>
<a href="#l13.29"></a><span id="l13.29">     calMgr: null,</span>
<a href="#l13.30"></a><span id="l13.30"> </span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI([</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([</span>
<a href="#l13.33"></a><span id="l13.33">         Components.interfaces.nsIWindowMediatorListener,</span>
<a href="#l13.34"></a><span id="l13.34">         Components.interfaces.calIObserver</span>
<a href="#l13.35"></a><span id="l13.35">     ]),</span>
<a href="#l13.36"></a><span id="l13.36"> </span>
<a href="#l13.37"></a><span id="l13.37">     // calIObserver:</span>
<a href="#l13.38"></a><span id="l13.38">     onStartBatch: function() { return this.calMgr.notifyCalendarObservers(&quot;onStartBatch&quot;, arguments); },</span>
<a href="#l13.39"></a><span id="l13.39">     onEndBatch: function() { return this.calMgr.notifyCalendarObservers(&quot;onEndBatch&quot;, arguments); },</span>
<a href="#l13.40"></a><span id="l13.40">     onLoad: function(calendar) { return this.calMgr.notifyCalendarObservers(&quot;onLoad&quot;, arguments); },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/src/calCalendarSearchService.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/src/calCalendarSearchService.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -52,17 +52,17 @@ var calCalendarSearchServiceClassID = Co</span>
<a href="#l14.4"></a><span id="l14.4"> var calCalendarSearchServiceInterfaces = [</span>
<a href="#l14.5"></a><span id="l14.5">     Components.interfaces.calICalendarSearchProvider,</span>
<a href="#l14.6"></a><span id="l14.6">     Components.interfaces.calICalendarSearchService</span>
<a href="#l14.7"></a><span id="l14.7"> ];</span>
<a href="#l14.8"></a><span id="l14.8"> calCalendarSearchService.prototype = {</span>
<a href="#l14.9"></a><span id="l14.9">     mProviders: null,</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">     classID: calCalendarSearchServiceClassID,</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calCalendarSearchServiceInterfaces),</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+    QueryInterface: cal.generateQI(calCalendarSearchServiceInterfaces),</span>
<a href="#l14.14"></a><span id="l14.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l14.15"></a><span id="l14.15">         classID: calCalendarSearchServiceClassID,</span>
<a href="#l14.16"></a><span id="l14.16">         contractID: &quot;@mozilla.org/calendar/calendarsearch-service;1&quot;,</span>
<a href="#l14.17"></a><span id="l14.17">         classDescription: &quot;Calendar Search Service&quot;,</span>
<a href="#l14.18"></a><span id="l14.18">         interfaces: calCalendarSearchServiceInterfaces,</span>
<a href="#l14.19"></a><span id="l14.19">         flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l14.20"></a><span id="l14.20">     }),</span>
<a href="#l14.21"></a><span id="l14.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/src/calDateTimeFormatter.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/src/calDateTimeFormatter.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -6,27 +6,19 @@ ChromeUtils.import(&quot;resource://gre/modul</span>
<a href="#l15.4"></a><span id="l15.4"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l15.5"></a><span id="l15.5"> ChromeUtils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l15.6"></a><span id="l15.6"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8"> function calDateTimeFormatter() {</span>
<a href="#l15.9"></a><span id="l15.9">     this.wrappedJSObject = this;</span>
<a href="#l15.10"></a><span id="l15.10">     this.mDateStringBundle = Services.strings.createBundle(&quot;chrome://calendar/locale/dateFormat.properties&quot;);</span>
<a href="#l15.11"></a><span id="l15.11"> }</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-var calDateTimeFormatterClassID = Components.ID(&quot;{4123da9a-f047-42da-a7d0-cc4175b9f36a}&quot;);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-var calDateTimeFormatterInterfaces = [Components.interfaces.calIDateTimeFormatter];</span>
<a href="#l15.14"></a><span id="l15.14"> calDateTimeFormatter.prototype = {</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-    classID: calDateTimeFormatterClassID,</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calDateTimeFormatterInterfaces),</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-        classID: calDateTimeFormatterClassID,</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/datetime-formatter;1&quot;,</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">-        classDescription: &quot;Formats Dates and Times&quot;,</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineminus">-        interfaces: calDateTimeFormatterInterfaces,</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-    }),</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIDateTimeFormatter]),</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+    classID: Components.ID(&quot;{4123da9a-f047-42da-a7d0-cc4175b9f36a}&quot;),</span>
<a href="#l15.25"></a><span id="l15.25"> </span>
<a href="#l15.26"></a><span id="l15.26">     formatDate: function(aDate) {</span>
<a href="#l15.27"></a><span id="l15.27">         // Format the date using user's format preference (long or short)</span>
<a href="#l15.28"></a><span id="l15.28">         let format = Preferences.get(&quot;calendar.date.format&quot;, 0);</span>
<a href="#l15.29"></a><span id="l15.29">         return (format == 0 ? this.formatDateLong(aDate) : this.formatDateShort(aDate));</span>
<a href="#l15.30"></a><span id="l15.30">     },</span>
<a href="#l15.31"></a><span id="l15.31"> </span>
<a href="#l15.32"></a><span id="l15.32">     formatDateShort: function(aDate) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/src/calDefaultACLManager.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/src/calDefaultACLManager.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,37 +1,25 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.5"></a><span id="l16.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.6"></a><span id="l16.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineminus">-</span>
<a href="#l16.11"></a><span id="l16.11"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l16.12"></a><span id="l16.12"> </span>
<a href="#l16.13"></a><span id="l16.13"> /* calDefaultACLManager */</span>
<a href="#l16.14"></a><span id="l16.14"> function calDefaultACLManager() {</span>
<a href="#l16.15"></a><span id="l16.15">     this.mCalendarEntries = {};</span>
<a href="#l16.16"></a><span id="l16.16"> }</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18" class="difflineminus">-var calDefaultACLManagerClassID = Components.ID(&quot;{7463258c-6ef3-40a2-89a9-bb349596e927}&quot;);</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-var calDefaultACLManagerInterfaces = [Components.interfaces.calICalendarACLManager];</span>
<a href="#l16.20"></a><span id="l16.20"> calDefaultACLManager.prototype = {</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineminus">-    mCalendarEntries: null,</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calICalendarACLManager]),</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+    classID: Components.ID(&quot;{7463258c-6ef3-40a2-89a9-bb349596e927}&quot;),</span>
<a href="#l16.24"></a><span id="l16.24"> </span>
<a href="#l16.25"></a><span id="l16.25" class="difflineminus">-    /* nsISupports, nsIClassInfo */</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineminus">-    classID: calDefaultACLManagerClassID,</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calDefaultACLManagerInterfaces),</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineminus">-        classID: calDefaultACLManagerClassID,</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/acl-manager;1?type=default&quot;,</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-        classDescription: &quot;Default Calendar ACL Provider&quot;,</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineminus">-        interfaces: calDefaultACLManagerInterfaces,</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineminus">-    }),</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineplus">+    mCalendarEntries: null,</span>
<a href="#l16.36"></a><span id="l16.36"> </span>
<a href="#l16.37"></a><span id="l16.37">     /* calICalendarACLManager */</span>
<a href="#l16.38"></a><span id="l16.38">     _getCalendarEntryCached: function(aCalendar) {</span>
<a href="#l16.39"></a><span id="l16.39">         let calUri = aCalendar.uri.spec;</span>
<a href="#l16.40"></a><span id="l16.40">         if (!(calUri in this.mCalendarEntries)) {</span>
<a href="#l16.41"></a><span id="l16.41">             this.mCalendarEntries[calUri] = new calDefaultCalendarACLEntry(this, aCalendar);</span>
<a href="#l16.42"></a><span id="l16.42">         }</span>
<a href="#l16.43"></a><span id="l16.43"> </span>
<a href="#l16.44"></a><span id="l16.44" class="difflineat">@@ -52,20 +40,19 @@ calDefaultACLManager.prototype = {</span>
<a href="#l16.45"></a><span id="l16.45"> };</span>
<a href="#l16.46"></a><span id="l16.46"> </span>
<a href="#l16.47"></a><span id="l16.47"> function calDefaultCalendarACLEntry(aMgr, aCalendar) {</span>
<a href="#l16.48"></a><span id="l16.48">     this.mACLManager = aMgr;</span>
<a href="#l16.49"></a><span id="l16.49">     this.mCalendar = aCalendar;</span>
<a href="#l16.50"></a><span id="l16.50"> }</span>
<a href="#l16.51"></a><span id="l16.51"> </span>
<a href="#l16.52"></a><span id="l16.52"> calDefaultCalendarACLEntry.prototype = {</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineminus">-    mACLManager: null,</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calICalendarACLEntry]),</span>
<a href="#l16.55"></a><span id="l16.55"> </span>
<a href="#l16.56"></a><span id="l16.56" class="difflineminus">-    /* nsISupports */</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calICalendarACLEntry]),</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineplus">+    mACLManager: null,</span>
<a href="#l16.59"></a><span id="l16.59"> </span>
<a href="#l16.60"></a><span id="l16.60">     /* calICalendarACLCalendarEntry */</span>
<a href="#l16.61"></a><span id="l16.61">     get aclManager() {</span>
<a href="#l16.62"></a><span id="l16.62">         return this.mACLManager;</span>
<a href="#l16.63"></a><span id="l16.63">     },</span>
<a href="#l16.64"></a><span id="l16.64"> </span>
<a href="#l16.65"></a><span id="l16.65">     hasAccessControl: false,</span>
<a href="#l16.66"></a><span id="l16.66">     userIsOwner: true,</span>
<a href="#l16.67"></a><span id="l16.67" class="difflineat">@@ -102,18 +89,17 @@ calDefaultCalendarACLEntry.prototype = {</span>
<a href="#l16.68"></a><span id="l16.68">     }</span>
<a href="#l16.69"></a><span id="l16.69"> };</span>
<a href="#l16.70"></a><span id="l16.70"> </span>
<a href="#l16.71"></a><span id="l16.71"> function calDefaultItemACLEntry(aCalendarEntry) {</span>
<a href="#l16.72"></a><span id="l16.72">     this.calendarEntry = aCalendarEntry;</span>
<a href="#l16.73"></a><span id="l16.73"> }</span>
<a href="#l16.74"></a><span id="l16.74"> </span>
<a href="#l16.75"></a><span id="l16.75"> calDefaultItemACLEntry.prototype = {</span>
<a href="#l16.76"></a><span id="l16.76" class="difflineminus">-    /* nsISupports */</span>
<a href="#l16.77"></a><span id="l16.77" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIItemACLEntry]),</span>
<a href="#l16.78"></a><span id="l16.78" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIItemACLEntry]),</span>
<a href="#l16.79"></a><span id="l16.79"> </span>
<a href="#l16.80"></a><span id="l16.80">     /* calIItemACLEntry */</span>
<a href="#l16.81"></a><span id="l16.81">     calendarEntry: null,</span>
<a href="#l16.82"></a><span id="l16.82">     userCanModify: true,</span>
<a href="#l16.83"></a><span id="l16.83">     userCanRespond: true,</span>
<a href="#l16.84"></a><span id="l16.84">     userCanViewAll: true,</span>
<a href="#l16.85"></a><span id="l16.85">     userCanViewDateAndTime: true,</span>
<a href="#l16.86"></a><span id="l16.86"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/src/calDeletedItems.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/src/calDeletedItems.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l17.4"></a><span id="l17.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.5"></a><span id="l17.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.6"></a><span id="l17.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l17.10"></a><span id="l17.10"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l17.11"></a><span id="l17.11"> ChromeUtils.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);</span>
<a href="#l17.12"></a><span id="l17.12"> </span>
<a href="#l17.13"></a><span id="l17.13"> /**</span>
<a href="#l17.14"></a><span id="l17.14">  * Handles remembering deleted items.</span>
<a href="#l17.15"></a><span id="l17.15">  *</span>
<a href="#l17.16"></a><span id="l17.16">  * This is (currently) not a real trashcan. Only ids and time deleted is stored.</span>
<a href="#l17.17"></a><span id="l17.17">  * Note also that the code doesn't strictly check the calendar of the item,</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineat">@@ -27,17 +28,17 @@ var calDeletedItemsClassID = Components.</span>
<a href="#l17.19"></a><span id="l17.19"> var calDeletedItemsInterfaces = [</span>
<a href="#l17.20"></a><span id="l17.20">     Components.interfaces.calIDeletedItems,</span>
<a href="#l17.21"></a><span id="l17.21">     Components.interfaces.nsIObserver,</span>
<a href="#l17.22"></a><span id="l17.22">     Components.interfaces.calIObserver</span>
<a href="#l17.23"></a><span id="l17.23"> ];</span>
<a href="#l17.24"></a><span id="l17.24"> calDeletedItems.prototype = {</span>
<a href="#l17.25"></a><span id="l17.25"> </span>
<a href="#l17.26"></a><span id="l17.26">     classID: calDeletedItemsClassID,</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calDeletedItemsInterfaces),</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineplus">+    QueryInterface: cal.generateQI(calDeletedItemsInterfaces),</span>
<a href="#l17.29"></a><span id="l17.29">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l17.30"></a><span id="l17.30">         classID: calDeletedItemsClassID,</span>
<a href="#l17.31"></a><span id="l17.31">         contractID: &quot;@mozilla.org/calendar/deleted-items-manager;1&quot;,</span>
<a href="#l17.32"></a><span id="l17.32">         classDescription: &quot;Database containing information about deleted items&quot;,</span>
<a href="#l17.33"></a><span id="l17.33">         interfaces: calDeletedItemsInterfaces,</span>
<a href="#l17.34"></a><span id="l17.34">         flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l17.35"></a><span id="l17.35">     }),</span>
<a href="#l17.36"></a><span id="l17.36"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/src/calEvent.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/src/calEvent.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -22,17 +22,17 @@ var calEventInterfaces = [</span>
<a href="#l18.4"></a><span id="l18.4">     Components.interfaces.calIItemBase,</span>
<a href="#l18.5"></a><span id="l18.5">     Components.interfaces.calIEvent,</span>
<a href="#l18.6"></a><span id="l18.6">     Components.interfaces.calIInternalShallowCopy</span>
<a href="#l18.7"></a><span id="l18.7"> ];</span>
<a href="#l18.8"></a><span id="l18.8"> calEvent.prototype = {</span>
<a href="#l18.9"></a><span id="l18.9">     __proto__: calItemBase.prototype,</span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11">     classID: calEventClassID,</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calEventInterfaces),</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+    QueryInterface: cal.generateQI(calEventInterfaces),</span>
<a href="#l18.14"></a><span id="l18.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l18.15"></a><span id="l18.15">         classID: calEventClassID,</span>
<a href="#l18.16"></a><span id="l18.16">         contractID: &quot;@mozilla.org/calendar/event;1&quot;,</span>
<a href="#l18.17"></a><span id="l18.17">         classDescription: &quot;Calendar Event&quot;,</span>
<a href="#l18.18"></a><span id="l18.18">         interfaces: calEventInterfaces</span>
<a href="#l18.19"></a><span id="l18.19">     }),</span>
<a href="#l18.20"></a><span id="l18.20"> </span>
<a href="#l18.21"></a><span id="l18.21">     cloneShallow: function(aNewParent) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/src/calFreeBusyService.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/src/calFreeBusyService.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1,30 +1,29 @@</span>
<a href="#l19.4"></a><span id="l19.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.5"></a><span id="l19.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.6"></a><span id="l19.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l19.9"></a><span id="l19.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11"> function calFreeBusyListener(numOperations, finalListener) {</span>
<a href="#l19.12"></a><span id="l19.12">     this.mFinalListener = finalListener;</span>
<a href="#l19.13"></a><span id="l19.13">     this.mNumOperations = numOperations;</span>
<a href="#l19.14"></a><span id="l19.14"> </span>
<a href="#l19.15"></a><span id="l19.15">     this.opGroup = new cal.data.OperationGroup(() =&gt; {</span>
<a href="#l19.16"></a><span id="l19.16">         this.notifyResult(null);</span>
<a href="#l19.17"></a><span id="l19.17">     });</span>
<a href="#l19.18"></a><span id="l19.18"> }</span>
<a href="#l19.19"></a><span id="l19.19"> calFreeBusyListener.prototype = {</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIGenericOperationListener]),</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+</span>
<a href="#l19.22"></a><span id="l19.22">     mFinalListener: null,</span>
<a href="#l19.23"></a><span id="l19.23">     mNumOperations: 0,</span>
<a href="#l19.24"></a><span id="l19.24">     opGroup: null,</span>
<a href="#l19.25"></a><span id="l19.25"> </span>
<a href="#l19.26"></a><span id="l19.26" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIGenericOperationListener]),</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineminus">-</span>
<a href="#l19.28"></a><span id="l19.28">     notifyResult: function(result) {</span>
<a href="#l19.29"></a><span id="l19.29">         let listener = this.mFinalListener;</span>
<a href="#l19.30"></a><span id="l19.30">         if (listener) {</span>
<a href="#l19.31"></a><span id="l19.31">             if (!this.opGroup.isPending) {</span>
<a href="#l19.32"></a><span id="l19.32">                 this.mFinalListener = null;</span>
<a href="#l19.33"></a><span id="l19.33">             }</span>
<a href="#l19.34"></a><span id="l19.34">             listener.onResult(this.opGroup, result);</span>
<a href="#l19.35"></a><span id="l19.35">         }</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineat">@@ -49,33 +48,21 @@ calFreeBusyListener.prototype = {</span>
<a href="#l19.37"></a><span id="l19.37">         }</span>
<a href="#l19.38"></a><span id="l19.38">     }</span>
<a href="#l19.39"></a><span id="l19.39"> };</span>
<a href="#l19.40"></a><span id="l19.40"> </span>
<a href="#l19.41"></a><span id="l19.41"> function calFreeBusyService() {</span>
<a href="#l19.42"></a><span id="l19.42">     this.wrappedJSObject = this;</span>
<a href="#l19.43"></a><span id="l19.43">     this.mProviders = new Set();</span>
<a href="#l19.44"></a><span id="l19.44"> }</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineminus">-var calFreeBusyServiceClassID = Components.ID(&quot;{29c56cd5-d36e-453a-acde-0083bd4fe6d3}&quot;);</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineminus">-var calFreeBusyServiceInterfaces = [</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineminus">-    Components.interfaces.calIFreeBusyProvider,</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineminus">-    Components.interfaces.calIFreeBusyService</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineminus">-];</span>
<a href="#l19.50"></a><span id="l19.50"> calFreeBusyService.prototype = {</span>
<a href="#l19.51"></a><span id="l19.51" class="difflineminus">-    mProviders: null,</span>
<a href="#l19.52"></a><span id="l19.52" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIFreeBusyProvider, Ci.calIFreeBusyService]),</span>
<a href="#l19.53"></a><span id="l19.53" class="difflineplus">+    classID: Components.ID(&quot;{29c56cd5-d36e-453a-acde-0083bd4fe6d3}&quot;),</span>
<a href="#l19.54"></a><span id="l19.54"> </span>
<a href="#l19.55"></a><span id="l19.55" class="difflineminus">-    classID: calFreeBusyServiceClassID,</span>
<a href="#l19.56"></a><span id="l19.56" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calFreeBusyServiceInterfaces),</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineminus">-        classID: calFreeBusyServiceClassID,</span>
<a href="#l19.59"></a><span id="l19.59" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/freebusy-service;1&quot;,</span>
<a href="#l19.60"></a><span id="l19.60" class="difflineminus">-        classDescription: &quot;Calendar FreeBusy Service&quot;,</span>
<a href="#l19.61"></a><span id="l19.61" class="difflineminus">-        interfaces: calFreeBusyServiceInterfaces,</span>
<a href="#l19.62"></a><span id="l19.62" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineminus">-    }),</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineplus">+    mProviders: null,</span>
<a href="#l19.65"></a><span id="l19.65"> </span>
<a href="#l19.66"></a><span id="l19.66">     // calIFreeBusyProvider:</span>
<a href="#l19.67"></a><span id="l19.67">     getFreeBusyIntervals: function(aCalId, aRangeStart, aRangeEnd, aBusyTypes, aListener) {</span>
<a href="#l19.68"></a><span id="l19.68">         let groupListener = new calFreeBusyListener(this.mProviders.size, aListener);</span>
<a href="#l19.69"></a><span id="l19.69">         for (let provider of this.mProviders.values()) {</span>
<a href="#l19.70"></a><span id="l19.70">             let operation = provider.getFreeBusyIntervals(aCalId, aRangeStart,</span>
<a href="#l19.71"></a><span id="l19.71">                                                           aRangeEnd,</span>
<a href="#l19.72"></a><span id="l19.72">                                                           aBusyTypes,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/src/calIcsParser.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/src/calIcsParser.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,35 +1,24 @@</span>
<a href="#l20.4"></a><span id="l20.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.5"></a><span id="l20.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.6"></a><span id="l20.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineminus">-</span>
<a href="#l20.10"></a><span id="l20.10"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12"> function calIcsParser() {</span>
<a href="#l20.13"></a><span id="l20.13">     this.wrappedJSObject = this;</span>
<a href="#l20.14"></a><span id="l20.14">     this.mItems = [];</span>
<a href="#l20.15"></a><span id="l20.15">     this.mParentlessItems = [];</span>
<a href="#l20.16"></a><span id="l20.16">     this.mComponents = [];</span>
<a href="#l20.17"></a><span id="l20.17">     this.mProperties = [];</span>
<a href="#l20.18"></a><span id="l20.18"> }</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineminus">-var calIcsParserClassID = Components.ID(&quot;{6fe88047-75b6-4874-80e8-5f5800f14984}&quot;);</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineminus">-var calIcsParserInterfaces = [Components.interfaces.calIIcsParser];</span>
<a href="#l20.21"></a><span id="l20.21"> calIcsParser.prototype = {</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineminus">-    classID: calIcsParserClassID,</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calIcsParserInterfaces),</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineminus">-        classID: calIcsParserClassID,</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/ics-parser;1&quot;,</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineminus">-        classDescription: &quot;Calendar ICS Parser&quot;,</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineminus">-        interfaces: calIcsParserInterfaces,</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.THREADSAFE</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineminus">-    }),</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIIcsParser]),</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+    classID: Components.ID(&quot;{6fe88047-75b6-4874-80e8-5f5800f14984}&quot;),</span>
<a href="#l20.33"></a><span id="l20.33"> </span>
<a href="#l20.34"></a><span id="l20.34">     processIcalComponent: function(rootComp, aAsyncParsing) {</span>
<a href="#l20.35"></a><span id="l20.35">         let calComp;</span>
<a href="#l20.36"></a><span id="l20.36">         // libical returns the vcalendar component if there is just one vcalendar.</span>
<a href="#l20.37"></a><span id="l20.37">         // If there are multiple vcalendars, it returns an xroot component, with</span>
<a href="#l20.38"></a><span id="l20.38">         // vcalendar children. We need to handle both cases.</span>
<a href="#l20.39"></a><span id="l20.39">         if (rootComp) {</span>
<a href="#l20.40"></a><span id="l20.40">             if (rootComp.componentType == &quot;VCALENDAR&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/src/calIcsSerializer.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/src/calIcsSerializer.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -5,27 +5,19 @@</span>
<a href="#l21.4"></a><span id="l21.4"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l21.5"></a><span id="l21.5"> </span>
<a href="#l21.6"></a><span id="l21.6"> function calIcsSerializer() {</span>
<a href="#l21.7"></a><span id="l21.7">     this.wrappedJSObject = this;</span>
<a href="#l21.8"></a><span id="l21.8">     this.mItems = [];</span>
<a href="#l21.9"></a><span id="l21.9">     this.mProperties = [];</span>
<a href="#l21.10"></a><span id="l21.10">     this.mComponents = [];</span>
<a href="#l21.11"></a><span id="l21.11"> }</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-var calIcsSerializerClassID = Components.ID(&quot;{207a6682-8ff1-4203-9160-729ec28c8766}&quot;);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-var calIcsSerializerInterfaces = [Components.interfaces.calIIcsSerializer];</span>
<a href="#l21.14"></a><span id="l21.14"> calIcsSerializer.prototype = {</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-    classID: calIcsSerializerClassID,</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calIcsSerializerInterfaces),</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineminus">-        classID: calIcsSerializerClassID,</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/ics-serializer;1&quot;,</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineminus">-        classDescription: &quot;Calendar ICS Serializer&quot;,</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineminus">-        interfaces: calIcsSerializerInterfaces,</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineminus">-    }),</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIIcsSerializer]),</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineplus">+    classID: Components.ID(&quot;{207a6682-8ff1-4203-9160-729ec28c8766}&quot;),</span>
<a href="#l21.25"></a><span id="l21.25"> </span>
<a href="#l21.26"></a><span id="l21.26">     addItems: function(aItems, aCount) {</span>
<a href="#l21.27"></a><span id="l21.27">         if (aCount &gt; 0) {</span>
<a href="#l21.28"></a><span id="l21.28">             this.mItems = this.mItems.concat(aItems);</span>
<a href="#l21.29"></a><span id="l21.29">         }</span>
<a href="#l21.30"></a><span id="l21.30">     },</span>
<a href="#l21.31"></a><span id="l21.31"> </span>
<a href="#l21.32"></a><span id="l21.32">     addProperty: function(aProperty) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/src/calItipItem.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/src/calItipItem.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -1,37 +1,26 @@</span>
<a href="#l22.4"></a><span id="l22.4" class="difflineminus">-/* -*- Mode: javascript; tab-width: 20; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a href="#l22.5"></a><span id="l22.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.6"></a><span id="l22.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.7"></a><span id="l22.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l22.10"></a><span id="l22.10" class="difflineminus">-</span>
<a href="#l22.11"></a><span id="l22.11"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l22.12"></a><span id="l22.12"> </span>
<a href="#l22.13"></a><span id="l22.13"> /**</span>
<a href="#l22.14"></a><span id="l22.14">  * Constructor of calItipItem object</span>
<a href="#l22.15"></a><span id="l22.15">  */</span>
<a href="#l22.16"></a><span id="l22.16"> function calItipItem() {</span>
<a href="#l22.17"></a><span id="l22.17">     this.wrappedJSObject = this;</span>
<a href="#l22.18"></a><span id="l22.18">     this.mCurrentItemIndex = 0;</span>
<a href="#l22.19"></a><span id="l22.19"> }</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineminus">-var calItipItemClassID = Components.ID(&quot;{f41392ab-dcad-4bad-818f-b3d1631c4d93}&quot;);</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineminus">-var calItipItemInterfaces = [Components.interfaces.calIItipItem];</span>
<a href="#l22.22"></a><span id="l22.22"> calItipItem.prototype = {</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineminus">-    mIsInitialized: false,</span>
<a href="#l22.24"></a><span id="l22.24" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIItipItem]),</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineplus">+    classID: Components.ID(&quot;{f41392ab-dcad-4bad-818f-b3d1631c4d93}&quot;),</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27" class="difflineminus">-    classID: calItipItemClassID,</span>
<a href="#l22.28"></a><span id="l22.28" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calItipItemInterfaces),</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-        classID: calItipItemClassID,</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/itip-item;1&quot;,</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineminus">-        classDescription: &quot;Calendar iTIP item&quot;,</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">-        interfaces: calItipItemInterfaces</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-    }),</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineplus">+    mIsInitialized: false,</span>
<a href="#l22.36"></a><span id="l22.36"> </span>
<a href="#l22.37"></a><span id="l22.37">     mSender: null,</span>
<a href="#l22.38"></a><span id="l22.38">     get sender() {</span>
<a href="#l22.39"></a><span id="l22.39">         return this.mSender;</span>
<a href="#l22.40"></a><span id="l22.40">     },</span>
<a href="#l22.41"></a><span id="l22.41">     set sender(aValue) {</span>
<a href="#l22.42"></a><span id="l22.42">         return (this.mSender = aValue);</span>
<a href="#l22.43"></a><span id="l22.43">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/base/src/calProtocolHandler.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/base/src/calProtocolHandler.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,24 +1,13 @@</span>
<a href="#l23.4"></a><span id="l23.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.5"></a><span id="l23.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.6"></a><span id="l23.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineminus">-</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineminus">-/** Constructor for webcal: protocol handler */</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-function calProtocolHandlerWebcal() {</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-    calProtocolHandler.call(this, &quot;webcal&quot;);</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">-}</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">-</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-/** Constructor for webcals: protocl handler */</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-function calProtocolHandlerWebcals() {</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineminus">-    calProtocolHandler.call(this, &quot;webcals&quot;);</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineminus">-}</span>
<a href="#l23.20"></a><span id="l23.20"> </span>
<a href="#l23.21"></a><span id="l23.21"> /**</span>
<a href="#l23.22"></a><span id="l23.22">  * Generic webcal constructor</span>
<a href="#l23.23"></a><span id="l23.23">  *</span>
<a href="#l23.24"></a><span id="l23.24">  * @param scheme        The scheme to init for (webcal, webcals)</span>
<a href="#l23.25"></a><span id="l23.25">  */</span>
<a href="#l23.26"></a><span id="l23.26"> function calProtocolHandler(scheme) {</span>
<a href="#l23.27"></a><span id="l23.27">     this.scheme = scheme;</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineat">@@ -61,35 +50,29 @@ calProtocolHandler.prototype = {</span>
<a href="#l23.29"></a><span id="l23.29">         channel.originalURI = aUri;</span>
<a href="#l23.30"></a><span id="l23.30">         return channel;</span>
<a href="#l23.31"></a><span id="l23.31">     },</span>
<a href="#l23.32"></a><span id="l23.32"> </span>
<a href="#l23.33"></a><span id="l23.33">     // We are not overriding any special ports</span>
<a href="#l23.34"></a><span id="l23.34">     allowPort: function(aPort, aScheme) { return false; }</span>
<a href="#l23.35"></a><span id="l23.35"> };</span>
<a href="#l23.36"></a><span id="l23.36"> </span>
<a href="#l23.37"></a><span id="l23.37" class="difflineminus">-var calProtocolHandlerWebcalClassID = Components.ID(&quot;{1153c73a-39be-46aa-9ba9-656d188865ca}&quot;);</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-var calProtocolHandlerWebcalInterfaces = [Components.interfaces.nsIProtocolHandler];</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineplus">+/** Constructor for webcal: protocol handler */</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineplus">+function calProtocolHandlerWebcal() {</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineplus">+    calProtocolHandler.call(this, &quot;webcal&quot;);</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineplus">+}</span>
<a href="#l23.43"></a><span id="l23.43"> calProtocolHandlerWebcal.prototype = {</span>
<a href="#l23.44"></a><span id="l23.44">     __proto__: calProtocolHandler.prototype,</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineminus">-    classID: calProtocolHandlerWebcalClassID,</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calProtocolHandlerWebcalInterfaces),</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-        classID: calProtocolHandlerWebcalClassID,</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-        contractID: &quot;@mozilla.org/network/protocol;1?name=webcal&quot;,</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-        classDescription: &quot;Calendar webcal protocal handler&quot;,</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-        interfaces: calProtocolHandlerWebcalInterfaces</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-    }),</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineplus">+</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIProtocolHandler]),</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineplus">+    classID: Components.ID(&quot;{1153c73a-39be-46aa-9ba9-656d188865ca}&quot;),</span>
<a href="#l23.56"></a><span id="l23.56"> };</span>
<a href="#l23.57"></a><span id="l23.57"> </span>
<a href="#l23.58"></a><span id="l23.58" class="difflineminus">-var calProtocolHandlerWebcalsClassID = Components.ID(&quot;{bdf71224-365d-4493-856a-a7e74026f766}&quot;);</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineminus">-var calProtocolHandlerWebcalsInterfaces = [Components.interfaces.nsIProtocolHandler];</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineplus">+/** Constructor for webcals: protocl handler */</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineplus">+function calProtocolHandlerWebcals() {</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineplus">+    calProtocolHandler.call(this, &quot;webcals&quot;);</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineplus">+}</span>
<a href="#l23.64"></a><span id="l23.64"> calProtocolHandlerWebcals.prototype = {</span>
<a href="#l23.65"></a><span id="l23.65">     __proto__: calProtocolHandler.prototype,</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineminus">-    classID: calProtocolHandlerWebcalsClassID,</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calProtocolHandlerWebcalsInterfaces),</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineminus">-        classID: calProtocolHandlerWebcalsClassID,</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-        contractID: &quot;@mozilla.org/network/protocol;1?name=webcals&quot;,</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineminus">-        classDescription: &quot;Calendar webcals protocal handler&quot;,</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineminus">-        interfaces: calProtocolHandlerWebcalsInterfaces</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineminus">-    }),</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineplus">+</span>
<a href="#l23.75"></a><span id="l23.75" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIProtocolHandler]),</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineplus">+    classID: Components.ID(&quot;{bdf71224-365d-4493-856a-a7e74026f766}&quot;),</span>
<a href="#l23.77"></a><span id="l23.77"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/base/src/calRecurrenceDate.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/base/src/calRecurrenceDate.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -5,25 +5,28 @@</span>
<a href="#l24.4"></a><span id="l24.4"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l24.5"></a><span id="l24.5"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l24.6"></a><span id="l24.6"> </span>
<a href="#l24.7"></a><span id="l24.7"> function calRecurrenceDate() {</span>
<a href="#l24.8"></a><span id="l24.8">     this.wrappedJSObject = this;</span>
<a href="#l24.9"></a><span id="l24.9"> }</span>
<a href="#l24.10"></a><span id="l24.10"> </span>
<a href="#l24.11"></a><span id="l24.11"> var calRecurrenceDateClassID = Components.ID(&quot;{806b6423-3aaa-4b26-afa3-de60563e9cec}&quot;);</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-var calRecurrenceDateInterfaces = [Components.interfaces.calIRecurrenceDate];</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+var calRecurrenceDateInterfaces = [</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+    Components.interfaces.calIRecurrenceItem,</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+    Components.interfaces.calIRecurrenceDate</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+];</span>
<a href="#l24.17"></a><span id="l24.17"> calRecurrenceDate.prototype = {</span>
<a href="#l24.18"></a><span id="l24.18">     isMutable: true,</span>
<a href="#l24.19"></a><span id="l24.19"> </span>
<a href="#l24.20"></a><span id="l24.20">     mIsNegative: false,</span>
<a href="#l24.21"></a><span id="l24.21">     mDate: null,</span>
<a href="#l24.22"></a><span id="l24.22"> </span>
<a href="#l24.23"></a><span id="l24.23">     classID: calRecurrenceDateClassID,</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calRecurrenceDateInterfaces),</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+    QueryInterface: cal.generateQI(calRecurrenceDateInterfaces),</span>
<a href="#l24.26"></a><span id="l24.26">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l24.27"></a><span id="l24.27">         classID: calRecurrenceDateClassID,</span>
<a href="#l24.28"></a><span id="l24.28">         contractID: &quot;@mozilla.org/calendar/recurrence-date;1&quot;,</span>
<a href="#l24.29"></a><span id="l24.29">         classDescription: &quot;The date of an occurrence of a recurring item&quot;,</span>
<a href="#l24.30"></a><span id="l24.30">         interfaces: calRecurrenceDateInterfaces</span>
<a href="#l24.31"></a><span id="l24.31">     }),</span>
<a href="#l24.32"></a><span id="l24.32">     makeImmutable: function() {</span>
<a href="#l24.33"></a><span id="l24.33">         this.isMutable = false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -1,52 +1,42 @@</span>
<a href="#l25.4"></a><span id="l25.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.5"></a><span id="l25.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.6"></a><span id="l25.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.7"></a><span id="l25.7"> </span>
<a href="#l25.8"></a><span id="l25.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l25.10"></a><span id="l25.10"> </span>
<a href="#l25.11"></a><span id="l25.11"> function getRidKey(date) {</span>
<a href="#l25.12"></a><span id="l25.12">     if (!date) {</span>
<a href="#l25.13"></a><span id="l25.13">         return null;</span>
<a href="#l25.14"></a><span id="l25.14">     }</span>
<a href="#l25.15"></a><span id="l25.15">     let timezone = date.timezone;</span>
<a href="#l25.16"></a><span id="l25.16">     if (!timezone.isUTC &amp;&amp; !timezone.isFloating) {</span>
<a href="#l25.17"></a><span id="l25.17">         date = date.getInTimezone(cal.dtz.UTC);</span>
<a href="#l25.18"></a><span id="l25.18">     }</span>
<a href="#l25.19"></a><span id="l25.19">     return date.icalString;</span>
<a href="#l25.20"></a><span id="l25.20"> }</span>
<a href="#l25.21"></a><span id="l25.21"> </span>
<a href="#l25.22"></a><span id="l25.22"> function calRecurrenceInfo() {</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+    this.wrappedJSObject = this;</span>
<a href="#l25.24"></a><span id="l25.24">     this.mRecurrenceItems = [];</span>
<a href="#l25.25"></a><span id="l25.25">     this.mExceptionMap = {};</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineminus">-</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineminus">-    this.wrappedJSObject = this;</span>
<a href="#l25.28"></a><span id="l25.28"> }</span>
<a href="#l25.29"></a><span id="l25.29"> </span>
<a href="#l25.30"></a><span id="l25.30" class="difflineminus">-var calRecurrenceInfoClassID = Components.ID(&quot;{04027036-5884-4a30-b4af-f2cad79f6edf}&quot;);</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-var calRecurrenceInfoInterfaces = [Components.interfaces.calIRecurrenceInfo];</span>
<a href="#l25.32"></a><span id="l25.32"> calRecurrenceInfo.prototype = {</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIRecurrenceInfo]),</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+    classID: Components.ID(&quot;{04027036-5884-4a30-b4af-f2cad79f6edf}&quot;),</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+</span>
<a href="#l25.36"></a><span id="l25.36">     mImmutable: false,</span>
<a href="#l25.37"></a><span id="l25.37">     mBaseItem: null,</span>
<a href="#l25.38"></a><span id="l25.38">     mRecurrenceItems: null,</span>
<a href="#l25.39"></a><span id="l25.39">     mPositiveRules: null,</span>
<a href="#l25.40"></a><span id="l25.40">     mNegativeRules: null,</span>
<a href="#l25.41"></a><span id="l25.41">     mExceptionMap: null,</span>
<a href="#l25.42"></a><span id="l25.42"> </span>
<a href="#l25.43"></a><span id="l25.43" class="difflineminus">-    classID: calRecurrenceInfoClassID,</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calRecurrenceInfoInterfaces),</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineminus">-        classID: calRecurrenceInfoClassID,</span>
<a href="#l25.47"></a><span id="l25.47" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/recurrence-info;1&quot;,</span>
<a href="#l25.48"></a><span id="l25.48" class="difflineminus">-        classDescription: &quot;Calendar Recurrence Info&quot;,</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineminus">-        interfaces: calRecurrenceInfoInterfaces,</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineminus">-    }),</span>
<a href="#l25.51"></a><span id="l25.51" class="difflineminus">-</span>
<a href="#l25.52"></a><span id="l25.52">     /**</span>
<a href="#l25.53"></a><span id="l25.53">      * Helpers</span>
<a href="#l25.54"></a><span id="l25.54">      */</span>
<a href="#l25.55"></a><span id="l25.55">     ensureBaseItem: function() {</span>
<a href="#l25.56"></a><span id="l25.56">         if (!this.mBaseItem) {</span>
<a href="#l25.57"></a><span id="l25.57">             throw Components.results.NS_ERROR_NOT_INITIALIZED;</span>
<a href="#l25.58"></a><span id="l25.58">         }</span>
<a href="#l25.59"></a><span id="l25.59">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/base/src/calRelation.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/base/src/calRelation.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1,41 +1,31 @@</span>
<a href="#l26.4"></a><span id="l26.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.5"></a><span id="l26.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.6"></a><span id="l26.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l26.7"></a><span id="l26.7"> </span>
<a href="#l26.8"></a><span id="l26.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineminus">-</span>
<a href="#l26.10"></a><span id="l26.10"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12"> /**</span>
<a href="#l26.13"></a><span id="l26.13">  * calRelation prototype definition</span>
<a href="#l26.14"></a><span id="l26.14">  *</span>
<a href="#l26.15"></a><span id="l26.15">  * @implements calIRelation</span>
<a href="#l26.16"></a><span id="l26.16">  * @constructor</span>
<a href="#l26.17"></a><span id="l26.17">  */</span>
<a href="#l26.18"></a><span id="l26.18"> function calRelation() {</span>
<a href="#l26.19"></a><span id="l26.19">     this.wrappedJSObject = this;</span>
<a href="#l26.20"></a><span id="l26.20">     this.mProperties = new cal.data.PropertyMap();</span>
<a href="#l26.21"></a><span id="l26.21"> }</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineminus">-var calRelationClassID = Components.ID(&quot;{76810fae-abad-4019-917a-08e95d5bbd68}&quot;);</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineminus">-var calRelationInterfaces = [Components.interfaces.calIRelation];</span>
<a href="#l26.24"></a><span id="l26.24"> calRelation.prototype = {</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIRelation]),</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineplus">+    classID: Components.ID(&quot;{76810fae-abad-4019-917a-08e95d5bbd68}&quot;),</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineplus">+</span>
<a href="#l26.28"></a><span id="l26.28">     mType: null,</span>
<a href="#l26.29"></a><span id="l26.29">     mId: null,</span>
<a href="#l26.30"></a><span id="l26.30"> </span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-    classID: calRelationClassID,</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calRelationInterfaces),</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineminus">-        classID: calRelationClassID,</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/relation;1&quot;,</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineminus">-        classDescription: &quot;Calendar Item Relation&quot;,</span>
<a href="#l26.37"></a><span id="l26.37" class="difflineminus">-        interfaces: calRelationInterfaces</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineminus">-    }),</span>
<a href="#l26.39"></a><span id="l26.39" class="difflineminus">-</span>
<a href="#l26.40"></a><span id="l26.40">     /**</span>
<a href="#l26.41"></a><span id="l26.41">      * @see calIRelation</span>
<a href="#l26.42"></a><span id="l26.42">      */</span>
<a href="#l26.43"></a><span id="l26.43"> </span>
<a href="#l26.44"></a><span id="l26.44">     get relType() {</span>
<a href="#l26.45"></a><span id="l26.45">         return this.mType;</span>
<a href="#l26.46"></a><span id="l26.46">     },</span>
<a href="#l26.47"></a><span id="l26.47">     set relType(aType) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/base/src/calSleepMonitor.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/base/src/calSleepMonitor.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1,32 +1,24 @@</span>
<a href="#l27.4"></a><span id="l27.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.5"></a><span id="l27.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.6"></a><span id="l27.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l27.7"></a><span id="l27.7"> </span>
<a href="#l27.8"></a><span id="l27.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l27.9"></a><span id="l27.9"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l27.10"></a><span id="l27.10"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-var calSleepMonitorClassID = Components.ID(&quot;9b987a8d-c2ef-4cb9-9602-1261b4b2f6fa&quot;);</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-var calSleepMonitorInterfaces = [Components.interfaces.nsIObserver];</span>
<a href="#l27.14"></a><span id="l27.14"> </span>
<a href="#l27.15"></a><span id="l27.15"> function calSleepMonitor() {</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+    this.wrappedJSObject = this;</span>
<a href="#l27.17"></a><span id="l27.17"> }</span>
<a href="#l27.18"></a><span id="l27.18"> </span>
<a href="#l27.19"></a><span id="l27.19"> calSleepMonitor.prototype = {</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineminus">-    classID: calSleepMonitorClassID,</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calSleepMonitorInterfaces),</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineminus">-        classID: calSleepMonitorClassID,</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/sleep-monitor;1&quot;,</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineminus">-        classDescription: &quot;Calendar Sleep Monitor&quot;,</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineminus">-        interfaces: calSleepMonitorInterfaces,</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l27.28"></a><span id="l27.28" class="difflineminus">-    }),</span>
<a href="#l27.29"></a><span id="l27.29" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIObserver]),</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineplus">+    classID: Components.ID(&quot;9b987a8d-c2ef-4cb9-9602-1261b4b2f6fa&quot;),</span>
<a href="#l27.31"></a><span id="l27.31"> </span>
<a href="#l27.32"></a><span id="l27.32">     interval: 60000,</span>
<a href="#l27.33"></a><span id="l27.33">     timer: null,</span>
<a href="#l27.34"></a><span id="l27.34">     expected: null,</span>
<a href="#l27.35"></a><span id="l27.35">     tolerance: 1000,</span>
<a href="#l27.36"></a><span id="l27.36"> </span>
<a href="#l27.37"></a><span id="l27.37">     callback: function() {</span>
<a href="#l27.38"></a><span id="l27.38">         let now = Date.now();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/base/src/calStartupService.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/base/src/calStartupService.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,15 +1,14 @@</span>
<a href="#l28.4"></a><span id="l28.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.5"></a><span id="l28.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.6"></a><span id="l28.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l28.7"></a><span id="l28.7"> </span>
<a href="#l28.8"></a><span id="l28.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l28.9"></a><span id="l28.9"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l28.11"></a><span id="l28.11"> ChromeUtils.import(&quot;resource://gre/modules/L10nRegistry.jsm&quot;);</span>
<a href="#l28.12"></a><span id="l28.12"> </span>
<a href="#l28.13"></a><span id="l28.13"> /**</span>
<a href="#l28.14"></a><span id="l28.14">  * Helper function to asynchronously call a certain method on the objects passed</span>
<a href="#l28.15"></a><span id="l28.15">  * in 'services' in order (i.e wait until the first completes before calling the</span>
<a href="#l28.16"></a><span id="l28.16">  * second</span>
<a href="#l28.17"></a><span id="l28.17">  *</span>
<a href="#l28.18"></a><span id="l28.18">  * @param method        The method name to call. Usually startup/shutdown.</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineat">@@ -26,28 +25,19 @@ function callOrderedServices(method, ser</span>
<a href="#l28.20"></a><span id="l28.20">     }</span>
<a href="#l28.21"></a><span id="l28.21"> }</span>
<a href="#l28.22"></a><span id="l28.22"> </span>
<a href="#l28.23"></a><span id="l28.23"> function calStartupService() {</span>
<a href="#l28.24"></a><span id="l28.24">     this.wrappedJSObject = this;</span>
<a href="#l28.25"></a><span id="l28.25">     this.setupObservers();</span>
<a href="#l28.26"></a><span id="l28.26"> }</span>
<a href="#l28.27"></a><span id="l28.27"> </span>
<a href="#l28.28"></a><span id="l28.28" class="difflineminus">-var calStartupServiceInterfaces = [Components.interfaces.nsIObserver];</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineminus">-var calStartupServiceClassID = Components.ID(&quot;{2547331f-34c0-4a4b-b93c-b503538ba6d6}&quot;);</span>
<a href="#l28.30"></a><span id="l28.30"> calStartupService.prototype = {</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calStartupServiceInterfaces),</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineminus">-    classID: calStartupServiceClassID,</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/startup-service;1&quot;,</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineminus">-        classDescription: &quot;Calendar Startup Service&quot;,</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineminus">-        classID: calStartupServiceClassID,</span>
<a href="#l28.37"></a><span id="l28.37" class="difflineminus">-        interfaces: calStartupServiceInterfaces,</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineminus">-    }),</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIObserver]),</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineplus">+    classID: Components.ID(&quot;{2547331f-34c0-4a4b-b93c-b503538ba6d6}&quot;),</span>
<a href="#l28.42"></a><span id="l28.42"> </span>
<a href="#l28.43"></a><span id="l28.43">     // Startup Service Methods</span>
<a href="#l28.44"></a><span id="l28.44"> </span>
<a href="#l28.45"></a><span id="l28.45">     /**</span>
<a href="#l28.46"></a><span id="l28.46">      * Sets up the needed observers for noticing startup/shutdown</span>
<a href="#l28.47"></a><span id="l28.47">      */</span>
<a href="#l28.48"></a><span id="l28.48">     setupObservers: function() {</span>
<a href="#l28.49"></a><span id="l28.49">         Services.obs.addObserver(this, &quot;profile-after-change&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/base/src/calTimezone.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/base/src/calTimezone.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -1,32 +1,23 @@</span>
<a href="#l29.4"></a><span id="l29.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.5"></a><span id="l29.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.6"></a><span id="l29.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l29.9"></a><span id="l29.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l29.10"></a><span id="l29.10"> ChromeUtils.import(&quot;resource://calendar/modules/ical.js&quot;);</span>
<a href="#l29.11"></a><span id="l29.11"> </span>
<a href="#l29.12"></a><span id="l29.12"> function calICALJSTimezone(innerObject) {</span>
<a href="#l29.13"></a><span id="l29.13">     this.innerObject = innerObject || new ICAL.Timezone();</span>
<a href="#l29.14"></a><span id="l29.14">     this.wrappedJSObject = this;</span>
<a href="#l29.15"></a><span id="l29.15"> }</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17" class="difflineminus">-var calTimezoneInterfaces = [Components.interfaces.calITimezone];</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineminus">-var calTimezoneClassID = Components.ID(&quot;{6702eb17-a968-4b43-b562-0d0c5f8e9eb5}&quot;);</span>
<a href="#l29.19"></a><span id="l29.19"> calICALJSTimezone.prototype = {</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calTimezoneInterfaces),</span>
<a href="#l29.21"></a><span id="l29.21" class="difflineminus">-    classID: calTimezoneClassID,</span>
<a href="#l29.22"></a><span id="l29.22" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/timezone;1&quot;,</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineminus">-        classDescription: &quot;Calendar Timezone&quot;,</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineminus">-        classID: calTimezoneClassID,</span>
<a href="#l29.26"></a><span id="l29.26" class="difflineminus">-        interfaces: calTimezoneInterfaces</span>
<a href="#l29.27"></a><span id="l29.27" class="difflineminus">-    }),</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calITimezone]),</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+    classID: Components.ID(&quot;{6702eb17-a968-4b43-b562-0d0c5f8e9eb5}&quot;),</span>
<a href="#l29.30"></a><span id="l29.30"> </span>
<a href="#l29.31"></a><span id="l29.31">     innerObject: null,</span>
<a href="#l29.32"></a><span id="l29.32"> </span>
<a href="#l29.33"></a><span id="l29.33">     get provider() { return cal.getTimezoneService(); },</span>
<a href="#l29.34"></a><span id="l29.34">     get icalComponent() {</span>
<a href="#l29.35"></a><span id="l29.35">         let innerComp = this.innerObject.component;</span>
<a href="#l29.36"></a><span id="l29.36">         let comp = null;</span>
<a href="#l29.37"></a><span id="l29.37">         if (innerComp) {</span>
<a href="#l29.38"></a><span id="l29.38" class="difflineat">@@ -63,24 +54,18 @@ function calLibicalTimezone(tzid, compon</span>
<a href="#l29.39"></a><span id="l29.39">     this.tzid = tzid;</span>
<a href="#l29.40"></a><span id="l29.40">     this.mComponent = component;</span>
<a href="#l29.41"></a><span id="l29.41">     this.mUTC = false;</span>
<a href="#l29.42"></a><span id="l29.42">     this.isFloating = false;</span>
<a href="#l29.43"></a><span id="l29.43">     this.latitude = latitude;</span>
<a href="#l29.44"></a><span id="l29.44">     this.longitude = longitude;</span>
<a href="#l29.45"></a><span id="l29.45"> }</span>
<a href="#l29.46"></a><span id="l29.46"> calLibicalTimezone.prototype = {</span>
<a href="#l29.47"></a><span id="l29.47" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calTimezoneInterfaces),</span>
<a href="#l29.48"></a><span id="l29.48" class="difflineminus">-    classID: calTimezoneClassID,</span>
<a href="#l29.49"></a><span id="l29.49" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l29.50"></a><span id="l29.50" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/timezone;1&quot;,</span>
<a href="#l29.51"></a><span id="l29.51" class="difflineminus">-        classDescription: &quot;Calendar Timezone&quot;,</span>
<a href="#l29.52"></a><span id="l29.52" class="difflineminus">-        classID: calTimezoneClassID,</span>
<a href="#l29.53"></a><span id="l29.53" class="difflineminus">-        interfaces: calTimezoneInterfaces</span>
<a href="#l29.54"></a><span id="l29.54" class="difflineminus">-    }),</span>
<a href="#l29.55"></a><span id="l29.55" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calITimezone]),</span>
<a href="#l29.56"></a><span id="l29.56" class="difflineplus">+    classID: Components.ID(&quot;{6702eb17-a968-4b43-b562-0d0c5f8e9eb5}&quot;),</span>
<a href="#l29.57"></a><span id="l29.57"> </span>
<a href="#l29.58"></a><span id="l29.58">     toString: function() {</span>
<a href="#l29.59"></a><span id="l29.59">         return (this.icalComponent ? this.icalComponent.toString() : this.tzid);</span>
<a href="#l29.60"></a><span id="l29.60">     },</span>
<a href="#l29.61"></a><span id="l29.61"> </span>
<a href="#l29.62"></a><span id="l29.62">     get isUTC() { return this.mUTC; },</span>
<a href="#l29.63"></a><span id="l29.63"> </span>
<a href="#l29.64"></a><span id="l29.64">     get icalComponent() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/base/src/calTimezoneService.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/base/src/calTimezoneService.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -43,17 +43,17 @@ var calTimezoneServiceInterfaces = [</span>
<a href="#l30.4"></a><span id="l30.4"> ];</span>
<a href="#l30.5"></a><span id="l30.5"> calTimezoneService.prototype = {</span>
<a href="#l30.6"></a><span id="l30.6">     mDefaultTimezone: null,</span>
<a href="#l30.7"></a><span id="l30.7">     mHasSetupObservers: false,</span>
<a href="#l30.8"></a><span id="l30.8">     mVersion: null,</span>
<a href="#l30.9"></a><span id="l30.9">     mZones: null,</span>
<a href="#l30.10"></a><span id="l30.10"> </span>
<a href="#l30.11"></a><span id="l30.11">     classID: calTimezoneServiceClassID,</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calTimezoneServiceInterfaces),</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+    QueryInterface: cal.generateQI(calTimezoneServiceInterfaces),</span>
<a href="#l30.14"></a><span id="l30.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l30.15"></a><span id="l30.15">         classID: calTimezoneServiceClassID,</span>
<a href="#l30.16"></a><span id="l30.16">         contractID: &quot;@mozilla.org/calendar/timezone-service;1&quot;,</span>
<a href="#l30.17"></a><span id="l30.17">         classDescription: &quot;Calendar Timezone Service&quot;,</span>
<a href="#l30.18"></a><span id="l30.18">         interfaces: calTimezoneServiceInterfaces,</span>
<a href="#l30.19"></a><span id="l30.19">         flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l30.20"></a><span id="l30.20">     }),</span>
<a href="#l30.21"></a><span id="l30.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/base/src/calTodo.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/base/src/calTodo.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -25,17 +25,17 @@ var calTodoInterfaces = [</span>
<a href="#l31.4"></a><span id="l31.4">     Components.interfaces.calIItemBase,</span>
<a href="#l31.5"></a><span id="l31.5">     Components.interfaces.calITodo,</span>
<a href="#l31.6"></a><span id="l31.6">     Components.interfaces.calIInternalShallowCopy</span>
<a href="#l31.7"></a><span id="l31.7"> ];</span>
<a href="#l31.8"></a><span id="l31.8"> calTodo.prototype = {</span>
<a href="#l31.9"></a><span id="l31.9">     __proto__: calItemBase.prototype,</span>
<a href="#l31.10"></a><span id="l31.10"> </span>
<a href="#l31.11"></a><span id="l31.11">     classID: calTodoClassID,</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calTodoInterfaces),</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+    QueryInterface: cal.generateQI(calTodoInterfaces),</span>
<a href="#l31.14"></a><span id="l31.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l31.15"></a><span id="l31.15">         classID: calTodoClassID,</span>
<a href="#l31.16"></a><span id="l31.16">         contractID: &quot;@mozilla.org/calendar/todo;1&quot;,</span>
<a href="#l31.17"></a><span id="l31.17">         classDescription: &quot;Calendar Todo&quot;,</span>
<a href="#l31.18"></a><span id="l31.18">         interfaces: calTodoInterfaces,</span>
<a href="#l31.19"></a><span id="l31.19">     }),</span>
<a href="#l31.20"></a><span id="l31.20"> </span>
<a href="#l31.21"></a><span id="l31.21">     cloneShallow: function(aNewParent) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/base/src/calTransactionManager.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/base/src/calTransactionManager.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,37 +1,26 @@</span>
<a href="#l32.4"></a><span id="l32.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.5"></a><span id="l32.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.6"></a><span id="l32.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.7"></a><span id="l32.7"> </span>
<a href="#l32.8"></a><span id="l32.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l32.10"></a><span id="l32.10"> </span>
<a href="#l32.11"></a><span id="l32.11"> function calTransactionManager() {</span>
<a href="#l32.12"></a><span id="l32.12">     this.wrappedJSObject = this;</span>
<a href="#l32.13"></a><span id="l32.13">     if (!this.transactionManager) {</span>
<a href="#l32.14"></a><span id="l32.14">         this.transactionManager =</span>
<a href="#l32.15"></a><span id="l32.15">             Components.classes[&quot;@mozilla.org/transactionmanager;1&quot;]</span>
<a href="#l32.16"></a><span id="l32.16">                       .createInstance(Components.interfaces.nsITransactionManager);</span>
<a href="#l32.17"></a><span id="l32.17">     }</span>
<a href="#l32.18"></a><span id="l32.18"> }</span>
<a href="#l32.19"></a><span id="l32.19"> </span>
<a href="#l32.20"></a><span id="l32.20" class="difflineminus">-var calTransactionManagerClassID = Components.ID(&quot;{1d529847-d292-4222-b066-b8b17a794d62}&quot;);</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineminus">-var calTransactionManagerInterfaces = [Components.interfaces.calITransactionManager];</span>
<a href="#l32.22"></a><span id="l32.22"> calTransactionManager.prototype = {</span>
<a href="#l32.23"></a><span id="l32.23" class="difflineminus">-</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineminus">-    classID: calTransactionManagerClassID,</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calTransactionManagerInterfaces),</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l32.27"></a><span id="l32.27" class="difflineminus">-        classID: calTransactionManagerClassID,</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineminus">-        classDescription: &quot;Calendar Transaction Manager&quot;,</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineminus">-        contractID: &quot;mozilla.org/calendar/transactionmanager;1&quot;,</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineminus">-        interfaces: calTransactionManagerInterfaces,</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineminus">-    }),</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calITransactionManager]),</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineplus">+    classID: Components.ID(&quot;{1d529847-d292-4222-b066-b8b17a794d62}&quot;),</span>
<a href="#l32.35"></a><span id="l32.35"> </span>
<a href="#l32.36"></a><span id="l32.36">     transactionManager: null,</span>
<a href="#l32.37"></a><span id="l32.37">     createAndCommitTxn: function(aAction, aItem, aCalendar, aOldItem, aListener, aExtResponse) {</span>
<a href="#l32.38"></a><span id="l32.38">         let txn = new calTransaction(aAction,</span>
<a href="#l32.39"></a><span id="l32.39">                                      aItem,</span>
<a href="#l32.40"></a><span id="l32.40">                                      aCalendar,</span>
<a href="#l32.41"></a><span id="l32.41">                                      aOldItem,</span>
<a href="#l32.42"></a><span id="l32.42">                                      aListener,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/base/src/calWeekInfoService.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/base/src/calWeekInfoService.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1,31 +1,21 @@</span>
<a href="#l33.4"></a><span id="l33.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.5"></a><span id="l33.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l33.6"></a><span id="l33.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l33.9"></a><span id="l33.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l33.10"></a><span id="l33.10"> ChromeUtils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12"> function calWeekInfoService() {</span>
<a href="#l33.13"></a><span id="l33.13">     this.wrappedJSObject = this;</span>
<a href="#l33.14"></a><span id="l33.14"> }</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-var calWeekInfoServiceClassID = Components.ID(&quot;{6877bbdd-f336-46f5-98ce-fe86d0285cc1}&quot;);</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineminus">-var calWeekInfoServiceInterfaces = [Components.interfaces.calIWeekInfoService];</span>
<a href="#l33.17"></a><span id="l33.17"> calWeekInfoService.prototype = {</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineminus">-    classID: calWeekInfoServiceClassID,</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calWeekInfoServiceInterfaces),</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineminus">-        classID: calWeekInfoServiceClassID,</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/weekinfo-service;1&quot;,</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineminus">-        classDescription: &quot;Calendar WeekInfo Service&quot;,</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineminus">-        interfaces: calWeekInfoServiceInterfaces,</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineminus">-        flags: Components.interfaces.nsIClassInfo.SINGLETON</span>
<a href="#l33.26"></a><span id="l33.26" class="difflineminus">-    }),</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIWeekInfoService]),</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineplus">+    classID: Components.ID(&quot;{6877bbdd-f336-46f5-98ce-fe86d0285cc1}&quot;),</span>
<a href="#l33.29"></a><span id="l33.29"> </span>
<a href="#l33.30"></a><span id="l33.30">     // calIWeekInfoService:</span>
<a href="#l33.31"></a><span id="l33.31">     getWeekTitle: function(aDateTime) {</span>
<a href="#l33.32"></a><span id="l33.32">         /**</span>
<a href="#l33.33"></a><span id="l33.33">          * This implementation is based on the ISO 8601 standard.</span>
<a href="#l33.34"></a><span id="l33.34">          * ISO 8601 defines week one as the first week with at least 4</span>
<a href="#l33.35"></a><span id="l33.35">          * days, and defines Monday as the first day of the week.</span>
<a href="#l33.36"></a><span id="l33.36">          * Equivalently, the week one is the week with the first Thursday.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/import-export/calHtmlExport.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/import-export/calHtmlExport.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,42 +1,31 @@</span>
<a href="#l34.4"></a><span id="l34.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.5"></a><span id="l34.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.6"></a><span id="l34.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l34.7"></a><span id="l34.7"> </span>
<a href="#l34.8"></a><span id="l34.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l34.9"></a><span id="l34.9" class="difflineminus">-</span>
<a href="#l34.10"></a><span id="l34.10"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l34.11"></a><span id="l34.11"> </span>
<a href="#l34.12"></a><span id="l34.12"> /**</span>
<a href="#l34.13"></a><span id="l34.13">  * HTML Export Plugin</span>
<a href="#l34.14"></a><span id="l34.14">  */</span>
<a href="#l34.15"></a><span id="l34.15"> function calHtmlExporter() {</span>
<a href="#l34.16"></a><span id="l34.16">     this.wrappedJSObject = this;</span>
<a href="#l34.17"></a><span id="l34.17"> }</span>
<a href="#l34.18"></a><span id="l34.18"> </span>
<a href="#l34.19"></a><span id="l34.19" class="difflineminus">-var calHtmlExporterClassID = Components.ID(&quot;{72d9ab35-9b1b-442a-8cd0-ae49f00b159b}&quot;);</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineminus">-var calHtmlExporterInterfaces = [Components.interfaces.calIExporter];</span>
<a href="#l34.21"></a><span id="l34.21"> calHtmlExporter.prototype = {</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineminus">-    classID: calHtmlExporterClassID,</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calHtmlExporterInterfaces),</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineminus">-</span>
<a href="#l34.25"></a><span id="l34.25" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l34.26"></a><span id="l34.26" class="difflineminus">-        classID: calHtmlExporterClassID,</span>
<a href="#l34.27"></a><span id="l34.27" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/export;1?type=html&quot;,</span>
<a href="#l34.28"></a><span id="l34.28" class="difflineminus">-        classDescription: &quot;Calendar HTML Exporter&quot;,</span>
<a href="#l34.29"></a><span id="l34.29" class="difflineminus">-        interfaces: calHtmlExporterInterfaces</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineminus">-    }),</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIExporter]),</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+    classID: Components.ID(&quot;{72d9ab35-9b1b-442a-8cd0-ae49f00b159b}&quot;),</span>
<a href="#l34.33"></a><span id="l34.33"> </span>
<a href="#l34.34"></a><span id="l34.34">     getFileTypes: function(aCount) {</span>
<a href="#l34.35"></a><span id="l34.35">         aCount.value = 1;</span>
<a href="#l34.36"></a><span id="l34.36">         let wildmat = &quot;*.html; *.htm&quot;;</span>
<a href="#l34.37"></a><span id="l34.37">         let label = cal.l10n.getCalString(&quot;filterHtml&quot;, [wildmat]);</span>
<a href="#l34.38"></a><span id="l34.38">         return [{</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineminus">-            QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIFileType]),</span>
<a href="#l34.40"></a><span id="l34.40" class="difflineplus">+            QueryInterface: ChromeUtils.generateQI([Ci.calIFileType]),</span>
<a href="#l34.41"></a><span id="l34.41">             defaultExtension: &quot;html&quot;,</span>
<a href="#l34.42"></a><span id="l34.42">             extensionFilter: wildmat,</span>
<a href="#l34.43"></a><span id="l34.43">             description: label</span>
<a href="#l34.44"></a><span id="l34.44">         }];</span>
<a href="#l34.45"></a><span id="l34.45">     },</span>
<a href="#l34.46"></a><span id="l34.46"> </span>
<a href="#l34.47"></a><span id="l34.47">     exportToStream: function(aStream, aCount, aItems, aTitle) {</span>
<a href="#l34.48"></a><span id="l34.48">         let document = cal.xml.parseFile(&quot;chrome://calendar-common/skin/printing/calHtmlExport.html&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/import-export/calIcsImportExport.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/import-export/calIcsImportExport.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,74 +1,56 @@</span>
<a href="#l35.4"></a><span id="l35.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.6"></a><span id="l35.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l35.9"></a><span id="l35.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l35.10"></a><span id="l35.10"> </span>
<a href="#l35.11"></a><span id="l35.11"> /**</span>
<a href="#l35.12"></a><span id="l35.12">  * ICS Import and Export Plugin</span>
<a href="#l35.13"></a><span id="l35.13">  */</span>
<a href="#l35.14"></a><span id="l35.14"> </span>
<a href="#l35.15"></a><span id="l35.15"> // Shared functions</span>
<a href="#l35.16"></a><span id="l35.16"> function getIcsFileTypes(aCount) {</span>
<a href="#l35.17"></a><span id="l35.17">     aCount.value = 1;</span>
<a href="#l35.18"></a><span id="l35.18">     return [{</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineminus">-        QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIFileType]),</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineplus">+        QueryInterface: ChromeUtils.generateQI([Ci.calIFileType]),</span>
<a href="#l35.21"></a><span id="l35.21">         defaultExtension: &quot;ics&quot;,</span>
<a href="#l35.22"></a><span id="l35.22">         extensionFilter: &quot;*.ics&quot;,</span>
<a href="#l35.23"></a><span id="l35.23">         description: cal.l10n.getCalString(&quot;filterIcs&quot;, [&quot;*.ics&quot;])</span>
<a href="#l35.24"></a><span id="l35.24">     }];</span>
<a href="#l35.25"></a><span id="l35.25"> }</span>
<a href="#l35.26"></a><span id="l35.26"> </span>
<a href="#l35.27"></a><span id="l35.27"> // Importer</span>
<a href="#l35.28"></a><span id="l35.28"> function calIcsImporter() {</span>
<a href="#l35.29"></a><span id="l35.29">     this.wrappedJSObject = this;</span>
<a href="#l35.30"></a><span id="l35.30"> }</span>
<a href="#l35.31"></a><span id="l35.31"> </span>
<a href="#l35.32"></a><span id="l35.32" class="difflineminus">-var calIcsImporterClassID = Components.ID(&quot;{1e3e33dc-445a-49de-b2b6-15b2a050bb9d}&quot;);</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineminus">-var calIcsImporterInterfaces = [Components.interfaces.calIImporter];</span>
<a href="#l35.34"></a><span id="l35.34"> calIcsImporter.prototype = {</span>
<a href="#l35.35"></a><span id="l35.35" class="difflineminus">-    classID: calIcsImporterClassID,</span>
<a href="#l35.36"></a><span id="l35.36" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calIcsImporterInterfaces),</span>
<a href="#l35.37"></a><span id="l35.37" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l35.38"></a><span id="l35.38" class="difflineminus">-        classID: calIcsImporterClassID,</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/import;1?type=ics&quot;,</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineminus">-        classDescription: &quot;Calendar ICS Importer&quot;,</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineminus">-        interfaces: calIcsImporterInterfaces</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineminus">-    }),</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIImporter]),</span>
<a href="#l35.44"></a><span id="l35.44" class="difflineplus">+    classID: Components.ID(&quot;{1e3e33dc-445a-49de-b2b6-15b2a050bb9d}&quot;),</span>
<a href="#l35.45"></a><span id="l35.45"> </span>
<a href="#l35.46"></a><span id="l35.46">     getFileTypes: getIcsFileTypes,</span>
<a href="#l35.47"></a><span id="l35.47"> </span>
<a href="#l35.48"></a><span id="l35.48">     importFromStream: function(aStream, aCount) {</span>
<a href="#l35.49"></a><span id="l35.49">         let parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l35.50"></a><span id="l35.50">                                .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l35.51"></a><span id="l35.51">         parser.parseFromStream(aStream, null);</span>
<a href="#l35.52"></a><span id="l35.52">         return parser.getItems(aCount);</span>
<a href="#l35.53"></a><span id="l35.53">     }</span>
<a href="#l35.54"></a><span id="l35.54"> };</span>
<a href="#l35.55"></a><span id="l35.55"> </span>
<a href="#l35.56"></a><span id="l35.56"> // Exporter</span>
<a href="#l35.57"></a><span id="l35.57"> function calIcsExporter() {</span>
<a href="#l35.58"></a><span id="l35.58">     this.wrappedJSObject = this;</span>
<a href="#l35.59"></a><span id="l35.59"> }</span>
<a href="#l35.60"></a><span id="l35.60"> </span>
<a href="#l35.61"></a><span id="l35.61" class="difflineminus">-var calIcsExporterClassID = Components.ID(&quot;{a6a524ce-adff-4a0f-bb7d-d1aaad4adc60}&quot;);</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineminus">-var calIcsExporterInterfaces = [Components.interfaces.calIExporter];</span>
<a href="#l35.63"></a><span id="l35.63"> calIcsExporter.prototype = {</span>
<a href="#l35.64"></a><span id="l35.64" class="difflineminus">-    classID: calIcsExporterClassID,</span>
<a href="#l35.65"></a><span id="l35.65" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calIcsExporterInterfaces),</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineminus">-</span>
<a href="#l35.67"></a><span id="l35.67" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l35.68"></a><span id="l35.68" class="difflineminus">-        classID: calIcsExporterClassID,</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/export;1?type=ics&quot;,</span>
<a href="#l35.70"></a><span id="l35.70" class="difflineminus">-        classDescription: &quot;Calendar ICS Exporter&quot;,</span>
<a href="#l35.71"></a><span id="l35.71" class="difflineminus">-        interfaces: calIcsExporterInterfaces</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineminus">-    }),</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIExporter]),</span>
<a href="#l35.74"></a><span id="l35.74" class="difflineplus">+    classID: Components.ID(&quot;{a6a524ce-adff-4a0f-bb7d-d1aaad4adc60}&quot;),</span>
<a href="#l35.75"></a><span id="l35.75"> </span>
<a href="#l35.76"></a><span id="l35.76">     getFileTypes: getIcsFileTypes,</span>
<a href="#l35.77"></a><span id="l35.77"> </span>
<a href="#l35.78"></a><span id="l35.78">     exportToStream: function(aStream, aCount, aItems) {</span>
<a href="#l35.79"></a><span id="l35.79">         let serializer = Components.classes[&quot;@mozilla.org/calendar/ics-serializer;1&quot;]</span>
<a href="#l35.80"></a><span id="l35.80">                                    .createInstance(Components.interfaces.calIIcsSerializer);</span>
<a href="#l35.81"></a><span id="l35.81">         serializer.addItems(aItems, aItems.length);</span>
<a href="#l35.82"></a><span id="l35.82">         serializer.serializeToStream(aStream);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/import-export/calListFormatter.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/import-export/calListFormatter.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,34 +1,24 @@</span>
<a href="#l36.4"></a><span id="l36.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l36.5"></a><span id="l36.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l36.6"></a><span id="l36.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l36.9"></a><span id="l36.9"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l36.10"></a><span id="l36.10"> </span>
<a href="#l36.11"></a><span id="l36.11"> /**</span>
<a href="#l36.12"></a><span id="l36.12">  * A thin wrapper around the html list exporter for the list print format.</span>
<a href="#l36.13"></a><span id="l36.13">  */</span>
<a href="#l36.14"></a><span id="l36.14"> function calListFormatter() {</span>
<a href="#l36.15"></a><span id="l36.15">     this.wrappedJSObject = this;</span>
<a href="#l36.16"></a><span id="l36.16"> }</span>
<a href="#l36.17"></a><span id="l36.17"> </span>
<a href="#l36.18"></a><span id="l36.18" class="difflineminus">-var calListFormatterClassID = Components.ID(&quot;{9ae04413-fee3-45b9-8bbb-1eb39a4cbd1b}&quot;);</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineminus">-var calListFormatterInterfaces = [Components.interfaces.calIPrintFormatter];</span>
<a href="#l36.20"></a><span id="l36.20"> calListFormatter.prototype = {</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineminus">-    classID: calListFormatterClassID,</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calListFormatterInterfaces),</span>
<a href="#l36.23"></a><span id="l36.23" class="difflineminus">-</span>
<a href="#l36.24"></a><span id="l36.24" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l36.25"></a><span id="l36.25" class="difflineminus">-        classID: calListFormatterClassID,</span>
<a href="#l36.26"></a><span id="l36.26" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/printformatter;1?type=list&quot;,</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineminus">-        classDescription: &quot;Calendar List Print Formatter&quot;,</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineminus">-        interfaces: calListFormatterInterfaces</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineminus">-    }),</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIPrintFormatter]),</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineplus">+    classID: Components.ID(&quot;{9ae04413-fee3-45b9-8bbb-1eb39a4cbd1b}&quot;),</span>
<a href="#l36.32"></a><span id="l36.32"> </span>
<a href="#l36.33"></a><span id="l36.33">     get name() { return cal.l10n.getCalString(&quot;formatListName&quot;); },</span>
<a href="#l36.34"></a><span id="l36.34"> </span>
<a href="#l36.35"></a><span id="l36.35">     formatToHtml: function(aStream, aStart, aEnd, aCount, aItems, aTitle) {</span>
<a href="#l36.36"></a><span id="l36.36">         let htmlexporter = Components.classes[&quot;@mozilla.org/calendar/export;1?type=htmllist&quot;]</span>
<a href="#l36.37"></a><span id="l36.37">                                      .createInstance(Components.interfaces.calIExporter);</span>
<a href="#l36.38"></a><span id="l36.38">         htmlexporter.exportToStream(aStream, aCount, aItems, aTitle);</span>
<a href="#l36.39"></a><span id="l36.39">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/import-export/calMonthGridPrinter.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/import-export/calMonthGridPrinter.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -1,36 +1,25 @@</span>
<a href="#l37.4"></a><span id="l37.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l37.5"></a><span id="l37.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l37.6"></a><span id="l37.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l37.7"></a><span id="l37.7"> </span>
<a href="#l37.8"></a><span id="l37.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l37.9"></a><span id="l37.9"> ChromeUtils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l37.10"></a><span id="l37.10" class="difflineminus">-</span>
<a href="#l37.11"></a><span id="l37.11"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l37.12"></a><span id="l37.12"> </span>
<a href="#l37.13"></a><span id="l37.13"> /**</span>
<a href="#l37.14"></a><span id="l37.14">  * Prints a rough month-grid of events/tasks</span>
<a href="#l37.15"></a><span id="l37.15">  */</span>
<a href="#l37.16"></a><span id="l37.16"> function calMonthPrinter() {</span>
<a href="#l37.17"></a><span id="l37.17">     this.wrappedJSObject = this;</span>
<a href="#l37.18"></a><span id="l37.18"> }</span>
<a href="#l37.19"></a><span id="l37.19"> </span>
<a href="#l37.20"></a><span id="l37.20" class="difflineminus">-var calMonthPrinterClassID = Components.ID(&quot;{f42d5132-92c4-487b-b5c8-38bf292d74c1}&quot;);</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineminus">-var calMonthPrinterInterfaces = [Components.interfaces.calIPrintFormatter];</span>
<a href="#l37.22"></a><span id="l37.22"> calMonthPrinter.prototype = {</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineminus">-    classID: calMonthPrinterClassID,</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calMonthPrinterInterfaces),</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineminus">-</span>
<a href="#l37.26"></a><span id="l37.26" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l37.27"></a><span id="l37.27" class="difflineminus">-        classID: calMonthPrinterClassID,</span>
<a href="#l37.28"></a><span id="l37.28" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/printformatter;1?type=monthgrid&quot;,</span>
<a href="#l37.29"></a><span id="l37.29" class="difflineminus">-        classDescription: &quot;Calendar Month Grid Print Formatter&quot;,</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineminus">-        interfaces: calMonthPrinterInterfaces</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-    }),</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIPrintFormatter]),</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineplus">+    classID: Components.ID(&quot;{f42d5132-92c4-487b-b5c8-38bf292d74c1}&quot;),</span>
<a href="#l37.34"></a><span id="l37.34"> </span>
<a href="#l37.35"></a><span id="l37.35">     get name() { return cal.l10n.getCalString(&quot;monthPrinterName&quot;); },</span>
<a href="#l37.36"></a><span id="l37.36"> </span>
<a href="#l37.37"></a><span id="l37.37">     formatToHtml: function(aStream, aStart, aEnd, aCount, aItems, aTitle) {</span>
<a href="#l37.38"></a><span id="l37.38">         let document = cal.xml.parseFile(&quot;chrome://calendar-common/skin/printing/calMonthGridPrinter.html&quot;);</span>
<a href="#l37.39"></a><span id="l37.39">         let defaultTimezone = cal.dtz.defaultTimezone;</span>
<a href="#l37.40"></a><span id="l37.40"> </span>
<a href="#l37.41"></a><span id="l37.41">         // Set page title</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l38.4"></a><span id="l38.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l38.5"></a><span id="l38.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l38.6"></a><span id="l38.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l38.7"></a><span id="l38.7"> </span>
<a href="#l38.8"></a><span id="l38.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l38.9"></a><span id="l38.9" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l38.10"></a><span id="l38.10"> ChromeUtils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l38.11"></a><span id="l38.11"> </span>
<a href="#l38.12"></a><span id="l38.12"> var localeEn = {</span>
<a href="#l38.13"></a><span id="l38.13">     headTitle:       &quot;Subject&quot;,</span>
<a href="#l38.14"></a><span id="l38.14">     headStartDate:   &quot;Start Date&quot;,</span>
<a href="#l38.15"></a><span id="l38.15">     headStartTime:   &quot;Start Time&quot;,</span>
<a href="#l38.16"></a><span id="l38.16">     headEndDate:     &quot;End Date&quot;,</span>
<a href="#l38.17"></a><span id="l38.17">     headEndTime:     &quot;End Time&quot;,</span>
<a href="#l38.18"></a><span id="l38.18" class="difflineat">@@ -85,27 +84,19 @@ function getOutlookCsvFileTypes(aCount) </span>
<a href="#l38.19"></a><span id="l38.19">         description: label</span>
<a href="#l38.20"></a><span id="l38.20">     }];</span>
<a href="#l38.21"></a><span id="l38.21"> }</span>
<a href="#l38.22"></a><span id="l38.22"> </span>
<a href="#l38.23"></a><span id="l38.23"> // Importer</span>
<a href="#l38.24"></a><span id="l38.24"> function calOutlookCSVImporter() {</span>
<a href="#l38.25"></a><span id="l38.25">     this.wrappedJSObject = this;</span>
<a href="#l38.26"></a><span id="l38.26"> }</span>
<a href="#l38.27"></a><span id="l38.27" class="difflineminus">-var calOutlookCSVImporterClassID = Components.ID(&quot;{64a5d17a-0497-48c5-b54f-72b15c9e9a14}&quot;);</span>
<a href="#l38.28"></a><span id="l38.28" class="difflineminus">-var calOutlookCSVImporterInterfaces = [Components.interfaces.calIImporter];</span>
<a href="#l38.29"></a><span id="l38.29"> calOutlookCSVImporter.prototype = {</span>
<a href="#l38.30"></a><span id="l38.30" class="difflineminus">-    classID: calOutlookCSVImporterClassID,</span>
<a href="#l38.31"></a><span id="l38.31" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calOutlookCSVImporterInterfaces),</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l38.33"></a><span id="l38.33" class="difflineminus">-        classID: calOutlookCSVImporterClassID,</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/import;1?type=csv&quot;,</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineminus">-        classDescription: &quot;Calendar Outlook CSV Importer&quot;,</span>
<a href="#l38.36"></a><span id="l38.36" class="difflineminus">-        interfaces: calOutlookCSVImporterInterfaces</span>
<a href="#l38.37"></a><span id="l38.37" class="difflineminus">-    }),</span>
<a href="#l38.38"></a><span id="l38.38" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIImporter]),</span>
<a href="#l38.39"></a><span id="l38.39" class="difflineplus">+    classID: Components.ID(&quot;{64a5d17a-0497-48c5-b54f-72b15c9e9a14}&quot;),</span>
<a href="#l38.40"></a><span id="l38.40"> </span>
<a href="#l38.41"></a><span id="l38.41">     getFileTypes: getOutlookCsvFileTypes,</span>
<a href="#l38.42"></a><span id="l38.42"> </span>
<a href="#l38.43"></a><span id="l38.43">     /**</span>
<a href="#l38.44"></a><span id="l38.44">      * Takes a text block of Outlook-exported Comma Separated Values and tries to</span>
<a href="#l38.45"></a><span id="l38.45">      * parse that into individual events.</span>
<a href="#l38.46"></a><span id="l38.46">      *</span>
<a href="#l38.47"></a><span id="l38.47">      * First line is field names, all quoted with double quotes.  Field names are</span>
<a href="#l38.48"></a><span id="l38.48" class="difflineat">@@ -406,27 +397,19 @@ calOutlookCSVImporter.prototype = {</span>
<a href="#l38.49"></a><span id="l38.49">     parseTextField: function(aTextField) {</span>
<a href="#l38.50"></a><span id="l38.50">         return aTextField ? aTextField.replace(/&quot;&quot;/g, &quot;\&quot;&quot;) : &quot;&quot;;</span>
<a href="#l38.51"></a><span id="l38.51">     }</span>
<a href="#l38.52"></a><span id="l38.52"> };</span>
<a href="#l38.53"></a><span id="l38.53"> </span>
<a href="#l38.54"></a><span id="l38.54"> // Exporter</span>
<a href="#l38.55"></a><span id="l38.55"> function calOutlookCSVExporter() {</span>
<a href="#l38.56"></a><span id="l38.56"> }</span>
<a href="#l38.57"></a><span id="l38.57" class="difflineminus">-var calOutlookCSVExporterClassID = Components.ID(&quot;{48e6d3a6-b41b-4052-9ed2-40b27800bd4b}&quot;);</span>
<a href="#l38.58"></a><span id="l38.58" class="difflineminus">-var calOutlookCSVExporterInterfaces = [Components.interfaces.calIExporter];</span>
<a href="#l38.59"></a><span id="l38.59"> calOutlookCSVExporter.prototype = {</span>
<a href="#l38.60"></a><span id="l38.60" class="difflineminus">-    classID: calOutlookCSVExporterClassID,</span>
<a href="#l38.61"></a><span id="l38.61" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calOutlookCSVExporterInterfaces),</span>
<a href="#l38.62"></a><span id="l38.62" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l38.63"></a><span id="l38.63" class="difflineminus">-        classID: calOutlookCSVExporterClassID,</span>
<a href="#l38.64"></a><span id="l38.64" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/export;1?type=csv&quot;,</span>
<a href="#l38.65"></a><span id="l38.65" class="difflineminus">-        classDescription: &quot;Calendar Outlook CSV Exporter&quot;,</span>
<a href="#l38.66"></a><span id="l38.66" class="difflineminus">-        interfaces: calOutlookCSVExporterInterfaces</span>
<a href="#l38.67"></a><span id="l38.67" class="difflineminus">-    }),</span>
<a href="#l38.68"></a><span id="l38.68" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIExporter]),</span>
<a href="#l38.69"></a><span id="l38.69" class="difflineplus">+    classID: Components.ID(&quot;{48e6d3a6-b41b-4052-9ed2-40b27800bd4b}&quot;),</span>
<a href="#l38.70"></a><span id="l38.70"> </span>
<a href="#l38.71"></a><span id="l38.71">     getFileTypes: getOutlookCsvFileTypes,</span>
<a href="#l38.72"></a><span id="l38.72"> </span>
<a href="#l38.73"></a><span id="l38.73">     exportToStream: function(aStream, aCount, aItems) {</span>
<a href="#l38.74"></a><span id="l38.74">         // Helper functions</span>
<a href="#l38.75"></a><span id="l38.75">         function dateString(aDateTime) {</span>
<a href="#l38.76"></a><span id="l38.76">             return cal.dtz.dateTimeToJsDate(aDateTime).toLocaleString(&quot;en-US&quot;, localeEn.dateFormat);</span>
<a href="#l38.77"></a><span id="l38.77">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/import-export/calWeekPrinter.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/import-export/calWeekPrinter.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -1,36 +1,25 @@</span>
<a href="#l39.4"></a><span id="l39.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l39.5"></a><span id="l39.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l39.6"></a><span id="l39.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l39.7"></a><span id="l39.7"> </span>
<a href="#l39.8"></a><span id="l39.8" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l39.9"></a><span id="l39.9"> ChromeUtils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l39.10"></a><span id="l39.10" class="difflineminus">-</span>
<a href="#l39.11"></a><span id="l39.11"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l39.12"></a><span id="l39.12"> </span>
<a href="#l39.13"></a><span id="l39.13"> /**</span>
<a href="#l39.14"></a><span id="l39.14">  * Prints a two column view of a week of events, much like a paper day-planner</span>
<a href="#l39.15"></a><span id="l39.15">  */</span>
<a href="#l39.16"></a><span id="l39.16"> function calWeekPrinter() {</span>
<a href="#l39.17"></a><span id="l39.17">     this.wrappedJSObject = this;</span>
<a href="#l39.18"></a><span id="l39.18"> }</span>
<a href="#l39.19"></a><span id="l39.19"> </span>
<a href="#l39.20"></a><span id="l39.20" class="difflineminus">-var calWeekPrinterClassID = Components.ID(&quot;{2d6ec97b-9109-4b92-89c5-d4b4806619ce}&quot;);</span>
<a href="#l39.21"></a><span id="l39.21" class="difflineminus">-var calWeekPrinterInterfaces = [Components.interfaces.calIPrintFormatter];</span>
<a href="#l39.22"></a><span id="l39.22"> calWeekPrinter.prototype = {</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineminus">-    classID: calWeekPrinterClassID,</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calWeekPrinterInterfaces),</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineminus">-</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l39.27"></a><span id="l39.27" class="difflineminus">-        classID: calWeekPrinterClassID,</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/printformatter;1?type=weekplan&quot;,</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineminus">-        classDescription: &quot;Calendar Week Print Formatter&quot;,</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineminus">-        interfaces: calWeekPrinterInterfaces</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-    }),</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIPrintFormatter]),</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+    classID: Components.ID(&quot;{2d6ec97b-9109-4b92-89c5-d4b4806619ce}&quot;),</span>
<a href="#l39.34"></a><span id="l39.34"> </span>
<a href="#l39.35"></a><span id="l39.35">     get name() { return cal.l10n.getCalString(&quot;weekPrinterName&quot;); },</span>
<a href="#l39.36"></a><span id="l39.36"> </span>
<a href="#l39.37"></a><span id="l39.37">     formatToHtml: function(aStream, aStart, aEnd, aCount, aItems, aTitle) {</span>
<a href="#l39.38"></a><span id="l39.38">         let document = cal.xml.parseFile(&quot;chrome://calendar-common/skin/printing/calWeekPrinter.html&quot;);</span>
<a href="#l39.39"></a><span id="l39.39">         let defaultTimezone = cal.dtz.defaultTimezone;</span>
<a href="#l39.40"></a><span id="l39.40"> </span>
<a href="#l39.41"></a><span id="l39.41">         // Set page title</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/itip/calItipEmailTransport.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/itip/calItipEmailTransport.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -11,27 +11,19 @@ ChromeUtils.import(&quot;resource://calendar/</span>
<a href="#l40.4"></a><span id="l40.4"> </span>
<a href="#l40.5"></a><span id="l40.5"> /**</span>
<a href="#l40.6"></a><span id="l40.6">  * Constructor of calItipEmailTransport object</span>
<a href="#l40.7"></a><span id="l40.7">  */</span>
<a href="#l40.8"></a><span id="l40.8"> function calItipEmailTransport() {</span>
<a href="#l40.9"></a><span id="l40.9">     this.wrappedJSObject = this;</span>
<a href="#l40.10"></a><span id="l40.10">     this._initEmailTransport();</span>
<a href="#l40.11"></a><span id="l40.11"> }</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-var calItipEmailTransportClassID = Components.ID(&quot;{d4d7b59e-c9e0-4a7a-b5e8-5958f85515f0}&quot;);</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineminus">-var calItipEmailTransportInterfaces = [Ci.calIItipTransport];</span>
<a href="#l40.14"></a><span id="l40.14"> calItipEmailTransport.prototype = {</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineminus">-    classID: calItipEmailTransportClassID,</span>
<a href="#l40.16"></a><span id="l40.16" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calItipEmailTransportInterfaces),</span>
<a href="#l40.17"></a><span id="l40.17" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l40.18"></a><span id="l40.18" class="difflineminus">-        classID: calItipEmailTransportClassID,</span>
<a href="#l40.19"></a><span id="l40.19" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/itip-transport;1?type=email&quot;,</span>
<a href="#l40.20"></a><span id="l40.20" class="difflineminus">-        classDescription: &quot;Calendar iTIP Email Transport&quot;,</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineminus">-        interfaces: calItipEmailTransportInterfaces,</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineminus">-    }),</span>
<a href="#l40.23"></a><span id="l40.23" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIItipTransport]),</span>
<a href="#l40.24"></a><span id="l40.24" class="difflineplus">+    classID: Components.ID(&quot;{d4d7b59e-c9e0-4a7a-b5e8-5958f85515f0}&quot;),</span>
<a href="#l40.25"></a><span id="l40.25"> </span>
<a href="#l40.26"></a><span id="l40.26">     mHasXpcomMail: false,</span>
<a href="#l40.27"></a><span id="l40.27">     mDefaultAccount: null,</span>
<a href="#l40.28"></a><span id="l40.28">     mDefaultIdentity: null,</span>
<a href="#l40.29"></a><span id="l40.29">     mDefaultSmtpServer: null,</span>
<a href="#l40.30"></a><span id="l40.30"> </span>
<a href="#l40.31"></a><span id="l40.31">     get scheme() { return &quot;mailto&quot;; },</span>
<a href="#l40.32"></a><span id="l40.32">     get type() { return &quot;email&quot;; },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/lightning/components/calItipProtocolHandler.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/lightning/components/calItipProtocolHandler.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -10,32 +10,22 @@ var ITIP_HANDLER_PROTOCOL = &quot;moz-cal-han</span>
<a href="#l41.4"></a><span id="l41.4"> var NS_ERROR_WONT_HANDLE_CONTENT = 0x805d0001;</span>
<a href="#l41.5"></a><span id="l41.5"> </span>
<a href="#l41.6"></a><span id="l41.6"> </span>
<a href="#l41.7"></a><span id="l41.7"> function NYI() {</span>
<a href="#l41.8"></a><span id="l41.8">     throw Components.results.NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l41.9"></a><span id="l41.9"> }</span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11"> function ItipChannel(URI) {</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineplus">+    this.wrappedJSObject = this;</span>
<a href="#l41.13"></a><span id="l41.13">     this.URI = this.originalURI = URI;</span>
<a href="#l41.14"></a><span id="l41.14"> }</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineminus">-var ItipChannelClassID = Components.ID(&quot;{643e0328-36f6-411d-a107-16238dff9cd7}&quot;);</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-var ItipChannelInterfaces = [</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineminus">-    Components.interfaces.nsIChannel,</span>
<a href="#l41.18"></a><span id="l41.18" class="difflineminus">-    Components.interfaces.nsIRequest</span>
<a href="#l41.19"></a><span id="l41.19" class="difflineminus">-];</span>
<a href="#l41.20"></a><span id="l41.20"> ItipChannel.prototype = {</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineminus">-    classID: ItipChannelClassID,</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(ItipChannelInterfaces),</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l41.24"></a><span id="l41.24" class="difflineminus">-        classID: ItipChannelClassID,</span>
<a href="#l41.25"></a><span id="l41.25" class="difflineminus">-        contractID: &quot;@mozilla.org/calendar/itip-channel;1&quot;,</span>
<a href="#l41.26"></a><span id="l41.26" class="difflineminus">-        classDescription: &quot;Calendar Itip Channel&quot;,</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineminus">-        interfaces: ItipChannelInterfaces,</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineminus">-    }),</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIChannel, Ci.nsIRequest]),</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineplus">+    classID: Components.ID(&quot;{643e0328-36f6-411d-a107-16238dff9cd7}&quot;),</span>
<a href="#l41.31"></a><span id="l41.31"> </span>
<a href="#l41.32"></a><span id="l41.32">     contentType: ITIP_HANDLER_MIMETYPE,</span>
<a href="#l41.33"></a><span id="l41.33">     loadAttributes: null,</span>
<a href="#l41.34"></a><span id="l41.34">     contentLength: 0,</span>
<a href="#l41.35"></a><span id="l41.35">     owner: null,</span>
<a href="#l41.36"></a><span id="l41.36">     loadGroup: null,</span>
<a href="#l41.37"></a><span id="l41.37">     notificationCallbacks: null,</span>
<a href="#l41.38"></a><span id="l41.38">     securityInfo: null,</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineat">@@ -53,27 +43,19 @@ ItipChannel.prototype = {</span>
<a href="#l41.40"></a><span id="l41.40">     cancel: function(status) { this.status = status; },</span>
<a href="#l41.41"></a><span id="l41.41">     suspend: NYI,</span>
<a href="#l41.42"></a><span id="l41.42">     resume: NYI,</span>
<a href="#l41.43"></a><span id="l41.43"> };</span>
<a href="#l41.44"></a><span id="l41.44"> </span>
<a href="#l41.45"></a><span id="l41.45"> function ItipProtocolHandler() {</span>
<a href="#l41.46"></a><span id="l41.46">     this.wrappedJSObject = this;</span>
<a href="#l41.47"></a><span id="l41.47"> }</span>
<a href="#l41.48"></a><span id="l41.48" class="difflineminus">-var ItipProtocolHandlerClassID = Components.ID(&quot;{6e957006-b4ce-11d9-b053-001124736B74}&quot;);</span>
<a href="#l41.49"></a><span id="l41.49" class="difflineminus">-var ItipProtocolHandlerInterfaces = [Components.interfaces.nsIProtocolHandler];</span>
<a href="#l41.50"></a><span id="l41.50"> ItipProtocolHandler.prototype = {</span>
<a href="#l41.51"></a><span id="l41.51" class="difflineminus">-    classID: ItipProtocolHandlerClassID,</span>
<a href="#l41.52"></a><span id="l41.52" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(ItipProtocolHandlerInterfaces),</span>
<a href="#l41.53"></a><span id="l41.53" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l41.54"></a><span id="l41.54" class="difflineminus">-        classID: ItipProtocolHandlerClassID,</span>
<a href="#l41.55"></a><span id="l41.55" class="difflineminus">-        contractID: &quot;@mozilla.org/network/protocol;1?name=&quot; + ITIP_HANDLER_PROTOCOL,</span>
<a href="#l41.56"></a><span id="l41.56" class="difflineminus">-        classDescription: &quot;iTIP Protocol Handler&quot;,</span>
<a href="#l41.57"></a><span id="l41.57" class="difflineminus">-        interfaces: ItipProtocolHandlerInterfaces</span>
<a href="#l41.58"></a><span id="l41.58" class="difflineminus">-    }),</span>
<a href="#l41.59"></a><span id="l41.59" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIProtocolHandler]),</span>
<a href="#l41.60"></a><span id="l41.60" class="difflineplus">+    classID: Components.ID(&quot;{6e957006-b4ce-11d9-b053-001124736B74}&quot;),</span>
<a href="#l41.61"></a><span id="l41.61"> </span>
<a href="#l41.62"></a><span id="l41.62">     protocolFlags: Ci.nsIProtocolHandler.URI_NORELATIVE | Ci.nsIProtocolHandler.URI_DANGEROUS_TO_LOAD,</span>
<a href="#l41.63"></a><span id="l41.63">     allowPort: () =&gt; false,</span>
<a href="#l41.64"></a><span id="l41.64">     isSecure: false,</span>
<a href="#l41.65"></a><span id="l41.65">     newURI: function(spec, charSet, baseURI) {</span>
<a href="#l41.66"></a><span id="l41.66">         dump(&quot;Creating new URI for &quot; + spec + &quot;\n&quot;);</span>
<a href="#l41.67"></a><span id="l41.67">         return Components.classes[&quot;@mozilla.org/network/standard-url-mutator;1&quot;]</span>
<a href="#l41.68"></a><span id="l41.68">                          .createInstance(Ci.nsIStandardURLMutator)</span>
<a href="#l41.69"></a><span id="l41.69" class="difflineat">@@ -90,27 +72,19 @@ ItipProtocolHandler.prototype = {</span>
<a href="#l41.70"></a><span id="l41.70">         dump(&quot;Creating new ItipChannel for &quot; + URI + &quot;\n&quot;);</span>
<a href="#l41.71"></a><span id="l41.71">         return new ItipChannel(URI);</span>
<a href="#l41.72"></a><span id="l41.72">     },</span>
<a href="#l41.73"></a><span id="l41.73"> };</span>
<a href="#l41.74"></a><span id="l41.74"> </span>
<a href="#l41.75"></a><span id="l41.75"> function ItipContentHandler() {</span>
<a href="#l41.76"></a><span id="l41.76">     this.wrappedJSObject = this;</span>
<a href="#l41.77"></a><span id="l41.77"> }</span>
<a href="#l41.78"></a><span id="l41.78" class="difflineminus">-var ItipContentHandlerClassID = Components.ID(&quot;{47c31f2b-b4de-11d9-bfe6-001124736B74}&quot;);</span>
<a href="#l41.79"></a><span id="l41.79" class="difflineminus">-var ItipContentHandlerInterfaces = [Components.interfaces.nsIContentHandler];</span>
<a href="#l41.80"></a><span id="l41.80"> ItipContentHandler.prototype = {</span>
<a href="#l41.81"></a><span id="l41.81" class="difflineminus">-    classID: ItipContentHandlerClassID,</span>
<a href="#l41.82"></a><span id="l41.82" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(ItipContentHandlerInterfaces),</span>
<a href="#l41.83"></a><span id="l41.83" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l41.84"></a><span id="l41.84" class="difflineminus">-        classID: ItipContentHandlerClassID,</span>
<a href="#l41.85"></a><span id="l41.85" class="difflineminus">-        contractID: &quot;@mozilla.org/uriloader/content-handler;1?type=&quot; + ITIP_HANDLER_MIMETYPE,</span>
<a href="#l41.86"></a><span id="l41.86" class="difflineminus">-        classDescription: &quot;Lightning text/calendar content handler&quot;,</span>
<a href="#l41.87"></a><span id="l41.87" class="difflineminus">-        interfaces: ItipContentHandlerInterfaces</span>
<a href="#l41.88"></a><span id="l41.88" class="difflineminus">-    }),</span>
<a href="#l41.89"></a><span id="l41.89" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsIContentHandler]),</span>
<a href="#l41.90"></a><span id="l41.90" class="difflineplus">+    classID: Components.ID(&quot;{47c31f2b-b4de-11d9-bfe6-001124736B74}&quot;),</span>
<a href="#l41.91"></a><span id="l41.91"> </span>
<a href="#l41.92"></a><span id="l41.92">     handleContent: function(contentType, windowTarget, request) {</span>
<a href="#l41.93"></a><span id="l41.93">         let channel = request.QueryInterface(Ci.nsIChannel);</span>
<a href="#l41.94"></a><span id="l41.94">         let uri = channel.URI.spec;</span>
<a href="#l41.95"></a><span id="l41.95">         if (!uri.startsWith(ITIP_HANDLER_PROTOCOL + &quot;:&quot;)) {</span>
<a href="#l41.96"></a><span id="l41.96">             cal.ERROR(&quot;Unexpected iTIP uri: &quot; + uri + &quot;\n&quot;);</span>
<a href="#l41.97"></a><span id="l41.97">             throw NS_ERROR_WONT_HANDLE_CONTENT;</span>
<a href="#l41.98"></a><span id="l41.98">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/lightning/components/lightningTextCalendarConverter.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/lightning/components/lightningTextCalendarConverter.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -7,28 +7,19 @@ ChromeUtils.import(&quot;resource://gre/modul</span>
<a href="#l42.4"></a><span id="l42.4"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l42.5"></a><span id="l42.5"> ChromeUtils.import(&quot;resource://calendar/modules/calRecurrenceUtils.jsm&quot;);</span>
<a href="#l42.6"></a><span id="l42.6"> ChromeUtils.import(&quot;resource://calendar/modules/ltnInvitationUtils.jsm&quot;);</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8"> function ltnMimeConverter() {</span>
<a href="#l42.9"></a><span id="l42.9">     this.wrappedJSObject = this;</span>
<a href="#l42.10"></a><span id="l42.10"> }</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-var ltnMimeConverterClassID = Components.ID(&quot;{c70acb08-464e-4e55-899d-b2c84c5409fa}&quot;);</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-var ltnMimeConverterInterfaces = [Components.interfaces.nsISimpleMimeConverter];</span>
<a href="#l42.14"></a><span id="l42.14"> ltnMimeConverter.prototype = {</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineminus">-    classID: ltnMimeConverterClassID,</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(ltnMimeConverterInterfaces),</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineminus">-</span>
<a href="#l42.18"></a><span id="l42.18" class="difflineminus">-    classInfo: XPCOMUtils.generateCI({</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineminus">-        classID: ltnMimeConverterClassID,</span>
<a href="#l42.20"></a><span id="l42.20" class="difflineminus">-        contractID: &quot;@mozilla.org/lightning/mime-converter;1&quot;,</span>
<a href="#l42.21"></a><span id="l42.21" class="difflineminus">-        classDescription: &quot;Lightning text/calendar handler&quot;,</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineminus">-        interfaces: ltnMimeConverterInterfaces</span>
<a href="#l42.23"></a><span id="l42.23" class="difflineminus">-    }),</span>
<a href="#l42.24"></a><span id="l42.24" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.nsISimpleMimeConverter]),</span>
<a href="#l42.25"></a><span id="l42.25" class="difflineplus">+    classID: Components.ID(&quot;{c70acb08-464e-4e55-899d-b2c84c5409fa}&quot;),</span>
<a href="#l42.26"></a><span id="l42.26"> </span>
<a href="#l42.27"></a><span id="l42.27">     uri: null,</span>
<a href="#l42.28"></a><span id="l42.28"> </span>
<a href="#l42.29"></a><span id="l42.29">     convertToHTML: function(contentType, data) {</span>
<a href="#l42.30"></a><span id="l42.30">         let parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l42.31"></a><span id="l42.31">                                .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l42.32"></a><span id="l42.32">         parser.parseString(data);</span>
<a href="#l42.33"></a><span id="l42.33">         let event = null;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -97,17 +97,17 @@ var calDavCalendarInterfaces = [</span>
<a href="#l43.4"></a><span id="l43.4">     Components.interfaces.calISchedulingSupport,</span>
<a href="#l43.5"></a><span id="l43.5">     Components.interfaces.calICalendar,</span>
<a href="#l43.6"></a><span id="l43.6">     Components.interfaces.calIChangeLog,</span>
<a href="#l43.7"></a><span id="l43.7">     calICalDavCalendar,</span>
<a href="#l43.8"></a><span id="l43.8"> ];</span>
<a href="#l43.9"></a><span id="l43.9"> calDavCalendar.prototype = {</span>
<a href="#l43.10"></a><span id="l43.10">     __proto__: cal.provider.BaseClass.prototype,</span>
<a href="#l43.11"></a><span id="l43.11">     classID: calDavCalendarClassID,</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calDavCalendarInterfaces),</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+    QueryInterface: cal.generateQI(calDavCalendarInterfaces),</span>
<a href="#l43.14"></a><span id="l43.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l43.15"></a><span id="l43.15">         classID: calDavCalendarClassID,</span>
<a href="#l43.16"></a><span id="l43.16">         contractID: &quot;@mozilla.org/calendar/calendar;1?type=caldav&quot;,</span>
<a href="#l43.17"></a><span id="l43.17">         classDescription: &quot;Calendar CalDAV back-end&quot;,</span>
<a href="#l43.18"></a><span id="l43.18">         interfaces: calDavCalendarInterfaces,</span>
<a href="#l43.19"></a><span id="l43.19">     }),</span>
<a href="#l43.20"></a><span id="l43.20"> </span>
<a href="#l43.21"></a><span id="l43.21">     // An array of components that are supported by the server. The default is</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineat">@@ -256,17 +256,17 @@ calDavCalendar.prototype = {</span>
<a href="#l43.23"></a><span id="l43.23">     /**</span>
<a href="#l43.24"></a><span id="l43.24">      * Ensure that cached items have associated meta data, otherwise server side</span>
<a href="#l43.25"></a><span id="l43.25">      * changes may not be reflected</span>
<a href="#l43.26"></a><span id="l43.26">      */</span>
<a href="#l43.27"></a><span id="l43.27">     ensureMetaData: function() {</span>
<a href="#l43.28"></a><span id="l43.28">         let self = this;</span>
<a href="#l43.29"></a><span id="l43.29">         let refreshNeeded = false;</span>
<a href="#l43.30"></a><span id="l43.30">         let getMetaListener = {</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineminus">-            QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l43.32"></a><span id="l43.32" class="difflineplus">+            QueryInterface: ChromeUtils.generateQI([Ci.calIOperationListener]),</span>
<a href="#l43.33"></a><span id="l43.33">             onGetResult: function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l43.34"></a><span id="l43.34">                 for (let item of aItems) {</span>
<a href="#l43.35"></a><span id="l43.35">                     if (!(item.id in self.mItemInfoCache)) {</span>
<a href="#l43.36"></a><span id="l43.36">                         let path = self.getItemLocationPath(item);</span>
<a href="#l43.37"></a><span id="l43.37">                         cal.LOG(&quot;Adding meta-data for cached item &quot; + item.id);</span>
<a href="#l43.38"></a><span id="l43.38">                         self.mItemInfoCache[item.id] = {</span>
<a href="#l43.39"></a><span id="l43.39">                             etag: null,</span>
<a href="#l43.40"></a><span id="l43.40">                             isNew: false,</span>
<a href="#l43.41"></a><span id="l43.41" class="difflineat">@@ -1326,17 +1326,17 @@ calDavCalendar.prototype = {</span>
<a href="#l43.42"></a><span id="l43.42">             if (this.isCached &amp;&amp; aChangeLogListener) {</span>
<a href="#l43.43"></a><span id="l43.43">                 aChangeLogListener.onResult({ status: status }, status);</span>
<a href="#l43.44"></a><span id="l43.44">             }</span>
<a href="#l43.45"></a><span id="l43.45">         };</span>
<a href="#l43.46"></a><span id="l43.46"> </span>
<a href="#l43.47"></a><span id="l43.47">         if (!this.mACLEntry) {</span>
<a href="#l43.48"></a><span id="l43.48">             let self = this;</span>
<a href="#l43.49"></a><span id="l43.49">             let opListener = {</span>
<a href="#l43.50"></a><span id="l43.50" class="difflineminus">-                QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l43.51"></a><span id="l43.51" class="difflineplus">+                QueryInterface: ChromeUtils.generateQI([Ci.calIOperationListener]),</span>
<a href="#l43.52"></a><span id="l43.52">                 onGetResult: function(calendar, status, itemType, detail, count, items) {</span>
<a href="#l43.53"></a><span id="l43.53">                     cal.ASSERT(false, &quot;unexpected!&quot;);</span>
<a href="#l43.54"></a><span id="l43.54">                 },</span>
<a href="#l43.55"></a><span id="l43.55">                 onOperationComplete: function(opCalendar, opStatus, opType, opId, opDetail) {</span>
<a href="#l43.56"></a><span id="l43.56">                     self.mACLEntry = opDetail;</span>
<a href="#l43.57"></a><span id="l43.57">                     self.fillACLProperties();</span>
<a href="#l43.58"></a><span id="l43.58">                     self.safeRefresh(aChangeLogListener);</span>
<a href="#l43.59"></a><span id="l43.59">                 }</span>
<a href="#l43.60"></a><span id="l43.60" class="difflineat">@@ -2630,17 +2630,17 @@ calDavCalendar.prototype = {</span>
<a href="#l43.61"></a><span id="l43.61">     //</span>
<a href="#l43.62"></a><span id="l43.62"> </span>
<a href="#l43.63"></a><span id="l43.63">     processItipReply: function(aItem, aPath) {</span>
<a href="#l43.64"></a><span id="l43.64">         // modify partstat for in-calendar item</span>
<a href="#l43.65"></a><span id="l43.65">         // delete item from inbox</span>
<a href="#l43.66"></a><span id="l43.66">         let self = this;</span>
<a href="#l43.67"></a><span id="l43.67"> </span>
<a href="#l43.68"></a><span id="l43.68">         let getItemListener = {};</span>
<a href="#l43.69"></a><span id="l43.69" class="difflineminus">-        getItemListener.QueryInterface = XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]);</span>
<a href="#l43.70"></a><span id="l43.70" class="difflineplus">+        getItemListener.QueryInterface = ChromeUtils.generateQI([Ci.calIOperationListener]);</span>
<a href="#l43.71"></a><span id="l43.71">         getItemListener.onOperationComplete = function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l43.72"></a><span id="l43.72">         };</span>
<a href="#l43.73"></a><span id="l43.73">         getItemListener.onGetResult = function(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l43.74"></a><span id="l43.74">             let itemToUpdate = aItems[0];</span>
<a href="#l43.75"></a><span id="l43.75">             if (aItem.recurrenceId &amp;&amp; itemToUpdate.recurrenceInfo) {</span>
<a href="#l43.76"></a><span id="l43.76">                 itemToUpdate = itemToUpdate.recurrenceInfo.getOccurrenceFor(aItem.recurrenceId);</span>
<a href="#l43.77"></a><span id="l43.77">             }</span>
<a href="#l43.78"></a><span id="l43.78">             let newItem = itemToUpdate.clone();</span>
<a href="#l43.79"></a><span id="l43.79" class="difflineat">@@ -2654,17 +2654,17 @@ calDavCalendar.prototype = {</span>
<a href="#l43.80"></a><span id="l43.80">                     newItem.addAttendee(att);</span>
<a href="#l43.81"></a><span id="l43.81">                 }</span>
<a href="#l43.82"></a><span id="l43.82">             }</span>
<a href="#l43.83"></a><span id="l43.83">             self.doModifyItem(newItem, itemToUpdate.parentItem /* related to bug 396182 */,</span>
<a href="#l43.84"></a><span id="l43.84">                               modListener, true);</span>
<a href="#l43.85"></a><span id="l43.85">         };</span>
<a href="#l43.86"></a><span id="l43.86"> </span>
<a href="#l43.87"></a><span id="l43.87">         let modListener = {};</span>
<a href="#l43.88"></a><span id="l43.88" class="difflineminus">-        modListener.QueryInterface = XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]);</span>
<a href="#l43.89"></a><span id="l43.89" class="difflineplus">+        modListener.QueryInterface = ChromeUtils.generateQI([Ci.calIOperationListener]);</span>
<a href="#l43.90"></a><span id="l43.90">         modListener.onOperationComplete = function(aCalendar, aStatus, aOperationType, aItemId, aDetail) {</span>
<a href="#l43.91"></a><span id="l43.91">             cal.LOG(&quot;CalDAV: status &quot; + aStatus + &quot; while processing iTIP REPLY &quot; +</span>
<a href="#l43.92"></a><span id="l43.92">                     &quot; for &quot; + self.name);</span>
<a href="#l43.93"></a><span id="l43.93">             // don't delete the REPLY item from inbox unless modifying the master</span>
<a href="#l43.94"></a><span id="l43.94">             // item was successful</span>
<a href="#l43.95"></a><span id="l43.95">             if (aStatus == 0) { // aStatus undocumented; 0 seems to indicate no error</span>
<a href="#l43.96"></a><span id="l43.96">                 let delUri = self.calendarUri.mutate()</span>
<a href="#l43.97"></a><span id="l43.97">                                  .setPathQueryRef(self.ensureEncodedPath(aPath))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/calendar/providers/composite/calCompositeCalendar.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/calendar/providers/composite/calCompositeCalendar.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -17,17 +17,17 @@ var calIOperationListener = Components.i</span>
<a href="#l44.4"></a><span id="l44.4"> function calCompositeCalendarObserverHelper(compCalendar) {</span>
<a href="#l44.5"></a><span id="l44.5">     this.compCalendar = compCalendar;</span>
<a href="#l44.6"></a><span id="l44.6">     this.pendingLoads = {};</span>
<a href="#l44.7"></a><span id="l44.7"> }</span>
<a href="#l44.8"></a><span id="l44.8"> </span>
<a href="#l44.9"></a><span id="l44.9"> calCompositeCalendarObserverHelper.prototype = {</span>
<a href="#l44.10"></a><span id="l44.10">     pendingLoads: null,</span>
<a href="#l44.11"></a><span id="l44.11"> </span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIObserver]),</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIObserver]),</span>
<a href="#l44.14"></a><span id="l44.14"> </span>
<a href="#l44.15"></a><span id="l44.15">     onStartBatch: function() {</span>
<a href="#l44.16"></a><span id="l44.16">         this.compCalendar.mObservers.notify(&quot;onStartBatch&quot;);</span>
<a href="#l44.17"></a><span id="l44.17">     },</span>
<a href="#l44.18"></a><span id="l44.18"> </span>
<a href="#l44.19"></a><span id="l44.19">     onEndBatch: function() {</span>
<a href="#l44.20"></a><span id="l44.20">         this.compCalendar.mObservers.notify(&quot;onEndBatch&quot;);</span>
<a href="#l44.21"></a><span id="l44.21">     },</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineat">@@ -436,16 +436,18 @@ function calCompositeGetListenerHelper(a</span>
<a href="#l44.23"></a><span id="l44.23">     this.wrappedJSObject = this;</span>
<a href="#l44.24"></a><span id="l44.24">     this.mCompositeCalendar = aCompositeCalendar;</span>
<a href="#l44.25"></a><span id="l44.25">     this.mNumQueries = aCompositeCalendar.enabledCalendars.length;</span>
<a href="#l44.26"></a><span id="l44.26">     this.mRealListener = aRealListener;</span>
<a href="#l44.27"></a><span id="l44.27">     this.mMaxItems = aMaxItems;</span>
<a href="#l44.28"></a><span id="l44.28"> }</span>
<a href="#l44.29"></a><span id="l44.29"> </span>
<a href="#l44.30"></a><span id="l44.30"> calCompositeGetListenerHelper.prototype = {</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineplus">+    QueryInterface: ChromeUtils.generateQI([Ci.calIOperationListener]),</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+</span>
<a href="#l44.33"></a><span id="l44.33">     mNumQueries: 0,</span>
<a href="#l44.34"></a><span id="l44.34">     mRealListener: null,</span>
<a href="#l44.35"></a><span id="l44.35">     mOpGroup: null,</span>
<a href="#l44.36"></a><span id="l44.36">     mReceivedCompletes: 0,</span>
<a href="#l44.37"></a><span id="l44.37">     mFinished: false,</span>
<a href="#l44.38"></a><span id="l44.38">     mMaxItems: 0,</span>
<a href="#l44.39"></a><span id="l44.39">     mItemsReceived: 0,</span>
<a href="#l44.40"></a><span id="l44.40"> </span>
<a href="#l44.41"></a><span id="l44.41" class="difflineat">@@ -462,18 +464,16 @@ calCompositeGetListenerHelper.prototype </span>
<a href="#l44.42"></a><span id="l44.42">                         this.mCompositeCalendar.mStatusObserver.stopMeteors();</span>
<a href="#l44.43"></a><span id="l44.43">                     }</span>
<a href="#l44.44"></a><span id="l44.44">                 }</span>
<a href="#l44.45"></a><span id="l44.45">             });</span>
<a href="#l44.46"></a><span id="l44.46">         }</span>
<a href="#l44.47"></a><span id="l44.47">         return this.mOpGroup;</span>
<a href="#l44.48"></a><span id="l44.48">     },</span>
<a href="#l44.49"></a><span id="l44.49"> </span>
<a href="#l44.50"></a><span id="l44.50" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l44.51"></a><span id="l44.51" class="difflineminus">-</span>
<a href="#l44.52"></a><span id="l44.52">     onOperationComplete: function(aCalendar, aStatus, aOperationType, aId, aDetail) {</span>
<a href="#l44.53"></a><span id="l44.53">         if (!this.mRealListener) {</span>
<a href="#l44.54"></a><span id="l44.54">             // has been cancelled, ignore any providers firing on this...</span>
<a href="#l44.55"></a><span id="l44.55">             return;</span>
<a href="#l44.56"></a><span id="l44.56">         }</span>
<a href="#l44.57"></a><span id="l44.57">         if (this.mFinished) {</span>
<a href="#l44.58"></a><span id="l44.58">             dump(&quot;+++ calCompositeGetListenerHelper.onOperationComplete: called with mFinished == true!&quot;);</span>
<a href="#l44.59"></a><span id="l44.59">             return;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/calendar/providers/gdata/components/calGoogleCalendar.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/calendar/providers/gdata/components/calGoogleCalendar.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -37,17 +37,17 @@ var calGoogleCalendarInterfaces = [</span>
<a href="#l45.4"></a><span id="l45.4">     Components.interfaces.calICalendar,</span>
<a href="#l45.5"></a><span id="l45.5">     Components.interfaces.calISchedulingSupport,</span>
<a href="#l45.6"></a><span id="l45.6">     Components.interfaces.calIChangeLog</span>
<a href="#l45.7"></a><span id="l45.7"> ];</span>
<a href="#l45.8"></a><span id="l45.8"> calGoogleCalendar.prototype = {</span>
<a href="#l45.9"></a><span id="l45.9">     __proto__: cal.provider.BaseClass.prototype,</span>
<a href="#l45.10"></a><span id="l45.10"> </span>
<a href="#l45.11"></a><span id="l45.11">     classID: calGoogleCalendarClassID,</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calGoogleCalendarInterfaces),</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+    QueryInterface: cal.generateQI(calGoogleCalendarInterfaces),</span>
<a href="#l45.14"></a><span id="l45.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l45.15"></a><span id="l45.15">         classDescription: &quot;Google Calendar Provider&quot;,</span>
<a href="#l45.16"></a><span id="l45.16">         contractID: &quot;@mozilla.org/calendar/calendar;1?type=gdata&quot;,</span>
<a href="#l45.17"></a><span id="l45.17">         classID: calGoogleCalendarClassID,</span>
<a href="#l45.18"></a><span id="l45.18">         interfaces: calGoogleCalendarInterfaces</span>
<a href="#l45.19"></a><span id="l45.19">     }),</span>
<a href="#l45.20"></a><span id="l45.20"> </span>
<a href="#l45.21"></a><span id="l45.21">     /* Used to reset the local cache between releases */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/calendar/providers/gdata/modules/calUtilsShim.jsm</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/calendar/providers/gdata/modules/calUtilsShim.jsm</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l46.4"></a><span id="l46.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l46.5"></a><span id="l46.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l46.6"></a><span id="l46.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l46.7"></a><span id="l46.7"> </span>
<a href="#l46.8"></a><span id="l46.8"> ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l46.9"></a><span id="l46.9" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l46.10"></a><span id="l46.10"> </span>
<a href="#l46.11"></a><span id="l46.11"> // Load these modules, which will inject into calUtils.jsm on old versions, and</span>
<a href="#l46.12"></a><span id="l46.12"> // silently fail on newer versions.</span>
<a href="#l46.13"></a><span id="l46.13"> try {</span>
<a href="#l46.14"></a><span id="l46.14">     ChromeUtils.import(&quot;resource://calendar/modules/calAsyncUtils.jsm&quot;);</span>
<a href="#l46.15"></a><span id="l46.15"> } catch (e) {}</span>
<a href="#l46.16"></a><span id="l46.16"> </span>
<a href="#l46.17"></a><span id="l46.17"> this.EXPORTED_SYMBOLS = [&quot;cal&quot;];</span>
<a href="#l46.18"></a><span id="l46.18" class="difflineat">@@ -108,8 +109,12 @@ if (typeof cal.provider == &quot;undefined&quot;) </span>
<a href="#l46.19"></a><span id="l46.19">         prepHttpChannel: (...args) =&gt; cal.prepHttpChannel(...args),</span>
<a href="#l46.20"></a><span id="l46.20">         sendHttpRequest: (...args) =&gt; cal.sendHttpRequest(...args),</span>
<a href="#l46.21"></a><span id="l46.21">         createStreamLoader: (...args) =&gt; cal.createStreamLoader(...args),</span>
<a href="#l46.22"></a><span id="l46.22">         InterfaceRequestor_getInterface: (...args) =&gt; cal.InterfaceRequestor_getInterface(...args),</span>
<a href="#l46.23"></a><span id="l46.23">         convertByteArray: (...args) =&gt; cal.convertByteArray(...args),</span>
<a href="#l46.24"></a><span id="l46.24">         promptOverwrite: (...args) =&gt; cal.promptOverwrite(...args)</span>
<a href="#l46.25"></a><span id="l46.25">     };</span>
<a href="#l46.26"></a><span id="l46.26"> }</span>
<a href="#l46.27"></a><span id="l46.27" class="difflineplus">+</span>
<a href="#l46.28"></a><span id="l46.28" class="difflineplus">+if (typeof cal.generateQI == &quot;undefined&quot;) {</span>
<a href="#l46.29"></a><span id="l46.29" class="difflineplus">+    cal.generateQI = XPCOMUtils.generateQI.bind(XPCOMUtils);</span>
<a href="#l46.30"></a><span id="l46.30" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -46,17 +46,17 @@ var calICSCalendarInterfaces = [</span>
<a href="#l47.4"></a><span id="l47.4">     Components.interfaces.nsIStreamListener,</span>
<a href="#l47.5"></a><span id="l47.5">     Components.interfaces.nsIStreamLoaderObserver,</span>
<a href="#l47.6"></a><span id="l47.6">     Components.interfaces.nsIChannelEventSink,</span>
<a href="#l47.7"></a><span id="l47.7">     Components.interfaces.nsIInterfaceRequestor,</span>
<a href="#l47.8"></a><span id="l47.8"> ];</span>
<a href="#l47.9"></a><span id="l47.9"> calICSCalendar.prototype = {</span>
<a href="#l47.10"></a><span id="l47.10">     __proto__: cal.provider.BaseClass.prototype,</span>
<a href="#l47.11"></a><span id="l47.11">     classID: calICSCalendarClassID,</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calICSCalendarInterfaces),</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+    QueryInterface: cal.generateQI(calICSCalendarInterfaces),</span>
<a href="#l47.14"></a><span id="l47.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l47.15"></a><span id="l47.15">         classID: calICSCalendarClassID,</span>
<a href="#l47.16"></a><span id="l47.16">         contractID: &quot;@mozilla.org/calendar/calendar;1?type=ics&quot;,</span>
<a href="#l47.17"></a><span id="l47.17">         classDescription: &quot;Calendar ICS provider&quot;,</span>
<a href="#l47.18"></a><span id="l47.18">         interfaces: calICSCalendarInterfaces,</span>
<a href="#l47.19"></a><span id="l47.19">     }),</span>
<a href="#l47.20"></a><span id="l47.20"> </span>
<a href="#l47.21"></a><span id="l47.21">     mObserver: null,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/calendar/providers/memory/calMemoryCalendar.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/calendar/providers/memory/calMemoryCalendar.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -23,17 +23,17 @@ var calMemoryCalendarInterfaces = [</span>
<a href="#l48.4"></a><span id="l48.4">     Components.interfaces.calISchedulingSupport,</span>
<a href="#l48.5"></a><span id="l48.5">     Components.interfaces.calIOfflineStorage,</span>
<a href="#l48.6"></a><span id="l48.6">     Components.interfaces.calISyncWriteCalendar,</span>
<a href="#l48.7"></a><span id="l48.7">     Components.interfaces.calICalendarProvider</span>
<a href="#l48.8"></a><span id="l48.8"> ];</span>
<a href="#l48.9"></a><span id="l48.9"> calMemoryCalendar.prototype = {</span>
<a href="#l48.10"></a><span id="l48.10">     __proto__: cal.provider.BaseClass.prototype,</span>
<a href="#l48.11"></a><span id="l48.11">     classID: calMemoryCalendarClassID,</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calMemoryCalendarInterfaces),</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+    QueryInterface: cal.generateQI(calMemoryCalendarInterfaces),</span>
<a href="#l48.14"></a><span id="l48.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l48.15"></a><span id="l48.15">         classID: calMemoryCalendarClassID,</span>
<a href="#l48.16"></a><span id="l48.16">         contractID: &quot;@mozilla.org/calendar/calendar;1?type=memory&quot;,</span>
<a href="#l48.17"></a><span id="l48.17">         classDescription: &quot;Calendar Memory Provider&quot;,</span>
<a href="#l48.18"></a><span id="l48.18">         interfaces: calMemoryCalendarInterfaces</span>
<a href="#l48.19"></a><span id="l48.19">     }),</span>
<a href="#l48.20"></a><span id="l48.20"> </span>
<a href="#l48.21"></a><span id="l48.21">     mItems: null,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -29,17 +29,17 @@ var calStorageCalendarInterfaces = [</span>
<a href="#l49.4"></a><span id="l49.4">     Components.interfaces.calICalendarProvider,</span>
<a href="#l49.5"></a><span id="l49.5">     Components.interfaces.calIOfflineStorage,</span>
<a href="#l49.6"></a><span id="l49.6">     Components.interfaces.calISchedulingSupport,</span>
<a href="#l49.7"></a><span id="l49.7">     Components.interfaces.calISyncWriteCalendar,</span>
<a href="#l49.8"></a><span id="l49.8"> ];</span>
<a href="#l49.9"></a><span id="l49.9"> calStorageCalendar.prototype = {</span>
<a href="#l49.10"></a><span id="l49.10">     __proto__: cal.provider.BaseClass.prototype,</span>
<a href="#l49.11"></a><span id="l49.11">     classID: calStorageCalendarClassID,</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calStorageCalendarInterfaces),</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+    QueryInterface: cal.generateQI(calStorageCalendarInterfaces),</span>
<a href="#l49.14"></a><span id="l49.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l49.15"></a><span id="l49.15">         classID: calStorageCalendarClassID,</span>
<a href="#l49.16"></a><span id="l49.16">         contractID: &quot;@mozilla.org/calendar/calendar;1?type=storage&quot;,</span>
<a href="#l49.17"></a><span id="l49.17">         classDescription: &quot;Calendar Storage Provider&quot;,</span>
<a href="#l49.18"></a><span id="l49.18">         interfaces: calStorageCalendarInterfaces</span>
<a href="#l49.19"></a><span id="l49.19">     }),</span>
<a href="#l49.20"></a><span id="l49.20"> </span>
<a href="#l49.21"></a><span id="l49.21">     //</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendar.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendar.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -24,17 +24,17 @@ var calWcapCalendarInterfaces = [</span>
<a href="#l50.4"></a><span id="l50.4">     calICalendar,</span>
<a href="#l50.5"></a><span id="l50.5">     Components.interfaces.calISchedulingSupport,</span>
<a href="#l50.6"></a><span id="l50.6">     Components.interfaces.calIChangeLog,</span>
<a href="#l50.7"></a><span id="l50.7">     Components.interfaces.calICalendarProvider,</span>
<a href="#l50.8"></a><span id="l50.8"> ];</span>
<a href="#l50.9"></a><span id="l50.9"> calWcapCalendar.prototype = {</span>
<a href="#l50.10"></a><span id="l50.10">     __proto__: cal.provider.BaseClass.prototype,</span>
<a href="#l50.11"></a><span id="l50.11">     classID: calWcapCalendarClassID,</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calWcapCalendarInterfaces),</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+    QueryInterface: cal.generateQI(calWcapCalendarInterfaces),</span>
<a href="#l50.14"></a><span id="l50.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l50.15"></a><span id="l50.15">         classID: calWcapCalendarClassID,</span>
<a href="#l50.16"></a><span id="l50.16">         contractID: &quot;@mozilla.org/calendar/calendar;1?type=wcap&quot;,</span>
<a href="#l50.17"></a><span id="l50.17">         classDescription: &quot;Sun Java System Calendar Server WCAP Provider&quot;,</span>
<a href="#l50.18"></a><span id="l50.18">         interfaces: calWcapCalendarInterfaces</span>
<a href="#l50.19"></a><span id="l50.19">     }),</span>
<a href="#l50.20"></a><span id="l50.20"> </span>
<a href="#l50.21"></a><span id="l50.21">     toString: function() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapRequest.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapRequest.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -202,17 +202,17 @@ var calWcapNetworkRequestInterfaces = [</span>
<a href="#l51.4"></a><span id="l51.4"> calWcapNetworkRequest.prototype = {</span>
<a href="#l51.5"></a><span id="l51.5">     m_id: 0,</span>
<a href="#l51.6"></a><span id="l51.6">     m_url: null,</span>
<a href="#l51.7"></a><span id="l51.7">     m_loader: null,</span>
<a href="#l51.8"></a><span id="l51.8">     m_respFunc: null,</span>
<a href="#l51.9"></a><span id="l51.9">     m_bLogging: false,</span>
<a href="#l51.10"></a><span id="l51.10"> </span>
<a href="#l51.11"></a><span id="l51.11">     classID: calWcapNetworkRequestClassID,</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calWcapNetworkRequestInterfaces),</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+    QueryInterface: cal.generateQI(calWcapNetworkRequestInterfaces),</span>
<a href="#l51.14"></a><span id="l51.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l51.15"></a><span id="l51.15">         classID: calWcapNetworkRequestClassID,</span>
<a href="#l51.16"></a><span id="l51.16">         contractID: &quot;@mozilla.org/calendar/wcap/network-request;1&quot;,</span>
<a href="#l51.17"></a><span id="l51.17">         classDescription: &quot;Sun Java System Calendar Server WCAP Network Request&quot;,</span>
<a href="#l51.18"></a><span id="l51.18">         interfaces: calWcapNetworkRequestInterfaces</span>
<a href="#l51.19"></a><span id="l51.19">     }),</span>
<a href="#l51.20"></a><span id="l51.20"> </span>
<a href="#l51.21"></a><span id="l51.21">     /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -109,17 +109,17 @@ var calWcapSessionInterfaces = [</span>
<a href="#l52.4"></a><span id="l52.4">     calIWcapSession,</span>
<a href="#l52.5"></a><span id="l52.5">     calIFreeBusyProvider,</span>
<a href="#l52.6"></a><span id="l52.6">     calICalendarSearchProvider,</span>
<a href="#l52.7"></a><span id="l52.7">     Components.interfaces.calITimezoneProvider,</span>
<a href="#l52.8"></a><span id="l52.8">     Components.interfaces.calICalendarManagerObserver</span>
<a href="#l52.9"></a><span id="l52.9"> ];</span>
<a href="#l52.10"></a><span id="l52.10"> calWcapSession.prototype = {</span>
<a href="#l52.11"></a><span id="l52.11">     classID: calWcapSessionClassID,</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-    QueryInterface: XPCOMUtils.generateQI(calWcapSessionInterfaces),</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+    QueryInterface: cal.generateQI(calWcapSessionInterfaces),</span>
<a href="#l52.14"></a><span id="l52.14">     classInfo: XPCOMUtils.generateCI({</span>
<a href="#l52.15"></a><span id="l52.15">         classID: calWcapSessionClassID,</span>
<a href="#l52.16"></a><span id="l52.16">         contractID: &quot;@mozilla.org/calendar/wcap/session;1&quot;,</span>
<a href="#l52.17"></a><span id="l52.17">         classDescription: &quot;Sun Java System Calendar Server WCAP Session&quot;,</span>
<a href="#l52.18"></a><span id="l52.18">         interfaces: calWcapSessionInterfaces</span>
<a href="#l52.19"></a><span id="l52.19">     }),</span>
<a href="#l52.20"></a><span id="l52.20"> </span>
<a href="#l52.21"></a><span id="l52.21">     toString: function(msg) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mail/config/mozconfigs/common</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mail/config/mozconfigs/common</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -1,1 +1,2 @@</span>
<a href="#l53.4"></a><span id="l53.4"> ac_add_options --enable-application=comm/mail</span>
<a href="#l53.5"></a><span id="l53.5" class="difflineplus">+ac_add_options --enable-calendar</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

