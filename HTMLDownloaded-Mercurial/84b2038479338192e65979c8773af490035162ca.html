<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 19066:84b2038479338192e65979c8773af490035162ca</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 84b2038479338192e65979c8773af490035162ca" />
<meta property="og:url" content="/comm-central/rev/84b2038479338192e65979c8773af490035162ca" />
<meta property="og:description" content="Bug 1253836 - Update references to legacy nsIDOMWindow in mintrayr. r=aleth" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 84b2038479338192e65979c8773af490035162ca 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/84b2038479338192e65979c8773af490035162ca">shortlog</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/84b2038479338192e65979c8773af490035162ca">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca">files</a> |
changeset |
<a href="/comm-central/raw-rev/84b2038479338192e65979c8773af490035162ca">raw</a>  | <a href="/comm-central/archive/84b2038479338192e65979c8773af490035162ca.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1253836">Bug 1253836</a> - Update references to legacy nsIDOMWindow in mintrayr. r=aleth
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#98;&#100;&#101;&#108;&#114;&#104;&#109;&#97;&#110;&#32;&#65;&#104;&#109;&#101;&#100;&#32;&#60;&#97;&#98;&#64;&#97;&#98;&#97;&#104;&#109;&#101;&#100;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 08 Mar 2016 14:44:00 +0100</td></tr>

<tr>
 <td>changeset 19066</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/84b2038479338192e65979c8773af490035162ca">84b2038479338192e65979c8773af490035162ca</a></td>
</tr>



<tr>
<td>parent 19065</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/4eae6164ce3d82a465431a339df9685481c88ce4">4eae6164ce3d82a465431a339df9685481c88ce4</a>
</td>
</tr>

<tr>
<td>child 19067</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a98dbd50cf2aa0722352b7ffeaa5267372add6b4">a98dbd50cf2aa0722352b7ffeaa5267372add6b4</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=84b2038479338192e65979c8773af490035162ca">11711</a></td></tr>
<tr><td>push user</td><td>aleth@instantbird.org</td></tr>
<tr><td>push date</td><td class="date age">Tue, 08 Mar 2016 22:53:05 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@84b203847933 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=84b2038479338192e65979c8773af490035162ca">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=84b2038479338192e65979c8773af490035162ca&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=84b2038479338192e65979c8773af490035162ca&newProject=comm-central&newRevision=84b2038479338192e65979c8773af490035162ca&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=84b2038479338192e65979c8773af490035162ca&newProject=comm-central&newRevision=84b2038479338192e65979c8773af490035162ca&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=84b2038479338192e65979c8773af490035162ca&newProject=comm-central&newRevision=84b2038479338192e65979c8773af490035162ca&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28aleth%29&revcount=50">aleth</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1253836">1253836</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1253836">Bug 1253836</a> - Update references to legacy nsIDOMWindow in mintrayr. r=aleth</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayIToolkit.idl">im/components/mintrayr/trayIToolkit.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayIToolkit.idl">file</a> |
<a href="/comm-central/annotate/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayIToolkit.idl">annotate</a> |
<a href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayIToolkit.idl">diff</a> |
<a href="/comm-central/comparison/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayIToolkit.idl">comparison</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayIToolkit.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatform.h">im/components/mintrayr/trayPlatform.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatform.h">file</a> |
<a href="/comm-central/annotate/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatform.h">annotate</a> |
<a href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatform.h">diff</a> |
<a href="/comm-central/comparison/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatform.h">comparison</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatform.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.cpp">im/components/mintrayr/trayPlatformGtk2.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.cpp">file</a> |
<a href="/comm-central/annotate/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.cpp">annotate</a> |
<a href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.cpp">diff</a> |
<a href="/comm-central/comparison/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.cpp">comparison</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.h">im/components/mintrayr/trayPlatformGtk2.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.h">file</a> |
<a href="/comm-central/annotate/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.h">annotate</a> |
<a href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.h">diff</a> |
<a href="/comm-central/comparison/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.h">comparison</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayPlatformGtk2.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.cpp">im/components/mintrayr/trayToolkit.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.cpp">file</a> |
<a href="/comm-central/annotate/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.cpp">annotate</a> |
<a href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.cpp">diff</a> |
<a href="/comm-central/comparison/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.cpp">comparison</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.h">im/components/mintrayr/trayToolkit.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.h">file</a> |
<a href="/comm-central/annotate/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.h">annotate</a> |
<a href="/comm-central/diff/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.h">diff</a> |
<a href="/comm-central/comparison/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.h">comparison</a> |
<a href="/comm-central/log/84b2038479338192e65979c8773af490035162ca/im/components/mintrayr/trayToolkit.h">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/im/components/mintrayr/trayIToolkit.idl</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/im/components/mintrayr/trayIToolkit.idl</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,23 +1,23 @@</span>
<a href="#l1.4"></a><span id="l1.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.5"></a><span id="l1.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.6"></a><span id="l1.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> #include &quot;nsISupports.idl&quot;</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10" class="difflineminus">-interface nsIDOMWindow;</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineplus">+interface mozIDOMWindow;</span>
<a href="#l1.12"></a><span id="l1.12"> </span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-[scriptable, uuid(e17d921c-4b3a-47b2-8283-cab425cc1a0c)]</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+[scriptable, uuid(4090c428-e534-11e5-91df-68b599e53270)]</span>
<a href="#l1.15"></a><span id="l1.15"> interface trayITrayIcon : nsISupports {</span>
<a href="#l1.16"></a><span id="l1.16"> </span>
<a href="#l1.17"></a><span id="l1.17">   /**</span>
<a href="#l1.18"></a><span id="l1.18">    * Associated DOM window</span>
<a href="#l1.19"></a><span id="l1.19">    */</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-  readonly attribute nsIDOMWindow window;</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+  readonly attribute mozIDOMWindow window;</span>
<a href="#l1.22"></a><span id="l1.22"> </span>
<a href="#l1.23"></a><span id="l1.23">   /**</span>
<a href="#l1.24"></a><span id="l1.24">    * Window is minimized to tray</span>
<a href="#l1.25"></a><span id="l1.25">    */</span>
<a href="#l1.26"></a><span id="l1.26">   readonly attribute boolean isMinimized;</span>
<a href="#l1.27"></a><span id="l1.27"> </span>
<a href="#l1.28"></a><span id="l1.28">   /**</span>
<a href="#l1.29"></a><span id="l1.29">      * Indicates whether icon will be closed if window is restored</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineat">@@ -35,46 +35,46 @@ interface trayITrayIcon : nsISupports {</span>
<a href="#l1.31"></a><span id="l1.31">   void restore();</span>
<a href="#l1.32"></a><span id="l1.32"> </span>
<a href="#l1.33"></a><span id="l1.33">   /**</span>
<a href="#l1.34"></a><span id="l1.34">    * Closes the tray icon, restoring the window in the process</span>
<a href="#l1.35"></a><span id="l1.35">    */</span>
<a href="#l1.36"></a><span id="l1.36">   void close();</span>
<a href="#l1.37"></a><span id="l1.37"> };</span>
<a href="#l1.38"></a><span id="l1.38"> </span>
<a href="#l1.39"></a><span id="l1.39" class="difflineminus">-[scriptable, uuid(8fbd1a20-7abf-11dd-ad8b-0800200c9a66)]</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+[scriptable, uuid(251192ae-e534-11e5-9bcb-68b599e53270)]</span>
<a href="#l1.41"></a><span id="l1.41"> interface trayITrayService : nsISupports {</span>
<a href="#l1.42"></a><span id="l1.42"> </span>
<a href="#l1.43"></a><span id="l1.43">   /**</span>
<a href="#l1.44"></a><span id="l1.44">    * Creates a tray icon for window</span>
<a href="#l1.45"></a><span id="l1.45">    */</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineminus">-  trayITrayIcon createIcon(in nsIDOMWindow window,  [optional] in boolean aCloseOnRestore);</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineplus">+  trayITrayIcon createIcon(in mozIDOMWindow window,  [optional] in boolean aCloseOnRestore);</span>
<a href="#l1.48"></a><span id="l1.48"> </span>
<a href="#l1.49"></a><span id="l1.49">   /**</span>
<a href="#l1.50"></a><span id="l1.50">    * Restores all windows from the tray</span>
<a href="#l1.51"></a><span id="l1.51">    */</span>
<a href="#l1.52"></a><span id="l1.52">   void restoreAll();</span>
<a href="#l1.53"></a><span id="l1.53"> </span>
<a href="#l1.54"></a><span id="l1.54">   /**</span>
<a href="#l1.55"></a><span id="l1.55">    * Watch a window, and if minimized send to tray</span>
<a href="#l1.56"></a><span id="l1.56">    */</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-  void watchMinimize(in nsIDOMWindow window);</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineplus">+  void watchMinimize(in mozIDOMWindow window);</span>
<a href="#l1.59"></a><span id="l1.59"> </span>
<a href="#l1.60"></a><span id="l1.60">   /**</span>
<a href="#l1.61"></a><span id="l1.61">    * unwatch a window again</span>
<a href="#l1.62"></a><span id="l1.62">    */</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineminus">-  void unwatchMinimize(in nsIDOMWindow window);</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineplus">+  void unwatchMinimize(in mozIDOMWindow window);</span>
<a href="#l1.65"></a><span id="l1.65"> </span>
<a href="#l1.66"></a><span id="l1.66">   /**</span>
<a href="#l1.67"></a><span id="l1.67">    * is the window watched</span>
<a href="#l1.68"></a><span id="l1.68">    */</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineminus">-  bool isWatchedWindow(in nsIDOMWindow window);</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineplus">+  bool isWatchedWindow(in mozIDOMWindow window);</span>
<a href="#l1.71"></a><span id="l1.71"> </span>
<a href="#l1.72"></a><span id="l1.72">   /**</span>
<a href="#l1.73"></a><span id="l1.73">    * minimizes a window to the tray</span>
<a href="#l1.74"></a><span id="l1.74">    */</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineminus">-  void minimize(in nsIDOMWindow aWindow, [optional] in boolean aCloseOnRestore);</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineplus">+  void minimize(in mozIDOMWindow aWindow, [optional] in boolean aCloseOnRestore);</span>
<a href="#l1.77"></a><span id="l1.77"> </span>
<a href="#l1.78"></a><span id="l1.78">   /**</span>
<a href="#l1.79"></a><span id="l1.79">    * Restores a window from the tray</span>
<a href="#l1.80"></a><span id="l1.80">    */</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineminus">-  void restore(in nsIDOMWindow aWindow);</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+  void restore(in mozIDOMWindow aWindow);</span>
<a href="#l1.83"></a><span id="l1.83"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/im/components/mintrayr/trayPlatform.h</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/im/components/mintrayr/trayPlatform.h</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -10,17 +10,17 @@</span>
<a href="#l2.4"></a><span id="l2.4"> #ifndef __TRAYPLATFORM_H</span>
<a href="#l2.5"></a><span id="l2.5"> #define __TRAYPLATFORM_H</span>
<a href="#l2.6"></a><span id="l2.6"> </span>
<a href="#l2.7"></a><span id="l2.7"> #include &quot;xpcom-config.h&quot;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l2.10"></a><span id="l2.10"> #include &quot;nsStringAPI.h&quot;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-#include &quot;nsIDOMWindow.h&quot;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+#include &quot;mozIDOMWindow.h&quot;</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15"> namespace mintrayr {</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17"> class TrayIconImpl;</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19"> namespace platform {</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21"> /**</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -31,35 +31,35 @@ void Init();</span>
<a href="#l2.23"></a><span id="l2.23"> /**</span>
<a href="#l2.24"></a><span id="l2.24">  * Called when the service is destroyed</span>
<a href="#l2.25"></a><span id="l2.25">  */</span>
<a href="#l2.26"></a><span id="l2.26"> void Destroy();</span>
<a href="#l2.27"></a><span id="l2.27"> </span>
<a href="#l2.28"></a><span id="l2.28"> /**</span>
<a href="#l2.29"></a><span id="l2.29">  * Window should be watched</span>
<a href="#l2.30"></a><span id="l2.30">  */</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-NS_IMETHODIMP WatchWindow(nsIDOMWindow *aWindow);</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+NS_IMETHODIMP WatchWindow(mozIDOMWindow *aWindow);</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34"> /**</span>
<a href="#l2.35"></a><span id="l2.35">  * Window should be unwatched</span>
<a href="#l2.36"></a><span id="l2.36">  */</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-NS_IMETHODIMP UnwatchWindow(nsIDOMWindow *aWindow);</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+NS_IMETHODIMP UnwatchWindow(mozIDOMWindow *aWindow);</span>
<a href="#l2.39"></a><span id="l2.39"> </span>
<a href="#l2.40"></a><span id="l2.40"> /**</span>
<a href="#l2.41"></a><span id="l2.41">  * Abstract helper class</span>
<a href="#l2.42"></a><span id="l2.42">  * Encapsulates the platform specific initialization code and message processing</span>
<a href="#l2.43"></a><span id="l2.43">  */</span>
<a href="#l2.44"></a><span id="l2.44"> class Icon {</span>
<a href="#l2.45"></a><span id="l2.45"> public:</span>
<a href="#l2.46"></a><span id="l2.46">   virtual ~Icon() {}</span>
<a href="#l2.47"></a><span id="l2.47">   virtual void Minimize() = 0;</span>
<a href="#l2.48"></a><span id="l2.48">   virtual void Restore() = 0;</span>
<a href="#l2.49"></a><span id="l2.49"> };</span>
<a href="#l2.50"></a><span id="l2.50"> </span>
<a href="#l2.51"></a><span id="l2.51"> /**</span>
<a href="#l2.52"></a><span id="l2.52">  * Factory</span>
<a href="#l2.53"></a><span id="l2.53">  */</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-Icon* CreateIcon(TrayIconImpl *aOwner, nsIDOMWindow* aWindow, const nsString&amp; aTitle);</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+Icon* CreateIcon(TrayIconImpl *aOwner, mozIDOMWindow* aWindow, const nsString&amp; aTitle);</span>
<a href="#l2.56"></a><span id="l2.56"> </span>
<a href="#l2.57"></a><span id="l2.57"> } // namespace platform</span>
<a href="#l2.58"></a><span id="l2.58"> } // namespace mintrayr</span>
<a href="#l2.59"></a><span id="l2.59"> </span>
<a href="#l2.60"></a><span id="l2.60"> #endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/im/components/mintrayr/trayPlatformGtk2.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/im/components/mintrayr/trayPlatformGtk2.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -17,17 +17,17 @@ namespace mintrayr {</span>
<a href="#l3.4"></a><span id="l3.4"> namespace platform {</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6"> #define XATOM(atom) static const Atom atom = XInternAtom(xev-&gt;xany.display, #atom, false)</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> /**</span>
<a href="#l3.9"></a><span id="l3.9">  * Helper: Gdk filter function to &quot;watch&quot; the window</span>
<a href="#l3.10"></a><span id="l3.10">  */</span>
<a href="#l3.11"></a><span id="l3.11"> static</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-GdkFilterReturn filterWindows(XEvent *xev, GdkEvent* event, nsIDOMWindow* window)</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+GdkFilterReturn filterWindows(XEvent *xev, GdkEvent* event, mozIDOMWindow* window)</span>
<a href="#l3.14"></a><span id="l3.14"> {</span>
<a href="#l3.15"></a><span id="l3.15">   XATOM(WM_DELETE_WINDOW);</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17">   if (!xev) {</span>
<a href="#l3.18"></a><span id="l3.18">     return GDK_FILTER_CONTINUE;</span>
<a href="#l3.19"></a><span id="l3.19">   }</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21">   switch (xev-&gt;type) {</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -57,22 +57,22 @@ GdkFilterReturn filterWindows(XEvent *xe</span>
<a href="#l3.23"></a><span id="l3.23">       break;</span>
<a href="#l3.24"></a><span id="l3.24">   }</span>
<a href="#l3.25"></a><span id="l3.25">   return GDK_FILTER_CONTINUE;</span>
<a href="#l3.26"></a><span id="l3.26"> }</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28"> void Init() {}</span>
<a href="#l3.29"></a><span id="l3.29"> void Destroy() {}</span>
<a href="#l3.30"></a><span id="l3.30"> </span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-Icon* CreateIcon(TrayIconImpl *aOwner, nsIDOMWindow* aWindow, const nsString&amp; aTitle)</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+Icon* CreateIcon(TrayIconImpl *aOwner, mozIDOMWindow* aWindow, const nsString&amp; aTitle)</span>
<a href="#l3.33"></a><span id="l3.33"> {</span>
<a href="#l3.34"></a><span id="l3.34">   return new gtk2::Icon(aOwner, aWindow, aTitle);</span>
<a href="#l3.35"></a><span id="l3.35"> }</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-NS_IMETHODIMP WatchWindow(nsIDOMWindow *aWindow)</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+NS_IMETHODIMP WatchWindow(mozIDOMWindow *aWindow)</span>
<a href="#l3.39"></a><span id="l3.39"> {</span>
<a href="#l3.40"></a><span id="l3.40">   nsresult rv;</span>
<a href="#l3.41"></a><span id="l3.41"> </span>
<a href="#l3.42"></a><span id="l3.42">   nsCOMPtr&lt;nsIBaseWindow&gt; baseWindow;</span>
<a href="#l3.43"></a><span id="l3.43">   rv = GetBaseWindow(aWindow, getter_AddRefs(baseWindow));</span>
<a href="#l3.44"></a><span id="l3.44">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.45"></a><span id="l3.45"> </span>
<a href="#l3.46"></a><span id="l3.46">   nativeWindow native = 0;</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineat">@@ -83,17 +83,17 @@ NS_IMETHODIMP WatchWindow(nsIDOMWindow *</span>
<a href="#l3.48"></a><span id="l3.48">   if (!gdkWindow) {</span>
<a href="#l3.49"></a><span id="l3.49">     return NS_ERROR_UNEXPECTED;</span>
<a href="#l3.50"></a><span id="l3.50">   }</span>
<a href="#l3.51"></a><span id="l3.51">   gdk_window_add_filter(gdkWindow, reinterpret_cast&lt;GdkFilterFunc&gt;(filterWindows), aWindow);</span>
<a href="#l3.52"></a><span id="l3.52"> </span>
<a href="#l3.53"></a><span id="l3.53"> </span>
<a href="#l3.54"></a><span id="l3.54">   return NS_OK;</span>
<a href="#l3.55"></a><span id="l3.55"> }</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-NS_IMETHODIMP UnwatchWindow(nsIDOMWindow *aWindow)</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+NS_IMETHODIMP UnwatchWindow(mozIDOMWindow *aWindow)</span>
<a href="#l3.58"></a><span id="l3.58"> {</span>
<a href="#l3.59"></a><span id="l3.59">   nsresult rv;</span>
<a href="#l3.60"></a><span id="l3.60"> </span>
<a href="#l3.61"></a><span id="l3.61">   nsCOMPtr&lt;nsIBaseWindow&gt; baseWindow;</span>
<a href="#l3.62"></a><span id="l3.62">   rv = GetBaseWindow(aWindow, getter_AddRefs(baseWindow));</span>
<a href="#l3.63"></a><span id="l3.63">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.64"></a><span id="l3.64"> </span>
<a href="#l3.65"></a><span id="l3.65">   nativeWindow native = 0;</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineat">@@ -106,22 +106,22 @@ NS_IMETHODIMP UnwatchWindow(nsIDOMWindow</span>
<a href="#l3.67"></a><span id="l3.67">   }</span>
<a href="#l3.68"></a><span id="l3.68">   gdk_window_remove_filter(gdkWindow, reinterpret_cast&lt;GdkFilterFunc&gt;(filterWindows), aWindow);</span>
<a href="#l3.69"></a><span id="l3.69"> </span>
<a href="#l3.70"></a><span id="l3.70">   return NS_OK;</span>
<a href="#l3.71"></a><span id="l3.71"> }</span>
<a href="#l3.72"></a><span id="l3.72"> </span>
<a href="#l3.73"></a><span id="l3.73"> namespace gtk2 {</span>
<a href="#l3.74"></a><span id="l3.74"> </span>
<a href="#l3.75"></a><span id="l3.75" class="difflineminus">-Icon::Icon(TrayIconImpl *aIcon, nsIDOMWindow *aWindow, const nsString&amp; aTitle)</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineplus">+Icon::Icon(TrayIconImpl *aIcon, mozIDOMWindow *aWindow, const nsString&amp; aTitle)</span>
<a href="#l3.77"></a><span id="l3.77">   : mStatusIcon(0), mGtkWindow(0), mGdkWindow(0), mIcon(aIcon)</span>
<a href="#l3.78"></a><span id="l3.78"> {</span>
<a href="#l3.79"></a><span id="l3.79">   Init(aWindow, aTitle);</span>
<a href="#l3.80"></a><span id="l3.80"> }</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineminus">-NS_IMETHODIMP Icon::Init(nsIDOMWindow *aWindow, const nsString&amp; aTitle)</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+NS_IMETHODIMP Icon::Init(mozIDOMWindow *aWindow, const nsString&amp; aTitle)</span>
<a href="#l3.83"></a><span id="l3.83"> {</span>
<a href="#l3.84"></a><span id="l3.84">   nsresult rv;</span>
<a href="#l3.85"></a><span id="l3.85">   nsCOMPtr&lt;nsIBaseWindow&gt; baseWindow;</span>
<a href="#l3.86"></a><span id="l3.86">   rv = GetBaseWindow(aWindow, getter_AddRefs(baseWindow));</span>
<a href="#l3.87"></a><span id="l3.87">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.88"></a><span id="l3.88"> </span>
<a href="#l3.89"></a><span id="l3.89">   nativeWindow native = 0;</span>
<a href="#l3.90"></a><span id="l3.90">   rv = baseWindow-&gt;GetParentNativeWindow(&amp;native);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/im/components/mintrayr/trayPlatformGtk2.h</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/im/components/mintrayr/trayPlatformGtk2.h</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -11,17 +11,17 @@</span>
<a href="#l4.4"></a><span id="l4.4"> </span>
<a href="#l4.5"></a><span id="l4.5"> #include &lt;gtk/gtk.h&gt;</span>
<a href="#l4.6"></a><span id="l4.6"> #include &lt;gdk/gdk.h&gt;</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8"> #include &quot;trayPlatform.h&quot;</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-#include &quot;nsIDOMWindow.h&quot;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+#include &quot;mozIDOMWindow.h&quot;</span>
<a href="#l4.14"></a><span id="l4.14"> </span>
<a href="#l4.15"></a><span id="l4.15"> namespace mintrayr {</span>
<a href="#l4.16"></a><span id="l4.16"> namespace platform {</span>
<a href="#l4.17"></a><span id="l4.17"> namespace gtk2 {</span>
<a href="#l4.18"></a><span id="l4.18"> </span>
<a href="#l4.19"></a><span id="l4.19"> /**</span>
<a href="#l4.20"></a><span id="l4.20">  * Helper class</span>
<a href="#l4.21"></a><span id="l4.21">  * Encapsulates the Gtk2 specific initialization code and message processing</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -29,24 +29,24 @@ namespace gtk2 {</span>
<a href="#l4.23"></a><span id="l4.23"> class Icon : public platform::Icon {</span>
<a href="#l4.24"></a><span id="l4.24"> private:</span>
<a href="#l4.25"></a><span id="l4.25"> public:</span>
<a href="#l4.26"></a><span id="l4.26">   GtkStatusIcon *mStatusIcon;</span>
<a href="#l4.27"></a><span id="l4.27">   GtkWindow *mGtkWindow;</span>
<a href="#l4.28"></a><span id="l4.28">   GdkWindow *mGdkWindow;</span>
<a href="#l4.29"></a><span id="l4.29">   TrayIconImpl *mIcon;</span>
<a href="#l4.30"></a><span id="l4.30"> </span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-  Icon(TrayIconImpl *aOwner, nsIDOMWindow* aWindow, const nsString&amp; aTitle);</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+  Icon(TrayIconImpl *aOwner, mozIDOMWindow* aWindow, const nsString&amp; aTitle);</span>
<a href="#l4.33"></a><span id="l4.33">   virtual ~Icon();</span>
<a href="#l4.34"></a><span id="l4.34"> </span>
<a href="#l4.35"></a><span id="l4.35">   virtual void Minimize();</span>
<a href="#l4.36"></a><span id="l4.36">   virtual void Restore();</span>
<a href="#l4.37"></a><span id="l4.37"> </span>
<a href="#l4.38"></a><span id="l4.38"> private:</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-  NS_IMETHOD Init(nsIDOMWindow *aWindow, const nsString&amp; aTitle);</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+  NS_IMETHOD Init(mozIDOMWindow *aWindow, const nsString&amp; aTitle);</span>
<a href="#l4.41"></a><span id="l4.41"> </span>
<a href="#l4.42"></a><span id="l4.42">   void buttonEvent(GdkEventButton *event);</span>
<a href="#l4.43"></a><span id="l4.43">   static void gtkButtonEvent(GtkStatusIcon*, GdkEventButton *event, Icon *icon) {</span>
<a href="#l4.44"></a><span id="l4.44">     icon-&gt;buttonEvent(event);</span>
<a href="#l4.45"></a><span id="l4.45">   }</span>
<a href="#l4.46"></a><span id="l4.46">   gboolean propertyEvent();</span>
<a href="#l4.47"></a><span id="l4.47">   gulong propertyEventId;</span>
<a href="#l4.48"></a><span id="l4.48">   static gboolean gtkPropertyEvent(GtkStatusIcon*, GdkEventProperty *event, Icon *icon) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/im/components/mintrayr/trayToolkit.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/im/components/mintrayr/trayToolkit.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5"> #include &quot;trayToolkit.h&quot;</span>
<a href="#l5.6"></a><span id="l5.6"> #include &quot;trayPlatform.h&quot;</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l5.9"></a><span id="l5.9"> #include &quot;nsStringAPI.h&quot;</span>
<a href="#l5.10"></a><span id="l5.10"> #include &quot;nsServiceManagerUtils.h&quot;</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-#include &quot;nsIDOMWindow.h&quot;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+#include &quot;mozIDOMWindow.h&quot;</span>
<a href="#l5.14"></a><span id="l5.14"> #include &quot;nsIDocument.h&quot;</span>
<a href="#l5.15"></a><span id="l5.15"> #include &quot;nsIDOMDocument.h&quot;</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17"> #include &quot;nsIDOMEvent.h&quot;</span>
<a href="#l5.18"></a><span id="l5.18"> #include &quot;nsIDOMEventTarget.h&quot;</span>
<a href="#l5.19"></a><span id="l5.19"> #include &quot;nsIDOMMouseEvent.h&quot;</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21"> #include &quot;nsIWebNavigation.h&quot;</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -26,17 +26,17 @@</span>
<a href="#l5.23"></a><span id="l5.23"> #include &quot;nsIPrefBranch2.h&quot;</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25"> #ifdef WIN32</span>
<a href="#l5.26"></a><span id="l5.26"> #define strcasecmp stricmp</span>
<a href="#l5.27"></a><span id="l5.27"> #endif</span>
<a href="#l5.28"></a><span id="l5.28"> </span>
<a href="#l5.29"></a><span id="l5.29"> namespace mintrayr {</span>
<a href="#l5.30"></a><span id="l5.30"> </span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-bool DoMinimizeWindow(nsIDOMWindow *window, eMinimizeActions action)</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+bool DoMinimizeWindow(mozIDOMWindow *window, eMinimizeActions action)</span>
<a href="#l5.33"></a><span id="l5.33"> {</span>
<a href="#l5.34"></a><span id="l5.34">   if (window == 0) {</span>
<a href="#l5.35"></a><span id="l5.35">     return false;</span>
<a href="#l5.36"></a><span id="l5.36">   }</span>
<a href="#l5.37"></a><span id="l5.37"> </span>
<a href="#l5.38"></a><span id="l5.38">   nsCOMPtr&lt;nsIPrefBranch2&gt; prefs(do_GetService(NS_PREFSERVICE_CONTRACTID));</span>
<a href="#l5.39"></a><span id="l5.39">   if (prefs) {</span>
<a href="#l5.40"></a><span id="l5.40">     PRInt32 whenToMinimize = 0;</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineat">@@ -52,17 +52,17 @@ bool DoMinimizeWindow(nsIDOMWindow *wind</span>
<a href="#l5.42"></a><span id="l5.42">     traySvc-&gt;Minimize(window, true);</span>
<a href="#l5.43"></a><span id="l5.43">   }</span>
<a href="#l5.44"></a><span id="l5.44">   return NS_SUCCEEDED(rv);</span>
<a href="#l5.45"></a><span id="l5.45"> }</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47"> /**</span>
<a href="#l5.48"></a><span id="l5.48">  * Helper: Get the base window for a DOM window</span>
<a href="#l5.49"></a><span id="l5.49">  */</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-NS_IMETHODIMP GetBaseWindow(nsIDOMWindow *aWindow, nsIBaseWindow **aBaseWindow)</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+NS_IMETHODIMP GetBaseWindow(mozIDOMWindow *aWindow, nsIBaseWindow **aBaseWindow)</span>
<a href="#l5.52"></a><span id="l5.52"> {</span>
<a href="#l5.53"></a><span id="l5.53">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.54"></a><span id="l5.54">   NS_ENSURE_ARG_POINTER(aBaseWindow);</span>
<a href="#l5.55"></a><span id="l5.55"> </span>
<a href="#l5.56"></a><span id="l5.56">   nsresult rv;</span>
<a href="#l5.57"></a><span id="l5.57"> </span>
<a href="#l5.58"></a><span id="l5.58">   nsCOMPtr&lt;nsIWebNavigation&gt; webNav = do_GetInterface(aWindow, &amp;rv);</span>
<a href="#l5.59"></a><span id="l5.59">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineat">@@ -73,17 +73,17 @@ NS_IMETHODIMP GetBaseWindow(nsIDOMWindow</span>
<a href="#l5.61"></a><span id="l5.61">   *aBaseWindow = baseWindow;</span>
<a href="#l5.62"></a><span id="l5.62">   NS_IF_ADDREF(*aBaseWindow);</span>
<a href="#l5.63"></a><span id="l5.63">   return NS_OK;</span>
<a href="#l5.64"></a><span id="l5.64"> }</span>
<a href="#l5.65"></a><span id="l5.65"> </span>
<a href="#l5.66"></a><span id="l5.66"> /**</span>
<a href="#l5.67"></a><span id="l5.67">  * Helper: Dispatch a trusted general event</span>
<a href="#l5.68"></a><span id="l5.68">  */</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineminus">-NS_IMETHODIMP DispatchTrustedEvent(nsIDOMWindow *aWindow, const nsAString&amp; aEventName)</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+NS_IMETHODIMP DispatchTrustedEvent(mozIDOMWindow *aWindow, const nsAString&amp; aEventName)</span>
<a href="#l5.71"></a><span id="l5.71"> {</span>
<a href="#l5.72"></a><span id="l5.72">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.73"></a><span id="l5.73"> </span>
<a href="#l5.74"></a><span id="l5.74">   nsresult rv;</span>
<a href="#l5.75"></a><span id="l5.75"> </span>
<a href="#l5.76"></a><span id="l5.76">   nsCOMPtr&lt;nsPIDOMWindowInner&gt; window(do_QueryInterface(aWindow));</span>
<a href="#l5.77"></a><span id="l5.77">   NS_ENSURE_STATE(window);</span>
<a href="#l5.78"></a><span id="l5.78"> </span>
<a href="#l5.79"></a><span id="l5.79" class="difflineat">@@ -106,17 +106,17 @@ NS_IMETHODIMP DispatchTrustedEvent(nsIDO</span>
<a href="#l5.80"></a><span id="l5.80">   bool dummy;</span>
<a href="#l5.81"></a><span id="l5.81">   return target-&gt;DispatchEvent(event, &amp;dummy);</span>
<a href="#l5.82"></a><span id="l5.82"> }</span>
<a href="#l5.83"></a><span id="l5.83"> </span>
<a href="#l5.84"></a><span id="l5.84"> /* TrayIconImpl */</span>
<a href="#l5.85"></a><span id="l5.85"> </span>
<a href="#l5.86"></a><span id="l5.86"> NS_IMPL_ISUPPORTS(TrayIconImpl, trayITrayIcon, nsIDOMEventListener)</span>
<a href="#l5.87"></a><span id="l5.87"> </span>
<a href="#l5.88"></a><span id="l5.88" class="difflineminus">-NS_IMETHODIMP TrayIconImpl::GetWindow(nsIDOMWindow **aWindow)</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineplus">+NS_IMETHODIMP TrayIconImpl::GetWindow(mozIDOMWindow **aWindow)</span>
<a href="#l5.90"></a><span id="l5.90"> {</span>
<a href="#l5.91"></a><span id="l5.91">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.92"></a><span id="l5.92">   *aWindow = mWindow;</span>
<a href="#l5.93"></a><span id="l5.93">   NS_ADDREF(*aWindow);</span>
<a href="#l5.94"></a><span id="l5.94">   return NS_OK;</span>
<a href="#l5.95"></a><span id="l5.95"> }</span>
<a href="#l5.96"></a><span id="l5.96"> </span>
<a href="#l5.97"></a><span id="l5.97"> NS_IMETHODIMP TrayIconImpl::GetIsMinimized(bool *aIsMinimized)</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineat">@@ -192,17 +192,17 @@ NS_IMETHODIMP TrayIconImpl::Close()</span>
<a href="#l5.99"></a><span id="l5.99"> NS_IMETHODIMP TrayIconImpl::HandleEvent(nsIDOMEvent *aEvent)</span>
<a href="#l5.100"></a><span id="l5.100"> {</span>
<a href="#l5.101"></a><span id="l5.101">   NS_ENSURE_ARG_POINTER(aEvent);</span>
<a href="#l5.102"></a><span id="l5.102">   Close();</span>
<a href="#l5.103"></a><span id="l5.103">   return NS_OK;</span>
<a href="#l5.104"></a><span id="l5.104"> }</span>
<a href="#l5.105"></a><span id="l5.105"> </span>
<a href="#l5.106"></a><span id="l5.106"> </span>
<a href="#l5.107"></a><span id="l5.107" class="difflineminus">-NS_IMETHODIMP TrayIconImpl::Init(nsIDOMWindow *aWindow, bool aCloseOnRestore)</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+NS_IMETHODIMP TrayIconImpl::Init(mozIDOMWindow *aWindow, bool aCloseOnRestore)</span>
<a href="#l5.109"></a><span id="l5.109"> {</span>
<a href="#l5.110"></a><span id="l5.110">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.111"></a><span id="l5.111"> </span>
<a href="#l5.112"></a><span id="l5.112">   nsresult rv;</span>
<a href="#l5.113"></a><span id="l5.113"> </span>
<a href="#l5.114"></a><span id="l5.114">   mCloseOnRestore = aCloseOnRestore;</span>
<a href="#l5.115"></a><span id="l5.115"> </span>
<a href="#l5.116"></a><span id="l5.116">   nsCOMPtr&lt;nsIDOMEventTarget&gt; target = do_QueryInterface(aWindow, &amp;rv);</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineat">@@ -299,25 +299,25 @@ void TrayServiceImpl::Destroy() {</span>
<a href="#l5.118"></a><span id="l5.118">   UnwatchAll();</span>
<a href="#l5.119"></a><span id="l5.119">   RestoreAll();</span>
<a href="#l5.120"></a><span id="l5.120"> </span>
<a href="#l5.121"></a><span id="l5.121">   // Better be safe :p</span>
<a href="#l5.122"></a><span id="l5.122">   mIcons.Clear();</span>
<a href="#l5.123"></a><span id="l5.123">   mWatches.Clear();</span>
<a href="#l5.124"></a><span id="l5.124"> }</span>
<a href="#l5.125"></a><span id="l5.125"> </span>
<a href="#l5.126"></a><span id="l5.126" class="difflineminus">-NS_IMETHODIMP TrayServiceImpl::CreateIcon(nsIDOMWindow *aWindow, bool aCloseOnRestore, trayITrayIcon **aResult)</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+NS_IMETHODIMP TrayServiceImpl::CreateIcon(mozIDOMWindow *aWindow, bool aCloseOnRestore, trayITrayIcon **aResult)</span>
<a href="#l5.128"></a><span id="l5.128"> {</span>
<a href="#l5.129"></a><span id="l5.129">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.130"></a><span id="l5.130"> </span>
<a href="#l5.131"></a><span id="l5.131">   nsresult rv;</span>
<a href="#l5.132"></a><span id="l5.132">   const PRInt32 count = mIcons.Count();</span>
<a href="#l5.133"></a><span id="l5.133"> </span>
<a href="#l5.134"></a><span id="l5.134">   for (PRInt32 i = 0; i &lt; count; ++i) {</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineminus">-    nsCOMPtr&lt;nsIDOMWindow&gt; domWindow;</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+    nsCOMPtr&lt;mozIDOMWindow&gt; domWindow;</span>
<a href="#l5.137"></a><span id="l5.137">     rv = mIcons[i]-&gt;GetWindow(getter_AddRefs(domWindow));</span>
<a href="#l5.138"></a><span id="l5.138">     if (NS_FAILED(rv)) {</span>
<a href="#l5.139"></a><span id="l5.139">       continue;</span>
<a href="#l5.140"></a><span id="l5.140">     }</span>
<a href="#l5.141"></a><span id="l5.141">     if (domWindow != aWindow) {</span>
<a href="#l5.142"></a><span id="l5.142">       continue;</span>
<a href="#l5.143"></a><span id="l5.143">     }</span>
<a href="#l5.144"></a><span id="l5.144">     *aResult = mIcons[i];</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineat">@@ -340,79 +340,79 @@ NS_IMETHODIMP TrayServiceImpl::RestoreAl</span>
<a href="#l5.146"></a><span id="l5.146"> {</span>
<a href="#l5.147"></a><span id="l5.147">   const PRInt32 count = mIcons.Count();</span>
<a href="#l5.148"></a><span id="l5.148">   for (PRInt32 i = count - 1; i &gt; -1; --i) {</span>
<a href="#l5.149"></a><span id="l5.149">     mIcons[i]-&gt;Restore();</span>
<a href="#l5.150"></a><span id="l5.150">   }</span>
<a href="#l5.151"></a><span id="l5.151">   return NS_OK;</span>
<a href="#l5.152"></a><span id="l5.152"> }</span>
<a href="#l5.153"></a><span id="l5.153"> </span>
<a href="#l5.154"></a><span id="l5.154" class="difflineminus">-NS_IMETHODIMP TrayServiceImpl::WatchMinimize(nsIDOMWindow *aWindow)</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+NS_IMETHODIMP TrayServiceImpl::WatchMinimize(mozIDOMWindow *aWindow)</span>
<a href="#l5.156"></a><span id="l5.156"> {</span>
<a href="#l5.157"></a><span id="l5.157">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.158"></a><span id="l5.158"> </span>
<a href="#l5.159"></a><span id="l5.159">   const PRInt32 index = mWatches.IndexOf(aWindow);</span>
<a href="#l5.160"></a><span id="l5.160">   if (index != -1) {</span>
<a href="#l5.161"></a><span id="l5.161">     return NS_OK;</span>
<a href="#l5.162"></a><span id="l5.162">   }</span>
<a href="#l5.163"></a><span id="l5.163"> </span>
<a href="#l5.164"></a><span id="l5.164">   if (!NS_SUCCEEDED(platform::WatchWindow(aWindow))) {</span>
<a href="#l5.165"></a><span id="l5.165">     return NS_ERROR_INVALID_ARG;</span>
<a href="#l5.166"></a><span id="l5.166">   }</span>
<a href="#l5.167"></a><span id="l5.167">   mWatches.AppendObject(aWindow);</span>
<a href="#l5.168"></a><span id="l5.168">   return NS_OK;</span>
<a href="#l5.169"></a><span id="l5.169"> }</span>
<a href="#l5.170"></a><span id="l5.170"> </span>
<a href="#l5.171"></a><span id="l5.171" class="difflineminus">-NS_IMETHODIMP TrayServiceImpl::UnwatchMinimize(nsIDOMWindow *aWindow)</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineplus">+NS_IMETHODIMP TrayServiceImpl::UnwatchMinimize(mozIDOMWindow *aWindow)</span>
<a href="#l5.173"></a><span id="l5.173"> {</span>
<a href="#l5.174"></a><span id="l5.174">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.175"></a><span id="l5.175"> </span>
<a href="#l5.176"></a><span id="l5.176">   if (NS_SUCCEEDED(platform::UnwatchWindow(aWindow))) {</span>
<a href="#l5.177"></a><span id="l5.177">     return NS_ERROR_INVALID_ARG;</span>
<a href="#l5.178"></a><span id="l5.178">   }</span>
<a href="#l5.179"></a><span id="l5.179">   mWatches.RemoveObject(aWindow);</span>
<a href="#l5.180"></a><span id="l5.180">   return NS_OK;</span>
<a href="#l5.181"></a><span id="l5.181"> }</span>
<a href="#l5.182"></a><span id="l5.182"> </span>
<a href="#l5.183"></a><span id="l5.183" class="difflineminus">-NS_IMETHODIMP TrayServiceImpl::Minimize(nsIDOMWindow *aWindow, bool aCloseOnRestore)</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+NS_IMETHODIMP TrayServiceImpl::Minimize(mozIDOMWindow *aWindow, bool aCloseOnRestore)</span>
<a href="#l5.185"></a><span id="l5.185"> {</span>
<a href="#l5.186"></a><span id="l5.186">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.187"></a><span id="l5.187"> </span>
<a href="#l5.188"></a><span id="l5.188">   nsresult rv;</span>
<a href="#l5.189"></a><span id="l5.189"> </span>
<a href="#l5.190"></a><span id="l5.190">   nsCOMPtr&lt;trayITrayIcon&gt; icon;</span>
<a href="#l5.191"></a><span id="l5.191">   rv = CreateIcon(aWindow, aCloseOnRestore, getter_AddRefs(icon));</span>
<a href="#l5.192"></a><span id="l5.192">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.193"></a><span id="l5.193"> </span>
<a href="#l5.194"></a><span id="l5.194">   rv = icon-&gt;Minimize();</span>
<a href="#l5.195"></a><span id="l5.195">   return rv;</span>
<a href="#l5.196"></a><span id="l5.196"> }</span>
<a href="#l5.197"></a><span id="l5.197"> </span>
<a href="#l5.198"></a><span id="l5.198" class="difflineminus">-NS_IMETHODIMP TrayServiceImpl::Restore(nsIDOMWindow *aWindow)</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+NS_IMETHODIMP TrayServiceImpl::Restore(mozIDOMWindow *aWindow)</span>
<a href="#l5.200"></a><span id="l5.200"> {</span>
<a href="#l5.201"></a><span id="l5.201">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.202"></a><span id="l5.202"> </span>
<a href="#l5.203"></a><span id="l5.203">   nsresult rv;</span>
<a href="#l5.204"></a><span id="l5.204">   const PRInt32 count = mIcons.Count();</span>
<a href="#l5.205"></a><span id="l5.205"> </span>
<a href="#l5.206"></a><span id="l5.206">   for (PRInt32 i = 0; i &lt; count; ++i) {</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineminus">-    nsCOMPtr&lt;nsIDOMWindow&gt; domWindow;</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+    nsCOMPtr&lt;mozIDOMWindow&gt; domWindow;</span>
<a href="#l5.209"></a><span id="l5.209">     rv = mIcons[i]-&gt;GetWindow(getter_AddRefs(domWindow));</span>
<a href="#l5.210"></a><span id="l5.210">     if (NS_FAILED(rv)) {</span>
<a href="#l5.211"></a><span id="l5.211">       continue;</span>
<a href="#l5.212"></a><span id="l5.212">     }</span>
<a href="#l5.213"></a><span id="l5.213">     if (domWindow != aWindow) {</span>
<a href="#l5.214"></a><span id="l5.214">       continue;</span>
<a href="#l5.215"></a><span id="l5.215">     }</span>
<a href="#l5.216"></a><span id="l5.216">     return mIcons[i]-&gt;Restore();</span>
<a href="#l5.217"></a><span id="l5.217">   }</span>
<a href="#l5.218"></a><span id="l5.218">   return NS_ERROR_INVALID_ARG;</span>
<a href="#l5.219"></a><span id="l5.219"> }</span>
<a href="#l5.220"></a><span id="l5.220"> </span>
<a href="#l5.221"></a><span id="l5.221" class="difflineminus">-NS_IMETHODIMP TrayServiceImpl::IsWatchedWindow(nsIDOMWindow *aWindow, bool *aResult)</span>
<a href="#l5.222"></a><span id="l5.222" class="difflineplus">+NS_IMETHODIMP TrayServiceImpl::IsWatchedWindow(mozIDOMWindow *aWindow, bool *aResult)</span>
<a href="#l5.223"></a><span id="l5.223"> {</span>
<a href="#l5.224"></a><span id="l5.224">   NS_ENSURE_ARG_POINTER(aWindow);</span>
<a href="#l5.225"></a><span id="l5.225">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l5.226"></a><span id="l5.226"> </span>
<a href="#l5.227"></a><span id="l5.227">   *aResult = mWatches.IndexOfObject(aWindow) != -1 ? true : false;</span>
<a href="#l5.228"></a><span id="l5.228">   return NS_OK;</span>
<a href="#l5.229"></a><span id="l5.229"> }</span>
<a href="#l5.230"></a><span id="l5.230"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/im/components/mintrayr/trayToolkit.h</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/im/components/mintrayr/trayToolkit.h</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -9,17 +9,17 @@</span>
<a href="#l6.4"></a><span id="l6.4"> </span>
<a href="#l6.5"></a><span id="l6.5"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l6.6"></a><span id="l6.6"> #include &quot;nsCOMPtr.h&quot;</span>
<a href="#l6.7"></a><span id="l6.7"> #include &quot;nsAutoPtr.h&quot;</span>
<a href="#l6.8"></a><span id="l6.8"> #include &quot;nsPoint.h&quot;</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10"> #include &quot;nsIDOMEventListener.h&quot;</span>
<a href="#l6.11"></a><span id="l6.11"> #include &quot;nsIBaseWindow.h&quot;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-#include &quot;nsIDOMWindow.h&quot;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+#include &quot;mozIDOMWindow.h&quot;</span>
<a href="#l6.14"></a><span id="l6.14"> </span>
<a href="#l6.15"></a><span id="l6.15"> #include &quot;trayIToolkit.h&quot;</span>
<a href="#l6.16"></a><span id="l6.16"> #include &quot;trayPlatform.h&quot;</span>
<a href="#l6.17"></a><span id="l6.17"> #include &quot;nsXPCOMStrings.h&quot;</span>
<a href="#l6.18"></a><span id="l6.18"> #include &quot;nsIObserver.h&quot;</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21"> #define TRAYSERVICE_CONTRACTID &quot;@tn123.ath.cx/trayservice;1&quot;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineat">@@ -33,40 +33,40 @@ namespace mintrayr {</span>
<a href="#l6.23"></a><span id="l6.23"> typedef enum _eMinimizeActions {</span>
<a href="#l6.24"></a><span id="l6.24">   kTrayOnMinimize = (1 &lt;&lt; 0),</span>
<a href="#l6.25"></a><span id="l6.25">   kTrayOnClose = (1 &lt;&lt; 1)</span>
<a href="#l6.26"></a><span id="l6.26"> } eMinimizeActions;</span>
<a href="#l6.27"></a><span id="l6.27"> </span>
<a href="#l6.28"></a><span id="l6.28"> /**</span>
<a href="#l6.29"></a><span id="l6.29">  * Helper for watch: Minimize a window if a configured for the action</span>
<a href="#l6.30"></a><span id="l6.30">  */</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-bool DoMinimizeWindow(nsIDOMWindow *window, eMinimizeActions action);</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+bool DoMinimizeWindow(mozIDOMWindow *window, eMinimizeActions action);</span>
<a href="#l6.33"></a><span id="l6.33"> </span>
<a href="#l6.34"></a><span id="l6.34"> /**</span>
<a href="#l6.35"></a><span id="l6.35">  * Helper: Gets the base window</span>
<a href="#l6.36"></a><span id="l6.36">  */</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-NS_IMETHODIMP GetBaseWindow(nsIDOMWindow *aWindow, nsIBaseWindow **aBaseWindow);</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+NS_IMETHODIMP GetBaseWindow(mozIDOMWindow *aWindow, nsIBaseWindow **aBaseWindow);</span>
<a href="#l6.39"></a><span id="l6.39"> </span>
<a href="#l6.40"></a><span id="l6.40"> /**</span>
<a href="#l6.41"></a><span id="l6.41">  * Helper: Dispatches a trusted event (i.e. chrome only)</span>
<a href="#l6.42"></a><span id="l6.42">  */</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-NS_IMETHODIMP DispatchTrustedEvent(nsIDOMWindow *aWindow, const nsAString&amp; aEventName);</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+NS_IMETHODIMP DispatchTrustedEvent(mozIDOMWindow *aWindow, const nsAString&amp; aEventName);</span>
<a href="#l6.45"></a><span id="l6.45"> </span>
<a href="#l6.46"></a><span id="l6.46"> class TrayServiceImpl;</span>
<a href="#l6.47"></a><span id="l6.47"> </span>
<a href="#l6.48"></a><span id="l6.48"> /**</span>
<a href="#l6.49"></a><span id="l6.49">  * The implementation for trayITrayIcon</span>
<a href="#l6.50"></a><span id="l6.50">  */</span>
<a href="#l6.51"></a><span id="l6.51"> class TrayIconImpl final : public trayITrayIcon, nsIDOMEventListener {</span>
<a href="#l6.52"></a><span id="l6.52">   friend class platform::Icon;</span>
<a href="#l6.53"></a><span id="l6.53"> </span>
<a href="#l6.54"></a><span id="l6.54"> private:</span>
<a href="#l6.55"></a><span id="l6.55">   ~TrayIconImpl() {}</span>
<a href="#l6.56"></a><span id="l6.56">   bool mIsMinimized;</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-  nsCOMPtr&lt;nsIDOMWindow&gt; mWindow;</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+  nsCOMPtr&lt;mozIDOMWindow&gt; mWindow;</span>
<a href="#l6.59"></a><span id="l6.59"> </span>
<a href="#l6.60"></a><span id="l6.60">   bool mCloseOnRestore;</span>
<a href="#l6.61"></a><span id="l6.61"> </span>
<a href="#l6.62"></a><span id="l6.62">   bool mClosed;</span>
<a href="#l6.63"></a><span id="l6.63">   TrayServiceImpl *mService;</span>
<a href="#l6.64"></a><span id="l6.64">   nsAutoPtr&lt;platform::Icon&gt; mPlatformIcon;</span>
<a href="#l6.65"></a><span id="l6.65"> </span>
<a href="#l6.66"></a><span id="l6.66"> public:</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineat">@@ -76,17 +76,17 @@ public:</span>
<a href="#l6.68"></a><span id="l6.68"> </span>
<a href="#l6.69"></a><span id="l6.69">   TrayIconImpl(TrayServiceImpl *aService)</span>
<a href="#l6.70"></a><span id="l6.70">     : mIsMinimized(false),</span>
<a href="#l6.71"></a><span id="l6.71">     mCloseOnRestore(false),</span>
<a href="#l6.72"></a><span id="l6.72">     mClosed(false),</span>
<a href="#l6.73"></a><span id="l6.73">     mService(aService)</span>
<a href="#l6.74"></a><span id="l6.74">     {}</span>
<a href="#l6.75"></a><span id="l6.75"> </span>
<a href="#l6.76"></a><span id="l6.76" class="difflineminus">-  NS_IMETHOD Init(nsIDOMWindow *aWindow, bool aCloseOnRestore);</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineplus">+  NS_IMETHOD Init(mozIDOMWindow *aWindow, bool aCloseOnRestore);</span>
<a href="#l6.78"></a><span id="l6.78">   NS_IMETHOD DispatchMouseEvent(const nsAString&amp; aEventName, PRUint16 aButton, nsPoint&amp; pt, bool aCtrlKey, bool aAltKey, bool aShiftKey);</span>
<a href="#l6.79"></a><span id="l6.79">   inline bool IsClosed() const { return mClosed; }</span>
<a href="#l6.80"></a><span id="l6.80"> };</span>
<a href="#l6.81"></a><span id="l6.81"> </span>
<a href="#l6.82"></a><span id="l6.82"> /**</span>
<a href="#l6.83"></a><span id="l6.83">  * The implementation for trayITrayService</span>
<a href="#l6.84"></a><span id="l6.84">  */</span>
<a href="#l6.85"></a><span id="l6.85"> class TrayServiceImpl final : public trayITrayService, nsIObserver {</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineat">@@ -95,17 +95,17 @@ public:</span>
<a href="#l6.87"></a><span id="l6.87">   NS_DECL_ISUPPORTS</span>
<a href="#l6.88"></a><span id="l6.88">   NS_DECL_NSIOBSERVER</span>
<a href="#l6.89"></a><span id="l6.89">   NS_DECL_TRAYITRAYSERVICE</span>
<a href="#l6.90"></a><span id="l6.90"> </span>
<a href="#l6.91"></a><span id="l6.91">   TrayServiceImpl();</span>
<a href="#l6.92"></a><span id="l6.92"> </span>
<a href="#l6.93"></a><span id="l6.93"> private:</span>
<a href="#l6.94"></a><span id="l6.94">   nsCOMArray&lt;trayITrayIcon&gt; mIcons;</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineminus">-  nsCOMArray&lt;nsIDOMWindow&gt; mWatches;</span>
<a href="#l6.96"></a><span id="l6.96" class="difflineplus">+  nsCOMArray&lt;mozIDOMWindow&gt; mWatches;</span>
<a href="#l6.97"></a><span id="l6.97"> </span>
<a href="#l6.98"></a><span id="l6.98"> private:</span>
<a href="#l6.99"></a><span id="l6.99">   ~TrayServiceImpl();</span>
<a href="#l6.100"></a><span id="l6.100">   void Destroy();</span>
<a href="#l6.101"></a><span id="l6.101"> </span>
<a href="#l6.102"></a><span id="l6.102">   void UnwatchAll();</span>
<a href="#l6.103"></a><span id="l6.103"> </span>
<a href="#l6.104"></a><span id="l6.104">   void CloseIcon(trayITrayIcon *aIcon);</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

