<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 9667:1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab" />
<meta property="og:url" content="/comm-central/rev/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab" />
<meta property="og:description" content="Bug 734446 - Some feed subscribe enhancements:" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">shortlog</a> |
<a href="/comm-central/log/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">files</a> |
changeset |
<a href="/comm-central/raw-rev/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">raw</a>  | <a href="/comm-central/archive/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=734446">Bug 734446</a> - Some feed subscribe enhancements:
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#97;&#108;&#116;&#97;&#56;&#56;&#32;&#60;&#97;&#108;&#116;&#97;&#56;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 10 Mar 2012 10:53:04 -0700</td></tr>

<tr>
 <td>changeset 9667</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab</a></td>
</tr>



<tr>
<td>parent 9666</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/cdc68c9020884a0d34205495ccc67d0d66fbac0e">cdc68c9020884a0d34205495ccc67d0d66fbac0e</a>
</td>
</tr>

<tr>
<td>child 9668</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/0294ba99ce0a0f181759f42dd890ab27a0fc8276">0294ba99ce0a0f181759f42dd890ab27a0fc8276</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">7393</a></td></tr>
<tr><td>push user</td><td>ryanvm@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 16 Mar 2012 00:23:17 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1d833a1dba7a [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&newProject=comm-central&newRevision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&newProject=comm-central&newRevision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&newProject=comm-central&newRevision=1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>

<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=734446">734446</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=734446">Bug 734446</a> - Some feed subscribe enhancements:
1. Add Validate link for existing feeds, not just those that fail on add.
2. Update subscribe dialog on feed dnd in folderpane.
3. Fix tree view update on open folder removal bug.
4. Fix dnd move if index changes on folder hover/open.

r=dbienvenu</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">file</a> |
<a href="/comm-central/annotate/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">annotate</a> |
<a href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">diff</a> |
<a href="/comm-central/comparison/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">comparison</a> |
<a href="/comm-central/log/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.js">mailnews/extensions/newsblog/content/feed-subscriptions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.js">file</a> |
<a href="/comm-central/annotate/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.js">annotate</a> |
<a href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.js">diff</a> |
<a href="/comm-central/comparison/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.js">comparison</a> |
<a href="/comm-central/log/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.xul">mailnews/extensions/newsblog/content/feed-subscriptions.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.xul">file</a> |
<a href="/comm-central/annotate/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.xul">annotate</a> |
<a href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.xul">diff</a> |
<a href="/comm-central/comparison/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.xul">comparison</a> |
<a href="/comm-central/log/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/feed-subscriptions.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/utils.js">mailnews/extensions/newsblog/content/utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/utils.js">file</a> |
<a href="/comm-central/annotate/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/utils.js">annotate</a> |
<a href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/utils.js">diff</a> |
<a href="/comm-central/comparison/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/utils.js">comparison</a> |
<a href="/comm-central/log/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/mailnews/extensions/newsblog/content/utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">file</a> |
<a href="/comm-central/annotate/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">annotate</a> |
<a href="/comm-central/diff/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">diff</a> |
<a href="/comm-central/comparison/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">comparison</a> |
<a href="/comm-central/log/1d833a1dba7a688b87efefc1ba6b39f7d9bad6ab/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger-newsblog/feed-subscriptions.dtd</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -10,16 +10,17 @@</span>
<a href="#l1.4"></a><span id="l1.4"> &lt;!ENTITY feedLocation.placeholder    &quot;Enter a valid feed url to Add&quot;&gt;</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> &lt;!ENTITY feedFolder.label            &quot;Store Articles in:&quot;&gt;</span>
<a href="#l1.7"></a><span id="l1.7"> &lt;!ENTITY feedFolder.accesskey        &quot;S&quot;&gt;</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9"> &lt;!ENTITY quickMode.label             &quot;Show the article summary instead of loading the web page&quot;&gt;</span>
<a href="#l1.10"></a><span id="l1.10"> &lt;!ENTITY quickMode.accesskey         &quot;h&quot;&gt;</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+&lt;!ENTITY locationValidate.label      &quot;Validate&quot;&gt;</span>
<a href="#l1.13"></a><span id="l1.13"> &lt;!ENTITY validateText.label          &quot;Check validation and retrieve a valid url.&quot;&gt;</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> &lt;!ENTITY button.addFeed.label        &quot;Add&quot;&gt;</span>
<a href="#l1.16"></a><span id="l1.16"> &lt;!ENTITY button.addFeed.accesskey    &quot;A&quot;&gt;</span>
<a href="#l1.17"></a><span id="l1.17"> &lt;!ENTITY button.editFeed.label       &quot;Update&quot;&gt;</span>
<a href="#l1.18"></a><span id="l1.18"> &lt;!ENTITY button.editFeed.accesskey   &quot;U&quot;&gt;</span>
<a href="#l1.19"></a><span id="l1.19"> &lt;!ENTITY button.removeFeed.label     &quot;Remove&quot;&gt;</span>
<a href="#l1.20"></a><span id="l1.20"> &lt;!ENTITY button.removeFeed.accesskey &quot;R&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/feed-subscriptions.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/feed-subscriptions.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -268,16 +268,20 @@ var gFeedSubscriptionsWindow = {</span>
<a href="#l2.4"></a><span id="l2.4">     },</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">     removeItemAtIndex: function (aRow, aNoSelect)</span>
<a href="#l2.7"></a><span id="l2.7">     {</span>
<a href="#l2.8"></a><span id="l2.8">       let itemToRemove = this.getItemAtIndex(aRow);</span>
<a href="#l2.9"></a><span id="l2.9">       if (!itemToRemove)</span>
<a href="#l2.10"></a><span id="l2.10">         return;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+      if (itemToRemove.container &amp;&amp; itemToRemove.open)</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        // Close it, if open container.</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+        this.toggle(aRow);</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+</span>
<a href="#l2.16"></a><span id="l2.16">       let parentIndex = this.getParentIndex(aRow);</span>
<a href="#l2.17"></a><span id="l2.17">       let hasNextSibling = this.hasNextSibling(aRow, aRow);</span>
<a href="#l2.18"></a><span id="l2.18">       if (parentIndex != this.kRowIndexUndefined)</span>
<a href="#l2.19"></a><span id="l2.19">       {</span>
<a href="#l2.20"></a><span id="l2.20">         let parent = this.getItemAtIndex(parentIndex);</span>
<a href="#l2.21"></a><span id="l2.21">         if (parent)</span>
<a href="#l2.22"></a><span id="l2.22">         {</span>
<a href="#l2.23"></a><span id="l2.23">           for (let index = 0; index &lt; parent.children.length; index++)</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineat">@@ -393,17 +397,18 @@ var gFeedSubscriptionsWindow = {</span>
<a href="#l2.25"></a><span id="l2.25">           if (uri.schemeIs(&quot;http&quot;) || uri.schemeIs(&quot;https&quot;))</span>
<a href="#l2.26"></a><span id="l2.26">           {</span>
<a href="#l2.27"></a><span id="l2.27">             urlToDrop = uri.spec;</span>
<a href="#l2.28"></a><span id="l2.28">             canDrop = true;</span>
<a href="#l2.29"></a><span id="l2.29">           }</span>
<a href="#l2.30"></a><span id="l2.30">         }</span>
<a href="#l2.31"></a><span id="l2.31">         else if (flavor.value == &quot;text/x-moz-feed-index&quot;)</span>
<a href="#l2.32"></a><span id="l2.32">         {</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">-          sourceIndex = parseInt(sourceUri);</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+          if (this.selection)</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+            sourceIndex = this.selection.currentIndex;</span>
<a href="#l2.36"></a><span id="l2.36">           canDrop = true;</span>
<a href="#l2.37"></a><span id="l2.37">         }</span>
<a href="#l2.38"></a><span id="l2.38">       }  // if dataObj.value</span>
<a href="#l2.39"></a><span id="l2.39"> </span>
<a href="#l2.40"></a><span id="l2.40">       return { canDrop: canDrop, url: urlToDrop, index: sourceIndex };</span>
<a href="#l2.41"></a><span id="l2.41">     },</span>
<a href="#l2.42"></a><span id="l2.42"> </span>
<a href="#l2.43"></a><span id="l2.43">     getParentIndex: function (aRow)</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineat">@@ -772,37 +777,40 @@ var gFeedSubscriptionsWindow = {</span>
<a href="#l2.45"></a><span id="l2.45"> </span>
<a href="#l2.46"></a><span id="l2.46">   updateFeedData: function (aItem)</span>
<a href="#l2.47"></a><span id="l2.47">   {</span>
<a href="#l2.48"></a><span id="l2.48">     if (!aItem)</span>
<a href="#l2.49"></a><span id="l2.49">       return;</span>
<a href="#l2.50"></a><span id="l2.50"> </span>
<a href="#l2.51"></a><span id="l2.51">     let nameValue = document.getElementById(&quot;nameValue&quot;);</span>
<a href="#l2.52"></a><span id="l2.52">     let locationValue = document.getElementById(&quot;locationValue&quot;);</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineplus">+    let locationValidate = document.getElementById(&quot;locationValidate&quot;);</span>
<a href="#l2.54"></a><span id="l2.54">     let selectFolder = document.getElementById(&quot;selectFolder&quot;);</span>
<a href="#l2.55"></a><span id="l2.55">     let rssAccountMenuItem = document.getElementById(&quot;rssAccountMenuItem&quot;);</span>
<a href="#l2.56"></a><span id="l2.56">     let server, rootFolder, displayFolder;</span>
<a href="#l2.57"></a><span id="l2.57"> </span>
<a href="#l2.58"></a><span id="l2.58">     if (!aItem.container)</span>
<a href="#l2.59"></a><span id="l2.59">     {</span>
<a href="#l2.60"></a><span id="l2.60">       // A feed item.  Set the feed location and title info.</span>
<a href="#l2.61"></a><span id="l2.61">       nameValue.value = aItem.name;</span>
<a href="#l2.62"></a><span id="l2.62">       locationValue.value = aItem.url;</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineplus">+      locationValidate.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l2.64"></a><span id="l2.64"> </span>
<a href="#l2.65"></a><span id="l2.65">       // Root the location picker to the news &amp; blogs server.</span>
<a href="#l2.66"></a><span id="l2.66">       server = aItem.parentFolder.server;</span>
<a href="#l2.67"></a><span id="l2.67">       rootFolder = aItem.parentFolder.rootFolder;</span>
<a href="#l2.68"></a><span id="l2.68">       displayFolder = aItem.parentFolder;</span>
<a href="#l2.69"></a><span id="l2.69">     }</span>
<a href="#l2.70"></a><span id="l2.70">     else</span>
<a href="#l2.71"></a><span id="l2.71">     {</span>
<a href="#l2.72"></a><span id="l2.72">       // A folder/container item.</span>
<a href="#l2.73"></a><span id="l2.73">       nameValue.value = &quot;&quot;;</span>
<a href="#l2.74"></a><span id="l2.74">       nameValue.disabled = true;</span>
<a href="#l2.75"></a><span id="l2.75">       locationValue.value = &quot;&quot;;</span>
<a href="#l2.76"></a><span id="l2.76" class="difflineplus">+      locationValidate.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l2.77"></a><span id="l2.77"> </span>
<a href="#l2.78"></a><span id="l2.78">       server = aItem.folder.server;</span>
<a href="#l2.79"></a><span id="l2.79">       rootFolder = aItem.folder.rootFolder;</span>
<a href="#l2.80"></a><span id="l2.80">       displayFolder = aItem.folder;</span>
<a href="#l2.81"></a><span id="l2.81">     }</span>
<a href="#l2.82"></a><span id="l2.82"> </span>
<a href="#l2.83"></a><span id="l2.83">     // Common to both folder and feed items.</span>
<a href="#l2.84"></a><span id="l2.84">     nameValue.disabled = aItem.container;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/feed-subscriptions.xul</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/feed-subscriptions.xul</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -122,22 +122,31 @@</span>
<a href="#l3.4"></a><span id="l3.4">             &lt;/row&gt;</span>
<a href="#l3.5"></a><span id="l3.5">             &lt;row&gt;</span>
<a href="#l3.6"></a><span id="l3.6">               &lt;hbox align=&quot;right&quot; valign=&quot;middle&quot;&gt;</span>
<a href="#l3.7"></a><span id="l3.7">                 &lt;label id=&quot;locationLabel&quot;</span>
<a href="#l3.8"></a><span id="l3.8">                        accesskey=&quot;&amp;feedLocation.accesskey;&quot;</span>
<a href="#l3.9"></a><span id="l3.9">                        control=&quot;locationValue&quot;</span>
<a href="#l3.10"></a><span id="l3.10">                        value=&quot;&amp;feedLocation.label;&quot;/&gt;</span>
<a href="#l3.11"></a><span id="l3.11">               &lt;/hbox&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-              &lt;textbox id=&quot;locationValue&quot;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-                       class=&quot;uri-element&quot;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-                       placeholder=&quot;&amp;feedLocation.placeholder;&quot;</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-                       clickSelectsAll=&quot;true&quot;</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-                       onfocus=&quot;gFeedSubscriptionsWindow.setSummaryFocus();&quot;</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-                       onblur=&quot;gFeedSubscriptionsWindow.setSummaryFocus();&quot;/&gt;</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+              &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+                &lt;textbox id=&quot;locationValue&quot;</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+                         flex=&quot;1&quot;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+                         class=&quot;uri-element&quot;</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+                         placeholder=&quot;&amp;feedLocation.placeholder;&quot;</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+                         clickSelectsAll=&quot;true&quot;</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+                         onfocus=&quot;gFeedSubscriptionsWindow.setSummaryFocus();&quot;</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+                         onblur=&quot;gFeedSubscriptionsWindow.setSummaryFocus();&quot;/&gt;</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+                &lt;label id=&quot;locationValidate&quot;</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+                       collapsed=&quot;true&quot;</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+                       class=&quot;text-link&quot;</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+                       crop=&quot;end&quot;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+                       value=&quot;&amp;locationValidate.label;&quot;</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+                       onclick=&quot;gFeedSubscriptionsWindow.checkValidation(event);&quot;/&gt;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l3.33"></a><span id="l3.33">             &lt;/row&gt;</span>
<a href="#l3.34"></a><span id="l3.34">             &lt;row&gt;</span>
<a href="#l3.35"></a><span id="l3.35">               &lt;hbox align=&quot;right&quot; valign=&quot;middle&quot;&gt;</span>
<a href="#l3.36"></a><span id="l3.36">                 &lt;label id=&quot;feedFolderLabel&quot;</span>
<a href="#l3.37"></a><span id="l3.37">                        value=&quot;&amp;feedFolder.label;&quot;</span>
<a href="#l3.38"></a><span id="l3.38">                        accesskey=&quot;&amp;feedFolder.accesskey;&quot;</span>
<a href="#l3.39"></a><span id="l3.39">                        control=&quot;selectFolder&quot;/&gt;</span>
<a href="#l3.40"></a><span id="l3.40">               &lt;/hbox&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/utils.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/utils.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -109,16 +109,22 @@ var FeedUtils = {</span>
<a href="#l4.4"></a><span id="l4.4">           // Add feed just adds the feed to the subscription UI and flushes the</span>
<a href="#l4.5"></a><span id="l4.5">           // datasource.</span>
<a href="#l4.6"></a><span id="l4.6">           addFeed(feed.url, feed.name, feed.folder);</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8">           // Nice touch: select the folder that now contains the newly subscribed</span>
<a href="#l4.9"></a><span id="l4.9">           // feed.  This is particularly nice if we just finished subscribing</span>
<a href="#l4.10"></a><span id="l4.10">           // to a feed URL that the operating system gave us.</span>
<a href="#l4.11"></a><span id="l4.11">           this.mMsgWindow.windowCommands.selectFolder(feed.folder.URI);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+          // Check for an existing feed subscriptions window and update it.</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+          let subscriptionsWindow =</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+              Services.wm.getMostRecentWindow(&quot;Mail:News-BlogSubscriptions&quot;);</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+          if (subscriptionsWindow)</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+            subscriptionsWindow.gFeedSubscriptionsWindow.refreshSubscriptionView();</span>
<a href="#l4.18"></a><span id="l4.18">         }</span>
<a href="#l4.19"></a><span id="l4.19">         else</span>
<a href="#l4.20"></a><span id="l4.20">         {</span>
<a href="#l4.21"></a><span id="l4.21">           // Non success.  Remove intermediate traces from the feeds database.</span>
<a href="#l4.22"></a><span id="l4.22">           if (feed &amp;&amp; feed.url &amp;&amp; feed.server)</span>
<a href="#l4.23"></a><span id="l4.23">             deleteFeed(rdf.GetResource(feed.url),</span>
<a href="#l4.24"></a><span id="l4.24">                        feed.server,</span>
<a href="#l4.25"></a><span id="l4.25">                        feed.server.rootFolder);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/newsblog/feed-subscriptions.dtd</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -10,16 +10,17 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;!ENTITY feedLocation.placeholder    &quot;Enter a valid feed url to Add&quot;&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6"> &lt;!ENTITY feedFolder.label            &quot;Store Articles in:&quot;&gt;</span>
<a href="#l5.7"></a><span id="l5.7"> &lt;!ENTITY feedFolder.accesskey        &quot;S&quot;&gt;</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9"> &lt;!ENTITY quickMode.label             &quot;Show the article summary instead of loading the web page&quot;&gt;</span>
<a href="#l5.10"></a><span id="l5.10"> &lt;!ENTITY quickMode.accesskey         &quot;h&quot;&gt;</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+&lt;!ENTITY locationValidate.label      &quot;Validate&quot;&gt;</span>
<a href="#l5.13"></a><span id="l5.13"> &lt;!ENTITY validateText.label          &quot;Check validation and retrieve a valid url.&quot;&gt;</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15"> &lt;!ENTITY button.addFeed.label        &quot;Add&quot;&gt;</span>
<a href="#l5.16"></a><span id="l5.16"> &lt;!ENTITY button.addFeed.accesskey    &quot;A&quot;&gt;</span>
<a href="#l5.17"></a><span id="l5.17"> &lt;!ENTITY button.editFeed.label       &quot;Update&quot;&gt;</span>
<a href="#l5.18"></a><span id="l5.18"> &lt;!ENTITY button.editFeed.accesskey   &quot;U&quot;&gt;</span>
<a href="#l5.19"></a><span id="l5.19"> &lt;!ENTITY button.removeFeed.label     &quot;Remove&quot;&gt;</span>
<a href="#l5.20"></a><span id="l5.20"> &lt;!ENTITY button.removeFeed.accesskey &quot;R&quot;&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

