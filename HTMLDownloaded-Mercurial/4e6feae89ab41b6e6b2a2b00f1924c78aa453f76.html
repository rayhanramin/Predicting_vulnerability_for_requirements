<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 10891:4e6feae89ab41b6e6b2a2b00f1924c78aa453f76</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 4e6feae89ab41b6e6b2a2b00f1924c78aa453f76" />
<meta property="og:url" content="/comm-central/rev/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76" />
<meta property="og:description" content="Bug 779130 - Add lots of static_cast&lt;nsresult&gt;; r=standard8" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 4e6feae89ab41b6e6b2a2b00f1924c78aa453f76 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">shortlog</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">files</a> |
changeset |
<a href="/comm-central/raw-rev/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">raw</a>  | <a href="/comm-central/archive/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=779130">Bug 779130</a> - Add lots of static_cast&lt;nsresult&gt;; r=standard8
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#114;&#121;&#101;&#104;&#32;&#71;&#114;&#101;&#103;&#111;&#114;&#32;&#60;&#97;&#121;&#103;&#64;&#97;&#114;&#121;&#101;&#104;&#46;&#110;&#97;&#109;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 06 Aug 2012 18:49:44 +0300</td></tr>

<tr>
 <td>changeset 10891</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">4e6feae89ab41b6e6b2a2b00f1924c78aa453f76</a></td>
</tr>



<tr>
<td>parent 10890</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/9354cabcfa4145c983bb5adcbe3feec9a4daccd7">9354cabcfa4145c983bb5adcbe3feec9a4daccd7</a>
</td>
</tr>

<tr>
<td>child 10892</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/eb4e923be691c8e2058897d8e8b2aa388cee4105">eb4e923be691c8e2058897d8e8b2aa388cee4105</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=4e6feae89ab41b6e6b2a2b00f1924c78aa453f76">8171</a></td></tr>
<tr><td>push user</td><td>ayg@aryeh.name</td></tr>
<tr><td>push date</td><td class="date age">Fri, 17 Aug 2012 11:47:13 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@2657de7f561b [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=2657de7f561bd4491898dca1ba0eb213ffd691b3">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=2657de7f561bd4491898dca1ba0eb213ffd691b3&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2657de7f561bd4491898dca1ba0eb213ffd691b3&newProject=comm-central&newRevision=9d106bbca8d92aea7b5188a1f67d2793fd1fb3fb&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2657de7f561bd4491898dca1ba0eb213ffd691b3&newProject=comm-central&newRevision=9d106bbca8d92aea7b5188a1f67d2793fd1fb3fb&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2657de7f561bd4491898dca1ba0eb213ffd691b3&newProject=comm-central&newRevision=9d106bbca8d92aea7b5188a1f67d2793fd1fb3fb&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28standard8%29&revcount=50">standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=779130">779130</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=779130">Bug 779130</a> - Add lots of static_cast&lt;nsresult&gt;; r=standard8</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkCursor.cpp">db/mork/src/morkCursor.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkCursor.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkCursor.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkCursor.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkCursor.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkCursor.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkNode.cpp">db/mork/src/morkNode.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkNode.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkNode.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkNode.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkNode.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkNode.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkObject.cpp">db/mork/src/morkObject.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkObject.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkObject.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkObject.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkObject.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkObject.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkStore.cpp">db/mork/src/morkStore.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkStore.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkStore.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkStore.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkStore.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkStore.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkZone.cpp">db/mork/src/morkZone.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkZone.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkZone.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkZone.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkZone.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/db/mork/src/morkZone.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp">mailnews/addrbook/src/nsAbLDAPReplicationData.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbMDBDirectory.cpp">mailnews/addrbook/src/nsAbMDBDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbMDBDirectory.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbMDBDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbMDBDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbMDBDirectory.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/addrbook/src/nsAbMDBDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/base/search/src/nsMsgFilter.cpp">mailnews/base/search/src/nsMsgFilter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/base/search/src/nsMsgFilter.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/base/search/src/nsMsgFilter.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/base/search/src/nsMsgFilter.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/base/search/src/nsMsgFilter.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/base/search/src/nsMsgFilter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSend.cpp">mailnews/compose/src/nsMsgSend.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSend.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSend.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSend.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSend.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSend.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSendPart.cpp">mailnews/compose/src/nsMsgSendPart.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSendPart.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSendPart.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSendPart.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSendPart.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsMsgSendPart.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsSmtpProtocol.cpp">mailnews/compose/src/nsSmtpProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsSmtpProtocol.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsSmtpProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsSmtpProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsSmtpProtocol.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/compose/src/nsSmtpProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/imap/src/nsIMAPHostSessionList.cpp">mailnews/imap/src/nsIMAPHostSessionList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/imap/src/nsIMAPHostSessionList.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/imap/src/nsIMAPHostSessionList.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/imap/src/nsIMAPHostSessionList.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/imap/src/nsIMAPHostSessionList.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/imap/src/nsIMAPHostSessionList.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/local/src/nsPop3Protocol.cpp">mailnews/local/src/nsPop3Protocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/local/src/nsPop3Protocol.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/local/src/nsPop3Protocol.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/local/src/nsPop3Protocol.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/local/src/nsPop3Protocol.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/local/src/nsPop3Protocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp">mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/mimemoz2.cpp">mailnews/mime/src/mimemoz2.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/mimemoz2.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/mimemoz2.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/mimemoz2.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/mimemoz2.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/mimemoz2.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsMimeHeaders.cpp">mailnews/mime/src/nsMimeHeaders.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsMimeHeaders.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsMimeHeaders.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsMimeHeaders.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsMimeHeaders.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsMimeHeaders.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsStreamConverter.cpp">mailnews/mime/src/nsStreamConverter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsStreamConverter.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsStreamConverter.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsStreamConverter.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsStreamConverter.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/mime/src/nsStreamConverter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/news/src/nsNNTPNewsgroupList.cpp">mailnews/news/src/nsNNTPNewsgroupList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/news/src/nsNNTPNewsgroupList.cpp">file</a> |
<a href="/comm-central/annotate/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/news/src/nsNNTPNewsgroupList.cpp">annotate</a> |
<a href="/comm-central/diff/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/news/src/nsNNTPNewsgroupList.cpp">diff</a> |
<a href="/comm-central/comparison/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/news/src/nsNNTPNewsgroupList.cpp">comparison</a> |
<a href="/comm-central/log/4e6feae89ab41b6e6b2a2b00f1924c78aa453f76/mailnews/news/src/nsNNTPNewsgroupList.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/db/mork/src/morkCursor.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/db/mork/src/morkCursor.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -94,33 +94,37 @@ morkCursor::GetStrongRefCount(nsIMdbEnv*</span>
<a href="#l1.4"></a><span id="l1.4"> {</span>
<a href="#l1.5"></a><span id="l1.5">   *outCount = StrongRefsOnly();</span>
<a href="#l1.6"></a><span id="l1.6">   return NS_OK;</span>
<a href="#l1.7"></a><span id="l1.7"> }</span>
<a href="#l1.8"></a><span id="l1.8"> // ### TODO - clean up this cast, if required</span>
<a href="#l1.9"></a><span id="l1.9"> NS_IMETHODIMP</span>
<a href="#l1.10"></a><span id="l1.10"> morkCursor::AddWeakRef(nsIMdbEnv* mev)</span>
<a href="#l1.11"></a><span id="l1.11"> {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-  return morkNode::AddWeakRef((morkEnv *) mev);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+  // XXX Casting mork_refs to nsresult</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::AddWeakRef((morkEnv *) mev));</span>
<a href="#l1.15"></a><span id="l1.15"> }</span>
<a href="#l1.16"></a><span id="l1.16"> NS_IMETHODIMP</span>
<a href="#l1.17"></a><span id="l1.17"> morkCursor::AddStrongRef(nsIMdbEnv* mev)</span>
<a href="#l1.18"></a><span id="l1.18"> {</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-  return morkNode::AddStrongRef((morkEnv *) mev);</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+  // XXX Casting mork_uses to nsresult</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::AddStrongRef((morkEnv *) mev));</span>
<a href="#l1.22"></a><span id="l1.22"> }</span>
<a href="#l1.23"></a><span id="l1.23"> </span>
<a href="#l1.24"></a><span id="l1.24"> NS_IMETHODIMP</span>
<a href="#l1.25"></a><span id="l1.25"> morkCursor::CutWeakRef(nsIMdbEnv* mev)</span>
<a href="#l1.26"></a><span id="l1.26"> {</span>
<a href="#l1.27"></a><span id="l1.27" class="difflineminus">-  return morkNode::CutWeakRef((morkEnv *) mev);</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineplus">+  // XXX Casting mork_refs to nsresult</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::CutWeakRef((morkEnv *) mev));</span>
<a href="#l1.30"></a><span id="l1.30"> }</span>
<a href="#l1.31"></a><span id="l1.31"> NS_IMETHODIMP</span>
<a href="#l1.32"></a><span id="l1.32"> morkCursor::CutStrongRef(nsIMdbEnv* mev)</span>
<a href="#l1.33"></a><span id="l1.33"> {</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-  return morkNode::CutStrongRef((morkEnv *) mev);</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+  // XXX Casting mork_uses to nsresult</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::CutStrongRef((morkEnv *) mev));</span>
<a href="#l1.37"></a><span id="l1.37"> }</span>
<a href="#l1.38"></a><span id="l1.38"> </span>
<a href="#l1.39"></a><span id="l1.39">   </span>
<a href="#l1.40"></a><span id="l1.40"> NS_IMETHODIMP</span>
<a href="#l1.41"></a><span id="l1.41"> morkCursor::CloseMdbObject(nsIMdbEnv* mev)</span>
<a href="#l1.42"></a><span id="l1.42"> {</span>
<a href="#l1.43"></a><span id="l1.43">   return morkNode::CloseMdbObject((morkEnv *) mev);</span>
<a href="#l1.44"></a><span id="l1.44"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/db/mork/src/morkNode.cpp</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/db/mork/src/morkNode.cpp</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -207,17 +207,18 @@ morkNode::CloseMdbObject(nsIMdbEnv* mev)</span>
<a href="#l2.4"></a><span id="l2.4"> {</span>
<a href="#l2.5"></a><span id="l2.5">   return morkNode::CloseMdbObject((morkEnv *) mev);</span>
<a href="#l2.6"></a><span id="l2.6"> }</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8"> mdb_err morkNode::CloseMdbObject(morkEnv *ev)</span>
<a href="#l2.9"></a><span id="l2.9"> {</span>
<a href="#l2.10"></a><span id="l2.10">   // if only one ref, Handle_CutStrongRef will clean up better.</span>
<a href="#l2.11"></a><span id="l2.11">   if (mNode_Uses == 1)</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-    return CutStrongRef(ev);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+    // XXX Casting mork_uses to mdb_err</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+    return static_cast&lt;mdb_err&gt;(CutStrongRef(ev));</span>
<a href="#l2.15"></a><span id="l2.15"> </span>
<a href="#l2.16"></a><span id="l2.16">   mdb_err outErr = NS_OK;</span>
<a href="#l2.17"></a><span id="l2.17">   </span>
<a href="#l2.18"></a><span id="l2.18">   if ( IsNode() &amp;&amp; IsOpenNode() )</span>
<a href="#l2.19"></a><span id="l2.19">   {</span>
<a href="#l2.20"></a><span id="l2.20">     if ( ev )</span>
<a href="#l2.21"></a><span id="l2.21">     {</span>
<a href="#l2.22"></a><span id="l2.22">       CloseMorkNode(ev);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/db/mork/src/morkObject.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/db/mork/src/morkObject.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -138,33 +138,37 @@ morkObject::GetStrongRefCount(nsIMdbEnv*</span>
<a href="#l3.4"></a><span id="l3.4"> {</span>
<a href="#l3.5"></a><span id="l3.5">   *outCount = StrongRefsOnly();</span>
<a href="#l3.6"></a><span id="l3.6">   return NS_OK;</span>
<a href="#l3.7"></a><span id="l3.7"> }</span>
<a href="#l3.8"></a><span id="l3.8"> // ### TODO - clean up this cast, if required</span>
<a href="#l3.9"></a><span id="l3.9"> NS_IMETHODIMP</span>
<a href="#l3.10"></a><span id="l3.10"> morkObject::AddWeakRef(nsIMdbEnv* mev)</span>
<a href="#l3.11"></a><span id="l3.11"> {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  return morkNode::AddWeakRef((morkEnv *) mev);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  // XXX Casting mork_refs to nsresult</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::AddWeakRef((morkEnv *) mev));</span>
<a href="#l3.15"></a><span id="l3.15"> }</span>
<a href="#l3.16"></a><span id="l3.16"> NS_IMETHODIMP</span>
<a href="#l3.17"></a><span id="l3.17"> morkObject::AddStrongRef(nsIMdbEnv* mev)</span>
<a href="#l3.18"></a><span id="l3.18"> {</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-  return morkNode::AddStrongRef((morkEnv *) mev);</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+  // XXX Casting mork_uses to nsresult</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::AddStrongRef((morkEnv *) mev));</span>
<a href="#l3.22"></a><span id="l3.22"> }</span>
<a href="#l3.23"></a><span id="l3.23"> </span>
<a href="#l3.24"></a><span id="l3.24"> NS_IMETHODIMP</span>
<a href="#l3.25"></a><span id="l3.25"> morkObject::CutWeakRef(nsIMdbEnv* mev)</span>
<a href="#l3.26"></a><span id="l3.26"> {</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineminus">-  return morkNode::CutWeakRef((morkEnv *) mev);</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+  // XXX Casting mork_refs to nsresult</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::CutWeakRef((morkEnv *) mev));</span>
<a href="#l3.30"></a><span id="l3.30"> }</span>
<a href="#l3.31"></a><span id="l3.31"> NS_IMETHODIMP</span>
<a href="#l3.32"></a><span id="l3.32"> morkObject::CutStrongRef(nsIMdbEnv* mev)</span>
<a href="#l3.33"></a><span id="l3.33"> {</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-  return morkNode::CutStrongRef((morkEnv *) mev);</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+  // XXX Casting mork_uses to nsresult</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::CutStrongRef((morkEnv *) mev));</span>
<a href="#l3.37"></a><span id="l3.37"> }</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39">   </span>
<a href="#l3.40"></a><span id="l3.40"> NS_IMETHODIMP</span>
<a href="#l3.41"></a><span id="l3.41"> morkObject::CloseMdbObject(nsIMdbEnv* mev)</span>
<a href="#l3.42"></a><span id="l3.42"> {</span>
<a href="#l3.43"></a><span id="l3.43">   return morkNode::CloseMdbObject((morkEnv *) mev);</span>
<a href="#l3.44"></a><span id="l3.44"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/db/mork/src/morkStore.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/db/mork/src/morkStore.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1305,34 +1305,38 @@ morkStore::GetStrongRefCount(nsIMdbEnv* </span>
<a href="#l4.4"></a><span id="l4.4">   *outCount = StrongRefsOnly();</span>
<a href="#l4.5"></a><span id="l4.5">   return NS_OK;</span>
<a href="#l4.6"></a><span id="l4.6"> }</span>
<a href="#l4.7"></a><span id="l4.7"> // ### TODO - clean up this cast, if required</span>
<a href="#l4.8"></a><span id="l4.8"> NS_IMETHODIMP</span>
<a href="#l4.9"></a><span id="l4.9"> morkStore::AddWeakRef(nsIMdbEnv* mev)</span>
<a href="#l4.10"></a><span id="l4.10"> {</span>
<a href="#l4.11"></a><span id="l4.11">   morkEnv *ev  = morkEnv::FromMdbEnv(mev);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  return morkNode::AddWeakRef(ev);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  // XXX Casting mork_refs to nsresult</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::AddWeakRef(ev));</span>
<a href="#l4.15"></a><span id="l4.15"> }</span>
<a href="#l4.16"></a><span id="l4.16"> NS_IMETHODIMP</span>
<a href="#l4.17"></a><span id="l4.17"> morkStore::AddStrongRef(nsIMdbEnv* mev)</span>
<a href="#l4.18"></a><span id="l4.18"> {</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-  return AddRef();</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+  // XXX Casting nsrefcnt to nsresult</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+  return static_cast&lt;nsresult&gt;(AddRef());</span>
<a href="#l4.22"></a><span id="l4.22"> }</span>
<a href="#l4.23"></a><span id="l4.23"> </span>
<a href="#l4.24"></a><span id="l4.24"> NS_IMETHODIMP</span>
<a href="#l4.25"></a><span id="l4.25"> morkStore::CutWeakRef(nsIMdbEnv* mev)</span>
<a href="#l4.26"></a><span id="l4.26"> {</span>
<a href="#l4.27"></a><span id="l4.27">   morkEnv *ev  = morkEnv::FromMdbEnv(mev);</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineminus">-  return morkNode::CutWeakRef(ev);</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+  // XXX Casting mork_refs to nsresult</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+  return static_cast&lt;nsresult&gt;(morkNode::CutWeakRef(ev));</span>
<a href="#l4.31"></a><span id="l4.31"> }</span>
<a href="#l4.32"></a><span id="l4.32"> NS_IMETHODIMP</span>
<a href="#l4.33"></a><span id="l4.33"> morkStore::CutStrongRef(nsIMdbEnv* mev)</span>
<a href="#l4.34"></a><span id="l4.34"> {</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-  return Release();</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+  // XXX Casting nsrefcnt to nsresult</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+  return static_cast&lt;nsresult&gt;(Release());</span>
<a href="#l4.38"></a><span id="l4.38"> }</span>
<a href="#l4.39"></a><span id="l4.39"> </span>
<a href="#l4.40"></a><span id="l4.40"> NS_IMETHODIMP</span>
<a href="#l4.41"></a><span id="l4.41"> morkStore::CloseMdbObject(nsIMdbEnv* mev)</span>
<a href="#l4.42"></a><span id="l4.42"> {</span>
<a href="#l4.43"></a><span id="l4.43">   morkEnv *ev = morkEnv::FromMdbEnv(mev);</span>
<a href="#l4.44"></a><span id="l4.44">   CloseMorkNode(ev);</span>
<a href="#l4.45"></a><span id="l4.45">   Release();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/db/mork/src/morkZone.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/db/mork/src/morkZone.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -494,17 +494,18 @@ morkZone::Alloc(nsIMdbEnv* mev, // alloc</span>
<a href="#l5.4"></a><span id="l5.4">   void* block = 0;</span>
<a href="#l5.5"></a><span id="l5.5">   morkEnv* ev = morkEnv::FromMdbEnv(mev);</span>
<a href="#l5.6"></a><span id="l5.6">   if ( ev )</span>
<a href="#l5.7"></a><span id="l5.7">   {</span>
<a href="#l5.8"></a><span id="l5.8">     block = this-&gt;ZoneNewRun(ev, inSize);</span>
<a href="#l5.9"></a><span id="l5.9">     outErr = ev-&gt;AsErr();</span>
<a href="#l5.10"></a><span id="l5.10">   }</span>
<a href="#l5.11"></a><span id="l5.11">   else</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    outErr = 1;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    // XXX 1 is not a valid mdb_err (= nsresult)</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+    outErr = static_cast&lt;mdb_err&gt;(1);</span>
<a href="#l5.15"></a><span id="l5.15">     </span>
<a href="#l5.16"></a><span id="l5.16">   if ( outBlock )</span>
<a href="#l5.17"></a><span id="l5.17">     *outBlock = block;</span>
<a href="#l5.18"></a><span id="l5.18">     </span>
<a href="#l5.19"></a><span id="l5.19">   return outErr;</span>
<a href="#l5.20"></a><span id="l5.20"> }</span>
<a href="#l5.21"></a><span id="l5.21">   </span>
<a href="#l5.22"></a><span id="l5.22"> /*virtual*/ mdb_err</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineat">@@ -516,17 +517,18 @@ morkZone::Free(nsIMdbEnv* mev, // free b</span>
<a href="#l5.24"></a><span id="l5.24">   {</span>
<a href="#l5.25"></a><span id="l5.25">     morkEnv* ev = morkEnv::FromMdbEnv(mev);</span>
<a href="#l5.26"></a><span id="l5.26">     if ( ev )</span>
<a href="#l5.27"></a><span id="l5.27">     {</span>
<a href="#l5.28"></a><span id="l5.28">       this-&gt;ZoneZapRun(ev, inBlock);</span>
<a href="#l5.29"></a><span id="l5.29">       outErr = ev-&gt;AsErr();</span>
<a href="#l5.30"></a><span id="l5.30">     }</span>
<a href="#l5.31"></a><span id="l5.31">     else</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-      outErr = 1;</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+      // XXX 1 is not a valid mdb_err (= nsresult)</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+      outErr = static_cast&lt;mdb_err&gt;(1);</span>
<a href="#l5.35"></a><span id="l5.35">   }</span>
<a href="#l5.36"></a><span id="l5.36">     </span>
<a href="#l5.37"></a><span id="l5.37">   return outErr;</span>
<a href="#l5.38"></a><span id="l5.38"> }</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40"> /*virtual*/ mdb_err</span>
<a href="#l5.41"></a><span id="l5.41"> morkZone::HeapAddStrongRef(nsIMdbEnv* mev) // does nothing</span>
<a href="#l5.42"></a><span id="l5.42"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPReplicationData.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -201,18 +201,20 @@ nsresult nsAbLDAPProcessReplicationData:</span>
<a href="#l6.4"></a><span id="l6.4">   nsCAutoString attributes;</span>
<a href="#l6.5"></a><span id="l6.5">   rv = mDirectoryUrl-&gt;GetAttributes(attributes);</span>
<a href="#l6.6"></a><span id="l6.6">   if (NS_FAILED(rv))</span>
<a href="#l6.7"></a><span id="l6.7">     return rv;</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9">   mState = kReplicatingAll;</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">   if (mListener &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+    // XXX Cast from bool to nsresult</span>
<a href="#l6.13"></a><span id="l6.13">     mListener-&gt;OnStateChange(nullptr, nullptr,</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-                             nsIWebProgressListener::STATE_START, true);</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+                             nsIWebProgressListener::STATE_START,</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+                             static_cast&lt;nsresult&gt;(true));</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18">   return mOperation-&gt;SearchExt(dn, scope, urlFilter, attributes, 0, 0);</span>
<a href="#l6.19"></a><span id="l6.19"> }</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21"> void nsAbLDAPProcessReplicationData::InitFailed(bool aCancelled)</span>
<a href="#l6.22"></a><span id="l6.22"> {</span>
<a href="#l6.23"></a><span id="l6.23">   // Just call Done() which will ensure everything is tidied up nicely.</span>
<a href="#l6.24"></a><span id="l6.24">   Done(false);</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineat">@@ -463,17 +465,20 @@ void nsAbLDAPProcessReplicationData::Don</span>
<a href="#l6.26"></a><span id="l6.26">        return;</span>
<a href="#l6.27"></a><span id="l6.27"> </span>
<a href="#l6.28"></a><span id="l6.28">    mState = kReplicationDone;</span>
<a href="#l6.29"></a><span id="l6.29"> </span>
<a href="#l6.30"></a><span id="l6.30">    if (mQuery)</span>
<a href="#l6.31"></a><span id="l6.31">      mQuery-&gt;Done(aSuccess);</span>
<a href="#l6.32"></a><span id="l6.32"> </span>
<a href="#l6.33"></a><span id="l6.33">    if (mListener)</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-       mListener-&gt;OnStateChange(nullptr, nullptr, nsIWebProgressListener::STATE_STOP, aSuccess);</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+       // XXX Cast from bool to nsresult</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+       mListener-&gt;OnStateChange(nullptr, nullptr,</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+           nsIWebProgressListener::STATE_STOP,</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+           static_cast&lt;nsresult&gt;(aSuccess));</span>
<a href="#l6.39"></a><span id="l6.39"> </span>
<a href="#l6.40"></a><span id="l6.40">    // since this is called when all is done here, either on success,</span>
<a href="#l6.41"></a><span id="l6.41">    // failure or abort release the query now.</span>
<a href="#l6.42"></a><span id="l6.42">    mQuery = nullptr;</span>
<a href="#l6.43"></a><span id="l6.43"> }</span>
<a href="#l6.44"></a><span id="l6.44"> </span>
<a href="#l6.45"></a><span id="l6.45"> nsresult nsAbLDAPProcessReplicationData::DeleteCard(nsString &amp; aDn)</span>
<a href="#l6.46"></a><span id="l6.46"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbMDBDirectory.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbMDBDirectory.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -193,17 +193,18 @@ NS_IMETHODIMP nsAbMDBDirectory::DeleteDi</span>
<a href="#l7.4"></a><span id="l7.4">   rv = database-&gt;DeleteMailList(directory, this);</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6">   if (NS_SUCCEEDED(rv))</span>
<a href="#l7.7"></a><span id="l7.7">     database-&gt;Commit(nsAddrDBCommitType::kLargeCommit);</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9">   PRUint32 dirIndex;</span>
<a href="#l7.10"></a><span id="l7.10">   if (m_AddressList &amp;&amp; NS_SUCCEEDED(m_AddressList-&gt;IndexOf(0, directory, &amp;dirIndex)))</span>
<a href="#l7.11"></a><span id="l7.11">     m_AddressList-&gt;RemoveElementAt(dirIndex);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  rv = mSubDirectories.RemoveObject(directory);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  // XXX Cast from bool to nsresult</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+  rv = static_cast&lt;nsresult&gt;(mSubDirectories.RemoveObject(directory));</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16">   NotifyItemDeleted(directory);</span>
<a href="#l7.17"></a><span id="l7.17">   return rv;</span>
<a href="#l7.18"></a><span id="l7.18"> }</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20"> nsresult nsAbMDBDirectory::NotifyItemChanged(nsISupports *item)</span>
<a href="#l7.21"></a><span id="l7.21"> {</span>
<a href="#l7.22"></a><span id="l7.22">   nsresult rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -308,56 +308,61 @@ nsMsgFilter::GetSortedActionList(nsISupp</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5">     nsMsgRuleActionType actionType;</span>
<a href="#l8.6"></a><span id="l8.6">     action-&gt;GetType(&amp;actionType);</span>
<a href="#l8.7"></a><span id="l8.7">     switch (actionType)</span>
<a href="#l8.8"></a><span id="l8.8">     {</span>
<a href="#l8.9"></a><span id="l8.9">       case nsMsgFilterAction::FetchBodyFromPop3Server:</span>
<a href="#l8.10"></a><span id="l8.10">       {</span>
<a href="#l8.11"></a><span id="l8.11">         // always insert in front</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-        rv = actionList-&gt;InsertElementAt(action, 0);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+        // XXX Cast from bool to nsresult</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+        rv = static_cast&lt;nsresult&gt;(actionList-&gt;InsertElementAt(action, 0));</span>
<a href="#l8.15"></a><span id="l8.15">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.16"></a><span id="l8.16">         ++nextIndexForNormal;</span>
<a href="#l8.17"></a><span id="l8.17">         ++nextIndexForCopy;</span>
<a href="#l8.18"></a><span id="l8.18">         ++nextIndexForMove;</span>
<a href="#l8.19"></a><span id="l8.19">         break;</span>
<a href="#l8.20"></a><span id="l8.20">       }</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22">       case nsMsgFilterAction::CopyToFolder:</span>
<a href="#l8.23"></a><span id="l8.23">       {</span>
<a href="#l8.24"></a><span id="l8.24">         // insert into copy actions block, in order of appearance</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-        rv = actionList-&gt;InsertElementAt(action, nextIndexForCopy);</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+        // XXX Cast from bool to nsresult</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+        rv = static_cast&lt;nsresult&gt;(actionList-&gt;InsertElementAt(action, nextIndexForCopy));</span>
<a href="#l8.28"></a><span id="l8.28">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.29"></a><span id="l8.29">         ++nextIndexForCopy;</span>
<a href="#l8.30"></a><span id="l8.30">         ++nextIndexForMove;</span>
<a href="#l8.31"></a><span id="l8.31">         break;</span>
<a href="#l8.32"></a><span id="l8.32">       }</span>
<a href="#l8.33"></a><span id="l8.33"> </span>
<a href="#l8.34"></a><span id="l8.34">       case nsMsgFilterAction::MoveToFolder:</span>
<a href="#l8.35"></a><span id="l8.35">       case nsMsgFilterAction::Delete:</span>
<a href="#l8.36"></a><span id="l8.36">       {</span>
<a href="#l8.37"></a><span id="l8.37">         // insert into move/delete action block</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-        rv = actionList-&gt;InsertElementAt(action, nextIndexForMove);</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+        // XXX Cast from bool to nsresult</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+        rv = static_cast&lt;nsresult&gt;(actionList-&gt;InsertElementAt(action, nextIndexForMove));</span>
<a href="#l8.41"></a><span id="l8.41">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.42"></a><span id="l8.42">         ++nextIndexForMove;</span>
<a href="#l8.43"></a><span id="l8.43">         break;</span>
<a href="#l8.44"></a><span id="l8.44">       }</span>
<a href="#l8.45"></a><span id="l8.45"> </span>
<a href="#l8.46"></a><span id="l8.46">       case nsMsgFilterAction::StopExecution:</span>
<a href="#l8.47"></a><span id="l8.47">       {</span>
<a href="#l8.48"></a><span id="l8.48">         // insert into stop action block</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-        rv = actionList-&gt;AppendElement(action);</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+        // XXX Cast from bool to nsresult</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+        rv = static_cast&lt;nsresult&gt;(actionList-&gt;AppendElement(action));</span>
<a href="#l8.52"></a><span id="l8.52">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.53"></a><span id="l8.53">         break;</span>
<a href="#l8.54"></a><span id="l8.54">       }</span>
<a href="#l8.55"></a><span id="l8.55"> </span>
<a href="#l8.56"></a><span id="l8.56">       default:</span>
<a href="#l8.57"></a><span id="l8.57">       {</span>
<a href="#l8.58"></a><span id="l8.58">         // insert into normal action block, in order of appearance</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-        rv = actionList-&gt;InsertElementAt(action, nextIndexForNormal);</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+        // XXX Cast from bool to nsresult</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+        rv = static_cast&lt;nsresult&gt;(actionList-&gt;InsertElementAt(action, nextIndexForNormal));</span>
<a href="#l8.62"></a><span id="l8.62">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.63"></a><span id="l8.63">         ++nextIndexForNormal;</span>
<a href="#l8.64"></a><span id="l8.64">         ++nextIndexForCopy;</span>
<a href="#l8.65"></a><span id="l8.65">         ++nextIndexForMove;</span>
<a href="#l8.66"></a><span id="l8.66">         break;</span>
<a href="#l8.67"></a><span id="l8.67">       }</span>
<a href="#l8.68"></a><span id="l8.68">     }</span>
<a href="#l8.69"></a><span id="l8.69">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -2639,18 +2639,24 @@ nsMsgComposeAndSend::HackAttachments(nsI</span>
<a href="#l9.4"></a><span id="l9.4">         nsAutoString attachmentFileName;</span>
<a href="#l9.5"></a><span id="l9.5">         nsresult rv = ConvertToUnicode(nsMsgI18NFileSystemCharset(), m_attachments[i].m_realName, attachmentFileName);</span>
<a href="#l9.6"></a><span id="l9.6">         if (NS_SUCCEEDED(rv))</span>
<a href="#l9.7"></a><span id="l9.7">         {</span>
<a href="#l9.8"></a><span id="l9.8">           nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l9.9"></a><span id="l9.9">           const PRUnichar *params[] = { attachmentFileName.get() };</span>
<a href="#l9.10"></a><span id="l9.10">           mComposeBundle-&gt;FormatStringFromID(NS_ERROR_GET_CODE(NS_MSG_ERROR_ATTACHING_FILE), params, 1, getter_Copies(errorMsg));</span>
<a href="#l9.11"></a><span id="l9.11">           mSendReport-&gt;SetMessage(nsIMsgSendReport::process_Current, errorMsg.get(), false);</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-          mSendReport-&gt;SetError(nsIMsgSendReport::process_Current, NS_MSG_GENERATE_FAILURE(NS_MSG_ERROR_ATTACHING_FILE) /* status */,</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-                                false);</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+          mSendReport-&gt;SetError(nsIMsgSendReport::process_Current,</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+              // XXX The following applies NS_ERROR_GENERATE_FAILURE twice,</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+              // which doesn't make sense.  Just NS_MSG_ERROR_ATTACHING_FILE is</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+              // surely what was intended.</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+              NS_ERROR_GENERATE_FAILURE(</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+                NS_ERROR_MODULE_MAILNEWS,</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+                static_cast&lt;PRUint32&gt;(NS_MSG_ERROR_ATTACHING_FILE)),</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+              false);</span>
<a href="#l9.22"></a><span id="l9.22">         }</span>
<a href="#l9.23"></a><span id="l9.23">         return NS_MSG_ERROR_ATTACHING_FILE;</span>
<a href="#l9.24"></a><span id="l9.24">       }</span>
<a href="#l9.25"></a><span id="l9.25">       if (m_be_synchronous_p)</span>
<a href="#l9.26"></a><span id="l9.26">         break;</span>
<a href="#l9.27"></a><span id="l9.27">     }</span>
<a href="#l9.28"></a><span id="l9.28">   }</span>
<a href="#l9.29"></a><span id="l9.29"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSendPart.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSendPart.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -230,28 +230,30 @@ nsresult nsMsgSendPart::PushBody(const c</span>
<a href="#l10.4"></a><span id="l10.4"> {</span>
<a href="#l10.5"></a><span id="l10.5">   nsresult status = NS_OK;</span>
<a href="#l10.6"></a><span id="l10.6">   const char* encoded_data = buffer;</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8">   if (m_encoder_data)</span>
<a href="#l10.9"></a><span id="l10.9">   {</span>
<a href="#l10.10"></a><span id="l10.10">     nsresult rv = MIME_EncoderWrite(m_encoder_data, encoded_data, length);</span>
<a href="#l10.11"></a><span id="l10.11">     if (NS_FAILED(rv))</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      status = -1;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+      // XXX -1 is not a valid nsresult</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+      status = static_cast&lt;nsresult&gt;(-1);</span>
<a href="#l10.15"></a><span id="l10.15">   }</span>
<a href="#l10.16"></a><span id="l10.16">   else</span>
<a href="#l10.17"></a><span id="l10.17">   {</span>
<a href="#l10.18"></a><span id="l10.18">     // Merely translate all linebreaks to CRLF.</span>
<a href="#l10.19"></a><span id="l10.19">     const char *in = encoded_data;</span>
<a href="#l10.20"></a><span id="l10.20">     const char *end = in + length;</span>
<a href="#l10.21"></a><span id="l10.21">     char *buffer, *out;</span>
<a href="#l10.22"></a><span id="l10.22"> </span>
<a href="#l10.23"></a><span id="l10.23"> </span>
<a href="#l10.24"></a><span id="l10.24">     buffer = mime_get_stream_write_buffer();</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineminus">-    NS_ENSURE_TRUE(buffer, -1);</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+    // XXX -1 is not a valid nsresult</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+    NS_ENSURE_TRUE(buffer, static_cast&lt;nsresult&gt;(-1));</span>
<a href="#l10.28"></a><span id="l10.28"> </span>
<a href="#l10.29"></a><span id="l10.29">     NS_ASSERTION(encoded_data != buffer, &quot;encoded_data == buffer&quot;);</span>
<a href="#l10.30"></a><span id="l10.30">     out = buffer;</span>
<a href="#l10.31"></a><span id="l10.31"> </span>
<a href="#l10.32"></a><span id="l10.32">     for (; in &lt; end; in++) {</span>
<a href="#l10.33"></a><span id="l10.33">       if (m_just_hit_CR) {</span>
<a href="#l10.34"></a><span id="l10.34">         m_just_hit_CR = false;</span>
<a href="#l10.35"></a><span id="l10.35">         if (*in == '\n') {</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineat">@@ -453,17 +455,18 @@ nsMsgSendPart::Write()</span>
<a href="#l10.37"></a><span id="l10.37"> #define PUSH(str) PUSHLEN(str, PL_strlen(str))</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39">   // rhp: Suppress the output of parts that are empty!</span>
<a href="#l10.40"></a><span id="l10.40">   if ( (m_parent) &amp;&amp;</span>
<a href="#l10.41"></a><span id="l10.41">        (m_numchildren == 0) &amp;&amp;</span>
<a href="#l10.42"></a><span id="l10.42">        ( (!m_buffer) || (!*m_buffer) ) &amp;&amp;</span>
<a href="#l10.43"></a><span id="l10.43">        (!m_file) &amp;&amp;</span>
<a href="#l10.44"></a><span id="l10.44">        (!m_mainpart) )</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineminus">-    return SKIP_EMPTY_PART;</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+    // XXX SKIP_EMPTY_PART (= 1966) is not a valid nsresult</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineplus">+    return static_cast&lt;nsresult&gt;(SKIP_EMPTY_PART);</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">   if (m_mainpart &amp;&amp; m_type &amp;&amp; PL_strcmp(m_type, TEXT_HTML) == 0) </span>
<a href="#l10.50"></a><span id="l10.50">   {     </span>
<a href="#l10.51"></a><span id="l10.51">     if (m_file) </span>
<a href="#l10.52"></a><span id="l10.52">     {</span>
<a href="#l10.53"></a><span id="l10.53">       // The &quot;insert HTML links&quot; code requires a memory buffer,</span>
<a href="#l10.54"></a><span id="l10.54">       // so read the file into memory.</span>
<a href="#l10.55"></a><span id="l10.55">       NS_ASSERTION(m_buffer == nullptr, &quot;not-null buffer&quot;);</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineat">@@ -735,17 +738,18 @@ nsMsgSendPart::Write()</span>
<a href="#l10.57"></a><span id="l10.57"> </span>
<a href="#l10.58"></a><span id="l10.58">   if (m_encoder_data)</span>
<a href="#l10.59"></a><span id="l10.59">   {</span>
<a href="#l10.60"></a><span id="l10.60">     nsresult rv  = MIME_EncoderDestroy(m_encoder_data, false);</span>
<a href="#l10.61"></a><span id="l10.61">     m_encoder_data = nullptr;</span>
<a href="#l10.62"></a><span id="l10.62">     needToWriteCRLFAfterEncodedBody = !m_parent;</span>
<a href="#l10.63"></a><span id="l10.63">     if (NS_FAILED(rv))</span>
<a href="#l10.64"></a><span id="l10.64">     {</span>
<a href="#l10.65"></a><span id="l10.65" class="difflineminus">-      status = -1;</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineplus">+      // XXX -1 is not a valid nsresult</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineplus">+      status = static_cast&lt;nsresult&gt;(-1);</span>
<a href="#l10.68"></a><span id="l10.68">       goto FAIL;</span>
<a href="#l10.69"></a><span id="l10.69">     }</span>
<a href="#l10.70"></a><span id="l10.70">   }</span>
<a href="#l10.71"></a><span id="l10.71"> </span>
<a href="#l10.72"></a><span id="l10.72">   //</span>
<a href="#l10.73"></a><span id="l10.73">   // Ok, from here we loop and drive the the output of all children </span>
<a href="#l10.74"></a><span id="l10.74">   // for this message.</span>
<a href="#l10.75"></a><span id="l10.75">   //</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineat">@@ -763,17 +767,18 @@ nsMsgSendPart::Write()</span>
<a href="#l10.77"></a><span id="l10.77">         PUSH(separator);</span>
<a href="#l10.78"></a><span id="l10.78">         PUSH(CRLF);</span>
<a href="#l10.79"></a><span id="l10.79">       }</span>
<a href="#l10.80"></a><span id="l10.80"> </span>
<a href="#l10.81"></a><span id="l10.81">       status = m_children[i]-&gt;Write();</span>
<a href="#l10.82"></a><span id="l10.82">       if (NS_FAILED(status))</span>
<a href="#l10.83"></a><span id="l10.83">         goto FAIL;</span>
<a href="#l10.84"></a><span id="l10.84"> </span>
<a href="#l10.85"></a><span id="l10.85" class="difflineminus">-      if (status == SKIP_EMPTY_PART)</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineplus">+      // XXX SKIP_EMPTY_PART (= 1966) is not a valid nsresult</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineplus">+      if (status == static_cast&lt;nsresult&gt;(SKIP_EMPTY_PART))</span>
<a href="#l10.88"></a><span id="l10.88">         writeSeparator = false;</span>
<a href="#l10.89"></a><span id="l10.89">       else</span>
<a href="#l10.90"></a><span id="l10.90">         writeSeparator = true;</span>
<a href="#l10.91"></a><span id="l10.91">     }</span>
<a href="#l10.92"></a><span id="l10.92"> </span>
<a href="#l10.93"></a><span id="l10.93">     PUSH(CRLF);</span>
<a href="#l10.94"></a><span id="l10.94">     PUSH(&quot;--&quot;);</span>
<a href="#l10.95"></a><span id="l10.95">     PUSH(separator);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1565,17 +1565,18 @@ PRInt32 nsSmtpProtocol::SendRecipientRes</span>
<a href="#l11.4"></a><span id="l11.4">   SetFlag(SMTP_PAUSE_FOR_READ);</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6">   return(status);</span>
<a href="#l11.7"></a><span id="l11.7"> }</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> nsresult nsSmtpProtocol::SendData(const char *dataBuffer, bool aSuppressLogging)</span>
<a href="#l11.11"></a><span id="l11.11"> {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  if (!dataBuffer) return -1;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  // XXX -1 is not a valid nsresult</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+  if (!dataBuffer) return static_cast&lt;nsresult&gt;(-1);</span>
<a href="#l11.15"></a><span id="l11.15"> </span>
<a href="#l11.16"></a><span id="l11.16">   if (!aSuppressLogging) {</span>
<a href="#l11.17"></a><span id="l11.17">       PR_LOG(SMTPLogModule, PR_LOG_ALWAYS, (&quot;SMTP Send: %s&quot;, dataBuffer));</span>
<a href="#l11.18"></a><span id="l11.18">   } else {</span>
<a href="#l11.19"></a><span id="l11.19">       PR_LOG(SMTPLogModule, PR_LOG_ALWAYS, (&quot;Logging suppressed for this command (it probably contained authentication information)&quot;));</span>
<a href="#l11.20"></a><span id="l11.20">   }</span>
<a href="#l11.21"></a><span id="l11.21">   return nsMsgAsyncWriteProtocol::SendData(dataBuffer);</span>
<a href="#l11.22"></a><span id="l11.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -214,17 +214,18 @@ nsresult nsMsgComposeSecure::GetSMIMEBun</span>
<a href="#l12.4"></a><span id="l12.4"> {</span>
<a href="#l12.5"></a><span id="l12.5">   *outString = nullptr;</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7">   NS_ENSURE_ARG_POINTER(name);</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9">   if (!InitializeSMIMEBundle())</span>
<a href="#l12.10"></a><span id="l12.10">     return NS_ERROR_FAILURE;</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  return NS_SUCCEEDED(mSMIMEBundle-&gt;GetStringFromName(name, outString));</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  // XXX Cast of bool to nsresult</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+  return static_cast&lt;nsresult&gt;(NS_SUCCEEDED(mSMIMEBundle-&gt;GetStringFromName(name, outString)));</span>
<a href="#l12.15"></a><span id="l12.15"> }</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17"> nsresult</span>
<a href="#l12.18"></a><span id="l12.18"> nsMsgComposeSecure::</span>
<a href="#l12.19"></a><span id="l12.19"> SMIMEBundleFormatStringFromName(const PRUnichar *name,</span>
<a href="#l12.20"></a><span id="l12.20">                                 const PRUnichar **params,</span>
<a href="#l12.21"></a><span id="l12.21">                                 PRUint32 numParams,</span>
<a href="#l12.22"></a><span id="l12.22">                                 PRUnichar **outString)</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineat">@@ -397,17 +398,18 @@ NS_IMETHODIMP nsMsgComposeSecure::BeginC</span>
<a href="#l12.24"></a><span id="l12.24">     rv = MimeInitEncryption(true, sendReport);</span>
<a href="#l12.25"></a><span id="l12.25">     break;</span>
<a href="#l12.26"></a><span id="l12.26">   case mime_crypto_encrypted:</span>
<a href="#l12.27"></a><span id="l12.27">     rv = MimeInitEncryption(false, sendReport);</span>
<a href="#l12.28"></a><span id="l12.28">     break;</span>
<a href="#l12.29"></a><span id="l12.29">   case mime_crypto_none:</span>
<a href="#l12.30"></a><span id="l12.30">     /* This can happen if mime_crypto_hack_certs() decided to turn off</span>
<a href="#l12.31"></a><span id="l12.31">      encryption (by asking the user.) */</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-    rv = 1;</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+    // XXX 1 is not a valid nsresult</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+    rv = static_cast&lt;nsresult&gt;(1);</span>
<a href="#l12.35"></a><span id="l12.35">     break;</span>
<a href="#l12.36"></a><span id="l12.36">   default:</span>
<a href="#l12.37"></a><span id="l12.37">     PR_ASSERT(0);</span>
<a href="#l12.38"></a><span id="l12.38">     break;</span>
<a href="#l12.39"></a><span id="l12.39">   }</span>
<a href="#l12.40"></a><span id="l12.40"> </span>
<a href="#l12.41"></a><span id="l12.41"> FAIL:</span>
<a href="#l12.42"></a><span id="l12.42">   return rv;</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineat">@@ -456,17 +458,18 @@ nsresult nsMsgComposeSecure::MimeInitMul</span>
<a href="#l12.44"></a><span id="l12.44"> </span>
<a href="#l12.45"></a><span id="l12.45">   L = strlen(header);</span>
<a href="#l12.46"></a><span id="l12.46"> </span>
<a href="#l12.47"></a><span id="l12.47">   if (aOuter){</span>
<a href="#l12.48"></a><span id="l12.48">     /* If this is the outer block, write it to the file. */</span>
<a href="#l12.49"></a><span id="l12.49">     PRUint32 n;</span>
<a href="#l12.50"></a><span id="l12.50">     rv = mStream-&gt;Write(header, L, &amp;n);</span>
<a href="#l12.51"></a><span id="l12.51">     if (NS_FAILED(rv) || n &lt; L) {</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-      rv = MK_MIME_ERROR_WRITING_FILE;</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+      // XXX This is -1, not an nsresult</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+      rv = static_cast&lt;nsresult&gt;(MK_MIME_ERROR_WRITING_FILE);</span>
<a href="#l12.55"></a><span id="l12.55">     }</span>
<a href="#l12.56"></a><span id="l12.56">   } else {</span>
<a href="#l12.57"></a><span id="l12.57">     /* If this is an inner block, feed it through the crypto stream. */</span>
<a href="#l12.58"></a><span id="l12.58">     rv = MimeCryptoWriteBlock (header, L);</span>
<a href="#l12.59"></a><span id="l12.59">   }</span>
<a href="#l12.60"></a><span id="l12.60"> </span>
<a href="#l12.61"></a><span id="l12.61">   PR_Free(header);</span>
<a href="#l12.62"></a><span id="l12.62">   if (NS_FAILED(rv)) goto FAIL;</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineat">@@ -654,17 +657,18 @@ nsresult nsMsgComposeSecure::MimeFinishM</span>
<a href="#l12.64"></a><span id="l12.64">   }</span>
<a href="#l12.65"></a><span id="l12.65"> </span>
<a href="#l12.66"></a><span id="l12.66">   L = strlen(header);</span>
<a href="#l12.67"></a><span id="l12.67">   if (aOuter) {</span>
<a href="#l12.68"></a><span id="l12.68">     /* If this is the outer block, write it to the file. */</span>
<a href="#l12.69"></a><span id="l12.69">     PRUint32 n;</span>
<a href="#l12.70"></a><span id="l12.70">     rv = mStream-&gt;Write(header, L, &amp;n);</span>
<a href="#l12.71"></a><span id="l12.71">     if (NS_FAILED(rv) || n &lt; L) {</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineminus">-      rv = MK_MIME_ERROR_WRITING_FILE;</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+      // XXX This is -1, not an nsresult</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+      rv = static_cast&lt;nsresult&gt;(MK_MIME_ERROR_WRITING_FILE);</span>
<a href="#l12.75"></a><span id="l12.75">     } </span>
<a href="#l12.76"></a><span id="l12.76">   } else {</span>
<a href="#l12.77"></a><span id="l12.77">     /* If this is an inner block, feed it through the crypto stream. */</span>
<a href="#l12.78"></a><span id="l12.78">     rv = MimeCryptoWriteBlock (header, L);</span>
<a href="#l12.79"></a><span id="l12.79">   }</span>
<a href="#l12.80"></a><span id="l12.80"> </span>
<a href="#l12.81"></a><span id="l12.81">   PR_Free(header);</span>
<a href="#l12.82"></a><span id="l12.82"> </span>
<a href="#l12.83"></a><span id="l12.83" class="difflineat">@@ -733,17 +737,18 @@ nsresult nsMsgComposeSecure::MimeFinishM</span>
<a href="#l12.84"></a><span id="l12.84">     goto FAIL;</span>
<a href="#l12.85"></a><span id="l12.85">   }</span>
<a href="#l12.86"></a><span id="l12.86">   L = strlen(header);</span>
<a href="#l12.87"></a><span id="l12.87">   if (aOuter) {</span>
<a href="#l12.88"></a><span id="l12.88">     /* If this is the outer block, write it to the file. */</span>
<a href="#l12.89"></a><span id="l12.89">     PRUint32 n;</span>
<a href="#l12.90"></a><span id="l12.90">     rv = mStream-&gt;Write(header, L, &amp;n);</span>
<a href="#l12.91"></a><span id="l12.91">     if (NS_FAILED(rv) || n &lt; L)</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineminus">-      rv = MK_MIME_ERROR_WRITING_FILE;</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+      // XXX This is -1, not an nsresult</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+      rv = static_cast&lt;nsresult&gt;(MK_MIME_ERROR_WRITING_FILE);</span>
<a href="#l12.95"></a><span id="l12.95">   } else {</span>
<a href="#l12.96"></a><span id="l12.96">     /* If this is an inner block, feed it through the crypto stream. */</span>
<a href="#l12.97"></a><span id="l12.97">     rv = MimeCryptoWriteBlock (header, L);</span>
<a href="#l12.98"></a><span id="l12.98">   }</span>
<a href="#l12.99"></a><span id="l12.99">   }</span>
<a href="#l12.100"></a><span id="l12.100"> </span>
<a href="#l12.101"></a><span id="l12.101"> FAIL:</span>
<a href="#l12.102"></a><span id="l12.102">   return rv;</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineat">@@ -847,17 +852,18 @@ nsresult nsMsgComposeSecure::MimeCryptoH</span>
<a href="#l12.104"></a><span id="l12.104">   }</span>
<a href="#l12.105"></a><span id="l12.105"> </span>
<a href="#l12.106"></a><span id="l12.106">   pHeader-&gt;ExtractHeaderAddressMailboxes(nsDependentCString(aRecipients),</span>
<a href="#l12.107"></a><span id="l12.107">                                          all_mailboxes);</span>
<a href="#l12.108"></a><span id="l12.108">   pHeader-&gt;RemoveDuplicateAddresses(all_mailboxes, EmptyCString(), mailboxes);</span>
<a href="#l12.109"></a><span id="l12.109"> </span>
<a href="#l12.110"></a><span id="l12.110">   pHeader-&gt;ParseHeaderAddresses(mailboxes.get(), 0, &amp;mailbox_list, &amp;count);</span>
<a href="#l12.111"></a><span id="l12.111"> </span>
<a href="#l12.112"></a><span id="l12.112" class="difflineminus">-  if (count &lt; 0) return count;</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineplus">+  // XXX This is not a valid use of nsresult</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineplus">+  if (count &lt; 0) return static_cast&lt;nsresult&gt;(count);</span>
<a href="#l12.115"></a><span id="l12.115"> </span>
<a href="#l12.116"></a><span id="l12.116">   if (aEncrypt &amp;&amp; mSelfEncryptionCert) {</span>
<a href="#l12.117"></a><span id="l12.117">     // Make sure self's configured cert is prepared for being used</span>
<a href="#l12.118"></a><span id="l12.118">     // as an email recipient cert.</span>
<a href="#l12.119"></a><span id="l12.119">     </span>
<a href="#l12.120"></a><span id="l12.120">     nsCOMPtr&lt;nsISMimeCert&gt; sc = do_QueryInterface(mSelfEncryptionCert);</span>
<a href="#l12.121"></a><span id="l12.121">     if (sc) {</span>
<a href="#l12.122"></a><span id="l12.122">       sc-&gt;SaveSMimeProfile();</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineat">@@ -937,19 +943,22 @@ NS_IMETHODIMP nsMsgComposeSecure::MimeCr</span>
<a href="#l12.124"></a><span id="l12.124">    going to cause the signature check to fail.</span>
<a href="#l12.125"></a><span id="l12.125"> </span>
<a href="#l12.126"></a><span id="l12.126">    (This assumes that, in the cases where From-mangling must happen,</span>
<a href="#l12.127"></a><span id="l12.127">    this function is called a line at a time.  That happens to be the</span>
<a href="#l12.128"></a><span id="l12.128">    case.)</span>
<a href="#l12.129"></a><span id="l12.129">   */</span>
<a href="#l12.130"></a><span id="l12.130">   if (size &gt;= 5 &amp;&amp; buf[0] == 'F' &amp;&amp; !strncmp(buf, &quot;From &quot;, 5)) {</span>
<a href="#l12.131"></a><span id="l12.131">     char mangle[] = &quot;&gt;&quot;;</span>
<a href="#l12.132"></a><span id="l12.132" class="difflineminus">-    status = MimeCryptoWriteBlock (mangle, 1);</span>
<a href="#l12.133"></a><span id="l12.133" class="difflineminus">-    if (status &lt; 0)</span>
<a href="#l12.134"></a><span id="l12.134" class="difflineminus">-    return status;</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineplus">+    nsresult res = MimeCryptoWriteBlock (mangle, 1);</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineplus">+    if (NS_FAILED(res))</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineplus">+      return res;</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineplus">+    // This value will actually be cast back to an nsresult before use, so this</span>
<a href="#l12.139"></a><span id="l12.139" class="difflineplus">+    // cast is reasonable under the circumstances.</span>
<a href="#l12.140"></a><span id="l12.140" class="difflineplus">+    status = static_cast&lt;int&gt;(res);</span>
<a href="#l12.141"></a><span id="l12.141">   }</span>
<a href="#l12.142"></a><span id="l12.142"> </span>
<a href="#l12.143"></a><span id="l12.143">   /* If we're signing, or signing-and-encrypting, feed this data into</span>
<a href="#l12.144"></a><span id="l12.144">    the computation of the hash. */</span>
<a href="#l12.145"></a><span id="l12.145">   if (mDataHash) {</span>
<a href="#l12.146"></a><span id="l12.146">     PR_SetError(0,0);</span>
<a href="#l12.147"></a><span id="l12.147">     mDataHash-&gt;Update((const PRUint8*) buf, size);</span>
<a href="#l12.148"></a><span id="l12.148"> 	  status = PR_GetError();</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineat">@@ -988,21 +997,24 @@ NS_IMETHODIMP nsMsgComposeSecure::MimeCr</span>
<a href="#l12.150"></a><span id="l12.150">     }</span>
<a href="#l12.151"></a><span id="l12.151">   } else {</span>
<a href="#l12.152"></a><span id="l12.152"> 	  /* If we're not encrypting (presumably just signing) then write this</span>
<a href="#l12.153"></a><span id="l12.153"> 		 data directly to the file. */</span>
<a href="#l12.154"></a><span id="l12.154"> </span>
<a href="#l12.155"></a><span id="l12.155">     PRUint32 n;</span>
<a href="#l12.156"></a><span id="l12.156">     rv = mStream-&gt;Write(buf, size, &amp;n);</span>
<a href="#l12.157"></a><span id="l12.157">     if (NS_FAILED(rv) || n &lt; size) {</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineminus">-      return MK_MIME_ERROR_WRITING_FILE;</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineplus">+      // XXX MK_MIME_ERROR_WRITING_FILE is -1, which is not a valid nsresult</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineplus">+      return static_cast&lt;nsresult&gt;(MK_MIME_ERROR_WRITING_FILE);</span>
<a href="#l12.161"></a><span id="l12.161">     }</span>
<a href="#l12.162"></a><span id="l12.162">   }</span>
<a href="#l12.163"></a><span id="l12.163">  FAIL:</span>
<a href="#l12.164"></a><span id="l12.164" class="difflineminus">-  return status;</span>
<a href="#l12.165"></a><span id="l12.165" class="difflineplus">+  // XXX status sometimes has invalid nsresults like -1 or PR_GetError()</span>
<a href="#l12.166"></a><span id="l12.166" class="difflineplus">+  // assigned to it</span>
<a href="#l12.167"></a><span id="l12.167" class="difflineplus">+  return static_cast&lt;nsresult&gt;(status);</span>
<a href="#l12.168"></a><span id="l12.168"> }</span>
<a href="#l12.169"></a><span id="l12.169"> </span>
<a href="#l12.170"></a><span id="l12.170"> /* Returns a string consisting of a Content-Type header, and a boundary</span>
<a href="#l12.171"></a><span id="l12.171">    string, suitable for moving from the header block, down into the body</span>
<a href="#l12.172"></a><span id="l12.172">    of a multipart object.  The boundary itself is also returned (so that</span>
<a href="#l12.173"></a><span id="l12.173">    the caller knows what to write to close it off.)</span>
<a href="#l12.174"></a><span id="l12.174">  */</span>
<a href="#l12.175"></a><span id="l12.175"> static nsresult</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/imap/src/nsIMAPHostSessionList.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/imap/src/nsIMAPHostSessionList.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -658,17 +658,18 @@ NS_IMETHODIMP nsIMAPHostSessionList::Add</span>
<a href="#l13.4"></a><span id="l13.4"> 	PR_EnterMonitor(gCachedHostInfoMonitor);</span>
<a href="#l13.5"></a><span id="l13.5"> 	nsIMAPHostInfo *host = FindHost(serverKey);</span>
<a href="#l13.6"></a><span id="l13.6"> 	if (host)</span>
<a href="#l13.7"></a><span id="l13.7"> 	{</span>
<a href="#l13.8"></a><span id="l13.8"> 		if (host-&gt;fShellCache)</span>
<a href="#l13.9"></a><span id="l13.9"> 		{</span>
<a href="#l13.10"></a><span id="l13.10"> 			bool rv = host-&gt;fShellCache-&gt;AddShellToCache(shell);</span>
<a href="#l13.11"></a><span id="l13.11"> 			PR_ExitMonitor(gCachedHostInfoMonitor);</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-			return rv;</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+			// XXX Cast of bool to nsresult</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+			return static_cast&lt;nsresult&gt;(rv);</span>
<a href="#l13.15"></a><span id="l13.15"> 		}</span>
<a href="#l13.16"></a><span id="l13.16"> 		else</span>
<a href="#l13.17"></a><span id="l13.17"> 		{</span>
<a href="#l13.18"></a><span id="l13.18"> 			PR_ExitMonitor(gCachedHostInfoMonitor);</span>
<a href="#l13.19"></a><span id="l13.19"> 			return NS_OK;</span>
<a href="#l13.20"></a><span id="l13.20"> 		}</span>
<a href="#l13.21"></a><span id="l13.21"> 	}</span>
<a href="#l13.22"></a><span id="l13.22"> 	PR_ExitMonitor(gCachedHostInfoMonitor);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Protocol.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Protocol.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -3558,17 +3558,19 @@ nsPop3Protocol::HandleLine(char *line, P</span>
<a href="#l14.4"></a><span id="l14.4"> </span>
<a href="#l14.5"></a><span id="l14.5">             // The following was added to prevent the loss of Data when we try</span>
<a href="#l14.6"></a><span id="l14.6">             // and write to somewhere we don't have write access error to (See</span>
<a href="#l14.7"></a><span id="l14.7">             // bug 62480)</span>
<a href="#l14.8"></a><span id="l14.8">             // (Note: This is only a temp hack until the underlying XPCOM is</span>
<a href="#l14.9"></a><span id="l14.9">             // fixed to return errors)</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">             if (NS_FAILED(rv))</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-              return (Error((rv == NS_MSG_ERROR_COPYING_FROM_TMP_DOWNLOAD)</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+              // XXX Error() returns -1, which is not a valid nsresult</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+              return static_cast&lt;nsresult&gt;(Error(</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineplus">+                             (rv == NS_MSG_ERROR_COPYING_FROM_TMP_DOWNLOAD)</span>
<a href="#l14.16"></a><span id="l14.16">                              ? POP3_TMP_DOWNLOAD_FAILED</span>
<a href="#l14.17"></a><span id="l14.17">                              : POP3_MESSAGE_WRITE_ERROR));</span>
<a href="#l14.18"></a><span id="l14.18"> </span>
<a href="#l14.19"></a><span id="l14.19">             m_pop3ConData-&gt;msg_closure = nullptr;</span>
<a href="#l14.20"></a><span id="l14.20">             return rv;</span>
<a href="#l14.21"></a><span id="l14.21">         }</span>
<a href="#l14.22"></a><span id="l14.22">     }</span>
<a href="#l14.23"></a><span id="l14.23">     /* Check if the line begins with the termination octet. If so</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineat">@@ -3724,17 +3726,18 @@ nsresult nsPop3Protocol::ProcessProtocol</span>
<a href="#l14.25"></a><span id="l14.25">   PR_LOG(POP3LOGMODULE, PR_LOG_ALWAYS, (&quot;Entering NET_ProcessPop3 %d&quot;,</span>
<a href="#l14.26"></a><span id="l14.26">     aLength));</span>
<a href="#l14.27"></a><span id="l14.27"> </span>
<a href="#l14.28"></a><span id="l14.28">   m_pop3ConData-&gt;pause_for_read = false; /* already paused; reset */</span>
<a href="#l14.29"></a><span id="l14.29"> </span>
<a href="#l14.30"></a><span id="l14.30">   if(m_username.IsEmpty())</span>
<a href="#l14.31"></a><span id="l14.31">   {</span>
<a href="#l14.32"></a><span id="l14.32">     // net_pop3_block = false;</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-    return(Error(POP3_USERNAME_UNDEFINED));</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+    // XXX Error() returns -1, which is not a valid nsresult</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+    return static_cast&lt;nsresult&gt;(Error(POP3_USERNAME_UNDEFINED));</span>
<a href="#l14.36"></a><span id="l14.36">   }</span>
<a href="#l14.37"></a><span id="l14.37"> </span>
<a href="#l14.38"></a><span id="l14.38">   while(!m_pop3ConData-&gt;pause_for_read)</span>
<a href="#l14.39"></a><span id="l14.39">   {</span>
<a href="#l14.40"></a><span id="l14.40">     PR_LOG(POP3LOGMODULE, PR_LOG_ALWAYS,</span>
<a href="#l14.41"></a><span id="l14.41">       (&quot;POP3: Entering state: %d&quot;, m_pop3ConData-&gt;next_state));</span>
<a href="#l14.42"></a><span id="l14.42"> </span>
<a href="#l14.43"></a><span id="l14.43">     switch(m_pop3ConData-&gt;next_state)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/mime/emitters/src/nsMimeBaseEmitter.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -694,17 +694,19 @@ nsMimeBaseEmitter::GenerateDateString(co</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5">   dateFormatPrefs-&gt;GetBoolPref(&quot;date_senders_timezone&quot;, &amp;displaySenderTimezone);</span>
<a href="#l15.6"></a><span id="l15.6">   dateFormatPrefs-&gt;GetBoolPref(&quot;original_date&quot;, &amp;displayOriginalDate);</span>
<a href="#l15.7"></a><span id="l15.7">   // migrate old pref to date_senders_timezone</span>
<a href="#l15.8"></a><span id="l15.8">   if (displayOriginalDate &amp;&amp; !displaySenderTimezone)</span>
<a href="#l15.9"></a><span id="l15.9">     dateFormatPrefs-&gt;SetBoolPref(&quot;date_senders_timezone&quot;, true);</span>
<a href="#l15.10"></a><span id="l15.10"> </span>
<a href="#l15.11"></a><span id="l15.11">   PRExplodedTime explodedMsgTime;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  rv = PR_ParseTimeStringToExplodedTime(dateString, false, &amp;explodedMsgTime);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  // XXX Casting PRStatus to nsresult</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+  rv = static_cast&lt;nsresult&gt;(</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+    PR_ParseTimeStringToExplodedTime(dateString, false, &amp;explodedMsgTime));</span>
<a href="#l15.16"></a><span id="l15.16">   /**</span>
<a href="#l15.17"></a><span id="l15.17">    * To determine the date format to use, comparison of current and message</span>
<a href="#l15.18"></a><span id="l15.18">    * time has to be made. If displaying in local time, both timestamps have</span>
<a href="#l15.19"></a><span id="l15.19">    * to be in local time. If displaying in senders time zone, leave the compare</span>
<a href="#l15.20"></a><span id="l15.20">    * time in that time zone.</span>
<a href="#l15.21"></a><span id="l15.21">    * Otherwise in TZ+0100 on 2009-03-12 a message from 2009-03-11T20:49-0700</span>
<a href="#l15.22"></a><span id="l15.22">    * would be displayed as &quot;20:49 -0700&quot; though it in fact is not from the</span>
<a href="#l15.23"></a><span id="l15.23">    * same day.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/mime/src/mimemoz2.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/mime/src/mimemoz2.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -588,17 +588,18 @@ MimeGetAttachmentList(MimeObject *tobj, </span>
<a href="#l16.4"></a><span id="l16.4">   if (!mime_subclass_p(obj-&gt;clazz, (MimeObjectClass*) &amp;mimeContainerClass))</span>
<a href="#l16.5"></a><span id="l16.5">     return ProcessBodyAsAttachment(obj, data);</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7">   isAnInlineMessage = mime_typep(obj, (MimeObjectClass *) &amp;mimeMessageClass);</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9">   cobj = (MimeContainer*) obj;</span>
<a href="#l16.10"></a><span id="l16.10">   n = CountTotalMimeAttachments(cobj);</span>
<a href="#l16.11"></a><span id="l16.11">   if (n &lt;= 0)</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-    return n;</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+    // XXX n is a regular number here, not meaningful as an nsresult</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+    return static_cast&lt;nsresult&gt;(n);</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16">   // in case of an inline message (as body), we need an extra slot for the</span>
<a href="#l16.17"></a><span id="l16.17">   // message itself that we will fill later...</span>
<a href="#l16.18"></a><span id="l16.18">   if (isAnInlineMessage)</span>
<a href="#l16.19"></a><span id="l16.19">     n ++;</span>
<a href="#l16.20"></a><span id="l16.20"> </span>
<a href="#l16.21"></a><span id="l16.21">   *data = new nsMsgAttachmentData[n + 1];</span>
<a href="#l16.22"></a><span id="l16.22">   if (!*data)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/mime/src/nsMimeHeaders.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/mime/src/nsMimeHeaders.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -23,17 +23,18 @@ NS_IMPL_ISUPPORTS1(nsMimeHeaders, nsIMim</span>
<a href="#l17.4"></a><span id="l17.4"> nsresult nsMimeHeaders::Initialize(const char *aAllHeaders, PRInt32 allHeadersSize)</span>
<a href="#l17.5"></a><span id="l17.5"> {</span>
<a href="#l17.6"></a><span id="l17.6">   /* just in case we want to reuse the object, cleanup...*/</span>
<a href="#l17.7"></a><span id="l17.7">   if (mHeaders)</span>
<a href="#l17.8"></a><span id="l17.8">     MimeHeaders_free(mHeaders);</span>
<a href="#l17.9"></a><span id="l17.9"> </span>
<a href="#l17.10"></a><span id="l17.10">   mHeaders = MimeHeaders_new();</span>
<a href="#l17.11"></a><span id="l17.11">   if (mHeaders)</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    return MimeHeaders_parse_line(aAllHeaders, allHeadersSize, mHeaders);</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+    // XXX This function returns -1 in some paths, not nsresult</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+    return static_cast&lt;nsresult&gt;(MimeHeaders_parse_line(aAllHeaders, allHeadersSize, mHeaders));</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16">   return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l17.17"></a><span id="l17.17"> }</span>
<a href="#l17.18"></a><span id="l17.18"> </span>
<a href="#l17.19"></a><span id="l17.19"> nsresult nsMimeHeaders::ExtractHeader(const char *headerName, bool getAllOfThem, char **_retval)</span>
<a href="#l17.20"></a><span id="l17.20"> {</span>
<a href="#l17.21"></a><span id="l17.21">   NS_ENSURE_ARG_POINTER(_retval);</span>
<a href="#l17.22"></a><span id="l17.22">   NS_ENSURE_TRUE(mHeaders, NS_ERROR_NOT_INITIALIZED);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/mime/src/nsStreamConverter.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/mime/src/nsStreamConverter.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -937,17 +937,19 @@ const char output[] = &quot;\</span>
<a href="#l18.4"></a><span id="l18.4">     if (mEmitter)</span>
<a href="#l18.5"></a><span id="l18.5">     {</span>
<a href="#l18.6"></a><span id="l18.6">       rc = mEmitter-&gt;Write(Substring(buf, buf+readLen), &amp;written);</span>
<a href="#l18.7"></a><span id="l18.7">     }</span>
<a href="#l18.8"></a><span id="l18.8">   }</span>
<a href="#l18.9"></a><span id="l18.9">   else if (mBridgeStream)</span>
<a href="#l18.10"></a><span id="l18.10">   {</span>
<a href="#l18.11"></a><span id="l18.11">     nsMIMESession   *tSession = (nsMIMESession *) mBridgeStream;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-    rc = tSession-&gt;put_block((nsMIMESession *)mBridgeStream, buf, readLen);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+    // XXX Casting int to nsresult</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+    rc = static_cast&lt;nsresult&gt;(</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+      tSession-&gt;put_block((nsMIMESession *)mBridgeStream, buf, readLen));</span>
<a href="#l18.16"></a><span id="l18.16">   }</span>
<a href="#l18.17"></a><span id="l18.17"> </span>
<a href="#l18.18"></a><span id="l18.18">   PR_FREEIF(buf);</span>
<a href="#l18.19"></a><span id="l18.19">   return rc;</span>
<a href="#l18.20"></a><span id="l18.20"> }</span>
<a href="#l18.21"></a><span id="l18.21"> </span>
<a href="#l18.22"></a><span id="l18.22"> /////////////////////////////////////////////////////////////////////////////</span>
<a href="#l18.23"></a><span id="l18.23"> // Methods for nsIRequestObserver</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -449,17 +449,18 @@ nsNNTPNewsgroupList::AddToKnownArticles(</span>
<a href="#l19.4"></a><span id="l19.4"> </span>
<a href="#l19.5"></a><span id="l19.5">   if (!m_knownArts.set)</span>
<a href="#l19.6"></a><span id="l19.6">   {</span>
<a href="#l19.7"></a><span id="l19.7">     m_knownArts.set = nsMsgKeySet::Create();</span>
<a href="#l19.8"></a><span id="l19.8">     if (!m_knownArts.set)</span>
<a href="#l19.9"></a><span id="l19.9">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l19.10"></a><span id="l19.10">   }</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  status = m_knownArts.set-&gt;AddRange(first, last);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  // XXX Casting int to nsresult</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+  status = static_cast&lt;nsresult&gt;(m_knownArts.set-&gt;AddRange(first, last));</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16">   if (m_newsDB) {</span>
<a href="#l19.17"></a><span id="l19.17">     nsresult rv = NS_OK;</span>
<a href="#l19.18"></a><span id="l19.18">     nsCOMPtr &lt;nsIDBFolderInfo&gt; newsGroupInfo;</span>
<a href="#l19.19"></a><span id="l19.19">     rv = m_newsDB-&gt;GetDBFolderInfo(getter_AddRefs(newsGroupInfo));</span>
<a href="#l19.20"></a><span id="l19.20">     if (NS_SUCCEEDED(rv) &amp;&amp; newsGroupInfo) {</span>
<a href="#l19.21"></a><span id="l19.21">       nsCString output;</span>
<a href="#l19.22"></a><span id="l19.22">       status = m_knownArts.set-&gt;Output(getter_Copies(output));</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

