<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 6754:113880e9f04372ea03887b0ca70aa443d919d966</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 113880e9f04372ea03887b0ca70aa443d919d966" />
<meta property="og:url" content="/comm-central/rev/113880e9f04372ea03887b0ca70aa443d919d966" />
<meta property="og:description" content="Bug 250141 - Introduce deletion of newsgroup messages r=bienvenu, sr=neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 113880e9f04372ea03887b0ca70aa443d919d966 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/113880e9f04372ea03887b0ca70aa443d919d966">shortlog</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/113880e9f04372ea03887b0ca70aa443d919d966">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966">files</a> |
changeset |
<a href="/comm-central/raw-rev/113880e9f04372ea03887b0ca70aa443d919d966">raw</a>  | <a href="/comm-central/archive/113880e9f04372ea03887b0ca70aa443d919d966.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=250141">Bug 250141</a> - Introduce deletion of newsgroup messages r=bienvenu, sr=neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#115;&#104;&#117;&#97;&#32;&#67;&#114;&#97;&#110;&#109;&#101;&#114;&#32;&#60;&#80;&#105;&#100;&#103;&#101;&#111;&#116;&#49;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 06 Sep 2010 08:57:09 -0400</td></tr>

<tr>
 <td>changeset 6754</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/113880e9f04372ea03887b0ca70aa443d919d966">113880e9f04372ea03887b0ca70aa443d919d966</a></td>
</tr>



<tr>
<td>parent 6753</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a42338acc7db45330650c846f591d4ba4ace0898">a42338acc7db45330650c846f591d4ba4ace0898</a>
</td>
</tr>

<tr>
<td>child 6755</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bcacd8aada1d4e97f5ac9f89012d7cc6f82fa300">bcacd8aada1d4e97f5ac9f89012d7cc6f82fa300</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=113880e9f04372ea03887b0ca70aa443d919d966">5188</a></td></tr>
<tr><td>push user</td><td>Pidgeot18@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Wed, 24 Nov 2010 17:45:19 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@113880e9f043 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=113880e9f04372ea03887b0ca70aa443d919d966">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=113880e9f04372ea03887b0ca70aa443d919d966&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=113880e9f04372ea03887b0ca70aa443d919d966&newProject=comm-central&newRevision=113880e9f04372ea03887b0ca70aa443d919d966&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=113880e9f04372ea03887b0ca70aa443d919d966&newProject=comm-central&newRevision=113880e9f04372ea03887b0ca70aa443d919d966&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=113880e9f04372ea03887b0ca70aa443d919d966&newProject=comm-central&newRevision=113880e9f04372ea03887b0ca70aa443d919d966&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bienvenu%29&revcount=50">bienvenu</a>, <a href="/comm-central/log?rev=reviewer%28neil%29&revcount=50">neil</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=250141">250141</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=250141">Bug 250141</a> - Introduce deletion of newsgroup messages r=bienvenu, sr=neil

This also makes the distinction between `cancel' and `delete' much more clear.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/SearchDialog.js">mail/base/content/SearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/SearchDialog.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/SearchDialog.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/SearchDialog.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/SearchDialog.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/SearchDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mail3PaneWindowCommands.js">mail/base/content/mail3PaneWindowCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mail3PaneWindowCommands.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mail3PaneWindowCommands.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mail3PaneWindowCommands.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mail3PaneWindowCommands.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mail3PaneWindowCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.xul">mail/base/content/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mail/base/content/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/news.properties">mail/locales/en-US/chrome/messenger/news.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/news.properties">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/news.properties">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/news.properties">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/news.properties">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mail/locales/en-US/chrome/messenger/news.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/public/nsIMsgFolder.idl">mailnews/base/public/nsIMsgFolder.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/public/nsIMsgFolder.idl">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/public/nsIMsgFolder.idl">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/public/nsIMsgFolder.idl">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/public/nsIMsgFolder.idl">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/public/nsIMsgFolder.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/public/nsIMsgNewsFolder.idl">mailnews/news/public/nsIMsgNewsFolder.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/public/nsIMsgNewsFolder.idl">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/public/nsIMsgNewsFolder.idl">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/public/nsIMsgNewsFolder.idl">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/public/nsIMsgNewsFolder.idl">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/public/nsIMsgNewsFolder.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.cpp">mailnews/news/src/nsNewsFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.cpp">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.cpp">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.cpp">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.cpp">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.h">mailnews/news/src/nsNewsFolder.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.h">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.h">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.h">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.h">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/mailnews/news/src/nsNewsFolder.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/messenger.dtd">suite/locales/en-US/chrome/mailnews/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/messenger.dtd">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/messenger.dtd">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/news.properties">suite/locales/en-US/chrome/mailnews/news.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/news.properties">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/news.properties">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/news.properties">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/news.properties">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/locales/en-US/chrome/mailnews/news.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mail3PaneWindowCommands.js">suite/mailnews/mail3PaneWindowCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mail3PaneWindowCommands.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mail3PaneWindowCommands.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mail3PaneWindowCommands.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mail3PaneWindowCommands.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mail3PaneWindowCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.js">suite/mailnews/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.xul">suite/mailnews/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/messageWindow.js">suite/mailnews/messageWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/messageWindow.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/messageWindow.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/messageWindow.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/messageWindow.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/messageWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/search/SearchDialog.js">suite/mailnews/search/SearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/search/SearchDialog.js">file</a> |
<a href="/comm-central/annotate/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/search/SearchDialog.js">annotate</a> |
<a href="/comm-central/diff/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/search/SearchDialog.js">diff</a> |
<a href="/comm-central/comparison/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/search/SearchDialog.js">comparison</a> |
<a href="/comm-central/log/113880e9f04372ea03887b0ca70aa443d919d966/suite/mailnews/search/SearchDialog.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/SearchDialog.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -96,18 +96,17 @@ var nsSearchResultsController =</span>
<a href="#l1.4"></a><span id="l1.4">           case &quot;open_in_folder_button&quot;:</span>
<a href="#l1.5"></a><span id="l1.5">             if (GetNumSelectedMessages() != 1)</span>
<a href="#l1.6"></a><span id="l1.6">               enabled = false;</span>
<a href="#l1.7"></a><span id="l1.7">             break;</span>
<a href="#l1.8"></a><span id="l1.8">           case &quot;cmd_delete&quot;:</span>
<a href="#l1.9"></a><span id="l1.9">           case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l1.10"></a><span id="l1.10">           case &quot;button_delete&quot;:</span>
<a href="#l1.11"></a><span id="l1.11">             // this assumes that advanced searches don't cross accounts</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-            if (GetNumSelectedMessages() &lt;= 0 ||</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-                isNewsURI(gFolderDisplay.view.dbView.getURIForViewIndex(0)))</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+            if (GetNumSelectedMessages() &lt;= 0)</span>
<a href="#l1.15"></a><span id="l1.15">               enabled = false;</span>
<a href="#l1.16"></a><span id="l1.16">             break;</span>
<a href="#l1.17"></a><span id="l1.17">           case &quot;saveas_vf_button&quot;:</span>
<a href="#l1.18"></a><span id="l1.18">               // need someway to see if there are any search criteria...</span>
<a href="#l1.19"></a><span id="l1.19">               return true;</span>
<a href="#l1.20"></a><span id="l1.20">           case &quot;cmd_selectAll&quot;:</span>
<a href="#l1.21"></a><span id="l1.21">             return true;</span>
<a href="#l1.22"></a><span id="l1.22">           default:</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineat">@@ -614,47 +613,35 @@ function onSearchButton(event)</span>
<a href="#l1.24"></a><span id="l1.24"> // threadPane.js will be needing this, too</span>
<a href="#l1.25"></a><span id="l1.25"> function GetNumSelectedMessages()</span>
<a href="#l1.26"></a><span id="l1.26"> {</span>
<a href="#l1.27"></a><span id="l1.27">   return gFolderDisplay.treeSelection.count;</span>
<a href="#l1.28"></a><span id="l1.28"> }</span>
<a href="#l1.29"></a><span id="l1.29"> </span>
<a href="#l1.30"></a><span id="l1.30"> function MsgDeleteSelectedMessages(aCommandType)</span>
<a href="#l1.31"></a><span id="l1.31"> {</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-    // we don't delete news messages, we just return in that case</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-    if (gFolderDisplay.selectedMessageIsNews)</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-        return;</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-    // if mail messages delete</span>
<a href="#l1.37"></a><span id="l1.37">     gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l1.38"></a><span id="l1.38">     gFolderDisplay.doCommand(aCommandType);</span>
<a href="#l1.39"></a><span id="l1.39"> }</span>
<a href="#l1.40"></a><span id="l1.40"> </span>
<a href="#l1.41"></a><span id="l1.41"> function MoveMessageInSearch(destFolder)</span>
<a href="#l1.42"></a><span id="l1.42"> {</span>
<a href="#l1.43"></a><span id="l1.43">   // Get the msg folder we're moving messages into.</span>
<a href="#l1.44"></a><span id="l1.44">   // If the id (uri) is not set, use file-uri which is set for</span>
<a href="#l1.45"></a><span id="l1.45">   // &quot;File Here&quot;.</span>
<a href="#l1.46"></a><span id="l1.46">   let destUri = destFolder.getAttribute('id');</span>
<a href="#l1.47"></a><span id="l1.47">   if (destUri.length == 0)</span>
<a href="#l1.48"></a><span id="l1.48">     destUri = destFolder.getAttribute('file-uri');</span>
<a href="#l1.49"></a><span id="l1.49"> </span>
<a href="#l1.50"></a><span id="l1.50">   let destMsgFolder = GetMsgFolderFromUri(destUri).QueryInterface(</span>
<a href="#l1.51"></a><span id="l1.51">                         Components.interfaces.nsIMsgFolder);</span>
<a href="#l1.52"></a><span id="l1.52"> </span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-  // we don't move news messages, we copy them</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineminus">-  if (gFolderDisplay.selectedMessageIsNews) {</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineminus">-    gFolderDisplay.doCommandWithFolder(nsMsgViewCommandType.copyMessages,</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineminus">-                                       destMsgFolder);</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-  }</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineminus">-  else {</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineminus">-    gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineminus">-    gFolderDisplay.doCommandWithFolder(nsMsgViewCommandType.moveMessages,</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-                                       destMsgFolder);</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineminus">-  }</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineplus">+  gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineplus">+  gFolderDisplay.doCommandWithFolder(nsMsgViewCommandType.moveMessages,</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineplus">+                                     destMsgFolder);</span>
<a href="#l1.66"></a><span id="l1.66"> }</span>
<a href="#l1.67"></a><span id="l1.67"> </span>
<a href="#l1.68"></a><span id="l1.68"> function OpenInFolder()</span>
<a href="#l1.69"></a><span id="l1.69"> {</span>
<a href="#l1.70"></a><span id="l1.70">   MailUtils.displayMessageInFolderTab(gFolderDisplay.selectedMessage);</span>
<a href="#l1.71"></a><span id="l1.71"> }</span>
<a href="#l1.72"></a><span id="l1.72"> </span>
<a href="#l1.73"></a><span id="l1.73"> function saveAsVirtualFolder()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -245,16 +245,17 @@ var DefaultController =</span>
<a href="#l2.4"></a><span id="l2.4">       case &quot;cmd_downloadFlagged&quot;:</span>
<a href="#l2.5"></a><span id="l2.5">       case &quot;cmd_downloadSelected&quot;:</span>
<a href="#l2.6"></a><span id="l2.6">       case &quot;cmd_synchronizeOffline&quot;:</span>
<a href="#l2.7"></a><span id="l2.7">         return MailOfflineMgr.isOnline();</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">       case &quot;cmd_watchThread&quot;:</span>
<a href="#l2.10"></a><span id="l2.10">       case &quot;cmd_killThread&quot;:</span>
<a href="#l2.11"></a><span id="l2.11">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+      case &quot;cmd_cancel&quot;:</span>
<a href="#l2.13"></a><span id="l2.13">         return(gFolderDisplay.selectedMessageIsNews);</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15">       default:</span>
<a href="#l2.16"></a><span id="l2.16">         return false;</span>
<a href="#l2.17"></a><span id="l2.17">     }</span>
<a href="#l2.18"></a><span id="l2.18">   },</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">   isCommandEnabled: function(command)</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineat">@@ -268,16 +269,21 @@ var DefaultController =</span>
<a href="#l2.22"></a><span id="l2.22">       case &quot;cmd_delete&quot;:</span>
<a href="#l2.23"></a><span id="l2.23">         UpdateDeleteCommand();</span>
<a href="#l2.24"></a><span id="l2.24">         // fall through</span>
<a href="#l2.25"></a><span id="l2.25">       case &quot;button_delete&quot;:</span>
<a href="#l2.26"></a><span id="l2.26">         UpdateDeleteToolbarButton();</span>
<a href="#l2.27"></a><span id="l2.27">         return gFolderDisplay.getCommandStatus(nsMsgViewCommandType.deleteMsg);</span>
<a href="#l2.28"></a><span id="l2.28">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l2.29"></a><span id="l2.29">         return gFolderDisplay.getCommandStatus(nsMsgViewCommandType.deleteNoTrash);</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+      case &quot;cmd_cancel&quot;: {</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+        let selectedMessages = gFolderDisplay.selectedMessages;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+        return selectedMessages.length == 1 &amp;&amp; selectedMessages[0].folder &amp;&amp;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+               selectedMessages[0].folder.server.type == &quot;nntp&quot;;</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+      }</span>
<a href="#l2.35"></a><span id="l2.35">       case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.36"></a><span id="l2.36">         var folders = gFolderTreeView.getSelectedFolders();</span>
<a href="#l2.37"></a><span id="l2.37">         if (folders.length == 1) {</span>
<a href="#l2.38"></a><span id="l2.38">           var folder = folders[0];</span>
<a href="#l2.39"></a><span id="l2.39">           if (folder.server.type == &quot;nntp&quot;)</span>
<a href="#l2.40"></a><span id="l2.40">             return false; // Just disable the command for news.</span>
<a href="#l2.41"></a><span id="l2.41">           else</span>
<a href="#l2.42"></a><span id="l2.42">             return CanDeleteFolder(folder);</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineat">@@ -616,16 +622,21 @@ var DefaultController =</span>
<a href="#l2.44"></a><span id="l2.44">         // If this is a right-click triggered delete, then do not hint about</span>
<a href="#l2.45"></a><span id="l2.45">         //  the deletion.  Note: The code that swaps the selection back in will</span>
<a href="#l2.46"></a><span id="l2.46">         //  take care of ensuring that this deletion does not make the saved</span>
<a href="#l2.47"></a><span id="l2.47">         //  selection incorrect.</span>
<a href="#l2.48"></a><span id="l2.48">         if (!gRightMouseButtonSavedSelection)</span>
<a href="#l2.49"></a><span id="l2.49">           gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l2.50"></a><span id="l2.50">         gFolderDisplay.doCommand(nsMsgViewCommandType.deleteMsg);</span>
<a href="#l2.51"></a><span id="l2.51">         break;</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+      case &quot;cmd_cancel&quot;:</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineplus">+        let message = gFolderDisplay.selectedMessages[0];</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineplus">+        message.folder.QueryInterface(Components.interfaces.nsIMsgNewsFolder)</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+                      .cancelMessage(message, msgWindow);</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+        break;</span>
<a href="#l2.57"></a><span id="l2.57">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l2.58"></a><span id="l2.58">         MarkSelectedMessagesRead(true);</span>
<a href="#l2.59"></a><span id="l2.59">         gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l2.60"></a><span id="l2.60">         gFolderDisplay.doCommand(nsMsgViewCommandType.deleteNoTrash);</span>
<a href="#l2.61"></a><span id="l2.61">         break;</span>
<a href="#l2.62"></a><span id="l2.62">       case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.63"></a><span id="l2.63">         gFolderTreeController.deleteFolder();</span>
<a href="#l2.64"></a><span id="l2.64">         break;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -349,16 +349,17 @@ function InitMessageMenu()</span>
<a href="#l3.4"></a><span id="l3.4">   document.getElementById(&quot;replyMainMenu&quot;).hidden = isNews;</span>
<a href="#l3.5"></a><span id="l3.5">   document.getElementById(&quot;replySenderMainMenu&quot;).hidden = !isNews;</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7">   // We only kill and watch threads for news.</span>
<a href="#l3.8"></a><span id="l3.8">   document.getElementById(&quot;threadItemsSeparator&quot;).hidden = !isNews;</span>
<a href="#l3.9"></a><span id="l3.9">   document.getElementById(&quot;killThread&quot;).hidden = !isNews;</span>
<a href="#l3.10"></a><span id="l3.10">   document.getElementById(&quot;killSubthread&quot;).hidden = !isNews;</span>
<a href="#l3.11"></a><span id="l3.11">   document.getElementById(&quot;watchThread&quot;).hidden = !isNews;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+  document.getElementById(&quot;menu_cancel&quot;).hidden = !isNews;</span>
<a href="#l3.13"></a><span id="l3.13"> </span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">   // Disable the move and copy menus if there are no messages selected or if</span>
<a href="#l3.16"></a><span id="l3.16">   // the message is a dummy - e.g. opening a message in the standalone window.</span>
<a href="#l3.17"></a><span id="l3.17">   let messageStoredInternally = selectedMsg &amp;&amp; !gMessageDisplay.isDummy;</span>
<a href="#l3.18"></a><span id="l3.18">   // Disable the move menu if we can't delete msgs from the folder.</span>
<a href="#l3.19"></a><span id="l3.19">   let canMove = messageStoredInternally &amp;&amp;</span>
<a href="#l3.20"></a><span id="l3.20">                 gFolderDisplay.canDeleteSelectedMessages;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineat">@@ -1011,19 +1012,17 @@ function UpdateDeleteToolbarButton()</span>
<a href="#l3.22"></a><span id="l3.22">       GetNumSelectedMessages() == 0)</span>
<a href="#l3.23"></a><span id="l3.23">     deleteButtonDeck.selectedIndex = 0;</span>
<a href="#l3.24"></a><span id="l3.24">   else</span>
<a href="#l3.25"></a><span id="l3.25">     deleteButtonDeck.selectedIndex = SelectedMessagesAreDeleted() ? 1 : 0;</span>
<a href="#l3.26"></a><span id="l3.26"> }</span>
<a href="#l3.27"></a><span id="l3.27"> function UpdateDeleteCommand()</span>
<a href="#l3.28"></a><span id="l3.28"> {</span>
<a href="#l3.29"></a><span id="l3.29">   var value = &quot;value&quot;;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-  if (gFolderDisplay.selectedMessageIsNews)</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-    value += &quot;News&quot;;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-  else if (SelectedMessagesAreDeleted())</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+  if (SelectedMessagesAreDeleted())</span>
<a href="#l3.34"></a><span id="l3.34">     value += &quot;IMAPDeleted&quot;;</span>
<a href="#l3.35"></a><span id="l3.35">   if (GetNumSelectedMessages() &lt; 2)</span>
<a href="#l3.36"></a><span id="l3.36">     value += &quot;Message&quot;;</span>
<a href="#l3.37"></a><span id="l3.37">   else</span>
<a href="#l3.38"></a><span id="l3.38">     value += &quot;Messages&quot;;</span>
<a href="#l3.39"></a><span id="l3.39">   goSetMenuValue(&quot;cmd_delete&quot;, value);</span>
<a href="#l3.40"></a><span id="l3.40">   goSetAccessKey(&quot;cmd_delete&quot;, value + &quot;AccessKey&quot;);</span>
<a href="#l3.41"></a><span id="l3.41"> }</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineat">@@ -1221,28 +1220,18 @@ function MsgCopyMessage(aDestFolder)</span>
<a href="#l3.43"></a><span id="l3.43"> }</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45"> /**</span>
<a href="#l3.46"></a><span id="l3.46">  * Moves the selected messages to the destination folder</span>
<a href="#l3.47"></a><span id="l3.47">  * @param aDestFolder  the destination folder</span>
<a href="#l3.48"></a><span id="l3.48">  */</span>
<a href="#l3.49"></a><span id="l3.49"> function MsgMoveMessage(aDestFolder)</span>
<a href="#l3.50"></a><span id="l3.50"> {</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-  // We don't move news messages, we copy them.</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">-  // XXX this check is incorrect in two ways. For saved searches we could have</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-  // cross folder/newsgroup messages, so this check would do the wrong thing.</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineminus">-  // For global search views, we don't have a msgFolder - however as we don't</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-  // index newsgroup messages, we can at least temporarily get away with this.</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-  if (gDBView.msgFolder &amp;&amp; isNewsURI(gDBView.msgFolder.URI))</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineminus">-    gDBView.doCommandWithFolder(nsMsgViewCommandType.copyMessages, aDestFolder);</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-  else</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-  {</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-    gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-    gDBView.doCommandWithFolder(nsMsgViewCommandType.moveMessages, aDestFolder);</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-  }</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineplus">+  gFolderDisplay.hintAboutToDeleteMessages();</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineplus">+  gDBView.doCommandWithFolder(nsMsgViewCommandType.moveMessages, aDestFolder);</span>
<a href="#l3.65"></a><span id="l3.65">   pref.setCharPref(&quot;mail.last_msg_movecopy_target_uri&quot;, aDestFolder.URI);</span>
<a href="#l3.66"></a><span id="l3.66">   pref.setBoolPref(&quot;mail.last_msg_movecopy_was_move&quot;, true);</span>
<a href="#l3.67"></a><span id="l3.67"> }</span>
<a href="#l3.68"></a><span id="l3.68"> </span>
<a href="#l3.69"></a><span id="l3.69"> /**</span>
<a href="#l3.70"></a><span id="l3.70">  * Calls the ComposeMessage function with the desired type, and proper default</span>
<a href="#l3.71"></a><span id="l3.71">  * based on the event that fired it.</span>
<a href="#l3.72"></a><span id="l3.72">  *</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineat">@@ -2198,22 +2187,17 @@ function IsGetNextNMessagesEnabled()</span>
<a href="#l3.74"></a><span id="l3.74"> }</span>
<a href="#l3.75"></a><span id="l3.75"> </span>
<a href="#l3.76"></a><span id="l3.76"> function SetUpToolbarButtons(uri)</span>
<a href="#l3.77"></a><span id="l3.77"> {</span>
<a href="#l3.78"></a><span id="l3.78">   var deleteButton = document.getElementById(&quot;button-delete&quot;);</span>
<a href="#l3.79"></a><span id="l3.79">   if (!deleteButton)</span>
<a href="#l3.80"></a><span id="l3.80">     return;</span>
<a href="#l3.81"></a><span id="l3.81"> </span>
<a href="#l3.82"></a><span id="l3.82" class="difflineminus">-  // Eventually, we might want to set up the toolbar differently for imap,</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineminus">-  // pop, and news.  For now, just tweak it based on if it is news or not.</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineminus">-  if (isNewsURI(uri))</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineminus">-    deleteButton.setAttribute('hidden', true);</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineminus">-  else</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineminus">-    deleteButton.removeAttribute('hidden');</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineplus">+  deleteButton.removeAttribute('hidden');</span>
<a href="#l3.89"></a><span id="l3.89"> }</span>
<a href="#l3.90"></a><span id="l3.90"> </span>
<a href="#l3.91"></a><span id="l3.91"> function MsgSynchronizeOffline()</span>
<a href="#l3.92"></a><span id="l3.92"> {</span>
<a href="#l3.93"></a><span id="l3.93">   window.openDialog(&quot;chrome://messenger/content/msgSynchronize.xul&quot;, &quot;&quot;,</span>
<a href="#l3.94"></a><span id="l3.94">                     &quot;centerscreen,chrome,modal,titlebar,resizable=yes&quot;,</span>
<a href="#l3.95"></a><span id="l3.95">                     {msgWindow:msgWindow});</span>
<a href="#l3.96"></a><span id="l3.96"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -194,24 +194,21 @@</span>
<a href="#l4.4"></a><span id="l4.4">          valueFolder=&quot;&amp;deleteFolderCmd.label;&quot;</span>
<a href="#l4.5"></a><span id="l4.5">          valueFolderAccessKey=&quot;&amp;deleteFolderCmd.accesskey;&quot;</span>
<a href="#l4.6"></a><span id="l4.6">          valueNewsgroup=&quot;&amp;unsubscribeNewsgroupCmd.label;&quot;</span>
<a href="#l4.7"></a><span id="l4.7">          valueNewsgroupAccessKey=&quot;&amp;unsubscribeNewsgroupCmd.accesskey;&quot;</span>
<a href="#l4.8"></a><span id="l4.8">          valueMessage=&quot;&amp;deleteMsgCmd.label;&quot;</span>
<a href="#l4.9"></a><span id="l4.9">          valueMessageAccessKey=&quot;&amp;deleteMsgCmd.accesskey;&quot;</span>
<a href="#l4.10"></a><span id="l4.10">          valueIMAPDeletedMessage=&quot;&amp;undeleteMsgCmd.label;&quot;</span>
<a href="#l4.11"></a><span id="l4.11">          valueIMAPDeletedMessageAccessKey=&quot;&amp;undeleteMsgCmd.accesskey;&quot;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-         valueNewsMessage=&quot;&amp;cancelNewsMsgCmd.label;&quot;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-         valueNewsMessageAccessKey=&quot;&amp;cancelNewsMsgCmd.accesskey;&quot;</span>
<a href="#l4.14"></a><span id="l4.14">          valueMessages=&quot;&amp;deleteMsgsCmd.label;&quot;</span>
<a href="#l4.15"></a><span id="l4.15">          valueMessagesAccessKey=&quot;&amp;deleteMsgsCmd.accesskey;&quot;</span>
<a href="#l4.16"></a><span id="l4.16">          valueIMAPDeletedMessages=&quot;&amp;undeleteMsgsCmd.label;&quot;</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-         valueIMAPDeletedMessagesAccessKey=&quot;&amp;undeleteMsgsCmd.accesskey;&quot;</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-         valueNewsMessages=&quot;&amp;cancelNewsMsgsCmd.label;&quot;</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-         valueNewsMessagesAccessKey=&quot;&amp;cancelNewsMsgsCmd.accesskey;&quot;/&gt;</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+         valueIMAPDeletedMessagesAccessKey=&quot;&amp;undeleteMsgsCmd.accesskey;&quot;/&gt;</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+  &lt;command id=&quot;cmd_cancel&quot; oncommand=&quot;goDoCommand('cmd_cancel')&quot;/&gt;</span>
<a href="#l4.22"></a><span id="l4.22">   &lt;command id=&quot;cmd_selectAll&quot;/&gt;</span>
<a href="#l4.23"></a><span id="l4.23">   &lt;command id=&quot;cmd_selectThread&quot; oncommand=&quot;goDoCommand('cmd_selectThread')&quot;/&gt;</span>
<a href="#l4.24"></a><span id="l4.24">   &lt;command id=&quot;cmd_selectFlagged&quot; oncommand=&quot;goDoCommand('cmd_selectFlagged')&quot;/&gt;</span>
<a href="#l4.25"></a><span id="l4.25">   &lt;command id=&quot;cmd_properties&quot; oncommand=&quot;goDoCommand('cmd_properties')&quot;</span>
<a href="#l4.26"></a><span id="l4.26">          valueNewsgroup=&quot;&amp;folderPropsNewsgroupCmd.label;&quot;</span>
<a href="#l4.27"></a><span id="l4.27">          valueFolder=&quot;&amp;folderPropsFolderCmd.label;&quot;</span>
<a href="#l4.28"></a><span id="l4.28">          valueGeneric=&quot;&amp;folderPropsCmd.label;&quot;/&gt;</span>
<a href="#l4.29"></a><span id="l4.29">   &lt;command id=&quot;cmd_find&quot; oncommand=&quot;goDoCommand('cmd_find')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineat">@@ -1479,16 +1476,19 @@</span>
<a href="#l4.31"></a><span id="l4.31">                           command=&quot;cmd_recalculateJunkScore&quot;/&gt;</span>
<a href="#l4.32"></a><span id="l4.32">               &lt;/menupopup&gt;</span>
<a href="#l4.33"></a><span id="l4.33">             &lt;/menu&gt;</span>
<a href="#l4.34"></a><span id="l4.34">             &lt;menuseparator id=&quot;messageMenuAfterMarkSeparator&quot;/&gt;</span>
<a href="#l4.35"></a><span id="l4.35">             &lt;menuitem id=&quot;archiveMainMenu&quot; label=&quot;&amp;archiveMsgCmd.label;&quot;</span>
<a href="#l4.36"></a><span id="l4.36">                       accesskey=&quot;&amp;archiveMsgCmd.accesskey;&quot;</span>
<a href="#l4.37"></a><span id="l4.37">                       key=&quot;key_archive&quot;</span>
<a href="#l4.38"></a><span id="l4.38">                       command=&quot;cmd_archive&quot;/&gt;</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+            &lt;menuitem id=&quot;menu_cancel&quot; command=&quot;cmd_cancel&quot;</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+                      label=&quot;&amp;cancelNewsMsgCmd.label;&quot;</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+                      accesskey=&quot;&amp;cancelNewsMsgCmd.accesskey;&quot;/&gt;</span>
<a href="#l4.42"></a><span id="l4.42">             &lt;menu id=&quot;moveMenu&quot;</span>
<a href="#l4.43"></a><span id="l4.43">                   label=&quot;&amp;moveMsgToMenu.label;&quot;</span>
<a href="#l4.44"></a><span id="l4.44">                   accesskey=&quot;&amp;moveMsgToMenu.accesskey;&quot;</span>
<a href="#l4.45"></a><span id="l4.45">                   oncommand=&quot;MsgMoveMessage(event.target._folder)&quot;&gt;</span>
<a href="#l4.46"></a><span id="l4.46">               &lt;menupopup type=&quot;folder&quot; mode=&quot;filing&quot; showFileHereLabel=&quot;true&quot;</span>
<a href="#l4.47"></a><span id="l4.47">                          showRecent=&quot;true&quot; fileHereLabel=&quot;&amp;fileHereMenu.label;&quot;</span>
<a href="#l4.48"></a><span id="l4.48">                          fileHereAccessKey=&quot;&amp;fileHereMenu.accesskey;&quot;</span>
<a href="#l4.49"></a><span id="l4.49">                          recentLabel=&quot;&amp;moveCopyMsgRecentMenu.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -68,24 +68,20 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;!ENTITY printSetupCmd.label &quot;Page Setup&quot;&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> &lt;!ENTITY printSetupCmd.accesskey &quot;u&quot;&gt;</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7"> &lt;!-- Edit Menu --&gt;</span>
<a href="#l5.8"></a><span id="l5.8"> &lt;!ENTITY deleteMsgCmd.label &quot;Delete Message&quot;&gt;</span>
<a href="#l5.9"></a><span id="l5.9"> &lt;!ENTITY deleteMsgCmd.accesskey &quot;D&quot;&gt;</span>
<a href="#l5.10"></a><span id="l5.10"> &lt;!ENTITY undeleteMsgCmd.label &quot;Undelete Message&quot;&gt;</span>
<a href="#l5.11"></a><span id="l5.11"> &lt;!ENTITY undeleteMsgCmd.accesskey &quot;d&quot;&gt;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-&lt;!ENTITY cancelNewsMsgCmd.label &quot;Cancel Message&quot;&gt;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-&lt;!ENTITY cancelNewsMsgCmd.accesskey &quot;M&quot;&gt;</span>
<a href="#l5.14"></a><span id="l5.14"> &lt;!ENTITY deleteMsgsCmd.label &quot;Delete Selected Messages&quot;&gt;</span>
<a href="#l5.15"></a><span id="l5.15"> &lt;!ENTITY deleteMsgsCmd.accesskey &quot;D&quot;&gt;</span>
<a href="#l5.16"></a><span id="l5.16"> &lt;!ENTITY undeleteMsgsCmd.label &quot;Undelete Selected Messages&quot;&gt;</span>
<a href="#l5.17"></a><span id="l5.17"> &lt;!ENTITY undeleteMsgsCmd.accesskey &quot;d&quot;&gt;</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-&lt;!ENTITY cancelNewsMsgsCmd.label &quot;Cancel Selected Messages&quot;&gt;</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-&lt;!ENTITY cancelNewsMsgsCmd.accesskey &quot;n&quot;&gt;</span>
<a href="#l5.20"></a><span id="l5.20"> &lt;!ENTITY deleteFolderCmd.label &quot;Delete Folder&quot;&gt;</span>
<a href="#l5.21"></a><span id="l5.21"> &lt;!ENTITY deleteFolderCmd.accesskey &quot;D&quot;&gt;</span>
<a href="#l5.22"></a><span id="l5.22"> &lt;!ENTITY unsubscribeNewsgroupCmd.label &quot;Unsubscribe&quot;&gt;</span>
<a href="#l5.23"></a><span id="l5.23"> &lt;!ENTITY unsubscribeNewsgroupCmd.accesskey &quot;n&quot;&gt;</span>
<a href="#l5.24"></a><span id="l5.24"> &lt;!ENTITY selectMenu.label &quot;Select&quot;&gt;</span>
<a href="#l5.25"></a><span id="l5.25"> &lt;!ENTITY selectMenu.accesskey &quot;S&quot;&gt;</span>
<a href="#l5.26"></a><span id="l5.26"> &lt;!ENTITY all.label &quot;All&quot;&gt;</span>
<a href="#l5.27"></a><span id="l5.27"> &lt;!ENTITY all.accesskey &quot;A&quot;&gt;</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineat">@@ -325,16 +321,18 @@ you can use these alternative items. Oth</span>
<a href="#l5.29"></a><span id="l5.29"> &lt;!ENTITY msgMenu.accesskey &quot;M&quot;&gt;</span>
<a href="#l5.30"></a><span id="l5.30"> &lt;!ENTITY newMsgCmd.label &quot;New Message&quot;&gt;</span>
<a href="#l5.31"></a><span id="l5.31"> &lt;!ENTITY newMsgCmd.accesskey &quot;N&quot;&gt;</span>
<a href="#l5.32"></a><span id="l5.32"> &lt;!ENTITY newNewMsgCmd.label &quot;Message&quot;&gt;</span>
<a href="#l5.33"></a><span id="l5.33"> &lt;!ENTITY newNewMsgCmd.accesskey &quot;M&quot;&gt;</span>
<a href="#l5.34"></a><span id="l5.34"> &lt;!ENTITY archiveMsgCmd.label &quot;Archive&quot;&gt;</span>
<a href="#l5.35"></a><span id="l5.35"> &lt;!ENTITY archiveMsgCmd.accesskey &quot;A&quot;&gt;</span>
<a href="#l5.36"></a><span id="l5.36"> &lt;!ENTITY archiveMsgCmd.key  &quot;a&quot;&gt;</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+&lt;!ENTITY cancelNewsMsgCmd.label &quot;Cancel Message&quot;&gt;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+&lt;!ENTITY cancelNewsMsgCmd.accesskey &quot;C&quot;&gt;</span>
<a href="#l5.39"></a><span id="l5.39"> &lt;!ENTITY replyMsgCmd.label &quot;Reply&quot;&gt;</span>
<a href="#l5.40"></a><span id="l5.40"> &lt;!ENTITY replyMsgCmd.accesskey &quot;R&quot;&gt;</span>
<a href="#l5.41"></a><span id="l5.41"> &lt;!ENTITY replyMsgCmd.key  &quot;r&quot;&gt;</span>
<a href="#l5.42"></a><span id="l5.42"> &lt;!ENTITY replySenderCmd.label &quot;Reply to Sender Only&quot;&gt;</span>
<a href="#l5.43"></a><span id="l5.43"> &lt;!ENTITY replySenderCmd.accesskey &quot;R&quot;&gt;</span>
<a href="#l5.44"></a><span id="l5.44"> &lt;!ENTITY replyNewsgroupCmd.label &quot;Reply to Newsgroup&quot;&gt;</span>
<a href="#l5.45"></a><span id="l5.45"> &lt;!ENTITY replyNewsgroupCmd.accesskey  &quot;y&quot;&gt;</span>
<a href="#l5.46"></a><span id="l5.46"> &lt;!ENTITY replyToAllMsgCmd.label &quot;Reply to All&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/news.properties</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/news.properties</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -62,18 +62,16 @@ newNewsgroupHeaders=Downloading %1$S of </span>
<a href="#l6.4"></a><span id="l6.4"> # header being filtered on, %2$S is the number of the current header being</span>
<a href="#l6.5"></a><span id="l6.5"> # downloaded, %3$S is the number of headers to be downloaded, and %4$S is the</span>
<a href="#l6.6"></a><span id="l6.6"> # newsgroup whose headers are being downloaded.</span>
<a href="#l6.7"></a><span id="l6.7"> newNewsgroupFilteringHeaders=Getting headers for filters: %1$S (%2$S/%3$S) on %4$S</span>
<a href="#l6.8"></a><span id="l6.8"> downloadingArticles=Downloading articles %S-%S</span>
<a href="#l6.9"></a><span id="l6.9"> bytesReceived=Downloading newsgroups: %S received (%SKB read at %SKB/sec)</span>
<a href="#l6.10"></a><span id="l6.10"> downloadingArticlesForOffline=Downloading articles %S-%S in %S</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-onlyCancelOneMessage=You can only cancel one article at a time.</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-</span>
<a href="#l6.14"></a><span id="l6.14"> # LOCALIZATION NOTE (autoUnsubscribeText): %1$S is the newsgroup and %2$S is the newsgroup-server it is being removed from.</span>
<a href="#l6.15"></a><span id="l6.15"> autoUnsubscribeText=The newsgroup %1$S does not appear to exist on the host %2$S.  Would you like to unsubscribe from it?</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17"> # LOCALIZATION NOTE (autoSubscribeText): %1$S is the newsgroup.</span>
<a href="#l6.18"></a><span id="l6.18"> autoSubscribeText=Would you like to subscribe to %1$S?</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20"> # LOCALIZATION NOTE (Error -304): In the following item, don't translate &quot;NNTP&quot;</span>
<a href="#l6.21"></a><span id="l6.21"> # Error - server error</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/public/nsIMsgFolder.idl</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/public/nsIMsgFolder.idl</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -405,16 +405,26 @@ interface nsIMsgFolder : nsISupports {</span>
<a href="#l7.4"></a><span id="l7.4">    */</span>
<a href="#l7.5"></a><span id="l7.5">   boolean isSpecialFolder(in unsigned long flags,</span>
<a href="#l7.6"></a><span id="l7.6">                           [optional] in boolean checkAncestors);</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8">   void getExpansionArray(in nsISupportsArray expansionArray);</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10">   ACString getUriForMsg(in nsIMsgDBHdr msgHdr);</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+  /**</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+   * Deletes the messages from the folder.</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+   *</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+   * @param messages      The array of nsIMsgDBHdr objects to be deleted.</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+   * @param msgWindow     The standard message window object, for alerts et al.</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+   * @param deleteStorage Whether or not the message should be truly deleted, as</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+                          opposed to moving to trash.</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+   * @param isMove        Whether or not this is a deletion for moving messages.</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+   * @param allowUndo     Whether this action should be undoable.</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+   */</span>
<a href="#l7.22"></a><span id="l7.22">   void deleteMessages(in nsIArray messages,</span>
<a href="#l7.23"></a><span id="l7.23">                       in nsIMsgWindow msgWindow,</span>
<a href="#l7.24"></a><span id="l7.24">                       in boolean deleteStorage, in boolean isMove,</span>
<a href="#l7.25"></a><span id="l7.25">                       in nsIMsgCopyServiceListener listener, in boolean allowUndo);</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27">   void copyMessages(in nsIMsgFolder srcFolder, in nsIArray messages,</span>
<a href="#l7.28"></a><span id="l7.28">                     in boolean isMove, in nsIMsgWindow msgWindow,</span>
<a href="#l7.29"></a><span id="l7.29">                     in nsIMsgCopyServiceListener listener, in boolean isFolder,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -2503,19 +2503,17 @@ NS_IMETHODIMP nsMsgDBView::GetCommandSta</span>
<a href="#l8.4"></a><span id="l8.4">     haveSelection = m_currentlyDisplayedViewIndex != nsMsgViewIndex_None;</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6">   switch (command)</span>
<a href="#l8.7"></a><span id="l8.7">   {</span>
<a href="#l8.8"></a><span id="l8.8">   case nsMsgViewCommandType::deleteMsg:</span>
<a href="#l8.9"></a><span id="l8.9">   case nsMsgViewCommandType::deleteNoTrash:</span>
<a href="#l8.10"></a><span id="l8.10">     {</span>
<a href="#l8.11"></a><span id="l8.11">       PRBool canDelete;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-      // news folders can't delete (or move messages)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-      // but we use delete for cancel messages.</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-      if (m_folder &amp;&amp; !mIsNews &amp;&amp; NS_SUCCEEDED(m_folder-&gt;GetCanDeleteMessages(&amp;canDelete)) &amp;&amp; !canDelete)</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+      if (m_folder &amp;&amp; NS_SUCCEEDED(m_folder-&gt;GetCanDeleteMessages(&amp;canDelete)) &amp;&amp; !canDelete)</span>
<a href="#l8.16"></a><span id="l8.16">         *selectable_p = PR_FALSE;</span>
<a href="#l8.17"></a><span id="l8.17">       else</span>
<a href="#l8.18"></a><span id="l8.18">         *selectable_p = haveSelection;</span>
<a href="#l8.19"></a><span id="l8.19">     }</span>
<a href="#l8.20"></a><span id="l8.20">     break;</span>
<a href="#l8.21"></a><span id="l8.21">   case nsMsgViewCommandType::applyFilters:</span>
<a href="#l8.22"></a><span id="l8.22">     // disable if no messages</span>
<a href="#l8.23"></a><span id="l8.23">     // XXX todo, check that we have filters, and at least one is enabled</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/news/public/nsIMsgNewsFolder.idl</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/news/public/nsIMsgNewsFolder.idl</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -42,17 +42,17 @@</span>
<a href="#l9.4"></a><span id="l9.4"> #include &quot;nsTArray.h&quot;</span>
<a href="#l9.5"></a><span id="l9.5"> %}</span>
<a href="#l9.6"></a><span id="l9.6"> </span>
<a href="#l9.7"></a><span id="l9.7"> interface nsIMsgWindow;</span>
<a href="#l9.8"></a><span id="l9.8"> interface nsINntpIncomingServer;</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10"> [ref] native nsMsgKeyArrayRef(nsTArray&lt;nsMsgKey&gt;);</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-[scriptable, uuid(e56a2366-e66c-4240-a9a1-48c4a0a9ffbc)]</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+[scriptable, uuid(86a38356-6ab0-4117-8269-674cbb4f264f)]</span>
<a href="#l9.14"></a><span id="l9.14"> interface nsIMsgNewsFolder : nsISupports {</span>
<a href="#l9.15"></a><span id="l9.15">   attribute ACString groupUsername;</span>
<a href="#l9.16"></a><span id="l9.16">   attribute ACString groupPassword;</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18">   readonly attribute AString unicodeName;</span>
<a href="#l9.19"></a><span id="l9.19">   /**|rawName| is an 8-bit string to represent the name of a newsgroup used by </span>
<a href="#l9.20"></a><span id="l9.20">    * a news server. It's offered for the convenience of callers so that they </span>
<a href="#l9.21"></a><span id="l9.21">    * don't have to convert |unicodeName| to the server-side name when </span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -96,9 +96,20 @@ interface nsIMsgNewsFolder : nsISupports</span>
<a href="#l9.23"></a><span id="l9.23">   void notifyFinishedDownloadinghdrs();</span>
<a href="#l9.24"></a><span id="l9.24"> </span>
<a href="#l9.25"></a><span id="l9.25">   /**</span>
<a href="#l9.26"></a><span id="l9.26">    * Retrieves the database, but does not cache it in mDatabase.</span>
<a href="#l9.27"></a><span id="l9.27">    *</span>
<a href="#l9.28"></a><span id="l9.28">    * This is useful for operations that shouldn't hold open the database.</span>
<a href="#l9.29"></a><span id="l9.29">    */</span>
<a href="#l9.30"></a><span id="l9.30">   nsIMsgDatabase getDatabaseWithoutCache();</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+  /**</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+   * Requests that a message be canceled.</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+   *</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+   * Note that, before sending the news cancel, this method will check to make</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+   * sure that the user has proper permission to cancel the message.</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+   *</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+   * @param aMsgHdr     The header of the message to be canceled.</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+   * @param aMsgWindow  The standard message window object, for error dialogs.</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineplus">+   */</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineplus">+  void cancelMessage(in nsIMsgDBHdr aMsgHdr, in nsIMsgWindow aMsgWindow);</span>
<a href="#l9.42"></a><span id="l9.42"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -396,24 +396,16 @@ nsMsgNewsFolder::GetCanFileMessages(PRBo</span>
<a href="#l10.4"></a><span id="l10.4"> {</span>
<a href="#l10.5"></a><span id="l10.5">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l10.6"></a><span id="l10.6">   // you can't file messages into a news server or news group</span>
<a href="#l10.7"></a><span id="l10.7">   *aResult = PR_FALSE;</span>
<a href="#l10.8"></a><span id="l10.8">   return NS_OK;</span>
<a href="#l10.9"></a><span id="l10.9"> }</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11"> NS_IMETHODIMP</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-nsMsgNewsFolder::GetCanDeleteMessages(PRBool *aCanDeleteMessages)</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-{</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-  NS_ENSURE_ARG_POINTER(aCanDeleteMessages);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-  *aCanDeleteMessages = PR_FALSE;</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-  return NS_OK;</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineminus">-}</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineminus">-</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-NS_IMETHODIMP</span>
<a href="#l10.20"></a><span id="l10.20"> nsMsgNewsFolder::GetCanCreateSubfolders(PRBool *aResult)</span>
<a href="#l10.21"></a><span id="l10.21"> {</span>
<a href="#l10.22"></a><span id="l10.22">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l10.23"></a><span id="l10.23">   *aResult = PR_FALSE;</span>
<a href="#l10.24"></a><span id="l10.24">   // you can't create subfolders on a news server or a news group</span>
<a href="#l10.25"></a><span id="l10.25">   return NS_OK;</span>
<a href="#l10.26"></a><span id="l10.26"> }</span>
<a href="#l10.27"></a><span id="l10.27"> </span>
<a href="#l10.28"></a><span id="l10.28" class="difflineat">@@ -786,62 +778,71 @@ NS_IMETHODIMP nsMsgNewsFolder::GetRequir</span>
<a href="#l10.29"></a><span id="l10.29">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l10.30"></a><span id="l10.30"> }</span>
<a href="#l10.31"></a><span id="l10.31"> </span>
<a href="#l10.32"></a><span id="l10.32"> NS_IMETHODIMP nsMsgNewsFolder::GetSizeOnDisk(PRUint32 *size)</span>
<a href="#l10.33"></a><span id="l10.33"> {</span>
<a href="#l10.34"></a><span id="l10.34">   return NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l10.35"></a><span id="l10.35"> }</span>
<a href="#l10.36"></a><span id="l10.36"> </span>
<a href="#l10.37"></a><span id="l10.37" class="difflineminus">-/* this is news, so remember that DeleteMessage is really CANCEL. */</span>
<a href="#l10.38"></a><span id="l10.38"> NS_IMETHODIMP</span>
<a href="#l10.39"></a><span id="l10.39"> nsMsgNewsFolder::DeleteMessages(nsIArray *messages, nsIMsgWindow *aMsgWindow,</span>
<a href="#l10.40"></a><span id="l10.40">                                 PRBool deleteStorage, PRBool isMove,</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineminus">-                                nsIMsgCopyServiceListener* listener, PRBool allowUndo)</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineplus">+                                nsIMsgCopyServiceListener* listener,</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+                                PRBool allowUndo)</span>
<a href="#l10.44"></a><span id="l10.44"> {</span>
<a href="#l10.45"></a><span id="l10.45">   nsresult rv = NS_OK;</span>
<a href="#l10.46"></a><span id="l10.46"> </span>
<a href="#l10.47"></a><span id="l10.47">   NS_ENSURE_ARG_POINTER(messages);</span>
<a href="#l10.48"></a><span id="l10.48">   NS_ENSURE_ARG_POINTER(aMsgWindow);</span>
<a href="#l10.49"></a><span id="l10.49"> </span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-  PRUint32 count = 0;</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineminus">-  rv = messages-&gt;GetLength(&amp;count);</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineplus">+  if (!isMove)</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineplus">+  {</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineplus">+    nsCOMPtr&lt;nsIMsgFolderNotificationService&gt; notifier(do_GetService(NS_MSGNOTIFICATIONSERVICE_CONTRACTID));</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+    if (notifier)</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+      notifier-&gt;NotifyMsgsDeleted(messages);</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+  }</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineplus">+</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineplus">+  rv = GetDatabase();</span>
<a href="#l10.60"></a><span id="l10.60">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.61"></a><span id="l10.61"> </span>
<a href="#l10.62"></a><span id="l10.62" class="difflineminus">-  if (count != 1)</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+  rv = EnableNotifications(allMessageCountNotifications, PR_FALSE, PR_TRUE);</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineplus">+  if (NS_SUCCEEDED(rv))</span>
<a href="#l10.65"></a><span id="l10.65">   {</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineminus">-    nsCOMPtr&lt;nsIStringBundleService&gt; bundleService = do_GetService(NS_STRINGBUNDLE_CONTRACTID, &amp;rv);</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineminus">-    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineminus">-</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineminus">-    nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineminus">-    rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineplus">+    PRUint32 count = 0;</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineplus">+    rv = messages-&gt;GetLength(&amp;count);</span>
<a href="#l10.73"></a><span id="l10.73">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.74"></a><span id="l10.74"> </span>
<a href="#l10.75"></a><span id="l10.75" class="difflineminus">-    nsString alertText;</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;onlyCancelOneMessage&quot;).get(), getter_Copies(alertText));</span>
<a href="#l10.77"></a><span id="l10.77" class="difflineminus">-    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.78"></a><span id="l10.78" class="difflineminus">-</span>
<a href="#l10.79"></a><span id="l10.79" class="difflineminus">-    nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineminus">-    rv = aMsgWindow-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineminus">-    NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineplus">+    for (PRUint32 i = 0; i &lt; count &amp;&amp; NS_SUCCEEDED(rv); i++)</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineplus">+    {</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineplus">+      nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr = do_QueryElementAt(messages, i, &amp;rv);</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineplus">+      if (msgHdr)</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineplus">+        rv = mDatabase-&gt;DeleteHeader(msgHdr, nsnull, PR_TRUE, PR_TRUE);</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineplus">+    }</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineplus">+    EnableNotifications(allMessageCountNotifications, PR_TRUE, PR_TRUE);</span>
<a href="#l10.89"></a><span id="l10.89" class="difflineplus">+  }</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineplus">+ </span>
<a href="#l10.91"></a><span id="l10.91" class="difflineplus">+  if (!isMove) </span>
<a href="#l10.92"></a><span id="l10.92" class="difflineplus">+    NotifyFolderEvent(NS_SUCCEEDED(rv) ? mDeleteOrMoveMsgCompletedAtom :</span>
<a href="#l10.93"></a><span id="l10.93" class="difflineplus">+      mDeleteOrMoveMsgFailedAtom);</span>
<a href="#l10.94"></a><span id="l10.94"> </span>
<a href="#l10.95"></a><span id="l10.95" class="difflineminus">-    if (dialog)</span>
<a href="#l10.96"></a><span id="l10.96" class="difflineminus">-    {</span>
<a href="#l10.97"></a><span id="l10.97" class="difflineminus">-      rv = dialog-&gt;Alert(nsnull, alertText.get());</span>
<a href="#l10.98"></a><span id="l10.98" class="difflineminus">-      NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.99"></a><span id="l10.99" class="difflineminus">-    }</span>
<a href="#l10.100"></a><span id="l10.100" class="difflineminus">-    // return failure, since the cancel failed</span>
<a href="#l10.101"></a><span id="l10.101" class="difflineminus">-    return NS_ERROR_FAILURE;</span>
<a href="#l10.102"></a><span id="l10.102" class="difflineminus">-  }</span>
<a href="#l10.103"></a><span id="l10.103" class="difflineplus">+  return NS_OK;</span>
<a href="#l10.104"></a><span id="l10.104" class="difflineplus">+}</span>
<a href="#l10.105"></a><span id="l10.105" class="difflineplus">+</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineplus">+NS_IMETHODIMP nsMsgNewsFolder::CancelMessage(nsIMsgDBHdr *msgHdr,</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineplus">+                                             nsIMsgWindow *aMsgWindow)</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineplus">+{</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineplus">+  NS_ENSURE_ARG_POINTER(msgHdr);</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineplus">+  NS_ENSURE_ARG_POINTER(aMsgWindow);</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineplus">+</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineplus">+  nsresult rv;</span>
<a href="#l10.113"></a><span id="l10.113"> </span>
<a href="#l10.114"></a><span id="l10.114">   nsCOMPtr &lt;nsINntpService&gt; nntpService = do_GetService(NS_NNTPSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l10.115"></a><span id="l10.115">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.116"></a><span id="l10.116"> </span>
<a href="#l10.117"></a><span id="l10.117" class="difflineminus">-  nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr(do_QueryElementAt(messages, 0));</span>
<a href="#l10.118"></a><span id="l10.118" class="difflineminus">-</span>
<a href="#l10.119"></a><span id="l10.119">   // for cancel, we need to</span>
<a href="#l10.120"></a><span id="l10.120">   // turn &quot;newsmessage://sspitzer@news.mozilla.org/netscape.test#5428&quot;</span>
<a href="#l10.121"></a><span id="l10.121">   // into &quot;news://sspitzer@news.mozilla.org/23423@netscape.com&quot;</span>
<a href="#l10.122"></a><span id="l10.122"> </span>
<a href="#l10.123"></a><span id="l10.123">   nsCOMPtr &lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l10.124"></a><span id="l10.124">   rv = GetServer(getter_AddRefs(server));</span>
<a href="#l10.125"></a><span id="l10.125">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.126"></a><span id="l10.126"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/news/src/nsNewsFolder.h</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsFolder.h</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -89,17 +89,16 @@ public:</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5">   NS_IMETHOD DeleteMessages(nsIArray *messages,</span>
<a href="#l11.6"></a><span id="l11.6">                       nsIMsgWindow *msgWindow, PRBool deleteStorage, PRBool isMove,</span>
<a href="#l11.7"></a><span id="l11.7">                       nsIMsgCopyServiceListener* listener, PRBool allowUndo);</span>
<a href="#l11.8"></a><span id="l11.8">   NS_IMETHOD GetNewMessages(nsIMsgWindow *aWindow, nsIUrlListener *aListener);</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10">   NS_IMETHOD GetCanSubscribe(PRBool *aResult);</span>
<a href="#l11.11"></a><span id="l11.11">   NS_IMETHOD GetCanFileMessages(PRBool *aResult);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  NS_IMETHOD GetCanDeleteMessages(PRBool *aCanDeleteMessages);</span>
<a href="#l11.13"></a><span id="l11.13">   NS_IMETHOD GetCanCreateSubfolders(PRBool *aResult);</span>
<a href="#l11.14"></a><span id="l11.14">   NS_IMETHOD GetCanRename(PRBool *aResult);</span>
<a href="#l11.15"></a><span id="l11.15">   NS_IMETHOD GetCanCompact(PRBool *aResult);</span>
<a href="#l11.16"></a><span id="l11.16">   NS_IMETHOD OnReadChanged(nsIDBChangeListener * aInstigator);</span>
<a href="#l11.17"></a><span id="l11.17"> </span>
<a href="#l11.18"></a><span id="l11.18">   NS_IMETHOD DownloadMessagesForOffline(nsIArray *messages, nsIMsgWindow *window);</span>
<a href="#l11.19"></a><span id="l11.19">   NS_IMETHOD Compact(nsIUrlListener *aListener, nsIMsgWindow *aMsgWindow);</span>
<a href="#l11.20"></a><span id="l11.20">   NS_IMETHOD DownloadAllForOffline(nsIUrlListener *listener, nsIMsgWindow *msgWindow);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/messenger.dtd</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/messenger.dtd</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -121,18 +121,16 @@</span>
<a href="#l12.4"></a><span id="l12.4"> &lt;!ENTITY undeleteMsgCmd.label &quot;Undelete Message&quot;&gt;</span>
<a href="#l12.5"></a><span id="l12.5"> &lt;!ENTITY undeleteMsgCmd.accesskey &quot;d&quot;&gt;</span>
<a href="#l12.6"></a><span id="l12.6"> &lt;!ENTITY cancelNewsMsgCmd.label &quot;Cancel Message&quot;&gt;</span>
<a href="#l12.7"></a><span id="l12.7"> &lt;!ENTITY cancelNewsMsgCmd.accesskey &quot;n&quot;&gt;</span>
<a href="#l12.8"></a><span id="l12.8"> &lt;!ENTITY deleteMsgsCmd.label &quot;Delete Selected Messages&quot;&gt;</span>
<a href="#l12.9"></a><span id="l12.9"> &lt;!ENTITY deleteMsgsCmd.accesskey &quot;D&quot;&gt;</span>
<a href="#l12.10"></a><span id="l12.10"> &lt;!ENTITY undeleteMsgsCmd.label &quot;Undelete Selected Messages&quot;&gt;</span>
<a href="#l12.11"></a><span id="l12.11"> &lt;!ENTITY undeleteMsgsCmd.accesskey &quot;d&quot;&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-&lt;!ENTITY cancelNewsMsgsCmd.label &quot;Cancel Selected Messages&quot;&gt;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-&lt;!ENTITY cancelNewsMsgsCmd.accesskey &quot;n&quot;&gt;</span>
<a href="#l12.14"></a><span id="l12.14"> &lt;!ENTITY deleteFolderCmd.label &quot;Delete Folder&quot;&gt;</span>
<a href="#l12.15"></a><span id="l12.15"> &lt;!ENTITY deleteFolderCmd.accesskey &quot;D&quot;&gt;</span>
<a href="#l12.16"></a><span id="l12.16"> &lt;!ENTITY unsubscribeNewsgroupCmd.label &quot;Unsubscribe&quot;&gt;</span>
<a href="#l12.17"></a><span id="l12.17"> &lt;!ENTITY unsubscribeNewsgroupCmd.accesskey &quot;n&quot;&gt;</span>
<a href="#l12.18"></a><span id="l12.18"> &lt;!ENTITY selectMenu.label &quot;Select&quot;&gt;</span>
<a href="#l12.19"></a><span id="l12.19"> &lt;!ENTITY selectMenu.accesskey &quot;S&quot;&gt;</span>
<a href="#l12.20"></a><span id="l12.20"> &lt;!ENTITY selectThreadCmd.label &quot;Thread&quot;&gt;</span>
<a href="#l12.21"></a><span id="l12.21"> &lt;!ENTITY selectThreadCmd.accesskey &quot;T&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/news.properties</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/news.properties</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -62,18 +62,16 @@ newNewsgroupHeaders=Downloading %1$S of </span>
<a href="#l13.4"></a><span id="l13.4"> # header being filtered on, %2$S is the number of the current header being</span>
<a href="#l13.5"></a><span id="l13.5"> # downloaded, %3$S is the number of headers to be downloaded, and %4$S is the</span>
<a href="#l13.6"></a><span id="l13.6"> # newsgroup whose headers are being downloaded.</span>
<a href="#l13.7"></a><span id="l13.7"> newNewsgroupFilteringHeaders=Getting headers for filters: %1$S (%2$S/%3$S) on %4$S</span>
<a href="#l13.8"></a><span id="l13.8"> downloadingArticles=Downloading articles %S-%S</span>
<a href="#l13.9"></a><span id="l13.9"> bytesReceived=Downloading newsgroups: %S received (%SKB read at %SKB/sec)</span>
<a href="#l13.10"></a><span id="l13.10"> downloadingArticlesForOffline=Downloading articles %S-%S in %S</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-onlyCancelOneMessage=You can only cancel one article at a time.</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-</span>
<a href="#l13.14"></a><span id="l13.14"> # LOCALIZATION NOTE (autoUnsubscribeText): %1$S is the newsgroup and %2$S is the newsgroup-server it is being removed from.</span>
<a href="#l13.15"></a><span id="l13.15"> autoUnsubscribeText=The newsgroup %1$S does not appear to exist on the host %2$S.  Would you like to unsubscribe from it?</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17"> # LOCALIZATION NOTE (autoSubscribeText): %1$S is the newsgroup.</span>
<a href="#l13.18"></a><span id="l13.18"> autoSubscribeText=Would you like to subscribe to %1$S?</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20"> # LOCALIZATION NOTE (Error -304): In the following item, don't translate &quot;NNTP&quot;</span>
<a href="#l13.21"></a><span id="l13.21"> # Error - server error</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/suite/mailnews/mail3PaneWindowCommands.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/suite/mailnews/mail3PaneWindowCommands.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -241,16 +241,17 @@ var DefaultController =</span>
<a href="#l14.4"></a><span id="l14.4">       case &quot;cmd_downloadFlagged&quot;:</span>
<a href="#l14.5"></a><span id="l14.5">       case &quot;cmd_downloadSelected&quot;:</span>
<a href="#l14.6"></a><span id="l14.6">       case &quot;cmd_synchronizeOffline&quot;:</span>
<a href="#l14.7"></a><span id="l14.7">         return(CheckOnline());</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">       case &quot;cmd_watchThread&quot;:</span>
<a href="#l14.10"></a><span id="l14.10">       case &quot;cmd_killThread&quot;:</span>
<a href="#l14.11"></a><span id="l14.11">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+      case &quot;cmd_cancel&quot;:</span>
<a href="#l14.13"></a><span id="l14.13">         return(isNewsURI(GetFirstSelectedMessage()));</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> 			default:</span>
<a href="#l14.16"></a><span id="l14.16"> 				return false;</span>
<a href="#l14.17"></a><span id="l14.17"> 		}</span>
<a href="#l14.18"></a><span id="l14.18"> 	},</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20">   isCommandEnabled: function(command)</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineat">@@ -270,16 +271,19 @@ var DefaultController =</span>
<a href="#l14.22"></a><span id="l14.22">         if (gDBView)</span>
<a href="#l14.23"></a><span id="l14.23">           gDBView.getCommandStatus(nsMsgViewCommandType.deleteMsg, enabled, checkStatus);</span>
<a href="#l14.24"></a><span id="l14.24">         return enabled.value;</span>
<a href="#l14.25"></a><span id="l14.25">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l14.26"></a><span id="l14.26">       case &quot;button_shiftDelete&quot;:</span>
<a href="#l14.27"></a><span id="l14.27">         if (gDBView)</span>
<a href="#l14.28"></a><span id="l14.28">           gDBView.getCommandStatus(nsMsgViewCommandType.deleteNoTrash, enabled, checkStatus);</span>
<a href="#l14.29"></a><span id="l14.29">         return enabled.value;</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+      case &quot;cmd_cancel&quot;:</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+        return GetNumSelectedMessages() == 1 &amp;&amp;</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+               gFolderDisplay.selectedMessageIsNews;</span>
<a href="#l14.33"></a><span id="l14.33">       case &quot;button_junk&quot;:</span>
<a href="#l14.34"></a><span id="l14.34">         UpdateJunkToolbarButton();</span>
<a href="#l14.35"></a><span id="l14.35">         if (gDBView)</span>
<a href="#l14.36"></a><span id="l14.36">           gDBView.getCommandStatus(nsMsgViewCommandType.junk, enabled, checkStatus);</span>
<a href="#l14.37"></a><span id="l14.37">         return enabled.value;</span>
<a href="#l14.38"></a><span id="l14.38">       case &quot;cmd_killThread&quot;:</span>
<a href="#l14.39"></a><span id="l14.39">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l14.40"></a><span id="l14.40">         return GetNumSelectedMessages() &gt; 0;</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -552,16 +556,21 @@ var DefaultController =</span>
<a href="#l14.42"></a><span id="l14.42">         MsgDeleteMessage(false);</span>
<a href="#l14.43"></a><span id="l14.43">         UpdateDeleteToolbarButton(false);</span>
<a href="#l14.44"></a><span id="l14.44">         break;</span>
<a href="#l14.45"></a><span id="l14.45">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l14.46"></a><span id="l14.46">       case &quot;button_shiftDelete&quot;:</span>
<a href="#l14.47"></a><span id="l14.47">         MsgDeleteMessage(true);</span>
<a href="#l14.48"></a><span id="l14.48">         UpdateDeleteToolbarButton(false);</span>
<a href="#l14.49"></a><span id="l14.49">         break;</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+      case &quot;cmd_cancel&quot;:</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+        let message = gFolderDisplay.selectedMessage;</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+        message.folder.QueryInterface(Components.interfaces.nsIMsgNewsFolder)</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+                      .cancelMessage(message, msgWindow);</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+        break;</span>
<a href="#l14.55"></a><span id="l14.55">       case &quot;cmd_killThread&quot;:</span>
<a href="#l14.56"></a><span id="l14.56">         /* kill thread kills the thread and then does a next unread */</span>
<a href="#l14.57"></a><span id="l14.57">       	GoNextMessage(nsMsgNavigationType.toggleThreadKilled, true);</span>
<a href="#l14.58"></a><span id="l14.58">         break;</span>
<a href="#l14.59"></a><span id="l14.59">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l14.60"></a><span id="l14.60">         GoNextMessage(nsMsgNavigationType.toggleSubthreadKilled, true);</span>
<a href="#l14.61"></a><span id="l14.61">         break;</span>
<a href="#l14.62"></a><span id="l14.62">       case &quot;cmd_watchThread&quot;:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/suite/mailnews/mailWindowOverlay.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/suite/mailnews/mailWindowOverlay.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -384,16 +384,20 @@ function InitMessageMenu()</span>
<a href="#l15.4"></a><span id="l15.4">   var killSubthreadMenuItem = document.getElementById(&quot;killSubthread&quot;);</span>
<a href="#l15.5"></a><span id="l15.5">   if (killSubthreadMenuItem) {</span>
<a href="#l15.6"></a><span id="l15.6">       killSubthreadMenuItem.setAttribute(&quot;hidden&quot;, isNews ? &quot;&quot; : &quot;true&quot;);</span>
<a href="#l15.7"></a><span id="l15.7">   }</span>
<a href="#l15.8"></a><span id="l15.8">   var watchThreadMenuItem = document.getElementById(&quot;watchThread&quot;);</span>
<a href="#l15.9"></a><span id="l15.9">   if (watchThreadMenuItem) {</span>
<a href="#l15.10"></a><span id="l15.10">       watchThreadMenuItem.setAttribute(&quot;hidden&quot;, isNews ? &quot;&quot; : &quot;true&quot;);</span>
<a href="#l15.11"></a><span id="l15.11">   }</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+  var cancelMenuItem = document.getElementById(&quot;menu_cancel&quot;);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  if (cancelMenuItem) {</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+      cancelMenuItem.setAttribute(&quot;hidden&quot;, isNews ? &quot;&quot; : &quot;true&quot;);</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+  }</span>
<a href="#l15.16"></a><span id="l15.16"> </span>
<a href="#l15.17"></a><span id="l15.17">   // Disable the Move and Copy menus if there are no messages selected.</span>
<a href="#l15.18"></a><span id="l15.18">   // Disable the Move menu if we can't delete messages from the folder.</span>
<a href="#l15.19"></a><span id="l15.19">   var moveMenu = document.getElementById(&quot;moveMenu&quot;);</span>
<a href="#l15.20"></a><span id="l15.20">   var msgFolder = GetLoadedMsgFolder();</span>
<a href="#l15.21"></a><span id="l15.21">   if(moveMenu)</span>
<a href="#l15.22"></a><span id="l15.22">   {</span>
<a href="#l15.23"></a><span id="l15.23">       var enableMenuItem = aMessage &amp;&amp; msgFolder &amp;&amp; msgFolder.canDeleteMessages;</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineat">@@ -869,19 +873,17 @@ function UpdateDeleteToolbarButton(aFold</span>
<a href="#l15.25"></a><span id="l15.25">   // Wallpaper over Bug 491676 by using the attribute instead of the property.</span>
<a href="#l15.26"></a><span id="l15.26">   deleteButtonDeck.setAttribute(&quot;selectedIndex&quot;, selectedIndex);</span>
<a href="#l15.27"></a><span id="l15.27"> }</span>
<a href="#l15.28"></a><span id="l15.28"> </span>
<a href="#l15.29"></a><span id="l15.29"> function UpdateDeleteCommand()</span>
<a href="#l15.30"></a><span id="l15.30"> {</span>
<a href="#l15.31"></a><span id="l15.31">   var value = &quot;value&quot;;</span>
<a href="#l15.32"></a><span id="l15.32">   var uri = GetFirstSelectedMessage();</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-  if (IsNewsMessage(uri))</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineminus">-    value += &quot;News&quot;;</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineminus">-  else if (SelectedMessagesAreDeleted())</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+  if (SelectedMessagesAreDeleted())</span>
<a href="#l15.37"></a><span id="l15.37">     value += &quot;IMAPDeleted&quot;;</span>
<a href="#l15.38"></a><span id="l15.38">   if (GetNumSelectedMessages() &lt; 2)</span>
<a href="#l15.39"></a><span id="l15.39">     value += &quot;Message&quot;;</span>
<a href="#l15.40"></a><span id="l15.40">   else</span>
<a href="#l15.41"></a><span id="l15.41">     value += &quot;Messages&quot;;</span>
<a href="#l15.42"></a><span id="l15.42">   goSetMenuValue(&quot;cmd_delete&quot;, value);</span>
<a href="#l15.43"></a><span id="l15.43">   goSetAccessKey(&quot;cmd_delete&quot;, value + &quot;AccessKey&quot;);</span>
<a href="#l15.44"></a><span id="l15.44"> }</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineat">@@ -1080,24 +1082,18 @@ function MsgCopyMessage(destFolder)</span>
<a href="#l15.46"></a><span id="l15.46"> }</span>
<a href="#l15.47"></a><span id="l15.47"> </span>
<a href="#l15.48"></a><span id="l15.48"> function MsgMoveMessage(destFolder)</span>
<a href="#l15.49"></a><span id="l15.49"> {</span>
<a href="#l15.50"></a><span id="l15.50">   try {</span>
<a href="#l15.51"></a><span id="l15.51">     // get the msg folder we're moving messages into</span>
<a href="#l15.52"></a><span id="l15.52">     var destUri = destFolder.getAttribute('id');</span>
<a href="#l15.53"></a><span id="l15.53">     let destMsgFolder = GetMsgFolderFromUri(destUri);</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineminus">-    // we don't move news messages, we copy them</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineminus">-    if (isNewsURI(gDBView.msgFolder.URI)) {</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineminus">-      gDBView.doCommandWithFolder(nsMsgViewCommandType.copyMessages, destMsgFolder);</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineminus">-    }</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineminus">-    else {</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineminus">-      SetNextMessageAfterDelete();</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineminus">-      gDBView.doCommandWithFolder(nsMsgViewCommandType.moveMessages, destMsgFolder);</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineminus">-    }</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+    SetNextMessageAfterDelete();</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+    gDBView.doCommandWithFolder(nsMsgViewCommandType.moveMessages, destMsgFolder);</span>
<a href="#l15.64"></a><span id="l15.64">   }</span>
<a href="#l15.65"></a><span id="l15.65">   catch (ex) {</span>
<a href="#l15.66"></a><span id="l15.66">     dump(&quot;MsgMoveMessage failed: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l15.67"></a><span id="l15.67">   }</span>
<a href="#l15.68"></a><span id="l15.68"> }</span>
<a href="#l15.69"></a><span id="l15.69"> </span>
<a href="#l15.70"></a><span id="l15.70"> /**</span>
<a href="#l15.71"></a><span id="l15.71">  * Calls the ComposeMessage function with the desired type and proper default</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/suite/mailnews/mailWindowOverlay.xul</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/suite/mailnews/mailWindowOverlay.xul</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -194,24 +194,20 @@</span>
<a href="#l16.4"></a><span id="l16.4">          valueFolder=&quot;&amp;deleteFolderCmd.label;&quot;</span>
<a href="#l16.5"></a><span id="l16.5">          valueFolderAccessKey=&quot;&amp;deleteFolderCmd.accesskey;&quot;</span>
<a href="#l16.6"></a><span id="l16.6">          valueNewsgroup=&quot;&amp;unsubscribeNewsgroupCmd.label;&quot;</span>
<a href="#l16.7"></a><span id="l16.7">          valueNewsgroupAccessKey=&quot;&amp;unsubscribeNewsgroupCmd.accesskey;&quot;</span>
<a href="#l16.8"></a><span id="l16.8">          valueMessage=&quot;&amp;deleteMsgCmd.label;&quot;</span>
<a href="#l16.9"></a><span id="l16.9">          valueMessageAccessKey=&quot;&amp;deleteMsgCmd.accesskey;&quot;</span>
<a href="#l16.10"></a><span id="l16.10">          valueIMAPDeletedMessage=&quot;&amp;undeleteMsgCmd.label;&quot;</span>
<a href="#l16.11"></a><span id="l16.11">          valueIMAPDeletedMessageAccessKey=&quot;&amp;undeleteMsgCmd.accesskey;&quot;</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-         valueNewsMessage=&quot;&amp;cancelNewsMsgCmd.label;&quot;</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-         valueNewsMessageAccessKey=&quot;&amp;cancelNewsMsgCmd.accesskey;&quot;</span>
<a href="#l16.14"></a><span id="l16.14">          valueMessages=&quot;&amp;deleteMsgsCmd.label;&quot;</span>
<a href="#l16.15"></a><span id="l16.15">          valueMessagesAccessKey=&quot;&amp;deleteMsgsCmd.accesskey;&quot;</span>
<a href="#l16.16"></a><span id="l16.16">          valueIMAPDeletedMessages=&quot;&amp;undeleteMsgsCmd.label;&quot;</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineminus">-         valueIMAPDeletedMessagesAccessKey=&quot;&amp;undeleteMsgsCmd.accesskey;&quot;</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineminus">-         valueNewsMessages=&quot;&amp;cancelNewsMsgsCmd.label;&quot;</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-         valueNewsMessagesAccessKey=&quot;&amp;cancelNewsMsgsCmd.accesskey;&quot;/&gt;</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+         valueIMAPDeletedMessagesAccessKey=&quot;&amp;undeleteMsgsCmd.accesskey;&quot;/&gt;</span>
<a href="#l16.21"></a><span id="l16.21">   &lt;command id=&quot;cmd_selectAll&quot;/&gt;</span>
<a href="#l16.22"></a><span id="l16.22">   &lt;command id=&quot;cmd_selectThread&quot; oncommand=&quot;goDoCommand('cmd_selectThread')&quot;/&gt;</span>
<a href="#l16.23"></a><span id="l16.23">   &lt;command id=&quot;cmd_selectFlagged&quot; oncommand=&quot;goDoCommand('cmd_selectFlagged')&quot;/&gt;</span>
<a href="#l16.24"></a><span id="l16.24">   &lt;command id=&quot;cmd_properties&quot; oncommand=&quot;goDoCommand('cmd_properties')&quot;</span>
<a href="#l16.25"></a><span id="l16.25">          valueNewsgroup=&quot;&amp;folderPropsNewsgroupCmd.label;&quot;</span>
<a href="#l16.26"></a><span id="l16.26">          valueFolder=&quot;&amp;folderPropsFolderCmd.label;&quot;</span>
<a href="#l16.27"></a><span id="l16.27">          valueGeneric=&quot;&amp;folderPropsCmd.label;&quot;/&gt;</span>
<a href="#l16.28"></a><span id="l16.28">   &lt;command id=&quot;cmd_find&quot; oncommand=&quot;goDoCommand('cmd_find')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineat">@@ -256,16 +252,17 @@</span>
<a href="#l16.30"></a><span id="l16.30">   &lt;command id=&quot;cmd_replySenderAndGroup&quot; oncommand=&quot;goDoCommand('cmd_replySenderAndGroup')&quot;/&gt;</span>
<a href="#l16.31"></a><span id="l16.31">   &lt;command id=&quot;cmd_replyAllRecipients&quot; oncommand=&quot;goDoCommand('cmd_replyAllRecipients')&quot;/&gt;</span>
<a href="#l16.32"></a><span id="l16.32">   &lt;command id=&quot;cmd_forward&quot; oncommand=&quot;goDoCommand('cmd_forward')&quot;/&gt;</span>
<a href="#l16.33"></a><span id="l16.33">   &lt;command id=&quot;cmd_forwardInline&quot; oncommand=&quot;goDoCommand('cmd_forwardInline')&quot;/&gt;</span>
<a href="#l16.34"></a><span id="l16.34">   &lt;command id=&quot;cmd_forwardAttachment&quot; oncommand=&quot;goDoCommand('cmd_forwardAttachment')&quot;/&gt;</span>
<a href="#l16.35"></a><span id="l16.35">   &lt;command id=&quot;cmd_editAsNew&quot; oncommand=&quot;goDoCommand('cmd_editAsNew')&quot;/&gt;</span>
<a href="#l16.36"></a><span id="l16.36">   &lt;command id=&quot;cmd_openMessage&quot; oncommand=&quot;goDoCommand('cmd_openMessage')&quot;/&gt;</span>
<a href="#l16.37"></a><span id="l16.37">   &lt;command id=&quot;cmd_createFilterFromMenu&quot; oncommand=&quot;goDoCommand('cmd_createFilterFromMenu')&quot;/&gt;</span>
<a href="#l16.38"></a><span id="l16.38" class="difflineplus">+  &lt;command id=&quot;cmd_cancel&quot; oncommand=&quot;goDoCommand('cmd_cancel')&quot;/&gt;</span>
<a href="#l16.39"></a><span id="l16.39">   &lt;command id=&quot;cmd_killThread&quot; oncommand=&quot;goDoCommand('cmd_killThread')&quot;/&gt;</span>
<a href="#l16.40"></a><span id="l16.40">   &lt;command id=&quot;cmd_killSubthread&quot; oncommand=&quot;goDoCommand('cmd_killSubthread')&quot;/&gt;</span>
<a href="#l16.41"></a><span id="l16.41">   &lt;command id=&quot;cmd_watchThread&quot; oncommand=&quot;goDoCommand('cmd_watchThread')&quot;/&gt;</span>
<a href="#l16.42"></a><span id="l16.42"> &lt;/commandset&gt;</span>
<a href="#l16.43"></a><span id="l16.43"> </span>
<a href="#l16.44"></a><span id="l16.44"> &lt;commandset id=&quot;mailToolbarItems&quot;</span>
<a href="#l16.45"></a><span id="l16.45">             commandupdater=&quot;true&quot;</span>
<a href="#l16.46"></a><span id="l16.46">             events=&quot;mail-toolbar&quot;</span>
<a href="#l16.47"></a><span id="l16.47" class="difflineat">@@ -1859,16 +1856,20 @@</span>
<a href="#l16.48"></a><span id="l16.48">       &lt;/menupopup&gt;</span>
<a href="#l16.49"></a><span id="l16.49">     &lt;/menu&gt;</span>
<a href="#l16.50"></a><span id="l16.50">     &lt;menuseparator id=&quot;messageMenuAfterMarkSeparator&quot;/&gt;</span>
<a href="#l16.51"></a><span id="l16.51">     &lt;menuitem id=&quot;createFilter&quot;</span>
<a href="#l16.52"></a><span id="l16.52">               label=&quot;&amp;createFilter.label;&quot;</span>
<a href="#l16.53"></a><span id="l16.53">               accesskey=&quot;&amp;createFilter.accesskey;&quot;</span>
<a href="#l16.54"></a><span id="l16.54">               command=&quot;cmd_createFilterFromMenu&quot;/&gt;</span>
<a href="#l16.55"></a><span id="l16.55">     &lt;menuseparator id=&quot;threadItemsSeparator&quot;/&gt;</span>
<a href="#l16.56"></a><span id="l16.56" class="difflineplus">+    &lt;menuitem id=&quot;menu_cancel&quot;</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineplus">+              label=&quot;&amp;cancelNewsMsgCmd.label;&quot;</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineplus">+              accesskey=&quot;&amp;cancelNewsMsgCmd.accesskey;&quot;</span>
<a href="#l16.59"></a><span id="l16.59" class="difflineplus">+              command=&quot;cmd_cancel&quot;/&gt;</span>
<a href="#l16.60"></a><span id="l16.60">     &lt;menuitem id=&quot;killThread&quot;</span>
<a href="#l16.61"></a><span id="l16.61">               label=&quot;&amp;killThreadMenu.label;&quot;</span>
<a href="#l16.62"></a><span id="l16.62">               accesskey=&quot;&amp;killThreadMenu.accesskey;&quot;</span>
<a href="#l16.63"></a><span id="l16.63">               key=&quot;key_killThread&quot; command=&quot;cmd_killThread&quot;/&gt;</span>
<a href="#l16.64"></a><span id="l16.64">     &lt;menuitem id=&quot;killSubthread&quot;</span>
<a href="#l16.65"></a><span id="l16.65">               label=&quot;&amp;killSubthreadMenu.label;&quot;</span>
<a href="#l16.66"></a><span id="l16.66">               accesskey=&quot;&amp;killSubthreadMenu.accesskey;&quot;</span>
<a href="#l16.67"></a><span id="l16.67">               key=&quot;key_killSubthread&quot; command=&quot;cmd_killSubthread&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/suite/mailnews/messageWindow.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/suite/mailnews/messageWindow.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -711,17 +711,17 @@ var MessageWindowController =</span>
<a href="#l17.4"></a><span id="l17.4">         // fall through</span>
<a href="#l17.5"></a><span id="l17.5">       case &quot;button_delete&quot;:</span>
<a href="#l17.6"></a><span id="l17.6">         if (command == &quot;button_delete&quot;)</span>
<a href="#l17.7"></a><span id="l17.7">           UpdateDeleteToolbarButton(false);</span>
<a href="#l17.8"></a><span id="l17.8">         // fall through</span>
<a href="#l17.9"></a><span id="l17.9">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l17.10"></a><span id="l17.10">       case &quot;button_shiftDelete&quot;:</span>
<a href="#l17.11"></a><span id="l17.11">         loadedFolder = GetLoadedMsgFolder();</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-        return gCurrentMessageUri &amp;&amp; loadedFolder &amp;&amp; (loadedFolder.canDeleteMessages || isNewsURI(gCurrentFolderUri));</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+        return gCurrentMessageUri &amp;&amp; loadedFolder &amp;&amp; loadedFolder.canDeleteMessages;</span>
<a href="#l17.14"></a><span id="l17.14">       case &quot;button_junk&quot;:</span>
<a href="#l17.15"></a><span id="l17.15">         UpdateJunkToolbarButton();</span>
<a href="#l17.16"></a><span id="l17.16">         // fall through</span>
<a href="#l17.17"></a><span id="l17.17">       case &quot;cmd_markAsJunk&quot;:</span>
<a href="#l17.18"></a><span id="l17.18"> 			case &quot;cmd_markAsNotJunk&quot;:</span>
<a href="#l17.19"></a><span id="l17.19">         if (gDBView)</span>
<a href="#l17.20"></a><span id="l17.20">           gDBView.getCommandStatus(nsMsgViewCommandType.junk, enabled, checkStatus);</span>
<a href="#l17.21"></a><span id="l17.21">         return enabled.value;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/suite/mailnews/search/SearchDialog.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/suite/mailnews/search/SearchDialog.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -94,17 +94,17 @@ var nsSearchResultsController =</span>
<a href="#l18.4"></a><span id="l18.4">           case &quot;goto_folder_button&quot;:</span>
<a href="#l18.5"></a><span id="l18.5">             if (GetNumSelectedMessages() != 1)</span>
<a href="#l18.6"></a><span id="l18.6">               enabled = false;</span>
<a href="#l18.7"></a><span id="l18.7">             break;</span>
<a href="#l18.8"></a><span id="l18.8">           case &quot;cmd_delete&quot;:</span>
<a href="#l18.9"></a><span id="l18.9">           case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l18.10"></a><span id="l18.10">           case &quot;button_delete&quot;:</span>
<a href="#l18.11"></a><span id="l18.11">             // this assumes that advanced searches don't cross accounts</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-            if (GetNumSelectedMessages() &lt;= 0 || isNewsURI(gSearchView.getURIForViewIndex(0)))</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+            if (GetNumSelectedMessages() &lt;= 0)</span>
<a href="#l18.14"></a><span id="l18.14">               enabled = false;</span>
<a href="#l18.15"></a><span id="l18.15">             break;</span>
<a href="#l18.16"></a><span id="l18.16">           case &quot;saveas_vf_button&quot;:</span>
<a href="#l18.17"></a><span id="l18.17">               // need someway to see if there are any search criteria...</span>
<a href="#l18.18"></a><span id="l18.18">               return true;</span>
<a href="#l18.19"></a><span id="l18.19">           case &quot;cmd_selectAll&quot;:</span>
<a href="#l18.20"></a><span id="l18.20">             return GetDBView() != null;              </span>
<a href="#l18.21"></a><span id="l18.21">           default:</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineat">@@ -607,21 +607,16 @@ function GetNumSelectedMessages()</span>
<a href="#l18.23"></a><span id="l18.23"> </span>
<a href="#l18.24"></a><span id="l18.24"> function GetDBView()</span>
<a href="#l18.25"></a><span id="l18.25"> {</span>
<a href="#l18.26"></a><span id="l18.26">     return gSearchView;</span>
<a href="#l18.27"></a><span id="l18.27"> }</span>
<a href="#l18.28"></a><span id="l18.28"> </span>
<a href="#l18.29"></a><span id="l18.29"> function MsgDeleteSelectedMessages(aCommandType)</span>
<a href="#l18.30"></a><span id="l18.30"> {</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineminus">-    // we don't delete news messages, we just return in that case</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineminus">-    if (isNewsURI(gSearchView.getURIForViewIndex(0))) </span>
<a href="#l18.33"></a><span id="l18.33" class="difflineminus">-        return;</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineminus">-    // if mail messages delete</span>
<a href="#l18.36"></a><span id="l18.36">     SetNextMessageAfterDelete();</span>
<a href="#l18.37"></a><span id="l18.37">     gSearchView.doCommand(aCommandType);</span>
<a href="#l18.38"></a><span id="l18.38"> }</span>
<a href="#l18.39"></a><span id="l18.39"> </span>
<a href="#l18.40"></a><span id="l18.40"> function SetNextMessageAfterDelete()</span>
<a href="#l18.41"></a><span id="l18.41"> {</span>
<a href="#l18.42"></a><span id="l18.42">   gNextMessageViewIndexAfterDelete = gSearchView.msgToSelectAfterDelete;</span>
<a href="#l18.43"></a><span id="l18.43"> }</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineat">@@ -736,24 +731,18 @@ function MoveMessageInSearch(destFolder)</span>
<a href="#l18.45"></a><span id="l18.45">         // &quot;File Here&quot;</span>
<a href="#l18.46"></a><span id="l18.46">         var destUri = destFolder.getAttribute('id');</span>
<a href="#l18.47"></a><span id="l18.47">         if (destUri.length == 0) { </span>
<a href="#l18.48"></a><span id="l18.48">           destUri = destFolder.getAttribute('file-uri')</span>
<a href="#l18.49"></a><span id="l18.49">         }</span>
<a href="#l18.50"></a><span id="l18.50"> </span>
<a href="#l18.51"></a><span id="l18.51">         var destMsgFolder = GetMsgFolderFromUri(destUri).QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l18.52"></a><span id="l18.52"> </span>
<a href="#l18.53"></a><span id="l18.53" class="difflineminus">-        // we don't move news messages, we copy them</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineminus">-        if (isNewsURI(gSearchView.getURIForViewIndex(0))) {</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineminus">-          gSearchView.doCommandWithFolder(nsMsgViewCommandType.copyMessages, destMsgFolder);</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineminus">-        }</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineminus">-        else {</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineminus">-            SetNextMessageAfterDelete();</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineminus">-            gSearchView.doCommandWithFolder(nsMsgViewCommandType.moveMessages, destMsgFolder);</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineminus">-        } </span>
<a href="#l18.61"></a><span id="l18.61" class="difflineplus">+        SetNextMessageAfterDelete();</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+        gSearchView.doCommandWithFolder(nsMsgViewCommandType.moveMessages, destMsgFolder);</span>
<a href="#l18.63"></a><span id="l18.63">     }</span>
<a href="#l18.64"></a><span id="l18.64">     catch (ex) {</span>
<a href="#l18.65"></a><span id="l18.65">         dump(&quot;MsgMoveMessage failed: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l18.66"></a><span id="l18.66">     }   </span>
<a href="#l18.67"></a><span id="l18.67"> }</span>
<a href="#l18.68"></a><span id="l18.68"> </span>
<a href="#l18.69"></a><span id="l18.69"> function GoToFolder()</span>
<a href="#l18.70"></a><span id="l18.70"> {</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

