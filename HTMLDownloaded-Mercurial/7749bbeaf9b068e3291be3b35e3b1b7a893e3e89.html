<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 22335:7749bbeaf9b068e3291be3b35e3b1b7a893e3e89</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 7749bbeaf9b068e3291be3b35e3b1b7a893e3e89" />
<meta property="og:url" content="/comm-central/rev/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89" />
<meta property="og:description" content="Bug 1408196 - Port bug 1407838 to C-C: Replace use of NS_Alloc/NS_Free. rs=bustage-fix" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 7749bbeaf9b068e3291be3b35e3b1b7a893e3e89 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">shortlog</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">files</a> |
changeset |
<a href="/comm-central/raw-rev/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">raw</a>  | <a href="/comm-central/archive/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1408196">Bug 1408196</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1407838">bug 1407838</a> to C-C: Replace use of NS_Alloc/NS_Free. rs=bustage-fix
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 13 Oct 2017 01:13:43 +0200</td></tr>

<tr>
 <td>changeset 22335</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">7749bbeaf9b068e3291be3b35e3b1b7a893e3e89</a></td>
</tr>



<tr>
<td>parent 22334</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e8fac029f7e443867fde96aa62c6a4d1057b46cf">e8fac029f7e443867fde96aa62c6a4d1057b46cf</a>
</td>
</tr>

<tr>
<td>child 22336</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/10d1c5b3288570adb3139c17d456fae16b7a0a57">10d1c5b3288570adb3139c17d456fae16b7a0a57</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">13610</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 12 Oct 2017 23:26:09 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@7749bbeaf9b0 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&newProject=comm-central&newRevision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&newProject=comm-central&newRevision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&newProject=comm-central&newRevision=7749bbeaf9b068e3291be3b35e3b1b7a893e3e89&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bustage-fix%29&revcount=50">bustage-fix</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1408196">1408196</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1407838">1407838</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1408196">Bug 1408196</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1407838">bug 1407838</a> to C-C: Replace use of NS_Alloc/NS_Free. rs=bustage-fix</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPOperation.cpp">ldap/xpcom/src/nsLDAPOperation.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPOperation.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPOperation.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPOperation.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPOperation.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPOperation.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPService.cpp">ldap/xpcom/src/nsLDAPService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPService.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPService.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPService.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPService.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/ldap/xpcom/src/nsLDAPService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsMailProfileMigratorUtils.cpp">mail/components/migration/src/nsMailProfileMigratorUtils.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsMailProfileMigratorUtils.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsMailProfileMigratorUtils.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsMailProfileMigratorUtils.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsMailProfileMigratorUtils.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsMailProfileMigratorUtils.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp">mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">mailnews/addrbook/src/nsAbOutlookDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbWinHelper.cpp">mailnews/addrbook/src/nsAbWinHelper.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbWinHelper.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbWinHelper.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbWinHelper.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbWinHelper.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/addrbook/src/nsAbWinHelper.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchAdapter.cpp">mailnews/base/search/src/nsMsgSearchAdapter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchAdapter.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchAdapter.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchAdapter.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchAdapter.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchAdapter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchTerm.cpp">mailnews/base/search/src/nsMsgSearchTerm.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchTerm.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchTerm.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchTerm.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchTerm.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchTerm.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchValue.cpp">mailnews/base/search/src/nsMsgSearchValue.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchValue.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchValue.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchValue.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchValue.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/search/src/nsMsgSearchValue.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessenger.cpp">mailnews/base/src/nsMessenger.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessenger.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessenger.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessenger.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessenger.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessenger.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessengerUnixIntegration.cpp">mailnews/base/src/nsMessengerUnixIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessengerUnixIntegration.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessengerUnixIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessengerUnixIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessengerUnixIntegration.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMessengerUnixIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgTagService.cpp">mailnews/base/src/nsMsgTagService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgTagService.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgTagService.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgTagService.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgTagService.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsMsgTagService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsSubscribableServer.cpp">mailnews/base/src/nsSubscribableServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsSubscribableServer.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsSubscribableServer.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsSubscribableServer.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsSubscribableServer.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/src/nsSubscribableServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/util/nsMsgDBFolder.cpp">mailnews/base/util/nsMsgDBFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/util/nsMsgDBFolder.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/util/nsMsgDBFolder.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/util/nsMsgDBFolder.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/util/nsMsgDBFolder.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/base/util/nsMsgDBFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgCompFields.cpp">mailnews/compose/src/nsMsgCompFields.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgCompFields.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgCompFields.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgCompFields.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgCompFields.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgCompFields.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgSend.cpp">mailnews/compose/src/nsMsgSend.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgSend.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgSend.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgSend.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgSend.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsMsgSend.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsSmtpProtocol.cpp">mailnews/compose/src/nsSmtpProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsSmtpProtocol.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsSmtpProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsSmtpProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsSmtpProtocol.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/compose/src/nsSmtpProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/db/msgdb/src/nsMsgDatabase.cpp">mailnews/db/msgdb/src/nsMsgDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/db/msgdb/src/nsMsgDatabase.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/db/msgdb/src/nsMsgDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/db/msgdb/src/nsMsgDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/db/msgdb/src/nsMsgDatabase.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/db/msgdb/src/nsMsgDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp">mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapProtocol.cpp">mailnews/imap/src/nsImapProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapProtocol.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapProtocol.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapServerResponseParser.cpp">mailnews/imap/src/nsImapServerResponseParser.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapServerResponseParser.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapServerResponseParser.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapServerResponseParser.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapServerResponseParser.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapServerResponseParser.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapService.cpp">mailnews/imap/src/nsImapService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapService.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapService.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapService.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapService.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapUrl.cpp">mailnews/imap/src/nsImapUrl.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapUrl.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapUrl.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapUrl.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapUrl.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/imap/src/nsImapUrl.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiApi.cpp">mailnews/import/outlook/src/MapiApi.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiApi.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiApi.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiApi.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiApi.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiApi.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiMessage.cpp">mailnews/import/outlook/src/MapiMessage.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiMessage.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiMessage.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiMessage.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiMessage.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/MapiMessage.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/nsOutlookImport.cpp">mailnews/import/outlook/src/nsOutlookImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/nsOutlookImport.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/nsOutlookImport.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/nsOutlookImport.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/nsOutlookImport.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/outlook/src/nsOutlookImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportAddressBooks.cpp">mailnews/import/src/nsImportAddressBooks.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportAddressBooks.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportAddressBooks.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportAddressBooks.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportAddressBooks.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportAddressBooks.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportFieldMap.cpp">mailnews/import/src/nsImportFieldMap.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportFieldMap.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportFieldMap.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportFieldMap.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportFieldMap.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportFieldMap.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportMail.cpp">mailnews/import/src/nsImportMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportMail.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportMail.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportMail.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportMail.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/src/nsImportMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/text/src/nsTextImport.cpp">mailnews/import/text/src/nsTextImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/text/src/nsTextImport.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/text/src/nsTextImport.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/text/src/nsTextImport.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/text/src/nsTextImport.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/text/src/nsTextImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/vcard/src/nsVCardImport.cpp">mailnews/import/vcard/src/nsVCardImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/vcard/src/nsVCardImport.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/vcard/src/nsVCardImport.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/vcard/src/nsVCardImport.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/vcard/src/nsVCardImport.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/import/vcard/src/nsVCardImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/local/src/nsMsgMaildirStore.cpp">mailnews/local/src/nsMsgMaildirStore.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/local/src/nsMsgMaildirStore.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/local/src/nsMsgMaildirStore.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/local/src/nsMsgMaildirStore.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/local/src/nsMsgMaildirStore.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/local/src/nsMsgMaildirStore.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp">mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">mailnews/mime/emitters/nsMimeBaseEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeXmlEmitter.cpp">mailnews/mime/emitters/nsMimeXmlEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeXmlEmitter.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeXmlEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeXmlEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeXmlEmitter.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/emitters/nsMimeXmlEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/mimemoz2.cpp">mailnews/mime/src/mimemoz2.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/mimemoz2.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/mimemoz2.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/mimemoz2.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/mimemoz2.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/mimemoz2.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/nsStreamConverter.cpp">mailnews/mime/src/nsStreamConverter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/nsStreamConverter.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/nsStreamConverter.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/nsStreamConverter.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/nsStreamConverter.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/mailnews/mime/src/nsStreamConverter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">file</a> |
<a href="/comm-central/annotate/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">annotate</a> |
<a href="/comm-central/diff/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">diff</a> |
<a href="/comm-central/comparison/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">comparison</a> |
<a href="/comm-central/log/7749bbeaf9b068e3291be3b35e3b1b7a893e3e89/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPOperation.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPOperation.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -447,17 +447,17 @@ nsLDAPOperation::SearchExt(const nsACStr</span>
<a href="#l1.4"></a><span id="l1.4">     // Convert our comma separated string to one that the C-SDK will like, i.e.</span>
<a href="#l1.5"></a><span id="l1.5">     // convert to a char array and add a last NULL element.</span>
<a href="#l1.6"></a><span id="l1.6">     nsTArray&lt;nsCString&gt; attrArray;</span>
<a href="#l1.7"></a><span id="l1.7">     ParseString(aAttributes, ',', attrArray);</span>
<a href="#l1.8"></a><span id="l1.8">     char **attrs = nullptr;</span>
<a href="#l1.9"></a><span id="l1.9">     uint32_t origLength = attrArray.Length();</span>
<a href="#l1.10"></a><span id="l1.10">     if (origLength)</span>
<a href="#l1.11"></a><span id="l1.11">     {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-      attrs = static_cast&lt;char **&gt; (NS_Alloc((origLength + 1) * sizeof(char *)));</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+      attrs = static_cast&lt;char **&gt; (moz_xmalloc((origLength + 1) * sizeof(char *)));</span>
<a href="#l1.14"></a><span id="l1.14">       if (!attrs)</span>
<a href="#l1.15"></a><span id="l1.15">         return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l1.16"></a><span id="l1.16"> </span>
<a href="#l1.17"></a><span id="l1.17">       for (uint32_t i = 0; i &lt; origLength; ++i)</span>
<a href="#l1.18"></a><span id="l1.18">         attrs[i] = ToNewCString(attrArray[i]);</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20">       attrs[origLength] = 0;</span>
<a href="#l1.21"></a><span id="l1.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPService.cpp</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPService.cpp</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -885,17 +885,17 @@ NS_IMETHODIMP nsLDAPService::ParseDn(con</span>
<a href="#l2.4"></a><span id="l2.4">             ++len;</span>
<a href="#l2.5"></a><span id="l2.5">         if (*p != '=') {</span>
<a href="#l2.6"></a><span id="l2.6">             NS_ERROR(&quot;nsLDAPService::parseDn: &quot;</span>
<a href="#l2.7"></a><span id="l2.7">                 &quot;could not find '=' in RDN component&quot;);</span>
<a href="#l2.8"></a><span id="l2.8">             ldap_value_free(dnComponents);</span>
<a href="#l2.9"></a><span id="l2.9">             ldap_value_free(rdnComponents);</span>
<a href="#l2.10"></a><span id="l2.10">             return NS_ERROR_UNEXPECTED;</span>
<a href="#l2.11"></a><span id="l2.11">         }</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        if (!(attrNameArray[index] = (char*)NS_Alloc(len + 1))) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        if (!(attrNameArray[index] = (char*)moz_xmalloc(len + 1))) {</span>
<a href="#l2.14"></a><span id="l2.14">             NS_ERROR(&quot;nsLDAPService::ParseDn: out of memory &quot;);</span>
<a href="#l2.15"></a><span id="l2.15">             ldap_value_free(dnComponents);</span>
<a href="#l2.16"></a><span id="l2.16">             ldap_value_free(rdnComponents);</span>
<a href="#l2.17"></a><span id="l2.17">             NS_FREE_XPCOM_ALLOCATED_POINTER_ARRAY(index, attrNameArray);</span>
<a href="#l2.18"></a><span id="l2.18">             return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l2.19"></a><span id="l2.19">         }</span>
<a href="#l2.20"></a><span id="l2.20">         memcpy(attrNameArray[index], *component, len);</span>
<a href="#l2.21"></a><span id="l2.21">         *(attrNameArray[index] + len) = '\0';</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/migration/src/nsMailProfileMigratorUtils.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/migration/src/nsMailProfileMigratorUtils.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -67,17 +67,17 @@ void GetMigrateDataFromArray(MigrationDa</span>
<a href="#l3.4"></a><span id="l3.4">     // can be imported.</span>
<a href="#l3.5"></a><span id="l3.5">     if (aReplace || !cursor-&gt;replaceOnly) {</span>
<a href="#l3.6"></a><span id="l3.6">       aSourceProfile-&gt;Clone(getter_AddRefs(sourceFile));</span>
<a href="#l3.7"></a><span id="l3.7">       sourceFile-&gt;Append(nsDependentString(cursor-&gt;fileName));</span>
<a href="#l3.8"></a><span id="l3.8">       sourceFile-&gt;Exists(&amp;exists);</span>
<a href="#l3.9"></a><span id="l3.9">       if (exists)</span>
<a href="#l3.10"></a><span id="l3.10">         *aResult |= cursor-&gt;sourceFlag;</span>
<a href="#l3.11"></a><span id="l3.11">     }</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    NS_Free(cursor-&gt;fileName);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    free(cursor-&gt;fileName);</span>
<a href="#l3.14"></a><span id="l3.14">     cursor-&gt;fileName = nullptr;</span>
<a href="#l3.15"></a><span id="l3.15">   }</span>
<a href="#l3.16"></a><span id="l3.16"> }</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18"> void</span>
<a href="#l3.19"></a><span id="l3.19"> GetProfilePath(nsIProfileStartup* aStartup, nsCOMPtr&lt;nsIFile&gt;&amp; aProfileDir)</span>
<a href="#l3.20"></a><span id="l3.20"> {</span>
<a href="#l3.21"></a><span id="l3.21">   if (aStartup) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/migration/src/nsSeamonkeyProfileMigrator.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -445,17 +445,17 @@ nsSeamonkeyProfileMigrator::CopySignatur</span>
<a href="#l4.4"></a><span id="l4.4">         srcSigFile-&gt;GetLeafName(leafName);</span>
<a href="#l4.5"></a><span id="l4.5">         srcSigFile-&gt;CopyTo(targetSigFile,leafName); // will fail if we've already copied a sig file here</span>
<a href="#l4.6"></a><span id="l4.6">         targetSigFile-&gt;Append(leafName);</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8">         // now write out the new descriptor</span>
<a href="#l4.9"></a><span id="l4.9">         nsAutoCString descriptorString;</span>
<a href="#l4.10"></a><span id="l4.10">         rv = targetSigFile-&gt;GetPersistentDescriptor(descriptorString);</span>
<a href="#l4.11"></a><span id="l4.11">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l4.14"></a><span id="l4.14">         pref-&gt;stringValue = ToNewCString(descriptorString);</span>
<a href="#l4.15"></a><span id="l4.15">       }</span>
<a href="#l4.16"></a><span id="l4.16">     }</span>
<a href="#l4.17"></a><span id="l4.17">   }</span>
<a href="#l4.18"></a><span id="l4.18">   return NS_OK;</span>
<a href="#l4.19"></a><span id="l4.19"> }</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> nsresult</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -476,17 +476,17 @@ nsSeamonkeyProfileMigrator::CopyMailFold</span>
<a href="#l4.23"></a><span id="l4.23"> </span>
<a href="#l4.24"></a><span id="l4.24">     if (StringEndsWith(prefName, NS_LITERAL_CSTRING(&quot;.directory-rel&quot;))) {</span>
<a href="#l4.25"></a><span id="l4.25">       // When the directories are modified below, we may change the .directory</span>
<a href="#l4.26"></a><span id="l4.26">       // pref. As we don't have a pref branch to modify at this stage and set</span>
<a href="#l4.27"></a><span id="l4.27">       // up the relative folders properly, we'll just remove all the</span>
<a href="#l4.28"></a><span id="l4.28">       // *.directory-rel prefs. Mailnews will cope with this, creating them</span>
<a href="#l4.29"></a><span id="l4.29">       // when it first needs them.</span>
<a href="#l4.30"></a><span id="l4.30">       if (pref-&gt;type == nsIPrefBranch::PREF_STRING)</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l4.33"></a><span id="l4.33"> </span>
<a href="#l4.34"></a><span id="l4.34">       aMailServers.RemoveElementAt(i);</span>
<a href="#l4.35"></a><span id="l4.35">       // Now decrease i and count to match the removed element</span>
<a href="#l4.36"></a><span id="l4.36">       --i;</span>
<a href="#l4.37"></a><span id="l4.37">       --count;</span>
<a href="#l4.38"></a><span id="l4.38">     }</span>
<a href="#l4.39"></a><span id="l4.39">     else if (StringEndsWith(prefName, nsDependentCString(&quot;.directory&quot;)))</span>
<a href="#l4.40"></a><span id="l4.40">     {</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineat">@@ -540,17 +540,17 @@ nsSeamonkeyProfileMigrator::CopyMailFold</span>
<a href="#l4.42"></a><span id="l4.42"> </span>
<a href="#l4.43"></a><span id="l4.43">         (void) RecursiveCopy(sourceMailFolder, targetMailFolder);</span>
<a href="#l4.44"></a><span id="l4.44">         // now we want to make sure the actual directory pref that gets</span>
<a href="#l4.45"></a><span id="l4.45">         // transformed into the new profile's pref.js has the right file</span>
<a href="#l4.46"></a><span id="l4.46">         // location.</span>
<a href="#l4.47"></a><span id="l4.47">         nsAutoCString descriptorString;</span>
<a href="#l4.48"></a><span id="l4.48">         rv = targetMailFolder-&gt;GetPersistentDescriptor(descriptorString);</span>
<a href="#l4.49"></a><span id="l4.49">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l4.52"></a><span id="l4.52">         pref-&gt;stringValue = ToNewCString(descriptorString);</span>
<a href="#l4.53"></a><span id="l4.53">       }</span>
<a href="#l4.54"></a><span id="l4.54">     }</span>
<a href="#l4.55"></a><span id="l4.55">     else if (StringEndsWith(prefName, nsDependentCString(&quot;.newsrc.file&quot;)))</span>
<a href="#l4.56"></a><span id="l4.56">     {</span>
<a href="#l4.57"></a><span id="l4.57">       // copy the news RC file into \News. this won't work if the user has different newsrc files for each account</span>
<a href="#l4.58"></a><span id="l4.58">       // I don't know what to do in that situation.</span>
<a href="#l4.59"></a><span id="l4.59"> </span>
<a href="#l4.60"></a><span id="l4.60" class="difflineat">@@ -572,17 +572,17 @@ nsSeamonkeyProfileMigrator::CopyMailFold</span>
<a href="#l4.61"></a><span id="l4.61">         srcNewsRCFile-&gt;GetLeafName(leafName);</span>
<a href="#l4.62"></a><span id="l4.62">         srcNewsRCFile-&gt;CopyTo(targetNewsRCFile,leafName); // will fail if we've already copied a newsrc file here</span>
<a href="#l4.63"></a><span id="l4.63">         targetNewsRCFile-&gt;Append(leafName);</span>
<a href="#l4.64"></a><span id="l4.64"> </span>
<a href="#l4.65"></a><span id="l4.65">         // now write out the new descriptor</span>
<a href="#l4.66"></a><span id="l4.66">         nsAutoCString descriptorString;</span>
<a href="#l4.67"></a><span id="l4.67">         rv = targetNewsRCFile-&gt;GetPersistentDescriptor(descriptorString);</span>
<a href="#l4.68"></a><span id="l4.68">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l4.71"></a><span id="l4.71">         pref-&gt;stringValue = ToNewCString(descriptorString);</span>
<a href="#l4.72"></a><span id="l4.72">       }</span>
<a href="#l4.73"></a><span id="l4.73">     }</span>
<a href="#l4.74"></a><span id="l4.74">   }</span>
<a href="#l4.75"></a><span id="l4.75"> </span>
<a href="#l4.76"></a><span id="l4.76">   return NS_OK;</span>
<a href="#l4.77"></a><span id="l4.77"> }</span>
<a href="#l4.78"></a><span id="l4.78"> </span>
<a href="#l4.79"></a><span id="l4.79" class="difflineat">@@ -686,31 +686,31 @@ nsSeamonkeyProfileMigrator::WriteBranch(</span>
<a href="#l4.80"></a><span id="l4.80">   aPrefService-&gt;GetBranch(branchName, getter_AddRefs(branch));</span>
<a href="#l4.81"></a><span id="l4.81"> </span>
<a href="#l4.82"></a><span id="l4.82">   uint32_t count = aPrefs.Length();</span>
<a href="#l4.83"></a><span id="l4.83">   for (uint32_t i = 0; i &lt; count; ++i) {</span>
<a href="#l4.84"></a><span id="l4.84">     PrefBranchStruct* pref = aPrefs.ElementAt(i);</span>
<a href="#l4.85"></a><span id="l4.85">     switch (pref-&gt;type) {</span>
<a href="#l4.86"></a><span id="l4.86">     case nsIPrefBranch::PREF_STRING:</span>
<a href="#l4.87"></a><span id="l4.87">       (void) branch-&gt;SetCharPref(pref-&gt;prefName, pref-&gt;stringValue);</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineminus">-      NS_Free(pref-&gt;stringValue);</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+      free(pref-&gt;stringValue);</span>
<a href="#l4.90"></a><span id="l4.90">       pref-&gt;stringValue = nullptr;</span>
<a href="#l4.91"></a><span id="l4.91">       break;</span>
<a href="#l4.92"></a><span id="l4.92">     case nsIPrefBranch::PREF_BOOL:</span>
<a href="#l4.93"></a><span id="l4.93">       (void) branch-&gt;SetBoolPref(pref-&gt;prefName, pref-&gt;boolValue);</span>
<a href="#l4.94"></a><span id="l4.94">       break;</span>
<a href="#l4.95"></a><span id="l4.95">     case nsIPrefBranch::PREF_INT:</span>
<a href="#l4.96"></a><span id="l4.96">       (void) branch-&gt;SetIntPref(pref-&gt;prefName, pref-&gt;intValue);</span>
<a href="#l4.97"></a><span id="l4.97">       break;</span>
<a href="#l4.98"></a><span id="l4.98">     default:</span>
<a href="#l4.99"></a><span id="l4.99">       NS_WARNING(&quot;Invalid Pref Type in &quot;</span>
<a href="#l4.100"></a><span id="l4.100">                  &quot;nsNetscapeProfileMigratorBase::WriteBranch\n&quot;);</span>
<a href="#l4.101"></a><span id="l4.101">       break;</span>
<a href="#l4.102"></a><span id="l4.102">     }</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineminus">-    NS_Free(pref-&gt;prefName);</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+    free(pref-&gt;prefName);</span>
<a href="#l4.105"></a><span id="l4.105">     pref-&gt;prefName = nullptr;</span>
<a href="#l4.106"></a><span id="l4.106">     delete pref;</span>
<a href="#l4.107"></a><span id="l4.107">     pref = nullptr;</span>
<a href="#l4.108"></a><span id="l4.108">   }</span>
<a href="#l4.109"></a><span id="l4.109">   aPrefs.Clear();</span>
<a href="#l4.110"></a><span id="l4.110"> }</span>
<a href="#l4.111"></a><span id="l4.111"> </span>
<a href="#l4.112"></a><span id="l4.112"> nsresult nsSeamonkeyProfileMigrator::DummyCopyRoutine(bool aReplace)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbOutlookDirectory.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbOutlookDirectory.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -797,38 +797,38 @@ static void DestroyRestriction(SRestrict</span>
<a href="#l5.4"></a><span id="l5.4">             }</span>
<a href="#l5.5"></a><span id="l5.5">             delete [] aRestriction.res.resAnd.lpRes ;</span>
<a href="#l5.6"></a><span id="l5.6">         }</span>
<a href="#l5.7"></a><span id="l5.7">         break ;</span>
<a href="#l5.8"></a><span id="l5.8">     case RES_COMMENT :</span>
<a href="#l5.9"></a><span id="l5.9">         break ;</span>
<a href="#l5.10"></a><span id="l5.10">     case RES_CONTENT :</span>
<a href="#l5.11"></a><span id="l5.11">         if (PROP_TYPE(aRestriction.res.resContent.ulPropTag) == PT_UNICODE) {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-            NS_Free(aRestriction.res.resContent.lpProp-&gt;Value.lpszW) ;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+            free(aRestriction.res.resContent.lpProp-&gt;Value.lpszW) ;</span>
<a href="#l5.14"></a><span id="l5.14">         }</span>
<a href="#l5.15"></a><span id="l5.15">         else if (PROP_TYPE(aRestriction.res.resContent.ulPropTag) == PT_STRING8) {</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-            NS_Free(aRestriction.res.resContent.lpProp-&gt;Value.lpszA) ;</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+            free(aRestriction.res.resContent.lpProp-&gt;Value.lpszA) ;</span>
<a href="#l5.18"></a><span id="l5.18">         }</span>
<a href="#l5.19"></a><span id="l5.19">         delete aRestriction.res.resContent.lpProp ;</span>
<a href="#l5.20"></a><span id="l5.20">         break ;</span>
<a href="#l5.21"></a><span id="l5.21">     case RES_EXIST :</span>
<a href="#l5.22"></a><span id="l5.22">         break ;</span>
<a href="#l5.23"></a><span id="l5.23">     case RES_NOT :</span>
<a href="#l5.24"></a><span id="l5.24">         DestroyRestriction(*aRestriction.res.resNot.lpRes) ;</span>
<a href="#l5.25"></a><span id="l5.25">         delete aRestriction.res.resNot.lpRes ;</span>
<a href="#l5.26"></a><span id="l5.26">         break ;</span>
<a href="#l5.27"></a><span id="l5.27">     case RES_BITMASK :</span>
<a href="#l5.28"></a><span id="l5.28">     case RES_COMPAREPROPS :</span>
<a href="#l5.29"></a><span id="l5.29">         break ;</span>
<a href="#l5.30"></a><span id="l5.30">     case RES_PROPERTY :</span>
<a href="#l5.31"></a><span id="l5.31">         if (PROP_TYPE(aRestriction.res.resProperty.ulPropTag) == PT_UNICODE) {</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-            NS_Free(aRestriction.res.resProperty.lpProp-&gt;Value.lpszW) ;</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+            free(aRestriction.res.resProperty.lpProp-&gt;Value.lpszW) ;</span>
<a href="#l5.34"></a><span id="l5.34">         }</span>
<a href="#l5.35"></a><span id="l5.35">         else if (PROP_TYPE(aRestriction.res.resProperty.ulPropTag) == PT_STRING8) {</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-            NS_Free(aRestriction.res.resProperty.lpProp-&gt;Value.lpszA) ;</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+            free(aRestriction.res.resProperty.lpProp-&gt;Value.lpszA) ;</span>
<a href="#l5.38"></a><span id="l5.38">         }</span>
<a href="#l5.39"></a><span id="l5.39">         delete aRestriction.res.resProperty.lpProp ;</span>
<a href="#l5.40"></a><span id="l5.40">     case RES_SIZE :</span>
<a href="#l5.41"></a><span id="l5.41">     case RES_SUBRESTRICTION :</span>
<a href="#l5.42"></a><span id="l5.42">         break ;</span>
<a href="#l5.43"></a><span id="l5.43">     }</span>
<a href="#l5.44"></a><span id="l5.44"> }</span>
<a href="#l5.45"></a><span id="l5.45"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbWinHelper.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbWinHelper.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -554,17 +554,17 @@ BOOL nsAbWinHelper::SetPropertiesUString</span>
<a href="#l6.4"></a><span id="l6.4">             }</span>
<a href="#l6.5"></a><span id="l6.5">             values [currentValue ++].Value.lpszA = av ;</span>
<a href="#l6.6"></a><span id="l6.6">         }</span>
<a href="#l6.7"></a><span id="l6.7">     }</span>
<a href="#l6.8"></a><span id="l6.8">     if (retCode)</span>
<a href="#l6.9"></a><span id="l6.9">         retCode = SetMAPIProperties(aObject, currentValue, values) ;</span>
<a href="#l6.10"></a><span id="l6.10">     for (i = 0 ; i &lt; currentValue ; ++ i) {</span>
<a href="#l6.11"></a><span id="l6.11">         if (PROP_TYPE(aPropertiesTag [i]) == PT_STRING8) {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-            NS_Free(values [i].Value.lpszA) ;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+            free(values [i].Value.lpszA) ;</span>
<a href="#l6.14"></a><span id="l6.14">         }</span>
<a href="#l6.15"></a><span id="l6.15">     }</span>
<a href="#l6.16"></a><span id="l6.16">     delete [] values ;</span>
<a href="#l6.17"></a><span id="l6.17">     return retCode ;</span>
<a href="#l6.18"></a><span id="l6.18"> }</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20"> BOOL nsAbWinHelper::SetPropertyDate(const nsMapiEntry&amp; aObject, ULONG aPropertyTag, </span>
<a href="#l6.21"></a><span id="l6.21">                                     WORD aYear, WORD aMonth, WORD aDay)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchAdapter.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchAdapter.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -569,17 +569,17 @@ nsresult nsMsgSearchAdapter::EncodeImapT</span>
<a href="#l7.4"></a><span id="l7.4">               *p++ = ch;</span>
<a href="#l7.5"></a><span id="l7.5">             }</span>
<a href="#l7.6"></a><span id="l7.6">             *p = '\0';</span>
<a href="#l7.7"></a><span id="l7.7">             value = strdup(newValue.get()); // realloc down to smaller size</span>
<a href="#l7.8"></a><span id="l7.8">           }</span>
<a href="#l7.9"></a><span id="l7.9">         }</span>
<a href="#l7.10"></a><span id="l7.10">         else</span>
<a href="#l7.11"></a><span id="l7.11">           value = strdup(&quot;&quot;);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-        NS_Free(convertedValue);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+        free(convertedValue);</span>
<a href="#l7.14"></a><span id="l7.14">         valueWasAllocated = true;</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16">       }</span>
<a href="#l7.17"></a><span id="l7.17">     }</span>
<a href="#l7.18"></a><span id="l7.18"> </span>
<a href="#l7.19"></a><span id="l7.19">     // this should be rewritten to use nsCString</span>
<a href="#l7.20"></a><span id="l7.20">     int subLen =</span>
<a href="#l7.21"></a><span id="l7.21">       (value ? strlen(value) : 0) +</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -619,17 +619,17 @@ nsresult nsMsgSearchAdapter::EncodeImapT</span>
<a href="#l7.23"></a><span id="l7.23"> </span>
<a href="#l7.24"></a><span id="l7.24">       // kmcentee, don't let the encoding end with whitespace,</span>
<a href="#l7.25"></a><span id="l7.25">       // this throws off later url STRCMP</span>
<a href="#l7.26"></a><span id="l7.26">       if (*encoding &amp;&amp; *(encoding + strlen(encoding) - 1) == ' ')</span>
<a href="#l7.27"></a><span id="l7.27">         *(encoding + strlen(encoding) - 1) = '\0';</span>
<a href="#l7.28"></a><span id="l7.28">     }</span>
<a href="#l7.29"></a><span id="l7.29"> </span>
<a href="#l7.30"></a><span id="l7.30">     if (value &amp;&amp; valueWasAllocated)</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-      NS_Free (value);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+      free (value);</span>
<a href="#l7.33"></a><span id="l7.33"> </span>
<a href="#l7.34"></a><span id="l7.34">     *ppOutTerm = encoding;</span>
<a href="#l7.35"></a><span id="l7.35"> </span>
<a href="#l7.36"></a><span id="l7.36">     return err;</span>
<a href="#l7.37"></a><span id="l7.37"> }</span>
<a href="#l7.38"></a><span id="l7.38"> </span>
<a href="#l7.39"></a><span id="l7.39"> nsresult nsMsgSearchAdapter::EncodeImapValue(char *encoding, const char *value, bool useQuotes, bool reallyDredd)</span>
<a href="#l7.40"></a><span id="l7.40"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchTerm.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchTerm.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -396,17 +396,17 @@ nsMsgSearchTerm::nsMsgSearchTerm (</span>
<a href="#l8.4"></a><span id="l8.4">   m_matchAll = false;</span>
<a href="#l8.5"></a><span id="l8.5"> }</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9"> nsMsgSearchTerm::~nsMsgSearchTerm ()</span>
<a href="#l8.10"></a><span id="l8.10"> {</span>
<a href="#l8.11"></a><span id="l8.11">   if (IS_STRING_ATTRIBUTE (m_attribute) &amp;&amp; m_value.string)</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    NS_Free(m_value.string);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    free(m_value.string);</span>
<a href="#l8.14"></a><span id="l8.14"> }</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16"> NS_IMPL_ISUPPORTS(nsMsgSearchTerm, nsIMsgSearchTerm)</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18"> </span>
<a href="#l8.19"></a><span id="l8.19"> // Perhaps we could find a better place for this?</span>
<a href="#l8.20"></a><span id="l8.20"> // Caller needs to free.</span>
<a href="#l8.21"></a><span id="l8.21"> /* static */char *nsMsgSearchTerm::EscapeQuotesInStr(const char *str)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchValue.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchValue.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -19,17 +19,17 @@ nsMsgSearchValueImpl::nsMsgSearchValueIm</span>
<a href="#l9.4"></a><span id="l9.4">     }</span>
<a href="#l9.5"></a><span id="l9.5">     else</span>
<a href="#l9.6"></a><span id="l9.6">         mValue.string = 0;</span>
<a href="#l9.7"></a><span id="l9.7"> }</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> nsMsgSearchValueImpl::~nsMsgSearchValueImpl()</span>
<a href="#l9.10"></a><span id="l9.10"> {</span>
<a href="#l9.11"></a><span id="l9.11">   if (IS_STRING_ATTRIBUTE(mValue.attribute))</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    NS_Free(mValue.string);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    free(mValue.string);</span>
<a href="#l9.14"></a><span id="l9.14"> }</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16"> NS_IMPL_ISUPPORTS(nsMsgSearchValueImpl, nsIMsgSearchValue)</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> NS_IMPL_GETSET(nsMsgSearchValueImpl, Priority, nsMsgPriorityValue, mValue.u.priority)</span>
<a href="#l9.19"></a><span id="l9.19"> NS_IMPL_GETSET(nsMsgSearchValueImpl, Status, uint32_t, mValue.u.msgStatus)</span>
<a href="#l9.20"></a><span id="l9.20"> NS_IMPL_GETSET(nsMsgSearchValueImpl, Size, uint32_t, mValue.u.size)</span>
<a href="#l9.21"></a><span id="l9.21"> NS_IMPL_GETSET(nsMsgSearchValueImpl, MsgKey, nsMsgKey, mValue.u.key)</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -65,17 +65,17 @@ nsMsgSearchValueImpl::GetStr(nsAString &amp;</span>
<a href="#l9.23"></a><span id="l9.23">     return NS_OK;</span>
<a href="#l9.24"></a><span id="l9.24"> }</span>
<a href="#l9.25"></a><span id="l9.25"> </span>
<a href="#l9.26"></a><span id="l9.26"> NS_IMETHODIMP</span>
<a href="#l9.27"></a><span id="l9.27"> nsMsgSearchValueImpl::SetStr(const nsAString &amp;aValue)</span>
<a href="#l9.28"></a><span id="l9.28"> {</span>
<a href="#l9.29"></a><span id="l9.29">     NS_ENSURE_TRUE(IS_STRING_ATTRIBUTE(mValue.attribute), NS_ERROR_ILLEGAL_VALUE);</span>
<a href="#l9.30"></a><span id="l9.30">     if (mValue.string)</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-        NS_Free(mValue.string);</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+        free(mValue.string);</span>
<a href="#l9.33"></a><span id="l9.33">     mValue.string = ToNewUTF8String(aValue);</span>
<a href="#l9.34"></a><span id="l9.34">     mValue.utf16String = aValue;</span>
<a href="#l9.35"></a><span id="l9.35">     return NS_OK;</span>
<a href="#l9.36"></a><span id="l9.36"> }</span>
<a href="#l9.37"></a><span id="l9.37"> </span>
<a href="#l9.38"></a><span id="l9.38"> NS_IMETHODIMP</span>
<a href="#l9.39"></a><span id="l9.39"> nsMsgSearchValueImpl::ToString(nsAString &amp;aResult)</span>
<a href="#l9.40"></a><span id="l9.40"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -2088,26 +2088,26 @@ nsSaveAllAttachmentsState::nsSaveAllAtta</span>
<a href="#l10.4"></a><span id="l10.4">     m_detachingAttachments = detachingAttachments;</span>
<a href="#l10.5"></a><span id="l10.5"> }</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7"> nsSaveAllAttachmentsState::~nsSaveAllAttachmentsState()</span>
<a href="#l10.8"></a><span id="l10.8"> {</span>
<a href="#l10.9"></a><span id="l10.9">     uint32_t i;</span>
<a href="#l10.10"></a><span id="l10.10">     for (i = 0; i &lt; m_count; i++)</span>
<a href="#l10.11"></a><span id="l10.11">     {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      NS_Free(m_contentTypeArray[i]);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-      NS_Free(m_urlArray[i]);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-      NS_Free(m_displayNameArray[i]);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-      NS_Free(m_messageUriArray[i]);</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+      free(m_contentTypeArray[i]);</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+      free(m_urlArray[i]);</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+      free(m_displayNameArray[i]);</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+      free(m_messageUriArray[i]);</span>
<a href="#l10.20"></a><span id="l10.20">     }</span>
<a href="#l10.21"></a><span id="l10.21">     delete[] m_contentTypeArray;</span>
<a href="#l10.22"></a><span id="l10.22">     delete[] m_urlArray;</span>
<a href="#l10.23"></a><span id="l10.23">     delete[] m_displayNameArray;</span>
<a href="#l10.24"></a><span id="l10.24">     delete[] m_messageUriArray;</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineminus">-    NS_Free(m_directoryName);</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+    free(m_directoryName);</span>
<a href="#l10.27"></a><span id="l10.27"> }</span>
<a href="#l10.28"></a><span id="l10.28"> </span>
<a href="#l10.29"></a><span id="l10.29"> nsresult</span>
<a href="#l10.30"></a><span id="l10.30"> nsMessenger::GetLastSaveDirectory(nsIFile **aLastSaveDir)</span>
<a href="#l10.31"></a><span id="l10.31"> {</span>
<a href="#l10.32"></a><span id="l10.32">   nsresult rv;</span>
<a href="#l10.33"></a><span id="l10.33">   nsCOMPtr&lt;nsIPrefBranch&gt; prefBranch = do_GetService(NS_PREFSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l10.34"></a><span id="l10.34">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineat">@@ -2383,20 +2383,20 @@ struct msgAttachment</span>
<a href="#l10.36"></a><span id="l10.36"> </span>
<a href="#l10.37"></a><span id="l10.37">   ~msgAttachment()</span>
<a href="#l10.38"></a><span id="l10.38">   {</span>
<a href="#l10.39"></a><span id="l10.39">     Clear();</span>
<a href="#l10.40"></a><span id="l10.40">   }</span>
<a href="#l10.41"></a><span id="l10.41"> </span>
<a href="#l10.42"></a><span id="l10.42">   void Clear()</span>
<a href="#l10.43"></a><span id="l10.43">   {</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineminus">-    NS_Free(mContentType);</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineminus">-    NS_Free(mUrl);</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineminus">-    NS_Free(mDisplayName);</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineminus">-    NS_Free(mMessageUri);</span>
<a href="#l10.48"></a><span id="l10.48" class="difflineplus">+    free(mContentType);</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineplus">+    free(mUrl);</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineplus">+    free(mDisplayName);</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+    free(mMessageUri);</span>
<a href="#l10.52"></a><span id="l10.52">   }</span>
<a href="#l10.53"></a><span id="l10.53"> </span>
<a href="#l10.54"></a><span id="l10.54">   bool Init(const char * aContentType, const char * aUrl,</span>
<a href="#l10.55"></a><span id="l10.55">               const char * aDisplayName, const char * aMessageUri)</span>
<a href="#l10.56"></a><span id="l10.56">   {</span>
<a href="#l10.57"></a><span id="l10.57">     Clear();</span>
<a href="#l10.58"></a><span id="l10.58">     mContentType = strdup(aContentType);</span>
<a href="#l10.59"></a><span id="l10.59">     mUrl = strdup(aUrl);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -489,17 +489,17 @@ void nsMessengerUnixIntegration::FillToo</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5">     uint32_t numNewKeys = 0;</span>
<a href="#l11.6"></a><span id="l11.6">     uint32_t *newMessageKeys;</span>
<a href="#l11.7"></a><span id="l11.7">     db-&gt;GetNewList(&amp;numNewKeys, &amp;newMessageKeys);</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9">     // If we had new messages, we *should* have new keys, but we'll</span>
<a href="#l11.10"></a><span id="l11.10">     // check just in case.</span>
<a href="#l11.11"></a><span id="l11.11">     if (numNewKeys &lt;= 0) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-      NS_Free(newMessageKeys);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+      free(newMessageKeys);</span>
<a href="#l11.14"></a><span id="l11.14">       return;</span>
<a href="#l11.15"></a><span id="l11.15">     }</span>
<a href="#l11.16"></a><span id="l11.16"> </span>
<a href="#l11.17"></a><span id="l11.17">     // Find the rootFolder that folder belongs to, and find out</span>
<a href="#l11.18"></a><span id="l11.18">     // what MRUTime it maps to.  Assign this to lastMRUTime.</span>
<a href="#l11.19"></a><span id="l11.19">     uint32_t lastMRUTime = 0;</span>
<a href="#l11.20"></a><span id="l11.20">     if (NS_FAILED(GetMRUTimestampForFolder(folder, &amp;lastMRUTime)))</span>
<a href="#l11.21"></a><span id="l11.21">       lastMRUTime = 0;</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -517,17 +517,17 @@ void nsMessengerUnixIntegration::FillToo</span>
<a href="#l11.23"></a><span id="l11.23"> </span>
<a href="#l11.24"></a><span id="l11.24">       if (dateInSeconds &gt; lastMRUTime)</span>
<a href="#l11.25"></a><span id="l11.25">         newMsgHdrs.AppendObject(hdr);</span>
<a href="#l11.26"></a><span id="l11.26"> </span>
<a href="#l11.27"></a><span id="l11.27">     }</span>
<a href="#l11.28"></a><span id="l11.28"> </span>
<a href="#l11.29"></a><span id="l11.29">     // At this point, we don't need newMessageKeys any more,</span>
<a href="#l11.30"></a><span id="l11.30">     // so let's free it.</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-    NS_Free(newMessageKeys);</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+    free(newMessageKeys);</span>
<a href="#l11.33"></a><span id="l11.33"> </span>
<a href="#l11.34"></a><span id="l11.34">     // If we didn't happen to add any message headers, bail out</span>
<a href="#l11.35"></a><span id="l11.35">     if (!newMsgHdrs.Count())</span>
<a href="#l11.36"></a><span id="l11.36">       return;</span>
<a href="#l11.37"></a><span id="l11.37"> </span>
<a href="#l11.38"></a><span id="l11.38">     // Sort the message headers by dateInSeconds, in ascending</span>
<a href="#l11.39"></a><span id="l11.39">     // order</span>
<a href="#l11.40"></a><span id="l11.40">     newMsgHdrs.Sort(nsMsgDbHdrTimestampComparator, nullptr);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -168,26 +168,26 @@ nsMsgDBView::InitializeLiterals()</span>
<a href="#l12.4"></a><span id="l12.4"> nsMsgDBView::~nsMsgDBView()</span>
<a href="#l12.5"></a><span id="l12.5"> {</span>
<a href="#l12.6"></a><span id="l12.6">   if (m_db)</span>
<a href="#l12.7"></a><span id="l12.7">     m_db-&gt;RemoveListener(this);</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9">   gInstanceCount--;</span>
<a href="#l12.10"></a><span id="l12.10">   if (gInstanceCount &lt;= 0)</span>
<a href="#l12.11"></a><span id="l12.11">   {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-    NS_Free(kHighestPriorityString);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-    NS_Free(kHighPriorityString);</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-    NS_Free(kLowestPriorityString);</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-    NS_Free(kLowPriorityString);</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-    NS_Free(kNormalPriorityString);</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-    NS_Free(kReadString);</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-    NS_Free(kRepliedString);</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-    NS_Free(kForwardedString);</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-    NS_Free(kNewString);</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+    free(kHighestPriorityString);</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+    free(kHighPriorityString);</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+    free(kLowestPriorityString);</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+    free(kLowPriorityString);</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+    free(kNormalPriorityString);</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+    free(kReadString);</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+    free(kRepliedString);</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+    free(kForwardedString);</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+    free(kNewString);</span>
<a href="#l12.32"></a><span id="l12.32">   }</span>
<a href="#l12.33"></a><span id="l12.33"> }</span>
<a href="#l12.34"></a><span id="l12.34"> </span>
<a href="#l12.35"></a><span id="l12.35"> nsresult</span>
<a href="#l12.36"></a><span id="l12.36"> nsMsgDBView::InitLabelStrings()</span>
<a href="#l12.37"></a><span id="l12.37"> {</span>
<a href="#l12.38"></a><span id="l12.38">   nsresult rv = NS_OK;</span>
<a href="#l12.39"></a><span id="l12.39">   nsCString prefString;</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineat">@@ -2685,17 +2685,17 @@ nsMsgDBView::GetIndicesForSelection(uint</span>
<a href="#l12.41"></a><span id="l12.41">   nsMsgViewIndexArray selection;</span>
<a href="#l12.42"></a><span id="l12.42">   GetSelectedIndices(selection);</span>
<a href="#l12.43"></a><span id="l12.43">   uint32_t numIndices = selection.Length();</span>
<a href="#l12.44"></a><span id="l12.44">   if (!numIndices)</span>
<a href="#l12.45"></a><span id="l12.45">     return NS_OK;</span>
<a href="#l12.46"></a><span id="l12.46"> </span>
<a href="#l12.47"></a><span id="l12.47">   *length = numIndices;</span>
<a href="#l12.48"></a><span id="l12.48">   uint32_t datalen = numIndices * sizeof(nsMsgViewIndex);</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-  *indices = (nsMsgViewIndex *)NS_Alloc(datalen);</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+  *indices = (nsMsgViewIndex *)moz_xmalloc(datalen);</span>
<a href="#l12.51"></a><span id="l12.51">   if (!*indices)</span>
<a href="#l12.52"></a><span id="l12.52">     return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l12.53"></a><span id="l12.53"> </span>
<a href="#l12.54"></a><span id="l12.54">   memcpy(*indices, selection.Elements(), datalen);</span>
<a href="#l12.55"></a><span id="l12.55">   return NS_OK;</span>
<a href="#l12.56"></a><span id="l12.56"> }</span>
<a href="#l12.57"></a><span id="l12.57"> </span>
<a href="#l12.58"></a><span id="l12.58"> NS_IMETHODIMP</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineat">@@ -2719,17 +2719,17 @@ nsMsgDBView::GetSelectedMsgHdrs(uint32_t</span>
<a href="#l12.60"></a><span id="l12.60">   nsCOMPtr&lt;nsIMutableArray&gt; messages(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l12.61"></a><span id="l12.61">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.62"></a><span id="l12.62">   rv = GetHeadersFromSelection(selection.Elements(), numIndices, messages);</span>
<a href="#l12.63"></a><span id="l12.63">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.64"></a><span id="l12.64">   uint32_t numMsgsSelected;</span>
<a href="#l12.65"></a><span id="l12.65">   messages-&gt;GetLength(&amp;numMsgsSelected);</span>
<a href="#l12.66"></a><span id="l12.66"> </span>
<a href="#l12.67"></a><span id="l12.67">   nsIMsgDBHdr **headers =</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineminus">-    static_cast&lt;nsIMsgDBHdr**&gt;(NS_Alloc(sizeof(nsIMsgDBHdr*) * numMsgsSelected));</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+    static_cast&lt;nsIMsgDBHdr**&gt;(moz_xmalloc(sizeof(nsIMsgDBHdr*) * numMsgsSelected));</span>
<a href="#l12.70"></a><span id="l12.70"> </span>
<a href="#l12.71"></a><span id="l12.71">   for (uint32_t i = 0; i &lt; numMsgsSelected; i++)</span>
<a href="#l12.72"></a><span id="l12.72">   {</span>
<a href="#l12.73"></a><span id="l12.73">     nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr = do_QueryElementAt(messages, i, &amp;rv);</span>
<a href="#l12.74"></a><span id="l12.74">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.75"></a><span id="l12.75">     // Already AddRefed.</span>
<a href="#l12.76"></a><span id="l12.76">     msgHdr.forget(&amp;headers[i]);</span>
<a href="#l12.77"></a><span id="l12.77">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/src/nsMsgTagService.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgTagService.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -353,17 +353,17 @@ NS_IMETHODIMP nsMsgTagService::GetAllTag</span>
<a href="#l13.4"></a><span id="l13.4">   char **prefList;</span>
<a href="#l13.5"></a><span id="l13.5">   rv = m_tagPrefBranch-&gt;GetChildList(&quot;&quot;, &amp;prefCount, &amp;prefList);</span>
<a href="#l13.6"></a><span id="l13.6">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.7"></a><span id="l13.7">   // sort them by key for ease of processing</span>
<a href="#l13.8"></a><span id="l13.8">   NS_QuickSort(prefList, prefCount, sizeof(char*), CompareMsgTagKeys, nullptr);</span>
<a href="#l13.9"></a><span id="l13.9"> </span>
<a href="#l13.10"></a><span id="l13.10">   // build an array of nsIMsgTag elements from the orderered list</span>
<a href="#l13.11"></a><span id="l13.11">   // it's at max the same size as the preflist, but usually only about half</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  nsIMsgTag** tagArray = (nsIMsgTag**) NS_Alloc(sizeof(nsIMsgTag*) * prefCount);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  nsIMsgTag** tagArray = (nsIMsgTag**) moz_xmalloc(sizeof(nsIMsgTag*) * prefCount);</span>
<a href="#l13.14"></a><span id="l13.14"> </span>
<a href="#l13.15"></a><span id="l13.15">   if (!tagArray)</span>
<a href="#l13.16"></a><span id="l13.16">   {</span>
<a href="#l13.17"></a><span id="l13.17">     NS_FREE_XPCOM_ALLOCATED_POINTER_ARRAY(prefCount, prefList);</span>
<a href="#l13.18"></a><span id="l13.18">     return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l13.19"></a><span id="l13.19">   }</span>
<a href="#l13.20"></a><span id="l13.20">   uint32_t currentTagIndex = 0;</span>
<a href="#l13.21"></a><span id="l13.21">   nsMsgTag *newMsgTag;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/src/nsSubscribableServer.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/src/nsSubscribableServer.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -418,17 +418,17 @@ nsSubscribableServer::FreeSubtree(Subscr</span>
<a href="#l14.4"></a><span id="l14.4">             rv = FreeSubtree(node-&gt;nextSibling);</span>
<a href="#l14.5"></a><span id="l14.5">             NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l14.6"></a><span id="l14.6">             node-&gt;nextSibling = nullptr;</span>
<a href="#l14.7"></a><span id="l14.7">         }</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9"> #ifdef HAVE_SUBSCRIBE_DESCRIPTION</span>
<a href="#l14.10"></a><span id="l14.10">         NS_ASSERTION(node-&gt;description == nullptr, &quot;you need to free the description&quot;);</span>
<a href="#l14.11"></a><span id="l14.11"> #endif</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-        NS_Free(node-&gt;name);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+        free(node-&gt;name);</span>
<a href="#l14.14"></a><span id="l14.14"> #if 0</span>
<a href="#l14.15"></a><span id="l14.15">         node-&gt;name = nullptr;</span>
<a href="#l14.16"></a><span id="l14.16">         node-&gt;parent = nullptr;</span>
<a href="#l14.17"></a><span id="l14.17">         node-&gt;lastChild = nullptr;</span>
<a href="#l14.18"></a><span id="l14.18">         node-&gt;cachedChild = nullptr;</span>
<a href="#l14.19"></a><span id="l14.19"> #endif</span>
<a href="#l14.20"></a><span id="l14.20"> </span>
<a href="#l14.21"></a><span id="l14.21">         PR_Free(node);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -561,17 +561,17 @@ NS_IMETHODIMP nsMsgDBFolder::ClearNewMes</span>
<a href="#l15.4"></a><span id="l15.4">   {</span>
<a href="#l15.5"></a><span id="l15.5">     uint32_t numNewKeys;</span>
<a href="#l15.6"></a><span id="l15.6">     nsMsgKey *newMessageKeys;</span>
<a href="#l15.7"></a><span id="l15.7">     rv = mDatabase-&gt;GetNewList(&amp;numNewKeys, &amp;newMessageKeys);</span>
<a href="#l15.8"></a><span id="l15.8">     if (NS_SUCCEEDED(rv) &amp;&amp; newMessageKeys)</span>
<a href="#l15.9"></a><span id="l15.9">     {</span>
<a href="#l15.10"></a><span id="l15.10">       m_saveNewMsgs.Clear();</span>
<a href="#l15.11"></a><span id="l15.11">       m_saveNewMsgs.AppendElements(newMessageKeys, numNewKeys);</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-      NS_Free(newMessageKeys);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+      free(newMessageKeys);</span>
<a href="#l15.14"></a><span id="l15.14">     }</span>
<a href="#l15.15"></a><span id="l15.15">     mDatabase-&gt;ClearNewList(true);</span>
<a href="#l15.16"></a><span id="l15.16">   }</span>
<a href="#l15.17"></a><span id="l15.17">   if (!dbWasCached)</span>
<a href="#l15.18"></a><span id="l15.18">     SetMsgDatabase(nullptr);</span>
<a href="#l15.19"></a><span id="l15.19"> </span>
<a href="#l15.20"></a><span id="l15.20">   m_newMsgs.Clear();</span>
<a href="#l15.21"></a><span id="l15.21">   mNumNewBiffMessages = 0;</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -956,17 +956,17 @@ nsMsgDBFolder::SetMsgDatabase(nsIMsgData</span>
<a href="#l15.23"></a><span id="l15.23">       uint32_t numNewKeys;</span>
<a href="#l15.24"></a><span id="l15.24">       nsMsgKey *newMessageKeys;</span>
<a href="#l15.25"></a><span id="l15.25">       nsresult rv = mDatabase-&gt;GetNewList(&amp;numNewKeys, &amp;newMessageKeys);</span>
<a href="#l15.26"></a><span id="l15.26">       if (NS_SUCCEEDED(rv) &amp;&amp; newMessageKeys)</span>
<a href="#l15.27"></a><span id="l15.27">       {</span>
<a href="#l15.28"></a><span id="l15.28">         m_newMsgs.Clear();</span>
<a href="#l15.29"></a><span id="l15.29">         m_newMsgs.AppendElements(newMessageKeys, numNewKeys);</span>
<a href="#l15.30"></a><span id="l15.30">       }</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-      NS_Free(newMessageKeys);</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+      free(newMessageKeys);</span>
<a href="#l15.33"></a><span id="l15.33">     }</span>
<a href="#l15.34"></a><span id="l15.34">   }</span>
<a href="#l15.35"></a><span id="l15.35">   mDatabase = aMsgDatabase;</span>
<a href="#l15.36"></a><span id="l15.36"> </span>
<a href="#l15.37"></a><span id="l15.37">   if (aMsgDatabase)</span>
<a href="#l15.38"></a><span id="l15.38">     aMsgDatabase-&gt;AddListener(this);</span>
<a href="#l15.39"></a><span id="l15.39">   return NS_OK;</span>
<a href="#l15.40"></a><span id="l15.40"> }</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineat">@@ -2292,18 +2292,18 @@ nsMsgDBFolder::SpamFilterClassifyMessage</span>
<a href="#l15.42"></a><span id="l15.42"> </span>
<a href="#l15.43"></a><span id="l15.43">   uint32_t count;</span>
<a href="#l15.44"></a><span id="l15.44">   uint32_t *proIndices;</span>
<a href="#l15.45"></a><span id="l15.45">   uint32_t *antiIndices;</span>
<a href="#l15.46"></a><span id="l15.46">   rv = traitService-&gt;GetEnabledIndices(&amp;count, &amp;proIndices, &amp;antiIndices);</span>
<a href="#l15.47"></a><span id="l15.47">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l15.48"></a><span id="l15.48"> </span>
<a href="#l15.49"></a><span id="l15.49">   rv = aJunkMailPlugin-&gt;ClassifyTraitsInMessage(aURI, count, proIndices, antiIndices, this, aMsgWindow, this);</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineminus">-  NS_Free(proIndices);</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineminus">-  NS_Free(antiIndices);</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+  free(proIndices);</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+  free(antiIndices);</span>
<a href="#l15.54"></a><span id="l15.54">   return rv;</span>
<a href="#l15.55"></a><span id="l15.55"> }</span>
<a href="#l15.56"></a><span id="l15.56"> </span>
<a href="#l15.57"></a><span id="l15.57"> nsresult</span>
<a href="#l15.58"></a><span id="l15.58"> nsMsgDBFolder::SpamFilterClassifyMessages(const char **aURIArray, uint32_t aURICount, nsIMsgWindow *aMsgWindow, nsIJunkMailPlugin *aJunkMailPlugin)</span>
<a href="#l15.59"></a><span id="l15.59"> {</span>
<a href="#l15.60"></a><span id="l15.60"> </span>
<a href="#l15.61"></a><span id="l15.61">   nsresult rv;</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineat">@@ -2313,18 +2313,18 @@ nsMsgDBFolder::SpamFilterClassifyMessage</span>
<a href="#l15.63"></a><span id="l15.63">   uint32_t count;</span>
<a href="#l15.64"></a><span id="l15.64">   uint32_t *proIndices;</span>
<a href="#l15.65"></a><span id="l15.65">   uint32_t *antiIndices;</span>
<a href="#l15.66"></a><span id="l15.66">   rv = traitService-&gt;GetEnabledIndices(&amp;count, &amp;proIndices, &amp;antiIndices);</span>
<a href="#l15.67"></a><span id="l15.67">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l15.68"></a><span id="l15.68"> </span>
<a href="#l15.69"></a><span id="l15.69">   rv = aJunkMailPlugin-&gt;ClassifyTraitsInMessages(aURICount, aURIArray, count,</span>
<a href="#l15.70"></a><span id="l15.70">       proIndices, antiIndices, this, aMsgWindow, this);</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineminus">-  NS_Free(proIndices);</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineminus">-  NS_Free(antiIndices);</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+  free(proIndices);</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+  free(antiIndices);</span>
<a href="#l15.75"></a><span id="l15.75">   return rv;</span>
<a href="#l15.76"></a><span id="l15.76"> }</span>
<a href="#l15.77"></a><span id="l15.77"> </span>
<a href="#l15.78"></a><span id="l15.78"> NS_IMETHODIMP</span>
<a href="#l15.79"></a><span id="l15.79"> nsMsgDBFolder::OnMessageClassified(const char *aMsgURI,</span>
<a href="#l15.80"></a><span id="l15.80">                                    nsMsgJunkStatus aClassification,</span>
<a href="#l15.81"></a><span id="l15.81">                                    uint32_t aJunkPercent)</span>
<a href="#l15.82"></a><span id="l15.82"> {</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineat">@@ -2614,18 +2614,18 @@ nsMsgDBFolder::CallFilterPlugins(nsIMsgW</span>
<a href="#l15.84"></a><span id="l15.84">         GetInheritedStringProperty(property.get(), isEnabledOnFolder);</span>
<a href="#l15.85"></a><span id="l15.85">         if (isEnabledOnFolder.EqualsLiteral(&quot;false&quot;))</span>
<a href="#l15.86"></a><span id="l15.86">           filterForOther = false;</span>
<a href="#l15.87"></a><span id="l15.87">         // We might have to allow a &quot;true&quot; override in the future, but</span>
<a href="#l15.88"></a><span id="l15.88">         // for now there is no way for that to affect the processing</span>
<a href="#l15.89"></a><span id="l15.89">         break;</span>
<a href="#l15.90"></a><span id="l15.90">       }</span>
<a href="#l15.91"></a><span id="l15.91">     }</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineminus">-    NS_Free(proIndices);</span>
<a href="#l15.93"></a><span id="l15.93" class="difflineminus">-    NS_Free(antiIndices);</span>
<a href="#l15.94"></a><span id="l15.94" class="difflineplus">+    free(proIndices);</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineplus">+    free(antiIndices);</span>
<a href="#l15.96"></a><span id="l15.96">   }</span>
<a href="#l15.97"></a><span id="l15.97"> </span>
<a href="#l15.98"></a><span id="l15.98">   // Do we need to apply message filters?</span>
<a href="#l15.99"></a><span id="l15.99">   bool filterPostPlugin = false; // Do we have a post-analysis filter?</span>
<a href="#l15.100"></a><span id="l15.100">   nsCOMPtr&lt;nsIMsgFilterList&gt; filterList;</span>
<a href="#l15.101"></a><span id="l15.101">   GetFilterList(aMsgWindow, getter_AddRefs(filterList));</span>
<a href="#l15.102"></a><span id="l15.102">   if (filterList)</span>
<a href="#l15.103"></a><span id="l15.103">   {</span>
<a href="#l15.104"></a><span id="l15.104" class="difflineat">@@ -2668,17 +2668,17 @@ nsMsgDBFolder::CallFilterPlugins(nsIMsgW</span>
<a href="#l15.105"></a><span id="l15.105">   nsTArray&lt;nsMsgKey&gt; newMessageKeys;</span>
<a href="#l15.106"></a><span id="l15.106">   // Start from m_saveNewMsgs (and clear its current state).  m_saveNewMsgs is</span>
<a href="#l15.107"></a><span id="l15.107">   // where we stash the list of new messages when we are told to clear the list</span>
<a href="#l15.108"></a><span id="l15.108">   // of new messages by the UI (which purges the list from the nsMsgDatabase).</span>
<a href="#l15.109"></a><span id="l15.109">   newMessageKeys.SwapElements(m_saveNewMsgs);</span>
<a href="#l15.110"></a><span id="l15.110">   if (numNewKeys)</span>
<a href="#l15.111"></a><span id="l15.111">     newMessageKeys.AppendElements(newKeys, numNewKeys);</span>
<a href="#l15.112"></a><span id="l15.112"> </span>
<a href="#l15.113"></a><span id="l15.113" class="difflineminus">-  NS_Free(newKeys);</span>
<a href="#l15.114"></a><span id="l15.114" class="difflineplus">+  free(newKeys);</span>
<a href="#l15.115"></a><span id="l15.115"> </span>
<a href="#l15.116"></a><span id="l15.116">   // build up list of keys to classify</span>
<a href="#l15.117"></a><span id="l15.117">   nsTArray&lt;nsMsgKey&gt; classifyMsgKeys;</span>
<a href="#l15.118"></a><span id="l15.118">   nsCString uri;</span>
<a href="#l15.119"></a><span id="l15.119"> </span>
<a href="#l15.120"></a><span id="l15.120">   uint32_t numNewMessages = newMessageKeys.Length();</span>
<a href="#l15.121"></a><span id="l15.121">   for (uint32_t i = 0 ; i &lt; numNewMessages ; ++i)</span>
<a href="#l15.122"></a><span id="l15.122">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompFields.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompFields.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -603,17 +603,17 @@ nsMsgCompFields::SplitRecipients(const n</span>
<a href="#l16.4"></a><span id="l16.4">   nsCOMArray&lt;msgIAddressObject&gt; header(EncodedHeader(NS_ConvertUTF16toUTF8(aRecipients)));</span>
<a href="#l16.5"></a><span id="l16.5">   nsTArray&lt;nsString&gt; results;</span>
<a href="#l16.6"></a><span id="l16.6">   if (aEmailAddressOnly)</span>
<a href="#l16.7"></a><span id="l16.7">     ExtractEmails(header, results);</span>
<a href="#l16.8"></a><span id="l16.8">   else</span>
<a href="#l16.9"></a><span id="l16.9">     ExtractDisplayAddresses(header, results);</span>
<a href="#l16.10"></a><span id="l16.10"> </span>
<a href="#l16.11"></a><span id="l16.11">   uint32_t count = results.Length();</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  char16_t **result = (char16_t **)NS_Alloc(sizeof(char16_t *) * count);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  char16_t **result = (char16_t **)moz_xmalloc(sizeof(char16_t *) * count);</span>
<a href="#l16.14"></a><span id="l16.14">   for (uint32_t i = 0; i &lt; count; ++i)</span>
<a href="#l16.15"></a><span id="l16.15">     result[i] = ToNewUnicode(results[i]);</span>
<a href="#l16.16"></a><span id="l16.16"> </span>
<a href="#l16.17"></a><span id="l16.17">   *aResult = result;</span>
<a href="#l16.18"></a><span id="l16.18">   *aLength = count;</span>
<a href="#l16.19"></a><span id="l16.19">   return NS_OK;</span>
<a href="#l16.20"></a><span id="l16.20"> }</span>
<a href="#l16.21"></a><span id="l16.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1631,17 +1631,17 @@ nsMsgComposeAndSend::GetBodyFromEditor()</span>
<a href="#l17.4"></a><span id="l17.4">       {</span>
<a href="#l17.5"></a><span id="l17.5">         mOriginalHTMLBody = ToNewCString(newBody);</span>
<a href="#l17.6"></a><span id="l17.6">       }</span>
<a href="#l17.7"></a><span id="l17.7">     }</span>
<a href="#l17.8"></a><span id="l17.8">     else {</span>
<a href="#l17.9"></a><span id="l17.9">       mOriginalHTMLBody = ToNewCString(attachment1_body);</span>
<a href="#l17.10"></a><span id="l17.10">     }</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    NS_Free(bodyText);    //Don't need it anymore</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+    free(bodyText);    //Don't need it anymore</span>
<a href="#l17.14"></a><span id="l17.14">   }</span>
<a href="#l17.15"></a><span id="l17.15">   else</span>
<a href="#l17.16"></a><span id="l17.16">     return NS_ERROR_FAILURE;</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18">   rv = SnarfAndCopyBody(attachment1_body, TEXT_HTML);</span>
<a href="#l17.19"></a><span id="l17.19"> </span>
<a href="#l17.20"></a><span id="l17.20">   return rv;</span>
<a href="#l17.21"></a><span id="l17.21"> }</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -3367,17 +3367,17 @@ nsMsgComposeAndSend::DeliverFileAsMail()</span>
<a href="#l17.23"></a><span id="l17.23">     buf = convbuf;</span>
<a href="#l17.24"></a><span id="l17.24">   }</span>
<a href="#l17.25"></a><span id="l17.25"> </span>
<a href="#l17.26"></a><span id="l17.26">   nsCString escaped_buf;</span>
<a href="#l17.27"></a><span id="l17.27">   MsgEscapeString(nsDependentCString(buf), nsINetUtil::ESCAPE_URL_PATH, escaped_buf);</span>
<a href="#l17.28"></a><span id="l17.28"> </span>
<a href="#l17.29"></a><span id="l17.29">   if (!escaped_buf.IsEmpty())</span>
<a href="#l17.30"></a><span id="l17.30">   {</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-    NS_Free(buf);</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+    free(buf);</span>
<a href="#l17.33"></a><span id="l17.33">     buf = ToNewCString(escaped_buf);</span>
<a href="#l17.34"></a><span id="l17.34">   }</span>
<a href="#l17.35"></a><span id="l17.35"> </span>
<a href="#l17.36"></a><span id="l17.36">   nsCOMPtr&lt;nsISmtpService&gt; smtpService(do_GetService(NS_SMTPSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l17.37"></a><span id="l17.37">   if (NS_SUCCEEDED(rv) &amp;&amp; smtpService)</span>
<a href="#l17.38"></a><span id="l17.38">   {</span>
<a href="#l17.39"></a><span id="l17.39">     MsgDeliveryListener *deliveryListener = new MsgDeliveryListener(this, false);</span>
<a href="#l17.40"></a><span id="l17.40">     if (!deliveryListener)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1510,17 +1510,17 @@ nsresult nsSmtpProtocol::AuthLoginStep1(</span>
<a href="#l18.4"></a><span id="l18.4">   }</span>
<a href="#l18.5"></a><span id="l18.5">   else</span>
<a href="#l18.6"></a><span id="l18.6">     return (NS_ERROR_COMMUNICATIONS_ERROR);</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8">   status = SendData(buffer, true);</span>
<a href="#l18.9"></a><span id="l18.9">   m_nextState = SMTP_RESPONSE;</span>
<a href="#l18.10"></a><span id="l18.10">   m_nextStateAfterResponse = SMTP_AUTH_LOGIN_RESPONSE;</span>
<a href="#l18.11"></a><span id="l18.11">   SetFlag(SMTP_PAUSE_FOR_READ);</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-  NS_Free(base64Str);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+  free(base64Str);</span>
<a href="#l18.14"></a><span id="l18.14"> </span>
<a href="#l18.15"></a><span id="l18.15">   return (status);</span>
<a href="#l18.16"></a><span id="l18.16"> }</span>
<a href="#l18.17"></a><span id="l18.17"> </span>
<a href="#l18.18"></a><span id="l18.18"> nsresult nsSmtpProtocol::AuthLoginStep2()</span>
<a href="#l18.19"></a><span id="l18.19"> {</span>
<a href="#l18.20"></a><span id="l18.20">   /* use cached smtp password first</span>
<a href="#l18.21"></a><span id="l18.21">   * if not then use cached pop password</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineat">@@ -1572,17 +1572,17 @@ nsresult nsSmtpProtocol::AuthLoginStep2(</span>
<a href="#l18.23"></a><span id="l18.23">         if (NS_FAILED(rv)) return NS_ERROR_FAILURE;</span>
<a href="#l18.24"></a><span id="l18.24"> </span>
<a href="#l18.25"></a><span id="l18.25">         nsCString userName;</span>
<a href="#l18.26"></a><span id="l18.26">         rv = smtpServer-&gt;GetUsername(userName);</span>
<a href="#l18.27"></a><span id="l18.27"> </span>
<a href="#l18.28"></a><span id="l18.28">         PR_snprintf(buffer, sizeof(buffer), &quot;%s %s&quot;, userName.get(), encodedDigest.get());</span>
<a href="#l18.29"></a><span id="l18.29">         char *base64Str = PL_Base64Encode(buffer, strlen(buffer), nullptr);</span>
<a href="#l18.30"></a><span id="l18.30">         PR_snprintf(buffer, sizeof(buffer), &quot;%s&quot; CRLF, base64Str);</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineminus">-        NS_Free(base64Str);</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+        free(base64Str);</span>
<a href="#l18.33"></a><span id="l18.33">       }</span>
<a href="#l18.34"></a><span id="l18.34">       if (NS_FAILED(rv))</span>
<a href="#l18.35"></a><span id="l18.35">         PR_snprintf(buffer, sizeof(buffer), &quot;*&quot; CRLF);</span>
<a href="#l18.36"></a><span id="l18.36">     }</span>
<a href="#l18.37"></a><span id="l18.37">     else if (m_currentAuthMethod == SMTP_AUTH_NTLM_ENABLED ||</span>
<a href="#l18.38"></a><span id="l18.38">              m_currentAuthMethod == SMTP_AUTH_MSN_ENABLED)</span>
<a href="#l18.39"></a><span id="l18.39">     {</span>
<a href="#l18.40"></a><span id="l18.40">       MOZ_LOG(SMTPLogModule, mozilla::LogLevel::Debug, (&quot;NTLM/MSN auth, step 2&quot;));</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineat">@@ -1591,17 +1591,17 @@ nsresult nsSmtpProtocol::AuthLoginStep2(</span>
<a href="#l18.42"></a><span id="l18.42">       PR_snprintf(buffer, sizeof(buffer), &quot;%.509s&quot; CRLF, response.get());</span>
<a href="#l18.43"></a><span id="l18.43">     }</span>
<a href="#l18.44"></a><span id="l18.44">     else if (m_currentAuthMethod == SMTP_AUTH_PLAIN_ENABLED ||</span>
<a href="#l18.45"></a><span id="l18.45">              m_currentAuthMethod == SMTP_AUTH_LOGIN_ENABLED)</span>
<a href="#l18.46"></a><span id="l18.46">     {</span>
<a href="#l18.47"></a><span id="l18.47">       MOZ_LOG(SMTPLogModule, mozilla::LogLevel::Debug, (&quot;PLAIN/LOGIN auth, step 2&quot;));</span>
<a href="#l18.48"></a><span id="l18.48">       char *base64Str = PL_Base64Encode(password.get(), password.Length(), nullptr);</span>
<a href="#l18.49"></a><span id="l18.49">       PR_snprintf(buffer, sizeof(buffer), &quot;%.256s&quot; CRLF, base64Str);</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineminus">-      NS_Free(base64Str);</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineplus">+      free(base64Str);</span>
<a href="#l18.52"></a><span id="l18.52">     }</span>
<a href="#l18.53"></a><span id="l18.53">     else</span>
<a href="#l18.54"></a><span id="l18.54">       return NS_ERROR_COMMUNICATIONS_ERROR;</span>
<a href="#l18.55"></a><span id="l18.55"> </span>
<a href="#l18.56"></a><span id="l18.56">     status = SendData(buffer, true);</span>
<a href="#l18.57"></a><span id="l18.57">     m_nextState = SMTP_RESPONSE;</span>
<a href="#l18.58"></a><span id="l18.58">     m_nextStateAfterResponse = SMTP_AUTH_LOGIN_RESPONSE;</span>
<a href="#l18.59"></a><span id="l18.59">     SetFlag(SMTP_PAUSE_FOR_READ);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -3605,28 +3605,28 @@ nsresult nsMsgDatabase::CharPtrToRowCell</span>
<a href="#l19.4"></a><span id="l19.4">   yarn.mYarn_Buf = (void *) charPtr;</span>
<a href="#l19.5"></a><span id="l19.5">   yarn.mYarn_Size = PL_strlen((const char *) yarn.mYarn_Buf) + 1;</span>
<a href="#l19.6"></a><span id="l19.6">   yarn.mYarn_Fill = yarn.mYarn_Size - 1;</span>
<a href="#l19.7"></a><span id="l19.7">   yarn.mYarn_Form = 0;  // what to do with this? we're storing csid in the msg hdr...</span>
<a href="#l19.8"></a><span id="l19.8"> </span>
<a href="#l19.9"></a><span id="l19.9">   return row-&gt;AddColumn(GetEnv(),  columnToken, &amp;yarn);</span>
<a href="#l19.10"></a><span id="l19.10"> }</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-// caller must NS_Free result</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+// caller must free result</span>
<a href="#l19.14"></a><span id="l19.14"> nsresult nsMsgDatabase::RowCellColumnToCharPtr(nsIMdbRow *row, mdb_token columnToken, char **result)</span>
<a href="#l19.15"></a><span id="l19.15"> {</span>
<a href="#l19.16"></a><span id="l19.16">   nsresult  err = NS_ERROR_NULL_POINTER;</span>
<a href="#l19.17"></a><span id="l19.17"> </span>
<a href="#l19.18"></a><span id="l19.18">   if (row &amp;&amp; result)</span>
<a href="#l19.19"></a><span id="l19.19">   {</span>
<a href="#l19.20"></a><span id="l19.20">     struct mdbYarn yarn;</span>
<a href="#l19.21"></a><span id="l19.21">     err = row-&gt;AliasCellYarn(GetEnv(), columnToken, &amp;yarn);</span>
<a href="#l19.22"></a><span id="l19.22">     if (NS_SUCCEEDED(err))</span>
<a href="#l19.23"></a><span id="l19.23">     {</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-      *result = (char *)NS_Alloc(yarn.mYarn_Fill + 1);</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineplus">+      *result = (char *)moz_xmalloc(yarn.mYarn_Fill + 1);</span>
<a href="#l19.26"></a><span id="l19.26">       if (*result)</span>
<a href="#l19.27"></a><span id="l19.27">       {</span>
<a href="#l19.28"></a><span id="l19.28">         if (yarn.mYarn_Fill &gt; 0)</span>
<a href="#l19.29"></a><span id="l19.29">           memcpy(*result, yarn.mYarn_Buf, yarn.mYarn_Fill);</span>
<a href="#l19.30"></a><span id="l19.30">         (*result)[yarn.mYarn_Fill] = '\0';</span>
<a href="#l19.31"></a><span id="l19.31">       }</span>
<a href="#l19.32"></a><span id="l19.32">       else</span>
<a href="#l19.33"></a><span id="l19.33">         err = NS_ERROR_OUT_OF_MEMORY;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/extensions/bayesian-spam-filter/src/nsBayesianFilter.cpp</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1692,17 +1692,17 @@ void nsBayesianFilter::classifyMessage(</span>
<a href="#l20.4"></a><span id="l20.4">           tokenStrings.AppendElement(ToNewUnicode(NS_ConvertUTF8toUTF16(</span>
<a href="#l20.5"></a><span id="l20.5">               tokens[ta.mTokenIndex].mWord)));</span>
<a href="#l20.6"></a><span id="l20.6">         }</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8">         aDetailListener-&gt;OnMessageTraitDetails(messageURI, aProTraits[traitIndex],</span>
<a href="#l20.9"></a><span id="l20.9">             usedTokenCount, (const char16_t**)tokenStrings.Elements(),</span>
<a href="#l20.10"></a><span id="l20.10">             tokenPercents.Elements(), runningPercents.Elements());</span>
<a href="#l20.11"></a><span id="l20.11">         for (uint32_t tokenIndex = 0; tokenIndex &lt; usedTokenCount; tokenIndex++)</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-          NS_Free(tokenStrings[tokenIndex]);</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+          free(tokenStrings[tokenIndex]);</span>
<a href="#l20.14"></a><span id="l20.14">       }</span>
<a href="#l20.15"></a><span id="l20.15"> </span>
<a href="#l20.16"></a><span id="l20.16">       uint32_t proPercent = static_cast&lt;uint32_t&gt;(prob*100. + .5);</span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18">       // directly classify junk to maintain backwards compatibility</span>
<a href="#l20.19"></a><span id="l20.19">       if (aProTraits[traitIndex] == kJunkTrait)</span>
<a href="#l20.20"></a><span id="l20.20">       {</span>
<a href="#l20.21"></a><span id="l20.21">         bool isJunk = (prob &gt;= mJunkProbabilityThreshold);</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineat">@@ -1735,19 +1735,19 @@ void nsBayesianFilter::classifyMessage(</span>
<a href="#l20.23"></a><span id="l20.23">       if (aTraitListener)</span>
<a href="#l20.24"></a><span id="l20.24">       {</span>
<a href="#l20.25"></a><span id="l20.25">         traits.AppendElement(aProTraits[traitIndex]);</span>
<a href="#l20.26"></a><span id="l20.26">         percents.AppendElement(proPercent);</span>
<a href="#l20.27"></a><span id="l20.27">       }</span>
<a href="#l20.28"></a><span id="l20.28"> </span>
<a href="#l20.29"></a><span id="l20.29">       // free aliases arrays returned from XPCOM</span>
<a href="#l20.30"></a><span id="l20.30">       if (proAliasesLengths[traitIndex])</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineminus">-        NS_Free(proAliasArrays[traitIndex]);</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+        free(proAliasArrays[traitIndex]);</span>
<a href="#l20.33"></a><span id="l20.33">       if (antiAliasesLengths[traitIndex])</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineminus">-        NS_Free(antiAliasArrays[traitIndex]);</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+        free(antiAliasArrays[traitIndex]);</span>
<a href="#l20.36"></a><span id="l20.36">     }</span>
<a href="#l20.37"></a><span id="l20.37"> </span>
<a href="#l20.38"></a><span id="l20.38">     if (aTraitListener)</span>
<a href="#l20.39"></a><span id="l20.39">       aTraitListener-&gt;OnMessageTraitsClassified(messageURI,</span>
<a href="#l20.40"></a><span id="l20.40">           traits.Length(), traits.Elements(), percents.Elements());</span>
<a href="#l20.41"></a><span id="l20.41"> </span>
<a href="#l20.42"></a><span id="l20.42">     delete[] tokens;</span>
<a href="#l20.43"></a><span id="l20.43">     // reuse mAnalysisStore without clearing memory</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -8400,17 +8400,17 @@ nsImapMailFolder::CopyFileToOfflineStore</span>
<a href="#l21.4"></a><span id="l21.4">     {</span>
<a href="#l21.5"></a><span id="l21.5">       newLine = inputStreamBuffer-&gt;ReadNextLine(inputStream, numBytesInLine, needMoreData);</span>
<a href="#l21.6"></a><span id="l21.6">       if (newLine)</span>
<a href="#l21.7"></a><span id="l21.7">       {</span>
<a href="#l21.8"></a><span id="l21.8">         msgParser-&gt;ParseAFolderLine(newLine, numBytesInLine);</span>
<a href="#l21.9"></a><span id="l21.9">         if (offlineStore)</span>
<a href="#l21.10"></a><span id="l21.10">           rv = offlineStore-&gt;Write(newLine, numBytesInLine, &amp;bytesWritten);</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-        NS_Free(newLine);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+        free(newLine);</span>
<a href="#l21.14"></a><span id="l21.14">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l21.15"></a><span id="l21.15">       }</span>
<a href="#l21.16"></a><span id="l21.16">     } while (newLine);</span>
<a href="#l21.17"></a><span id="l21.17"> </span>
<a href="#l21.18"></a><span id="l21.18">     msgParser-&gt;FinishHeader();</span>
<a href="#l21.19"></a><span id="l21.19">     uint32_t resultFlags;</span>
<a href="#l21.20"></a><span id="l21.20">     if (offlineStore)</span>
<a href="#l21.21"></a><span id="l21.21">       fakeHdr-&gt;OrFlags(nsMsgMessageFlags::Offline | nsMsgMessageFlags::Read, &amp;resultFlags);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/imap/src/nsImapProtocol.cpp</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapProtocol.cpp</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -2516,17 +2516,17 @@ void nsImapProtocol::ProcessSelectedStat</span>
<a href="#l22.4"></a><span id="l22.4">         bool more;</span>
<a href="#l22.5"></a><span id="l22.5">         m_imapMailFolderSink-&gt;GetMsgHdrsToDownload(&amp;more,</span>
<a href="#l22.6"></a><span id="l22.6">                                                    &amp;m_progressExpectedNumber,</span>
<a href="#l22.7"></a><span id="l22.7">                                                    &amp;msgCount,</span>
<a href="#l22.8"></a><span id="l22.8">                                                    &amp;msgIdList);</span>
<a href="#l22.9"></a><span id="l22.9">         if (msgIdList)</span>
<a href="#l22.10"></a><span id="l22.10">         {</span>
<a href="#l22.11"></a><span id="l22.11">           FolderHeaderDump(msgIdList, msgCount);</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-          NS_Free(msgIdList);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+          free(msgIdList);</span>
<a href="#l22.14"></a><span id="l22.14">           m_runningUrl-&gt;SetMoreHeadersToDownload(more);</span>
<a href="#l22.15"></a><span id="l22.15">           // We're going to be re-running this url.</span>
<a href="#l22.16"></a><span id="l22.16">           if (more)</span>
<a href="#l22.17"></a><span id="l22.17">             m_runningUrl-&gt;SetRerunningUrl(true);</span>
<a href="#l22.18"></a><span id="l22.18">         }</span>
<a href="#l22.19"></a><span id="l22.19">         HeaderFetchCompleted();</span>
<a href="#l22.20"></a><span id="l22.20">       }</span>
<a href="#l22.21"></a><span id="l22.21">       else</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineat">@@ -3533,17 +3533,17 @@ nsImapProtocol::FetchMessage(const nsCSt</span>
<a href="#l22.23"></a><span id="l22.23">           headersToDL = strdup(dbHeaders);</span>
<a href="#l22.24"></a><span id="l22.24">         else</span>
<a href="#l22.25"></a><span id="l22.25">           headersToDL = PR_smprintf(&quot;%s %s&quot;,dbHeaders, arbitraryHeaders.get());</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27">         if (gUseEnvelopeCmd)</span>
<a href="#l22.28"></a><span id="l22.28">           what = PR_smprintf(&quot; ENVELOPE BODY.PEEK[HEADER.FIELDS (%s)])&quot;, headersToDL);</span>
<a href="#l22.29"></a><span id="l22.29">         else</span>
<a href="#l22.30"></a><span id="l22.30">           what = PR_smprintf(&quot; BODY.PEEK[HEADER.FIELDS (%s)])&quot;,headersToDL);</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-        NS_Free(headersToDL);</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+        free(headersToDL);</span>
<a href="#l22.33"></a><span id="l22.33">         if (what)</span>
<a href="#l22.34"></a><span id="l22.34">         {</span>
<a href="#l22.35"></a><span id="l22.35">           commandString.AppendLiteral(&quot; %s (UID &quot;);</span>
<a href="#l22.36"></a><span id="l22.36">            if (m_isGmailServer)</span>
<a href="#l22.37"></a><span id="l22.37">             commandString.AppendLiteral(&quot;X-GM-MSGID X-GM-THRID X-GM-LABELS &quot;);</span>
<a href="#l22.38"></a><span id="l22.38">           if (aolImapServer)</span>
<a href="#l22.39"></a><span id="l22.39">             commandString.AppendLiteral(&quot; XAOL.SIZE&quot;) ;</span>
<a href="#l22.40"></a><span id="l22.40">           else</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineat">@@ -4254,17 +4254,17 @@ void nsImapProtocol::ProcessMailboxUpdat</span>
<a href="#l22.42"></a><span id="l22.42">   if (GetServerStateParser().LastCommandSuccessful())</span>
<a href="#l22.43"></a><span id="l22.43">   {</span>
<a href="#l22.44"></a><span id="l22.44">     if (entered_waitForBodyIdsMonitor)</span>
<a href="#l22.45"></a><span id="l22.45">       m_waitForBodyIdsMonitor.Exit();</span>
<a href="#l22.46"></a><span id="l22.46"> </span>
<a href="#l22.47"></a><span id="l22.47">     if (msgIdList &amp;&amp; !DeathSignalReceived() &amp;&amp; GetServerStateParser().LastCommandSuccessful())</span>
<a href="#l22.48"></a><span id="l22.48">     {</span>
<a href="#l22.49"></a><span id="l22.49">       FolderHeaderDump(msgIdList, msgCount);</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-      NS_Free( msgIdList);</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineplus">+      free( msgIdList);</span>
<a href="#l22.52"></a><span id="l22.52">     }</span>
<a href="#l22.53"></a><span id="l22.53">     HeaderFetchCompleted();</span>
<a href="#l22.54"></a><span id="l22.54">       // this might be bogus, how are we going to do pane notification and stuff when we fetch bodies without</span>
<a href="#l22.55"></a><span id="l22.55">       // headers!</span>
<a href="#l22.56"></a><span id="l22.56">   }</span>
<a href="#l22.57"></a><span id="l22.57">   else if (entered_waitForBodyIdsMonitor) // need to exit this monitor if death signal received</span>
<a href="#l22.58"></a><span id="l22.58">     m_waitForBodyIdsMonitor.Exit();</span>
<a href="#l22.59"></a><span id="l22.59"> </span>
<a href="#l22.60"></a><span id="l22.60" class="difflineat">@@ -6527,17 +6527,17 @@ void nsImapProtocol::OnRefreshAllACLs()</span>
<a href="#l22.61"></a><span id="l22.61">     mb = m_listedMailboxList.ElementAt(i);</span>
<a href="#l22.62"></a><span id="l22.62">     if (mb) // paranoia</span>
<a href="#l22.63"></a><span id="l22.63">     {</span>
<a href="#l22.64"></a><span id="l22.64">       char *onlineName = nullptr;</span>
<a href="#l22.65"></a><span id="l22.65">       m_runningUrl-&gt;AllocateServerPath(PromiseFlatCString(mb-&gt;GetMailboxName()).get(), mb-&gt;GetDelimiter(), &amp;onlineName);</span>
<a href="#l22.66"></a><span id="l22.66">       if (onlineName)</span>
<a href="#l22.67"></a><span id="l22.67">       {</span>
<a href="#l22.68"></a><span id="l22.68">         RefreshACLForFolder(onlineName);</span>
<a href="#l22.69"></a><span id="l22.69" class="difflineminus">-        NS_Free(onlineName);</span>
<a href="#l22.70"></a><span id="l22.70" class="difflineplus">+        free(onlineName);</span>
<a href="#l22.71"></a><span id="l22.71">       }</span>
<a href="#l22.72"></a><span id="l22.72">       PercentProgressUpdateEvent(NULL, count, total);</span>
<a href="#l22.73"></a><span id="l22.73">       delete mb;</span>
<a href="#l22.74"></a><span id="l22.74">       count++;</span>
<a href="#l22.75"></a><span id="l22.75">     }</span>
<a href="#l22.76"></a><span id="l22.76">   }</span>
<a href="#l22.77"></a><span id="l22.77">   m_listedMailboxList.Clear();</span>
<a href="#l22.78"></a><span id="l22.78"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/imap/src/nsImapServerResponseParser.cpp</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapServerResponseParser.cpp</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1599,17 +1599,17 @@ void nsImapServerResponseParser::parse_a</span>
<a href="#l23.4"></a><span id="l23.4">         AdvanceToNextToken();</span>
<a href="#l23.5"></a><span id="l23.5">         char *hostName = CreateNilString();</span>
<a href="#l23.6"></a><span id="l23.6">         AdvanceToNextToken();</span>
<a href="#l23.7"></a><span id="l23.7">         addressLine += mailboxName;</span>
<a href="#l23.8"></a><span id="l23.8">         if (hostName)</span>
<a href="#l23.9"></a><span id="l23.9">         {</span>
<a href="#l23.10"></a><span id="l23.10">           addressLine += '@';</span>
<a href="#l23.11"></a><span id="l23.11">           addressLine += hostName;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-          NS_Free(hostName);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+          free(hostName);</span>
<a href="#l23.14"></a><span id="l23.14">         }</span>
<a href="#l23.15"></a><span id="l23.15">         if (personalName)</span>
<a href="#l23.16"></a><span id="l23.16">         {</span>
<a href="#l23.17"></a><span id="l23.17">           addressLine += &quot; (&quot;;</span>
<a href="#l23.18"></a><span id="l23.18">           addressLine += personalName;</span>
<a href="#l23.19"></a><span id="l23.19">           addressLine += ')';</span>
<a href="#l23.20"></a><span id="l23.20">         }</span>
<a href="#l23.21"></a><span id="l23.21">       }</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineat">@@ -1636,17 +1636,17 @@ void nsImapServerResponseParser::interna</span>
<a href="#l23.23"></a><span id="l23.23">   AdvanceToNextToken();</span>
<a href="#l23.24"></a><span id="l23.24">   if (ContinueParse())</span>
<a href="#l23.25"></a><span id="l23.25">   {</span>
<a href="#l23.26"></a><span id="l23.26">     nsAutoCString dateLine(&quot;Date: &quot;);</span>
<a href="#l23.27"></a><span id="l23.27">     char *strValue = CreateNilString();</span>
<a href="#l23.28"></a><span id="l23.28">     if (strValue)</span>
<a href="#l23.29"></a><span id="l23.29">     {</span>
<a href="#l23.30"></a><span id="l23.30">       dateLine += strValue;</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-      NS_Free(strValue);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+      free(strValue);</span>
<a href="#l23.33"></a><span id="l23.33">     }</span>
<a href="#l23.34"></a><span id="l23.34">     fServerConnection.HandleMessageDownLoadLine(dateLine.get(), false);</span>
<a href="#l23.35"></a><span id="l23.35">   }</span>
<a href="#l23.36"></a><span id="l23.36">   // advance the parser.</span>
<a href="#l23.37"></a><span id="l23.37">   AdvanceToNextToken();</span>
<a href="#l23.38"></a><span id="l23.38"> }</span>
<a href="#l23.39"></a><span id="l23.39"> </span>
<a href="#l23.40"></a><span id="l23.40"> void nsImapServerResponseParser::flags()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/imap/src/nsImapService.cpp</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapService.cpp</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -2079,17 +2079,17 @@ nsresult nsImapService::OfflineAppendFro</span>
<a href="#l24.4"></a><span id="l24.4">           uint32_t numBytesInLine = 0;</span>
<a href="#l24.5"></a><span id="l24.5">           do</span>
<a href="#l24.6"></a><span id="l24.6">           {</span>
<a href="#l24.7"></a><span id="l24.7">             newLine = inputStreamBuffer-&gt;ReadNextLine(inputStream, numBytesInLine, needMoreData); </span>
<a href="#l24.8"></a><span id="l24.8">             if (newLine)</span>
<a href="#l24.9"></a><span id="l24.9">             {</span>
<a href="#l24.10"></a><span id="l24.10">               msgParser-&gt;ParseAFolderLine(newLine, numBytesInLine);</span>
<a href="#l24.11"></a><span id="l24.11">               rv = offlineStore-&gt;Write(newLine, numBytesInLine, &amp;bytesWritten);</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-              NS_Free(newLine);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+              free(newLine);</span>
<a href="#l24.14"></a><span id="l24.14">             }</span>
<a href="#l24.15"></a><span id="l24.15">           } while (newLine);</span>
<a href="#l24.16"></a><span id="l24.16">           msgParser-&gt;FinishHeader();</span>
<a href="#l24.17"></a><span id="l24.17"> </span>
<a href="#l24.18"></a><span id="l24.18">           nsCOMPtr&lt;nsIMsgDBHdr&gt; fakeHdr;</span>
<a href="#l24.19"></a><span id="l24.19">           msgParser-&gt;GetNewMsgHdr(getter_AddRefs(fakeHdr));</span>
<a href="#l24.20"></a><span id="l24.20">           if (fakeHdr)</span>
<a href="#l24.21"></a><span id="l24.21">           {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/imap/src/nsImapUrl.cpp</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapUrl.cpp</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -798,17 +798,17 @@ NS_IMETHODIMP nsImapUrl::AddOnlineDirect</span>
<a href="#l25.4"></a><span id="l25.4">           PL_strcat(newOnlineName, onlineMailboxName);</span>
<a href="#l25.5"></a><span id="l25.5">         }</span>
<a href="#l25.6"></a><span id="l25.6">       }</span>
<a href="#l25.7"></a><span id="l25.7">     }</span>
<a href="#l25.8"></a><span id="l25.8">   }</span>
<a href="#l25.9"></a><span id="l25.9">   if (directory)</span>
<a href="#l25.10"></a><span id="l25.10">     *directory = newOnlineName;</span>
<a href="#l25.11"></a><span id="l25.11">   else if (newOnlineName)</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    NS_Free(newOnlineName);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+    free(newOnlineName);</span>
<a href="#l25.14"></a><span id="l25.14">   return rv;</span>
<a href="#l25.15"></a><span id="l25.15"> }</span>
<a href="#l25.16"></a><span id="l25.16"> </span>
<a href="#l25.17"></a><span id="l25.17"> // Converts from canonical format (hierarchy is indicated by '/' and all real slashes ('/') are escaped)</span>
<a href="#l25.18"></a><span id="l25.18"> // to the real online name on the server.</span>
<a href="#l25.19"></a><span id="l25.19"> NS_IMETHODIMP nsImapUrl::AllocateServerPath(const char * canonicalPath, char onlineDelimiter, char ** aAllocatedPath)</span>
<a href="#l25.20"></a><span id="l25.20"> {</span>
<a href="#l25.21"></a><span id="l25.21">   nsresult retVal = NS_OK;</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineat">@@ -823,24 +823,24 @@ NS_IMETHODIMP nsImapUrl::AllocateServerP</span>
<a href="#l25.23"></a><span id="l25.23">     rv = strdup(&quot;&quot;);</span>
<a href="#l25.24"></a><span id="l25.24"> </span>
<a href="#l25.25"></a><span id="l25.25">   if (delimiterToUse != '/')</span>
<a href="#l25.26"></a><span id="l25.26">     UnescapeSlashes(rv);</span>
<a href="#l25.27"></a><span id="l25.27">   char *onlineNameAdded = nullptr;</span>
<a href="#l25.28"></a><span id="l25.28">   AddOnlineDirectoryIfNecessary(rv, &amp;onlineNameAdded);</span>
<a href="#l25.29"></a><span id="l25.29">   if (onlineNameAdded)</span>
<a href="#l25.30"></a><span id="l25.30">   {</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-    NS_Free(rv);</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+    free(rv);</span>
<a href="#l25.33"></a><span id="l25.33">     rv = onlineNameAdded;</span>
<a href="#l25.34"></a><span id="l25.34">   }</span>
<a href="#l25.35"></a><span id="l25.35"> </span>
<a href="#l25.36"></a><span id="l25.36">   if (aAllocatedPath)</span>
<a href="#l25.37"></a><span id="l25.37">     *aAllocatedPath = rv;</span>
<a href="#l25.38"></a><span id="l25.38">   else</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineminus">-    NS_Free(rv);</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineplus">+    free(rv);</span>
<a href="#l25.41"></a><span id="l25.41"> </span>
<a href="#l25.42"></a><span id="l25.42">   return retVal;</span>
<a href="#l25.43"></a><span id="l25.43"> }</span>
<a href="#l25.44"></a><span id="l25.44"> </span>
<a href="#l25.45"></a><span id="l25.45"> // escape '/' as ^, ^ -&gt; ^^ - use UnescapeSlashes to revert</span>
<a href="#l25.46"></a><span id="l25.46"> /* static */ nsresult nsImapUrl::EscapeSlashes(const char *sourcePath, char **resultPath)</span>
<a href="#l25.47"></a><span id="l25.47"> {</span>
<a href="#l25.48"></a><span id="l25.48">   NS_ENSURE_ARG(sourcePath);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/import/outlook/src/MapiApi.cpp</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/import/outlook/src/MapiApi.cpp</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1355,17 +1355,17 @@ void CMapiApi::ReportUIDProp(const char </span>
<a href="#l26.4"></a><span id="l26.4">       MAPI_TRACE1(&quot;%s - INVALID, expecting 16 bytes of binary data for UID\n&quot;, pTag);</span>
<a href="#l26.5"></a><span id="l26.5">     }</span>
<a href="#l26.6"></a><span id="l26.6">     else {</span>
<a href="#l26.7"></a><span id="l26.7">       nsIID  uid;</span>
<a href="#l26.8"></a><span id="l26.8">       memcpy(&amp;uid, pVal-&gt;Value.bin.lpb, 16);</span>
<a href="#l26.9"></a><span id="l26.9">       char *  pStr = uid.ToString();</span>
<a href="#l26.10"></a><span id="l26.10">       if (pStr) {</span>
<a href="#l26.11"></a><span id="l26.11">         MAPI_TRACE2(&quot;%s %s\n&quot;, pTag, (const char *)pStr);</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-        NS_Free(pStr);</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+        free(pStr);</span>
<a href="#l26.14"></a><span id="l26.14">       }</span>
<a href="#l26.15"></a><span id="l26.15">     }</span>
<a href="#l26.16"></a><span id="l26.16">   }</span>
<a href="#l26.17"></a><span id="l26.17">   else if (pVal &amp;&amp; (PROP_TYPE(pVal-&gt;ulPropTag) == PT_NULL)) {</span>
<a href="#l26.18"></a><span id="l26.18">     MAPI_TRACE1(&quot;%s {NULL}\n&quot;, pTag);</span>
<a href="#l26.19"></a><span id="l26.19">   }</span>
<a href="#l26.20"></a><span id="l26.20">   else if (pVal &amp;&amp; (PROP_TYPE(pVal-&gt;ulPropTag) == PT_ERROR)) {</span>
<a href="#l26.21"></a><span id="l26.21">     MAPI_TRACE1(&quot;%s {Error retrieving property}\n&quot;, pTag);</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineat">@@ -1641,23 +1641,23 @@ void CMapiFolderList::DumpList(void)</span>
<a href="#l26.23"></a><span id="l26.23">     depth *= 2;</span>
<a href="#l26.24"></a><span id="l26.24">     if (depth &gt; 255)</span>
<a href="#l26.25"></a><span id="l26.25">       depth = 255;</span>
<a href="#l26.26"></a><span id="l26.26">     memset(prefix, ' ', depth);</span>
<a href="#l26.27"></a><span id="l26.27">     prefix[depth] = 0;</span>
<a href="#l26.28"></a><span id="l26.28"> #ifdef MAPI_DEBUG</span>
<a href="#l26.29"></a><span id="l26.29">         char *ansiStr = ToNewCString(str);</span>
<a href="#l26.30"></a><span id="l26.30">     MAPI_TRACE2(&quot;%s%s: &quot;, prefix, ansiStr);</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-    NS_Free(ansiStr);</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+    free(ansiStr);</span>
<a href="#l26.33"></a><span id="l26.33"> #endif</span>
<a href="#l26.34"></a><span id="l26.34">     pFolder-&gt;GetFilePath(str);</span>
<a href="#l26.35"></a><span id="l26.35"> #ifdef MAPI_DEBUG</span>
<a href="#l26.36"></a><span id="l26.36">         ansiStr = ToNewCString(str);</span>
<a href="#l26.37"></a><span id="l26.37">     MAPI_TRACE2(&quot;depth=%d, filePath=%s\n&quot;, pFolder-&gt;GetDepth(), ansiStr);</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineminus">-    NS_Free(ansiStr);</span>
<a href="#l26.39"></a><span id="l26.39" class="difflineplus">+    free(ansiStr);</span>
<a href="#l26.40"></a><span id="l26.40"> #endif</span>
<a href="#l26.41"></a><span id="l26.41">   }</span>
<a href="#l26.42"></a><span id="l26.42">   MAPI_TRACE0(&quot;---------------------------------------------\n&quot;);</span>
<a href="#l26.43"></a><span id="l26.43"> }</span>
<a href="#l26.44"></a><span id="l26.44"> </span>
<a href="#l26.45"></a><span id="l26.45"> </span>
<a href="#l26.46"></a><span id="l26.46"> CMapiFolder::CMapiFolder()</span>
<a href="#l26.47"></a><span id="l26.47"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/import/outlook/src/MapiMessage.cpp</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/import/outlook/src/MapiMessage.cpp</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1115,23 +1115,23 @@ bool CMapiMessage::AddAttachment(DWORD a</span>
<a href="#l27.4"></a><span id="l27.4"> }</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6"> void CMapiMessage::ClearAttachment(attach_data* data)</span>
<a href="#l27.7"></a><span id="l27.7"> {</span>
<a href="#l27.8"></a><span id="l27.8">   if (data-&gt;delete_file &amp;&amp; data-&gt;tmp_file)</span>
<a href="#l27.9"></a><span id="l27.9">     data-&gt;tmp_file-&gt;Remove(false);</span>
<a href="#l27.10"></a><span id="l27.10"> </span>
<a href="#l27.11"></a><span id="l27.11">   if (data-&gt;type)</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    NS_Free(data-&gt;type);</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+    free(data-&gt;type);</span>
<a href="#l27.14"></a><span id="l27.14">   if (data-&gt;encoding)</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineminus">-    NS_Free(data-&gt;encoding);</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+    free(data-&gt;encoding);</span>
<a href="#l27.17"></a><span id="l27.17">   if (data-&gt;real_name)</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-    NS_Free(data-&gt;real_name);</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineplus">+    free(data-&gt;real_name);</span>
<a href="#l27.20"></a><span id="l27.20">   if (data-&gt;cid)</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-    NS_Free(data-&gt;cid);</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineplus">+    free(data-&gt;cid);</span>
<a href="#l27.23"></a><span id="l27.23"> </span>
<a href="#l27.24"></a><span id="l27.24">   delete data;</span>
<a href="#l27.25"></a><span id="l27.25"> }</span>
<a href="#l27.26"></a><span id="l27.26"> </span>
<a href="#l27.27"></a><span id="l27.27"> void CMapiMessage::ClearAttachments()</span>
<a href="#l27.28"></a><span id="l27.28"> {</span>
<a href="#l27.29"></a><span id="l27.29">   std::for_each(m_stdattachments.begin(), m_stdattachments.end(), ClearAttachment);</span>
<a href="#l27.30"></a><span id="l27.30">   m_stdattachments.clear();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/import/outlook/src/nsOutlookImport.cpp</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/import/outlook/src/nsOutlookImport.cpp</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -381,17 +381,17 @@ ImportOutlookMailImpl::ImportMailbox(nsI</span>
<a href="#l28.4"></a><span id="l28.4"> </span>
<a href="#l28.5"></a><span id="l28.5">   nsString  success;</span>
<a href="#l28.6"></a><span id="l28.6">   nsString  error;</span>
<a href="#l28.7"></a><span id="l28.7">   bool abort = false;</span>
<a href="#l28.8"></a><span id="l28.8">   nsString name;</span>
<a href="#l28.9"></a><span id="l28.9">   char16_t *pName;</span>
<a href="#l28.10"></a><span id="l28.10">   if (NS_SUCCEEDED( pSource-&gt;GetDisplayName( &amp;pName))) {</span>
<a href="#l28.11"></a><span id="l28.11">     name = pName;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-    NS_Free( pName);</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+    free( pName);</span>
<a href="#l28.14"></a><span id="l28.14">  }</span>
<a href="#l28.15"></a><span id="l28.15"> </span>
<a href="#l28.16"></a><span id="l28.16">   uint32_t mailSize = 0;</span>
<a href="#l28.17"></a><span id="l28.17">   pSource-&gt;GetSize(&amp;mailSize);</span>
<a href="#l28.18"></a><span id="l28.18">   if (mailSize == 0) {</span>
<a href="#l28.19"></a><span id="l28.19">     ReportSuccess(name, 0, &amp;success);</span>
<a href="#l28.20"></a><span id="l28.20">     SetLogs(success, error, pErrorLog, pSuccessLog);</span>
<a href="#l28.21"></a><span id="l28.21">     return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/import/src/nsImportAddressBooks.cpp</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/import/src/nsImportAddressBooks.cpp</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -138,17 +138,17 @@ nsImportGenericAddressBooks::nsImportGen</span>
<a href="#l29.4"></a><span id="l29.4"> </span>
<a href="#l29.5"></a><span id="l29.5">   nsImportStringBundle::GetStringBundle(IMPORT_MSGS_URL, getter_AddRefs(m_stringBundle));</span>
<a href="#l29.6"></a><span id="l29.6"> }</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8"> </span>
<a href="#l29.9"></a><span id="l29.9"> nsImportGenericAddressBooks::~nsImportGenericAddressBooks()</span>
<a href="#l29.10"></a><span id="l29.10"> {</span>
<a href="#l29.11"></a><span id="l29.11">   if (m_description)</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-    NS_Free(m_description);</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    free(m_description);</span>
<a href="#l29.14"></a><span id="l29.14"> }</span>
<a href="#l29.15"></a><span id="l29.15"> </span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17"> </span>
<a href="#l29.18"></a><span id="l29.18"> NS_IMPL_ISUPPORTS(nsImportGenericAddressBooks, nsIImportGeneric)</span>
<a href="#l29.19"></a><span id="l29.19"> </span>
<a href="#l29.20"></a><span id="l29.20"> </span>
<a href="#l29.21"></a><span id="l29.21"> NS_IMETHODIMP nsImportGenericAddressBooks::GetData(const char *dataId, nsISupports **_retval)</span>
<a href="#l29.22"></a><span id="l29.22" class="difflineat">@@ -219,17 +219,17 @@ NS_IMETHODIMP nsImportGenericAddressBook</span>
<a href="#l29.23"></a><span id="l29.23">       bool      found = false;</span>
<a href="#l29.24"></a><span id="l29.24">       rv = m_pInterface-&gt;GetSampleData(rNum, &amp;found, &amp;pData);</span>
<a href="#l29.25"></a><span id="l29.25">       if (NS_FAILED(rv))</span>
<a href="#l29.26"></a><span id="l29.26">         return rv;</span>
<a href="#l29.27"></a><span id="l29.27">       if (found) {</span>
<a href="#l29.28"></a><span id="l29.28">         data-&gt;SetData(nsDependentString(pData));</span>
<a href="#l29.29"></a><span id="l29.29">         data.forget(_retval);</span>
<a href="#l29.30"></a><span id="l29.30">       }</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineminus">-      NS_Free(pData);</span>
<a href="#l29.32"></a><span id="l29.32" class="difflineplus">+      free(pData);</span>
<a href="#l29.33"></a><span id="l29.33">     }</span>
<a href="#l29.34"></a><span id="l29.34">   }</span>
<a href="#l29.35"></a><span id="l29.35"> </span>
<a href="#l29.36"></a><span id="l29.36">   return NS_OK;</span>
<a href="#l29.37"></a><span id="l29.37"> }</span>
<a href="#l29.38"></a><span id="l29.38"> </span>
<a href="#l29.39"></a><span id="l29.39"> </span>
<a href="#l29.40"></a><span id="l29.40"> NS_IMETHODIMP nsImportGenericAddressBooks::SetData(const char *dataId, nsISupports *item)</span>
<a href="#l29.41"></a><span id="l29.41" class="difflineat">@@ -324,17 +324,17 @@ void nsImportGenericAddressBooks::GetDef</span>
<a href="#l29.42"></a><span id="l29.42"> {</span>
<a href="#l29.43"></a><span id="l29.43">   if (!m_pInterface)</span>
<a href="#l29.44"></a><span id="l29.44">     return;</span>
<a href="#l29.45"></a><span id="l29.45"> </span>
<a href="#l29.46"></a><span id="l29.46">   if ((m_pLocation &amp;&amp; m_gotLocation) || m_autoFind)</span>
<a href="#l29.47"></a><span id="l29.47">     return;</span>
<a href="#l29.48"></a><span id="l29.48"> </span>
<a href="#l29.49"></a><span id="l29.49">   if (m_description)</span>
<a href="#l29.50"></a><span id="l29.50" class="difflineminus">-    NS_Free(m_description);</span>
<a href="#l29.51"></a><span id="l29.51" class="difflineplus">+    free(m_description);</span>
<a href="#l29.52"></a><span id="l29.52">   m_description = nullptr;</span>
<a href="#l29.53"></a><span id="l29.53">   m_pInterface-&gt;GetAutoFind(&amp;m_description, &amp;m_autoFind);</span>
<a href="#l29.54"></a><span id="l29.54">   m_gotLocation = true;</span>
<a href="#l29.55"></a><span id="l29.55">   if (m_autoFind) {</span>
<a href="#l29.56"></a><span id="l29.56">     m_found = true;</span>
<a href="#l29.57"></a><span id="l29.57">     m_userVerify = false;</span>
<a href="#l29.58"></a><span id="l29.58">     return;</span>
<a href="#l29.59"></a><span id="l29.59">   }</span>
<a href="#l29.60"></a><span id="l29.60" class="difflineat">@@ -722,17 +722,17 @@ void nsImportGenericAddressBooks::Report</span>
<a href="#l29.61"></a><span id="l29.61"> {</span>
<a href="#l29.62"></a><span id="l29.62">   if (!pStream)</span>
<a href="#l29.63"></a><span id="l29.63">     return;</span>
<a href="#l29.64"></a><span id="l29.64">   // load the error string</span>
<a href="#l29.65"></a><span id="l29.65">   char16_t *pFmt = nsImportStringBundle::GetStringByID(IMPORT_ERROR_GETABOOK, aBundle);</span>
<a href="#l29.66"></a><span id="l29.66">   nsString pText;</span>
<a href="#l29.67"></a><span id="l29.67">   nsTextFormatter::ssprintf(pText, pFmt, pName);</span>
<a href="#l29.68"></a><span id="l29.68">   pStream-&gt;Append(pText);</span>
<a href="#l29.69"></a><span id="l29.69" class="difflineminus">-  NS_Free(pFmt);</span>
<a href="#l29.70"></a><span id="l29.70" class="difflineplus">+  free(pFmt);</span>
<a href="#l29.71"></a><span id="l29.71">   pStream-&gt;AppendLiteral(MSG_LINEBREAK);</span>
<a href="#l29.72"></a><span id="l29.72"> }</span>
<a href="#l29.73"></a><span id="l29.73"> </span>
<a href="#l29.74"></a><span id="l29.74"> static void ImportAddressThread(void *stuff)</span>
<a href="#l29.75"></a><span id="l29.75"> {</span>
<a href="#l29.76"></a><span id="l29.76">   IMPORT_LOG0(&quot;In Begin ImportAddressThread\n&quot;);</span>
<a href="#l29.77"></a><span id="l29.77"> </span>
<a href="#l29.78"></a><span id="l29.78">   AddressThreadData *pData = (AddressThreadData *)stuff;</span>
<a href="#l29.79"></a><span id="l29.79" class="difflineat">@@ -788,21 +788,21 @@ static void ImportAddressThread(void *st</span>
<a href="#l29.80"></a><span id="l29.80">                                                        db,</span>
<a href="#l29.81"></a><span id="l29.81">                                                        pData-&gt;fieldMap,</span>
<a href="#l29.82"></a><span id="l29.82">                                                        pData-&gt;ldifService,</span>
<a href="#l29.83"></a><span id="l29.83">                                                        &amp;pError,</span>
<a href="#l29.84"></a><span id="l29.84">                                                        &amp;pSuccess,</span>
<a href="#l29.85"></a><span id="l29.85">                                                        &amp;fatalError);</span>
<a href="#l29.86"></a><span id="l29.86">           if (NS_SUCCEEDED(rv) &amp;&amp; pSuccess) {</span>
<a href="#l29.87"></a><span id="l29.87">             success.Append(pSuccess);</span>
<a href="#l29.88"></a><span id="l29.88" class="difflineminus">-            NS_Free(pSuccess);</span>
<a href="#l29.89"></a><span id="l29.89" class="difflineplus">+            free(pSuccess);</span>
<a href="#l29.90"></a><span id="l29.90">           }</span>
<a href="#l29.91"></a><span id="l29.91">           if (pError) {</span>
<a href="#l29.92"></a><span id="l29.92">             error.Append(pError);</span>
<a href="#l29.93"></a><span id="l29.93" class="difflineminus">-            NS_Free(pError);</span>
<a href="#l29.94"></a><span id="l29.94" class="difflineplus">+            free(pError);</span>
<a href="#l29.95"></a><span id="l29.95">           }</span>
<a href="#l29.96"></a><span id="l29.96">         }</span>
<a href="#l29.97"></a><span id="l29.97">         else {</span>
<a href="#l29.98"></a><span id="l29.98">           nsImportGenericAddressBooks::ReportError(name.get(), &amp;error, pData-&gt;stringBundle);</span>
<a href="#l29.99"></a><span id="l29.99">         }</span>
<a href="#l29.100"></a><span id="l29.100"> </span>
<a href="#l29.101"></a><span id="l29.101">         pData-&gt;currentSize = 0;</span>
<a href="#l29.102"></a><span id="l29.102">         pData-&gt;currentTotal += size;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mailnews/import/src/nsImportFieldMap.cpp</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mailnews/import/src/nsImportFieldMap.cpp</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -329,17 +329,17 @@ NS_IMETHODIMP nsImportFieldMap::SetField</span>
<a href="#l30.4"></a><span id="l30.4">   default:</span>
<a href="#l30.5"></a><span id="l30.5">     /* Get the field description, and add it as an anonymous attr? */</span>
<a href="#l30.6"></a><span id="l30.6">     /* OR WHAT???? */</span>
<a href="#l30.7"></a><span id="l30.7">     {</span>
<a href="#l30.8"></a><span id="l30.8">       rv = NS_ERROR_FAILURE;</span>
<a href="#l30.9"></a><span id="l30.9">     }</span>
<a href="#l30.10"></a><span id="l30.10">   }</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-  NS_Free(pVal);</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+  free(pVal);</span>
<a href="#l30.14"></a><span id="l30.14"> </span>
<a href="#l30.15"></a><span id="l30.15">   return rv;</span>
<a href="#l30.16"></a><span id="l30.16"> }</span>
<a href="#l30.17"></a><span id="l30.17"> </span>
<a href="#l30.18"></a><span id="l30.18"> </span>
<a href="#l30.19"></a><span id="l30.19"> nsresult nsImportFieldMap::Allocate(int32_t newSize)</span>
<a href="#l30.20"></a><span id="l30.20"> {</span>
<a href="#l30.21"></a><span id="l30.21">   if (newSize &lt;= m_allocated)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mailnews/import/src/nsImportMail.cpp</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mailnews/import/src/nsImportMail.cpp</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -564,17 +564,17 @@ void nsImportGenericMail::ReportError(in</span>
<a href="#l31.4"></a><span id="l31.4">   if (!pStream)</span>
<a href="#l31.5"></a><span id="l31.5">     return;</span>
<a href="#l31.6"></a><span id="l31.6"> </span>
<a href="#l31.7"></a><span id="l31.7">   // load the error string</span>
<a href="#l31.8"></a><span id="l31.8">   char16_t *pFmt = nsImportStringBundle::GetStringByID(id, aBundle);</span>
<a href="#l31.9"></a><span id="l31.9">   nsString pText;</span>
<a href="#l31.10"></a><span id="l31.10">   nsTextFormatter::ssprintf(pText, pFmt, pName);</span>
<a href="#l31.11"></a><span id="l31.11">   pStream-&gt;Append(pText);</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-  NS_Free(pFmt);</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+  free(pFmt);</span>
<a href="#l31.14"></a><span id="l31.14">   pStream-&gt;Append(NS_ConvertASCIItoUTF16(MSG_LINEBREAK));</span>
<a href="#l31.15"></a><span id="l31.15"> }</span>
<a href="#l31.16"></a><span id="l31.16"> </span>
<a href="#l31.17"></a><span id="l31.17"> </span>
<a href="#l31.18"></a><span id="l31.18"> void nsImportGenericMail::SetLogs(nsString&amp; success, nsString&amp; error, nsISupportsString *pSuccess, nsISupportsString *pError)</span>
<a href="#l31.19"></a><span id="l31.19"> {</span>
<a href="#l31.20"></a><span id="l31.20">     nsAutoString str;</span>
<a href="#l31.21"></a><span id="l31.21">     if (pSuccess) {</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineat">@@ -739,17 +739,17 @@ ImportMailThread(void *stuff)</span>
<a href="#l31.23"></a><span id="l31.23">           break;</span>
<a href="#l31.24"></a><span id="l31.24">         }</span>
<a href="#l31.25"></a><span id="l31.25">       }</span>
<a href="#l31.26"></a><span id="l31.26">       depth = newDepth;</span>
<a href="#l31.27"></a><span id="l31.27">       pName = nullptr;</span>
<a href="#l31.28"></a><span id="l31.28">       box-&gt;GetDisplayName(&amp;pName);</span>
<a href="#l31.29"></a><span id="l31.29">       if (pName) {</span>
<a href="#l31.30"></a><span id="l31.30">         lastName = pName;</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineminus">-        NS_Free(pName);</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+        free(pName);</span>
<a href="#l31.33"></a><span id="l31.33">       }</span>
<a href="#l31.34"></a><span id="l31.34">       else</span>
<a href="#l31.35"></a><span id="l31.35">         lastName.AssignLiteral(&quot;Unknown!&quot;);</span>
<a href="#l31.36"></a><span id="l31.36"> </span>
<a href="#l31.37"></a><span id="l31.37">       // translate the folder name if we are doing migration, but</span>
<a href="#l31.38"></a><span id="l31.38">       // only for special folders which are at the root level</span>
<a href="#l31.39"></a><span id="l31.39">       if (pData-&gt;performingMigration &amp;&amp; depth == 1)</span>
<a href="#l31.40"></a><span id="l31.40">         pData-&gt;mailImport-&gt;TranslateFolderName(lastName, lastName);</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineat">@@ -781,21 +781,21 @@ ImportMailThread(void *stuff)</span>
<a href="#l31.42"></a><span id="l31.42">       if (size &amp;&amp; import &amp;&amp; newFolder &amp;&amp; NS_SUCCEEDED(rv)) {</span>
<a href="#l31.43"></a><span id="l31.43">         bool fatalError = false;</span>
<a href="#l31.44"></a><span id="l31.44">         pData-&gt;currentSize = size;</span>
<a href="#l31.45"></a><span id="l31.45">         char16_t *pSuccess = nullptr;</span>
<a href="#l31.46"></a><span id="l31.46">         char16_t *pError = nullptr;</span>
<a href="#l31.47"></a><span id="l31.47">         rv = pData-&gt;mailImport-&gt;ImportMailbox(box, newFolder, &amp;pError, &amp;pSuccess, &amp;fatalError);</span>
<a href="#l31.48"></a><span id="l31.48">         if (pError) {</span>
<a href="#l31.49"></a><span id="l31.49">           error.Append(pError);</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineminus">-          NS_Free(pError);</span>
<a href="#l31.51"></a><span id="l31.51" class="difflineplus">+          free(pError);</span>
<a href="#l31.52"></a><span id="l31.52">         }</span>
<a href="#l31.53"></a><span id="l31.53">         if (pSuccess) {</span>
<a href="#l31.54"></a><span id="l31.54">           success.Append(pSuccess);</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineminus">-          NS_Free(pSuccess);</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineplus">+          free(pSuccess);</span>
<a href="#l31.57"></a><span id="l31.57">         }</span>
<a href="#l31.58"></a><span id="l31.58"> </span>
<a href="#l31.59"></a><span id="l31.59">         pData-&gt;currentSize = 0;</span>
<a href="#l31.60"></a><span id="l31.60">         pData-&gt;currentTotal += size;</span>
<a href="#l31.61"></a><span id="l31.61">         </span>
<a href="#l31.62"></a><span id="l31.62">         // commit to the db synchronously, but using a proxy since it doesn't like being used</span>
<a href="#l31.63"></a><span id="l31.63">         // elsewhere than from the main thread.</span>
<a href="#l31.64"></a><span id="l31.64">         // OK, we've copied the actual folder/file over if the folder size is not 0</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mailnews/import/text/src/nsTextImport.cpp</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mailnews/import/text/src/nsTextImport.cpp</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -326,32 +326,32 @@ void ImportAddressImpl::ReportSuccess(ns</span>
<a href="#l32.4"></a><span id="l32.4"> </span>
<a href="#l32.5"></a><span id="l32.5">   // load the success string</span>
<a href="#l32.6"></a><span id="l32.6">   char16_t *pFmt =</span>
<a href="#l32.7"></a><span id="l32.7">     nsImportStringBundle::GetStringByID(TEXTIMPORT_ADDRESS_SUCCESS, pBundle);</span>
<a href="#l32.8"></a><span id="l32.8"> </span>
<a href="#l32.9"></a><span id="l32.9">   nsString pText;</span>
<a href="#l32.10"></a><span id="l32.10">   nsTextFormatter::ssprintf(pText, pFmt, name.get());</span>
<a href="#l32.11"></a><span id="l32.11">   pStream-&gt;Append(pText);</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-  NS_Free(pFmt);</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+  free(pFmt);</span>
<a href="#l32.14"></a><span id="l32.14">   pStream-&gt;Append(char16_t('\n'));</span>
<a href="#l32.15"></a><span id="l32.15"> }</span>
<a href="#l32.16"></a><span id="l32.16"> </span>
<a href="#l32.17"></a><span id="l32.17"> void ImportAddressImpl::ReportError(int32_t errorNum, nsString&amp; name,</span>
<a href="#l32.18"></a><span id="l32.18">                                     nsString *pStream, nsIStringBundle* pBundle)</span>
<a href="#l32.19"></a><span id="l32.19"> {</span>
<a href="#l32.20"></a><span id="l32.20">   if (!pStream)</span>
<a href="#l32.21"></a><span id="l32.21">     return;</span>
<a href="#l32.22"></a><span id="l32.22"> </span>
<a href="#l32.23"></a><span id="l32.23">   // load the error string</span>
<a href="#l32.24"></a><span id="l32.24">   char16_t *pFmt = nsImportStringBundle::GetStringByID(errorNum, pBundle);</span>
<a href="#l32.25"></a><span id="l32.25">   nsString pText;</span>
<a href="#l32.26"></a><span id="l32.26">   nsTextFormatter::ssprintf(pText, pFmt, name.get());</span>
<a href="#l32.27"></a><span id="l32.27">   pStream-&gt;Append(pText);</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineminus">-  NS_Free(pFmt);</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineplus">+  free(pFmt);</span>
<a href="#l32.30"></a><span id="l32.30">   pStream-&gt;Append(char16_t('\n'));</span>
<a href="#l32.31"></a><span id="l32.31"> }</span>
<a href="#l32.32"></a><span id="l32.32"> </span>
<a href="#l32.33"></a><span id="l32.33"> void ImportAddressImpl::SetLogs(nsString&amp; success, nsString&amp; error, char16_t **pError, char16_t **pSuccess)</span>
<a href="#l32.34"></a><span id="l32.34"> {</span>
<a href="#l32.35"></a><span id="l32.35">   if (pError)</span>
<a href="#l32.36"></a><span id="l32.36">     *pError = ToNewUnicode(error);</span>
<a href="#l32.37"></a><span id="l32.37">   if (pSuccess)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mailnews/import/vcard/src/nsVCardImport.cpp</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mailnews/import/vcard/src/nsVCardImport.cpp</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -286,33 +286,33 @@ void ImportVCardAddressImpl::ReportSucce</span>
<a href="#l33.4"></a><span id="l33.4"> </span>
<a href="#l33.5"></a><span id="l33.5">   // load the success string</span>
<a href="#l33.6"></a><span id="l33.6">   char16_t *pFmt = nsImportStringBundle::GetStringByName(</span>
<a href="#l33.7"></a><span id="l33.7">       &quot;vCardImportAddressSuccess&quot;, pBundle);</span>
<a href="#l33.8"></a><span id="l33.8"> </span>
<a href="#l33.9"></a><span id="l33.9">   nsString pText;</span>
<a href="#l33.10"></a><span id="l33.10">   nsTextFormatter::ssprintf(pText, pFmt, name.get());</span>
<a href="#l33.11"></a><span id="l33.11">   pStream-&gt;Append(pText);</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-  NS_Free(pFmt);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+  free(pFmt);</span>
<a href="#l33.14"></a><span id="l33.14">   pStream-&gt;Append(char16_t('\n'));</span>
<a href="#l33.15"></a><span id="l33.15"> }</span>
<a href="#l33.16"></a><span id="l33.16"> </span>
<a href="#l33.17"></a><span id="l33.17"> void ImportVCardAddressImpl::ReportError(</span>
<a href="#l33.18"></a><span id="l33.18">     const char *errorName, nsString&amp; name, nsString *pStream,</span>
<a href="#l33.19"></a><span id="l33.19">     nsIStringBundle* pBundle)</span>
<a href="#l33.20"></a><span id="l33.20"> {</span>
<a href="#l33.21"></a><span id="l33.21">   if (!pStream)</span>
<a href="#l33.22"></a><span id="l33.22">     return;</span>
<a href="#l33.23"></a><span id="l33.23"> </span>
<a href="#l33.24"></a><span id="l33.24">   // load the error string</span>
<a href="#l33.25"></a><span id="l33.25">   char16_t *pFmt = nsImportStringBundle::GetStringByName(errorName, pBundle);</span>
<a href="#l33.26"></a><span id="l33.26">   nsString pText;</span>
<a href="#l33.27"></a><span id="l33.27">   nsTextFormatter::ssprintf(pText, pFmt, name.get());</span>
<a href="#l33.28"></a><span id="l33.28">   pStream-&gt;Append(pText);</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-  NS_Free(pFmt);</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineplus">+  free(pFmt);</span>
<a href="#l33.31"></a><span id="l33.31">   pStream-&gt;Append(char16_t('\n'));</span>
<a href="#l33.32"></a><span id="l33.32"> }</span>
<a href="#l33.33"></a><span id="l33.33"> </span>
<a href="#l33.34"></a><span id="l33.34"> void ImportVCardAddressImpl::SetLogs(</span>
<a href="#l33.35"></a><span id="l33.35">     nsString&amp; success, nsString&amp; error,</span>
<a href="#l33.36"></a><span id="l33.36">     char16_t **pError, char16_t **pSuccess)</span>
<a href="#l33.37"></a><span id="l33.37"> { </span>
<a href="#l33.38"></a><span id="l33.38">   if (pError) </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mailnews/local/src/nsMsgMaildirStore.cpp</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mailnews/local/src/nsMsgMaildirStore.cpp</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1209,17 +1209,17 @@ nsresult MaildirStoreParser::ParseNextMe</span>
<a href="#l34.4"></a><span id="l34.4">     // from the file size. So we can do this in one time slice.</span>
<a href="#l34.5"></a><span id="l34.5">     do</span>
<a href="#l34.6"></a><span id="l34.6">     {</span>
<a href="#l34.7"></a><span id="l34.7">       newLine = inputStreamBuffer-&gt;ReadNextLine(inputStream, numBytesInLine,</span>
<a href="#l34.8"></a><span id="l34.8">                                                 needMoreData);</span>
<a href="#l34.9"></a><span id="l34.9">       if (newLine)</span>
<a href="#l34.10"></a><span id="l34.10">       {</span>
<a href="#l34.11"></a><span id="l34.11">         msgParser-&gt;ParseAFolderLine(newLine, numBytesInLine);</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-        NS_Free(newLine);</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+        free(newLine);</span>
<a href="#l34.14"></a><span id="l34.14">       }</span>
<a href="#l34.15"></a><span id="l34.15">     } while (newLine &amp;&amp; numBytesInLine &gt; 0);</span>
<a href="#l34.16"></a><span id="l34.16"> </span>
<a href="#l34.17"></a><span id="l34.17">     msgParser-&gt;FinishHeader();</span>
<a href="#l34.18"></a><span id="l34.18">     // A single message needs to be less than 4GB</span>
<a href="#l34.19"></a><span id="l34.19">     newMsgHdr-&gt;SetMessageSize((uint32_t) fileSize);</span>
<a href="#l34.20"></a><span id="l34.20">     m_db-&gt;AddNewHdrToDB(newMsgHdr, true);</span>
<a href="#l34.21"></a><span id="l34.21">     nsAutoCString storeToken;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mailnews/mime/cthandlers/glue/nsMimeContentTypeHandler.cpp</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -24,17 +24,17 @@ nsMimeContentTypeHandler::nsMimeContentT</span>
<a href="#l35.4"></a><span id="l35.4">   NS_ASSERTION(callback, &quot;nsMimeContentTypeHandler should be initialized with non-null callback&quot;);</span>
<a href="#l35.5"></a><span id="l35.5">   mimeType = PL_strdup(aMimeType);</span>
<a href="#l35.6"></a><span id="l35.6">   realCreateContentTypeHandlerClass = callback;</span>
<a href="#l35.7"></a><span id="l35.7"> }</span>
<a href="#l35.8"></a><span id="l35.8"> </span>
<a href="#l35.9"></a><span id="l35.9"> nsMimeContentTypeHandler::~nsMimeContentTypeHandler(void)</span>
<a href="#l35.10"></a><span id="l35.10"> {</span>
<a href="#l35.11"></a><span id="l35.11">   if (mimeType) {</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-    NS_Free(mimeType);</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+    free(mimeType);</span>
<a href="#l35.14"></a><span id="l35.14">     mimeType = 0;</span>
<a href="#l35.15"></a><span id="l35.15">   }</span>
<a href="#l35.16"></a><span id="l35.16">   realCreateContentTypeHandlerClass = 0;</span>
<a href="#l35.17"></a><span id="l35.17"> }</span>
<a href="#l35.18"></a><span id="l35.18"> </span>
<a href="#l35.19"></a><span id="l35.19"> // Get the content type if necessary</span>
<a href="#l35.20"></a><span id="l35.20"> nsresult</span>
<a href="#l35.21"></a><span id="l35.21"> nsMimeContentTypeHandler::GetContentType(char **contentType)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mailnews/mime/emitters/nsMimeBaseEmitter.cpp</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mailnews/mime/emitters/nsMimeBaseEmitter.cpp</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -100,17 +100,17 @@ nsMimeBaseEmitter::~nsMimeBaseEmitter(vo</span>
<a href="#l36.4"></a><span id="l36.4">     for (size_t i = 0; i &lt; mAttachArray-&gt;Length(); i++)</span>
<a href="#l36.5"></a><span id="l36.5">     {</span>
<a href="#l36.6"></a><span id="l36.6">       attachmentInfoType *attachInfo = mAttachArray-&gt;ElementAt(i);</span>
<a href="#l36.7"></a><span id="l36.7">       if (!attachInfo)</span>
<a href="#l36.8"></a><span id="l36.8">         continue;</span>
<a href="#l36.9"></a><span id="l36.9"> </span>
<a href="#l36.10"></a><span id="l36.10">       PR_FREEIF(attachInfo-&gt;contentType);</span>
<a href="#l36.11"></a><span id="l36.11">       if (attachInfo-&gt;displayName)</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-        NS_Free(attachInfo-&gt;displayName);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+        free(attachInfo-&gt;displayName);</span>
<a href="#l36.14"></a><span id="l36.14">       PR_FREEIF(attachInfo-&gt;urlSpec);</span>
<a href="#l36.15"></a><span id="l36.15">       PR_FREEIF(attachInfo);</span>
<a href="#l36.16"></a><span id="l36.16">     }</span>
<a href="#l36.17"></a><span id="l36.17">     delete mAttachArray;</span>
<a href="#l36.18"></a><span id="l36.18">   }</span>
<a href="#l36.19"></a><span id="l36.19"> </span>
<a href="#l36.20"></a><span id="l36.20">   // Cleanup allocated header arrays...</span>
<a href="#l36.21"></a><span id="l36.21">   CleanupHeaderArray(mHeaderArray);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mailnews/mime/emitters/nsMimeXmlEmitter.cpp</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mailnews/mime/emitters/nsMimeXmlEmitter.cpp</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -105,17 +105,17 @@ nsMimeXmlEmitter::WriteXMLTag(const char</span>
<a href="#l37.4"></a><span id="l37.4">   UtilityWrite(&quot;: &quot;);</span>
<a href="#l37.5"></a><span id="l37.5">   UtilityWrite(&quot;&lt;/headerdisplayname&gt;&quot;);</span>
<a href="#l37.6"></a><span id="l37.6"> </span>
<a href="#l37.7"></a><span id="l37.7">   // Now write out the actual value itself and move on!</span>
<a href="#l37.8"></a><span id="l37.8">   //</span>
<a href="#l37.9"></a><span id="l37.9">   UtilityWrite(newValue.get());</span>
<a href="#l37.10"></a><span id="l37.10">   UtilityWrite(&quot;&lt;/header&gt;&quot;);</span>
<a href="#l37.11"></a><span id="l37.11"> </span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-  NS_Free(upCaseTag);</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+  free(upCaseTag);</span>
<a href="#l37.14"></a><span id="l37.14"> </span>
<a href="#l37.15"></a><span id="l37.15">   return NS_OK;</span>
<a href="#l37.16"></a><span id="l37.16"> }</span>
<a href="#l37.17"></a><span id="l37.17"> </span>
<a href="#l37.18"></a><span id="l37.18"> // Header handling routines.</span>
<a href="#l37.19"></a><span id="l37.19"> nsresult</span>
<a href="#l37.20"></a><span id="l37.20"> nsMimeXmlEmitter::StartHeader(bool rootMailHeader, bool headerOnly, const char *msgID,</span>
<a href="#l37.21"></a><span id="l37.21">                            const char *outCharset)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/mime/src/mimemoz2.cpp</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/mime/src/mimemoz2.cpp</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -953,20 +953,20 @@ mime_display_stream_complete (nsMIMESess</span>
<a href="#l38.4"></a><span id="l38.4">       msd-&gt;options = 0;</span>
<a href="#l38.5"></a><span id="l38.5">     }</span>
<a href="#l38.6"></a><span id="l38.6">   }</span>
<a href="#l38.7"></a><span id="l38.7"> </span>
<a href="#l38.8"></a><span id="l38.8">   if (msd-&gt;headers)</span>
<a href="#l38.9"></a><span id="l38.9">     MimeHeaders_free (msd-&gt;headers);</span>
<a href="#l38.10"></a><span id="l38.10"> </span>
<a href="#l38.11"></a><span id="l38.11">   if (msd-&gt;url_name)</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-    NS_Free(msd-&gt;url_name);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+    free(msd-&gt;url_name);</span>
<a href="#l38.14"></a><span id="l38.14"> </span>
<a href="#l38.15"></a><span id="l38.15">   if (msd-&gt;orig_url_name)</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineminus">-      NS_Free(msd-&gt;orig_url_name);</span>
<a href="#l38.17"></a><span id="l38.17" class="difflineplus">+      free(msd-&gt;orig_url_name);</span>
<a href="#l38.18"></a><span id="l38.18"> </span>
<a href="#l38.19"></a><span id="l38.19">   delete msd;</span>
<a href="#l38.20"></a><span id="l38.20"> }</span>
<a href="#l38.21"></a><span id="l38.21"> </span>
<a href="#l38.22"></a><span id="l38.22"> extern &quot;C&quot; void</span>
<a href="#l38.23"></a><span id="l38.23"> mime_display_stream_abort (nsMIMESession *stream, int status)</span>
<a href="#l38.24"></a><span id="l38.24"> {</span>
<a href="#l38.25"></a><span id="l38.25">   mime_stream_data *msd = (mime_stream_data *) ((nsMIMESession *)stream)-&gt;data_object;</span>
<a href="#l38.26"></a><span id="l38.26" class="difflineat">@@ -988,20 +988,20 @@ mime_display_stream_abort (nsMIMESession</span>
<a href="#l38.27"></a><span id="l38.27">       msd-&gt;options = 0;</span>
<a href="#l38.28"></a><span id="l38.28">     }</span>
<a href="#l38.29"></a><span id="l38.29">   }</span>
<a href="#l38.30"></a><span id="l38.30"> </span>
<a href="#l38.31"></a><span id="l38.31">   if (msd-&gt;headers)</span>
<a href="#l38.32"></a><span id="l38.32">     MimeHeaders_free (msd-&gt;headers);</span>
<a href="#l38.33"></a><span id="l38.33"> </span>
<a href="#l38.34"></a><span id="l38.34">   if (msd-&gt;url_name)</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineminus">-    NS_Free(msd-&gt;url_name);</span>
<a href="#l38.36"></a><span id="l38.36" class="difflineplus">+    free(msd-&gt;url_name);</span>
<a href="#l38.37"></a><span id="l38.37"> </span>
<a href="#l38.38"></a><span id="l38.38">   if (msd-&gt;orig_url_name)</span>
<a href="#l38.39"></a><span id="l38.39" class="difflineminus">-      NS_Free(msd-&gt;orig_url_name);</span>
<a href="#l38.40"></a><span id="l38.40" class="difflineplus">+      free(msd-&gt;orig_url_name);</span>
<a href="#l38.41"></a><span id="l38.41"> </span>
<a href="#l38.42"></a><span id="l38.42">   delete msd;</span>
<a href="#l38.43"></a><span id="l38.43"> }</span>
<a href="#l38.44"></a><span id="l38.44"> </span>
<a href="#l38.45"></a><span id="l38.45"> static int</span>
<a href="#l38.46"></a><span id="l38.46"> mime_output_init_fn (const char *type,</span>
<a href="#l38.47"></a><span id="l38.47">                      const char *charset,</span>
<a href="#l38.48"></a><span id="l38.48">                      const char *name,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/mime/src/nsStreamConverter.cpp</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/mime/src/nsStreamConverter.cpp</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -198,17 +198,17 @@ bridge_new_new_uri(void *bridgeStream, n</span>
<a href="#l39.4"></a><span id="l39.4">             }</span>
<a href="#l39.5"></a><span id="l39.5">           }</span>
<a href="#l39.6"></a><span id="l39.6">         }</span>
<a href="#l39.7"></a><span id="l39.7">         nsAutoCString urlString;</span>
<a href="#l39.8"></a><span id="l39.8">         if (NS_SUCCEEDED(aURI-&gt;GetSpec(urlString)))</span>
<a href="#l39.9"></a><span id="l39.9">         {</span>
<a href="#l39.10"></a><span id="l39.10">           if (!urlString.IsEmpty())</span>
<a href="#l39.11"></a><span id="l39.11">           {</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-            NS_Free(*url_name);</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+            free(*url_name);</span>
<a href="#l39.14"></a><span id="l39.14">             *url_name = ToNewCString(urlString);</span>
<a href="#l39.15"></a><span id="l39.15">             if (!(*url_name))</span>
<a href="#l39.16"></a><span id="l39.16">               return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l39.17"></a><span id="l39.17"> </span>
<a href="#l39.18"></a><span id="l39.18">             // rhp: Ugh, this is ugly...but it works.</span>
<a href="#l39.19"></a><span id="l39.19">             if (fixup_pointer)</span>
<a href="#l39.20"></a><span id="l39.20">               *fixup_pointer = (const char *)*url_name;</span>
<a href="#l39.21"></a><span id="l39.21">           }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -571,31 +571,31 @@ nsNetscapeProfileMigratorBase::WriteBran</span>
<a href="#l40.4"></a><span id="l40.4"> </span>
<a href="#l40.5"></a><span id="l40.5">   uint32_t count = aPrefs.Length();</span>
<a href="#l40.6"></a><span id="l40.6">   for (uint32_t i = 0; i &lt; count; ++i) {</span>
<a href="#l40.7"></a><span id="l40.7">     PrefBranchStruct* pref = aPrefs.ElementAt(i);</span>
<a href="#l40.8"></a><span id="l40.8"> </span>
<a href="#l40.9"></a><span id="l40.9">     switch (pref-&gt;type) {</span>
<a href="#l40.10"></a><span id="l40.10">     case nsIPrefBranch::PREF_STRING:</span>
<a href="#l40.11"></a><span id="l40.11">       branch-&gt;SetCharPref(pref-&gt;prefName, pref-&gt;stringValue);</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-      NS_Free(pref-&gt;stringValue);</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+      free(pref-&gt;stringValue);</span>
<a href="#l40.14"></a><span id="l40.14">       pref-&gt;stringValue = nullptr;</span>
<a href="#l40.15"></a><span id="l40.15">       break;</span>
<a href="#l40.16"></a><span id="l40.16">     case nsIPrefBranch::PREF_BOOL:</span>
<a href="#l40.17"></a><span id="l40.17">       branch-&gt;SetBoolPref(pref-&gt;prefName, pref-&gt;boolValue);</span>
<a href="#l40.18"></a><span id="l40.18">       break;</span>
<a href="#l40.19"></a><span id="l40.19">     case nsIPrefBranch::PREF_INT:</span>
<a href="#l40.20"></a><span id="l40.20">       branch-&gt;SetIntPref(pref-&gt;prefName, pref-&gt;intValue);</span>
<a href="#l40.21"></a><span id="l40.21">       break;</span>
<a href="#l40.22"></a><span id="l40.22">     default:</span>
<a href="#l40.23"></a><span id="l40.23">       NS_WARNING(&quot;Invalid Pref Type in &quot;</span>
<a href="#l40.24"></a><span id="l40.24">                  &quot;nsNetscapeProfileMigratorBase::WriteBranch\n&quot;);</span>
<a href="#l40.25"></a><span id="l40.25">       break;</span>
<a href="#l40.26"></a><span id="l40.26">     }</span>
<a href="#l40.27"></a><span id="l40.27" class="difflineminus">-    NS_Free(pref-&gt;prefName);</span>
<a href="#l40.28"></a><span id="l40.28" class="difflineplus">+    free(pref-&gt;prefName);</span>
<a href="#l40.29"></a><span id="l40.29">     pref-&gt;prefName = nullptr;</span>
<a href="#l40.30"></a><span id="l40.30">     delete pref;</span>
<a href="#l40.31"></a><span id="l40.31">     pref = nullptr;</span>
<a href="#l40.32"></a><span id="l40.32">   }</span>
<a href="#l40.33"></a><span id="l40.33">   aPrefs.Clear();</span>
<a href="#l40.34"></a><span id="l40.34"> }</span>
<a href="#l40.35"></a><span id="l40.35"> </span>
<a href="#l40.36"></a><span id="l40.36"> nsresult</span>
<a href="#l40.37"></a><span id="l40.37" class="difflineat">@@ -799,17 +799,17 @@ nsNetscapeProfileMigratorBase::CopySigna</span>
<a href="#l40.38"></a><span id="l40.38">         srcSigFile-&gt;CopyTo(targetSigFile, leafName);</span>
<a href="#l40.39"></a><span id="l40.39">         targetSigFile-&gt;Append(leafName);</span>
<a href="#l40.40"></a><span id="l40.40"> </span>
<a href="#l40.41"></a><span id="l40.41">         // now write out the new descriptor</span>
<a href="#l40.42"></a><span id="l40.42">         nsAutoCString descriptorString;</span>
<a href="#l40.43"></a><span id="l40.43">         rv = targetSigFile-&gt;GetPersistentDescriptor(descriptorString);</span>
<a href="#l40.44"></a><span id="l40.44">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l40.45"></a><span id="l40.45"> </span>
<a href="#l40.46"></a><span id="l40.46" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l40.47"></a><span id="l40.47" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l40.48"></a><span id="l40.48">         pref-&gt;stringValue = ToNewCString(descriptorString);</span>
<a href="#l40.49"></a><span id="l40.49">       }</span>
<a href="#l40.50"></a><span id="l40.50">     }</span>
<a href="#l40.51"></a><span id="l40.51">   }</span>
<a href="#l40.52"></a><span id="l40.52">   return NS_OK;</span>
<a href="#l40.53"></a><span id="l40.53"> }</span>
<a href="#l40.54"></a><span id="l40.54"> </span>
<a href="#l40.55"></a><span id="l40.55"> nsresult</span>
<a href="#l40.56"></a><span id="l40.56" class="difflineat">@@ -889,17 +889,17 @@ nsNetscapeProfileMigratorBase::CopyMailF</span>
<a href="#l40.57"></a><span id="l40.57">         RecursiveCopy(sourceMailFolder, targetMailFolder);</span>
<a href="#l40.58"></a><span id="l40.58">         // now we want to make sure the actual directory pref that gets</span>
<a href="#l40.59"></a><span id="l40.59">         // transformed into the new profile's pref.js has the right file</span>
<a href="#l40.60"></a><span id="l40.60">         // location.</span>
<a href="#l40.61"></a><span id="l40.61">         nsAutoCString descriptorString;</span>
<a href="#l40.62"></a><span id="l40.62">         rv = targetMailFolder-&gt;GetPersistentDescriptor(descriptorString);</span>
<a href="#l40.63"></a><span id="l40.63">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l40.64"></a><span id="l40.64"> </span>
<a href="#l40.65"></a><span id="l40.65" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l40.66"></a><span id="l40.66" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l40.67"></a><span id="l40.67">         pref-&gt;stringValue = ToNewCString(descriptorString);</span>
<a href="#l40.68"></a><span id="l40.68">       }</span>
<a href="#l40.69"></a><span id="l40.69">     }</span>
<a href="#l40.70"></a><span id="l40.70">     else if (StringEndsWith(prefName, NS_LITERAL_CSTRING(&quot;.newsrc.file&quot;))) {</span>
<a href="#l40.71"></a><span id="l40.71">       // copy the news RC file into \News. this won't work if the user has</span>
<a href="#l40.72"></a><span id="l40.72">       // different newsrc files for each account I don't know what to do in</span>
<a href="#l40.73"></a><span id="l40.73">       // that situation.</span>
<a href="#l40.74"></a><span id="l40.74">       nsCOMPtr&lt;nsIFile&gt; targetNewsRCFile;</span>
<a href="#l40.75"></a><span id="l40.75" class="difflineat">@@ -923,31 +923,31 @@ nsNetscapeProfileMigratorBase::CopyMailF</span>
<a href="#l40.76"></a><span id="l40.76">         srcNewsRCFile-&gt;CopyTo(targetNewsRCFile,leafName);</span>
<a href="#l40.77"></a><span id="l40.77">         targetNewsRCFile-&gt;Append(leafName);</span>
<a href="#l40.78"></a><span id="l40.78"> </span>
<a href="#l40.79"></a><span id="l40.79">         // now write out the new descriptor</span>
<a href="#l40.80"></a><span id="l40.80">         nsAutoCString descriptorString;</span>
<a href="#l40.81"></a><span id="l40.81">         rv = targetNewsRCFile-&gt;GetPersistentDescriptor(descriptorString);</span>
<a href="#l40.82"></a><span id="l40.82">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l40.83"></a><span id="l40.83"> </span>
<a href="#l40.84"></a><span id="l40.84" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l40.85"></a><span id="l40.85" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l40.86"></a><span id="l40.86">         pref-&gt;stringValue = ToNewCString(descriptorString);</span>
<a href="#l40.87"></a><span id="l40.87">       }</span>
<a href="#l40.88"></a><span id="l40.88">     }</span>
<a href="#l40.89"></a><span id="l40.89">   }</span>
<a href="#l40.90"></a><span id="l40.90"> </span>
<a href="#l40.91"></a><span id="l40.91">   // Remove all .directory-rel prefs as those might have changed; MailNews</span>
<a href="#l40.92"></a><span id="l40.92">   // will create those prefs again on first use</span>
<a href="#l40.93"></a><span id="l40.93">   for (int32_t i = count; i-- &gt; 0; ) {</span>
<a href="#l40.94"></a><span id="l40.94">     PrefBranchStruct* pref = aMailServers.ElementAt(i);</span>
<a href="#l40.95"></a><span id="l40.95">     nsDependentCString prefName(pref-&gt;prefName);</span>
<a href="#l40.96"></a><span id="l40.96"> </span>
<a href="#l40.97"></a><span id="l40.97">     if (StringEndsWith(prefName, NS_LITERAL_CSTRING(&quot;.directory-rel&quot;))) {</span>
<a href="#l40.98"></a><span id="l40.98">       if (pref-&gt;type == nsIPrefBranch::PREF_STRING)</span>
<a href="#l40.99"></a><span id="l40.99" class="difflineminus">-        NS_Free(pref-&gt;stringValue);</span>
<a href="#l40.100"></a><span id="l40.100" class="difflineplus">+        free(pref-&gt;stringValue);</span>
<a href="#l40.101"></a><span id="l40.101"> </span>
<a href="#l40.102"></a><span id="l40.102">       aMailServers.RemoveElementAt(i);</span>
<a href="#l40.103"></a><span id="l40.103">     }</span>
<a href="#l40.104"></a><span id="l40.104">   }</span>
<a href="#l40.105"></a><span id="l40.105"> </span>
<a href="#l40.106"></a><span id="l40.106">   return NS_OK;</span>
<a href="#l40.107"></a><span id="l40.107"> }</span>
<a href="#l40.108"></a><span id="l40.108"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

