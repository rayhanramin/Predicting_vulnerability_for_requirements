<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 23189:9cc46d0b8df3d27df8d7fc8fcc8c965139241c80</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 9cc46d0b8df3d27df8d7fc8fcc8c965139241c80" />
<meta property="og:url" content="/comm-central/rev/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80" />
<meta property="og:description" content="Bug 1431954 - remove usage of arguments and arguments.callee in c-c. r=arai" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 9cc46d0b8df3d27df8d7fc8fcc8c965139241c80 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">shortlog</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">files</a> |
changeset |
<a href="/comm-central/raw-rev/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">raw</a>  | <a href="/comm-central/archive/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1431954">Bug 1431954</a> - remove usage of arguments and arguments.callee in c-c. r=arai
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#97;&#99;&#101;&#109;&#97;&#110;&#32;&#60;&#97;&#99;&#101;&#108;&#105;&#115;&#116;&#115;&#64;&#97;&#116;&#108;&#97;&#115;&#46;&#115;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 27 Jan 2018 10:35:00 +0100</td></tr>

<tr>
 <td>changeset 23189</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">9cc46d0b8df3d27df8d7fc8fcc8c965139241c80</a></td>
</tr>



<tr>
<td>parent 23188</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b9d00bd94c1071ad1e4323709f2785c5a77c26ed">b9d00bd94c1071ad1e4323709f2785c5a77c26ed</a>
</td>
</tr>

<tr>
<td>child 23190</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/97c3241c0c25883b70242f6519383b8f6ee27912">97c3241c0c25883b70242f6519383b8f6ee27912</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">14020</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Sat, 27 Jan 2018 20:03:07 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@9cc46d0b8df3 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=9cc46d0b8df3d27df8d7fc8fcc8c965139241c80">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=9cc46d0b8df3d27df8d7fc8fcc8c965139241c80&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9cc46d0b8df3d27df8d7fc8fcc8c965139241c80&newProject=comm-central&newRevision=b9d00bd94c1071ad1e4323709f2785c5a77c26ed&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9cc46d0b8df3d27df8d7fc8fcc8c965139241c80&newProject=comm-central&newRevision=b9d00bd94c1071ad1e4323709f2785c5a77c26ed&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9cc46d0b8df3d27df8d7fc8fcc8c965139241c80&newProject=comm-central&newRevision=b9d00bd94c1071ad1e4323709f2785c5a77c26ed&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28arai%29&revcount=50">arai</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1431954">1431954</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1431954">Bug 1431954</a> - remove usage of arguments and arguments.callee in c-c. r=arai</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/base/test/unit/resources/viewWrapperTestUtils.js">mail/base/test/unit/resources/viewWrapperTestUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/base/test/unit/resources/viewWrapperTestUtils.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/base/test/unit/resources/viewWrapperTestUtils.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/base/test/unit/resources/viewWrapperTestUtils.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/base/test/unit/resources/viewWrapperTestUtils.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/base/test/unit/resources/viewWrapperTestUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/accountcreation/content/util.js">mail/components/accountcreation/content/util.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/accountcreation/content/util.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/accountcreation/content/util.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/accountcreation/content/util.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/accountcreation/content/util.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/accountcreation/content/util.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/activity/modules/glodaIndexer.js">mail/components/activity/modules/glodaIndexer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/activity/modules/glodaIndexer.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/activity/modules/glodaIndexer.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/activity/modules/glodaIndexer.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/activity/modules/glodaIndexer.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/activity/modules/glodaIndexer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/preferences/subdialogs.js">mail/components/preferences/subdialogs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/preferences/subdialogs.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/preferences/subdialogs.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/preferences/subdialogs.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/preferences/subdialogs.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/components/preferences/subdialogs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">mail/test/mozmill/shared-modules/test-folder-display-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js">mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-window-helpers.js">mail/test/mozmill/shared-modules/test-window-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-window-helpers.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-window-helpers.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-window-helpers.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-window-helpers.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/mozmill/shared-modules/test-window-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js">mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js">mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js">mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_jsTreeSelection.js">mailnews/base/test/unit/test_jsTreeSelection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_jsTreeSelection.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_jsTreeSelection.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_jsTreeSelection.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_jsTreeSelection.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_jsTreeSelection.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_nsMsgDBView.js">mailnews/base/test/unit/test_nsMsgDBView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_nsMsgDBView.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_nsMsgDBView.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_nsMsgDBView.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_nsMsgDBView.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/test/unit/test_nsMsgDBView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/JXON.js">mailnews/base/util/JXON.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/JXON.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/JXON.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/JXON.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/JXON.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/JXON.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/traceHelper.js">mailnews/base/util/traceHelper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/traceHelper.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/traceHelper.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/traceHelper.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/traceHelper.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/base/util/traceHelper.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/databind.js">mailnews/db/gloda/modules/databind.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/databind.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/databind.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/databind.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/databind.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/databind.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/gloda.js">mailnews/db/gloda/modules/gloda.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/gloda.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/gloda.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/gloda.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/gloda.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/gloda.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/indexer.js">mailnews/db/gloda/modules/indexer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/indexer.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/indexer.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/indexer.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/indexer.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/indexer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/log4moz.js">mailnews/db/gloda/modules/log4moz.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/log4moz.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/log4moz.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/log4moz.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/log4moz.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/log4moz.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/public.js">mailnews/db/gloda/modules/public.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/public.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/public.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/public.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/public.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/public.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/query.js">mailnews/db/gloda/modules/query.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/query.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/query.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/query.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/query.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/modules/query.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/base_gloda_content.js">mailnews/db/gloda/test/unit/base_gloda_content.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/base_gloda_content.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/base_gloda_content.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/base_gloda_content.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/base_gloda_content.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/base_gloda_content.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js">mailnews/db/gloda/test/unit/resources/glodaTestHelper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/test_index_sweep_folder.js">mailnews/db/gloda/test/unit/test_index_sweep_folder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/test_index_sweep_folder.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/test_index_sweep_folder.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/test_index_sweep_folder.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/test_index_sweep_folder.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/db/gloda/test/unit/test_index_sweep_folder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/jsmime.js">mailnews/mime/jsmime/jsmime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/jsmime.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/jsmime.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/jsmime.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/jsmime.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/jsmime.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/test/mock_date.js">mailnews/mime/jsmime/test/mock_date.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/test/mock_date.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/test/mock_date.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/test/mock_date.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/test/mock_date.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/jsmime/test/mock_date.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/src/mimeJSComponents.js">mailnews/mime/src/mimeJSComponents.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/src/mimeJSComponents.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/src/mimeJSComponents.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/src/mimeJSComponents.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/src/mimeJSComponents.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/mime/src/mimeJSComponents.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/fakeserver/nntpd.js">mailnews/test/fakeserver/nntpd.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/fakeserver/nntpd.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/fakeserver/nntpd.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/fakeserver/nntpd.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/fakeserver/nntpd.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/fakeserver/nntpd.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageGenerator.js">mailnews/test/resources/messageGenerator.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageGenerator.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageGenerator.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageGenerator.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageGenerator.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageGenerator.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageModifier.js">mailnews/test/resources/messageModifier.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageModifier.js">file</a> |
<a href="/comm-central/annotate/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageModifier.js">annotate</a> |
<a href="/comm-central/diff/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageModifier.js">diff</a> |
<a href="/comm-central/comparison/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageModifier.js">comparison</a> |
<a href="/comm-central/log/9cc46d0b8df3d27df8d7fc8fcc8c965139241c80/mailnews/test/resources/messageModifier.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/test/unit/resources/viewWrapperTestUtils.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/test/unit/resources/viewWrapperTestUtils.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -471,37 +471,35 @@ function verify_view_level_histogram(aEx</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5"> /**</span>
<a href="#l1.6"></a><span id="l1.6">  * Given a view wrapper and one or more view indices, verify that the row</span>
<a href="#l1.7"></a><span id="l1.7">  *  returns true for isContainer.</span>
<a href="#l1.8"></a><span id="l1.8">  *</span>
<a href="#l1.9"></a><span id="l1.9">  * @param aViewWrapper The view wrapper in question</span>
<a href="#l1.10"></a><span id="l1.10">  * @param ... View indices to check.</span>
<a href="#l1.11"></a><span id="l1.11">  */</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-function verify_view_row_at_index_is_container(aViewWrapper) {</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+function verify_view_row_at_index_is_container(aViewWrapper, ...aArgs) {</span>
<a href="#l1.14"></a><span id="l1.14">   let treeView = aViewWrapper.dbView.QueryInterface(Ci.nsITreeView);</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-  for (let iArg = 1; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-    let viewIndex = arguments[iArg];</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+  for (let viewIndex of aArgs) {</span>
<a href="#l1.18"></a><span id="l1.18">     if (!treeView.isContainer(viewIndex)) {</span>
<a href="#l1.19"></a><span id="l1.19">       dump_view_state(aViewWrapper);</span>
<a href="#l1.20"></a><span id="l1.20">       do_throw(&quot;Expected isContainer to be true at view index &quot; + viewIndex);</span>
<a href="#l1.21"></a><span id="l1.21">     }</span>
<a href="#l1.22"></a><span id="l1.22">   }</span>
<a href="#l1.23"></a><span id="l1.23"> }</span>
<a href="#l1.24"></a><span id="l1.24"> </span>
<a href="#l1.25"></a><span id="l1.25"> /**</span>
<a href="#l1.26"></a><span id="l1.26">  * Given a view wrapper and one or more view indices, verify that there is a</span>
<a href="#l1.27"></a><span id="l1.27">  *  dummy header at each provided index.</span>
<a href="#l1.28"></a><span id="l1.28">  *</span>
<a href="#l1.29"></a><span id="l1.29">  * @param aViewWrapper The view wrapper in question</span>
<a href="#l1.30"></a><span id="l1.30">  * @param ... View indices to check.</span>
<a href="#l1.31"></a><span id="l1.31">  */</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-function verify_view_row_at_index_is_dummy(aViewWrapper) {</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-  for (let iArg = 1; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-    let viewIndex = arguments[iArg];</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+function verify_view_row_at_index_is_dummy(aViewWrapper, ...aArgs) {</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+  for (let viewIndex of aArgs) {</span>
<a href="#l1.37"></a><span id="l1.37">     let flags = aViewWrapper.dbView.getFlagsAt(viewIndex);</span>
<a href="#l1.38"></a><span id="l1.38">     if (!(flags &amp; MSG_VIEW_FLAG_DUMMY)) {</span>
<a href="#l1.39"></a><span id="l1.39">       dump_view_state(aViewWrapper);</span>
<a href="#l1.40"></a><span id="l1.40">       do_throw(&quot;Expected a dummy header at view index &quot; + viewIndex);</span>
<a href="#l1.41"></a><span id="l1.41">     }</span>
<a href="#l1.42"></a><span id="l1.42">   }</span>
<a href="#l1.43"></a><span id="l1.43"> }</span>
<a href="#l1.44"></a><span id="l1.44"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/accountcreation/content/util.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/accountcreation/content/util.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -21,20 +21,17 @@ function assert(test, errorMsg)</span>
<a href="#l2.4"></a><span id="l2.4"> {</span>
<a href="#l2.5"></a><span id="l2.5">   if (!test)</span>
<a href="#l2.6"></a><span id="l2.6">     throw new NotReached(errorMsg ? errorMsg :</span>
<a href="#l2.7"></a><span id="l2.7">           &quot;Programming bug. Assertion failed, see log.&quot;);</span>
<a href="#l2.8"></a><span id="l2.8"> }</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> function makeCallback(obj, func)</span>
<a href="#l2.11"></a><span id="l2.11"> {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  return function()</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-  {</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-    return func.apply(obj, arguments);</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-  }</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+  return func.bind(obj);</span>
<a href="#l2.17"></a><span id="l2.17"> }</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20"> /**</span>
<a href="#l2.21"></a><span id="l2.21">  * Runs the given function sometime later</span>
<a href="#l2.22"></a><span id="l2.22">  *</span>
<a href="#l2.23"></a><span id="l2.23">  * Currently implemented using setTimeout(), but</span>
<a href="#l2.24"></a><span id="l2.24">  * can later be replaced with an nsITimer impl,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/activity/modules/glodaIndexer.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/activity/modules/glodaIndexer.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -54,19 +54,19 @@ var glodaIndexerActivity =</span>
<a href="#l3.4"></a><span id="l3.4">       throw(e);</span>
<a href="#l3.5"></a><span id="l3.5">     }</span>
<a href="#l3.6"></a><span id="l3.6">   },</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8">   init: function() {</span>
<a href="#l3.9"></a><span id="l3.9">     // Register a listener with the Gloda indexer that receives notifications</span>
<a href="#l3.10"></a><span id="l3.10">     // about Gloda indexing status.  We wrap the listener in this function so we</span>
<a href="#l3.11"></a><span id="l3.11">     // can set |this| to the GlodaIndexerActivity object inside the listener.</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    function listenerWrapper()</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    function listenerWrapper(...aArgs)</span>
<a href="#l3.14"></a><span id="l3.14">     {</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-      glodaIndexerActivity.listener.apply(glodaIndexerActivity, arguments);</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+      glodaIndexerActivity.listener(...aArgs);</span>
<a href="#l3.17"></a><span id="l3.17">     };</span>
<a href="#l3.18"></a><span id="l3.18">     GlodaIndexer.addListener(listenerWrapper);</span>
<a href="#l3.19"></a><span id="l3.19">   },</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21">   /**</span>
<a href="#l3.22"></a><span id="l3.22">    * Information about the current job.  An object with these properties:</span>
<a href="#l3.23"></a><span id="l3.23">    *</span>
<a href="#l3.24"></a><span id="l3.24">    *   folder       {String}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/preferences/subdialogs.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/preferences/subdialogs.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -71,19 +71,18 @@ SubDialog.prototype = {</span>
<a href="#l4.4"></a><span id="l4.4">   async open(aURL, aFeatures = null, aParams = null, aClosingCallback = null) {</span>
<a href="#l4.5"></a><span id="l4.5">     // Wait until frame is ready to prevent browser crash in tests</span>
<a href="#l4.6"></a><span id="l4.6">     await this._frameCreated;</span>
<a href="#l4.7"></a><span id="l4.7">     // If we're open on some (other) URL or we're closing, open when closing has finished.</span>
<a href="#l4.8"></a><span id="l4.8">     if (this._openedURL || this._isClosing) {</span>
<a href="#l4.9"></a><span id="l4.9">       if (!this._isClosing) {</span>
<a href="#l4.10"></a><span id="l4.10">         this.close();</span>
<a href="#l4.11"></a><span id="l4.11">       }</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-      let args = Array.from(arguments);</span>
<a href="#l4.13"></a><span id="l4.13">       this._closingPromise.then(() =&gt; {</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-        this.open.apply(this, args);</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+        this.open(aURL, aFeatures, aParams, aClosingCallback);</span>
<a href="#l4.16"></a><span id="l4.16">       });</span>
<a href="#l4.17"></a><span id="l4.17">       return;</span>
<a href="#l4.18"></a><span id="l4.18">     }</span>
<a href="#l4.19"></a><span id="l4.19">     this._addDialogEventListeners();</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">     Services.prefs.setBoolPref(&quot;browser.preferences.instantApply&quot;, true);</span>
<a href="#l4.22"></a><span id="l4.22">     let features = (aFeatures ? aFeatures + &quot;,&quot; : &quot;&quot;) + &quot;resizable,dialog=no,centerscreen&quot;;</span>
<a href="#l4.23"></a><span id="l4.23">     let dialog = window.openDialog(aURL, `dialogFrame-${this._id}`, features, aParams);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -388,18 +388,18 @@ function create_folder(aFolderName, aSpe</span>
<a href="#l5.4"></a><span id="l5.4">   mc.folderTreeView.mode = &quot;all&quot;;</span>
<a href="#l5.5"></a><span id="l5.5">   return folder;</span>
<a href="#l5.6"></a><span id="l5.6"> }</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> /**</span>
<a href="#l5.9"></a><span id="l5.9">  * Create a virtual folder by deferring to |make_virtual_folder| and making</span>
<a href="#l5.10"></a><span id="l5.10">  *  sure to rebuild the folder tree afterwards.</span>
<a href="#l5.11"></a><span id="l5.11">  */</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-function create_virtual_folder() {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-  let folder = testHelperModule.make_virtual_folder.apply(null, arguments);</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+function create_virtual_folder(...aArgs) {</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+  let folder = testHelperModule.make_virtual_folder(...aArgs);</span>
<a href="#l5.16"></a><span id="l5.16">   mc.folderTreeView.mode = &quot;all&quot;;</span>
<a href="#l5.17"></a><span id="l5.17">   return folder;</span>
<a href="#l5.18"></a><span id="l5.18"> }</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20"> /**</span>
<a href="#l5.21"></a><span id="l5.21">  * Get special folder having a folder flag under Local Folders.</span>
<a href="#l5.22"></a><span id="l5.22">  * This function clears the contents of the folder by default.</span>
<a href="#l5.23"></a><span id="l5.23">  *</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineat">@@ -1724,22 +1724,21 @@ var FolderListener = {</span>
<a href="#l5.25"></a><span id="l5.25">     MailServices.mailSession.AddFolderListener(this,</span>
<a href="#l5.26"></a><span id="l5.26">                                                Ci.nsIFolderListener.event);</span>
<a href="#l5.27"></a><span id="l5.27"> </span>
<a href="#l5.28"></a><span id="l5.28">     this._inited = true;</span>
<a href="#l5.29"></a><span id="l5.29">   },</span>
<a href="#l5.30"></a><span id="l5.30"> </span>
<a href="#l5.31"></a><span id="l5.31">   sawEvents: false,</span>
<a href="#l5.32"></a><span id="l5.32">   watchingFor: null,</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-  planToWaitFor: function FolderListener_planToWaitFor() {</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+  planToWaitFor: function FolderListener_planToWaitFor(...aArgs) {</span>
<a href="#l5.35"></a><span id="l5.35">     this.sawEvents = false;</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-    this.watchingFor = [];</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-    for (let i = 0; i &lt; arguments.length; i++)</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-      this.watchingFor[i] = arguments[i];</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+    this.watchingFor = aArgs;</span>
<a href="#l5.40"></a><span id="l5.40">   },</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+</span>
<a href="#l5.42"></a><span id="l5.42">   waitForEvents: function FolderListener_waitForEvents() {</span>
<a href="#l5.43"></a><span id="l5.43">     if (this.sawEvents)</span>
<a href="#l5.44"></a><span id="l5.44">       return;</span>
<a href="#l5.45"></a><span id="l5.45">     let self = this;</span>
<a href="#l5.46"></a><span id="l5.46">     try {</span>
<a href="#l5.47"></a><span id="l5.47">       utils.waitFor(() =&gt; self.sawEvents);</span>
<a href="#l5.48"></a><span id="l5.48">     } catch (e) {</span>
<a href="#l5.49"></a><span id="l5.49">       if (e instanceof utils.TimeoutError) {</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineat">@@ -1769,19 +1768,19 @@ var FolderListener = {</span>
<a href="#l5.51"></a><span id="l5.51">  *  the thing that would generate the event.</span>
<a href="#l5.52"></a><span id="l5.52">  * For example, plan_to_wait_for_folder_events(&quot;DeleteOrMoveMsgCompleted&quot;,</span>
<a href="#l5.53"></a><span id="l5.53">  *  &quot;DeleteOrMoveMsgFailed&quot;) waits for a deletion completion notification</span>
<a href="#l5.54"></a><span id="l5.54">  *  when you call |wait_for_folder_events|.</span>
<a href="#l5.55"></a><span id="l5.55">  * The waiting is currently un-scoped, so the event happening on any folder</span>
<a href="#l5.56"></a><span id="l5.56">  *  triggers us.  It is expected that you won't try and have multiple events</span>
<a href="#l5.57"></a><span id="l5.57">  *  in-flight or will augment us when the time comes to have to deal with that.</span>
<a href="#l5.58"></a><span id="l5.58">  */</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineminus">-function plan_to_wait_for_folder_events() {</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+function plan_to_wait_for_folder_events(...aArgs) {</span>
<a href="#l5.61"></a><span id="l5.61">   FolderListener.ensureInited();</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineminus">-  FolderListener.planToWaitFor.apply(FolderListener, arguments);</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+  FolderListener.planToWaitFor(...aArgs);</span>
<a href="#l5.64"></a><span id="l5.64"> }</span>
<a href="#l5.65"></a><span id="l5.65"> function wait_for_folder_events() {</span>
<a href="#l5.66"></a><span id="l5.66">   FolderListener.waitForEvents();</span>
<a href="#l5.67"></a><span id="l5.67"> }</span>
<a href="#l5.68"></a><span id="l5.68"> </span>
<a href="#l5.69"></a><span id="l5.69"> /**</span>
<a href="#l5.70"></a><span id="l5.70">  * Assert that the given synthetic message sets are present in the folder</span>
<a href="#l5.71"></a><span id="l5.71">  *  display.</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineat">@@ -1897,22 +1896,21 @@ function toggle_message_pane() {</span>
<a href="#l5.73"></a><span id="l5.73"> }</span>
<a href="#l5.74"></a><span id="l5.74"> </span>
<a href="#l5.75"></a><span id="l5.75"> /**</span>
<a href="#l5.76"></a><span id="l5.76">  * Helper function for use by assert_selected / assert_selected_and_displayed /</span>
<a href="#l5.77"></a><span id="l5.77">  *  assert_displayed.</span>
<a href="#l5.78"></a><span id="l5.78">  *</span>
<a href="#l5.79"></a><span id="l5.79">  * @return A list of two elements: [MozmillController, [list of view indices]].</span>
<a href="#l5.80"></a><span id="l5.80">  */</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-function _process_row_message_arguments() {</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+function _process_row_message_arguments(...aArgs) {</span>
<a href="#l5.83"></a><span id="l5.83">   let troller = mc;</span>
<a href="#l5.84"></a><span id="l5.84">   // - normalize into desired selected view indices</span>
<a href="#l5.85"></a><span id="l5.85">   let desiredIndices = [];</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineminus">-    let arg = arguments[iArg];</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+  for (let arg of aArgs) {</span>
<a href="#l5.89"></a><span id="l5.89">     // An integer identifying a view index</span>
<a href="#l5.90"></a><span id="l5.90">     if (typeof(arg) == &quot;number&quot;) {</span>
<a href="#l5.91"></a><span id="l5.91">       desiredIndices.push(_normalize_view_index(arg));</span>
<a href="#l5.92"></a><span id="l5.92">     }</span>
<a href="#l5.93"></a><span id="l5.93">     // A message header</span>
<a href="#l5.94"></a><span id="l5.94">     else if (arg instanceof Ci.nsIMsgDBHdr) {</span>
<a href="#l5.95"></a><span id="l5.95">       // do not expand; the thing should already be selected, eg expanded!</span>
<a href="#l5.96"></a><span id="l5.96">       let viewIndex = troller.dbView.findIndexOfMsgHdr(arg, false);</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineat">@@ -1979,19 +1977,19 @@ function _process_row_message_arguments(</span>
<a href="#l5.98"></a><span id="l5.98">  * - A MozmillController, indicating we should use that controller instead of</span>
<a href="#l5.99"></a><span id="l5.99">  *   the default, &quot;mc&quot; (corresponding to the 3pane.)  Pass this first!</span>
<a href="#l5.100"></a><span id="l5.100">  * - An integer identifying a view index.</span>
<a href="#l5.101"></a><span id="l5.101">  * - A list containing two integers, indicating a range of view indices.</span>
<a href="#l5.102"></a><span id="l5.102">  * - A message header.</span>
<a href="#l5.103"></a><span id="l5.103">  * - A list of message headers.</span>
<a href="#l5.104"></a><span id="l5.104">  * - A synthetic message set.</span>
<a href="#l5.105"></a><span id="l5.105">  */</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineminus">-function assert_selected() {</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+function assert_selected(...aArgs) {</span>
<a href="#l5.108"></a><span id="l5.108">   let [troller, desiredIndices] =</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineminus">-    _process_row_message_arguments.apply(this, arguments);</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+    _process_row_message_arguments(...aArgs);</span>
<a href="#l5.111"></a><span id="l5.111"> </span>
<a href="#l5.112"></a><span id="l5.112">   // - get the actual selection (already sorted by integer value)</span>
<a href="#l5.113"></a><span id="l5.113">   let selectedIndices = troller.folderDisplay.selectedIndices;</span>
<a href="#l5.114"></a><span id="l5.114">   // - test selection equivalence</span>
<a href="#l5.115"></a><span id="l5.115">   // which is the same as string equivalence in this case. muah hah hah.</span>
<a href="#l5.116"></a><span id="l5.116">   if (desiredIndices.toString() != selectedIndices.toString())</span>
<a href="#l5.117"></a><span id="l5.117">     mark_failure([&quot;Desired selection is:&quot;, desiredIndices,</span>
<a href="#l5.118"></a><span id="l5.118">                   &quot;but actual selection is: &quot;, selectedIndices]);</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineat">@@ -2008,19 +2006,19 @@ function assert_selected() {</span>
<a href="#l5.120"></a><span id="l5.120">  * The arguments consist of one or more of the following:</span>
<a href="#l5.121"></a><span id="l5.121">  * - A MozmillController, indicating we should use that controller instead of</span>
<a href="#l5.122"></a><span id="l5.122">  *   the default, &quot;mc&quot; (corresponding to the 3pane.)  Pass this first!</span>
<a href="#l5.123"></a><span id="l5.123">  * - An integer identifying a view index.</span>
<a href="#l5.124"></a><span id="l5.124">  * - A list containing two integers, indicating a range of view indices.</span>
<a href="#l5.125"></a><span id="l5.125">  * - A message header.</span>
<a href="#l5.126"></a><span id="l5.126">  * - A list of message headers.</span>
<a href="#l5.127"></a><span id="l5.127">  */</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineminus">-function assert_displayed() {</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+function assert_displayed(...aArgs) {</span>
<a href="#l5.130"></a><span id="l5.130">   let [troller, desiredIndices] =</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineminus">-    _process_row_message_arguments.apply(this, arguments);</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+    _process_row_message_arguments(...aArgs);</span>
<a href="#l5.133"></a><span id="l5.133">   _internal_assert_displayed(false, troller, desiredIndices);</span>
<a href="#l5.134"></a><span id="l5.134"> }</span>
<a href="#l5.135"></a><span id="l5.135"> </span>
<a href="#l5.136"></a><span id="l5.136"> /**</span>
<a href="#l5.137"></a><span id="l5.137">  * Assert-that-the-display-is-right logic.  We need an internal version so that</span>
<a href="#l5.138"></a><span id="l5.138">  *  we can know whether we can trust/assert that folderDisplay.selectedMessage</span>
<a href="#l5.139"></a><span id="l5.139">  *  agrees with messageDisplay, and also so that we don't have to re-compute</span>
<a href="#l5.140"></a><span id="l5.140">  *  troller and desiredIndices.</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineat">@@ -2119,19 +2117,19 @@ function _internal_assert_displayed(trus</span>
<a href="#l5.142"></a><span id="l5.142">  * The arguments consist of one or more of the following:</span>
<a href="#l5.143"></a><span id="l5.143">  * - A MozmillController, indicating we should use that controller instead of</span>
<a href="#l5.144"></a><span id="l5.144">  *   the default, &quot;mc&quot; (corresponding to the 3pane.)  Pass this first!</span>
<a href="#l5.145"></a><span id="l5.145">  * - An integer identifying a view index.</span>
<a href="#l5.146"></a><span id="l5.146">  * - A list containing two integers, indicating a range of view indices.</span>
<a href="#l5.147"></a><span id="l5.147">  * - A message header.</span>
<a href="#l5.148"></a><span id="l5.148">  * - A list of message headers.</span>
<a href="#l5.149"></a><span id="l5.149">  */</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineminus">-function assert_selected_and_displayed() {</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+function assert_selected_and_displayed(...aArgs) {</span>
<a href="#l5.152"></a><span id="l5.152">   // make sure the selection is right first.</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineminus">-  let [troller, desiredIndices] = assert_selected.apply(this, arguments);</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+  let [troller, desiredIndices] = assert_selected(...aArgs);</span>
<a href="#l5.155"></a><span id="l5.155">   // now make sure the display is right</span>
<a href="#l5.156"></a><span id="l5.156">   _internal_assert_displayed(true, troller, desiredIndices);</span>
<a href="#l5.157"></a><span id="l5.157"> }</span>
<a href="#l5.158"></a><span id="l5.158"> </span>
<a href="#l5.159"></a><span id="l5.159"> /**</span>
<a href="#l5.160"></a><span id="l5.160">  * Use the internal archiving code for archiving any given set of messages</span>
<a href="#l5.161"></a><span id="l5.161">  *</span>
<a href="#l5.162"></a><span id="l5.162">  * @param aMsgHdrs a list of message headers</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineat">@@ -2242,44 +2240,44 @@ function assert_not_shown(aMessages) {</span>
<a href="#l5.164"></a><span id="l5.164">   });</span>
<a href="#l5.165"></a><span id="l5.165"> }</span>
<a href="#l5.166"></a><span id="l5.166"> </span>
<a href="#l5.167"></a><span id="l5.167"> /**</span>
<a href="#l5.168"></a><span id="l5.168">  * @param aShouldBeElided Should the messages at the view indices be elided?</span>
<a href="#l5.169"></a><span id="l5.169">  * @param aArgs Arguments of the form processed by</span>
<a href="#l5.170"></a><span id="l5.170">  *     |_process_row_message_arguments|.</span>
<a href="#l5.171"></a><span id="l5.171">  */</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineminus">-function _assert_elided_helper(aShouldBeElided, aArgs) {</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineplus">+function _assert_elided_helper(aShouldBeElided, ...aArgs) {</span>
<a href="#l5.174"></a><span id="l5.174">   let [troller, viewIndices] =</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineminus">-    _process_row_message_arguments.apply(this, aArgs);</span>
<a href="#l5.176"></a><span id="l5.176" class="difflineplus">+    _process_row_message_arguments(...aArgs);</span>
<a href="#l5.177"></a><span id="l5.177"> </span>
<a href="#l5.178"></a><span id="l5.178">   let dbView = troller.dbView;</span>
<a href="#l5.179"></a><span id="l5.179">   for (let viewIndex of viewIndices) {</span>
<a href="#l5.180"></a><span id="l5.180">     let flags = dbView.getFlagsAt(viewIndex);</span>
<a href="#l5.181"></a><span id="l5.181">     if (Boolean(flags &amp; Ci.nsMsgMessageFlags.Elided) != aShouldBeElided)</span>
<a href="#l5.182"></a><span id="l5.182">       throw new Error(&quot;Message at view index &quot; + viewIndex +</span>
<a href="#l5.183"></a><span id="l5.183">                       (aShouldBeElided ? &quot; should be elided but is not!&quot;</span>
<a href="#l5.184"></a><span id="l5.184">                                        : &quot; should not be elided but is!&quot;));</span>
<a href="#l5.185"></a><span id="l5.185">   }</span>
<a href="#l5.186"></a><span id="l5.186"> }</span>
<a href="#l5.187"></a><span id="l5.187"> </span>
<a href="#l5.188"></a><span id="l5.188"> /**</span>
<a href="#l5.189"></a><span id="l5.189">  * Assert that all of the messages at the given view indices are collapsed.</span>
<a href="#l5.190"></a><span id="l5.190">  * Arguments should be of the type accepted by |assert_selected_and_displayed|.</span>
<a href="#l5.191"></a><span id="l5.191">  */</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineminus">-function assert_collapsed() {</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineminus">-  _assert_elided_helper(true, arguments);</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+function assert_collapsed(...aArgs) {</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+  _assert_elided_helper(true, ...aArgs);</span>
<a href="#l5.196"></a><span id="l5.196"> }</span>
<a href="#l5.197"></a><span id="l5.197"> </span>
<a href="#l5.198"></a><span id="l5.198"> /**</span>
<a href="#l5.199"></a><span id="l5.199">  * Assert that all of the messages at the given view indices are expanded.</span>
<a href="#l5.200"></a><span id="l5.200">  * Arguments should be of the type accepted by |assert_selected_and_displayed|.</span>
<a href="#l5.201"></a><span id="l5.201">  */</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineminus">-function assert_expanded() {</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineminus">-  _assert_elided_helper(false, arguments);</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+function assert_expanded(...aArgs) {</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+  _assert_elided_helper(false, ...aArgs);</span>
<a href="#l5.206"></a><span id="l5.206"> }</span>
<a href="#l5.207"></a><span id="l5.207"> </span>
<a href="#l5.208"></a><span id="l5.208"> /**</span>
<a href="#l5.209"></a><span id="l5.209">  * Add the widget with the given id to the toolbar if it is not already present.</span>
<a href="#l5.210"></a><span id="l5.210">  *  It gets added to the front if we add it.  Use |remove_from_toolbar| to</span>
<a href="#l5.211"></a><span id="l5.211">  *  remove the widget from the toolbar when you are done.</span>
<a href="#l5.212"></a><span id="l5.212">  *</span>
<a href="#l5.213"></a><span id="l5.213">  * @param aToolbarElement The DOM element that is the toolbar, like you would</span>
<a href="#l5.214"></a><span id="l5.214" class="difflineat">@@ -2449,22 +2447,21 @@ function _normalize_folder_view_index(aV</span>
<a href="#l5.215"></a><span id="l5.215">       aViewIndex;</span>
<a href="#l5.216"></a><span id="l5.216">   return aViewIndex;</span>
<a href="#l5.217"></a><span id="l5.217"> }</span>
<a href="#l5.218"></a><span id="l5.218"> </span>
<a href="#l5.219"></a><span id="l5.219"> /**</span>
<a href="#l5.220"></a><span id="l5.220">  * Helper function for use by assert_folders_selected /</span>
<a href="#l5.221"></a><span id="l5.221">  * assert_folders_selected_and_displayed / assert_folder_displayed.</span>
<a href="#l5.222"></a><span id="l5.222">  */</span>
<a href="#l5.223"></a><span id="l5.223" class="difflineminus">-function _process_row_folder_arguments() {</span>
<a href="#l5.224"></a><span id="l5.224" class="difflineplus">+function _process_row_folder_arguments(...aArgs) {</span>
<a href="#l5.225"></a><span id="l5.225">   let troller = mc;</span>
<a href="#l5.226"></a><span id="l5.226">   // - normalize into desired selected view indices</span>
<a href="#l5.227"></a><span id="l5.227">   let desiredFolders = [];</span>
<a href="#l5.228"></a><span id="l5.228" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l5.229"></a><span id="l5.229" class="difflineminus">-    let arg = arguments[iArg];</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineplus">+  for (let arg of aArgs) {</span>
<a href="#l5.231"></a><span id="l5.231">     // An integer identifying a view index</span>
<a href="#l5.232"></a><span id="l5.232">     if (typeof(arg) == &quot;number&quot;) {</span>
<a href="#l5.233"></a><span id="l5.233">       let folder = troller.folderTreeView.getFolderForIndex(</span>
<a href="#l5.234"></a><span id="l5.234">                        _normalize_folder_view_index(arg));</span>
<a href="#l5.235"></a><span id="l5.235">       if (!folder)</span>
<a href="#l5.236"></a><span id="l5.236">         throw new Error(&quot;Folder index not present in folder view: &quot; + arg);</span>
<a href="#l5.237"></a><span id="l5.237">       desiredFolders.push(folder);</span>
<a href="#l5.238"></a><span id="l5.238">     }</span>
<a href="#l5.239"></a><span id="l5.239" class="difflineat">@@ -2509,19 +2506,19 @@ function _process_row_folder_arguments()</span>
<a href="#l5.240"></a><span id="l5.240">  * The arguments consist of one or more of the following:</span>
<a href="#l5.241"></a><span id="l5.241">  * - A MozmillController, indicating we should use that controller instead of</span>
<a href="#l5.242"></a><span id="l5.242">  *   the default, &quot;mc&quot; (corresponding to the 3pane.)  Pass this first!</span>
<a href="#l5.243"></a><span id="l5.243">  * - An integer identifying a view index.</span>
<a href="#l5.244"></a><span id="l5.244">  * - A list containing two integers, indicating a range of view indices.</span>
<a href="#l5.245"></a><span id="l5.245">  * - An nsIMsgFolder.</span>
<a href="#l5.246"></a><span id="l5.246">  * - A list of nsIMsgFolders.</span>
<a href="#l5.247"></a><span id="l5.247">  */</span>
<a href="#l5.248"></a><span id="l5.248" class="difflineminus">-function assert_folders_selected() {</span>
<a href="#l5.249"></a><span id="l5.249" class="difflineplus">+function assert_folders_selected(...aArgs) {</span>
<a href="#l5.250"></a><span id="l5.250">   let [troller, desiredFolders] =</span>
<a href="#l5.251"></a><span id="l5.251" class="difflineminus">-    _process_row_folder_arguments.apply(this, arguments);</span>
<a href="#l5.252"></a><span id="l5.252" class="difflineplus">+    _process_row_folder_arguments(...aArgs);</span>
<a href="#l5.253"></a><span id="l5.253"> </span>
<a href="#l5.254"></a><span id="l5.254">   // - get the actual selection (already sorted by integer value)</span>
<a href="#l5.255"></a><span id="l5.255">   let selectedFolders = troller.folderTreeView.getSelectedFolders();</span>
<a href="#l5.256"></a><span id="l5.256">   // - test selection equivalence</span>
<a href="#l5.257"></a><span id="l5.257">   // no shortcuts here. check if each folder in either array is present in the</span>
<a href="#l5.258"></a><span id="l5.258">   // other array</span>
<a href="#l5.259"></a><span id="l5.259">   if (desiredFolders.some(</span>
<a href="#l5.260"></a><span id="l5.260">       folder =&gt; _non_strict_index_of(selectedFolders, folder) == -1) ||</span>
<a href="#l5.261"></a><span id="l5.261" class="difflineat">@@ -2547,19 +2544,19 @@ var assert_folder_selected = assert_fold</span>
<a href="#l5.262"></a><span id="l5.262">  * - An integer identifying a view index.</span>
<a href="#l5.263"></a><span id="l5.263">  * - A list containing two integers, indicating a range of view indices.</span>
<a href="#l5.264"></a><span id="l5.264">  * - An nsIMsgFolder.</span>
<a href="#l5.265"></a><span id="l5.265">  * - A list of nsIMsgFolders.</span>
<a href="#l5.266"></a><span id="l5.266">  *</span>
<a href="#l5.267"></a><span id="l5.267">  * In each case, since we can only have one folder displayed, we only look at</span>
<a href="#l5.268"></a><span id="l5.268">  * the first folder you pass in.</span>
<a href="#l5.269"></a><span id="l5.269">  */</span>
<a href="#l5.270"></a><span id="l5.270" class="difflineminus">-function assert_folder_displayed() {</span>
<a href="#l5.271"></a><span id="l5.271" class="difflineplus">+function assert_folder_displayed(...aArgs) {</span>
<a href="#l5.272"></a><span id="l5.272">   let [troller, desiredFolders] =</span>
<a href="#l5.273"></a><span id="l5.273" class="difflineminus">-    _process_row_folder_arguments.apply(this, arguments);</span>
<a href="#l5.274"></a><span id="l5.274" class="difflineplus">+    _process_row_folder_arguments(...aArgs);</span>
<a href="#l5.275"></a><span id="l5.275">   if (troller.folderDisplay.displayedFolder != desiredFolders[0])</span>
<a href="#l5.276"></a><span id="l5.276">     mark_failure([&quot;The displayed folder should be&quot;, desiredFolders[0],</span>
<a href="#l5.277"></a><span id="l5.277">                   &quot;but is actually&quot;, troller.folderDisplay.displayedFolder]);</span>
<a href="#l5.278"></a><span id="l5.278"> }</span>
<a href="#l5.279"></a><span id="l5.279"> </span>
<a href="#l5.280"></a><span id="l5.280"> /**</span>
<a href="#l5.281"></a><span id="l5.281">  * Asserts that the folders corresponding to the one or more folder spec</span>
<a href="#l5.282"></a><span id="l5.282">  * arguments are selected and displayed. If you specify multiple folders,</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineat">@@ -2570,19 +2567,18 @@ function assert_folder_displayed() {</span>
<a href="#l5.284"></a><span id="l5.284">  * The arguments consist of one or more of the following:</span>
<a href="#l5.285"></a><span id="l5.285">  * - A MozmillController, indicating we should use that controller instead of</span>
<a href="#l5.286"></a><span id="l5.286">  *   the default, &quot;mc&quot; (corresponding to the 3pane.)  Pass this first!</span>
<a href="#l5.287"></a><span id="l5.287">  * - An integer identifying a view index.</span>
<a href="#l5.288"></a><span id="l5.288">  * - A list containing two integers, indicating a range of view indices.</span>
<a href="#l5.289"></a><span id="l5.289">  * - An nsIMsgFolder.</span>
<a href="#l5.290"></a><span id="l5.290">  * - A list of nsIMsgFolders.</span>
<a href="#l5.291"></a><span id="l5.291">  */</span>
<a href="#l5.292"></a><span id="l5.292" class="difflineminus">-function assert_folders_selected_and_displayed() {</span>
<a href="#l5.293"></a><span id="l5.293" class="difflineminus">-  let [troller, desiredFolders] = assert_folders_selected.apply(this,</span>
<a href="#l5.294"></a><span id="l5.294" class="difflineminus">-                                                                arguments);</span>
<a href="#l5.295"></a><span id="l5.295" class="difflineplus">+function assert_folders_selected_and_displayed(...aArgs) {</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineplus">+  let [troller, desiredFolders] = assert_folders_selected(...aArgs);</span>
<a href="#l5.297"></a><span id="l5.297">   if (desiredFolders.length &gt; 0) {</span>
<a href="#l5.298"></a><span id="l5.298">       if (troller.folderDisplay.displayedFolder != desiredFolders[0])</span>
<a href="#l5.299"></a><span id="l5.299">         mark_failure([&quot;The displayed folder should be&quot;, desiredFolders[0],</span>
<a href="#l5.300"></a><span id="l5.300">                       &quot;but is actually&quot;,</span>
<a href="#l5.301"></a><span id="l5.301">                       troller.folderDisplay.displayedFolder]);</span>
<a href="#l5.302"></a><span id="l5.302">   }</span>
<a href="#l5.303"></a><span id="l5.303"> }</span>
<a href="#l5.304"></a><span id="l5.304"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-quick-filter-bar-helper.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -104,30 +104,26 @@ function assert_constraints_expressed(aC</span>
<a href="#l6.4"></a><span id="l6.4">     }</span>
<a href="#l6.5"></a><span id="l6.5">   }</span>
<a href="#l6.6"></a><span id="l6.6"> }</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> /**</span>
<a href="#l6.9"></a><span id="l6.9">  * Toggle the given filter buttons by name (from nameToBarDomId); variable</span>
<a href="#l6.10"></a><span id="l6.10">  * argument magic enabled.</span>
<a href="#l6.11"></a><span id="l6.11">  */</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-function toggle_boolean_constraints() {</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-    mc.click(mc.eid(nameToBarDomId[arguments[iArg]]));</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-  }</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+function toggle_boolean_constraints(...aArgs) {</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+  aArgs.forEach(arg =&gt; mc.click(mc.eid(nameToBarDomId[arg])));</span>
<a href="#l6.18"></a><span id="l6.18">   fdh.wait_for_all_messages_to_load(mc);</span>
<a href="#l6.19"></a><span id="l6.19"> }</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21"> /**</span>
<a href="#l6.22"></a><span id="l6.22">  * Toggle the tag faceting buttons by tag key.  Wait for messages after.</span>
<a href="#l6.23"></a><span id="l6.23">  */</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-function toggle_tag_constraints() {</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-    mc.click(mc.eid(&quot;qfb-tag-&quot; + arguments[iArg]));</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-  }</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+function toggle_tag_constraints(...aArgs) {</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+  aArgs.forEach(arg =&gt; mc.click(mc.eid(&quot;qfb-tag-&quot; + arg)));</span>
<a href="#l6.30"></a><span id="l6.30">   fdh.wait_for_all_messages_to_load(mc);</span>
<a href="#l6.31"></a><span id="l6.31"> }</span>
<a href="#l6.32"></a><span id="l6.32"> </span>
<a href="#l6.33"></a><span id="l6.33"> /**</span>
<a href="#l6.34"></a><span id="l6.34">  * Set the tag filtering mode. Wait for messages after.</span>
<a href="#l6.35"></a><span id="l6.35">  */</span>
<a href="#l6.36"></a><span id="l6.36"> function toggle_tag_mode() {</span>
<a href="#l6.37"></a><span id="l6.37">   let qbm = mc.e(&quot;qfb-boolean-mode&quot;);</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineat">@@ -144,44 +140,44 @@ function toggle_tag_mode() {</span>
<a href="#l6.39"></a><span id="l6.39">   }</span>
<a href="#l6.40"></a><span id="l6.40">   fdh.wait_for_all_messages_to_load(mc);</span>
<a href="#l6.41"></a><span id="l6.41"> }</span>
<a href="#l6.42"></a><span id="l6.42"> </span>
<a href="#l6.43"></a><span id="l6.43"> /**</span>
<a href="#l6.44"></a><span id="l6.44">  * Verify that tag buttons exist for exactly the given set of tag keys in the</span>
<a href="#l6.45"></a><span id="l6.45">  *  provided variable argument list.  Ordering is significant.</span>
<a href="#l6.46"></a><span id="l6.46">  */</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-function assert_tag_constraints_visible() {</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+function assert_tag_constraints_visible(...aArgs) {</span>
<a href="#l6.49"></a><span id="l6.49">   // the stupid bar should be visible if any arguments are specified</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-  if (arguments.length &amp;&amp; mc.e(&quot;quick-filter-bar-tab-bar&quot;).collapsed)</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+  if (aArgs.length &gt; 0 &amp;&amp; mc.e(&quot;quick-filter-bar-tab-bar&quot;).collapsed)</span>
<a href="#l6.52"></a><span id="l6.52">     throw new Error(&quot;The tag bar should not be collapsed!&quot;);</span>
<a href="#l6.53"></a><span id="l6.53"> </span>
<a href="#l6.54"></a><span id="l6.54">   let kids = mc.e(&quot;quick-filter-bar-tab-bar&quot;).childNodes;</span>
<a href="#l6.55"></a><span id="l6.55">   let tagLength = kids.length - 1; // -1 for the qfb-boolean-mode widget</span>
<a href="#l6.56"></a><span id="l6.56">   // this is bad error reporting in here for now.</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-  if (tagLength != arguments.length)</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+  if (tagLength != aArgs.length)</span>
<a href="#l6.59"></a><span id="l6.59">     throw new Error(&quot;Mismatch in expected tag count and actual. &quot; +</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineminus">-                    &quot;Expected &quot; + arguments.length +</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineplus">+                    &quot;Expected &quot; + aArgs.length +</span>
<a href="#l6.62"></a><span id="l6.62">                     &quot; actual &quot; + tagLength);</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineminus">-    let nodeId = &quot;qfb-tag-&quot; + arguments[iArg];</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+  for (let iArg = 0; iArg &lt; aArgs.length; iArg++) {</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+    let nodeId = &quot;qfb-tag-&quot; + aArgs[iArg];</span>
<a href="#l6.67"></a><span id="l6.67">     if (nodeId != kids[iArg+1].id)</span>
<a href="#l6.68"></a><span id="l6.68">       throw new Error(&quot;Mismatch at tag &quot; + iArg + &quot; expected &quot; + nodeId +</span>
<a href="#l6.69"></a><span id="l6.69">                       &quot; but got &quot; + kids[iArg+1].id);</span>
<a href="#l6.70"></a><span id="l6.70">   }</span>
<a href="#l6.71"></a><span id="l6.71"> }</span>
<a href="#l6.72"></a><span id="l6.72"> </span>
<a href="#l6.73"></a><span id="l6.73"> /**</span>
<a href="#l6.74"></a><span id="l6.74">  * Verify that only the buttons corresponding to the provided tag keys are</span>
<a href="#l6.75"></a><span id="l6.75">  * checked.</span>
<a href="#l6.76"></a><span id="l6.76">  */</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineminus">-function assert_tag_constraints_checked() {</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineplus">+function assert_tag_constraints_checked(...aArgs) {</span>
<a href="#l6.79"></a><span id="l6.79">   let expected = {};</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineminus">-    let nodeId = &quot;qfb-tag-&quot; + arguments[iArg];</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+  for (let arg of aArgs) {</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineplus">+    let nodeId = &quot;qfb-tag-&quot; + arg;</span>
<a href="#l6.84"></a><span id="l6.84">     expected[nodeId] = true;</span>
<a href="#l6.85"></a><span id="l6.85">   }</span>
<a href="#l6.86"></a><span id="l6.86"> </span>
<a href="#l6.87"></a><span id="l6.87">   let kids = mc.e(&quot;quick-filter-bar-tab-bar&quot;).childNodes;</span>
<a href="#l6.88"></a><span id="l6.88">   for (let iNode = 0; iNode &lt; kids.length; iNode++) {</span>
<a href="#l6.89"></a><span id="l6.89">     let node = kids[iNode];</span>
<a href="#l6.90"></a><span id="l6.90">     if (node.checked != (node.id in expected))</span>
<a href="#l6.91"></a><span id="l6.91">       throw new Error(&quot;node &quot; + node.id + &quot; should &quot; +</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineat">@@ -191,31 +187,29 @@ function assert_tag_constraints_checked(</span>
<a href="#l6.93"></a><span id="l6.93"> </span>
<a href="#l6.94"></a><span id="l6.94"> var nameToTextDomId = {</span>
<a href="#l6.95"></a><span id="l6.95">   sender: &quot;qfb-qs-sender&quot;,</span>
<a href="#l6.96"></a><span id="l6.96">   recipients: &quot;qfb-qs-recipients&quot;,</span>
<a href="#l6.97"></a><span id="l6.97">   subject: &quot;qfb-qs-subject&quot;,</span>
<a href="#l6.98"></a><span id="l6.98">   body: &quot;qfb-qs-body&quot;,</span>
<a href="#l6.99"></a><span id="l6.99"> };</span>
<a href="#l6.100"></a><span id="l6.100"> </span>
<a href="#l6.101"></a><span id="l6.101" class="difflineminus">-function toggle_text_constraints() {</span>
<a href="#l6.102"></a><span id="l6.102" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l6.103"></a><span id="l6.103" class="difflineminus">-    mc.click(mc.eid(nameToTextDomId[arguments[iArg]]));</span>
<a href="#l6.104"></a><span id="l6.104" class="difflineminus">-  }</span>
<a href="#l6.105"></a><span id="l6.105" class="difflineplus">+function toggle_text_constraints(...aArgs) {</span>
<a href="#l6.106"></a><span id="l6.106" class="difflineplus">+  aArgs.forEach(arg =&gt; mc.click(mc.eid(nameToTextDomId[arg])));</span>
<a href="#l6.107"></a><span id="l6.107">   fdh.wait_for_all_messages_to_load(mc);</span>
<a href="#l6.108"></a><span id="l6.108"> }</span>
<a href="#l6.109"></a><span id="l6.109"> </span>
<a href="#l6.110"></a><span id="l6.110"> /**</span>
<a href="#l6.111"></a><span id="l6.111">  * Assert that the text constraint buttons are checked.  Variable-argument</span>
<a href="#l6.112"></a><span id="l6.112">  *  support where the arguments are one of sender/recipients/subject/body.</span>
<a href="#l6.113"></a><span id="l6.113">  */</span>
<a href="#l6.114"></a><span id="l6.114" class="difflineminus">-function assert_text_constraints_checked() {</span>
<a href="#l6.115"></a><span id="l6.115" class="difflineplus">+function assert_text_constraints_checked(...aArgs) {</span>
<a href="#l6.116"></a><span id="l6.116">   let expected = {};</span>
<a href="#l6.117"></a><span id="l6.117" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l6.118"></a><span id="l6.118" class="difflineminus">-    let nodeId = nameToTextDomId[arguments[iArg]];</span>
<a href="#l6.119"></a><span id="l6.119" class="difflineplus">+  for (let arg of aArgs) {</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineplus">+    let nodeId = nameToTextDomId[arg];</span>
<a href="#l6.121"></a><span id="l6.121">     expected[nodeId] = true;</span>
<a href="#l6.122"></a><span id="l6.122">   }</span>
<a href="#l6.123"></a><span id="l6.123"> </span>
<a href="#l6.124"></a><span id="l6.124">   let kids = mc.e(&quot;quick-filter-bar-filter-text-bar&quot;).childNodes;</span>
<a href="#l6.125"></a><span id="l6.125">   for (let iNode = 0; iNode &lt; kids.length; iNode++) {</span>
<a href="#l6.126"></a><span id="l6.126">     let node = kids[iNode];</span>
<a href="#l6.127"></a><span id="l6.127">     if (node.tagName == &quot;label&quot;)</span>
<a href="#l6.128"></a><span id="l6.128">       continue;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-window-helpers.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-window-helpers.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1413,27 +1413,27 @@ function _augment_helper(aController, aA</span>
<a href="#l7.4"></a><span id="l7.4">       let reportAs = traceDef.reportAs; // latch</span>
<a href="#l7.5"></a><span id="l7.5">       let showArgs = (&quot;showArgs&quot; in traceDef) ? traceDef.showArgs : true;</span>
<a href="#l7.6"></a><span id="l7.6">       baseObj[wrappedName] = origFunc;</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8">       // - create the trace func based on the definition and apply</span>
<a href="#l7.9"></a><span id="l7.9">       let traceFunc;</span>
<a href="#l7.10"></a><span id="l7.10">       if (traceDef.hasOwnProperty(&quot;doBefore&quot;)) {</span>
<a href="#l7.11"></a><span id="l7.11">         let beforeFunc = traceDef.doBefore;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-        traceFunc = function() {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-          beforeFunc.apply(useThis ? this : baseObj, arguments);</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-          return origFunc.apply(this, arguments);</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+        traceFunc = function(...aArgs) {</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+          beforeFunc.apply(useThis ? this : baseObj, aArgs);</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+          return origFunc.apply(this, aArgs);</span>
<a href="#l7.18"></a><span id="l7.18">         }</span>
<a href="#l7.19"></a><span id="l7.19">       }</span>
<a href="#l7.20"></a><span id="l7.20">       else {</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-        traceFunc = function() {</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+        traceFunc = function(...aArgs) {</span>
<a href="#l7.23"></a><span id="l7.23">           mark_action(&quot;winhelp&quot;, reportAs,</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-                      showArgs ? Array.from(arguments) : []);</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+                      showArgs ? aArgs : []);</span>
<a href="#l7.26"></a><span id="l7.26">           try {</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-            return origFunc.apply(this, arguments);</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+            return origFunc.apply(this, aArgs);</span>
<a href="#l7.29"></a><span id="l7.29">           }</span>
<a href="#l7.30"></a><span id="l7.30">           catch(ex) {</span>
<a href="#l7.31"></a><span id="l7.31">             mark_failure([&quot;exception in&quot;, reportAs, &quot;ex:&quot;, ex]);</span>
<a href="#l7.32"></a><span id="l7.32">             // re-throw it; someone might care!</span>
<a href="#l7.33"></a><span id="l7.33">             throw ex;</span>
<a href="#l7.34"></a><span id="l7.34">           }</span>
<a href="#l7.35"></a><span id="l7.35">         }</span>
<a href="#l7.36"></a><span id="l7.36">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/modules/controller.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -476,17 +476,17 @@ MozMillController.prototype.open = funct</span>
<a href="#l8.4"></a><span id="l8.4">  *                               [optional - default: current element]</span>
<a href="#l8.5"></a><span id="l8.5">  *                  type       - Type of the expected mouse event</span>
<a href="#l8.6"></a><span id="l8.6">  */</span>
<a href="#l8.7"></a><span id="l8.7"> MozMillController.prototype.mouseEvent = function(aTarget, aOffsetX, aOffsetY,</span>
<a href="#l8.8"></a><span id="l8.8">                                                   aEvent, aExpectedEvent) {</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10">   var element = aTarget.getNode();</span>
<a href="#l8.11"></a><span id="l8.11">   if (!element) {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    throw new Error(arguments.callee.name + &quot;: could not find element &quot; +</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    throw new Error(&quot;mouseEvent: could not find element &quot; +</span>
<a href="#l8.14"></a><span id="l8.14">                     aTarget.getInfo());</span>
<a href="#l8.15"></a><span id="l8.15">   }</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17">   // If no offset is given we will use the center of the element to click on.</span>
<a href="#l8.18"></a><span id="l8.18">   var rect = element.getBoundingClientRect();</span>
<a href="#l8.19"></a><span id="l8.19">   if (isNaN(aOffsetX))</span>
<a href="#l8.20"></a><span id="l8.20">     aOffsetX = rect.width / 2;</span>
<a href="#l8.21"></a><span id="l8.21">   if (isNaN(aOffsetY))</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -494,22 +494,22 @@ MozMillController.prototype.mouseEvent =</span>
<a href="#l8.23"></a><span id="l8.23"> </span>
<a href="#l8.24"></a><span id="l8.24">   // Scroll element into view otherwise the click will fail</span>
<a href="#l8.25"></a><span id="l8.25">   if (element.scrollIntoView)</span>
<a href="#l8.26"></a><span id="l8.26">     element.scrollIntoView();</span>
<a href="#l8.27"></a><span id="l8.27"> </span>
<a href="#l8.28"></a><span id="l8.28">   if (aExpectedEvent) {</span>
<a href="#l8.29"></a><span id="l8.29">     // The expected event type has to be set</span>
<a href="#l8.30"></a><span id="l8.30">     if (!aExpectedEvent.type)</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-      throw new Error(arguments.callee.name + &quot;: Expected event type not specified&quot;);</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+      throw new Error(&quot;mouseEvent: Expected event type not specified&quot;);</span>
<a href="#l8.33"></a><span id="l8.33"> </span>
<a href="#l8.34"></a><span id="l8.34">     // If no target has been specified use the specified element</span>
<a href="#l8.35"></a><span id="l8.35">     var target = aExpectedEvent.target ? aExpectedEvent.target.getNode() : element;</span>
<a href="#l8.36"></a><span id="l8.36">     if (!target) {</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-      throw new Error(arguments.callee.name + &quot;: could not find element &quot; +</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+      throw new Error(&quot;mouseEvent: could not find element &quot; +</span>
<a href="#l8.39"></a><span id="l8.39">                       aExpectedEvent.target.getInfo());</span>
<a href="#l8.40"></a><span id="l8.40">     }</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42">     EventUtils.synthesizeMouseExpectEvent(element, aOffsetX, aOffsetY, aEvent,</span>
<a href="#l8.43"></a><span id="l8.43">                                           target, aExpectedEvent.event,</span>
<a href="#l8.44"></a><span id="l8.44">                                           &quot;controller.mouseEvent()&quot;,</span>
<a href="#l8.45"></a><span id="l8.45">                                           element.ownerDocument.defaultView);</span>
<a href="#l8.46"></a><span id="l8.46">   } else {</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineat">@@ -604,19 +604,19 @@ MozMillController.prototype.rightClick =</span>
<a href="#l8.48"></a><span id="l8.48"> </span>
<a href="#l8.49"></a><span id="l8.49">   frame.events.pass({'function':'controller.rightClick()'});</span>
<a href="#l8.50"></a><span id="l8.50">   return true;</span>
<a href="#l8.51"></a><span id="l8.51"> }</span>
<a href="#l8.52"></a><span id="l8.52"> </span>
<a href="#l8.53"></a><span id="l8.53"> /**</span>
<a href="#l8.54"></a><span id="l8.54">  * Synthesize a mouse right click event on the given element (deprecated)</span>
<a href="#l8.55"></a><span id="l8.55">  */</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-MozMillController.prototype.rightclick = function(){</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+MozMillController.prototype.rightclick = function(...aArgs){</span>
<a href="#l8.58"></a><span id="l8.58">   frame.log({function:'rightclick - Deprecation Warning', message:'Controller.rightclick should be renamed to Controller.rightClick'});</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-  this.rightClick.apply(this, arguments);</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+  this.rightClick(...aArgs);</span>
<a href="#l8.61"></a><span id="l8.61"> }</span>
<a href="#l8.62"></a><span id="l8.62"> </span>
<a href="#l8.63"></a><span id="l8.63"> /**</span>
<a href="#l8.64"></a><span id="l8.64">  * Enable/Disable a checkbox depending on the target state</span>
<a href="#l8.65"></a><span id="l8.65">  */</span>
<a href="#l8.66"></a><span id="l8.66"> MozMillController.prototype.check = function(el, state) {</span>
<a href="#l8.67"></a><span id="l8.67">   var result = false;</span>
<a href="#l8.68"></a><span id="l8.68">   var element = el.getNode();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/modules/events.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -128,22 +128,22 @@ var triggerKeyEvent = function(element, </span>
<a href="#l9.4"></a><span id="l9.4">     // Only focus the element when it's not focused yet</span>
<a href="#l9.5"></a><span id="l9.5">     if (!node)</span>
<a href="#l9.6"></a><span id="l9.6">       element.focus();</span>
<a href="#l9.7"></a><span id="l9.7">   }</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9">   if (expectedEvent) {</span>
<a href="#l9.10"></a><span id="l9.10">     // The expected event type has to be set</span>
<a href="#l9.11"></a><span id="l9.11">     if (!expectedEvent.type)</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-      throw new Error(arguments.callee.name + &quot;: Expected event type not specified&quot;);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+      throw new Error(&quot;triggerKeyEvent: Expected event type not specified&quot;);</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15">     // If no target has been specified use the specified element</span>
<a href="#l9.16"></a><span id="l9.16">     var target = expectedEvent.target ? expectedEvent.target.getNode() : element;</span>
<a href="#l9.17"></a><span id="l9.17">     if (!target) {</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-      throw new Error(arguments.callee.name + &quot;: could not find element &quot; +</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+      throw new Error(&quot;triggerKeyEvent: could not find element &quot; +</span>
<a href="#l9.20"></a><span id="l9.20">                       expectedEvent.target.getInfo());</span>
<a href="#l9.21"></a><span id="l9.21">     }</span>
<a href="#l9.22"></a><span id="l9.22"> </span>
<a href="#l9.23"></a><span id="l9.23">     EventUtils.synthesizeKeyExpectEvent(aKey, modifiers, target,</span>
<a href="#l9.24"></a><span id="l9.24">                                         expectedEvent.type,</span>
<a href="#l9.25"></a><span id="l9.25">                                         &quot;events.triggerKeyEvent()&quot;, win);</span>
<a href="#l9.26"></a><span id="l9.26">   } else {</span>
<a href="#l9.27"></a><span id="l9.27">     EventUtils.synthesizeKey(aKey, modifiers, win);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/modules/utils.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -367,17 +367,17 @@ function sleep(milliseconds) {</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5"> /**</span>
<a href="#l10.6"></a><span id="l10.6">  * Check if the callback function evaluates to true</span>
<a href="#l10.7"></a><span id="l10.7">  */</span>
<a href="#l10.8"></a><span id="l10.8"> function assert(callback, message, thisObject) {</span>
<a href="#l10.9"></a><span id="l10.9">   var result = callback.call(thisObject);</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11">   if (!result) {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    throw new Error(message || arguments.callee.name + &quot;: Failed for '&quot; + callback + &quot;'&quot;);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+    throw new Error(message || &quot;assert: Failed for '&quot; + callback + &quot;'&quot;);</span>
<a href="#l10.14"></a><span id="l10.14">   }</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16">   return true;</span>
<a href="#l10.17"></a><span id="l10.17"> }</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> /**</span>
<a href="#l10.20"></a><span id="l10.20">  * Unwraps a node which is wrapped into a XPCNativeWrapper or XrayWrapper</span>
<a href="#l10.21"></a><span id="l10.21">  *</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -438,30 +438,30 @@ function waitFor(callback, message, time</span>
<a href="#l10.23"></a><span id="l10.23"> </span>
<a href="#l10.24"></a><span id="l10.24">   while((self.result != true) &amp;&amp; (self.counter &lt; timeout))  {</span>
<a href="#l10.25"></a><span id="l10.25">     thread.processNextEvent(true);</span>
<a href="#l10.26"></a><span id="l10.26">   }</span>
<a href="#l10.27"></a><span id="l10.27"> </span>
<a href="#l10.28"></a><span id="l10.28">   hwindow.clearInterval(timeoutInterval);</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30">   if (self.counter &gt;= timeout) {</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-    message = message || arguments.callee.name + &quot;: Timeout exceeded for '&quot; + callback + &quot;'&quot;;</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+    message = message || &quot;waitFor: Timeout exceeded for '&quot; + callback + &quot;'&quot;;</span>
<a href="#l10.33"></a><span id="l10.33">     throw new TimeoutError(message);</span>
<a href="#l10.34"></a><span id="l10.34">   }</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36">   return true;</span>
<a href="#l10.37"></a><span id="l10.37"> }</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39"> /**</span>
<a href="#l10.40"></a><span id="l10.40">  * Waits until the expression evaluates to true</span>
<a href="#l10.41"></a><span id="l10.41">  */</span>
<a href="#l10.42"></a><span id="l10.42"> function waitForEval(expression, timeout, interval, subject) {</span>
<a href="#l10.43"></a><span id="l10.43">   waitFor(function() {</span>
<a href="#l10.44"></a><span id="l10.44">     return eval(expression);</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineminus">-  }, arguments.callee.name + &quot;: Timeout exceeded for '&quot; + expression + &quot;'&quot;, timeout, interval);</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+  }, &quot;waitForEval: Timeout exceeded for '&quot; + expression + &quot;'&quot;, timeout, interval);</span>
<a href="#l10.47"></a><span id="l10.47"> </span>
<a href="#l10.48"></a><span id="l10.48">   return true;</span>
<a href="#l10.49"></a><span id="l10.49"> }</span>
<a href="#l10.50"></a><span id="l10.50"> </span>
<a href="#l10.51"></a><span id="l10.51"> </span>
<a href="#l10.52"></a><span id="l10.52">  //</span>
<a href="#l10.53"></a><span id="l10.53">  // //Function to start the running of jsTests</span>
<a href="#l10.54"></a><span id="l10.54">  // var jsTests = function (paramObj) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/test/unit/test_jsTreeSelection.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_jsTreeSelection.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -29,32 +29,32 @@ function bad_ranges(aMsg, aExpected) {</span>
<a href="#l11.4"></a><span id="l11.4">   }</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6">   s += &quot;\x1b[0m\n&quot;;</span>
<a href="#l11.7"></a><span id="l11.7"> </span>
<a href="#l11.8"></a><span id="l11.8">   dump(s);</span>
<a href="#l11.9"></a><span id="l11.9">   do_throw(aMsg);</span>
<a href="#l11.10"></a><span id="l11.10"> }</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-function assert_selection_ranges() {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-  if (sel._ranges.length != arguments.length)</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-    bad_ranges(&quot;Wrong number of ranges!&quot;, arguments);</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+function assert_selection_ranges(...aArgs) {</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+  if (sel._ranges.length != aArgs.length)</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+    bad_ranges(&quot;Wrong number of ranges!&quot;, aArgs);</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19">   let i = 0;</span>
<a href="#l11.20"></a><span id="l11.20">   let ourCount = 0;</span>
<a href="#l11.21"></a><span id="l11.21">   for (let [slow,shigh] of sel._ranges) {</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineminus">-    let [dlow, dhigh] = arguments[i++];</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+    let [dlow, dhigh] = aArgs[i++];</span>
<a href="#l11.24"></a><span id="l11.24">     if (dlow != slow || dhigh != shigh)</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineminus">-      bad_ranges(&quot;Range mis-match on index &quot; + i, arguments);</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+      bad_ranges(&quot;Range mis-match on index &quot; + i, aArgs);</span>
<a href="#l11.27"></a><span id="l11.27">     ourCount += shigh - slow + 1;</span>
<a href="#l11.28"></a><span id="l11.28">   }</span>
<a href="#l11.29"></a><span id="l11.29"> </span>
<a href="#l11.30"></a><span id="l11.30">   if (ourCount != sel.count)</span>
<a href="#l11.31"></a><span id="l11.31">     bad_ranges(&quot;Count was wrong! We counted &quot; + ourCount + &quot; but they say &quot; +</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">-               sel.count, arguments);</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+               sel.count, aArgs);</span>
<a href="#l11.34"></a><span id="l11.34"> }</span>
<a href="#l11.35"></a><span id="l11.35"> var asr = assert_selection_ranges;</span>
<a href="#l11.36"></a><span id="l11.36"> </span>
<a href="#l11.37"></a><span id="l11.37"> function assert_current_index(aIndex) {</span>
<a href="#l11.38"></a><span id="l11.38">   if (sel.currentIndex != aIndex)</span>
<a href="#l11.39"></a><span id="l11.39">     do_throw(&quot;Current index is wrong! Is &quot; + sel.currentIndex +</span>
<a href="#l11.40"></a><span id="l11.40">              &quot; but should be &quot; + aIndex);</span>
<a href="#l11.41"></a><span id="l11.41"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/test/unit/test_nsMsgDBView.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_nsMsgDBView.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -145,32 +145,30 @@ function assert_view_row_count(aCount) {</span>
<a href="#l12.4"></a><span id="l12.4">     view_throw(&quot;Expected view to have &quot; + aCount + &quot; rows, but it had &quot; +</span>
<a href="#l12.5"></a><span id="l12.5">              gTreeView.rowCount + &quot; rows!&quot;);</span>
<a href="#l12.6"></a><span id="l12.6"> }</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8"> /**</span>
<a href="#l12.9"></a><span id="l12.9">  * Throw if any of the arguments (as view indices) do not correspond to dummy</span>
<a href="#l12.10"></a><span id="l12.10">  *  rows in gDBView.</span>
<a href="#l12.11"></a><span id="l12.11">  */</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-function assert_view_index_is_dummy() {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-    let viewIndex = arguments[iArg];</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+function assert_view_index_is_dummy(...aArgs) {</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+  for (let viewIndex of aArgs) {</span>
<a href="#l12.17"></a><span id="l12.17">     let flags = gDBView.getFlagsAt(viewIndex);</span>
<a href="#l12.18"></a><span id="l12.18">     if (!(flags &amp; MSG_VIEW_FLAG_DUMMY))</span>
<a href="#l12.19"></a><span id="l12.19">       view_throw(&quot;Expected index &quot; + viewIndex + &quot; to be a dummy!&quot;);</span>
<a href="#l12.20"></a><span id="l12.20">   }</span>
<a href="#l12.21"></a><span id="l12.21"> }</span>
<a href="#l12.22"></a><span id="l12.22"> </span>
<a href="#l12.23"></a><span id="l12.23"> /**</span>
<a href="#l12.24"></a><span id="l12.24">  * Throw if any of the arguments (as view indices) correspond to dummy rows in</span>
<a href="#l12.25"></a><span id="l12.25">  *  gDBView.</span>
<a href="#l12.26"></a><span id="l12.26">  */</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-function assert_view_index_is_not_dummy() {</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">-    let viewIndex = arguments[iArg];</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+function assert_view_index_is_not_dummy(...aArgs) {</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+  for (let viewIndex of aArgs) {</span>
<a href="#l12.32"></a><span id="l12.32">     let flags = gDBView.getFlagsAt(viewIndex);</span>
<a href="#l12.33"></a><span id="l12.33">     if (flags &amp; MSG_VIEW_FLAG_DUMMY)</span>
<a href="#l12.34"></a><span id="l12.34">       view_throw(&quot;Expected index &quot; + viewIndex + &quot; to not be a dummy!&quot;);</span>
<a href="#l12.35"></a><span id="l12.35">   }</span>
<a href="#l12.36"></a><span id="l12.36"> }</span>
<a href="#l12.37"></a><span id="l12.37"> </span>
<a href="#l12.38"></a><span id="l12.38"> function assert_view_level_is(index, level) {</span>
<a href="#l12.39"></a><span id="l12.39">   if (gDBView.getLevel(index) != level)</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineat">@@ -180,20 +178,19 @@ function assert_view_level_is(index, lev</span>
<a href="#l12.41"></a><span id="l12.41"> /**</span>
<a href="#l12.42"></a><span id="l12.42">  * Given a message, assert that it is present at the given indices.</span>
<a href="#l12.43"></a><span id="l12.43">  *</span>
<a href="#l12.44"></a><span id="l12.44">  * Usage:</span>
<a href="#l12.45"></a><span id="l12.45">  *  assert_view_message_at_indices(synMsg, 0);</span>
<a href="#l12.46"></a><span id="l12.46">  *  assert_view_message_at_indices(synMsg, 0, 1);</span>
<a href="#l12.47"></a><span id="l12.47">  *  assert_view_message_at_indices(aMsg, 0, bMsg, 1);</span>
<a href="#l12.48"></a><span id="l12.48">  */</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-function assert_view_message_at_indices() {</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+function assert_view_message_at_indices(...aArgs) {</span>
<a href="#l12.51"></a><span id="l12.51">   let curHdr;</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-  for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-    let thing = arguments[iArg];</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+  for (let thing of aArgs) {</span>
<a href="#l12.55"></a><span id="l12.55">     if (typeof(thing) == &quot;number&quot;) {</span>
<a href="#l12.56"></a><span id="l12.56">       let hdrAt = gDBView.getMsgHdrAt(thing);</span>
<a href="#l12.57"></a><span id="l12.57">       if (curHdr != hdrAt) {</span>
<a href="#l12.58"></a><span id="l12.58">         view_throw(&quot;Expected hdr at &quot; + thing + &quot; to be &quot; +</span>
<a href="#l12.59"></a><span id="l12.59">                   curHdr.messageKey + &quot;:&quot; +</span>
<a href="#l12.60"></a><span id="l12.60">                    curHdr.mime2DecodedSubject.substr(0, 30) + &quot; not &quot; +</span>
<a href="#l12.61"></a><span id="l12.61">                   hdrAt.messageKey + &quot;:&quot; +</span>
<a href="#l12.62"></a><span id="l12.62">                     hdrAt.mime2DecodedSubject.substr(0, 30));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/util/JXON.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/util/JXON.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -160,21 +160,21 @@ var JXON = new (function() {</span>
<a href="#l13.4"></a><span id="l13.4">         else if (vValue !== null &amp;&amp; vValue !== true)</span>
<a href="#l13.5"></a><span id="l13.5">           oChild.appendChild(oXMLDoc.createTextNode(vValue.toString()));</span>
<a href="#l13.6"></a><span id="l13.6">         oParentEl.appendChild(oChild);</span>
<a href="#l13.7"></a><span id="l13.7">      }</span>
<a href="#l13.8"></a><span id="l13.8">    }</span>
<a href="#l13.9"></a><span id="l13.9">   };</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">   this.build = function(oXMLParent, nVerbosity /* optional */, bFreeze /* optional */, bNesteAttributes /* optional */) {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    const _nVerb = arguments.length &gt; 1 &amp;&amp;</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    const _nVerb =</span>
<a href="#l13.14"></a><span id="l13.14">         typeof nVerbosity === &quot;number&quot; ? nVerbosity &amp; 3 :</span>
<a href="#l13.15"></a><span id="l13.15">         /* put here the default verbosity level: */ 1;</span>
<a href="#l13.16"></a><span id="l13.16">     return createObjTree(oXMLParent, _nVerb, bFreeze || false,</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-        arguments.length &gt; 3 ? bNesteAttributes : _nVerb === 3);</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+        (bNesteAttributes !== undefined) ? bNesteAttributes : _nVerb === 3);</span>
<a href="#l13.19"></a><span id="l13.19">   };</span>
<a href="#l13.20"></a><span id="l13.20"> </span>
<a href="#l13.21"></a><span id="l13.21">   this.unbuild = function(oObjTree) {</span>
<a href="#l13.22"></a><span id="l13.22">     const oNewDoc = document.implementation.createDocument(&quot;&quot;, &quot;&quot;, null);</span>
<a href="#l13.23"></a><span id="l13.23">     loadObjTree(oNewDoc, oNewDoc, oObjTree);</span>
<a href="#l13.24"></a><span id="l13.24">     return oNewDoc;</span>
<a href="#l13.25"></a><span id="l13.25">   };</span>
<a href="#l13.26"></a><span id="l13.26"> })();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/util/traceHelper.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/util/traceHelper.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -62,35 +62,34 @@ var DebugTraceHelper = {</span>
<a href="#l14.4"></a><span id="l14.4">         // ignore properties!</span>
<a href="#l14.5"></a><span id="l14.5">         if (aObj.__lookupGetter__(key) || aObj.__lookupSetter__(key))</span>
<a href="#l14.6"></a><span id="l14.6">           continue;</span>
<a href="#l14.7"></a><span id="l14.7">         // ignore non-functions!</span>
<a href="#l14.8"></a><span id="l14.8">         if (typeof(aObj[key]) != &quot;function&quot;)</span>
<a href="#l14.9"></a><span id="l14.9">           continue;</span>
<a href="#l14.10"></a><span id="l14.10">         let name = key;</span>
<a href="#l14.11"></a><span id="l14.11">         let prev = aObj[name];</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-        aObj[name] = function() {</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+        aObj[name] = function(...aArgs) {</span>
<a href="#l14.14"></a><span id="l14.14">           let argstr = &quot;&quot;;</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-          for (let i = 0; i &lt; arguments.length; i++) {</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-            let arg = arguments[i];</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+          for (let arg of aArgs) {</span>
<a href="#l14.18"></a><span id="l14.18">             if (arg == null)</span>
<a href="#l14.19"></a><span id="l14.19">               argstr += &quot; null&quot;;</span>
<a href="#l14.20"></a><span id="l14.20">             else if (typeof(arg) == &quot;function&quot;)</span>
<a href="#l14.21"></a><span id="l14.21">               argstr += &quot; function &quot;+ arg.name;</span>
<a href="#l14.22"></a><span id="l14.22">             else</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-              argstr += &quot; &quot; + arguments[i].toString();</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+              argstr += &quot; &quot; + arg.toString();</span>
<a href="#l14.25"></a><span id="l14.25">           }</span>
<a href="#l14.26"></a><span id="l14.26"> </span>
<a href="#l14.27"></a><span id="l14.27">           let indent = SPACES.substr(0, aContext.depth++ * 2);</span>
<a href="#l14.28"></a><span id="l14.28">           dump(indent + &quot;--&gt; &quot; + aSettings.introCode + aDesc + &quot;::&quot; + name +</span>
<a href="#l14.29"></a><span id="l14.29">                &quot;:&quot; + argstr +</span>
<a href="#l14.30"></a><span id="l14.30">                STOP_COLORS + &quot;\n&quot;);</span>
<a href="#l14.31"></a><span id="l14.31">           let ret;</span>
<a href="#l14.32"></a><span id="l14.32">           try {</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-            ret = prev.apply(this, arguments);</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+            ret = prev.apply(this, aArgs);</span>
<a href="#l14.35"></a><span id="l14.35">           }</span>
<a href="#l14.36"></a><span id="l14.36">           catch (ex) {</span>
<a href="#l14.37"></a><span id="l14.37">             if (ex.stack) {</span>
<a href="#l14.38"></a><span id="l14.38">               dump(BRIGHT_COLORS.red + &quot;Exception: &quot; + ex + &quot;\n  &quot; +</span>
<a href="#l14.39"></a><span id="l14.39">                    ex.stack.replace(&quot;\n&quot;, &quot;\n  &quot;) + STOP_COLORS + &quot;\n&quot;);</span>
<a href="#l14.40"></a><span id="l14.40">             }</span>
<a href="#l14.41"></a><span id="l14.41">             else {</span>
<a href="#l14.42"></a><span id="l14.42">               dump(BRIGHT_COLORS.red + &quot;Exception: &quot; + ex.fileName + &quot;:&quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/db/gloda/modules/databind.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/databind.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -169,21 +169,21 @@ GlodaDatabind.prototype = {</span>
<a href="#l15.4"></a><span id="l15.4">       stmt.bindByIndex(0, aThing[this._idAttr]);</span>
<a href="#l15.5"></a><span id="l15.5">       for (let colDef of this._tableDef.fulltextColumns) {</span>
<a href="#l15.6"></a><span id="l15.6">         bindByType(stmt, colDef, aThing[colDef[2]]);</span>
<a href="#l15.7"></a><span id="l15.7">       }</span>
<a href="#l15.8"></a><span id="l15.8">       stmt.executeAsync(this._datastore.trackAsync());</span>
<a href="#l15.9"></a><span id="l15.9">     }</span>
<a href="#l15.10"></a><span id="l15.10">   },</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  adjustAttributes: function() {</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  adjustAttributes: function(...aArgs) {</span>
<a href="#l15.14"></a><span id="l15.14">     // just proxy the call over to the datastore... we have to do this for</span>
<a href="#l15.15"></a><span id="l15.15">     //  'this' reasons.  we don't refactor things to avoid this because it does</span>
<a href="#l15.16"></a><span id="l15.16">     //  make some sense to have all the methods exposed from a single object,</span>
<a href="#l15.17"></a><span id="l15.17">     //  even if the implementation does live elsewhere.</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-    return this._datastore.adjustAttributes.apply(this._datastore, arguments);</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+    return this._datastore.adjustAttributes(...aArgs);</span>
<a href="#l15.20"></a><span id="l15.20">   },</span>
<a href="#l15.21"></a><span id="l15.21"> </span>
<a href="#l15.22"></a><span id="l15.22">   // also proxied...</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-  queryFromQuery: function() {</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-    return this._datastore.queryFromQuery.apply(this._datastore, arguments);</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+  queryFromQuery: function(...aArgs) {</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+    return this._datastore.queryFromQuery(...aArgs);</span>
<a href="#l15.27"></a><span id="l15.27">   }</span>
<a href="#l15.28"></a><span id="l15.28"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/db/gloda/modules/gloda.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/gloda.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -365,34 +365,33 @@ var Gloda = {</span>
<a href="#l16.4"></a><span id="l16.4">    *  contact name.</span>
<a href="#l16.5"></a><span id="l16.5">    * This method uses the indexer's callback handle mechanism, and does not</span>
<a href="#l16.6"></a><span id="l16.6">    *  obey traditional return semantics.</span>
<a href="#l16.7"></a><span id="l16.7">    *</span>
<a href="#l16.8"></a><span id="l16.8">    * We normalize all e-mail addresses to be lowercase as a normative measure.</span>
<a href="#l16.9"></a><span id="l16.9">    *</span>
<a href="#l16.10"></a><span id="l16.10">    * @param aCallbackHandle The GlodaIndexer callback handle (or equivalent)</span>
<a href="#l16.11"></a><span id="l16.11">    *   that you are operating under.</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-   * @param ... One or more strings.  Each string can contain zero or more</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+   * @param aAddrGroups... One or more strings.  Each string can contain zero or more</span>
<a href="#l16.14"></a><span id="l16.14">    *   e-mail addresses with display name.  If more than one address is given,</span>
<a href="#l16.15"></a><span id="l16.15">    *   they should be comma-delimited.  For example</span>
<a href="#l16.16"></a><span id="l16.16">    *   '&quot;Bob Smith&quot; &lt;bob@example.com&gt;' is an address with display name.  Mime</span>
<a href="#l16.17"></a><span id="l16.17">    *   header decoding is performed, but is ignorant of any folder-level</span>
<a href="#l16.18"></a><span id="l16.18">    *   character set overrides.</span>
<a href="#l16.19"></a><span id="l16.19">    * @returns via the callback handle mechanism, a list containing one sub-list</span>
<a href="#l16.20"></a><span id="l16.20">    *   for each string argument passed.  Each sub-list containts zero or more</span>
<a href="#l16.21"></a><span id="l16.21">    *   GlodaIdentity instances corresponding to the addresses provided.</span>
<a href="#l16.22"></a><span id="l16.22">    */</span>
<a href="#l16.23"></a><span id="l16.23">   getOrCreateMailIdentities:</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineminus">-      function* gloda_ns_getOrCreateMailIdentities(aCallbackHandle) {</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+      function* gloda_ns_getOrCreateMailIdentities(aCallbackHandle, ...aAddrGroups) {</span>
<a href="#l16.26"></a><span id="l16.26">     let addresses = {};</span>
<a href="#l16.27"></a><span id="l16.27">     let resultLists = [];</span>
<a href="#l16.28"></a><span id="l16.28"> </span>
<a href="#l16.29"></a><span id="l16.29">     // parse the strings</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-    for (let iArg = 1; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-      let aMailAddresses = arguments[iArg];</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+    for (let aMailAddresses of aAddrGroups) {</span>
<a href="#l16.33"></a><span id="l16.33">       let parsed = GlodaUtils.parseMailAddresses(aMailAddresses);</span>
<a href="#l16.34"></a><span id="l16.34"> </span>
<a href="#l16.35"></a><span id="l16.35">       let resultList = [];</span>
<a href="#l16.36"></a><span id="l16.36">       resultLists.push(resultList);</span>
<a href="#l16.37"></a><span id="l16.37"> </span>
<a href="#l16.38"></a><span id="l16.38">       let identities = [];</span>
<a href="#l16.39"></a><span id="l16.39">       for (let iAddress = 0; iAddress &lt; parsed.count; iAddress++) {</span>
<a href="#l16.40"></a><span id="l16.40">         let address = parsed.addresses[iAddress].toLowerCase();</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineat">@@ -920,21 +919,18 @@ var Gloda = {</span>
<a href="#l16.42"></a><span id="l16.42">       aNounDef._dbMeta = {};</span>
<a href="#l16.43"></a><span id="l16.43">       aNounDef.class.prototype.NOUN_ID = aNounDef.id;</span>
<a href="#l16.44"></a><span id="l16.44">       aNounDef.class.prototype.NOUN_DEF = aNounDef;</span>
<a href="#l16.45"></a><span id="l16.45">       aNounDef.toJSON = this._managedToJSON;</span>
<a href="#l16.46"></a><span id="l16.46"> </span>
<a href="#l16.47"></a><span id="l16.47">       aNounDef.specialLoadAttribs = [];</span>
<a href="#l16.48"></a><span id="l16.48"> </span>
<a href="#l16.49"></a><span id="l16.49">       // - define the 'id' constrainer</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineminus">-      let idConstrainer = function() {</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineminus">-        let constraint = [GlodaDatastore.kConstraintIdIn, null];</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineminus">-        for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineminus">-          constraint.push(arguments[iArg]);</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineminus">-        }</span>
<a href="#l16.55"></a><span id="l16.55" class="difflineplus">+      let idConstrainer = function(...aArgs) {</span>
<a href="#l16.56"></a><span id="l16.56" class="difflineplus">+        let constraint = [GlodaDatastore.kConstraintIdIn, null, ...aArgs];</span>
<a href="#l16.57"></a><span id="l16.57">         this._constraints.push(constraint);</span>
<a href="#l16.58"></a><span id="l16.58">         return this;</span>
<a href="#l16.59"></a><span id="l16.59">       };</span>
<a href="#l16.60"></a><span id="l16.60">       aNounDef.queryClass.prototype.id = idConstrainer;</span>
<a href="#l16.61"></a><span id="l16.61">     }</span>
<a href="#l16.62"></a><span id="l16.62">     if (aNounDef.cache) {</span>
<a href="#l16.63"></a><span id="l16.63">       let cacheCost = aNounDef.cacheCost || 1024;</span>
<a href="#l16.64"></a><span id="l16.64">       let cacheBudget = aNounDef.cacheBudget || 128 * 1024;</span>
<a href="#l16.65"></a><span id="l16.65" class="difflineat">@@ -1505,31 +1501,25 @@ var Gloda = {</span>
<a href="#l16.66"></a><span id="l16.66">   _bindAttribute: function gloda_ns_bindAttr(aAttrDef, aSubjectNounDef) {</span>
<a href="#l16.67"></a><span id="l16.67">     let objectNounDef = aAttrDef.objectNounDef;</span>
<a href="#l16.68"></a><span id="l16.68"> </span>
<a href="#l16.69"></a><span id="l16.69">     // -- the query constraint helpers</span>
<a href="#l16.70"></a><span id="l16.70">     if (aSubjectNounDef.queryClass !== undefined) {</span>
<a href="#l16.71"></a><span id="l16.71">       let constrainer;</span>
<a href="#l16.72"></a><span id="l16.72">       let canQuery = true;</span>
<a href="#l16.73"></a><span id="l16.73">       if ((&quot;special&quot; in aAttrDef) &amp;&amp; (aAttrDef.special == this.kSpecialFulltext)) {</span>
<a href="#l16.74"></a><span id="l16.74" class="difflineminus">-        constrainer = function() {</span>
<a href="#l16.75"></a><span id="l16.75" class="difflineminus">-          let constraint = [GlodaDatastore.kConstraintFulltext, aAttrDef];</span>
<a href="#l16.76"></a><span id="l16.76" class="difflineminus">-          for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l16.77"></a><span id="l16.77" class="difflineminus">-            constraint.push(arguments[iArg]);</span>
<a href="#l16.78"></a><span id="l16.78" class="difflineminus">-          }</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineplus">+        constrainer = function(...aArgs) {</span>
<a href="#l16.80"></a><span id="l16.80" class="difflineplus">+          let constraint = [GlodaDatastore.kConstraintFulltext, aAttrDef, ...aArgs];</span>
<a href="#l16.81"></a><span id="l16.81">           this._constraints.push(constraint);</span>
<a href="#l16.82"></a><span id="l16.82">           return this;</span>
<a href="#l16.83"></a><span id="l16.83">         };</span>
<a href="#l16.84"></a><span id="l16.84">       }</span>
<a href="#l16.85"></a><span id="l16.85">       else if (aAttrDef.canQuery || aAttrDef.attributeName.startsWith(&quot;_&quot;)) {</span>
<a href="#l16.86"></a><span id="l16.86" class="difflineminus">-        constrainer = function() {</span>
<a href="#l16.87"></a><span id="l16.87" class="difflineminus">-          let constraint = [GlodaDatastore.kConstraintIn, aAttrDef];</span>
<a href="#l16.88"></a><span id="l16.88" class="difflineminus">-          for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l16.89"></a><span id="l16.89" class="difflineminus">-            constraint.push(arguments[iArg]);</span>
<a href="#l16.90"></a><span id="l16.90" class="difflineminus">-          }</span>
<a href="#l16.91"></a><span id="l16.91" class="difflineplus">+        constrainer = function(...aArgs) {</span>
<a href="#l16.92"></a><span id="l16.92" class="difflineplus">+          let constraint = [GlodaDatastore.kConstraintIn, aAttrDef, ...aArgs];</span>
<a href="#l16.93"></a><span id="l16.93">           this._constraints.push(constraint);</span>
<a href="#l16.94"></a><span id="l16.94">           return this;</span>
<a href="#l16.95"></a><span id="l16.95">         };</span>
<a href="#l16.96"></a><span id="l16.96">       } else {</span>
<a href="#l16.97"></a><span id="l16.97">         constrainer = function() {</span>
<a href="#l16.98"></a><span id="l16.98">           throw new Error(</span>
<a href="#l16.99"></a><span id="l16.99">               &quot;Cannot query on attribute &quot;+aAttrDef.attributeName</span>
<a href="#l16.100"></a><span id="l16.100">             + &quot; because its canQuery parameter hasn't been set to true.&quot;</span>
<a href="#l16.101"></a><span id="l16.101" class="difflineat">@@ -1544,55 +1534,49 @@ var Gloda = {</span>
<a href="#l16.102"></a><span id="l16.102">       // Don't bind extra query-able attributes if we're unable to perform a</span>
<a href="#l16.103"></a><span id="l16.103">       // search on the attribute.</span>
<a href="#l16.104"></a><span id="l16.104">       if (!canQuery)</span>
<a href="#l16.105"></a><span id="l16.105">         return;</span>
<a href="#l16.106"></a><span id="l16.106"> </span>
<a href="#l16.107"></a><span id="l16.107">       // - ranged value helper: fooRange</span>
<a href="#l16.108"></a><span id="l16.108">       if (objectNounDef.continuous) {</span>
<a href="#l16.109"></a><span id="l16.109">         // takes one or more tuples of [lower bound, upper bound]</span>
<a href="#l16.110"></a><span id="l16.110" class="difflineminus">-        let rangedConstrainer = function() {</span>
<a href="#l16.111"></a><span id="l16.111" class="difflineminus">-          let constraint = [GlodaDatastore.kConstraintRanges, aAttrDef];</span>
<a href="#l16.112"></a><span id="l16.112" class="difflineminus">-          for (let iArg = 0; iArg &lt; arguments.length; iArg++ ) {</span>
<a href="#l16.113"></a><span id="l16.113" class="difflineminus">-            constraint.push(arguments[iArg]);</span>
<a href="#l16.114"></a><span id="l16.114" class="difflineminus">-          }</span>
<a href="#l16.115"></a><span id="l16.115" class="difflineplus">+        let rangedConstrainer = function(...aArgs) {</span>
<a href="#l16.116"></a><span id="l16.116" class="difflineplus">+          let constraint = [GlodaDatastore.kConstraintRanges, aAttrDef, ...aArgs];</span>
<a href="#l16.117"></a><span id="l16.117">           this._constraints.push(constraint);</span>
<a href="#l16.118"></a><span id="l16.118">           return this;</span>
<a href="#l16.119"></a><span id="l16.119">         };</span>
<a href="#l16.120"></a><span id="l16.120"> </span>
<a href="#l16.121"></a><span id="l16.121">         aSubjectNounDef.queryClass.prototype[aAttrDef.boundName + &quot;Range&quot;] =</span>
<a href="#l16.122"></a><span id="l16.122">           rangedConstrainer;</span>
<a href="#l16.123"></a><span id="l16.123">       }</span>
<a href="#l16.124"></a><span id="l16.124"> </span>
<a href="#l16.125"></a><span id="l16.125">       // - string LIKE helper for special on-row attributes: fooLike</span>
<a href="#l16.126"></a><span id="l16.126">       // (it is impossible to store a string as an indexed attribute, which is</span>
<a href="#l16.127"></a><span id="l16.127">       //  why we do this for on-row only.)</span>
<a href="#l16.128"></a><span id="l16.128">       if ((&quot;special&quot; in aAttrDef) &amp;&amp; (aAttrDef.special == this.kSpecialString)) {</span>
<a href="#l16.129"></a><span id="l16.129" class="difflineminus">-        let likeConstrainer = function() {</span>
<a href="#l16.130"></a><span id="l16.130" class="difflineminus">-          let constraint = [GlodaDatastore.kConstraintStringLike, aAttrDef];</span>
<a href="#l16.131"></a><span id="l16.131" class="difflineminus">-          for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l16.132"></a><span id="l16.132" class="difflineminus">-            constraint.push(arguments[iArg]);</span>
<a href="#l16.133"></a><span id="l16.133" class="difflineminus">-          }</span>
<a href="#l16.134"></a><span id="l16.134" class="difflineplus">+        let likeConstrainer = function(...aArgs) {</span>
<a href="#l16.135"></a><span id="l16.135" class="difflineplus">+          let constraint = [GlodaDatastore.kConstraintStringLike, aAttrDef, ...aArgs];</span>
<a href="#l16.136"></a><span id="l16.136">           this._constraints.push(constraint);</span>
<a href="#l16.137"></a><span id="l16.137">           return this;</span>
<a href="#l16.138"></a><span id="l16.138">         };</span>
<a href="#l16.139"></a><span id="l16.139"> </span>
<a href="#l16.140"></a><span id="l16.140">         aSubjectNounDef.queryClass.prototype[aAttrDef.boundName + &quot;Like&quot;] =</span>
<a href="#l16.141"></a><span id="l16.141">           likeConstrainer;</span>
<a href="#l16.142"></a><span id="l16.142">       }</span>
<a href="#l16.143"></a><span id="l16.143"> </span>
<a href="#l16.144"></a><span id="l16.144">       // - Custom helpers provided by the noun type...</span>
<a href="#l16.145"></a><span id="l16.145">       if (&quot;queryHelpers&quot; in objectNounDef) {</span>
<a href="#l16.146"></a><span id="l16.146">         for (let name in objectNounDef.queryHelpers) {</span>
<a href="#l16.147"></a><span id="l16.147">           let helper = objectNounDef.queryHelpers[name];</span>
<a href="#l16.148"></a><span id="l16.148">           // we need a new closure...</span>
<a href="#l16.149"></a><span id="l16.149">           let helperFunc = helper;</span>
<a href="#l16.150"></a><span id="l16.150">           aSubjectNounDef.queryClass.prototype[aAttrDef.boundName + name] =</span>
<a href="#l16.151"></a><span id="l16.151" class="difflineminus">-            function() {</span>
<a href="#l16.152"></a><span id="l16.152" class="difflineminus">-              return helperFunc.call(this, aAttrDef, arguments);</span>
<a href="#l16.153"></a><span id="l16.153" class="difflineplus">+            function(...aArgs) {</span>
<a href="#l16.154"></a><span id="l16.154" class="difflineplus">+              return helperFunc.call(this, aAttrDef, ...aArgs);</span>
<a href="#l16.155"></a><span id="l16.155">             };</span>
<a href="#l16.156"></a><span id="l16.156">         }</span>
<a href="#l16.157"></a><span id="l16.157">       }</span>
<a href="#l16.158"></a><span id="l16.158">     }</span>
<a href="#l16.159"></a><span id="l16.159">   },</span>
<a href="#l16.160"></a><span id="l16.160"> </span>
<a href="#l16.161"></a><span id="l16.161">   /**</span>
<a href="#l16.162"></a><span id="l16.162">    * Names of attribute-specific localized strings and the JS attribute they are</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/db/gloda/modules/indexer.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/indexer.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -60,21 +60,21 @@ function IndexingJob(aJobType, aID, aIte</span>
<a href="#l17.4"></a><span id="l17.4">   this.callback = null;</span>
<a href="#l17.5"></a><span id="l17.5">   this.callbackThis = null;</span>
<a href="#l17.6"></a><span id="l17.6"> }</span>
<a href="#l17.7"></a><span id="l17.7"> IndexingJob.prototype = {</span>
<a href="#l17.8"></a><span id="l17.8">   /**</span>
<a href="#l17.9"></a><span id="l17.9">    * Invoke the callback associated with this job, passing through all arguments</span>
<a href="#l17.10"></a><span id="l17.10">    *  received by this function to the callback function.</span>
<a href="#l17.11"></a><span id="l17.11">    */</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-  safelyInvokeCallback: function() {</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  safelyInvokeCallback: function(...aArgs) {</span>
<a href="#l17.14"></a><span id="l17.14">     if (!this.callback)</span>
<a href="#l17.15"></a><span id="l17.15">       return;</span>
<a href="#l17.16"></a><span id="l17.16">     try {</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineminus">-      this.callback.apply(this.callbackThis, arguments);</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+      this.callback.apply(this.callbackThis, aArgs);</span>
<a href="#l17.19"></a><span id="l17.19">     }</span>
<a href="#l17.20"></a><span id="l17.20">     catch(ex) {</span>
<a href="#l17.21"></a><span id="l17.21">       GlodaIndexer._log.warn(&quot;job callback invocation problem:&quot;, ex);</span>
<a href="#l17.22"></a><span id="l17.22">     }</span>
<a href="#l17.23"></a><span id="l17.23">   },</span>
<a href="#l17.24"></a><span id="l17.24">   toString: function IndexingJob_toString() {</span>
<a href="#l17.25"></a><span id="l17.25">     return &quot;[job:&quot; + this.jobType +</span>
<a href="#l17.26"></a><span id="l17.26">       &quot; id:&quot; + this.id + &quot; items:&quot; + (this.items ? this.items.length : &quot;no&quot;) +</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineat">@@ -748,18 +748,18 @@ var GlodaIndexer = {</span>
<a href="#l17.28"></a><span id="l17.28">    */</span>
<a href="#l17.29"></a><span id="l17.29">   _timerCallbackDriver: function gloda_index_timerCallbackDriver() {</span>
<a href="#l17.30"></a><span id="l17.30">     GlodaIndexer.callbackDriver();</span>
<a href="#l17.31"></a><span id="l17.31">   },</span>
<a href="#l17.32"></a><span id="l17.32"> </span>
<a href="#l17.33"></a><span id="l17.33">   /**</span>
<a href="#l17.34"></a><span id="l17.34">    * A simple callback driver wrapper to provide 'this'.</span>
<a href="#l17.35"></a><span id="l17.35">    */</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineminus">-  _wrapCallbackDriver: function gloda_index_wrapCallbackDriver() {</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineminus">-    GlodaIndexer.callbackDriver.apply(GlodaIndexer, arguments);</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineplus">+  _wrapCallbackDriver: function gloda_index_wrapCallbackDriver(...aArgs) {</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineplus">+    GlodaIndexer.callbackDriver(...aArgs);</span>
<a href="#l17.40"></a><span id="l17.40">   },</span>
<a href="#l17.41"></a><span id="l17.41"> </span>
<a href="#l17.42"></a><span id="l17.42">   /**</span>
<a href="#l17.43"></a><span id="l17.43">    * The current processing 'batch' generator, produced by a call to workBatch()</span>
<a href="#l17.44"></a><span id="l17.44">    *  and used by callbackDriver to drive execution.</span>
<a href="#l17.45"></a><span id="l17.45">    */</span>
<a href="#l17.46"></a><span id="l17.46">   _batch: null,</span>
<a href="#l17.47"></a><span id="l17.47">   _inCallback: false,</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineat">@@ -769,33 +769,33 @@ var GlodaIndexer = {</span>
<a href="#l17.49"></a><span id="l17.49">    *  (stored in _batch) which run until they are done (kWorkDone) or they</span>
<a href="#l17.50"></a><span id="l17.50">    *  (really the embedded activeIterator) encounter something asynchronous.</span>
<a href="#l17.51"></a><span id="l17.51">    *  The convention is that all the callback handlers end up calling us,</span>
<a href="#l17.52"></a><span id="l17.52">    *  ensuring that control-flow properly resumes.  If the batch completes,</span>
<a href="#l17.53"></a><span id="l17.53">    *  we re-schedule ourselves after a time delay (controlled by _INDEX_INTERVAL)</span>
<a href="#l17.54"></a><span id="l17.54">    *  and return.  (We use one-shot timers because repeating-slack does not</span>
<a href="#l17.55"></a><span id="l17.55">    *  know enough to deal with our (current) asynchronous nature.)</span>
<a href="#l17.56"></a><span id="l17.56">    */</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineminus">-  callbackDriver: function gloda_index_callbackDriver() {</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineplus">+  callbackDriver: function gloda_index_callbackDriver(...aArgs) {</span>
<a href="#l17.59"></a><span id="l17.59">     // just bail if we are shutdown</span>
<a href="#l17.60"></a><span id="l17.60">     if (this._indexerIsShutdown)</span>
<a href="#l17.61"></a><span id="l17.61">       return;</span>
<a href="#l17.62"></a><span id="l17.62"> </span>
<a href="#l17.63"></a><span id="l17.63">     // it is conceivable that someone we call will call something that in some</span>
<a href="#l17.64"></a><span id="l17.64">     //  cases might be asynchronous, and in other cases immediately generate</span>
<a href="#l17.65"></a><span id="l17.65">     //  events without returning.  In the interest of (stack-depth) sanity,</span>
<a href="#l17.66"></a><span id="l17.66">     //  let's handle this by performing a minimal time-delay callback.</span>
<a href="#l17.67"></a><span id="l17.67">     // this is also now a good thing sequencing-wise.  if we get our callback</span>
<a href="#l17.68"></a><span id="l17.68">     //  with data before the underlying function has yielded, we obviously can't</span>
<a href="#l17.69"></a><span id="l17.69">     //  cram the data in yet.  Our options in this case are to either mark the</span>
<a href="#l17.70"></a><span id="l17.70">     //  fact that the callback has already happened and immediately return to</span>
<a href="#l17.71"></a><span id="l17.71">     //  the iterator when it does bubble up the kWorkAsync, or we can do as we</span>
<a href="#l17.72"></a><span id="l17.72">     //  have been doing, but save the</span>
<a href="#l17.73"></a><span id="l17.73">     if (this._inCallback) {</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineminus">-      this._savedCallbackArgs = arguments;</span>
<a href="#l17.75"></a><span id="l17.75" class="difflineplus">+      this._savedCallbackArgs = aArgs;</span>
<a href="#l17.76"></a><span id="l17.76">       this._timer.initWithCallback(this._timerCallbackDriver,</span>
<a href="#l17.77"></a><span id="l17.77">                                    0,</span>
<a href="#l17.78"></a><span id="l17.78">                                    Ci.nsITimer.TYPE_ONE_SHOT);</span>
<a href="#l17.79"></a><span id="l17.79">       return;</span>
<a href="#l17.80"></a><span id="l17.80">     }</span>
<a href="#l17.81"></a><span id="l17.81">     this._inCallback = true;</span>
<a href="#l17.82"></a><span id="l17.82"> </span>
<a href="#l17.83"></a><span id="l17.83">     try {</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineat">@@ -808,17 +808,17 @@ var GlodaIndexer = {</span>
<a href="#l17.85"></a><span id="l17.85">       //  someone else will be receiving the callback, and they will call us when</span>
<a href="#l17.86"></a><span id="l17.86">       //  they are done doing their thing.</span>
<a href="#l17.87"></a><span id="l17.87">       let args;</span>
<a href="#l17.88"></a><span id="l17.88">       if (this._savedCallbackArgs != null) {</span>
<a href="#l17.89"></a><span id="l17.89">         args = this._savedCallbackArgs;</span>
<a href="#l17.90"></a><span id="l17.90">         this._savedCallbackArgs = null;</span>
<a href="#l17.91"></a><span id="l17.91">       }</span>
<a href="#l17.92"></a><span id="l17.92">       else</span>
<a href="#l17.93"></a><span id="l17.93" class="difflineminus">-        args = arguments; //Array.from(arguments);</span>
<a href="#l17.94"></a><span id="l17.94" class="difflineplus">+        args = aArgs;</span>
<a href="#l17.95"></a><span id="l17.95"> </span>
<a href="#l17.96"></a><span id="l17.96">       let result;</span>
<a href="#l17.97"></a><span id="l17.97">       if (args.length == 0)</span>
<a href="#l17.98"></a><span id="l17.98">         result = this._batch.next().value;</span>
<a href="#l17.99"></a><span id="l17.99">       else if (args.length == 1)</span>
<a href="#l17.100"></a><span id="l17.100">         result = this._batch.next(args[0]).value;</span>
<a href="#l17.101"></a><span id="l17.101">       else // arguments works with destructuring assignment</span>
<a href="#l17.102"></a><span id="l17.102">         result = this._batch.next(args).value;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/db/gloda/modules/log4moz.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/log4moz.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -369,42 +369,42 @@ Logger.prototype = {</span>
<a href="#l18.4"></a><span id="l18.4">     let message;</span>
<a href="#l18.5"></a><span id="l18.5">     let appenders = this.appenders;</span>
<a href="#l18.6"></a><span id="l18.6">     for (let i = 0; i &lt; appenders.length; i++){</span>
<a href="#l18.7"></a><span id="l18.7">       let appender = appenders[i];</span>
<a href="#l18.8"></a><span id="l18.8">       if (appender.level &gt; level)</span>
<a href="#l18.9"></a><span id="l18.9">         continue;</span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11">       if (!message)</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-        message = new LogMessage(this._name, level, Array.from(args));</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+        message = new LogMessage(this._name, level, args);</span>
<a href="#l18.14"></a><span id="l18.14"> </span>
<a href="#l18.15"></a><span id="l18.15">       appender.append(message);</span>
<a href="#l18.16"></a><span id="l18.16">     }</span>
<a href="#l18.17"></a><span id="l18.17">   },</span>
<a href="#l18.18"></a><span id="l18.18"> </span>
<a href="#l18.19"></a><span id="l18.19" class="difflineminus">-  fatal: function Logger_fatal() {</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineminus">-    this.log(Log4Moz.Level.Fatal, arguments);</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineplus">+  fatal: function Logger_fatal(...aArgs) {</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+    this.log(Log4Moz.Level.Fatal, aArgs);</span>
<a href="#l18.23"></a><span id="l18.23">   },</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineminus">-  error: function Logger_error() {</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">-    this.log(Log4Moz.Level.Error, arguments);</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineplus">+  error: function Logger_error(...aArgs) {</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+    this.log(Log4Moz.Level.Error, aArgs);</span>
<a href="#l18.28"></a><span id="l18.28">   },</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">-  warn: function Logger_warn() {</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-    this.log(Log4Moz.Level.Warn, arguments);</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  warn: function Logger_warn(...aArgs) {</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+    this.log(Log4Moz.Level.Warn, aArgs);</span>
<a href="#l18.33"></a><span id="l18.33">   },</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-  info: function Logger_info(string) {</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineminus">-    this.log(Log4Moz.Level.Info, arguments);</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+  info: function Logger_info(...aArgs) {</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineplus">+    this.log(Log4Moz.Level.Info, aArgs);</span>
<a href="#l18.38"></a><span id="l18.38">   },</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineminus">-  config: function Logger_config(string) {</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineminus">-    this.log(Log4Moz.Level.Config, arguments);</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineplus">+  config: function Logger_config(...aArgs) {</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+    this.log(Log4Moz.Level.Config, aArgs);</span>
<a href="#l18.43"></a><span id="l18.43">   },</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineminus">-  debug: function Logger_debug(string) {</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineminus">-    this.log(Log4Moz.Level.Debug, arguments);</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineplus">+  debug: function Logger_debug(...aArgs) {</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+    this.log(Log4Moz.Level.Debug, aArgs);</span>
<a href="#l18.48"></a><span id="l18.48">   },</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineminus">-  trace: function Logger_trace(string) {</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineminus">-    this.log(Log4Moz.Level.Trace, arguments);</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineplus">+  trace: function Logger_trace(...aArgs) {</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+    this.log(Log4Moz.Level.Trace, aArgs);</span>
<a href="#l18.53"></a><span id="l18.53">   }</span>
<a href="#l18.54"></a><span id="l18.54"> };</span>
<a href="#l18.55"></a><span id="l18.55"> </span>
<a href="#l18.56"></a><span id="l18.56"> /*</span>
<a href="#l18.57"></a><span id="l18.57">  * LoggerRepository</span>
<a href="#l18.58"></a><span id="l18.58">  * Implements a hierarchy of Loggers</span>
<a href="#l18.59"></a><span id="l18.59">  */</span>
<a href="#l18.60"></a><span id="l18.60"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/db/gloda/modules/public.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/public.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -17,18 +17,18 @@ Cu.import(&quot;resource:///modules/gloda/ind</span>
<a href="#l19.4"></a><span id="l19.4"> //  its indexers.</span>
<a href="#l19.5"></a><span id="l19.5"> GlodaIndexer._init();</span>
<a href="#l19.6"></a><span id="l19.6"> Cu.import(&quot;resource:///modules/gloda/index_msg.js&quot;);</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8"> /**</span>
<a href="#l19.9"></a><span id="l19.9">  * Expose some junk</span>
<a href="#l19.10"></a><span id="l19.10">  */</span>
<a href="#l19.11"></a><span id="l19.11"> function proxy(aSourceObj, aSourceAttr, aDestObj, aDestAttr) {</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  aDestObj[aDestAttr] = function() {</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-    return aSourceObj[aSourceAttr].apply(aSourceObj, arguments);</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+  aDestObj[aDestAttr] = function(...aArgs) {</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+    return aSourceObj[aSourceAttr](...aArgs);</span>
<a href="#l19.16"></a><span id="l19.16">   };</span>
<a href="#l19.17"></a><span id="l19.17"> }</span>
<a href="#l19.18"></a><span id="l19.18"> </span>
<a href="#l19.19"></a><span id="l19.19"> proxy(GlodaIndexer, &quot;addListener&quot;, Gloda, &quot;addIndexerListener&quot;);</span>
<a href="#l19.20"></a><span id="l19.20"> proxy(GlodaIndexer, &quot;removeListener&quot;, Gloda, &quot;removeIndexerListener&quot;);</span>
<a href="#l19.21"></a><span id="l19.21"> proxy(GlodaMsgIndexer, &quot;isMessageIndexed&quot;, Gloda, &quot;isMessageIndexed&quot;);</span>
<a href="#l19.22"></a><span id="l19.22"> proxy(GlodaMsgIndexer, &quot;setFolderIndexingPriority&quot;, Gloda,</span>
<a href="#l19.23"></a><span id="l19.23">       &quot;setFolderIndexingPriority&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/db/gloda/modules/query.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/query.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -78,21 +78,18 @@ GlodaQueryClass.prototype = {</span>
<a href="#l20.4"></a><span id="l20.4">   or: function gloda_query_or() {</span>
<a href="#l20.5"></a><span id="l20.5">     let owner = this._owner || this;</span>
<a href="#l20.6"></a><span id="l20.6">     let orQuery = new this._queryClass();</span>
<a href="#l20.7"></a><span id="l20.7">     orQuery._owner = owner;</span>
<a href="#l20.8"></a><span id="l20.8">     owner._unions.push(orQuery);</span>
<a href="#l20.9"></a><span id="l20.9">     return orQuery;</span>
<a href="#l20.10"></a><span id="l20.10">   },</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-  orderBy: function gloda_query_orderBy() {</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-    for (let iArg = 0; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-      let arg = arguments[iArg];</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-      this._order.push(arg);</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-    }</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+  orderBy: function gloda_query_orderBy(...aArgs) {</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+    this._order.push(...aArgs);</span>
<a href="#l20.19"></a><span id="l20.19">     return this;</span>
<a href="#l20.20"></a><span id="l20.20">   },</span>
<a href="#l20.21"></a><span id="l20.21"> </span>
<a href="#l20.22"></a><span id="l20.22">   limit: function gloda_query_limit(aLimit) {</span>
<a href="#l20.23"></a><span id="l20.23">     this._limit = aLimit;</span>
<a href="#l20.24"></a><span id="l20.24">     return this;</span>
<a href="#l20.25"></a><span id="l20.25">   },</span>
<a href="#l20.26"></a><span id="l20.26"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/base_gloda_content.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/base_gloda_content.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -138,19 +138,19 @@ function test_stream_message(info) {</span>
<a href="#l21.4"></a><span id="l21.4">     verify_message_content(info, info._synMsg, info._glodaMsg, aMsgHdr,</span>
<a href="#l21.5"></a><span id="l21.5">                            aMimeMsg);</span>
<a href="#l21.6"></a><span id="l21.6">   });</span>
<a href="#l21.7"></a><span id="l21.7"> }</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9"> // instrument GlodaFundAttr so we can check the count</span>
<a href="#l21.10"></a><span id="l21.10"> var originalWhittler = GlodaFundAttr.contentWhittle;</span>
<a href="#l21.11"></a><span id="l21.11"> var whittleCount = 0;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-GlodaFundAttr.contentWhittle = function whittler_counter() {</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+GlodaFundAttr.contentWhittle = function(...aArgs) {</span>
<a href="#l21.14"></a><span id="l21.14">   whittleCount++;</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-  return originalWhittler.apply(this, arguments);</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+  return originalWhittler.apply(this, aArgs);</span>
<a href="#l21.17"></a><span id="l21.17"> };</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19"> function verify_message_content(aInfo, aSynMsg, aGlodaMsg, aMsgHdr, aMimeMsg) {</span>
<a href="#l21.20"></a><span id="l21.20">   if (aMimeMsg == null)</span>
<a href="#l21.21"></a><span id="l21.21">     do_throw(&quot;Message streaming should work; check test_mime_emitter.js first&quot;);</span>
<a href="#l21.22"></a><span id="l21.22"> </span>
<a href="#l21.23"></a><span id="l21.23">   whittleCount = 0;</span>
<a href="#l21.24"></a><span id="l21.24">   let content = Gloda.getMessageContent(aGlodaMsg, aMimeMsg);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/resources/glodaTestHelper.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -200,53 +200,53 @@ function _prepareIndexerForTesting() {</span>
<a href="#l22.4"></a><span id="l22.4"> </span>
<a href="#l22.5"></a><span id="l22.5"> /*</span>
<a href="#l22.6"></a><span id="l22.6">  * Add logsploder helpers to let us see what is being passed to the database</span>
<a href="#l22.7"></a><span id="l22.7">  *  manipulation functions and what is being extracted.</span>
<a href="#l22.8"></a><span id="l22.8">  */</span>
<a href="#l22.9"></a><span id="l22.9"> if (logHelperHasInterestedListeners) {</span>
<a href="#l22.10"></a><span id="l22.10">   let msgNounDef = GlodaMessage.prototype.NOUN_DEF;</span>
<a href="#l22.11"></a><span id="l22.11">   let orig_insertMessage = GlodaDatastore.insertMessage;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-  GlodaDatastore.insertMessage = msgNounDef.objInsert = function() {</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-    mark_action(&quot;glodaWrapped&quot;, &quot;insertMessage&quot;, [arguments[0]]);</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-    return orig_insertMessage.apply(GlodaDatastore, arguments);</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineplus">+  GlodaDatastore.insertMessage = msgNounDef.objInsert = function(...aArgs) {</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+    mark_action(&quot;glodaWrapped&quot;, &quot;insertMessage&quot;, [aArgs[0]]);</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineplus">+    return orig_insertMessage.apply(GlodaDatastore, aArgs);</span>
<a href="#l22.18"></a><span id="l22.18">   };</span>
<a href="#l22.19"></a><span id="l22.19"> </span>
<a href="#l22.20"></a><span id="l22.20">   let orig_updateMessage = GlodaDatastore.updateMessage;</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineminus">-  GlodaDatastore.updateMessage = msgNounDef.objUpdate = function() {</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineminus">-    mark_action(&quot;glodaWrapped&quot;, &quot;updateMessage&quot;, [arguments[0]]);</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineminus">-    return orig_updateMessage.apply(GlodaDatastore, arguments);</span>
<a href="#l22.24"></a><span id="l22.24" class="difflineplus">+  GlodaDatastore.updateMessage = msgNounDef.objUpdate = function(...aArgs) {</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineplus">+    mark_action(&quot;glodaWrapped&quot;, &quot;updateMessage&quot;, [aArgs[0]]);</span>
<a href="#l22.26"></a><span id="l22.26" class="difflineplus">+    return orig_updateMessage.apply(GlodaDatastore, aArgs);</span>
<a href="#l22.27"></a><span id="l22.27">   };</span>
<a href="#l22.28"></a><span id="l22.28"> </span>
<a href="#l22.29"></a><span id="l22.29">   let orig__messageFromRow = GlodaDatastore._messageFromRow;</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-  GlodaDatastore._messageFromRow = msgNounDef.objFromRow = function() {</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-    let rv = orig__messageFromRow.apply(GlodaDatastore, arguments);</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+  GlodaDatastore._messageFromRow = msgNounDef.objFromRow = function(...aArgs) {</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineplus">+    let rv = orig__messageFromRow.apply(GlodaDatastore, aArgs);</span>
<a href="#l22.34"></a><span id="l22.34">     mark_action(&quot;glodaWrapped&quot;, &quot;_messageFromRow&quot;, [rv]);</span>
<a href="#l22.35"></a><span id="l22.35">     return rv;</span>
<a href="#l22.36"></a><span id="l22.36">   };</span>
<a href="#l22.37"></a><span id="l22.37"> </span>
<a href="#l22.38"></a><span id="l22.38">   let orig_updateMessageLocations = GlodaDatastore.updateMessageLocations;</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-  GlodaDatastore.updateMessageLocations = function() {</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineplus">+  GlodaDatastore.updateMessageLocations = function(...aArgs) {</span>
<a href="#l22.41"></a><span id="l22.41">     mark_action(&quot;glodaWrapped&quot;, &quot;updateMessageLocations&quot;,</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineminus">-                [&quot;ids&quot;, arguments[0], &quot;keys&quot;, arguments[1], &quot;dest folder&quot;,</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineminus">-                 arguments[2], &quot;do not notify?&quot;, arguments[3]]);</span>
<a href="#l22.44"></a><span id="l22.44" class="difflineminus">-    orig_updateMessageLocations.apply(GlodaDatastore, arguments);</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineplus">+                [&quot;ids&quot;, aArgs[0], &quot;keys&quot;, aArgs[1], &quot;dest folder&quot;,</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineplus">+                 aArgs[2], &quot;do not notify?&quot;, aArgs[3]]);</span>
<a href="#l22.47"></a><span id="l22.47" class="difflineplus">+    orig_updateMessageLocations.apply(GlodaDatastore, aArgs);</span>
<a href="#l22.48"></a><span id="l22.48">   };</span>
<a href="#l22.49"></a><span id="l22.49">   let orig_updateMessageKeys = GlodaDatastore.updateMessageKeys;</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-  GlodaDatastore.updateMessageKeys = function() {</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineplus">+  GlodaDatastore.updateMessageKeys = function(...aArgs) {</span>
<a href="#l22.52"></a><span id="l22.52">     mark_action(&quot;glodaWrapped&quot;, &quot;updateMessageKeys&quot;</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineminus">-                [&quot;ids&quot;, arguments[0], &quot;keys&quot;, arguments[1]]);</span>
<a href="#l22.54"></a><span id="l22.54" class="difflineminus">-    orig_updateMessageKeys.apply(GlodaDatastore, arguments);</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineplus">+                [&quot;ids&quot;, aArgs[0], &quot;keys&quot;, aArgs[1]]);</span>
<a href="#l22.56"></a><span id="l22.56" class="difflineplus">+    orig_updateMessageKeys.apply(GlodaDatastore, aArgs);</span>
<a href="#l22.57"></a><span id="l22.57">   }</span>
<a href="#l22.58"></a><span id="l22.58"> </span>
<a href="#l22.59"></a><span id="l22.59">   /* also, let us see the results of cache lookups so we can know if we are</span>
<a href="#l22.60"></a><span id="l22.60">      performing cache unification when a load occurs. */</span>
<a href="#l22.61"></a><span id="l22.61">   let orig_cacheLookupOne = GlodaCollectionManager.cacheLookupOne;</span>
<a href="#l22.62"></a><span id="l22.62" class="difflineminus">-  GlodaCollectionManager.cacheLookupOne = function() {</span>
<a href="#l22.63"></a><span id="l22.63" class="difflineminus">-    let rv = orig_cacheLookupOne.apply(GlodaCollectionManager, arguments);</span>
<a href="#l22.64"></a><span id="l22.64" class="difflineplus">+  GlodaCollectionManager.cacheLookupOne = function(...aArgs) {</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineplus">+    let rv = orig_cacheLookupOne.apply(GlodaCollectionManager, aArgs);</span>
<a href="#l22.66"></a><span id="l22.66">     mark_action(&quot;glodaWrapped&quot;, &quot;cacheLookupOne&quot;, [&quot;hit?&quot;, rv !== null]);</span>
<a href="#l22.67"></a><span id="l22.67">     return rv;</span>
<a href="#l22.68"></a><span id="l22.68">   }</span>
<a href="#l22.69"></a><span id="l22.69"> }</span>
<a href="#l22.70"></a><span id="l22.70"> </span>
<a href="#l22.71"></a><span id="l22.71"> var _wait_for_gloda_indexer_defaults = {</span>
<a href="#l22.72"></a><span id="l22.72">   verifier: null,</span>
<a href="#l22.73"></a><span id="l22.73">   augment: false,</span>
<a href="#l22.74"></a><span id="l22.74" class="difflineat">@@ -991,25 +991,25 @@ function queryExpect(aQuery, aExpectedSe</span>
<a href="#l22.75"></a><span id="l22.75"> </span>
<a href="#l22.76"></a><span id="l22.76"> /**</span>
<a href="#l22.77"></a><span id="l22.77">  * Run an (async) SQL statement against the gloda database.  The statement</span>
<a href="#l22.78"></a><span id="l22.78">  *  should be a SELECT COUNT; we check the count against aExpectedCount.</span>
<a href="#l22.79"></a><span id="l22.79">  *  Any additional arguments are positionally bound to the statement.</span>
<a href="#l22.80"></a><span id="l22.80">  *</span>
<a href="#l22.81"></a><span id="l22.81">  * We run the statement asynchronously to get a consistent view of the database.</span>
<a href="#l22.82"></a><span id="l22.82">  */</span>
<a href="#l22.83"></a><span id="l22.83" class="difflineminus">-function sqlExpectCount(aExpectedCount, aSQLString /* ... params */) {</span>
<a href="#l22.84"></a><span id="l22.84" class="difflineplus">+function sqlExpectCount(aExpectedCount, aSQLString, ...params) {</span>
<a href="#l22.85"></a><span id="l22.85">   let conn = GlodaDatastore.asyncConnection;</span>
<a href="#l22.86"></a><span id="l22.86">   let stmt = conn.createStatement(aSQLString);</span>
<a href="#l22.87"></a><span id="l22.87"> </span>
<a href="#l22.88"></a><span id="l22.88" class="difflineminus">-  for (let iArg = 2; iArg &lt; arguments.length; iArg++) {</span>
<a href="#l22.89"></a><span id="l22.89" class="difflineminus">-    GlodaDatastore._bindVariant(stmt, iArg-2, arguments[iArg]);</span>
<a href="#l22.90"></a><span id="l22.90" class="difflineplus">+  for (let iArg = 0; iArg &lt; params.length; iArg++) {</span>
<a href="#l22.91"></a><span id="l22.91" class="difflineplus">+    GlodaDatastore._bindVariant(stmt, iArg, params[iArg]);</span>
<a href="#l22.92"></a><span id="l22.92">   }</span>
<a href="#l22.93"></a><span id="l22.93"> </span>
<a href="#l22.94"></a><span id="l22.94" class="difflineminus">-  let desc = Array.prototype.slice.call(arguments, 1);</span>
<a href="#l22.95"></a><span id="l22.95" class="difflineplus">+  let desc = [aSQLString, ...params];</span>
<a href="#l22.96"></a><span id="l22.96">   mark_action(&quot;glodaTestHelper&quot;, &quot;running SQL count&quot;, desc);</span>
<a href="#l22.97"></a><span id="l22.97">   stmt.executeAsync(new _SqlExpectationListener(aExpectedCount, desc,</span>
<a href="#l22.98"></a><span id="l22.98">                                                 Components.stack.caller));</span>
<a href="#l22.99"></a><span id="l22.99">   // we don't need the statement anymore</span>
<a href="#l22.100"></a><span id="l22.100">   stmt.finalize();</span>
<a href="#l22.101"></a><span id="l22.101"> </span>
<a href="#l22.102"></a><span id="l22.102">   return false;</span>
<a href="#l22.103"></a><span id="l22.103"> }</span>
<a href="#l22.104"></a><span id="l22.104" class="difflineat">@@ -1095,18 +1095,18 @@ function wait_for_gloda_db_flush() {</span>
<a href="#l22.105"></a><span id="l22.105">   if (savedDepth)</span>
<a href="#l22.106"></a><span id="l22.106">     GlodaDatastore._beginTransaction();</span>
<a href="#l22.107"></a><span id="l22.107">   return false;</span>
<a href="#l22.108"></a><span id="l22.108"> }</span>
<a href="#l22.109"></a><span id="l22.109"> </span>
<a href="#l22.110"></a><span id="l22.110"> var _gloda_simulate_hang_data = null;</span>
<a href="#l22.111"></a><span id="l22.111"> var _gloda_simulate_hang_waiting_for_hang = false;</span>
<a href="#l22.112"></a><span id="l22.112"> </span>
<a href="#l22.113"></a><span id="l22.113" class="difflineminus">-function _simulate_hang_on_MsgHdrToMimeMessage() {</span>
<a href="#l22.114"></a><span id="l22.114" class="difflineminus">-  _gloda_simulate_hang_data = [MsgHdrToMimeMessage, null, arguments];</span>
<a href="#l22.115"></a><span id="l22.115" class="difflineplus">+function _simulate_hang_on_MsgHdrToMimeMessage(...aArgs) {</span>
<a href="#l22.116"></a><span id="l22.116" class="difflineplus">+  _gloda_simulate_hang_data = [MsgHdrToMimeMessage, null, aArgs];</span>
<a href="#l22.117"></a><span id="l22.117">   if (_gloda_simulate_hang_waiting_for_hang)</span>
<a href="#l22.118"></a><span id="l22.118">     async_driver();</span>
<a href="#l22.119"></a><span id="l22.119"> }</span>
<a href="#l22.120"></a><span id="l22.120"> </span>
<a href="#l22.121"></a><span id="l22.121"> /**</span>
<a href="#l22.122"></a><span id="l22.122">  * If you have configured gloda to hang while indexing, this is the thing</span>
<a href="#l22.123"></a><span id="l22.123">  *  you wait on to make sure the indexer actually gets to the point where it</span>
<a href="#l22.124"></a><span id="l22.124">  *  hangs.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/test_index_sweep_folder.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/test_index_sweep_folder.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -20,31 +20,30 @@ load(&quot;resources/asyncCallbackHandler.js&quot;</span>
<a href="#l23.4"></a><span id="l23.4">  * How many more enumerations before we should throw; 0 means don't throw.</span>
<a href="#l23.5"></a><span id="l23.5">  */</span>
<a href="#l23.6"></a><span id="l23.6"> var explode_enumeration_after = 0;</span>
<a href="#l23.7"></a><span id="l23.7"> GlodaMsgIndexer._original_indexerGetEnumerator =</span>
<a href="#l23.8"></a><span id="l23.8">   GlodaMsgIndexer._indexerGetEnumerator;</span>
<a href="#l23.9"></a><span id="l23.9"> /**</span>
<a href="#l23.10"></a><span id="l23.10">  * Wrapper for GlodaMsgIndexer._indexerGetEnumerator to cause explosions.</span>
<a href="#l23.11"></a><span id="l23.11">  */</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-GlodaMsgIndexer._indexerGetEnumerator = function() {</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+GlodaMsgIndexer._indexerGetEnumerator = function(...aArgs) {</span>
<a href="#l23.14"></a><span id="l23.14">   if (explode_enumeration_after &amp;&amp; !(--explode_enumeration_after))</span>
<a href="#l23.15"></a><span id="l23.15">     throw asyncExpectedEarlyAbort;</span>
<a href="#l23.16"></a><span id="l23.16"> </span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-  return GlodaMsgIndexer._original_indexerGetEnumerator.apply(</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineminus">-    GlodaMsgIndexer, arguments);</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineplus">+  return GlodaMsgIndexer._original_indexerGetEnumerator(...aArgs);</span>
<a href="#l23.20"></a><span id="l23.20"> };</span>
<a href="#l23.21"></a><span id="l23.21"> </span>
<a href="#l23.22"></a><span id="l23.22"> /**</span>
<a href="#l23.23"></a><span id="l23.23">  * Create a folder indexing job for the given injection folder handle and</span>
<a href="#l23.24"></a><span id="l23.24">  * run it until completion.</span>
<a href="#l23.25"></a><span id="l23.25">  */</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineminus">-function spin_folder_indexer() {</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineplus">+function spin_folder_indexer(...aArgs) {</span>
<a href="#l23.28"></a><span id="l23.28">   return async_run({func: _spin_folder_indexer_gen,</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineminus">-                    args: arguments});</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineplus">+                    args: aArgs});</span>
<a href="#l23.31"></a><span id="l23.31"> }</span>
<a href="#l23.32"></a><span id="l23.32"> function* _spin_folder_indexer_gen(aFolderHandle, aExpectedJobGoal) {</span>
<a href="#l23.33"></a><span id="l23.33">   let msgFolder = get_real_injection_folder(aFolderHandle);</span>
<a href="#l23.34"></a><span id="l23.34"> </span>
<a href="#l23.35"></a><span id="l23.35">   // cheat and use indexFolder to build the job for us</span>
<a href="#l23.36"></a><span id="l23.36">   GlodaMsgIndexer.indexFolder(msgFolder);</span>
<a href="#l23.37"></a><span id="l23.37">   // steal that job...</span>
<a href="#l23.38"></a><span id="l23.38">   let job = GlodaIndexer._indexQueue.pop();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/mime/jsmime/jsmime.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/mime/jsmime/jsmime.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -2015,19 +2015,18 @@ MimeParser.prototype.deliverEOF = functi</span>
<a href="#l24.4"></a><span id="l24.4">  * Calls a method on the emitter safely.</span>
<a href="#l24.5"></a><span id="l24.5">  *</span>
<a href="#l24.6"></a><span id="l24.6">  * This method ensures that errors in the emitter call won't cause the parser</span>
<a href="#l24.7"></a><span id="l24.7">  * to exit with an error, unless the user wants it to.</span>
<a href="#l24.8"></a><span id="l24.8">  *</span>
<a href="#l24.9"></a><span id="l24.9">  * @param funcname {String} The function name to call on the emitter.</span>
<a href="#l24.10"></a><span id="l24.10">  * @param args...           Extra arguments to pass into the emitter callback.</span>
<a href="#l24.11"></a><span id="l24.11">  */</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-MimeParser.prototype._callEmitter = function (funcname) {</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+MimeParser.prototype._callEmitter = function (funcname, ...args) {</span>
<a href="#l24.14"></a><span id="l24.14">   if (this._emitter &amp;&amp; funcname in this._emitter) {</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-    let args = Array.prototype.splice.call(arguments, 1);</span>
<a href="#l24.16"></a><span id="l24.16">     if (args.length &gt; 0 &amp;&amp; this._willIgnorePart(args[0])) {</span>
<a href="#l24.17"></a><span id="l24.17">       // partNum is always the first argument, so check to make sure that it</span>
<a href="#l24.18"></a><span id="l24.18">       // satisfies our emitter's pruneat requirement.</span>
<a href="#l24.19"></a><span id="l24.19">       return;</span>
<a href="#l24.20"></a><span id="l24.20">     }</span>
<a href="#l24.21"></a><span id="l24.21">     try {</span>
<a href="#l24.22"></a><span id="l24.22">       this._emitter[funcname].apply(this._emitter, args);</span>
<a href="#l24.23"></a><span id="l24.23">     } catch (e) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/mime/jsmime/test/mock_date.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/mime/jsmime/test/mock_date.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -52,21 +52,21 @@ for (let name of Object.getOwnPropertyNa</span>
<a href="#l25.4"></a><span id="l25.4">   if (MockDate.prototype.hasOwnProperty(name))</span>
<a href="#l25.5"></a><span id="l25.5">     continue;</span>
<a href="#l25.6"></a><span id="l25.6"> </span>
<a href="#l25.7"></a><span id="l25.7">   if (name.includes('UTC')) {</span>
<a href="#l25.8"></a><span id="l25.8">     // 'name' is already supposed to be freshly bound per newest ES6 drafts, but</span>
<a href="#l25.9"></a><span id="l25.9">     // current ES6 implementations reuse the bindings. Until implementations</span>
<a href="#l25.10"></a><span id="l25.10">     // catch up, use a new let to bind it freshly.</span>
<a href="#l25.11"></a><span id="l25.11">     let boundName = name;</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    Object.defineProperty(MockDate.prototype, name, { value: function () {</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-      return Date.prototype[boundName].call(this._realDate, arguments);</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+    Object.defineProperty(MockDate.prototype, name, { value: function(...aArgs) {</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+      return Date.prototype[boundName].call(this._realDate, aArgs);</span>
<a href="#l25.16"></a><span id="l25.16">     }});</span>
<a href="#l25.17"></a><span id="l25.17">   } else {</span>
<a href="#l25.18"></a><span id="l25.18">     let newName = 'getUTC' + name.substr(3);</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">-    Object.defineProperty(MockDate.prototype, name, { value: function () {</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineminus">-      return Date.prototype[newName].call(this._shiftedDate, arguments);</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+    Object.defineProperty(MockDate.prototype, name, { value: function(...aArgs) {</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineplus">+      return Date.prototype[newName].call(this._shiftedDate, aArgs);</span>
<a href="#l25.23"></a><span id="l25.23">     }});</span>
<a href="#l25.24"></a><span id="l25.24">   }</span>
<a href="#l25.25"></a><span id="l25.25"> }</span>
<a href="#l25.26"></a><span id="l25.26"> </span>
<a href="#l25.27"></a><span id="l25.27"> return MockDate;</span>
<a href="#l25.28"></a><span id="l25.28"> });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/mime/src/mimeJSComponents.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/mime/src/mimeJSComponents.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -497,16 +497,16 @@ MimeConverter.prototype = {</span>
<a href="#l26.4"></a><span id="l26.4">       value = value.replace(/[\r\n]\t/g, ' ')</span>
<a href="#l26.5"></a><span id="l26.5">                    .replace(/[\r\n]/g, '');</span>
<a href="#l26.6"></a><span id="l26.6">     }</span>
<a href="#l26.7"></a><span id="l26.7">     return value;</span>
<a href="#l26.8"></a><span id="l26.8">   },</span>
<a href="#l26.9"></a><span id="l26.9"> </span>
<a href="#l26.10"></a><span id="l26.10">   // This is identical to the above, except for factors that are handled by the</span>
<a href="#l26.11"></a><span id="l26.11">   // xpconnect conversion process</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-  decodeMimeHeaderToUTF8: function () {</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-    return this.decodeMimeHeader.apply(this, arguments);</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+  decodeMimeHeaderToUTF8: function (...aArgs) {</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+    return this.decodeMimeHeader(...aArgs);</span>
<a href="#l26.16"></a><span id="l26.16">   },</span>
<a href="#l26.17"></a><span id="l26.17"> };</span>
<a href="#l26.18"></a><span id="l26.18"> </span>
<a href="#l26.19"></a><span id="l26.19"> var components = [MimeHeaders, MimeWritableStructuredHeaders, MimeAddressParser,</span>
<a href="#l26.20"></a><span id="l26.20">   MimeConverter];</span>
<a href="#l26.21"></a><span id="l26.21"> var NSGetFactory = XPCOMUtils.generateNSGetFactory(components);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/test/fakeserver/nntpd.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/test/fakeserver/nntpd.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -380,18 +380,18 @@ NNTP_RFC977_handler.prototype = {</span>
<a href="#l27.4"></a><span id="l27.4">  * @param def   The object definition of the subclass prototype.</span>
<a href="#l27.5"></a><span id="l27.5">  */</span>
<a href="#l27.6"></a><span id="l27.6"> function subclass(sub, sup, def) {</span>
<a href="#l27.7"></a><span id="l27.7">   sub.prototype = new sup();</span>
<a href="#l27.8"></a><span id="l27.8">   for (let obj in def) {</span>
<a href="#l27.9"></a><span id="l27.9">     sub.prototype[obj] = def[obj];</span>
<a href="#l27.10"></a><span id="l27.10">   }</span>
<a href="#l27.11"></a><span id="l27.11"> }</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-function subconstructor(sub, sup) {</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-  sup.apply(sub, Array.prototype.slice.call(arguments, 2));</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+function subconstructor(sub, sup, ...aArgs) {</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+  sup.apply(sub, aArgs);</span>
<a href="#l27.16"></a><span id="l27.16">   sub.parent = new Proxy(sub, {</span>
<a href="#l27.17"></a><span id="l27.17">     get: function (target, name) {</span>
<a href="#l27.18"></a><span id="l27.18">       let res = sup.prototype[name];</span>
<a href="#l27.19"></a><span id="l27.19">       if (typeof res === &quot;function&quot;)</span>
<a href="#l27.20"></a><span id="l27.20">         return res.bind(sub);</span>
<a href="#l27.21"></a><span id="l27.21">       return res;</span>
<a href="#l27.22"></a><span id="l27.22">     }});</span>
<a href="#l27.23"></a><span id="l27.23"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/test/resources/messageGenerator.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/test/resources/messageGenerator.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -229,62 +229,62 @@ SyntheticPartMulti.prototype = {</span>
<a href="#l28.4"></a><span id="l28.4">     return s;</span>
<a href="#l28.5"></a><span id="l28.5">   }</span>
<a href="#l28.6"></a><span id="l28.6"> };</span>
<a href="#l28.7"></a><span id="l28.7"> SyntheticPartMulti.prototype.BOUNDARY_COUNTER_HOME = SyntheticPartMulti.prototype;</span>
<a href="#l28.8"></a><span id="l28.8"> </span>
<a href="#l28.9"></a><span id="l28.9"> /**</span>
<a href="#l28.10"></a><span id="l28.10">  * Multipart mixed (multipart/mixed) MIME part.</span>
<a href="#l28.11"></a><span id="l28.11">  */</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-function SyntheticPartMultiMixed() {</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-  SyntheticPartMulti.apply(this, arguments);</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+function SyntheticPartMultiMixed(...aArgs) {</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+  SyntheticPartMulti.apply(this, aArgs);</span>
<a href="#l28.16"></a><span id="l28.16"> }</span>
<a href="#l28.17"></a><span id="l28.17"> SyntheticPartMultiMixed.prototype = {</span>
<a href="#l28.18"></a><span id="l28.18">   __proto__: SyntheticPartMulti.prototype,</span>
<a href="#l28.19"></a><span id="l28.19">   _contentType: 'multipart/mixed',</span>
<a href="#l28.20"></a><span id="l28.20"> };</span>
<a href="#l28.21"></a><span id="l28.21"> </span>
<a href="#l28.22"></a><span id="l28.22"> /**</span>
<a href="#l28.23"></a><span id="l28.23">  * Multipart mixed (multipart/mixed) MIME part.</span>
<a href="#l28.24"></a><span id="l28.24">  */</span>
<a href="#l28.25"></a><span id="l28.25" class="difflineminus">-function SyntheticPartMultiParallel() {</span>
<a href="#l28.26"></a><span id="l28.26" class="difflineminus">-  SyntheticPartMulti.apply(this, arguments);</span>
<a href="#l28.27"></a><span id="l28.27" class="difflineplus">+function SyntheticPartMultiParallel(...aArgs) {</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineplus">+  SyntheticPartMulti.apply(this, aArgs);</span>
<a href="#l28.29"></a><span id="l28.29"> }</span>
<a href="#l28.30"></a><span id="l28.30"> SyntheticPartMultiParallel.prototype = {</span>
<a href="#l28.31"></a><span id="l28.31">   __proto__: SyntheticPartMulti.prototype,</span>
<a href="#l28.32"></a><span id="l28.32">   _contentType: 'multipart/parallel',</span>
<a href="#l28.33"></a><span id="l28.33"> };</span>
<a href="#l28.34"></a><span id="l28.34"> </span>
<a href="#l28.35"></a><span id="l28.35"> /**</span>
<a href="#l28.36"></a><span id="l28.36">  * Multipart digest (multipart/digest) MIME part.</span>
<a href="#l28.37"></a><span id="l28.37">  */</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineminus">-function SyntheticPartMultiDigest() {</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineminus">-  SyntheticPartMulti.apply(this, arguments);</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineplus">+function SyntheticPartMultiDigest(...aArgs) {</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineplus">+  SyntheticPartMulti.apply(this, aArgs);</span>
<a href="#l28.42"></a><span id="l28.42"> }</span>
<a href="#l28.43"></a><span id="l28.43"> SyntheticPartMultiDigest.prototype = {</span>
<a href="#l28.44"></a><span id="l28.44">   __proto__: SyntheticPartMulti.prototype,</span>
<a href="#l28.45"></a><span id="l28.45">   _contentType: 'multipart/digest',</span>
<a href="#l28.46"></a><span id="l28.46"> };</span>
<a href="#l28.47"></a><span id="l28.47"> </span>
<a href="#l28.48"></a><span id="l28.48"> /**</span>
<a href="#l28.49"></a><span id="l28.49">  * Multipart alternative (multipart/alternative) MIME part.</span>
<a href="#l28.50"></a><span id="l28.50">  */</span>
<a href="#l28.51"></a><span id="l28.51" class="difflineminus">-function SyntheticPartMultiAlternative() {</span>
<a href="#l28.52"></a><span id="l28.52" class="difflineminus">-  SyntheticPartMulti.apply(this, arguments);</span>
<a href="#l28.53"></a><span id="l28.53" class="difflineplus">+function SyntheticPartMultiAlternative(...aArgs) {</span>
<a href="#l28.54"></a><span id="l28.54" class="difflineplus">+  SyntheticPartMulti.apply(this, aArgs);</span>
<a href="#l28.55"></a><span id="l28.55"> }</span>
<a href="#l28.56"></a><span id="l28.56"> SyntheticPartMultiAlternative.prototype = {</span>
<a href="#l28.57"></a><span id="l28.57">   __proto__: SyntheticPartMulti.prototype,</span>
<a href="#l28.58"></a><span id="l28.58">   _contentType: 'multipart/alternative',</span>
<a href="#l28.59"></a><span id="l28.59"> };</span>
<a href="#l28.60"></a><span id="l28.60"> </span>
<a href="#l28.61"></a><span id="l28.61"> /**</span>
<a href="#l28.62"></a><span id="l28.62">  * Multipart related (multipart/related) MIME part.</span>
<a href="#l28.63"></a><span id="l28.63">  */</span>
<a href="#l28.64"></a><span id="l28.64" class="difflineminus">-function SyntheticPartMultiRelated() {</span>
<a href="#l28.65"></a><span id="l28.65" class="difflineminus">-  SyntheticPartMulti.apply(this, arguments);</span>
<a href="#l28.66"></a><span id="l28.66" class="difflineplus">+function SyntheticPartMultiRelated(...aArgs) {</span>
<a href="#l28.67"></a><span id="l28.67" class="difflineplus">+  SyntheticPartMulti.apply(this, aArgs);</span>
<a href="#l28.68"></a><span id="l28.68"> }</span>
<a href="#l28.69"></a><span id="l28.69"> SyntheticPartMultiRelated.prototype = {</span>
<a href="#l28.70"></a><span id="l28.70">   __proto__: SyntheticPartMulti.prototype,</span>
<a href="#l28.71"></a><span id="l28.71">   _contentType: 'multipart/related',</span>
<a href="#l28.72"></a><span id="l28.72"> };</span>
<a href="#l28.73"></a><span id="l28.73"> </span>
<a href="#l28.74"></a><span id="l28.74"> var PKCS_SIGNATURE_MIME_TYPE = 'application/x-pkcs7-signature';</span>
<a href="#l28.75"></a><span id="l28.75"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/test/resources/messageModifier.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/test/resources/messageModifier.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -227,21 +227,18 @@ SyntheticMessageSet.prototype = {</span>
<a href="#l29.4"></a><span id="l29.4">                                      &quot;JunkStatusChanged&quot;,</span>
<a href="#l29.5"></a><span id="l29.5">                                      null, str);</span>
<a href="#l29.6"></a><span id="l29.6">   },</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8">   /**</span>
<a href="#l29.9"></a><span id="l29.9">    * Slice the message set using the exact Array.prototype.slice semantics</span>
<a href="#l29.10"></a><span id="l29.10">    * (because we call Array.prototype.slice).</span>
<a href="#l29.11"></a><span id="l29.11">    */</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-  slice: function() {</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-    let slicedMessages = this.synMessages.slice.apply(this.synMessages,</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineminus">-                                                      arguments);</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineminus">-    let slicedIndices = this.folderIndices.slice.apply(this.folderIndices,</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineminus">-                                                       arguments);</span>
<a href="#l29.17"></a><span id="l29.17" class="difflineplus">+  slice: function(...aArgs) {</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineplus">+    let slicedMessages = this.synMessages.slice(...aArgs);</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineplus">+    let slicedIndices = this.folderIndices.slice(...aArgs);</span>
<a href="#l29.20"></a><span id="l29.20">     let sliced = new SyntheticMessageSet(slicedMessages, this.msgFolders,</span>
<a href="#l29.21"></a><span id="l29.21">                                          slicedIndices);</span>
<a href="#l29.22"></a><span id="l29.22">     if ((&quot;glodaMessages&quot; in this) &amp;&amp; this.glodaMessages)</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineminus">-      sliced.glodaMessages = this.glodaMessages.slice.apply(this.glodaMessages,</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineminus">-                                                            arguments);</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineplus">+      sliced.glodaMessages = this.glodaMessages.slice(...aArgs);</span>
<a href="#l29.26"></a><span id="l29.26">     return sliced;</span>
<a href="#l29.27"></a><span id="l29.27">   }</span>
<a href="#l29.28"></a><span id="l29.28"> };</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

