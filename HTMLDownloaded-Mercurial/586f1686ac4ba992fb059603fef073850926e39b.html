<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29014:586f1686ac4ba992fb059603fef073850926e39b</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 586f1686ac4ba992fb059603fef073850926e39b" />
<meta property="og:url" content="/comm-central/rev/586f1686ac4ba992fb059603fef073850926e39b" />
<meta property="og:description" content="Bug 1603809 - Unified account preferences for S/MIME and OpenPGP. r=PatrickBrunschwig,mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 586f1686ac4ba992fb059603fef073850926e39b 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/586f1686ac4ba992fb059603fef073850926e39b">shortlog</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/586f1686ac4ba992fb059603fef073850926e39b">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b">files</a> |
changeset |
<a href="/comm-central/raw-rev/586f1686ac4ba992fb059603fef073850926e39b">raw</a>  | <a href="/comm-central/archive/586f1686ac4ba992fb059603fef073850926e39b.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1603809">Bug 1603809</a> - Unified account preferences for S/MIME and OpenPGP. r=PatrickBrunschwig,mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#75;&#97;&#105;&#32;&#69;&#110;&#103;&#101;&#114;&#116;&#32;&#60;&#107;&#97;&#105;&#101;&#64;&#107;&#117;&#105;&#120;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 05 Mar 2020 22:59:12 +0100</td></tr>

<tr>
 <td>changeset 29014</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/586f1686ac4ba992fb059603fef073850926e39b">586f1686ac4ba992fb059603fef073850926e39b</a></td>
</tr>



<tr>
<td>parent 29013</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/86329202745b8bdcae6aab6f72eacecea96b72bb">86329202745b8bdcae6aab6f72eacecea96b72bb</a>
</td>
</tr>

<tr>
<td>child 29015</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b0232faeed8a3bc67763c31d2c7b3fcf31e2c162">b0232faeed8a3bc67763c31d2c7b3fcf31e2c162</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=586f1686ac4ba992fb059603fef073850926e39b">17157</a></td></tr>
<tr><td>push user</td><td>kaie@kuix.de</td></tr>
<tr><td>push date</td><td class="date age">Wed, 18 Mar 2020 20:25:15 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1b32eca4d77c [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1b32eca4d77c757ef20f83bfd54f5d0f3c830a9f">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1b32eca4d77c757ef20f83bfd54f5d0f3c830a9f&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1b32eca4d77c757ef20f83bfd54f5d0f3c830a9f&newProject=comm-central&newRevision=586f1686ac4ba992fb059603fef073850926e39b&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1b32eca4d77c757ef20f83bfd54f5d0f3c830a9f&newProject=comm-central&newRevision=586f1686ac4ba992fb059603fef073850926e39b&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1b32eca4d77c757ef20f83bfd54f5d0f3c830a9f&newProject=comm-central&newRevision=586f1686ac4ba992fb059603fef073850926e39b&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28PatrickBrunschwig%29&revcount=50">PatrickBrunschwig</a>, <a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1603809">1603809</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1603809">Bug 1603809</a> - Unified account preferences for S/MIME and OpenPGP. r=PatrickBrunschwig,mkmelin

Differential Revision: <a href="https://phabricator.services.mozilla.com/D65618">https://phabricator.services.mozilla.com/D65618</a></div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/.eslintignore">.eslintignore</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/.eslintignore">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/.eslintignore">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/.eslintignore">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/.eslintignore">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/.eslintignore">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/messengercompose.xhtml">mail/components/compose/content/messengercompose.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/messengercompose.xhtml">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/messengercompose.xhtml">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/messengercompose.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/messengercompose.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/components/compose/content/messengercompose.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/AME2E.jsm">mail/extensions/am-e2e/AME2E.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/AME2E.jsm">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/AME2E.jsm">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/AME2E.jsm">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/AME2E.jsm">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/AME2E.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.inc.xhtml">mail/extensions/am-e2e/am-e2e.inc.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.inc.xhtml">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.inc.xhtml">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.inc.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.inc.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.inc.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.js">mail/extensions/am-e2e/am-e2e.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.xhtml">mail/extensions/am-e2e/am-e2e.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.xhtml">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.xhtml">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/am-e2e.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/components.conf">mail/extensions/am-e2e/components.conf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/components.conf">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/components.conf">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/components.conf">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/components.conf">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/moz.build">mail/extensions/am-e2e/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/moz.build">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/moz.build">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/moz.build">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/moz.build">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/prefs/e2e-prefs.js">mail/extensions/am-e2e/prefs/e2e-prefs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/prefs/e2e-prefs.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/prefs/e2e-prefs.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/prefs/e2e-prefs.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/prefs/e2e-prefs.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/am-e2e/prefs/e2e-prefs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/jar.mn">mail/extensions/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/jar.mn">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/jar.mn">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/jar.mn">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/jar.mn">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/moz.build">mail/extensions/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/moz.build">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/moz.build">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/moz.build">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/moz.build">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/BondOpenPGP.jsm">mail/extensions/openpgp/content/BondOpenPGP.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/BondOpenPGP.jsm">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/BondOpenPGP.jsm">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/BondOpenPGP.jsm">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/BondOpenPGP.jsm">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/BondOpenPGP.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/am-enigprefs.xhtml">mail/extensions/openpgp/content/am-enigprefs.xhtml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/am-enigprefs.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/am-enigprefs.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/am-enigprefs.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/amPrefsService.jsm">mail/extensions/openpgp/content/modules/amPrefsService.jsm</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/amPrefsService.jsm">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/amPrefsService.jsm">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/amPrefsService.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyObj.jsm">mail/extensions/openpgp/content/modules/keyObj.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyObj.jsm">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyObj.jsm">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyObj.jsm">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyObj.jsm">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyObj.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyRing.jsm">mail/extensions/openpgp/content/modules/keyRing.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyRing.jsm">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyRing.jsm">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyRing.jsm">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyRing.jsm">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/modules/keyRing.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/am-enigprefs.properties">mail/extensions/openpgp/content/strings/am-enigprefs.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/am-enigprefs.properties">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/am-enigprefs.properties">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/am-enigprefs.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.dtd">mail/extensions/openpgp/content/strings/enigmail.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.dtd">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.dtd">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.dtd">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.dtd">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.properties">mail/extensions/openpgp/content/strings/enigmail.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.properties">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.properties">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.properties">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.properties">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/strings/enigmail.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/am-enigprefs.js">mail/extensions/openpgp/content/ui/am-enigprefs.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/am-enigprefs.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/am-enigprefs.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/am-enigprefs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/commonWorkflows.js">mail/extensions/openpgp/content/ui/commonWorkflows.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/commonWorkflows.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/commonWorkflows.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/commonWorkflows.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/commonWorkflows.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/commonWorkflows.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js">mail/extensions/openpgp/content/ui/enigmailEditIdentity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.css">mail/extensions/openpgp/content/ui/keyPicker.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.css">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.css">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.css">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.css">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.ftl">mail/extensions/openpgp/content/ui/keyPicker.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.ftl">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.ftl">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.ftl">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.ftl">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.ftl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.js">mail/extensions/openpgp/content/ui/keyPicker.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.xhtml">mail/extensions/openpgp/content/ui/keyPicker.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.xhtml">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.xhtml">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/content/ui/keyPicker.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/jar.mn">mail/extensions/openpgp/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/jar.mn">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/jar.mn">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/jar.mn">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/jar.mn">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/locale/jar.mn">mail/extensions/openpgp/locale/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/locale/jar.mn">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/locale/jar.mn">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/locale/jar.mn">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/locale/jar.mn">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/locale/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/moz.build">mail/extensions/openpgp/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/moz.build">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/moz.build">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/moz.build">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/moz.build">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/prefs/openpgp-prefs.js">mail/extensions/openpgp/prefs/openpgp-prefs.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/prefs/openpgp-prefs.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/prefs/openpgp-prefs.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/openpgp/prefs/openpgp-prefs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/smime/jar.mn">mail/extensions/smime/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/smime/jar.mn">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/smime/jar.mn">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/smime/jar.mn">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/smime/jar.mn">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/extensions/smime/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/installer/package-manifest.in">mail/installer/package-manifest.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/installer/package-manifest.in">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/installer/package-manifest.in">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/installer/package-manifest.in">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/installer/package-manifest.in">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/installer/package-manifest.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger-smime/msgCompSMIMEOverlay.properties">mail/locales/en-US/chrome/messenger-smime/msgCompSMIMEOverlay.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger-smime/msgCompSMIMEOverlay.properties">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger-smime/msgCompSMIMEOverlay.properties">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger-smime/msgCompSMIMEOverlay.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-e2e.properties">mail/locales/en-US/chrome/messenger/am-e2e.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-e2e.properties">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-e2e.properties">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-e2e.properties">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-e2e.properties">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-e2e.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.dtd">mail/locales/en-US/chrome/messenger/am-smime.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.dtd">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.dtd">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.dtd">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.dtd">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.properties">mail/locales/en-US/chrome/messenger/am-smime.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.properties">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.properties">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.properties">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.properties">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/en-US/chrome/messenger/am-smime.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mail/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-help.js">mailnews/base/prefs/content/am-help.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-help.js">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-help.js">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-help.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-help.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-help.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-identity-edit.xhtml">mailnews/base/prefs/content/am-identity-edit.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-identity-edit.xhtml">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-identity-edit.xhtml">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-identity-edit.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-identity-edit.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/base/prefs/content/am-identity-edit.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.inc.xhtml">mailnews/extensions/smime/content/am-smime.inc.xhtml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.inc.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.inc.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.inc.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.js">mailnews/extensions/smime/content/am-smime.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.xhtml">mailnews/extensions/smime/content/am-smime.xhtml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/am-smime.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/certpicker.xhtml">mailnews/extensions/smime/content/certpicker.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/certpicker.xhtml">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/certpicker.xhtml">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/certpicker.xhtml">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/certpicker.xhtml">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/certpicker.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/smime.js">mailnews/extensions/smime/content/smime.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/smime.js">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/smime.js">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/content/smime.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/moz.build">mailnews/extensions/smime/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/moz.build">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/moz.build">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/moz.build">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/moz.build">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/SMIMEService.jsm">mailnews/extensions/smime/src/SMIMEService.jsm</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/SMIMEService.jsm">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/SMIMEService.jsm">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/SMIMEService.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/components.conf">mailnews/extensions/smime/src/components.conf</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/components.conf">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/components.conf">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/components.conf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/moz.build">mailnews/extensions/smime/src/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/moz.build">file</a> |
<a href="/comm-central/annotate/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/moz.build">annotate</a> |
<a href="/comm-central/diff/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/moz.build">diff</a> |
<a href="/comm-central/comparison/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/moz.build">comparison</a> |
<a href="/comm-central/log/586f1686ac4ba992fb059603fef073850926e39b/mailnews/extensions/smime/src/moz.build">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/.eslintignore</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/.eslintignore</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -59,30 +59,29 @@ editor/ui/dialogs/content/EdLinkChecker.</span>
<a href="#l1.4"></a><span id="l1.4"> editor/ui/dialogs/content/EdSnapToGrid.js</span>
<a href="#l1.5"></a><span id="l1.5"> editor/ui/dialogs/content/EdSnapToGrid.xul</span>
<a href="#l1.6"></a><span id="l1.6"> editor/ui/texzilla/**</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> # mailnews exclusions</span>
<a href="#l1.9"></a><span id="l1.9"> mailnews/mailnews.js</span>
<a href="#l1.10"></a><span id="l1.10"> mailnews/extensions/dsn/content/dsn.js</span>
<a href="#l1.11"></a><span id="l1.11"> mailnews/extensions/mdn/content/mdn.js</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-mailnews/extensions/smime/content/smime.js</span>
<a href="#l1.13"></a><span id="l1.13"> </span>
<a href="#l1.14"></a><span id="l1.14"> # mail exclusions</span>
<a href="#l1.15"></a><span id="l1.15"> mail/app/profile/all-thunderbird.js</span>
<a href="#l1.16"></a><span id="l1.16"> mail/app/profile/channel-prefs.js</span>
<a href="#l1.17"></a><span id="l1.17"> mail/base/content/protovis-r2.6-modded.js</span>
<a href="#l1.18"></a><span id="l1.18"> mail/branding/nightly/thunderbird-branding.js</span>
<a href="#l1.19"></a><span id="l1.19"> mail/branding/thunderbird/thunderbird-branding.js</span>
<a href="#l1.20"></a><span id="l1.20"> # This file is split into two in order to keep it as a valid json file</span>
<a href="#l1.21"></a><span id="l1.21"> # for documentation purposes (policies.json) but to be accessed by the</span>
<a href="#l1.22"></a><span id="l1.22"> # code as a .jsm (schema.jsm)</span>
<a href="#l1.23"></a><span id="l1.23"> mail/components/enterprisepolicies/schemas/schema.jsm</span>
<a href="#l1.24"></a><span id="l1.24"> mail/components/im/all-im.js</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineminus">-mail/extensions/openpgp/prefs/openpgp-prefs.js</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineplus">+mail/extensions/am-e2e/prefs/e2e-prefs.js</span>
<a href="#l1.27"></a><span id="l1.27"> mail/locales/en-US/all-l10n.js</span>
<a href="#l1.28"></a><span id="l1.28"> mail/components/compose/texzilla/**</span>
<a href="#l1.29"></a><span id="l1.29"> mail/components/compose/composer.js</span>
<a href="#l1.30"></a><span id="l1.30"> </span>
<a href="#l1.31"></a><span id="l1.31"> # exclude MailConstants.jsm because: #filter subtitution</span>
<a href="#l1.32"></a><span id="l1.32"> mail/base/modules/MailConstants.jsm</span>
<a href="#l1.33"></a><span id="l1.33"> </span>
<a href="#l1.34"></a><span id="l1.34"> # calendar/ exclusions</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1551,32 +1551,32 @@ function InitFileSaveAsMenu() {</span>
<a href="#l2.4"></a><span id="l2.4">   document</span>
<a href="#l2.5"></a><span id="l2.5">     .getElementById(&quot;cmd_saveAsDraft&quot;)</span>
<a href="#l2.6"></a><span id="l2.6">     .setAttribute(&quot;checked&quot;, defaultSaveOperation == &quot;draft&quot;);</span>
<a href="#l2.7"></a><span id="l2.7">   document</span>
<a href="#l2.8"></a><span id="l2.8">     .getElementById(&quot;cmd_saveAsTemplate&quot;)</span>
<a href="#l2.9"></a><span id="l2.9">     .setAttribute(&quot;checked&quot;, defaultSaveOperation == &quot;template&quot;);</span>
<a href="#l2.10"></a><span id="l2.10"> }</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+function isSmimeSigningConfigured() {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  return !!gCurrentIdentity.getUnicharAttribute(&quot;signing_cert_name&quot;);</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+}</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+function isSmimeEncryptionConfigured() {</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+  return !!gCurrentIdentity.getUnicharAttribute(&quot;encryption_cert_name&quot;);</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+}</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+function isPgpConfigured() {</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+  return !!gCurrentIdentity.getUnicharAttribute(&quot;openpgp_key_id&quot;);</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+}</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+</span>
<a href="#l2.24"></a><span id="l2.24"> function toggleGlobalSignMessage() {</span>
<a href="#l2.25"></a><span id="l2.25">   gSendSigned = !gSendSigned;</span>
<a href="#l2.26"></a><span id="l2.26">   gUserTouchedSendSigned = true;</span>
<a href="#l2.27"></a><span id="l2.27">   setEncSigStatusUI();</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineminus">-</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-  /*</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineminus">-  if (gSMFields.signMessage) // make sure we have a cert name...</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-  {</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-    if (!gCurrentIdentity.getUnicharAttribute(&quot;signing_cert_name&quot;))</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">-    {</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineminus">-      gSMFields.signMessage = false;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-      showSMNeedSetupInfo();</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineminus">-      return;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-    }</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineminus">-  }</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-  */</span>
<a href="#l2.40"></a><span id="l2.40"> }</span>
<a href="#l2.41"></a><span id="l2.41"> </span>
<a href="#l2.42"></a><span id="l2.42"> function setGlobalEncryptMessage(mode) {</span>
<a href="#l2.43"></a><span id="l2.43">   let oldSendEnc = gSendEncrypted;</span>
<a href="#l2.44"></a><span id="l2.44">   let oldOptEnc = gOptionalEncryption;</span>
<a href="#l2.45"></a><span id="l2.45"> </span>
<a href="#l2.46"></a><span id="l2.46">   switch (mode) {</span>
<a href="#l2.47"></a><span id="l2.47">     case 0:</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineat">@@ -1595,67 +1595,87 @@ function setGlobalEncryptMessage(mode) {</span>
<a href="#l2.49"></a><span id="l2.49">       return;</span>
<a href="#l2.50"></a><span id="l2.50">   }</span>
<a href="#l2.51"></a><span id="l2.51"> </span>
<a href="#l2.52"></a><span id="l2.52">   if (oldSendEnc != gSendEncrypted || oldOptEnc != gOptionalEncryption) {</span>
<a href="#l2.53"></a><span id="l2.53">     gUserTouchedSendEncrypted = true;</span>
<a href="#l2.54"></a><span id="l2.54">   }</span>
<a href="#l2.55"></a><span id="l2.55"> </span>
<a href="#l2.56"></a><span id="l2.56">   setEncSigStatusUI();</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineminus">-</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-  /*</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineminus">-  if (gSMFields.requireEncryptMessage)</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineminus">-  {</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineminus">-    // Make sure we have a cert.</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineminus">-    if (!gCurrentIdentity.getUnicharAttribute(&quot;encryption_cert_name&quot;))</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineminus">-    {</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineminus">-      gSMFields.requireEncryptMessage = false;</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineminus">-      showSMNeedSetupInfo();</span>
<a href="#l2.66"></a><span id="l2.66" class="difflineminus">-      return;</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineminus">-    }</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineminus">-  }</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-  */</span>
<a href="#l2.70"></a><span id="l2.70"> }</span>
<a href="#l2.71"></a><span id="l2.71"> </span>
<a href="#l2.72"></a><span id="l2.72"> function toggleAttachMyPublicKey() {</span>
<a href="#l2.73"></a><span id="l2.73">   gAttachMyPublicPGPKey = !gAttachMyPublicPGPKey;</span>
<a href="#l2.74"></a><span id="l2.74">   gUserTouchedAttachMyPubKey = true;</span>
<a href="#l2.75"></a><span id="l2.75"> }</span>
<a href="#l2.76"></a><span id="l2.76"> </span>
<a href="#l2.77"></a><span id="l2.77"> function setSecuritySettings(menu_id) {</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineminus">-  document</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineminus">-    .getElementById(&quot;menu_securityEncryptDisable&quot; + menu_id)</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineminus">-    .setAttribute(&quot;checked&quot;, !gSendEncrypted &amp;&amp; !gOptionalEncryption);</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineplus">+  let enc0Item = document.getElementById(</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineplus">+    &quot;menu_securityEncryptDisable&quot; + menu_id</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineplus">+  );</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineplus">+  enc0Item.checked = !gSendEncrypted &amp;&amp; !gOptionalEncryption;</span>
<a href="#l2.85"></a><span id="l2.85">   /*</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-  document</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-    .getElementById(&quot;menu_securityEncryptOptional&quot; + menu_id)</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-    .setAttribute(&quot;checked&quot;, gSendEncrypted &amp;&amp; gOptionalEncryption);</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineplus">+  let enc1Item = document</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineplus">+    .getElementById(&quot;menu_securityEncryptOptional&quot; + menu_id);</span>
<a href="#l2.91"></a><span id="l2.91" class="difflineplus">+  enc1Item.checked = (gSendEncrypted &amp;&amp; gOptionalEncryption);</span>
<a href="#l2.92"></a><span id="l2.92">   */</span>
<a href="#l2.93"></a><span id="l2.93" class="difflineminus">-  document</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-    .getElementById(&quot;menu_securityEncryptRequire&quot; + menu_id)</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineminus">-    .setAttribute(&quot;checked&quot;, gSendEncrypted &amp;&amp; !gOptionalEncryption);</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineminus">-</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineminus">-  document</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineminus">-    .getElementById(&quot;menu_securitySign&quot; + menu_id)</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineminus">-    .setAttribute(&quot;checked&quot;, gSendSigned);</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineplus">+  let enc2Item = document.getElementById(</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineplus">+    &quot;menu_securityEncryptRequire&quot; + menu_id</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+  );</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineplus">+  enc2Item.checked = gSendEncrypted &amp;&amp; !gOptionalEncryption;</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineplus">+</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineplus">+  let sigItem = document.getElementById(&quot;menu_securitySign&quot; + menu_id);</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineplus">+  sigItem.checked = gSendSigned;</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineplus">+</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineplus">+  let disableSig = false;</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineplus">+  let disableEnc = false;</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineplus">+</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP &amp;&amp; gSelectedTechnologyIsPGP) {</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineplus">+    if (!isPgpConfigured()) {</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineplus">+      disableSig = true;</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineplus">+      disableEnc = true;</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineplus">+    }</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineplus">+  } else {</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineplus">+    if (!isSmimeSigningConfigured()) {</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineplus">+      disableSig = true;</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineplus">+    }</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineplus">+    if (!isSmimeEncryptionConfigured()) {</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineplus">+      disableEnc = true;</span>
<a href="#l2.122"></a><span id="l2.122" class="difflineplus">+    }</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineplus">+  }</span>
<a href="#l2.124"></a><span id="l2.124" class="difflineplus">+</span>
<a href="#l2.125"></a><span id="l2.125" class="difflineplus">+  enc0Item.disabled = disableEnc;</span>
<a href="#l2.126"></a><span id="l2.126" class="difflineplus">+  //enc1Item.disabled = disableEnc;</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineplus">+  enc2Item.disabled = disableEnc;</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineplus">+</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineplus">+  sigItem.disabled = disableSig;</span>
<a href="#l2.130"></a><span id="l2.130"> </span>
<a href="#l2.131"></a><span id="l2.131">   if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineminus">-    document</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineminus">-      .getElementById(&quot;encTech_OpenPGP&quot; + menu_id)</span>
<a href="#l2.134"></a><span id="l2.134" class="difflineminus">-      .setAttribute(&quot;checked&quot;, gSelectedTechnologyIsPGP);</span>
<a href="#l2.135"></a><span id="l2.135" class="difflineminus">-    document</span>
<a href="#l2.136"></a><span id="l2.136" class="difflineminus">-      .getElementById(&quot;encTech_SMIME&quot; + menu_id)</span>
<a href="#l2.137"></a><span id="l2.137" class="difflineminus">-      .setAttribute(&quot;checked&quot;, !gSelectedTechnologyIsPGP);</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineplus">+    let pgpItem = document.getElementById(&quot;encTech_OpenPGP&quot; + menu_id);</span>
<a href="#l2.139"></a><span id="l2.139" class="difflineplus">+</span>
<a href="#l2.140"></a><span id="l2.140" class="difflineplus">+    let smimeItem = document.getElementById(&quot;encTech_SMIME&quot; + menu_id);</span>
<a href="#l2.141"></a><span id="l2.141" class="difflineplus">+</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineplus">+    pgpItem.checked = gSelectedTechnologyIsPGP;</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineplus">+    smimeItem.checked = !gSelectedTechnologyIsPGP;</span>
<a href="#l2.144"></a><span id="l2.144" class="difflineplus">+</span>
<a href="#l2.145"></a><span id="l2.145" class="difflineplus">+    smimeItem.disabled =</span>
<a href="#l2.146"></a><span id="l2.146" class="difflineplus">+      !isSmimeSigningConfigured() &amp;&amp; !isSmimeEncryptionConfigured();</span>
<a href="#l2.147"></a><span id="l2.147" class="difflineplus">+</span>
<a href="#l2.148"></a><span id="l2.148" class="difflineplus">+    pgpItem.disabled = !isPgpConfigured();</span>
<a href="#l2.149"></a><span id="l2.149"> </span>
<a href="#l2.150"></a><span id="l2.150">     let sep = document.getElementById(&quot;myPublicKeySeparator&quot; + menu_id);</span>
<a href="#l2.151"></a><span id="l2.151">     let box = document.getElementById(&quot;menu_securityMyPublicKey&quot; + menu_id);</span>
<a href="#l2.152"></a><span id="l2.152"> </span>
<a href="#l2.153"></a><span id="l2.153">     sep.setAttribute(&quot;hidden&quot;, !gSelectedTechnologyIsPGP);</span>
<a href="#l2.154"></a><span id="l2.154">     box.setAttribute(&quot;hidden&quot;, !gSelectedTechnologyIsPGP);</span>
<a href="#l2.155"></a><span id="l2.155" class="difflineminus">-    box.setAttribute(&quot;checked&quot;, gAttachMyPublicPGPKey);</span>
<a href="#l2.156"></a><span id="l2.156" class="difflineplus">+    box.checked = gAttachMyPublicPGPKey;</span>
<a href="#l2.157"></a><span id="l2.157" class="difflineplus">+</span>
<a href="#l2.158"></a><span id="l2.158" class="difflineplus">+    if (gSelectedTechnologyIsPGP) {</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineplus">+      box.disabled = disableEnc;</span>
<a href="#l2.160"></a><span id="l2.160" class="difflineplus">+    }</span>
<a href="#l2.161"></a><span id="l2.161">   }</span>
<a href="#l2.162"></a><span id="l2.162"> }</span>
<a href="#l2.163"></a><span id="l2.163"> </span>
<a href="#l2.164"></a><span id="l2.164"> function showMessageComposeSecurityStatus() {</span>
<a href="#l2.165"></a><span id="l2.165">   Recipients2CompFields(gMsgCompose.compFields);</span>
<a href="#l2.166"></a><span id="l2.166"> </span>
<a href="#l2.167"></a><span id="l2.167">   window.openDialog(</span>
<a href="#l2.168"></a><span id="l2.168">     &quot;chrome://messenger-smime/content/msgCompSecurityInfo.xhtml&quot;,</span>
<a href="#l2.169"></a><span id="l2.169" class="difflineat">@@ -1669,41 +1689,16 @@ function showMessageComposeSecurityStatu</span>
<a href="#l2.170"></a><span id="l2.170">         gCurrentIdentity.getUnicharAttribute(&quot;signing_cert_name&quot;) != &quot;&quot;,</span>
<a href="#l2.171"></a><span id="l2.171">       isEncryptionCertAvailable:</span>
<a href="#l2.172"></a><span id="l2.172">         gCurrentIdentity.getUnicharAttribute(&quot;encryption_cert_name&quot;) != &quot;&quot;,</span>
<a href="#l2.173"></a><span id="l2.173">       currentIdentity: gCurrentIdentity,</span>
<a href="#l2.174"></a><span id="l2.174">     }</span>
<a href="#l2.175"></a><span id="l2.175">   );</span>
<a href="#l2.176"></a><span id="l2.176"> }</span>
<a href="#l2.177"></a><span id="l2.177"> </span>
<a href="#l2.178"></a><span id="l2.178" class="difflineminus">-function showSMNeedSetupInfo() {</span>
<a href="#l2.179"></a><span id="l2.179" class="difflineminus">-  let compSmimeBundle = document.getElementById(&quot;bundle_comp_smime&quot;);</span>
<a href="#l2.180"></a><span id="l2.180" class="difflineminus">-  let brandBundle = document.getElementById(&quot;brandBundle&quot;);</span>
<a href="#l2.181"></a><span id="l2.181" class="difflineminus">-  if (!compSmimeBundle || !brandBundle) {</span>
<a href="#l2.182"></a><span id="l2.182" class="difflineminus">-    return;</span>
<a href="#l2.183"></a><span id="l2.183" class="difflineminus">-  }</span>
<a href="#l2.184"></a><span id="l2.184" class="difflineminus">-</span>
<a href="#l2.185"></a><span id="l2.185" class="difflineminus">-  let buttonPressed = Services.prompt.confirmEx(</span>
<a href="#l2.186"></a><span id="l2.186" class="difflineminus">-    window,</span>
<a href="#l2.187"></a><span id="l2.187" class="difflineminus">-    brandBundle.getString(&quot;brandShortName&quot;),</span>
<a href="#l2.188"></a><span id="l2.188" class="difflineminus">-    compSmimeBundle.getString(&quot;NeedSetup&quot;),</span>
<a href="#l2.189"></a><span id="l2.189" class="difflineminus">-    Services.prompt.STD_YES_NO_BUTTONS,</span>
<a href="#l2.190"></a><span id="l2.190" class="difflineminus">-    0,</span>
<a href="#l2.191"></a><span id="l2.191" class="difflineminus">-    0,</span>
<a href="#l2.192"></a><span id="l2.192" class="difflineminus">-    0,</span>
<a href="#l2.193"></a><span id="l2.193" class="difflineminus">-    null,</span>
<a href="#l2.194"></a><span id="l2.194" class="difflineminus">-    {}</span>
<a href="#l2.195"></a><span id="l2.195" class="difflineminus">-  );</span>
<a href="#l2.196"></a><span id="l2.196" class="difflineminus">-  if (buttonPressed == 0) {</span>
<a href="#l2.197"></a><span id="l2.197" class="difflineminus">-    let servers = MailServices.accounts.getServersForIdentity(gCurrentIdentity);</span>
<a href="#l2.198"></a><span id="l2.198" class="difflineminus">-    let server = servers.queryElementAt(0, Ci.nsIMsgIncomingServer);</span>
<a href="#l2.199"></a><span id="l2.199" class="difflineminus">-    MsgAccountManager(&quot;am-smime.xhtml&quot;, server);</span>
<a href="#l2.200"></a><span id="l2.200" class="difflineminus">-  }</span>
<a href="#l2.201"></a><span id="l2.201" class="difflineminus">-}</span>
<a href="#l2.202"></a><span id="l2.202" class="difflineminus">-</span>
<a href="#l2.203"></a><span id="l2.203"> function openEditorContextMenu(popup) {</span>
<a href="#l2.204"></a><span id="l2.204">   gSpellChecker.clearSuggestionsFromMenu();</span>
<a href="#l2.205"></a><span id="l2.205">   gSpellChecker.initFromEvent(</span>
<a href="#l2.206"></a><span id="l2.206">     document.popupRangeParent,</span>
<a href="#l2.207"></a><span id="l2.207">     document.popupRangeOffset</span>
<a href="#l2.208"></a><span id="l2.208">   );</span>
<a href="#l2.209"></a><span id="l2.209">   var onMisspelling = gSpellChecker.overMisspelling;</span>
<a href="#l2.210"></a><span id="l2.210">   document.getElementById(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/compose/content/messengercompose.xhtml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/compose/content/messengercompose.xhtml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -51,17 +51,16 @@</span>
<a href="#l3.4"></a><span id="l3.4">         macanimationtype=&quot;document&quot;</span>
<a href="#l3.5"></a><span id="l3.5">         chromemargin=&quot;0,-1,-1,-1&quot;</span>
<a href="#l3.6"></a><span id="l3.6"> #endif</span>
<a href="#l3.7"></a><span id="l3.7">         fullscreenbutton=&quot;true&quot;&gt;</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9">   &lt;stringbundle id=&quot;bundle_composeMsgs&quot; src=&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;/&gt;</span>
<a href="#l3.10"></a><span id="l3.10">   &lt;stringbundle id=&quot;bundle_messenger&quot; src=&quot;chrome://messenger/locale/messenger.properties&quot;/&gt;</span>
<a href="#l3.11"></a><span id="l3.11">   &lt;stringbundle id=&quot;brandBundle&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  &lt;stringbundle id=&quot;bundle_comp_smime&quot; src=&quot;chrome://messenger-smime/locale/msgCompSMIMEOverlay.properties&quot;/&gt;</span>
<a href="#l3.13"></a><span id="l3.13">   &lt;stringbundle id=&quot;charsetBundle&quot; src=&quot;chrome://communicator/content/labelsencodings.properties&quot;/&gt;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> &lt;linkset&gt;</span>
<a href="#l3.16"></a><span id="l3.16">   &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/messengercompose/messengercompose.ftl&quot;/&gt;</span>
<a href="#l3.17"></a><span id="l3.17">   &lt;html:link rel=&quot;localization&quot; href=&quot;toolkit/main-window/findbar.ftl&quot;/&gt;</span>
<a href="#l3.18"></a><span id="l3.18">   &lt;html:link rel=&quot;localization&quot; href=&quot;toolkit/global/textActions.ftl&quot;/&gt;</span>
<a href="#l3.19"></a><span id="l3.19">   &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/menubar.ftl&quot;/&gt;</span>
<a href="#l3.20"></a><span id="l3.20"> &lt;/linkset&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">rename from mailnews/extensions/smime/src/SMIMEService.jsm</span>
<a href="#l4.2"></a><span id="l4.2">rename to mail/extensions/am-e2e/AME2E.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineminus">--- a/mailnews/extensions/smime/src/SMIMEService.jsm</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineplus">+++ b/mail/extensions/am-e2e/AME2E.jsm</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineat">@@ -1,19 +1,19 @@</span>
<a href="#l4.6"></a><span id="l4.6"> /* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l4.7"></a><span id="l4.7">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.8"></a><span id="l4.8">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.9"></a><span id="l4.9">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11" class="difflineminus">-var EXPORTED_SYMBOLS = [&quot;SMIMEService&quot;];</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;E2EService&quot;];</span>
<a href="#l4.13"></a><span id="l4.13"> </span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-function SMIMEService() {}</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+function E2EService() {}</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-SMIMEService.prototype = {</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-  name: &quot;smime&quot;,</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+E2EService.prototype = {</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+  name: &quot;e2e&quot;,</span>
<a href="#l4.21"></a><span id="l4.21">   chromePackageName: &quot;messenger&quot;,</span>
<a href="#l4.22"></a><span id="l4.22">   showPanel(server) {</span>
<a href="#l4.23"></a><span id="l4.23">     // don't show the panel for news, rss, or local accounts</span>
<a href="#l4.24"></a><span id="l4.24">     return (</span>
<a href="#l4.25"></a><span id="l4.25">       server.type != &quot;nntp&quot; &amp;&amp;</span>
<a href="#l4.26"></a><span id="l4.26">       server.type != &quot;rss&quot; &amp;&amp;</span>
<a href="#l4.27"></a><span id="l4.27">       server.type != &quot;im&quot; &amp;&amp;</span>
<a href="#l4.28"></a><span id="l4.28">       server.type != &quot;none&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">rename from mailnews/extensions/smime/content/am-smime.inc.xhtml</span>
<a href="#l5.2"></a><span id="l5.2">rename to mail/extensions/am-e2e/am-e2e.inc.xhtml</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineminus">--- a/mailnews/extensions/smime/content/am-smime.inc.xhtml</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineplus">+++ b/mail/extensions/am-e2e/am-e2e.inc.xhtml</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineat">@@ -1,100 +1,162 @@</span>
<a href="#l5.6"></a><span id="l5.6"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.7"></a><span id="l5.7"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.8"></a><span id="l5.8"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10" class="difflineminus">-    &lt;vbox id=&quot;smimeEditing&quot;&gt;</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+#ifdef MOZ_OPENPGP</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+&lt;script src=&quot;chrome://openpgp/content/BondOpenPGP.jsm&quot;/&gt;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+#endif</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-      &lt;stringbundle id=&quot;bundle_smime&quot; src=&quot;chrome://messenger/locale/am-smime.properties&quot;/&gt;</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+    &lt;vbox id=&quot;e2eEditing&quot;&gt;</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+      &lt;stringbundle id=&quot;bundle_e2e&quot; src=&quot;chrome://messenger/locale/am-smime.properties&quot;/&gt;</span>
<a href="#l5.19"></a><span id="l5.19">       &lt;stringbundle id=&quot;bundle_brand&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-      &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.encryptionpolicy&quot;/&gt;</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+      &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity_encryptionpolicy&quot;/&gt;</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+      &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity_e2etechpref&quot;/&gt;</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-      &lt;description&gt;&amp;securityHeading.label;&lt;/description&gt;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+      &lt;vbox&gt;</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+        &lt;description flex=&quot;1&quot;&gt;&amp;e2eIntro.description;&lt;/description&gt;</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+        &lt;label is=&quot;text-link&quot; id=&quot;acceptLearnMoreE2E&quot;</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+               href=&quot;https://support.mozilla.org/kb/introduction-to-e2e-encryption&quot;</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+               value=&quot;&amp;e2eLearnMore.label;&quot;/&gt;</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+      &lt;/vbox&gt;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+#ifdef MOZ_OPENPGP</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+      &lt;html:fieldset id=&quot;openpgpOptions&quot;&gt;</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+        &lt;html:legend&gt;&amp;openpgpKeys.label;&lt;/html:legend&gt;</span>
<a href="#l5.36"></a><span id="l5.36"> </span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-      &lt;html:fieldset id=&quot;signing.titlebox&quot;&gt;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-        &lt;html:legend&gt;&amp;signingGroupTitle.label;&lt;/html:legend&gt;</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+        &lt;label id=&quot;identity_openpgp_key_nameLabel&quot;</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+               value=&quot;&amp;openpgpKey.message;&quot; control=&quot;identity_openpgp_key_id&quot;/&gt;</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+        &lt;hbox align=&quot;center&quot; class=&quot;input-container&quot;&gt;</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+          &lt;html:input id=&quot;identity_openpgp_key_id&quot; type=&quot;text&quot;</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+                      class=&quot;input-inline&quot;</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+                      readonly=&quot;readonly&quot;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+                      disabled=&quot;disabled&quot;</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+                      aria-labelledby=&quot;identity_openpgp_key_nameLabel&quot;</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+                      wsm_persist=&quot;true&quot;</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+                      prefstring=&quot;mail.identity.%identitykey%.openpgp_key_id&quot;/&gt;</span>
<a href="#l5.49"></a><span id="l5.49"> </span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-        &lt;label id=&quot;identity.signing_cert_nameLabel&quot;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineminus">-               value=&quot;&amp;signingCert.message;&quot; control=&quot;identity.signing_cert_name&quot;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+          &lt;button id=&quot;openpgpKeySelectButton&quot;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+                  label=&quot;&amp;openpgpKey.button;&quot;</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+                  accesskey=&quot;&amp;openpgpKey.accesskey;&quot;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+                  oncommand=&quot;pgpSelectKey('identity_openpgp_key_id')&quot;/&gt;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+          &lt;button id=&quot;openpgpKeyClearButton&quot;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+                  label=&quot;&amp;encryption.certificate_clear.button;&quot;</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+                  oncommand=&quot;pgpClearKey('identity_openpgp_key_id')&quot;/&gt;</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+        &lt;hbox align=&quot;right&quot;&gt;</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+          &lt;button id=&quot;openOpenPGPKeyManagerButton&quot; oncommand=&quot;BondOpenPGP.openKeyManager(window);&quot;</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+                  label=&quot;&amp;manageKeys.label;&quot;/&gt;</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+      &lt;/html:fieldset&gt;</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+#endif</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+      &lt;html:fieldset id=&quot;smimeOptions&quot;&gt;</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+        &lt;html:legend&gt;&amp;certificates2.label;&lt;/html:legend&gt;</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+        &lt;label id=&quot;identity_signing_cert_nameLabel&quot;</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+               value=&quot;&amp;signingCert2.message;&quot; control=&quot;identity_signing_cert_name&quot;</span>
<a href="#l5.73"></a><span id="l5.73">                prefstring=&quot;mail.identity.%identitykey%.encryptionpolicy&quot;/&gt;</span>
<a href="#l5.74"></a><span id="l5.74"> </span>
<a href="#l5.75"></a><span id="l5.75">         &lt;hbox align=&quot;center&quot; class=&quot;input-container&quot;&gt;</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineminus">-          &lt;html:input id=&quot;identity.signing_cert_name&quot; type=&quot;text&quot;</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+          &lt;html:input id=&quot;identity_signing_cert_name&quot; type=&quot;text&quot;</span>
<a href="#l5.78"></a><span id="l5.78">                       class=&quot;input-inline&quot;</span>
<a href="#l5.79"></a><span id="l5.79">                       readonly=&quot;readonly&quot;</span>
<a href="#l5.80"></a><span id="l5.80">                       disabled=&quot;disabled&quot;</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-                      aria-labelledby=&quot;identity.signing_cert_nameLabel&quot;</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+                      aria-labelledby=&quot;identity_signing_cert_nameLabel&quot;</span>
<a href="#l5.83"></a><span id="l5.83">                       wsm_persist=&quot;true&quot;</span>
<a href="#l5.84"></a><span id="l5.84">                       prefstring=&quot;mail.identity.%identitykey%.signing_cert_name&quot;/&gt;</span>
<a href="#l5.85"></a><span id="l5.85"> </span>
<a href="#l5.86"></a><span id="l5.86">           &lt;button id=&quot;signingCertSelectButton&quot;</span>
<a href="#l5.87"></a><span id="l5.87">                   label=&quot;&amp;digitalSign.certificate.button;&quot;</span>
<a href="#l5.88"></a><span id="l5.88">                   accesskey=&quot;&amp;digitalSign.certificate.accesskey;&quot;</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineminus">-                  oncommand=&quot;smimeSelectCert('identity.signing_cert_name')&quot;/&gt;</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineplus">+                  oncommand=&quot;smimeSelectCert('identity_signing_cert_name')&quot;/&gt;</span>
<a href="#l5.91"></a><span id="l5.91"> </span>
<a href="#l5.92"></a><span id="l5.92">           &lt;button id=&quot;signingCertClearButton&quot;</span>
<a href="#l5.93"></a><span id="l5.93">                   label=&quot;&amp;digitalSign.certificate_clear.button;&quot;</span>
<a href="#l5.94"></a><span id="l5.94">                   accesskey=&quot;&amp;digitalSign.certificate_clear.accesskey;&quot;</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineminus">-                  oncommand=&quot;smimeClearCert('identity.signing_cert_name')&quot;/&gt;</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+                  oncommand=&quot;smimeClearCert('identity_signing_cert_name')&quot;/&gt;</span>
<a href="#l5.97"></a><span id="l5.97">         &lt;/hbox&gt;</span>
<a href="#l5.98"></a><span id="l5.98"> </span>
<a href="#l5.99"></a><span id="l5.99" class="difflineminus">-        &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineminus">-</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineminus">-        &lt;checkbox id=&quot;identity.sign_mail&quot; wsm_persist=&quot;true&quot;</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineminus">-                  prefstring=&quot;mail.identity.%identitykey%.sign_mail&quot;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineminus">-                  label=&quot;&amp;signMessage.label;&quot; accesskey=&quot;&amp;signMessage.accesskey;&quot;/&gt;</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineminus">-      &lt;/html:fieldset&gt;</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineminus">-</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineminus">-      &lt;html:fieldset id=&quot;encryption.titlebox&quot;&gt;</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineminus">-        &lt;html:legend&gt;&amp;encryptionGroupTitle.label;&lt;/html:legend&gt;</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineminus">-</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineminus">-        &lt;label value=&quot;&amp;encryptionCert.message;&quot;</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineminus">-               control=&quot;identity.encryption_cert_name&quot;/&gt;</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+        &lt;label value=&quot;&amp;encryptionCert2.message;&quot;</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineplus">+               control=&quot;identity_encryption_cert_name&quot;/&gt;</span>
<a href="#l5.113"></a><span id="l5.113"> </span>
<a href="#l5.114"></a><span id="l5.114">         &lt;hbox align=&quot;center&quot; class=&quot;input-container&quot;&gt;</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineminus">-          &lt;html:input id=&quot;identity.encryption_cert_name&quot; type=&quot;text&quot;</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+          &lt;html:input id=&quot;identity_encryption_cert_name&quot; type=&quot;text&quot;</span>
<a href="#l5.117"></a><span id="l5.117">                       class=&quot;input-inline&quot;</span>
<a href="#l5.118"></a><span id="l5.118">                       readonly=&quot;readonly&quot;</span>
<a href="#l5.119"></a><span id="l5.119">                       disabled=&quot;disabled&quot;</span>
<a href="#l5.120"></a><span id="l5.120">                       wsm_persist=&quot;true&quot;</span>
<a href="#l5.121"></a><span id="l5.121">                       prefstring=&quot;mail.identity.%identitykey%.encryption_cert_name&quot;/&gt;</span>
<a href="#l5.122"></a><span id="l5.122"> </span>
<a href="#l5.123"></a><span id="l5.123">           &lt;button id=&quot;encryptionCertSelectButton&quot;</span>
<a href="#l5.124"></a><span id="l5.124">                   label=&quot;&amp;encryption.certificate.button;&quot;</span>
<a href="#l5.125"></a><span id="l5.125">                   accesskey=&quot;&amp;encryption.certificate.accesskey;&quot;</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineminus">-                  oncommand=&quot;smimeSelectCert('identity.encryption_cert_name')&quot;/&gt;</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+                  oncommand=&quot;smimeSelectCert('identity_encryption_cert_name')&quot;/&gt;</span>
<a href="#l5.128"></a><span id="l5.128"> </span>
<a href="#l5.129"></a><span id="l5.129">           &lt;button id=&quot;encryptionCertClearButton&quot;</span>
<a href="#l5.130"></a><span id="l5.130">                   label=&quot;&amp;encryption.certificate_clear.button;&quot;</span>
<a href="#l5.131"></a><span id="l5.131">                   accesskey=&quot;&amp;encryption.certificate_clear.accesskey;&quot;</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineminus">-                  oncommand=&quot;smimeClearCert('identity.encryption_cert_name')&quot;/&gt;</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+                  oncommand=&quot;smimeClearCert('identity_encryption_cert_name')&quot;/&gt;</span>
<a href="#l5.134"></a><span id="l5.134">         &lt;/hbox&gt;</span>
<a href="#l5.135"></a><span id="l5.135"> </span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+        &lt;hbox align=&quot;right&quot;&gt;</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineplus">+          &lt;button id=&quot;openCertManagerButton&quot; oncommand=&quot;openCertManager();&quot;</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+                  label=&quot;&amp;manageCerts3.label;&quot; accesskey=&quot;&amp;manageCerts3.accesskey;&quot;/&gt;</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+          &lt;button id=&quot;openDeviceManagerButton&quot; oncommand=&quot;openDeviceManager();&quot;</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+                  label=&quot;&amp;manageDevices2.label;&quot; accesskey=&quot;&amp;manageDevices2.accesskey;&quot;/&gt;</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+      &lt;/html:fieldset&gt;</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+      &lt;html:legend&gt;&amp;sendingDefaults.label;&lt;/html:legend&gt;</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineplus">+</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineplus">+      &lt;html:fieldset id=&quot;encryption_titlebox&quot;&gt;</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+        &lt;description flex=&quot;1&quot;&gt;&amp;e2eEnc.description;&lt;/description&gt;</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineplus">+</span>
<a href="#l5.150"></a><span id="l5.150">         &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l5.151"></a><span id="l5.151"> </span>
<a href="#l5.152"></a><span id="l5.152" class="difflineminus">-        &lt;label value=&quot;&amp;encryptionChoiceLabel.label;&quot; control=&quot;encryptionChoices&quot;/&gt;</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineplus">+        &lt;radiogroup id=&quot;encryptionChoices&quot;&gt;</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+          &lt;radio id=&quot;encrypt_no&quot; wsm_persist=&quot;true&quot; value=&quot;0&quot;</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+                 label=&quot;&amp;doNotEncrypt.label;&quot;</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+                 accesskey=&quot;&amp;doNotEncrypt.accesskey;&quot;/&gt;</span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+          &lt;!--</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+          &lt;radio id=&quot;encrypt_allow&quot; wsm_persist=&quot;true&quot; value=&quot;1&quot;</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+                 label=&quot;&quot;/&gt;</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+          --&gt;</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+          &lt;radio id=&quot;encrypt_require&quot; wsm_persist=&quot;true&quot; value=&quot;2&quot;</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineplus">+                 label=&quot;&amp;requireEncryptMessage.label;&quot;</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+                 accesskey=&quot;&amp;requireEncryptMessage.accesskey;&quot;/&gt;</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineplus">+        &lt;/radiogroup&gt;</span>
<a href="#l5.165"></a><span id="l5.165"> </span>
<a href="#l5.166"></a><span id="l5.166" class="difflineminus">-        &lt;radiogroup id=&quot;encryptionChoices&quot;&gt;</span>
<a href="#l5.167"></a><span id="l5.167" class="difflineminus">-          &lt;radio id=&quot;encrypt_mail_never&quot; wsm_persist=&quot;true&quot; value=&quot;0&quot;</span>
<a href="#l5.168"></a><span id="l5.168" class="difflineminus">-                 label=&quot;&amp;neverEncrypt.label;&quot;</span>
<a href="#l5.169"></a><span id="l5.169" class="difflineminus">-                 accesskey=&quot;&amp;neverEncrypt.accesskey;&quot;/&gt;</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineminus">-</span>
<a href="#l5.171"></a><span id="l5.171" class="difflineminus">-          &lt;radio id=&quot;encrypt_mail_always&quot; wsm_persist=&quot;true&quot; value=&quot;2&quot;</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineminus">-                 label=&quot;&amp;alwaysEncryptMessage.label;&quot;</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineminus">-                 accesskey=&quot;&amp;alwaysEncryptMessage.accesskey;&quot;/&gt;</span>
<a href="#l5.174"></a><span id="l5.174" class="difflineminus">-        &lt;/radiogroup&gt;</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineplus">+        &lt;description flex=&quot;1&quot;&gt;&amp;e2eeReqWarning.description;&lt;/description&gt;</span>
<a href="#l5.176"></a><span id="l5.176">       &lt;/html:fieldset&gt;</span>
<a href="#l5.177"></a><span id="l5.177"> </span>
<a href="#l5.178"></a><span id="l5.178" class="difflineminus">-      &lt;!-- Certificate manager --&gt;</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineminus">-      &lt;html:fieldset id=&quot;smimeCertificateManager&quot;&gt;</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineminus">-        &lt;html:legend&gt;&amp;certificates.label;&lt;/html:legend&gt;</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineminus">-        &lt;hbox&gt;</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineminus">-          &lt;button id=&quot;openCertManagerButton&quot; oncommand=&quot;openCertManager();&quot;</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineminus">-                  label=&quot;&amp;manageCerts2.label;&quot; accesskey=&quot;&amp;manageCerts2.accesskey;&quot;</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineminus">-                  prefstring=&quot;security.disable_button.openCertManager&quot;/&gt;</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineminus">-          &lt;button id=&quot;openDeviceManagerButton&quot; oncommand=&quot;openDeviceManager();&quot;</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineminus">-                  label=&quot;&amp;manageDevices.label;&quot; accesskey=&quot;&amp;manageDevices.accesskey;&quot;</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineminus">-                  prefstring=&quot;security.disable_button.openDeviceManager&quot;/&gt;</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineminus">-        &lt;/hbox&gt;</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineplus">+      &lt;separator/&gt;</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineplus">+      &lt;separator/&gt;</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineplus">+      &lt;html:fieldset id=&quot;signing_titlebox&quot;&gt;</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+        &lt;description flex=&quot;1&quot;&gt;&amp;e2eSigning.description;&lt;/description&gt;</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+        &lt;checkbox id=&quot;identity_sign_mail&quot; wsm_persist=&quot;true&quot;</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+                  prefstring=&quot;mail.identity.%identitykey%.sign_mail&quot;</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+                  label=&quot;&amp;signMessage2.label;&quot; accesskey=&quot;&amp;signMessage.accesskey;&quot;/&gt;</span>
<a href="#l5.197"></a><span id="l5.197">       &lt;/html:fieldset&gt;</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineplus">+</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+#ifdef MOZ_OPENPGP</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineplus">+      &lt;separator/&gt;</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineplus">+      &lt;html:fieldset id=&quot;technology_titlebox&quot;&gt;</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineplus">+        &lt;description&gt;&amp;e2eTechPref.description;&lt;/description&gt;</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineplus">+        &lt;radiogroup id=&quot;technologyChoices&quot;&gt;</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+          &lt;radio id=&quot;technology_automatic&quot; wsm_persist=&quot;true&quot; value=&quot;0&quot;</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+                 label=&quot;&amp;technologyAutomatic.label;&quot;/&gt;</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineplus">+</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineplus">+          &lt;radio id=&quot;technology_prefer_openpgp&quot; wsm_persist=&quot;true&quot; value=&quot;2&quot;</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+                 label=&quot;&amp;technologyOpenPGP.label;&quot;/&gt;</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineplus">+</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineplus">+          &lt;radio id=&quot;technology_prefer_smime&quot; wsm_persist=&quot;true&quot; value=&quot;1&quot;</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+                 label=&quot;&amp;technologySMIME.label;&quot;/&gt;</span>
<a href="#l5.212"></a><span id="l5.212" class="difflineplus">+        &lt;/radiogroup&gt;</span>
<a href="#l5.213"></a><span id="l5.213" class="difflineplus">+      &lt;/html:fieldset&gt;</span>
<a href="#l5.214"></a><span id="l5.214" class="difflineplus">+#endif</span>
<a href="#l5.215"></a><span id="l5.215">     &lt;/vbox&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">rename from mailnews/extensions/smime/content/am-smime.js</span>
<a href="#l6.2"></a><span id="l6.2">rename to mail/extensions/am-e2e/am-e2e.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineminus">--- a/mailnews/extensions/smime/content/am-smime.js</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineplus">+++ b/mail/extensions/am-e2e/am-e2e.js</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineat">@@ -1,84 +1,112 @@</span>
<a href="#l6.6"></a><span id="l6.6"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-</span>
<a href="#l6.7"></a><span id="l6.7">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.8"></a><span id="l6.8">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.9"></a><span id="l6.9">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+var { MailConstants } = ChromeUtils.import(</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  &quot;resource:///modules/MailConstants.jsm&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+);</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+  var { EnigmailKeyRing } = ChromeUtils.import(</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+    &quot;chrome://openpgp/content/modules/keyRing.jsm&quot;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+  );</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+}</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22"> var nsIX509CertDB = Ci.nsIX509CertDB;</span>
<a href="#l6.23"></a><span id="l6.23"> var nsX509CertDBContractID = &quot;@mozilla.org/security/x509certdb;1&quot;;</span>
<a href="#l6.24"></a><span id="l6.24"> var nsIX509Cert = Ci.nsIX509Cert;</span>
<a href="#l6.25"></a><span id="l6.25"> </span>
<a href="#l6.26"></a><span id="l6.26"> var email_signing_cert_usage = 4; // SECCertUsage.certUsageEmailSigner</span>
<a href="#l6.27"></a><span id="l6.27"> var email_recipient_cert_usage = 5; // SECCertUsage.certUsageEmailRecipient</span>
<a href="#l6.28"></a><span id="l6.28"> </span>
<a href="#l6.29"></a><span id="l6.29"> var gIdentity;</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-var gPref = null;</span>
<a href="#l6.31"></a><span id="l6.31"> var gEncryptionCertName = null;</span>
<a href="#l6.32"></a><span id="l6.32"> var gHiddenEncryptionPolicy = null;</span>
<a href="#l6.33"></a><span id="l6.33"> var gEncryptionChoices = null;</span>
<a href="#l6.34"></a><span id="l6.34"> var gSignCertName = null;</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+var gTechChoices = null;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+var gHiddenTechPref = null;</span>
<a href="#l6.37"></a><span id="l6.37"> var gSignMessages = null;</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-var gEncryptAlways = null;</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineminus">-var gNeverEncrypt = null;</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+var gRequireEncrypt = null;</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+var gDoNotEncrypt = null;</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+var gKeyId = null;</span>
<a href="#l6.43"></a><span id="l6.43"> var gBundle = null;</span>
<a href="#l6.44"></a><span id="l6.44"> var gBrandBundle;</span>
<a href="#l6.45"></a><span id="l6.45"> var gSmimePrefbranch;</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-var gEncryptionChoicesLocked;</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-var gSigningChoicesLocked;</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-var kEncryptionCertPref = &quot;identity.encryption_cert_name&quot;;</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-var kSigningCertPref = &quot;identity.signing_cert_name&quot;;</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+var kEncryptionCertPref = &quot;identity_encryption_cert_name&quot;;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+var kSigningCertPref = &quot;identity_signing_cert_name&quot;;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+var kOpenPGPKeyPref = &quot;identity_openpgp_key_id&quot;;</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+var gTechAuto = null;</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+var gTechPrefOpenPGP = null;</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+var gTechPrefSMIME = null;</span>
<a href="#l6.57"></a><span id="l6.57"> </span>
<a href="#l6.58"></a><span id="l6.58"> function onInit() {</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineminus">-  smimeInitializeFields();</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+  e2eInitializeFields();</span>
<a href="#l6.61"></a><span id="l6.61"> }</span>
<a href="#l6.62"></a><span id="l6.62"> </span>
<a href="#l6.63"></a><span id="l6.63" class="difflineminus">-function smimeInitializeFields() {</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+function e2eInitializeFields() {</span>
<a href="#l6.65"></a><span id="l6.65">   // initialize all of our elements based on the current identity values....</span>
<a href="#l6.66"></a><span id="l6.66">   gEncryptionCertName = document.getElementById(kEncryptionCertPref);</span>
<a href="#l6.67"></a><span id="l6.67">   gHiddenEncryptionPolicy = document.getElementById(</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineminus">-    &quot;identity.encryptionpolicy&quot;</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineplus">+    &quot;identity_encryptionpolicy&quot;</span>
<a href="#l6.70"></a><span id="l6.70">   );</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+  gHiddenTechPref = document.getElementById(&quot;identity_e2etechpref&quot;);</span>
<a href="#l6.72"></a><span id="l6.72">   gEncryptionChoices = document.getElementById(&quot;encryptionChoices&quot;);</span>
<a href="#l6.73"></a><span id="l6.73">   gSignCertName = document.getElementById(kSigningCertPref);</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineminus">-  gSignMessages = document.getElementById(&quot;identity.sign_mail&quot;);</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineminus">-  gEncryptAlways = document.getElementById(&quot;encrypt_mail_always&quot;);</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineminus">-  gNeverEncrypt = document.getElementById(&quot;encrypt_mail_never&quot;);</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineminus">-  gBundle = document.getElementById(&quot;bundle_smime&quot;);</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineplus">+  gSignMessages = document.getElementById(&quot;identity_sign_mail&quot;);</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineplus">+  gRequireEncrypt = document.getElementById(&quot;encrypt_require&quot;);</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineplus">+  gDoNotEncrypt = document.getElementById(&quot;encrypt_no&quot;);</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+  gBundle = document.getElementById(&quot;bundle_e2e&quot;);</span>
<a href="#l6.82"></a><span id="l6.82">   gBrandBundle = document.getElementById(&quot;bundle_brand&quot;);</span>
<a href="#l6.83"></a><span id="l6.83"> </span>
<a href="#l6.84"></a><span id="l6.84" class="difflineminus">-  gEncryptionChoicesLocked = false;</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineminus">-  gSigningChoicesLocked = false;</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineplus">+    gTechChoices = document.getElementById(&quot;technologyChoices&quot;);</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineplus">+    gKeyId = document.getElementById(kOpenPGPKeyPref);</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineplus">+    gTechAuto = document.getElementById(&quot;technology_automatic&quot;);</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineplus">+    gTechPrefOpenPGP = document.getElementById(&quot;technology_prefer_openpgp&quot;);</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineplus">+    gTechPrefSMIME = document.getElementById(&quot;technology_prefer_smime&quot;);</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineplus">+  }</span>
<a href="#l6.93"></a><span id="l6.93"> </span>
<a href="#l6.94"></a><span id="l6.94">   if (!gIdentity) {</span>
<a href="#l6.95"></a><span id="l6.95">     // The user is going to create a new identity.</span>
<a href="#l6.96"></a><span id="l6.96">     // Set everything to default values.</span>
<a href="#l6.97"></a><span id="l6.97">     // Do not take over the values from gAccount.defaultIdentity</span>
<a href="#l6.98"></a><span id="l6.98">     // as the new identity is going to have a different mail address.</span>
<a href="#l6.99"></a><span id="l6.99"> </span>
<a href="#l6.100"></a><span id="l6.100">     gEncryptionCertName.value = &quot;&quot;;</span>
<a href="#l6.101"></a><span id="l6.101">     gEncryptionCertName.displayName = &quot;&quot;;</span>
<a href="#l6.102"></a><span id="l6.102">     gEncryptionCertName.dbKey = &quot;&quot;;</span>
<a href="#l6.103"></a><span id="l6.103"> </span>
<a href="#l6.104"></a><span id="l6.104">     gSignCertName.value = &quot;&quot;;</span>
<a href="#l6.105"></a><span id="l6.105">     gSignCertName.displayName = &quot;&quot;;</span>
<a href="#l6.106"></a><span id="l6.106">     gSignCertName.dbKey = &quot;&quot;;</span>
<a href="#l6.107"></a><span id="l6.107"> </span>
<a href="#l6.108"></a><span id="l6.108" class="difflineminus">-    gEncryptAlways.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.109"></a><span id="l6.109" class="difflineminus">-    gNeverEncrypt.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.110"></a><span id="l6.110" class="difflineminus">-    gSignMessages.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.111"></a><span id="l6.111" class="difflineplus">+    gKeyId.value = &quot;&quot;;</span>
<a href="#l6.112"></a><span id="l6.112" class="difflineplus">+</span>
<a href="#l6.113"></a><span id="l6.113" class="difflineplus">+    gRequireEncrypt.disabled = true;</span>
<a href="#l6.114"></a><span id="l6.114" class="difflineplus">+    gDoNotEncrypt.disabled = true;</span>
<a href="#l6.115"></a><span id="l6.115" class="difflineplus">+    gSignMessages.disabled = true;</span>
<a href="#l6.116"></a><span id="l6.116"> </span>
<a href="#l6.117"></a><span id="l6.117">     gSignMessages.checked = false;</span>
<a href="#l6.118"></a><span id="l6.118">     gEncryptionChoices.value = 0;</span>
<a href="#l6.119"></a><span id="l6.119" class="difflineplus">+    if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineplus">+      gTechChoices.value = 0;</span>
<a href="#l6.121"></a><span id="l6.121" class="difflineplus">+    }</span>
<a href="#l6.122"></a><span id="l6.122">   } else {</span>
<a href="#l6.123"></a><span id="l6.123">     var certdb = Cc[nsX509CertDBContractID].getService(nsIX509CertDB);</span>
<a href="#l6.124"></a><span id="l6.124">     var x509cert = null;</span>
<a href="#l6.125"></a><span id="l6.125"> </span>
<a href="#l6.126"></a><span id="l6.126" class="difflineplus">+    if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.127"></a><span id="l6.127" class="difflineplus">+      gKeyId.value = gIdentity.getUnicharAttribute(&quot;openpgp_key_id&quot;);</span>
<a href="#l6.128"></a><span id="l6.128" class="difflineplus">+    }</span>
<a href="#l6.129"></a><span id="l6.129">     gEncryptionCertName.value = gIdentity.getUnicharAttribute(</span>
<a href="#l6.130"></a><span id="l6.130">       &quot;encryption_cert_name&quot;</span>
<a href="#l6.131"></a><span id="l6.131">     );</span>
<a href="#l6.132"></a><span id="l6.132">     gEncryptionCertName.dbKey = gIdentity.getCharAttribute(</span>
<a href="#l6.133"></a><span id="l6.133">       &quot;encryption_cert_dbkey&quot;</span>
<a href="#l6.134"></a><span id="l6.134">     );</span>
<a href="#l6.135"></a><span id="l6.135">     // If we succeed in looking up the certificate by the dbkey pref, then</span>
<a href="#l6.136"></a><span id="l6.136">     // append the serial number &quot; [...]&quot; to the display value, and remember the</span>
<a href="#l6.137"></a><span id="l6.137" class="difflineat">@@ -91,23 +119,24 @@ function smimeInitializeFields() {</span>
<a href="#l6.138"></a><span id="l6.138">       ) {</span>
<a href="#l6.139"></a><span id="l6.139">         gEncryptionCertName.value =</span>
<a href="#l6.140"></a><span id="l6.140">           x509cert.displayName + &quot; [&quot; + x509cert.serialNumber + &quot;]&quot;;</span>
<a href="#l6.141"></a><span id="l6.141">         gEncryptionCertName.displayName = x509cert.displayName;</span>
<a href="#l6.142"></a><span id="l6.142">       }</span>
<a href="#l6.143"></a><span id="l6.143">     } catch (e) {}</span>
<a href="#l6.144"></a><span id="l6.144"> </span>
<a href="#l6.145"></a><span id="l6.145">     gEncryptionChoices.value = gIdentity.getIntAttribute(&quot;encryptionpolicy&quot;);</span>
<a href="#l6.146"></a><span id="l6.146" class="difflineplus">+    if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.147"></a><span id="l6.147" class="difflineplus">+      gTechChoices.value = gIdentity.getIntAttribute(&quot;e2etechpref&quot;);</span>
<a href="#l6.148"></a><span id="l6.148" class="difflineplus">+    }</span>
<a href="#l6.149"></a><span id="l6.149"> </span>
<a href="#l6.150"></a><span id="l6.150" class="difflineminus">-    if (!gEncryptionCertName.value) {</span>
<a href="#l6.151"></a><span id="l6.151" class="difflineminus">-      gEncryptAlways.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.152"></a><span id="l6.152" class="difflineminus">-      gNeverEncrypt.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.153"></a><span id="l6.153" class="difflineminus">-    } else {</span>
<a href="#l6.154"></a><span id="l6.154" class="difflineminus">-      enableEncryptionControls(true);</span>
<a href="#l6.155"></a><span id="l6.155" class="difflineminus">-    }</span>
<a href="#l6.156"></a><span id="l6.156" class="difflineplus">+    let enableEnc = gEncryptionCertName.value || gKeyId.value;</span>
<a href="#l6.157"></a><span id="l6.157" class="difflineplus">+    gRequireEncrypt.disabled = !enableEnc;</span>
<a href="#l6.158"></a><span id="l6.158" class="difflineplus">+    gDoNotEncrypt.disabled = !enableEnc;</span>
<a href="#l6.159"></a><span id="l6.159" class="difflineplus">+    enableEncryptionControls(enableEnc);</span>
<a href="#l6.160"></a><span id="l6.160"> </span>
<a href="#l6.161"></a><span id="l6.161">     gSignCertName.value = gIdentity.getUnicharAttribute(&quot;signing_cert_name&quot;);</span>
<a href="#l6.162"></a><span id="l6.162">     gSignCertName.dbKey = gIdentity.getCharAttribute(&quot;signing_cert_dbkey&quot;);</span>
<a href="#l6.163"></a><span id="l6.163">     x509cert = null;</span>
<a href="#l6.164"></a><span id="l6.164">     // same procedure as with gEncryptionCertName (see above)</span>
<a href="#l6.165"></a><span id="l6.165">     try {</span>
<a href="#l6.166"></a><span id="l6.166">       if (</span>
<a href="#l6.167"></a><span id="l6.167">         certdb &amp;&amp;</span>
<a href="#l6.168"></a><span id="l6.168" class="difflineat">@@ -116,48 +145,53 @@ function smimeInitializeFields() {</span>
<a href="#l6.169"></a><span id="l6.169">       ) {</span>
<a href="#l6.170"></a><span id="l6.170">         gSignCertName.value =</span>
<a href="#l6.171"></a><span id="l6.171">           x509cert.displayName + &quot; [&quot; + x509cert.serialNumber + &quot;]&quot;;</span>
<a href="#l6.172"></a><span id="l6.172">         gSignCertName.displayName = x509cert.displayName;</span>
<a href="#l6.173"></a><span id="l6.173">       }</span>
<a href="#l6.174"></a><span id="l6.174">     } catch (e) {}</span>
<a href="#l6.175"></a><span id="l6.175"> </span>
<a href="#l6.176"></a><span id="l6.176">     gSignMessages.checked = gIdentity.getBoolAttribute(&quot;sign_mail&quot;);</span>
<a href="#l6.177"></a><span id="l6.177" class="difflineminus">-    if (!gSignCertName.value) {</span>
<a href="#l6.178"></a><span id="l6.178" class="difflineminus">-      gSignMessages.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineminus">-    } else {</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineminus">-      enableSigningControls(true);</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineminus">-    }</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineplus">+</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineplus">+    let enableSig = gSignCertName.value || gKeyId.value;</span>
<a href="#l6.184"></a><span id="l6.184" class="difflineplus">+    gSignMessages.disabled = !enableSig;</span>
<a href="#l6.185"></a><span id="l6.185" class="difflineplus">+    enableSigningControls(enableSig);</span>
<a href="#l6.186"></a><span id="l6.186">   }</span>
<a href="#l6.187"></a><span id="l6.187"> </span>
<a href="#l6.188"></a><span id="l6.188" class="difflineminus">-  // Always start with enabling signing and encryption cert select buttons.</span>
<a href="#l6.189"></a><span id="l6.189" class="difflineplus">+  // Always start with enabling select buttons.</span>
<a href="#l6.190"></a><span id="l6.190">   // This will keep the visibility of buttons in a sane state as user</span>
<a href="#l6.191"></a><span id="l6.191">   // jumps from security panel of one account to another.</span>
<a href="#l6.192"></a><span id="l6.192" class="difflineminus">-  enableCertSelectButtons();</span>
<a href="#l6.193"></a><span id="l6.193" class="difflineminus">-</span>
<a href="#l6.194"></a><span id="l6.194" class="difflineminus">-  // Disable all locked elements on the panel</span>
<a href="#l6.195"></a><span id="l6.195" class="difflineminus">-  if (gIdentity) {</span>
<a href="#l6.196"></a><span id="l6.196" class="difflineminus">-    onLockPreference();</span>
<a href="#l6.197"></a><span id="l6.197" class="difflineminus">-  }</span>
<a href="#l6.198"></a><span id="l6.198" class="difflineplus">+  enableSelectButtons();</span>
<a href="#l6.199"></a><span id="l6.199" class="difflineplus">+  updateTechPref();</span>
<a href="#l6.200"></a><span id="l6.200"> }</span>
<a href="#l6.201"></a><span id="l6.201"> </span>
<a href="#l6.202"></a><span id="l6.202"> function onPreInit(account, accountValues) {</span>
<a href="#l6.203"></a><span id="l6.203">   gIdentity = account.defaultIdentity;</span>
<a href="#l6.204"></a><span id="l6.204"> }</span>
<a href="#l6.205"></a><span id="l6.205"> </span>
<a href="#l6.206"></a><span id="l6.206"> function onSave() {</span>
<a href="#l6.207"></a><span id="l6.207" class="difflineminus">-  smimeSave();</span>
<a href="#l6.208"></a><span id="l6.208" class="difflineplus">+  e2eSave();</span>
<a href="#l6.209"></a><span id="l6.209">   window.dispatchEvent(new CustomEvent(&quot;prefchange&quot;));</span>
<a href="#l6.210"></a><span id="l6.210"> }</span>
<a href="#l6.211"></a><span id="l6.211"> </span>
<a href="#l6.212"></a><span id="l6.212" class="difflineminus">-function smimeSave() {</span>
<a href="#l6.213"></a><span id="l6.213" class="difflineplus">+function e2eSave() {</span>
<a href="#l6.214"></a><span id="l6.214">   // find out which radio for the encryption radio group is selected and set that on our hidden encryptionChoice pref....</span>
<a href="#l6.215"></a><span id="l6.215">   var newValue = gEncryptionChoices.value;</span>
<a href="#l6.216"></a><span id="l6.216">   gHiddenEncryptionPolicy.setAttribute(&quot;value&quot;, newValue);</span>
<a href="#l6.217"></a><span id="l6.217">   gIdentity.setIntAttribute(&quot;encryptionpolicy&quot;, newValue);</span>
<a href="#l6.218"></a><span id="l6.218" class="difflineplus">+</span>
<a href="#l6.219"></a><span id="l6.219" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.220"></a><span id="l6.220" class="difflineplus">+    newValue = gTechChoices.value;</span>
<a href="#l6.221"></a><span id="l6.221" class="difflineplus">+    gHiddenTechPref.setAttribute(&quot;value&quot;, newValue);</span>
<a href="#l6.222"></a><span id="l6.222" class="difflineplus">+    gIdentity.setIntAttribute(&quot;e2etechpref&quot;, newValue);</span>
<a href="#l6.223"></a><span id="l6.223" class="difflineplus">+  }</span>
<a href="#l6.224"></a><span id="l6.224" class="difflineplus">+</span>
<a href="#l6.225"></a><span id="l6.225" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.226"></a><span id="l6.226" class="difflineplus">+    gIdentity.setUnicharAttribute(&quot;openpgp_key_id&quot;, gKeyId.value);</span>
<a href="#l6.227"></a><span id="l6.227" class="difflineplus">+  }</span>
<a href="#l6.228"></a><span id="l6.228">   gIdentity.setUnicharAttribute(</span>
<a href="#l6.229"></a><span id="l6.229">     &quot;encryption_cert_name&quot;,</span>
<a href="#l6.230"></a><span id="l6.230">     gEncryptionCertName.displayName || gEncryptionCertName.value</span>
<a href="#l6.231"></a><span id="l6.231">   );</span>
<a href="#l6.232"></a><span id="l6.232">   gIdentity.setCharAttribute(</span>
<a href="#l6.233"></a><span id="l6.233">     &quot;encryption_cert_dbkey&quot;,</span>
<a href="#l6.234"></a><span id="l6.234">     gEncryptionCertName.dbKey</span>
<a href="#l6.235"></a><span id="l6.235">   );</span>
<a href="#l6.236"></a><span id="l6.236" class="difflineat">@@ -165,82 +199,18 @@ function smimeSave() {</span>
<a href="#l6.237"></a><span id="l6.237">   gIdentity.setBoolAttribute(&quot;sign_mail&quot;, gSignMessages.checked);</span>
<a href="#l6.238"></a><span id="l6.238">   gIdentity.setUnicharAttribute(</span>
<a href="#l6.239"></a><span id="l6.239">     &quot;signing_cert_name&quot;,</span>
<a href="#l6.240"></a><span id="l6.240">     gSignCertName.displayName || gSignCertName.value</span>
<a href="#l6.241"></a><span id="l6.241">   );</span>
<a href="#l6.242"></a><span id="l6.242">   gIdentity.setCharAttribute(&quot;signing_cert_dbkey&quot;, gSignCertName.dbKey);</span>
<a href="#l6.243"></a><span id="l6.243"> }</span>
<a href="#l6.244"></a><span id="l6.244"> </span>
<a href="#l6.245"></a><span id="l6.245" class="difflineminus">-function smimeOnAcceptEditor(event) {</span>
<a href="#l6.246"></a><span id="l6.246" class="difflineminus">-  smimeSave();</span>
<a href="#l6.247"></a><span id="l6.247" class="difflineminus">-}</span>
<a href="#l6.248"></a><span id="l6.248" class="difflineminus">-</span>
<a href="#l6.249"></a><span id="l6.249" class="difflineminus">-function onLockPreference() {</span>
<a href="#l6.250"></a><span id="l6.250" class="difflineminus">-  var initPrefString = &quot;mail.identity&quot;;</span>
<a href="#l6.251"></a><span id="l6.251" class="difflineminus">-  var finalPrefString;</span>
<a href="#l6.252"></a><span id="l6.252" class="difflineminus">-</span>
<a href="#l6.253"></a><span id="l6.253" class="difflineminus">-  var allPrefElements = [</span>
<a href="#l6.254"></a><span id="l6.254" class="difflineminus">-    { prefstring: &quot;signingCertSelectButton&quot;, id: &quot;signingCertSelectButton&quot; },</span>
<a href="#l6.255"></a><span id="l6.255" class="difflineminus">-    {</span>
<a href="#l6.256"></a><span id="l6.256" class="difflineminus">-      prefstring: &quot;encryptionCertSelectButton&quot;,</span>
<a href="#l6.257"></a><span id="l6.257" class="difflineminus">-      id: &quot;encryptionCertSelectButton&quot;,</span>
<a href="#l6.258"></a><span id="l6.258" class="difflineminus">-    },</span>
<a href="#l6.259"></a><span id="l6.259" class="difflineminus">-    { prefstring: &quot;sign_mail&quot;, id: &quot;identity.sign_mail&quot; },</span>
<a href="#l6.260"></a><span id="l6.260" class="difflineminus">-    { prefstring: &quot;encryptionpolicy&quot;, id: &quot;encryptionChoices&quot; },</span>
<a href="#l6.261"></a><span id="l6.261" class="difflineminus">-  ];</span>
<a href="#l6.262"></a><span id="l6.262" class="difflineminus">-</span>
<a href="#l6.263"></a><span id="l6.263" class="difflineminus">-  finalPrefString = initPrefString + &quot;.&quot; + gIdentity.key + &quot;.&quot;;</span>
<a href="#l6.264"></a><span id="l6.264" class="difflineminus">-  gSmimePrefbranch = Services.prefs.getBranch(finalPrefString);</span>
<a href="#l6.265"></a><span id="l6.265" class="difflineminus">-</span>
<a href="#l6.266"></a><span id="l6.266" class="difflineminus">-  disableIfLocked(allPrefElements);</span>
<a href="#l6.267"></a><span id="l6.267" class="difflineminus">-}</span>
<a href="#l6.268"></a><span id="l6.268" class="difflineminus">-</span>
<a href="#l6.269"></a><span id="l6.269" class="difflineminus">-// Does the work of disabling an element given the array which contains xul id/prefstring pairs.</span>
<a href="#l6.270"></a><span id="l6.270" class="difflineminus">-// Also saves the id/locked state in an array so that other areas of the code can avoid</span>
<a href="#l6.271"></a><span id="l6.271" class="difflineminus">-// stomping on the disabled state indiscriminately.</span>
<a href="#l6.272"></a><span id="l6.272" class="difflineminus">-function disableIfLocked(prefstrArray) {</span>
<a href="#l6.273"></a><span id="l6.273" class="difflineminus">-  for (let i = 0; i &lt; prefstrArray.length; i++) {</span>
<a href="#l6.274"></a><span id="l6.274" class="difflineminus">-    var id = prefstrArray[i].id;</span>
<a href="#l6.275"></a><span id="l6.275" class="difflineminus">-    var element = document.getElementById(id);</span>
<a href="#l6.276"></a><span id="l6.276" class="difflineminus">-    if (gSmimePrefbranch.prefIsLocked(prefstrArray[i].prefstring)) {</span>
<a href="#l6.277"></a><span id="l6.277" class="difflineminus">-      // If encryption choices radio group is locked, make sure the individual</span>
<a href="#l6.278"></a><span id="l6.278" class="difflineminus">-      // choices in the group are locked. Set a global (gEncryptionChoicesLocked)</span>
<a href="#l6.279"></a><span id="l6.279" class="difflineminus">-      // indicating the status so that locking can be maintained further.</span>
<a href="#l6.280"></a><span id="l6.280" class="difflineminus">-      if (id == &quot;encryptionChoices&quot;) {</span>
<a href="#l6.281"></a><span id="l6.281" class="difflineminus">-        document</span>
<a href="#l6.282"></a><span id="l6.282" class="difflineminus">-          .getElementById(&quot;encrypt_mail_never&quot;)</span>
<a href="#l6.283"></a><span id="l6.283" class="difflineminus">-          .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.284"></a><span id="l6.284" class="difflineminus">-        document</span>
<a href="#l6.285"></a><span id="l6.285" class="difflineminus">-          .getElementById(&quot;encrypt_mail_always&quot;)</span>
<a href="#l6.286"></a><span id="l6.286" class="difflineminus">-          .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.287"></a><span id="l6.287" class="difflineminus">-        gEncryptionChoicesLocked = true;</span>
<a href="#l6.288"></a><span id="l6.288" class="difflineminus">-      }</span>
<a href="#l6.289"></a><span id="l6.289" class="difflineminus">-      // If option to sign mail is locked (with true/false set in config file), disable</span>
<a href="#l6.290"></a><span id="l6.290" class="difflineminus">-      // the corresponding checkbox and set a global (gSigningChoicesLocked) in order to</span>
<a href="#l6.291"></a><span id="l6.291" class="difflineminus">-      // honor the locking as user changes other elements on the panel.</span>
<a href="#l6.292"></a><span id="l6.292" class="difflineminus">-      if (id == &quot;identity.sign_mail&quot;) {</span>
<a href="#l6.293"></a><span id="l6.293" class="difflineminus">-        document</span>
<a href="#l6.294"></a><span id="l6.294" class="difflineminus">-          .getElementById(&quot;identity.sign_mail&quot;)</span>
<a href="#l6.295"></a><span id="l6.295" class="difflineminus">-          .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.296"></a><span id="l6.296" class="difflineminus">-        gSigningChoicesLocked = true;</span>
<a href="#l6.297"></a><span id="l6.297" class="difflineminus">-      } else {</span>
<a href="#l6.298"></a><span id="l6.298" class="difflineminus">-        element.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.299"></a><span id="l6.299" class="difflineminus">-        if (id == &quot;signingCertSelectButton&quot;) {</span>
<a href="#l6.300"></a><span id="l6.300" class="difflineminus">-          document</span>
<a href="#l6.301"></a><span id="l6.301" class="difflineminus">-            .getElementById(&quot;signingCertClearButton&quot;)</span>
<a href="#l6.302"></a><span id="l6.302" class="difflineminus">-            .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.303"></a><span id="l6.303" class="difflineminus">-        } else if (id == &quot;encryptionCertSelectButton&quot;) {</span>
<a href="#l6.304"></a><span id="l6.304" class="difflineminus">-          document</span>
<a href="#l6.305"></a><span id="l6.305" class="difflineminus">-            .getElementById(&quot;encryptionCertClearButton&quot;)</span>
<a href="#l6.306"></a><span id="l6.306" class="difflineminus">-            .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.307"></a><span id="l6.307" class="difflineminus">-        }</span>
<a href="#l6.308"></a><span id="l6.308" class="difflineminus">-      }</span>
<a href="#l6.309"></a><span id="l6.309" class="difflineminus">-    }</span>
<a href="#l6.310"></a><span id="l6.310" class="difflineminus">-  }</span>
<a href="#l6.311"></a><span id="l6.311" class="difflineplus">+function e2eOnAcceptEditor(event) {</span>
<a href="#l6.312"></a><span id="l6.312" class="difflineplus">+  e2eSave();</span>
<a href="#l6.313"></a><span id="l6.313"> }</span>
<a href="#l6.314"></a><span id="l6.314"> </span>
<a href="#l6.315"></a><span id="l6.315"> function alertUser(message) {</span>
<a href="#l6.316"></a><span id="l6.316">   Services.prompt.alert(</span>
<a href="#l6.317"></a><span id="l6.317">     window,</span>
<a href="#l6.318"></a><span id="l6.318">     gBrandBundle.getString(&quot;brandShortName&quot;),</span>
<a href="#l6.319"></a><span id="l6.319">     message</span>
<a href="#l6.320"></a><span id="l6.320">   );</span>
<a href="#l6.321"></a><span id="l6.321" class="difflineat">@@ -308,16 +278,58 @@ function checkOtherCert(</span>
<a href="#l6.322"></a><span id="l6.322">   if (userWantsSameCert) {</span>
<a href="#l6.323"></a><span id="l6.323">     otherCertInfo.value = cert.displayName + &quot; [&quot; + cert.serialNumber + &quot;]&quot;;</span>
<a href="#l6.324"></a><span id="l6.324">     otherCertInfo.displayName = cert.displayName;</span>
<a href="#l6.325"></a><span id="l6.325">     otherCertInfo.dbKey = cert.dbKey;</span>
<a href="#l6.326"></a><span id="l6.326">     enabler(true);</span>
<a href="#l6.327"></a><span id="l6.327">   }</span>
<a href="#l6.328"></a><span id="l6.328"> }</span>
<a href="#l6.329"></a><span id="l6.329"> </span>
<a href="#l6.330"></a><span id="l6.330" class="difflineplus">+function pgpSelectKey(pgp_key) {</span>
<a href="#l6.331"></a><span id="l6.331" class="difflineplus">+  if (!MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.332"></a><span id="l6.332" class="difflineplus">+    return;</span>
<a href="#l6.333"></a><span id="l6.333" class="difflineplus">+  }</span>
<a href="#l6.334"></a><span id="l6.334" class="difflineplus">+</span>
<a href="#l6.335"></a><span id="l6.335" class="difflineplus">+  var keyInfo = document.getElementById(pgp_key);</span>
<a href="#l6.336"></a><span id="l6.336" class="difflineplus">+  if (!keyInfo) {</span>
<a href="#l6.337"></a><span id="l6.337" class="difflineplus">+    return;</span>
<a href="#l6.338"></a><span id="l6.338" class="difflineplus">+  }</span>
<a href="#l6.339"></a><span id="l6.339" class="difflineplus">+</span>
<a href="#l6.340"></a><span id="l6.340" class="difflineplus">+  let result = {};</span>
<a href="#l6.341"></a><span id="l6.341" class="difflineplus">+  EnigmailKeyRing.getAllSecretKeysByEmail(gIdentity.email, result);</span>
<a href="#l6.342"></a><span id="l6.342" class="difflineplus">+</span>
<a href="#l6.343"></a><span id="l6.343" class="difflineplus">+  let params = {</span>
<a href="#l6.344"></a><span id="l6.344" class="difflineplus">+    keys: result.all,</span>
<a href="#l6.345"></a><span id="l6.345" class="difflineplus">+    identity: gIdentity.fullAddress,</span>
<a href="#l6.346"></a><span id="l6.346" class="difflineplus">+    canceled: true,</span>
<a href="#l6.347"></a><span id="l6.347" class="difflineplus">+    index: -1,</span>
<a href="#l6.348"></a><span id="l6.348" class="difflineplus">+  };</span>
<a href="#l6.349"></a><span id="l6.349" class="difflineplus">+</span>
<a href="#l6.350"></a><span id="l6.350" class="difflineplus">+  window.docShell.rootTreeItem.domWindow.openDialog(</span>
<a href="#l6.351"></a><span id="l6.351" class="difflineplus">+    &quot;chrome://openpgp/content/ui/keyPicker.xhtml&quot;,</span>
<a href="#l6.352"></a><span id="l6.352" class="difflineplus">+    &quot;&quot;,</span>
<a href="#l6.353"></a><span id="l6.353" class="difflineplus">+    &quot;dialog,close,titlebar,modal,resizable&quot;,</span>
<a href="#l6.354"></a><span id="l6.354" class="difflineplus">+    params</span>
<a href="#l6.355"></a><span id="l6.355" class="difflineplus">+  );</span>
<a href="#l6.356"></a><span id="l6.356" class="difflineplus">+</span>
<a href="#l6.357"></a><span id="l6.357" class="difflineplus">+  if (params.canceled) {</span>
<a href="#l6.358"></a><span id="l6.358" class="difflineplus">+    return;</span>
<a href="#l6.359"></a><span id="l6.359" class="difflineplus">+  }</span>
<a href="#l6.360"></a><span id="l6.360" class="difflineplus">+</span>
<a href="#l6.361"></a><span id="l6.361" class="difflineplus">+  keyInfo.value = result.all[params.index].keyId;</span>
<a href="#l6.362"></a><span id="l6.362" class="difflineplus">+  keyInfo.displayName = result.all[params.index].keyId;</span>
<a href="#l6.363"></a><span id="l6.363" class="difflineplus">+</span>
<a href="#l6.364"></a><span id="l6.364" class="difflineplus">+  enableEncryptionControls(true);</span>
<a href="#l6.365"></a><span id="l6.365" class="difflineplus">+  enableSigningControls(true);</span>
<a href="#l6.366"></a><span id="l6.366" class="difflineplus">+</span>
<a href="#l6.367"></a><span id="l6.367" class="difflineplus">+  updateTechPref();</span>
<a href="#l6.368"></a><span id="l6.368" class="difflineplus">+  enableSelectButtons();</span>
<a href="#l6.369"></a><span id="l6.369" class="difflineplus">+  onSave();</span>
<a href="#l6.370"></a><span id="l6.370" class="difflineplus">+}</span>
<a href="#l6.371"></a><span id="l6.371" class="difflineplus">+</span>
<a href="#l6.372"></a><span id="l6.372"> function smimeSelectCert(smime_cert) {</span>
<a href="#l6.373"></a><span id="l6.373">   var certInfo = document.getElementById(smime_cert);</span>
<a href="#l6.374"></a><span id="l6.374">   if (!certInfo) {</span>
<a href="#l6.375"></a><span id="l6.375">     return;</span>
<a href="#l6.376"></a><span id="l6.376">   }</span>
<a href="#l6.377"></a><span id="l6.377"> </span>
<a href="#l6.378"></a><span id="l6.378">   var picker = Cc[&quot;@mozilla.org/user_cert_picker;1&quot;].createInstance(</span>
<a href="#l6.379"></a><span id="l6.379">     Ci.nsIUserCertPicker</span>
<a href="#l6.380"></a><span id="l6.380" class="difflineat">@@ -364,17 +376,17 @@ function smimeSelectCert(smime_cert) {</span>
<a href="#l6.381"></a><span id="l6.381">       } else {</span>
<a href="#l6.382"></a><span id="l6.382">         alertUser(</span>
<a href="#l6.383"></a><span id="l6.383">           gBundle.getString(</span>
<a href="#l6.384"></a><span id="l6.384">             selectEncryptionCert ? &quot;NoEncryptionCert&quot; : &quot;NoSigningCert&quot;</span>
<a href="#l6.385"></a><span id="l6.385">           )</span>
<a href="#l6.386"></a><span id="l6.386">         );</span>
<a href="#l6.387"></a><span id="l6.387">       }</span>
<a href="#l6.388"></a><span id="l6.388">     } else {</span>
<a href="#l6.389"></a><span id="l6.389" class="difflineminus">-      certInfo.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.390"></a><span id="l6.390" class="difflineplus">+      certInfo.disabled = false;</span>
<a href="#l6.391"></a><span id="l6.391">       certInfo.value =</span>
<a href="#l6.392"></a><span id="l6.392">         x509cert.displayName + &quot; [&quot; + x509cert.serialNumber + &quot;]&quot;;</span>
<a href="#l6.393"></a><span id="l6.393">       certInfo.displayName = x509cert.displayName;</span>
<a href="#l6.394"></a><span id="l6.394">       certInfo.dbKey = x509cert.dbKey;</span>
<a href="#l6.395"></a><span id="l6.395"> </span>
<a href="#l6.396"></a><span id="l6.396">       if (selectEncryptionCert) {</span>
<a href="#l6.397"></a><span id="l6.397">         enableEncryptionControls(true);</span>
<a href="#l6.398"></a><span id="l6.398"> </span>
<a href="#l6.399"></a><span id="l6.399" class="difflineat">@@ -398,105 +410,131 @@ function smimeSelectCert(smime_cert) {</span>
<a href="#l6.400"></a><span id="l6.400">           &quot;encryption_wantSame&quot;,</span>
<a href="#l6.401"></a><span id="l6.401">           &quot;encryption_needCertWantToSelect&quot;,</span>
<a href="#l6.402"></a><span id="l6.402">           enableEncryptionControls</span>
<a href="#l6.403"></a><span id="l6.403">         );</span>
<a href="#l6.404"></a><span id="l6.404">       }</span>
<a href="#l6.405"></a><span id="l6.405">     }</span>
<a href="#l6.406"></a><span id="l6.406">   }</span>
<a href="#l6.407"></a><span id="l6.407"> </span>
<a href="#l6.408"></a><span id="l6.408" class="difflineminus">-  enableCertSelectButtons();</span>
<a href="#l6.409"></a><span id="l6.409" class="difflineplus">+  updateTechPref();</span>
<a href="#l6.410"></a><span id="l6.410" class="difflineplus">+  enableSelectButtons();</span>
<a href="#l6.411"></a><span id="l6.411" class="difflineplus">+  onSave();</span>
<a href="#l6.412"></a><span id="l6.412"> }</span>
<a href="#l6.413"></a><span id="l6.413"> </span>
<a href="#l6.414"></a><span id="l6.414"> function enableEncryptionControls(do_enable) {</span>
<a href="#l6.415"></a><span id="l6.415" class="difflineminus">-  if (gEncryptionChoicesLocked) {</span>
<a href="#l6.416"></a><span id="l6.416" class="difflineminus">-    return;</span>
<a href="#l6.417"></a><span id="l6.417" class="difflineminus">-  }</span>
<a href="#l6.418"></a><span id="l6.418" class="difflineminus">-</span>
<a href="#l6.419"></a><span id="l6.419" class="difflineminus">-  if (do_enable) {</span>
<a href="#l6.420"></a><span id="l6.420" class="difflineminus">-    gEncryptAlways.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.421"></a><span id="l6.421" class="difflineminus">-    gNeverEncrypt.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.422"></a><span id="l6.422" class="difflineminus">-    gEncryptionCertName.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.423"></a><span id="l6.423" class="difflineminus">-  } else {</span>
<a href="#l6.424"></a><span id="l6.424" class="difflineminus">-    gEncryptAlways.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.425"></a><span id="l6.425" class="difflineminus">-    gNeverEncrypt.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.426"></a><span id="l6.426" class="difflineminus">-    gEncryptionCertName.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.427"></a><span id="l6.427" class="difflineplus">+  gRequireEncrypt.disabled = !do_enable;</span>
<a href="#l6.428"></a><span id="l6.428" class="difflineplus">+  gDoNotEncrypt.disabled = !do_enable;</span>
<a href="#l6.429"></a><span id="l6.429" class="difflineplus">+  if (!do_enable) {</span>
<a href="#l6.430"></a><span id="l6.430">     gEncryptionChoices.value = 0;</span>
<a href="#l6.431"></a><span id="l6.431">   }</span>
<a href="#l6.432"></a><span id="l6.432"> }</span>
<a href="#l6.433"></a><span id="l6.433"> </span>
<a href="#l6.434"></a><span id="l6.434"> function enableSigningControls(do_enable) {</span>
<a href="#l6.435"></a><span id="l6.435" class="difflineminus">-  if (gSigningChoicesLocked) {</span>
<a href="#l6.436"></a><span id="l6.436" class="difflineminus">-    return;</span>
<a href="#l6.437"></a><span id="l6.437" class="difflineminus">-  }</span>
<a href="#l6.438"></a><span id="l6.438" class="difflineminus">-</span>
<a href="#l6.439"></a><span id="l6.439" class="difflineminus">-  if (do_enable) {</span>
<a href="#l6.440"></a><span id="l6.440" class="difflineminus">-    gSignMessages.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.441"></a><span id="l6.441" class="difflineminus">-    gSignCertName.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.442"></a><span id="l6.442" class="difflineminus">-  } else {</span>
<a href="#l6.443"></a><span id="l6.443" class="difflineminus">-    gSignMessages.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.444"></a><span id="l6.444" class="difflineminus">-    gSignCertName.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.445"></a><span id="l6.445" class="difflineplus">+  gSignMessages.disabled = !do_enable;</span>
<a href="#l6.446"></a><span id="l6.446" class="difflineplus">+  if (!do_enable) {</span>
<a href="#l6.447"></a><span id="l6.447">     gSignMessages.checked = false;</span>
<a href="#l6.448"></a><span id="l6.448">   }</span>
<a href="#l6.449"></a><span id="l6.449"> }</span>
<a href="#l6.450"></a><span id="l6.450"> </span>
<a href="#l6.451"></a><span id="l6.451" class="difflineminus">-function enableCertSelectButtons() {</span>
<a href="#l6.452"></a><span id="l6.452" class="difflineminus">-  document</span>
<a href="#l6.453"></a><span id="l6.453" class="difflineminus">-    .getElementById(&quot;signingCertSelectButton&quot;)</span>
<a href="#l6.454"></a><span id="l6.454" class="difflineminus">-    .removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.455"></a><span id="l6.455" class="difflineplus">+function enableSelectButtons() {</span>
<a href="#l6.456"></a><span id="l6.456" class="difflineplus">+  gSignCertName.disabled = !gSignCertName.value;</span>
<a href="#l6.457"></a><span id="l6.457" class="difflineplus">+  document.getElementById(</span>
<a href="#l6.458"></a><span id="l6.458" class="difflineplus">+    &quot;signingCertClearButton&quot;</span>
<a href="#l6.459"></a><span id="l6.459" class="difflineplus">+  ).disabled = !gSignCertName.value;</span>
<a href="#l6.460"></a><span id="l6.460" class="difflineplus">+</span>
<a href="#l6.461"></a><span id="l6.461" class="difflineplus">+  gEncryptionCertName.disabled = !gEncryptionCertName.value;</span>
<a href="#l6.462"></a><span id="l6.462" class="difflineplus">+  document.getElementById(</span>
<a href="#l6.463"></a><span id="l6.463" class="difflineplus">+    &quot;encryptionCertClearButton&quot;</span>
<a href="#l6.464"></a><span id="l6.464" class="difflineplus">+  ).disabled = !gEncryptionCertName.value;</span>
<a href="#l6.465"></a><span id="l6.465"> </span>
<a href="#l6.466"></a><span id="l6.466" class="difflineminus">-  if (document.getElementById(&quot;identity.signing_cert_name&quot;).value.length) {</span>
<a href="#l6.467"></a><span id="l6.467" class="difflineminus">-    document</span>
<a href="#l6.468"></a><span id="l6.468" class="difflineminus">-      .getElementById(&quot;signingCertClearButton&quot;)</span>
<a href="#l6.469"></a><span id="l6.469" class="difflineminus">-      .removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.470"></a><span id="l6.470" class="difflineminus">-  } else {</span>
<a href="#l6.471"></a><span id="l6.471" class="difflineminus">-    document</span>
<a href="#l6.472"></a><span id="l6.472" class="difflineminus">-      .getElementById(&quot;signingCertClearButton&quot;)</span>
<a href="#l6.473"></a><span id="l6.473" class="difflineminus">-      .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.474"></a><span id="l6.474" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.475"></a><span id="l6.475" class="difflineplus">+    gKeyId.disabled = !gKeyId.value;</span>
<a href="#l6.476"></a><span id="l6.476" class="difflineplus">+    document.getElementById(&quot;openpgpKeyClearButton&quot;).disabled = !gKeyId.value;</span>
<a href="#l6.477"></a><span id="l6.477" class="difflineplus">+  }</span>
<a href="#l6.478"></a><span id="l6.478" class="difflineplus">+}</span>
<a href="#l6.479"></a><span id="l6.479" class="difflineplus">+</span>
<a href="#l6.480"></a><span id="l6.480" class="difflineplus">+function pgpClearKey(pgp_key) {</span>
<a href="#l6.481"></a><span id="l6.481" class="difflineplus">+  if (!MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.482"></a><span id="l6.482" class="difflineplus">+    return;</span>
<a href="#l6.483"></a><span id="l6.483" class="difflineplus">+  }</span>
<a href="#l6.484"></a><span id="l6.484" class="difflineplus">+  var keyInfo = document.getElementById(pgp_key);</span>
<a href="#l6.485"></a><span id="l6.485" class="difflineplus">+  if (!keyInfo) {</span>
<a href="#l6.486"></a><span id="l6.486" class="difflineplus">+    return;</span>
<a href="#l6.487"></a><span id="l6.487">   }</span>
<a href="#l6.488"></a><span id="l6.488"> </span>
<a href="#l6.489"></a><span id="l6.489" class="difflineminus">-  document</span>
<a href="#l6.490"></a><span id="l6.490" class="difflineminus">-    .getElementById(&quot;encryptionCertSelectButton&quot;)</span>
<a href="#l6.491"></a><span id="l6.491" class="difflineminus">-    .removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.492"></a><span id="l6.492" class="difflineplus">+  keyInfo.disabled = true;</span>
<a href="#l6.493"></a><span id="l6.493" class="difflineplus">+  keyInfo.value = &quot;&quot;;</span>
<a href="#l6.494"></a><span id="l6.494" class="difflineplus">+</span>
<a href="#l6.495"></a><span id="l6.495" class="difflineplus">+  let stillHaveOtherSigning = gSignCertName &amp;&amp; gSignCertName.value;</span>
<a href="#l6.496"></a><span id="l6.496" class="difflineplus">+  let stillHaveOtherEncryption =</span>
<a href="#l6.497"></a><span id="l6.497" class="difflineplus">+    gEncryptionCertName &amp;&amp; gEncryptionCertName.value;</span>
<a href="#l6.498"></a><span id="l6.498"> </span>
<a href="#l6.499"></a><span id="l6.499" class="difflineminus">-  if (document.getElementById(&quot;identity.encryption_cert_name&quot;).value.length) {</span>
<a href="#l6.500"></a><span id="l6.500" class="difflineminus">-    document</span>
<a href="#l6.501"></a><span id="l6.501" class="difflineminus">-      .getElementById(&quot;encryptionCertClearButton&quot;)</span>
<a href="#l6.502"></a><span id="l6.502" class="difflineminus">-      .removeAttribute(&quot;disabled&quot;);</span>
<a href="#l6.503"></a><span id="l6.503" class="difflineminus">-  } else {</span>
<a href="#l6.504"></a><span id="l6.504" class="difflineminus">-    document</span>
<a href="#l6.505"></a><span id="l6.505" class="difflineminus">-      .getElementById(&quot;encryptionCertClearButton&quot;)</span>
<a href="#l6.506"></a><span id="l6.506" class="difflineminus">-      .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.507"></a><span id="l6.507" class="difflineplus">+  if (!stillHaveOtherEncryption) {</span>
<a href="#l6.508"></a><span id="l6.508" class="difflineplus">+    enableEncryptionControls(false);</span>
<a href="#l6.509"></a><span id="l6.509">   }</span>
<a href="#l6.510"></a><span id="l6.510" class="difflineplus">+  if (!stillHaveOtherSigning) {</span>
<a href="#l6.511"></a><span id="l6.511" class="difflineplus">+    enableSigningControls(false);</span>
<a href="#l6.512"></a><span id="l6.512" class="difflineplus">+  }</span>
<a href="#l6.513"></a><span id="l6.513" class="difflineplus">+  updateTechPref();</span>
<a href="#l6.514"></a><span id="l6.514" class="difflineplus">+  enableSelectButtons();</span>
<a href="#l6.515"></a><span id="l6.515">   onSave();</span>
<a href="#l6.516"></a><span id="l6.516"> }</span>
<a href="#l6.517"></a><span id="l6.517"> </span>
<a href="#l6.518"></a><span id="l6.518"> function smimeClearCert(smime_cert) {</span>
<a href="#l6.519"></a><span id="l6.519">   var certInfo = document.getElementById(smime_cert);</span>
<a href="#l6.520"></a><span id="l6.520">   if (!certInfo) {</span>
<a href="#l6.521"></a><span id="l6.521">     return;</span>
<a href="#l6.522"></a><span id="l6.522">   }</span>
<a href="#l6.523"></a><span id="l6.523"> </span>
<a href="#l6.524"></a><span id="l6.524" class="difflineminus">-  certInfo.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l6.525"></a><span id="l6.525" class="difflineplus">+  certInfo.disabled = true;</span>
<a href="#l6.526"></a><span id="l6.526">   certInfo.value = &quot;&quot;;</span>
<a href="#l6.527"></a><span id="l6.527">   certInfo.displayName = &quot;&quot;;</span>
<a href="#l6.528"></a><span id="l6.528">   certInfo.dbKey = &quot;&quot;;</span>
<a href="#l6.529"></a><span id="l6.529"> </span>
<a href="#l6.530"></a><span id="l6.530" class="difflineminus">-  if (smime_cert == kEncryptionCertPref) {</span>
<a href="#l6.531"></a><span id="l6.531" class="difflineminus">-    enableEncryptionControls(false);</span>
<a href="#l6.532"></a><span id="l6.532" class="difflineminus">-  } else if (smime_cert == kSigningCertPref) {</span>
<a href="#l6.533"></a><span id="l6.533" class="difflineminus">-    enableSigningControls(false);</span>
<a href="#l6.534"></a><span id="l6.534" class="difflineplus">+  let stillHaveOther = gKeyId &amp;&amp; gKeyId.value;</span>
<a href="#l6.535"></a><span id="l6.535" class="difflineplus">+</span>
<a href="#l6.536"></a><span id="l6.536" class="difflineplus">+  if (!stillHaveOther) {</span>
<a href="#l6.537"></a><span id="l6.537" class="difflineplus">+    if (smime_cert == kEncryptionCertPref) {</span>
<a href="#l6.538"></a><span id="l6.538" class="difflineplus">+      enableEncryptionControls(false);</span>
<a href="#l6.539"></a><span id="l6.539" class="difflineplus">+    } else if (smime_cert == kSigningCertPref) {</span>
<a href="#l6.540"></a><span id="l6.540" class="difflineplus">+      enableSigningControls(false);</span>
<a href="#l6.541"></a><span id="l6.541" class="difflineplus">+    }</span>
<a href="#l6.542"></a><span id="l6.542">   }</span>
<a href="#l6.543"></a><span id="l6.543"> </span>
<a href="#l6.544"></a><span id="l6.544" class="difflineminus">-  enableCertSelectButtons();</span>
<a href="#l6.545"></a><span id="l6.545" class="difflineplus">+  updateTechPref();</span>
<a href="#l6.546"></a><span id="l6.546" class="difflineplus">+  enableSelectButtons();</span>
<a href="#l6.547"></a><span id="l6.547" class="difflineplus">+  onSave();</span>
<a href="#l6.548"></a><span id="l6.548" class="difflineplus">+}</span>
<a href="#l6.549"></a><span id="l6.549" class="difflineplus">+</span>
<a href="#l6.550"></a><span id="l6.550" class="difflineplus">+function updateTechPref() {</span>
<a href="#l6.551"></a><span id="l6.551" class="difflineplus">+  if (!MailConstants.MOZ_OPENPGP) {</span>
<a href="#l6.552"></a><span id="l6.552" class="difflineplus">+    return;</span>
<a href="#l6.553"></a><span id="l6.553" class="difflineplus">+  }</span>
<a href="#l6.554"></a><span id="l6.554" class="difflineplus">+</span>
<a href="#l6.555"></a><span id="l6.555" class="difflineplus">+  let haveSigCert = gSignCertName &amp;&amp; gSignCertName.value;</span>
<a href="#l6.556"></a><span id="l6.556" class="difflineplus">+  let haveEncCert = gEncryptionCertName &amp;&amp; gEncryptionCertName.value;</span>
<a href="#l6.557"></a><span id="l6.557" class="difflineplus">+  let havePgpkey = gKeyId &amp;&amp; gKeyId.value;</span>
<a href="#l6.558"></a><span id="l6.558" class="difflineplus">+</span>
<a href="#l6.559"></a><span id="l6.559" class="difflineplus">+  let enable = (haveSigCert || haveEncCert) &amp;&amp; havePgpkey;</span>
<a href="#l6.560"></a><span id="l6.560" class="difflineplus">+</span>
<a href="#l6.561"></a><span id="l6.561" class="difflineplus">+  gTechAuto.disabled = !enable;</span>
<a href="#l6.562"></a><span id="l6.562" class="difflineplus">+  gTechPrefOpenPGP.disabled = !enable;</span>
<a href="#l6.563"></a><span id="l6.563" class="difflineplus">+  gTechPrefSMIME.disabled = !enable;</span>
<a href="#l6.564"></a><span id="l6.564" class="difflineplus">+</span>
<a href="#l6.565"></a><span id="l6.565" class="difflineplus">+  if (!enable) {</span>
<a href="#l6.566"></a><span id="l6.566" class="difflineplus">+    gIdentity.setIntAttribute(&quot;e2etechpref&quot;, 0);</span>
<a href="#l6.567"></a><span id="l6.567" class="difflineplus">+    gHiddenTechPref.setAttribute(&quot;value&quot;, 0);</span>
<a href="#l6.568"></a><span id="l6.568" class="difflineplus">+    gTechChoices.value = 0;</span>
<a href="#l6.569"></a><span id="l6.569" class="difflineplus">+  }</span>
<a href="#l6.570"></a><span id="l6.570"> }</span>
<a href="#l6.571"></a><span id="l6.571"> </span>
<a href="#l6.572"></a><span id="l6.572"> function openCertManager() {</span>
<a href="#l6.573"></a><span id="l6.573">   parent.gSubDialog.open(&quot;chrome://pippki/content/certManager.xhtml&quot;);</span>
<a href="#l6.574"></a><span id="l6.574"> }</span>
<a href="#l6.575"></a><span id="l6.575"> </span>
<a href="#l6.576"></a><span id="l6.576"> function openDeviceManager() {</span>
<a href="#l6.577"></a><span id="l6.577">   parent.gSubDialog.open(&quot;chrome://pippki/content/device_manager.xhtml&quot;);</span>
<a href="#l6.578"></a><span id="l6.578"> }</span>
<a href="#l6.579"></a><span id="l6.579"> </span>
<a href="#l6.580"></a><span id="l6.580" class="difflineminus">-function smimeOnLoadEditor() {</span>
<a href="#l6.581"></a><span id="l6.581" class="difflineminus">-  smimeInitializeFields();</span>
<a href="#l6.582"></a><span id="l6.582" class="difflineplus">+function e2eOnLoadEditor() {</span>
<a href="#l6.583"></a><span id="l6.583" class="difflineplus">+  e2eInitializeFields();</span>
<a href="#l6.584"></a><span id="l6.584"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">rename from mailnews/extensions/smime/content/am-smime.xhtml</span>
<a href="#l7.2"></a><span id="l7.2">rename to mail/extensions/am-e2e/am-e2e.xhtml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineminus">--- a/mailnews/extensions/smime/content/am-smime.xhtml</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineplus">+++ b/mail/extensions/am-e2e/am-e2e.xhtml</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineat">@@ -4,24 +4,24 @@</span>
<a href="#l7.6"></a><span id="l7.6">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/accountManage.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10"> &lt;!DOCTYPE window SYSTEM &quot;chrome://messenger/locale/am-smime.dtd&quot;&gt;</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12"> &lt;window xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l7.13"></a><span id="l7.13">         class=&quot;color-dialog&quot;</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-        onload=&quot;parent.onPanelLoaded('am-smime.xhtml');&quot;&gt;</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+        onload=&quot;parent.onPanelLoaded('am-e2e.xhtml');&quot;&gt;</span>
<a href="#l7.16"></a><span id="l7.16"> </span>
<a href="#l7.17"></a><span id="l7.17">   &lt;script src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l7.18"></a><span id="l7.18">   &lt;script src=&quot;chrome://global/content/editMenuOverlay.js&quot;/&gt;</span>
<a href="#l7.19"></a><span id="l7.19">   &lt;script src=&quot;chrome://messenger/content/AccountManager.js&quot;/&gt;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">-  &lt;script src=&quot;chrome://messenger/content/am-smime.js&quot;/&gt;</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+  &lt;script src=&quot;chrome://messenger/content/am-e2e.js&quot;/&gt;</span>
<a href="#l7.22"></a><span id="l7.22"> </span>
<a href="#l7.23"></a><span id="l7.23">   &lt;vbox flex=&quot;1&quot; style=&quot;overflow: auto;&quot;&gt;</span>
<a href="#l7.24"></a><span id="l7.24">     &lt;hbox class=&quot;dialogheader&quot;&gt;</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-      &lt;label class=&quot;dialogheader-title&quot; value=&quot;&amp;securityTitle.label;&quot;/&gt;</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+      &lt;label class=&quot;dialogheader-title&quot; value=&quot;&amp;e2eTitle.label;&quot;/&gt;</span>
<a href="#l7.27"></a><span id="l7.27">     &lt;/hbox&gt;</span>
<a href="#l7.28"></a><span id="l7.28"> </span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-#include am-smime.inc.xhtml</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+#include am-e2e.inc.xhtml</span>
<a href="#l7.31"></a><span id="l7.31">   &lt;/vbox&gt;</span>
<a href="#l7.32"></a><span id="l7.32"> </span>
<a href="#l7.33"></a><span id="l7.33"> &lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">rename from mailnews/extensions/smime/src/components.conf</span>
<a href="#l8.2"></a><span id="l8.2">rename to mail/extensions/am-e2e/components.conf</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineminus">--- a/mailnews/extensions/smime/src/components.conf</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineplus">+++ b/mail/extensions/am-e2e/components.conf</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l8.6"></a><span id="l8.6"> # -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-</span>
<a href="#l8.7"></a><span id="l8.7"> # vim: set filetype=python:</span>
<a href="#l8.8"></a><span id="l8.8"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.9"></a><span id="l8.9"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.10"></a><span id="l8.10"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12"> Classes = [</span>
<a href="#l8.13"></a><span id="l8.13">   {</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-    'cid': '{f2809796-1dd1-11b2-8c1b-8f15f007c699}',</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-    'contract_ids': ['@mozilla.org/accountmanager/extension;1?name=smime'],</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-    'jsm': 'resource:///modules/SMIMEService.jsm',</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-    'constructor': 'SMIMEService',</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-    'categories': {'mailnews-accountmanager-extensions': 'smime-account-manager-extension'},</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+    'cid': '{d7aad508-991c-401a-8b3f-7e4e055e1e2b}',</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+    'contract_ids': ['@mozilla.org/accountmanager/extension;1?name=e2e'],</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+    'jsm': 'resource:///modules/AME2E.jsm',</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+    'constructor': 'E2EService',</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+    'categories': {'mailnews-accountmanager-extensions': 'e2e-account-manager-extension'},</span>
<a href="#l8.24"></a><span id="l8.24">   },</span>
<a href="#l8.25"></a><span id="l8.25"> ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">new file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- /dev/null</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ b/mail/extensions/am-e2e/moz.build</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -0,0 +1,16 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineplus">+# vim: set filetype=python:</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.7"></a><span id="l9.7" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.8"></a><span id="l9.8" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineplus">+</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+EXTRA_JS_MODULES += [</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineplus">+    'AME2E.jsm',</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+]</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+XPCOM_MANIFESTS += [</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+    'components.conf',</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+]</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+JS_PREFERENCE_FILES += [</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+    'prefs/e2e-prefs.js',</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">rename from mail/extensions/openpgp/prefs/openpgp-prefs.js</span>
<a href="#l10.2"></a><span id="l10.2">rename to mail/extensions/am-e2e/prefs/e2e-prefs.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineminus">--- a/mail/extensions/openpgp/prefs/openpgp-prefs.js</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineplus">+++ b/mail/extensions/am-e2e/prefs/e2e-prefs.js</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineat">@@ -1,19 +1,35 @@</span>
<a href="#l10.6"></a><span id="l10.6"> /* global pref: false */</span>
<a href="#l10.7"></a><span id="l10.7"> /*</span>
<a href="#l10.8"></a><span id="l10.8">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.9"></a><span id="l10.9">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.10"></a><span id="l10.10">  * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l10.11"></a><span id="l10.11">  */</span>
<a href="#l10.12"></a><span id="l10.12"> </span>
<a href="#l10.13"></a><span id="l10.13"> /**</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">- * Default pref values for Enigmail</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+ * Prefs shared by OpenPGP and S/MIME</span>
<a href="#l10.16"></a><span id="l10.16">  */</span>
<a href="#l10.17"></a><span id="l10.17"> </span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+pref(&quot;mail.identity.default.encryptionpolicy&quot;, 0);</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+pref(&quot;mail.identity.default.sign_mail&quot;, false);</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+/**</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+ * S/MIME prefs</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+*/</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+pref(&quot;mail.identity.default.encryption_cert_name&quot;, &quot;&quot;);</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+pref(&quot;mail.identity.default.signing_cert_name&quot;, &quot;&quot;);</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+/**</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+ * OpenPGP prefs</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+ */</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+pref(&quot;mail.identity.default.openpgp_key_id&quot;, &quot;&quot;);</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineplus">+</span>
<a href="#l10.34"></a><span id="l10.34"> </span>
<a href="#l10.35"></a><span id="l10.35"> // the last configured Enigmail version</span>
<a href="#l10.36"></a><span id="l10.36"> pref(&quot;temp.openpgp.configuredVersion&quot;, &quot;&quot;);</span>
<a href="#l10.37"></a><span id="l10.37"> </span>
<a href="#l10.38"></a><span id="l10.38"> // Hide prefs and menu entries from non-advanced users</span>
<a href="#l10.39"></a><span id="l10.39"> pref(&quot;temp.openpgp.advancedUser&quot;, false);</span>
<a href="#l10.40"></a><span id="l10.40"> </span>
<a href="#l10.41"></a><span id="l10.41"> // ** enigmail keySel preferences:</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineat">@@ -244,23 +260,16 @@ pref(&quot;mail.identity.default.defaultSigni</span>
<a href="#l10.43"></a><span id="l10.43"> pref(&quot;mail.identity.default.defaultEncryptionPolicy&quot;, 0);</span>
<a href="#l10.44"></a><span id="l10.44"> pref(&quot;mail.identity.default.openPgpUrlName&quot;, &quot;&quot;);</span>
<a href="#l10.45"></a><span id="l10.45"> pref(&quot;mail.identity.default.pgpMimeMode&quot;, true);</span>
<a href="#l10.46"></a><span id="l10.46"> pref(&quot;mail.identity.default.attachPgpKey&quot;, false);</span>
<a href="#l10.47"></a><span id="l10.47"> pref(&quot;mail.identity.default.autoEncryptDrafts&quot;, true);</span>
<a href="#l10.48"></a><span id="l10.48"> pref(&quot;mail.identity.default.protectSubject&quot;, true);</span>
<a href="#l10.49"></a><span id="l10.49"> pref(&quot;mail.identity.default.warnWeakReply&quot;, false);</span>
<a href="#l10.50"></a><span id="l10.50"> </span>
<a href="#l10.51"></a><span id="l10.51" class="difflineminus">-/*</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineminus">-   Default pref values for the enigmail per-account</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineminus">-   settings</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineminus">-*/</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineminus">-pref(&quot;mail.server.default.enableAutocrypt&quot;, false); // see https://autocrypt.org</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineminus">-pref(&quot;mail.server.default.acPreferEncrypt&quot;, 0);</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineminus">-</span>
<a href="#l10.58"></a><span id="l10.58"> // prefer S/MIME or PGP/MIME (0: S/MIME, 1: PGP/MIME)</span>
<a href="#l10.59"></a><span id="l10.59"> pref(&quot;mail.identity.default.mimePreferOpenPGP&quot;, 1);</span>
<a href="#l10.60"></a><span id="l10.60"> </span>
<a href="#l10.61"></a><span id="l10.61"> /*</span>
<a href="#l10.62"></a><span id="l10.62">    Other settings (change Mozilla behaviour)</span>
<a href="#l10.63"></a><span id="l10.63"> */</span>
<a href="#l10.64"></a><span id="l10.64"> </span>
<a href="#l10.65"></a><span id="l10.65"> // disable flowed text by default</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/mail/extensions/jar.mn</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,7 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+messenger.jar:</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+*  content/messenger/am-e2e.xhtml                                 (am-e2e/am-e2e.xhtml)</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+   content/messenger/am-e2e.js                                    (am-e2e/am-e2e.js)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/extensions/moz.build</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/extensions/moz.build</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,14 +1,20 @@</span>
<a href="#l12.4"></a><span id="l12.4"> # vim: set filetype=python:</span>
<a href="#l12.5"></a><span id="l12.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.6"></a><span id="l12.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.7"></a><span id="l12.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+</span>
<a href="#l12.11"></a><span id="l12.11"> DIRS += [</span>
<a href="#l12.12"></a><span id="l12.12">     'mailviews',</span>
<a href="#l12.13"></a><span id="l12.13">     'smime',</span>
<a href="#l12.14"></a><span id="l12.14"> ]</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+DIRS += [</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+    'am-e2e',</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+]</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+</span>
<a href="#l12.20"></a><span id="l12.20"> if CONFIG['MOZ_OPENPGP']:</span>
<a href="#l12.21"></a><span id="l12.21">   DIRS += [</span>
<a href="#l12.22"></a><span id="l12.22">       'openpgp',</span>
<a href="#l12.23"></a><span id="l12.23">   ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/extensions/openpgp/content/BondOpenPGP.jsm</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/BondOpenPGP.jsm</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -19,20 +19,16 @@ const { EnigmailLazy } = ChromeUtils.imp</span>
<a href="#l13.4"></a><span id="l13.4">   &quot;chrome://openpgp/content/modules/lazy.jsm&quot;</span>
<a href="#l13.5"></a><span id="l13.5"> );</span>
<a href="#l13.6"></a><span id="l13.6"> </span>
<a href="#l13.7"></a><span id="l13.7"> const getEnigmailApp = EnigmailLazy.loader(&quot;enigmail/app.jsm&quot;, &quot;EnigmailApp&quot;);</span>
<a href="#l13.8"></a><span id="l13.8"> const getEnigmailCore = EnigmailLazy.loader(</span>
<a href="#l13.9"></a><span id="l13.9">   &quot;enigmail/core.jsm&quot;,</span>
<a href="#l13.10"></a><span id="l13.10">   &quot;EnigmailCore&quot;</span>
<a href="#l13.11"></a><span id="l13.11"> );</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-const getEnigmailAmPrefsService = EnigmailLazy.loader(</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-  &quot;enigmail/amPrefsService.jsm&quot;,</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-  &quot;EnigmailAmPrefsService&quot;</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-);</span>
<a href="#l13.16"></a><span id="l13.16"> const getEnigmailPgpmimeHander = EnigmailLazy.loader(</span>
<a href="#l13.17"></a><span id="l13.17">   &quot;enigmail/pgpmimeHandler.jsm&quot;,</span>
<a href="#l13.18"></a><span id="l13.18">   &quot;EnigmailPgpmimeHander&quot;</span>
<a href="#l13.19"></a><span id="l13.19"> );</span>
<a href="#l13.20"></a><span id="l13.20"> const getRNP = EnigmailLazy.loader(&quot;enigmail/rnp.jsm&quot;, &quot;RNP&quot;);</span>
<a href="#l13.21"></a><span id="l13.21"> const getEnigmailWindows = EnigmailLazy.loader(</span>
<a href="#l13.22"></a><span id="l13.22">   &quot;enigmail/windows.jsm&quot;,</span>
<a href="#l13.23"></a><span id="l13.23">   &quot;EnigmailWindows&quot;</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineat">@@ -56,17 +52,16 @@ var BondOpenPGP = {</span>
<a href="#l13.25"></a><span id="l13.25">     }</span>
<a href="#l13.26"></a><span id="l13.26">     this.initDone = true;</span>
<a href="#l13.27"></a><span id="l13.27">     console.log(&quot;loading OpenPGP&quot;);</span>
<a href="#l13.28"></a><span id="l13.28">     try {</span>
<a href="#l13.29"></a><span id="l13.29">       getRNP().init({});</span>
<a href="#l13.30"></a><span id="l13.30">       //TODO: check RNP.libLoaded</span>
<a href="#l13.31"></a><span id="l13.31"> </span>
<a href="#l13.32"></a><span id="l13.32">       getEnigmailApp().initAddon();</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineminus">-      getEnigmailAmPrefsService().startup(0);</span>
<a href="#l13.34"></a><span id="l13.34">       getEnigmailCore().startup(0);</span>
<a href="#l13.35"></a><span id="l13.35">       getEnigmailPgpmimeHander().startup(0);</span>
<a href="#l13.36"></a><span id="l13.36"> </span>
<a href="#l13.37"></a><span id="l13.37">       Services.console.logStringMessage(&quot;OpenPGP bootstrap completed&quot;);</span>
<a href="#l13.38"></a><span id="l13.38">     } catch (ex) {</span>
<a href="#l13.39"></a><span id="l13.39">       this.logException(ex);</span>
<a href="#l13.40"></a><span id="l13.40">     }</span>
<a href="#l13.41"></a><span id="l13.41">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">deleted file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- a/mail/extensions/openpgp/content/am-enigprefs.xhtml</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ /dev/null</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -1,166 +0,0 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineminus">-</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineminus">-&lt;!--</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineminus">- * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineminus">- * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineminus">---&gt;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/accountManage.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-&lt;!DOCTYPE page SYSTEM &quot;chrome://openpgp/content/strings/enigmail.dtd&quot;&gt;</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-&lt;page xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineminus">-      xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineminus">-      class=&quot;color-dialog&quot;</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineminus">-      title=&quot;&amp;enigmail.amPrefTitle.label;&quot;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineminus">-      onload=&quot;parent.onPanelLoaded('am-enigprefs.xhtml');&quot;</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineminus">-      orient=&quot;vertical&quot;&gt;</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineminus">-  &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://messenger/content/AccountManager.js&quot;/&gt;</span>
<a href="#l14.25"></a><span id="l14.25" class="difflineminus">-  &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://openpgp/content/ui/enigmailEditIdentity.js&quot;/&gt;</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-  &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://openpgp/content/ui/am-enigprefs.js&quot;/&gt;</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineminus">-</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineminus">-  &lt;broadcasterset&gt;</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineminus">-    &lt;broadcaster id=&quot;enigmail_bcEnablePgp&quot; disabled=&quot;false&quot;/&gt;</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineminus">-    &lt;broadcaster id=&quot;enigmail_bcUseKeyId&quot; disabled=&quot;false&quot;/&gt;</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-    &lt;broadcaster id=&quot;enigmail_bcUseUrl&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineminus">-  &lt;/broadcasterset&gt;</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineminus">-  &lt;vbox flex=&quot;1&quot; style=&quot;overflow: auto;&quot;&gt;</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineminus">-</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineminus">-    &lt;dialogheader title=&quot;&amp;enigmail.amPrefTitle.label;&quot;/&gt;</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineminus">-</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineminus">-    &lt;description&gt;&amp;enigmail.amPrefDesc.label;&lt;/description&gt;</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineminus">-</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineminus">-    &lt;vbox id=&quot;enigmail_IdentityEdit&quot;&gt;</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineminus">-      &lt;checkbox id=&quot;enigmail_enablePgp&quot;</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineminus">-                prefstring=&quot;mail.identity.%identitykey%.enablePgp&quot;</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineminus">-                preftype=&quot;bool&quot; prefattribute=&quot;value&quot;</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineminus">-                label=&quot;&amp;enigmail.amPrefEnablePgp.label;&quot;</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineminus">-                oncommand=&quot;Enigmail.edit.toggleEnable();&quot;/&gt;</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineminus">-      &lt;vbox&gt;</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineminus">-        &lt;vbox class=&quot;enigmailGroupbox&quot; id=&quot;enigmail_encryption.titleBox&quot;&gt;</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineminus">-          &lt;radiogroup id=&quot;enigmail_pgpKeyMode&quot; aria-labelledby=&quot;enablePgp&quot;&gt;</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineminus">-            &lt;radio id=&quot;enigmail_keymode_useFromAddress&quot;</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-                   label=&quot;&amp;enigmail.amPrefUseFromAddr.label;&quot;</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineminus">-                   value=&quot;0&quot;</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineminus">-                   observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineminus">-                   oncommand=&quot;Enigmail.edit.enableKeySel(false);&quot;/&gt;</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineminus">-            &lt;vbox&gt;</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineminus">-              &lt;radio id=&quot;enigmail_keymode_usePgpkeyId&quot;</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineminus">-                     label=&quot;&amp;enigmail.amPrefUseKeyId.label;&quot;</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineminus">-                     observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineminus">-                     value=&quot;1&quot;</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineminus">-                     oncommand=&quot;Enigmail.edit.enableKeySel(true);&quot;/&gt;</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineminus">-              &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineminus">-                &lt;textbox id=&quot;enigmail_identity.pgpkeyId&quot; aria-labelledby=&quot;keymode_usePgpkeyId&quot;</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineminus">-                         prefstring=&quot;mail.identity.%identitykey%.pgpkeyId&quot;</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineminus">-                         observes=&quot;enigmail_bcUseKeyId&quot;</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineminus">-                         readonly=&quot;true&quot;</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineminus">-                         flex=&quot;1&quot;</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineminus">-                         preftype=&quot;wstring&quot; prefattribute=&quot;value&quot;/&gt;</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineminus">-                &lt;button id=&quot;enigmail_selectPgpKey&quot; label=&quot;&amp;enigmail.amPrefSelectKey.label;&quot;</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineminus">-                        observes=&quot;enigmail_bcUseKeyId&quot;</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineminus">-                        oncommand=&quot;Enigmail.edit.selectKeyId()&quot;/&gt;</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineminus">-              &lt;/hbox&gt;</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineminus">-            &lt;/vbox&gt;</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineminus">-          &lt;/radiogroup&gt;</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineminus">-</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineminus">-          &lt;tabbox flex=&quot;1&quot; id=&quot;enigmail_tabs&quot;&gt;</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineminus">-            &lt;tabs id=&quot;enigmail_tabBox&quot;&gt;</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineminus">-              &lt;tab id=&quot;enigmail_msgCompTab&quot;   label=&quot;&amp;enigmail.amPrefMsgComp.label;&quot;/&gt;</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineminus">-              &lt;tab id=&quot;enigmail_autocryptTab&quot; label=&quot;&amp;enigmail.autocrypt.label;&quot;/&gt;</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineminus">-            &lt;/tabs&gt;</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineminus">-</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineminus">-            &lt;tabpanels flex=&quot;1&quot; id=&quot;enigmail_tabPanels&quot;&gt;</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineminus">-              &lt;!-- Message Composition --&gt;</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineminus">-              &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineminus">-                &lt;caption label=&quot;&amp;enigmail.amPrefDefaultEncrypt.label;&quot;/&gt;</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineminus">-</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineminus">-                &lt;checkbox id=&quot;enigmail_encrypt_ifPossible&quot;</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineminus">-                          checked=&quot;false&quot;</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineminus">-                          observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineminus">-                          label=&quot;&amp;enigmail.defaultEncryption.label;&quot;/&gt;</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineminus">-                &lt;checkbox id=&quot;enigmail_sign_ifPossible&quot;</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineminus">-                          checked=&quot;false&quot;</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineminus">-                          observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineminus">-                          label=&quot;&amp;enigmail.defaultSigning.label;&quot;/&gt;</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineminus">-                &lt;checkbox id=&quot;enigmail_pgpMimeMode&quot;</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineminus">-                          checked=&quot;false&quot;</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineminus">-                          observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.96"></a><span id="l14.96" class="difflineminus">-                          label=&quot;&amp;enigmail.usePGPMimeAlways.label;&quot;/&gt;</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineminus">-</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineminus">-                &lt;separator/&gt;</span>
<a href="#l14.99"></a><span id="l14.99" class="difflineminus">-</span>
<a href="#l14.100"></a><span id="l14.100" class="difflineminus">-                &lt;label value=&quot;&amp;enigmail.afterDefaultsAndRules.label;&quot;/&gt;</span>
<a href="#l14.101"></a><span id="l14.101" class="difflineminus">-                &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineminus">-                  &lt;checkbox id=&quot;enigmail_sign_notEncrypted&quot;</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineminus">-                            checked=&quot;false&quot;</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineminus">-                            observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineminus">-                            label=&quot;&amp;enigmail.finallySignNotEncrypted.label;&quot;/&gt;</span>
<a href="#l14.106"></a><span id="l14.106" class="difflineminus">-                  &lt;checkbox id=&quot;enigmail_sign_encrypted&quot;</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineminus">-                            checked=&quot;false&quot;</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineminus">-                            observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineminus">-                            label=&quot;&amp;enigmail.finallySignEncrypted.label;&quot;/&gt;</span>
<a href="#l14.110"></a><span id="l14.110" class="difflineminus">-                &lt;/hbox&gt;</span>
<a href="#l14.111"></a><span id="l14.111" class="difflineminus">-</span>
<a href="#l14.112"></a><span id="l14.112" class="difflineminus">-                &lt;separator/&gt;</span>
<a href="#l14.113"></a><span id="l14.113" class="difflineminus">-</span>
<a href="#l14.114"></a><span id="l14.114" class="difflineminus">-                &lt;checkbox id=&quot;enigmail_autoEncryptDrafts&quot; checked=&quot;false&quot;</span>
<a href="#l14.115"></a><span id="l14.115" class="difflineminus">-                          label=&quot;&amp;enigmail.autoEncryptDrafts.label;&quot;/&gt;</span>
<a href="#l14.116"></a><span id="l14.116" class="difflineminus">-</span>
<a href="#l14.117"></a><span id="l14.117" class="difflineminus">-                &lt;separator/&gt;</span>
<a href="#l14.118"></a><span id="l14.118" class="difflineminus">-</span>
<a href="#l14.119"></a><span id="l14.119" class="difflineminus">-                &lt;label id=&quot;mimePreferOpenPGP&quot; value=&quot;&amp;enigmail.amPrefMimePreferProto.label;&quot;/&gt;</span>
<a href="#l14.120"></a><span id="l14.120" class="difflineminus">-                &lt;radiogroup id=&quot;enigmail_mimePreferOpenPGP&quot; aria-labelledby=&quot;mimePreferOpenPGP&quot;&gt;</span>
<a href="#l14.121"></a><span id="l14.121" class="difflineminus">-                  &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l14.122"></a><span id="l14.122" class="difflineminus">-                    &lt;radio id=&quot;enigmail_mime_preferSMime&quot;</span>
<a href="#l14.123"></a><span id="l14.123" class="difflineminus">-                           label=&quot;&amp;enigmail.amPrefMimePreferSMime.label;&quot;</span>
<a href="#l14.124"></a><span id="l14.124" class="difflineminus">-                           value=&quot;0&quot;</span>
<a href="#l14.125"></a><span id="l14.125" class="difflineminus">-                           observes=&quot;enigmail_bcEnablePgp&quot;/&gt;</span>
<a href="#l14.126"></a><span id="l14.126" class="difflineminus">-                    &lt;radio id=&quot;enigmail_mime_preferEnigmail&quot;</span>
<a href="#l14.127"></a><span id="l14.127" class="difflineminus">-                           label=&quot;&amp;enigmail.amPrefMimePreferEnigmail.label;&quot;</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineminus">-                           value=&quot;1&quot;</span>
<a href="#l14.129"></a><span id="l14.129" class="difflineminus">-                           observes=&quot;enigmail_bcEnablePgp&quot;/&gt;</span>
<a href="#l14.130"></a><span id="l14.130" class="difflineminus">-                  &lt;/hbox&gt;</span>
<a href="#l14.131"></a><span id="l14.131" class="difflineminus">-                &lt;/radiogroup&gt;</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineminus">-</span>
<a href="#l14.133"></a><span id="l14.133" class="difflineminus">-                &lt;separator/&gt;</span>
<a href="#l14.134"></a><span id="l14.134" class="difflineminus">-</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineminus">-                &lt;checkbox id=&quot;openpgp.sendKeyWithMsg&quot;</span>
<a href="#l14.136"></a><span id="l14.136" class="difflineminus">-                            label=&quot;&amp;enigmail.amPrefPgp.sendKeyWithMsg.label;&quot;</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineminus">-                            checked=&quot;false&quot;/&gt;</span>
<a href="#l14.138"></a><span id="l14.138" class="difflineminus">-              &lt;/vbox&gt;</span>
<a href="#l14.139"></a><span id="l14.139" class="difflineminus">-</span>
<a href="#l14.140"></a><span id="l14.140" class="difflineminus">-              &lt;!-- Autocrypt tab --&gt;</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineminus">-              &lt;vbox flex=&quot;1&quot; align=&quot;start&quot;&gt;</span>
<a href="#l14.142"></a><span id="l14.142" class="difflineminus">-                &lt;checkbox id=&quot;enigmail_enableAutocrypt&quot;</span>
<a href="#l14.143"></a><span id="l14.143" class="difflineminus">-                    prefstring=&quot;mail.server.%serverkey%.enableAutocrypt&quot;</span>
<a href="#l14.144"></a><span id="l14.144" class="difflineminus">-                    preftype=&quot;bool&quot; prefattribute=&quot;value&quot;</span>
<a href="#l14.145"></a><span id="l14.145" class="difflineminus">-                    observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.146"></a><span id="l14.146" class="difflineminus">-                    oncommand=&quot;Enigmail.edit.enableAcSettings()&quot;</span>
<a href="#l14.147"></a><span id="l14.147" class="difflineminus">-                    label=&quot;&amp;enigmail.enableAutocrypt.label;&quot;/&gt;</span>
<a href="#l14.148"></a><span id="l14.148" class="difflineminus">-</span>
<a href="#l14.149"></a><span id="l14.149" class="difflineminus">-                &lt;checkbox id=&quot;enigmail_acPreferEncrypt&quot;</span>
<a href="#l14.150"></a><span id="l14.150" class="difflineminus">-                    prefstring=&quot;mail.server.%serverkey%.acPreferEncrypt&quot;</span>
<a href="#l14.151"></a><span id="l14.151" class="difflineminus">-                    preftype=&quot;bool&quot; prefattribute=&quot;value&quot;</span>
<a href="#l14.152"></a><span id="l14.152" class="difflineminus">-                    label=&quot;&amp;enigmail.acPreferEncrypt.label;&quot;/&gt;</span>
<a href="#l14.153"></a><span id="l14.153" class="difflineminus">-              &lt;/vbox&gt;</span>
<a href="#l14.154"></a><span id="l14.154" class="difflineminus">-            &lt;/tabpanels&gt;</span>
<a href="#l14.155"></a><span id="l14.155" class="difflineminus">-          &lt;/tabbox&gt;</span>
<a href="#l14.156"></a><span id="l14.156" class="difflineminus">-</span>
<a href="#l14.157"></a><span id="l14.157" class="difflineminus">-          &lt;hbox autostretch=&quot;never&quot; id=&quot;enigmail_PrefsBox&quot;&gt;</span>
<a href="#l14.158"></a><span id="l14.158" class="difflineminus">-            &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l14.159"></a><span id="l14.159" class="difflineminus">-            &lt;button class=&quot;dialog&quot;</span>
<a href="#l14.160"></a><span id="l14.160" class="difflineminus">-                    id=&quot;enigmail_openpgpPrefsButton&quot;</span>
<a href="#l14.161"></a><span id="l14.161" class="difflineminus">-                    observes=&quot;enigmail_bcEnablePgp&quot;</span>
<a href="#l14.162"></a><span id="l14.162" class="difflineminus">-                    label=&quot;&amp;enigmail.openpgpPrefsButton.label;&quot;</span>
<a href="#l14.163"></a><span id="l14.163" class="difflineminus">-                    oncommand=&quot;EnigmailWindows.openPrefWindow(window, true, 'sendingTab');&quot;/&gt;</span>
<a href="#l14.164"></a><span id="l14.164" class="difflineminus">-          &lt;/hbox&gt;</span>
<a href="#l14.165"></a><span id="l14.165" class="difflineminus">-        &lt;/vbox&gt;</span>
<a href="#l14.166"></a><span id="l14.166" class="difflineminus">-      &lt;/vbox&gt;</span>
<a href="#l14.167"></a><span id="l14.167" class="difflineminus">-    &lt;/vbox&gt;</span>
<a href="#l14.168"></a><span id="l14.168" class="difflineminus">-</span>
<a href="#l14.169"></a><span id="l14.169" class="difflineminus">-  &lt;/vbox&gt;</span>
<a href="#l14.170"></a><span id="l14.170" class="difflineminus">-&lt;/page&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">deleted file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/amPrefsService.jsm</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ /dev/null</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -1,94 +0,0 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.7"></a><span id="l15.7" class="difflineminus">- * file, You can obtain one at https://mozilla.org/MPL/2.0/. */</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineminus">-</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineminus">-</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineminus">-const { manager: Cm } = Components;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-Cm.QueryInterface(Ci.nsIComponentRegistrar);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-const { EnigmailCompat } = ChromeUtils.import(</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-  &quot;chrome://openpgp/content/modules/compat.jsm&quot;</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-);</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-const { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">-const CATEGORY = &quot;mailnews-accountmanager-extensions&quot;;</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">-const CATEGORY_ENTRY = &quot;openpgp-account-manager-extension&quot;;</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineminus">-const PREF_SERVICE_NAME =</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-  &quot;@mozilla.org/accountmanager/extension;1?name=enigprefs&quot;;</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-var EXPORTED_SYMBOLS = [&quot;EnigmailAmPrefsService&quot;];</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineminus">-var EnigmailAmPrefsService = {</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineminus">-  startup(reason) {</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineminus">-    try {</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineminus">-      Services.catMan.addCategoryEntry(</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineminus">-        CATEGORY,</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-        CATEGORY_ENTRY,</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineminus">-        PREF_SERVICE_NAME,</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-        false,</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineminus">-        true</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineminus">-      );</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-      this.factory = new Factory(EnigmailPrefService);</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineminus">-    } catch (ex) {}</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineminus">-  },</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineminus">-</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineminus">-  shutdown(reason) {</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineminus">-    Services.catMan.deleteCategoryEntry(CATEGORY, CATEGORY_ENTRY, false);</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineminus">-</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineminus">-    if (this.factory) {</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineminus">-      this.factory.unregister();</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineminus">-    }</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineminus">-  },</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineminus">-};</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineminus">-</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineminus">-function EnigmailPrefService() {}</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineminus">-</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineminus">-EnigmailPrefService.prototype = {</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineminus">-  name: &quot;enigprefs&quot;,</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineminus">-  chromePackageName: &quot;openpgp&quot;,</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineminus">-  classID: Components.ID(&quot;{f2be6d32-ff3c-11e9-8e8b-00163e5e6c00}&quot;),</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineminus">-  classDescription: &quot;OpenPGP Account Manager Extension Service&quot;,</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineminus">-  contractID: PREF_SERVICE_NAME,</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineminus">-  QueryInterface: EnigmailCompat.generateQI([&quot;nsIMsgAccountManagerExtension&quot;]),</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineminus">-</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineminus">-  showPanel(server) {</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineminus">-    // show Enigmail panel for POP3, IMAP, NNTP and &quot;movemail&quot; (unix) account types</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineminus">-    switch (server.type) {</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineminus">-      case &quot;nntp&quot;:</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineminus">-      case &quot;imap&quot;:</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineminus">-      case &quot;pop3&quot;:</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineminus">-      case &quot;movemail&quot;:</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineminus">-        return true;</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineminus">-    }</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineminus">-    return false;</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineminus">-  },</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineminus">-};</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineminus">-</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineminus">-class Factory {</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineminus">-  constructor(component) {</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineminus">-    this.component = component;</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineminus">-    this.register();</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineminus">-    Object.freeze(this);</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineminus">-  }</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineminus">-</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineminus">-  createInstance(outer, iid) {</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineminus">-    if (outer) {</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineminus">-      throw Cr.NS_ERROR_NO_AGGREGATION;</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineminus">-    }</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineminus">-    return new this.component();</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineminus">-  }</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineminus">-</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineminus">-  register() {</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineminus">-    Cm.registerFactory(</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineminus">-      this.component.prototype.classID,</span>
<a href="#l15.89"></a><span id="l15.89" class="difflineminus">-      this.component.prototype.classDescription,</span>
<a href="#l15.90"></a><span id="l15.90" class="difflineminus">-      this.component.prototype.contractID,</span>
<a href="#l15.91"></a><span id="l15.91" class="difflineminus">-      this</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineminus">-    );</span>
<a href="#l15.93"></a><span id="l15.93" class="difflineminus">-  }</span>
<a href="#l15.94"></a><span id="l15.94" class="difflineminus">-</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineminus">-  unregister() {</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineminus">-    Cm.unregisterFactory(this.component.prototype.classID, this);</span>
<a href="#l15.97"></a><span id="l15.97" class="difflineminus">-  }</span>
<a href="#l15.98"></a><span id="l15.98" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/keyObj.jsm</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/keyObj.jsm</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -346,17 +346,17 @@ class EnigmailKeyObj {</span>
<a href="#l16.4"></a><span id="l16.4">             );</span>
<a href="#l16.5"></a><span id="l16.5">           }</span>
<a href="#l16.6"></a><span id="l16.6">         } else {</span>
<a href="#l16.7"></a><span id="l16.7">           retVal.keyValid = true;</span>
<a href="#l16.8"></a><span id="l16.8">         }</span>
<a href="#l16.9"></a><span id="l16.9">       }</span>
<a href="#l16.10"></a><span id="l16.10">     }</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-    console.debug(&quot;getSigningValidity retVal: %o&quot;, retVal);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+    //console.debug(&quot;getSigningValidity retVal: %o&quot;, retVal);</span>
<a href="#l16.14"></a><span id="l16.14">     return retVal;</span>
<a href="#l16.15"></a><span id="l16.15">   }</span>
<a href="#l16.16"></a><span id="l16.16"> </span>
<a href="#l16.17"></a><span id="l16.17">   /**</span>
<a href="#l16.18"></a><span id="l16.18">    * Check whether a key can be used for encryption and return a description of why not</span>
<a href="#l16.19"></a><span id="l16.19">    *</span>
<a href="#l16.20"></a><span id="l16.20">    * @return Object:</span>
<a href="#l16.21"></a><span id="l16.21">    *   - keyValid: Boolean (true if key is valid)</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineat">@@ -425,17 +425,17 @@ class EnigmailKeyObj {</span>
<a href="#l16.23"></a><span id="l16.23">             );</span>
<a href="#l16.24"></a><span id="l16.24">           }</span>
<a href="#l16.25"></a><span id="l16.25">         } else {</span>
<a href="#l16.26"></a><span id="l16.26">           retVal.keyValid = true;</span>
<a href="#l16.27"></a><span id="l16.27">         }</span>
<a href="#l16.28"></a><span id="l16.28">       }</span>
<a href="#l16.29"></a><span id="l16.29">     }</span>
<a href="#l16.30"></a><span id="l16.30"> </span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-    console.debug(&quot;getEncryptionValidity retVal: %o&quot;, retVal);</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+    //console.debug(&quot;getEncryptionValidity retVal: %o&quot;, retVal);</span>
<a href="#l16.33"></a><span id="l16.33">     return retVal;</span>
<a href="#l16.34"></a><span id="l16.34">   }</span>
<a href="#l16.35"></a><span id="l16.35"> </span>
<a href="#l16.36"></a><span id="l16.36">   /**</span>
<a href="#l16.37"></a><span id="l16.37">    * Determine the next expiry date of the key. This is either the public key expiry date,</span>
<a href="#l16.38"></a><span id="l16.38">    * or the maximum expiry date of a signing or encryption subkey. I.e. this returns the next</span>
<a href="#l16.39"></a><span id="l16.39">    * date at which the key cannot be used for signing and/or encryption anymore</span>
<a href="#l16.40"></a><span id="l16.40">    *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/keyRing.jsm</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/keyRing.jsm</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -194,103 +194,108 @@ var EnigmailKeyRing = {</span>
<a href="#l17.4"></a><span id="l17.4"> </span>
<a href="#l17.5"></a><span id="l17.5">     let res = [];</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7">     this.getAllKeys(); // ensure keylist is loaded;</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9">     if (searchTerm === &quot;&quot;) {</span>
<a href="#l17.10"></a><span id="l17.10">       return res;</span>
<a href="#l17.11"></a><span id="l17.11">     }</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    console.debug(gKeyListObj.keyList);</span>
<a href="#l17.13"></a><span id="l17.13">     for (let i in gKeyListObj.keyList) {</span>
<a href="#l17.14"></a><span id="l17.14">       let k = gKeyListObj.keyList[i];</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16">       for (let j in k.userIds) {</span>
<a href="#l17.17"></a><span id="l17.17">         if (k.userIds[j].type === &quot;uid&quot; &amp;&amp; k.userIds[j].userId.search(s) &gt;= 0) {</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-          console.debug(&quot;found &quot; + k.userIds[j].userId);</span>
<a href="#l17.19"></a><span id="l17.19">           if (</span>
<a href="#l17.20"></a><span id="l17.20">             !onlyValidUid ||</span>
<a href="#l17.21"></a><span id="l17.21">             !EnigmailTrust.isInvalid(k.userIds[j].keyTrust)</span>
<a href="#l17.22"></a><span id="l17.22">           ) {</span>
<a href="#l17.23"></a><span id="l17.23">             res.push(k);</span>
<a href="#l17.24"></a><span id="l17.24">             continue;</span>
<a href="#l17.25"></a><span id="l17.25">           }</span>
<a href="#l17.26"></a><span id="l17.26">         }</span>
<a href="#l17.27"></a><span id="l17.27">       }</span>
<a href="#l17.28"></a><span id="l17.28">     }</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineminus">-    console.debug(&quot;getKeysByUserId result: %o&quot;, res);</span>
<a href="#l17.30"></a><span id="l17.30">     return res;</span>
<a href="#l17.31"></a><span id="l17.31">   },</span>
<a href="#l17.32"></a><span id="l17.32"> </span>
<a href="#l17.33"></a><span id="l17.33">   /**</span>
<a href="#l17.34"></a><span id="l17.34">    * Specialized function for getSecretKeyByUserId() that takes into account</span>
<a href="#l17.35"></a><span id="l17.35">    * the specifics of email addresses in UIDs.</span>
<a href="#l17.36"></a><span id="l17.36">    *</span>
<a href="#l17.37"></a><span id="l17.37">    * @param emailAddr: String - email address to search for without any angulars</span>
<a href="#l17.38"></a><span id="l17.38">    *                            or names</span>
<a href="#l17.39"></a><span id="l17.39">    *</span>
<a href="#l17.40"></a><span id="l17.40">    * @return KeyObject with the found key, or null if no key found</span>
<a href="#l17.41"></a><span id="l17.41">    */</span>
<a href="#l17.42"></a><span id="l17.42">   getSecretKeyByEmail(emailAddr) {</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineplus">+    let result = {};</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineplus">+    this.getAllSecretKeysByEmail(emailAddr, result);</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineplus">+    return result.best;</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineplus">+  },</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineplus">+</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineplus">+  getAllSecretKeysByEmail(emailAddr, result) {</span>
<a href="#l17.49"></a><span id="l17.49">     // sanitize email address</span>
<a href="#l17.50"></a><span id="l17.50">     emailAddr = emailAddr.replace(/([\.\[\]\-\\])/g, &quot;\\$1&quot;);</span>
<a href="#l17.51"></a><span id="l17.51"> </span>
<a href="#l17.52"></a><span id="l17.52">     let searchTerm =</span>
<a href="#l17.53"></a><span id="l17.53">       &quot;(&lt;&quot; + emailAddr + &quot;&gt;| &quot; + emailAddr + &quot;$|^&quot; + emailAddr + &quot;$)&quot;;</span>
<a href="#l17.54"></a><span id="l17.54"> </span>
<a href="#l17.55"></a><span id="l17.55" class="difflineminus">-    return this.getSecretKeyByUserId(searchTerm);</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineplus">+    this.getAllSecretKeysByUserId(searchTerm, result);</span>
<a href="#l17.57"></a><span id="l17.57">   },</span>
<a href="#l17.58"></a><span id="l17.58"> </span>
<a href="#l17.59"></a><span id="l17.59">   /**</span>
<a href="#l17.60"></a><span id="l17.60">    * get the &quot;best&quot; possible secret key for a given user ID</span>
<a href="#l17.61"></a><span id="l17.61">    *</span>
<a href="#l17.62"></a><span id="l17.62">    * @param searchTerm   - String: a regular expression to match against all UIDs of the keys.</span>
<a href="#l17.63"></a><span id="l17.63">    *                               The search is always performed case-insensitively</span>
<a href="#l17.64"></a><span id="l17.64">    * @return KeyObject with the found key, or null if no key found</span>
<a href="#l17.65"></a><span id="l17.65">    */</span>
<a href="#l17.66"></a><span id="l17.66">   getSecretKeyByUserId(searchTerm) {</span>
<a href="#l17.67"></a><span id="l17.67" class="difflineplus">+    let result = {};</span>
<a href="#l17.68"></a><span id="l17.68" class="difflineplus">+    this.getAllSecretKeysByUserId(searchTerm, result);</span>
<a href="#l17.69"></a><span id="l17.69" class="difflineplus">+    return result.best;</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineplus">+  },</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineplus">+</span>
<a href="#l17.72"></a><span id="l17.72" class="difflineplus">+  getAllSecretKeysByUserId(searchTerm, result) {</span>
<a href="#l17.73"></a><span id="l17.73">     EnigmailLog.DEBUG(</span>
<a href="#l17.74"></a><span id="l17.74">       &quot;keyRing.jsm: getSecretKeyByUserId: '&quot; + searchTerm + &quot;'\n&quot;</span>
<a href="#l17.75"></a><span id="l17.75">     );</span>
<a href="#l17.76"></a><span id="l17.76">     let keyList = this.getKeysByUserId(searchTerm, true);</span>
<a href="#l17.77"></a><span id="l17.77" class="difflineminus">-    console.debug(</span>
<a href="#l17.78"></a><span id="l17.78" class="difflineminus">-      &quot;getSecretKeyByUserId, got result from getKeysByUserId: %o&quot;,</span>
<a href="#l17.79"></a><span id="l17.79" class="difflineminus">-      keyList</span>
<a href="#l17.80"></a><span id="l17.80" class="difflineminus">-    );</span>
<a href="#l17.81"></a><span id="l17.81"> </span>
<a href="#l17.82"></a><span id="l17.82" class="difflineminus">-    let foundKey = null;</span>
<a href="#l17.83"></a><span id="l17.83" class="difflineplus">+    result.all = [];</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineplus">+    result.best = null;</span>
<a href="#l17.85"></a><span id="l17.85"> </span>
<a href="#l17.86"></a><span id="l17.86">     for (let key of keyList) {</span>
<a href="#l17.87"></a><span id="l17.87">       if (</span>
<a href="#l17.88"></a><span id="l17.88">         key.secretAvailable &amp;&amp;</span>
<a href="#l17.89"></a><span id="l17.89">         key.getEncryptionValidity().keyValid &amp;&amp;</span>
<a href="#l17.90"></a><span id="l17.90">         key.getSigningValidity().keyValid</span>
<a href="#l17.91"></a><span id="l17.91">       ) {</span>
<a href="#l17.92"></a><span id="l17.92" class="difflineminus">-        if (!foundKey) {</span>
<a href="#l17.93"></a><span id="l17.93" class="difflineminus">-          foundKey = key;</span>
<a href="#l17.94"></a><span id="l17.94" class="difflineplus">+        result.all.push(key);</span>
<a href="#l17.95"></a><span id="l17.95" class="difflineplus">+        if (!result.best) {</span>
<a href="#l17.96"></a><span id="l17.96" class="difflineplus">+          result.best = key;</span>
<a href="#l17.97"></a><span id="l17.97">         } else if (</span>
<a href="#l17.98"></a><span id="l17.98" class="difflineminus">-          foundKey.algoSym === key.algoSym &amp;&amp;</span>
<a href="#l17.99"></a><span id="l17.99" class="difflineminus">-          foundKey.keySize === key.keySize</span>
<a href="#l17.100"></a><span id="l17.100" class="difflineplus">+          result.best.algoSym === key.algoSym &amp;&amp;</span>
<a href="#l17.101"></a><span id="l17.101" class="difflineplus">+          result.best.keySize === key.keySize</span>
<a href="#l17.102"></a><span id="l17.102">         ) {</span>
<a href="#l17.103"></a><span id="l17.103" class="difflineminus">-          if (key.expiryTime &gt; foundKey.expiryTime) {</span>
<a href="#l17.104"></a><span id="l17.104" class="difflineminus">-            foundKey = key;</span>
<a href="#l17.105"></a><span id="l17.105" class="difflineplus">+          if (key.expiryTime &gt; result.best.expiryTime) {</span>
<a href="#l17.106"></a><span id="l17.106" class="difflineplus">+            result.best = key;</span>
<a href="#l17.107"></a><span id="l17.107">           }</span>
<a href="#l17.108"></a><span id="l17.108">         } else if (</span>
<a href="#l17.109"></a><span id="l17.109" class="difflineminus">-          foundKey.algoSym.search(/^(DSA|RSA)$/) &lt; 0 &amp;&amp;</span>
<a href="#l17.110"></a><span id="l17.110" class="difflineplus">+          result.best.algoSym.search(/^(DSA|RSA)$/) &lt; 0 &amp;&amp;</span>
<a href="#l17.111"></a><span id="l17.111">           key.algoSym.search(/^(DSA|RSA)$/) === 0</span>
<a href="#l17.112"></a><span id="l17.112">         ) {</span>
<a href="#l17.113"></a><span id="l17.113">           // prefer RSA or DSA over ECC (long-term: change this once ECC keys are widely supported)</span>
<a href="#l17.114"></a><span id="l17.114" class="difflineminus">-          foundKey = key;</span>
<a href="#l17.115"></a><span id="l17.115" class="difflineminus">-        } else if (key.getVirtualKeySize() &gt; foundKey.getVirtualKeySize()) {</span>
<a href="#l17.116"></a><span id="l17.116" class="difflineminus">-          foundKey = key;</span>
<a href="#l17.117"></a><span id="l17.117" class="difflineplus">+          result.best = key;</span>
<a href="#l17.118"></a><span id="l17.118" class="difflineplus">+        } else if (key.getVirtualKeySize() &gt; result.best.getVirtualKeySize()) {</span>
<a href="#l17.119"></a><span id="l17.119" class="difflineplus">+          result.best = key;</span>
<a href="#l17.120"></a><span id="l17.120">         }</span>
<a href="#l17.121"></a><span id="l17.121">       }</span>
<a href="#l17.122"></a><span id="l17.122">     }</span>
<a href="#l17.123"></a><span id="l17.123" class="difflineminus">-    console.debug(&quot;getSecretKeyByUserId, foundKey: %o&quot;, foundKey);</span>
<a href="#l17.124"></a><span id="l17.124" class="difflineminus">-    return foundKey;</span>
<a href="#l17.125"></a><span id="l17.125">   },</span>
<a href="#l17.126"></a><span id="l17.126"> </span>
<a href="#l17.127"></a><span id="l17.127">   /**</span>
<a href="#l17.128"></a><span id="l17.128">    * get a list of keys for a given set of (sub-) key IDs</span>
<a href="#l17.129"></a><span id="l17.129">    *</span>
<a href="#l17.130"></a><span id="l17.130">    * @param keyIdList: Array of key IDs</span>
<a href="#l17.131"></a><span id="l17.131">                        OR String, with space-separated list of key IDs</span>
<a href="#l17.132"></a><span id="l17.132">    */</span>
<a href="#l17.133"></a><span id="l17.133" class="difflineat">@@ -439,22 +444,16 @@ var EnigmailKeyRing = {</span>
<a href="#l17.134"></a><span id="l17.134">    * @param errorMsgObj       Object   - o.value will contain error message from GnuPG</span>
<a href="#l17.135"></a><span id="l17.135">    *</span>
<a href="#l17.136"></a><span id="l17.136">    * @return String - if outputFile is NULL, the key block data; &quot;&quot; if a file is written</span>
<a href="#l17.137"></a><span id="l17.137">    */</span>
<a href="#l17.138"></a><span id="l17.138">   extractKey(includeSecretKey, id, outputFile, exitCodeObj, errorMsgObj) {</span>
<a href="#l17.139"></a><span id="l17.139">     EnigmailLog.DEBUG(&quot;keyRing.jsm: EnigmailKeyRing.extractKey: &quot; + id + &quot;\n&quot;);</span>
<a href="#l17.140"></a><span id="l17.140">     exitCodeObj.value = -1;</span>
<a href="#l17.141"></a><span id="l17.141"> </span>
<a href="#l17.142"></a><span id="l17.142" class="difflineminus">-    console.debug(</span>
<a href="#l17.143"></a><span id="l17.143" class="difflineminus">-      &quot;keyRing.jsm: EnigmailKeyRing.extractKey: type of parameter id:&quot;</span>
<a href="#l17.144"></a><span id="l17.144" class="difflineminus">-    );</span>
<a href="#l17.145"></a><span id="l17.145" class="difflineminus">-    console.debug(typeof id);</span>
<a href="#l17.146"></a><span id="l17.146" class="difflineminus">-    console.debug(id);</span>
<a href="#l17.147"></a><span id="l17.147" class="difflineminus">-</span>
<a href="#l17.148"></a><span id="l17.148">     if (includeSecretKey) {</span>
<a href="#l17.149"></a><span id="l17.149">       throw new Error(&quot;extractKey with secret key not implemented&quot;);</span>
<a href="#l17.150"></a><span id="l17.150">     }</span>
<a href="#l17.151"></a><span id="l17.151"> </span>
<a href="#l17.152"></a><span id="l17.152">     if (!id.length) {</span>
<a href="#l17.153"></a><span id="l17.153">       return &quot;&quot;;</span>
<a href="#l17.154"></a><span id="l17.154">     }</span>
<a href="#l17.155"></a><span id="l17.155"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">deleted file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/am-enigprefs.properties</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ /dev/null</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -1,2 +0,0 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineminus">-# Strings used in the Mozill AccountManager</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineminus">-prefPanel-enigprefs=OpenPGP Security</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.dtd</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.dtd</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -316,44 +316,30 @@</span>
<a href="#l19.4"></a><span id="l19.4"> &lt;!ENTITY enigmail.detailsHdrButton.label            &quot;Details&quot;&gt;</span>
<a href="#l19.5"></a><span id="l19.5"> &lt;!ENTITY enigmail.revealAttachmentsButton.label     &quot;The names of the files attached are hidden. Press the 'Reveal' button to retrieve the original file names.&quot;&gt;</span>
<a href="#l19.6"></a><span id="l19.6"> &lt;!ENTITY enigmail.revealAttachments.button          &quot;Reveal&quot;&gt;</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8"> &lt;!ENTITY enigmail.exchangeGarbage.desc              &quot;This is a broken PGP/MIME message from MS-Exchange. If you cannot access the attachments or have problems with replying or forwarding, press the 'Repair message' button to fix the message&quot;&gt;</span>
<a href="#l19.9"></a><span id="l19.9"> &lt;!ENTITY enigmail.exchangeGarbage.fixButton.label   &quot;Repair message&quot;&gt;</span>
<a href="#l19.10"></a><span id="l19.10"> &lt;!ENTITY enigmail.exchangeGarbage.waitMessage       &quot;Please wait ...&quot;&gt;</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-&lt;!ENTITY enigmail.amPrefTitle.label                 &quot;Signing/Encryption Options...&quot;&gt;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-&lt;!ENTITY enigmail.amPrefDesc.label                  &quot;Support for OpenPGP encryption and signing messages is provided by Gine-Liam. You need to have GnuPG (gpg) installed in order to use this feature.&quot;&gt;</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-&lt;!ENTITY enigmail.amPrefEnablePgp.label             &quot;Enable OpenPGP support (Gine-Liam) for this identity&quot;&gt;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-&lt;!ENTITY enigmail.amPrefUseFromAddr.label           &quot;Use email address of this identity to identify OpenPGP key&quot;&gt;</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-&lt;!ENTITY enigmail.amPrefUseKeyId.label              &quot;Use specific OpenPGP key ID:&quot;&gt;</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineminus">-&lt;!ENTITY enigmail.amPrefSelectKey.label             &quot;Select Key&quot;&gt;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineminus">-&lt;!ENTITY enigmail.amPrefMsgComp.label               &quot;Message Composition&quot;&gt;</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineminus">-&lt;!ENTITY enigmail.amPrefDefaultEncrypt.label        &quot;Message Composition Default Options&quot;&gt;</span>
<a href="#l19.20"></a><span id="l19.20"> &lt;!ENTITY enigmail.encryptionDlg.label               &quot;Gine-Liam Encryption &amp;amp; Signing Settings&quot;&gt;</span>
<a href="#l19.21"></a><span id="l19.21"> &lt;!ENTITY enigmail.encDlgProtocol.label              &quot;Encryption/Signing Standard&quot;&gt;</span>
<a href="#l19.22"></a><span id="l19.22"> &lt;!ENTITY enigmail.encDlgEncrypt.label               &quot;Encrypt Message&quot;&gt;</span>
<a href="#l19.23"></a><span id="l19.23"> &lt;!ENTITY enigmail.encDlgEncrypt.accesskey           &quot;E&quot;&gt;</span>
<a href="#l19.24"></a><span id="l19.24"> &lt;!ENTITY enigmail.encDlgSign.label                  &quot;Sign Message&quot;&gt;</span>
<a href="#l19.25"></a><span id="l19.25"> &lt;!ENTITY enigmail.encDlgSign.accesskey              &quot;S&quot;&gt;</span>
<a href="#l19.26"></a><span id="l19.26"> &lt;!ENTITY enigmail.encDlgPgpMime.label               &quot;Use PGP/MIME&quot;&gt;</span>
<a href="#l19.27"></a><span id="l19.27"> &lt;!ENTITY enigmail.encDlgPgpMime.accesskey           &quot;P&quot;&gt;</span>
<a href="#l19.28"></a><span id="l19.28"> &lt;!ENTITY enigmail.encDlgInlinePgp.label             &quot;Use Inline PGP&quot;&gt;</span>
<a href="#l19.29"></a><span id="l19.29"> &lt;!ENTITY enigmail.encDlgInlinePgp.accesskey         &quot;I&quot;&gt;</span>
<a href="#l19.30"></a><span id="l19.30"> &lt;!ENTITY enigmail.encDlgSMime.label                 &quot;Use S/MIME&quot;&gt;</span>
<a href="#l19.31"></a><span id="l19.31"> &lt;!ENTITY enigmail.encDlgSMime.accesskey             &quot;M&quot;&gt;</span>
<a href="#l19.32"></a><span id="l19.32"> &lt;!ENTITY enigmail.encDlgReset.label                 &quot;Reset to Defaults&quot;&gt;</span>
<a href="#l19.33"></a><span id="l19.33"> &lt;!ENTITY enigmail.encDlgReset.accesskey             &quot;R&quot;&gt;</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-&lt;!ENTITY enigmail.amPrefPgpHeader.label             &quot;Send 'OpenPGP' Header&quot;&gt;</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-&lt;!ENTITY enigmail.amPrefPgpHeader.id.label          &quot;Send OpenPGP Key ID&quot;&gt;</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineminus">-&lt;!ENTITY enigmail.amPrefPgpHeader.url.label         &quot;Send URL for key retrieval:&quot;&gt;</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineminus">-&lt;!ENTITY enigmail.amPrefMimePreferProto.label       &quot;If both, Gine-Liam and S/MIME encryption are possible, then:&quot;&gt;</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineminus">-&lt;!ENTITY enigmail.amPrefMimePreferEnigmail.label    &quot;Prefer Gine-Liam (OpenPGP)&quot;&gt;</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineminus">-&lt;!ENTITY enigmail.amPrefMimePreferSMime.label       &quot;Prefer S/MIME&quot;&gt;</span>
<a href="#l19.40"></a><span id="l19.40"> </span>
<a href="#l19.41"></a><span id="l19.41"> &lt;!ENTITY enigmail.progressText.label               &quot;Progress:&quot;&gt;</span>
<a href="#l19.42"></a><span id="l19.42"> </span>
<a href="#l19.43"></a><span id="l19.43"> &lt;!ENTITY enigmail.openPgpSecurity.label            &quot;OpenPGP Security&quot;&gt;</span>
<a href="#l19.44"></a><span id="l19.44"> </span>
<a href="#l19.45"></a><span id="l19.45"> &lt;!ENTITY enigmail.pgpSecurityInfo.label            &quot;Gine-Liam Security Info ...&quot;&gt;</span>
<a href="#l19.46"></a><span id="l19.46"> &lt;!ENTITY enigmail.copySecurityInfo.label           &quot;Copy Gine-Liam Security Info&quot;&gt;</span>
<a href="#l19.47"></a><span id="l19.47"> &lt;!ENTITY enigmail.showPhoto.label                  &quot;View OpenPGP Photo ID&quot;&gt;</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineat">@@ -665,17 +651,16 @@</span>
<a href="#l19.49"></a><span id="l19.49"> &lt;!ENTITY enigmail.setupWiz.useImportKeys             &quot;Alternatively, you can import your keys using the 'Import Keys' button below.&quot;&gt;</span>
<a href="#l19.50"></a><span id="l19.50"> &lt;!ENTITY enigmail.setupWiz.existingEncryptedMsg      &quot;We found that you have encrypted messages in your mail folders. We recommend that you export your keys on your existing device, and import them here. (Hint: you may use the 'Import Keys' multiple times, for example to import public and secret keys).&quot;&gt;</span>
<a href="#l19.51"></a><span id="l19.51"> &lt;!ENTITY enigmail.setupWiz.existingKeysFound         &quot;We found that you already have OpenPGP keys. We recommend that we set up Gine-Liam for you so that you can continue to work with these keys.&quot;&gt;</span>
<a href="#l19.52"></a><span id="l19.52"> &lt;!ENTITY enigmail.setupWiz.applyExistingKeysBtn      &quot;Apply my Keys&quot;&gt;</span>
<a href="#l19.53"></a><span id="l19.53"> &lt;!ENTITY enigmail.setupWiz.rescanInboxBtn            &quot;Rescan Inbox&quot;&gt;</span>
<a href="#l19.54"></a><span id="l19.54"> &lt;!ENTITY enigmail.setupWiz.importKeysBtn             &quot;Import Keys&quot;&gt;</span>
<a href="#l19.55"></a><span id="l19.55"> </span>
<a href="#l19.56"></a><span id="l19.56"> &lt;!ENTITY enigmail.advancedIdentityDlg.title          &quot;Advanced Gine-Liam Identity Settings&quot;&gt;</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineminus">-&lt;!ENTITY enigmail.amPrefPgp.sendKeyWithMsg.label     &quot;Attach my public key to messages&quot;&gt;</span>
<a href="#l19.58"></a><span id="l19.58"> </span>
<a href="#l19.59"></a><span id="l19.59"> &lt;!ENTITY enigmail.addPhoto.question.label            &quot;Do you want to add the following picture to the key?&quot;&gt;</span>
<a href="#l19.60"></a><span id="l19.60"> &lt;!ENTITY enigmail.addPhoto.title                     &quot;Add Photo to Key&quot;&gt;</span>
<a href="#l19.61"></a><span id="l19.61"> &lt;!ENTITY enigmail.msgViewColumn.tooltip              &quot;Sort by the OpenPGP status&quot;&gt;</span>
<a href="#l19.62"></a><span id="l19.62"> &lt;!ENTITY enigmail.addToRule.title                    &quot;Add Key to Per-Recipient Rule&quot;&gt;</span>
<a href="#l19.63"></a><span id="l19.63"> &lt;!ENTITY enigmail.addToRule.useRuleButton.label      &quot;Add Key to Selected Rule&quot;&gt;</span>
<a href="#l19.64"></a><span id="l19.64"> &lt;!ENTITY enigmail.addToRule.useRuleButton.accesskey  &quot;A&quot;&gt;</span>
<a href="#l19.65"></a><span id="l19.65"> &lt;!ENTITY enigmail.addToRule.newRuleButton.label      &quot;Create New Rule&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -381,21 +381,16 @@ userSel.problemMultipleKeys=Multiple key</span>
<a href="#l20.4"></a><span id="l20.4"> # should be same as thunderbird ENTITY sendLaterCmd.label:</span>
<a href="#l20.5"></a><span id="l20.5"> sendLaterCmd.label=Send Later</span>
<a href="#l20.6"></a><span id="l20.6"> </span>
<a href="#l20.7"></a><span id="l20.7"> # Strings used in enigmailAttachmentDialog.js</span>
<a href="#l20.8"></a><span id="l20.8"> pgpMimeNote=NOTE: PGP/MIME is not supported by all email clients. If you are unsure, select the %S option.</span>
<a href="#l20.9"></a><span id="l20.9"> first=first</span>
<a href="#l20.10"></a><span id="l20.10"> second=second</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-# Strings used in am-enigprefs.js / enigmailEditIdentity.js</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-encryptKeyHeader=Select OpenPGP Key for Encryption</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-identityName=Identity: %S</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-</span>
<a href="#l20.17"></a><span id="l20.17"> # Strings used in enigmailSingleRcptSettings.js</span>
<a href="#l20.18"></a><span id="l20.18"> noEncryption=You have activated encryption, but you did not select a key. In order to encrypt emails sent to %1$S, you need to specify one or several valid key(s) from your key list. Do you want to disable encryption for %2$S?</span>
<a href="#l20.19"></a><span id="l20.19"> noKeyToUse=(none - no encryption)</span>
<a href="#l20.20"></a><span id="l20.20"> noEmptyRule=The Rule may not be empty! Please set an email address in the Rule field.</span>
<a href="#l20.21"></a><span id="l20.21"> invalidAddress=The email address(es) you have entered are not valid. You should not set the names of the recipients, just the email addresses. E.g.:\nInvalid: Some Name &lt;some.name@address.net&gt;\nValid:   some.name@address.net</span>
<a href="#l20.22"></a><span id="l20.22"> noCurlyBrackets=The curly brackets {} have a special meaning and should not be used in an email address. If you want to modify the matching behavior for this rule, use the 'Apply rule if recipient ...' option.\nMore information is available from the Help button.</span>
<a href="#l20.23"></a><span id="l20.23"> </span>
<a href="#l20.24"></a><span id="l20.24"> # Strings used in enigmailRulesEditor.js</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">deleted file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/am-enigprefs.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ /dev/null</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -1,87 +0,0 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineminus">-/*</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineminus">- * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineminus">- * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineminus">- */</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineminus">-</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineminus">-&quot;use strict&quot;;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-var { EnigmailLog } = ChromeUtils.import(</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-  &quot;chrome://openpgp/content/modules/log.jsm&quot;</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-);</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineminus">-var EnigmailCore = ChromeUtils.import(</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineminus">-  &quot;chrome://openpgp/content/modules/core.jsm&quot;</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineminus">-).EnigmailCore;</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineminus">-</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineminus">-if (!Enigmail) {</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineminus">-  var Enigmail = {};</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineminus">-}</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineminus">-</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineminus">-var gPref = null;</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineminus">-</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineminus">-function onInit() {</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineminus">-  EnigmailLog.DEBUG(&quot;am-enigprefs.js: onInit()\n&quot;);</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineminus">-</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineminus">-  try {</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineminus">-    performInit();</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineminus">-  } catch (ex) {</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineminus">-    EnigmailLog.ERROR(&quot;am-enigprefs.js: onInit: error: &quot; + ex.message + &quot;\n&quot;);</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineminus">-  }</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineminus">-}</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineminus">-</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineminus">-function performInit() {</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineminus">-  EnigmailLog.DEBUG(&quot;am-enigprefs.js: performInit()\n&quot;);</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineminus">-</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineminus">-  Enigmail.edit.onInit();</span>
<a href="#l21.40"></a><span id="l21.40" class="difflineminus">-}</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineminus">-</span>
<a href="#l21.42"></a><span id="l21.42" class="difflineminus">-function onAcceptEditor() {</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineminus">-  EnigmailLog.DEBUG(&quot;am-enigprefs.js: onAcceptEditor()\n&quot;);</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineminus">-  Enigmail.edit.onSave();</span>
<a href="#l21.45"></a><span id="l21.45" class="difflineminus">-  saveChanges();</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineminus">-  return true;</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineminus">-}</span>
<a href="#l21.48"></a><span id="l21.48" class="difflineminus">-</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineminus">-function onPreInit(account, accountValues) {</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineminus">-  EnigmailLog.DEBUG(&quot;am-enigprefs.js: onPreInit()\n&quot;);</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineminus">-</span>
<a href="#l21.52"></a><span id="l21.52" class="difflineminus">-  if (!EnigmailCore.getService()) {</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineminus">-    return;</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineminus">-  }</span>
<a href="#l21.55"></a><span id="l21.55" class="difflineminus">-</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineminus">-  Enigmail.edit.identity = account.defaultIdentity;</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineminus">-  Enigmail.edit.account = account;</span>
<a href="#l21.58"></a><span id="l21.58" class="difflineminus">-}</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineminus">-</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineminus">-function onSave() {</span>
<a href="#l21.61"></a><span id="l21.61" class="difflineminus">-  EnigmailLog.DEBUG(&quot;am-enigprefs.js: onSave()\n&quot;);</span>
<a href="#l21.62"></a><span id="l21.62" class="difflineminus">-</span>
<a href="#l21.63"></a><span id="l21.63" class="difflineminus">-  Enigmail.edit.onSave();</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineminus">-  saveChanges();</span>
<a href="#l21.65"></a><span id="l21.65" class="difflineminus">-  return true;</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineminus">-}</span>
<a href="#l21.67"></a><span id="l21.67" class="difflineminus">-</span>
<a href="#l21.68"></a><span id="l21.68" class="difflineminus">-function onLockPreference() {</span>
<a href="#l21.69"></a><span id="l21.69" class="difflineminus">-  // do nothing</span>
<a href="#l21.70"></a><span id="l21.70" class="difflineminus">-}</span>
<a href="#l21.71"></a><span id="l21.71" class="difflineminus">-</span>
<a href="#l21.72"></a><span id="l21.72" class="difflineminus">-// Does the work of disabling an element given the array which contains xul id/prefstring pairs.</span>
<a href="#l21.73"></a><span id="l21.73" class="difflineminus">-// Also saves the id/locked state in an array so that other areas of the code can avoid</span>
<a href="#l21.74"></a><span id="l21.74" class="difflineminus">-// stomping on the disabled state indiscriminately.</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineminus">-function disableIfLocked(prefstrArray) {</span>
<a href="#l21.76"></a><span id="l21.76" class="difflineminus">-  // do nothing</span>
<a href="#l21.77"></a><span id="l21.77" class="difflineminus">-}</span>
<a href="#l21.78"></a><span id="l21.78" class="difflineminus">-</span>
<a href="#l21.79"></a><span id="l21.79" class="difflineminus">-function enigmailOnAcceptEditor() {</span>
<a href="#l21.80"></a><span id="l21.80" class="difflineminus">-  EnigmailLog.DEBUG(&quot;am-enigprefs.js: enigmailOnAcceptEditor()\n&quot;);</span>
<a href="#l21.81"></a><span id="l21.81" class="difflineminus">-</span>
<a href="#l21.82"></a><span id="l21.82" class="difflineminus">-  Enigmail.edit.onSave();</span>
<a href="#l21.83"></a><span id="l21.83" class="difflineminus">-</span>
<a href="#l21.84"></a><span id="l21.84" class="difflineminus">-  return true; // allow to close dialog in all cases</span>
<a href="#l21.85"></a><span id="l21.85" class="difflineminus">-}</span>
<a href="#l21.86"></a><span id="l21.86" class="difflineminus">-</span>
<a href="#l21.87"></a><span id="l21.87" class="difflineminus">-function saveChanges() {}</span>
<a href="#l21.88"></a><span id="l21.88" class="difflineminus">-</span>
<a href="#l21.89"></a><span id="l21.89" class="difflineminus">-document.addEventListener(&quot;dialogaccept&quot;, function(event) {</span>
<a href="#l21.90"></a><span id="l21.90" class="difflineminus">-  Enigmail.edit.onAcceptEditor();</span>
<a href="#l21.91"></a><span id="l21.91" class="difflineminus">-});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/commonWorkflows.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/commonWorkflows.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l22.4"></a><span id="l22.4"> /*</span>
<a href="#l22.5"></a><span id="l22.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.6"></a><span id="l22.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.7"></a><span id="l22.7">  * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l22.8"></a><span id="l22.8">  */</span>
<a href="#l22.9"></a><span id="l22.9"> </span>
<a href="#l22.10"></a><span id="l22.10"> &quot;use strict&quot;;</span>
<a href="#l22.11"></a><span id="l22.11"> </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-const { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l22.14"></a><span id="l22.14"> var EnigmailDialog = ChromeUtils.import(</span>
<a href="#l22.15"></a><span id="l22.15">   &quot;chrome://openpgp/content/modules/dialog.jsm&quot;</span>
<a href="#l22.16"></a><span id="l22.16"> ).EnigmailDialog;</span>
<a href="#l22.17"></a><span id="l22.17"> var EnigmailLocale = ChromeUtils.import(</span>
<a href="#l22.18"></a><span id="l22.18">   &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l22.19"></a><span id="l22.19"> ).EnigmailLocale;</span>
<a href="#l22.20"></a><span id="l22.20"> var { EnigmailKey } = ChromeUtils.import(</span>
<a href="#l22.21"></a><span id="l22.21">   &quot;chrome://openpgp/content/modules/key.jsm&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/enigmailEditIdentity.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -50,38 +50,27 @@ Enigmail.edit = {</span>
<a href="#l23.4"></a><span id="l23.4">     this.enablePgp = document.getElementById(&quot;enigmail_enablePgp&quot;);</span>
<a href="#l23.5"></a><span id="l23.5">     this.pgpKeyMode = document.getElementById(&quot;enigmail_pgpKeyMode&quot;);</span>
<a href="#l23.6"></a><span id="l23.6">     this.pgpKeyId = document.getElementById(&quot;enigmail_identity.pgpkeyId&quot;);</span>
<a href="#l23.7"></a><span id="l23.7">     this.signingPolicy = document.getElementById(&quot;enigmail_sign_ifPossible&quot;);</span>
<a href="#l23.8"></a><span id="l23.8">     this.encryptionPolicy = document.getElementById(</span>
<a href="#l23.9"></a><span id="l23.9">       &quot;enigmail_encrypt_ifPossible&quot;</span>
<a href="#l23.10"></a><span id="l23.10">     );</span>
<a href="#l23.11"></a><span id="l23.11">     this.pgpMimeMode = document.getElementById(&quot;enigmail_pgpMimeMode&quot;);</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-    this.pgpSignEncPolicy = document.getElementById(&quot;enigmail_sign_encrypted&quot;);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-    this.pgpSignPlainPolicy = document.getElementById(</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">-      &quot;enigmail_sign_notEncrypted&quot;</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">-    );</span>
<a href="#l23.16"></a><span id="l23.16">     this.autoEncryptDrafts = document.getElementById(</span>
<a href="#l23.17"></a><span id="l23.17">       &quot;enigmail_autoEncryptDrafts&quot;</span>
<a href="#l23.18"></a><span id="l23.18">     );</span>
<a href="#l23.19"></a><span id="l23.19">     this.mimePreferOpenPGP = document.getElementById(</span>
<a href="#l23.20"></a><span id="l23.20">       &quot;enigmail_mimePreferOpenPGP&quot;</span>
<a href="#l23.21"></a><span id="l23.21">     );</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">-    this.enableAc = document.getElementById(&quot;enigmail_enableAutocrypt&quot;);</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineminus">-    this.acPreferEncrypt = document.getElementById(&quot;enigmail_acPreferEncrypt&quot;);</span>
<a href="#l23.24"></a><span id="l23.24">     this.isSingleIdEditor = !!document.getElementById(&quot;enigmail_singleId&quot;);</span>
<a href="#l23.25"></a><span id="l23.25">     this.openPgpSendKeyWithMsg = document.getElementById(</span>
<a href="#l23.26"></a><span id="l23.26">       &quot;openpgp.sendKeyWithMsg&quot;</span>
<a href="#l23.27"></a><span id="l23.27">     );</span>
<a href="#l23.28"></a><span id="l23.28"> </span>
<a href="#l23.29"></a><span id="l23.29" class="difflineminus">-    if (this.isSingleIdEditor) {</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-      let acTab = document.getElementById(&quot;enigmail_autocryptTab&quot;);</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-      acTab.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-    }</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineminus">-</span>
<a href="#l23.34"></a><span id="l23.34">     if (this.identity) {</span>
<a href="#l23.35"></a><span id="l23.35">       this.enablePgp.checked = this.identity.getBoolAttribute(&quot;enablePgp&quot;);</span>
<a href="#l23.36"></a><span id="l23.36">       this.cryptoChoicesEnabled = this.enablePgp.checked;</span>
<a href="#l23.37"></a><span id="l23.37"> </span>
<a href="#l23.38"></a><span id="l23.38">       var selectedItemId = null;</span>
<a href="#l23.39"></a><span id="l23.39">       var keyPolicy = this.identity.getIntAttribute(&quot;pgpKeyMode&quot;);</span>
<a href="#l23.40"></a><span id="l23.40">       switch (keyPolicy) {</span>
<a href="#l23.41"></a><span id="l23.41">         case 1:</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineat">@@ -124,26 +113,16 @@ Enigmail.edit = {</span>
<a href="#l23.43"></a><span id="l23.43">     } else {</span>
<a href="#l23.44"></a><span id="l23.44">       this.enablePgp.checked = false;</span>
<a href="#l23.45"></a><span id="l23.45">       this.cryptoChoicesEnabled = false;</span>
<a href="#l23.46"></a><span id="l23.46">       this.pgpMimeMode.checked = true;</span>
<a href="#l23.47"></a><span id="l23.47">       this.pgpSignEncPolicy.checked = true;</span>
<a href="#l23.48"></a><span id="l23.48">       this.autoEncryptDrafts.checked = true;</span>
<a href="#l23.49"></a><span id="l23.49">     }</span>
<a href="#l23.50"></a><span id="l23.50"> </span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-    if (this.account) {</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-      this.enableAc.checked = this.account.incomingServer.getBoolValue(</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-        &quot;enableAutocrypt&quot;</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineminus">-      );</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineminus">-      this.acPreferEncrypt.checked =</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineminus">-        this.account.incomingServer.getIntValue(&quot;acPreferEncrypt&quot;) &gt; 0;</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineminus">-    } else {</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineminus">-      this.enableAc.checked = true;</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineminus">-    }</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineminus">-</span>
<a href="#l23.61"></a><span id="l23.61">     // Disable all locked elements on the panel</span>
<a href="#l23.62"></a><span id="l23.62">     //onLockPreference();</span>
<a href="#l23.63"></a><span id="l23.63">     this.enableAllPrefs();</span>
<a href="#l23.64"></a><span id="l23.64">   },</span>
<a href="#l23.65"></a><span id="l23.65"> </span>
<a href="#l23.66"></a><span id="l23.66">   onLoadEditor() {</span>
<a href="#l23.67"></a><span id="l23.67">     if (typeof gAccount == &quot;object&quot;) {</span>
<a href="#l23.68"></a><span id="l23.68">       this.account = gAccount;</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineat">@@ -221,27 +200,16 @@ Enigmail.edit = {</span>
<a href="#l23.70"></a><span id="l23.70">         &quot;pgpSignPlain&quot;,</span>
<a href="#l23.71"></a><span id="l23.71">         this.pgpSignPlainPolicy.checked</span>
<a href="#l23.72"></a><span id="l23.72">       );</span>
<a href="#l23.73"></a><span id="l23.73">       this.identity.setBoolAttribute(</span>
<a href="#l23.74"></a><span id="l23.74">         &quot;autoEncryptDrafts&quot;,</span>
<a href="#l23.75"></a><span id="l23.75">         this.autoEncryptDrafts.checked</span>
<a href="#l23.76"></a><span id="l23.76">       );</span>
<a href="#l23.77"></a><span id="l23.77">     }</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineminus">-</span>
<a href="#l23.79"></a><span id="l23.79" class="difflineminus">-    if (!this.isSingleIdEditor) {</span>
<a href="#l23.80"></a><span id="l23.80" class="difflineminus">-      this.account.incomingServer.setBoolValue(</span>
<a href="#l23.81"></a><span id="l23.81" class="difflineminus">-        &quot;enableAutocrypt&quot;,</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineminus">-        this.enableAc.checked</span>
<a href="#l23.83"></a><span id="l23.83" class="difflineminus">-      );</span>
<a href="#l23.84"></a><span id="l23.84" class="difflineminus">-      this.account.incomingServer.setIntValue(</span>
<a href="#l23.85"></a><span id="l23.85" class="difflineminus">-        &quot;acPreferEncrypt&quot;,</span>
<a href="#l23.86"></a><span id="l23.86" class="difflineminus">-        this.acPreferEncrypt.checked ? 1 : 0</span>
<a href="#l23.87"></a><span id="l23.87" class="difflineminus">-      );</span>
<a href="#l23.88"></a><span id="l23.88" class="difflineminus">-    }</span>
<a href="#l23.89"></a><span id="l23.89">   },</span>
<a href="#l23.90"></a><span id="l23.90"> </span>
<a href="#l23.91"></a><span id="l23.91">   toggleEnable() {</span>
<a href="#l23.92"></a><span id="l23.92">     let newCryptoEnabled = !this.cryptoChoicesEnabled;</span>
<a href="#l23.93"></a><span id="l23.93"> </span>
<a href="#l23.94"></a><span id="l23.94">     this.cryptoChoicesEnabled = newCryptoEnabled;</span>
<a href="#l23.95"></a><span id="l23.95">     this.enableAllPrefs();</span>
<a href="#l23.96"></a><span id="l23.96">   },</span>
<a href="#l23.97"></a><span id="l23.97" class="difflineat">@@ -252,39 +220,30 @@ Enigmail.edit = {</span>
<a href="#l23.98"></a><span id="l23.98">       if (elem) {</span>
<a href="#l23.99"></a><span id="l23.99">         elem.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l23.100"></a><span id="l23.100">       }</span>
<a href="#l23.101"></a><span id="l23.101">     } else if (elem) {</span>
<a href="#l23.102"></a><span id="l23.102">       elem.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l23.103"></a><span id="l23.103">     }</span>
<a href="#l23.104"></a><span id="l23.104"> </span>
<a href="#l23.105"></a><span id="l23.105">     this.enableKeySel(this.cryptoChoicesEnabled &amp;&amp; this.pgpKeyMode.value == 1);</span>
<a href="#l23.106"></a><span id="l23.106" class="difflineminus">-    this.enableAcSettings();</span>
<a href="#l23.107"></a><span id="l23.107">   },</span>
<a href="#l23.108"></a><span id="l23.108"> </span>
<a href="#l23.109"></a><span id="l23.109">   enableKeySel(enable) {</span>
<a href="#l23.110"></a><span id="l23.110">     if (enable) {</span>
<a href="#l23.111"></a><span id="l23.111">       document</span>
<a href="#l23.112"></a><span id="l23.112">         .getElementById(&quot;enigmail_bcUseKeyId&quot;)</span>
<a href="#l23.113"></a><span id="l23.113">         .removeAttribute(&quot;disabled&quot;);</span>
<a href="#l23.114"></a><span id="l23.114">     } else {</span>
<a href="#l23.115"></a><span id="l23.115">       document</span>
<a href="#l23.116"></a><span id="l23.116">         .getElementById(&quot;enigmail_bcUseKeyId&quot;)</span>
<a href="#l23.117"></a><span id="l23.117">         .setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l23.118"></a><span id="l23.118">     }</span>
<a href="#l23.119"></a><span id="l23.119">   },</span>
<a href="#l23.120"></a><span id="l23.120"> </span>
<a href="#l23.121"></a><span id="l23.121" class="difflineminus">-  enableAcSettings() {</span>
<a href="#l23.122"></a><span id="l23.122" class="difflineminus">-    if (this.cryptoChoicesEnabled &amp;&amp; this.enableAc.checked) {</span>
<a href="#l23.123"></a><span id="l23.123" class="difflineminus">-      this.acPreferEncrypt.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l23.124"></a><span id="l23.124" class="difflineminus">-    } else {</span>
<a href="#l23.125"></a><span id="l23.125" class="difflineminus">-      this.acPreferEncrypt.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l23.126"></a><span id="l23.126" class="difflineminus">-    }</span>
<a href="#l23.127"></a><span id="l23.127" class="difflineminus">-  },</span>
<a href="#l23.128"></a><span id="l23.128" class="difflineminus">-</span>
<a href="#l23.129"></a><span id="l23.129">   handleClick(event) {</span>
<a href="#l23.130"></a><span id="l23.130">     if (event.target.hasAttribute(&quot;href&quot;)) {</span>
<a href="#l23.131"></a><span id="l23.131">       EnigmailWindows.openMailTab(event.target.getAttribute(&quot;href&quot;));</span>
<a href="#l23.132"></a><span id="l23.132">     }</span>
<a href="#l23.133"></a><span id="l23.133">   },</span>
<a href="#l23.134"></a><span id="l23.134"> </span>
<a href="#l23.135"></a><span id="l23.135">   selectKeyId() {</span>
<a href="#l23.136"></a><span id="l23.136">     var resultObj = {};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">new file mode 100644</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineminus">--- /dev/null</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/keyPicker.css</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineat">@@ -0,0 +1,30 @@</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.6"></a><span id="l24.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.7"></a><span id="l24.7" class="difflineplus">+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.8"></a><span id="l24.8" class="difflineplus">+</span>
<a href="#l24.9"></a><span id="l24.9" class="difflineplus">+.info-name {</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineplus">+  overflow: hidden; /* Allows equal sizing combined with width=&quot;0&quot; */</span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+  padding-inline-start: 7px;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineplus">+  -moz-box-align: center;</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+}</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+#keyPickerDialog {</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+  width: 45em;</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+}</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineplus">+</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineplus">+#keyIDBox {</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineplus">+  min-height: 18em;</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+}</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineplus">+</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineplus">+#userID,</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineplus">+#keyID,</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+#keyCreated,</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+#keyExpiration,</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+#keyIDBox &gt; richlistitem {</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineplus">+  min-height: 35px;</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineplus">+}</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineplus">+</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+.website-status {</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+  margin: 1px;</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineplus">+  margin-inline-end: 5px;</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">new file mode 100644</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineminus">--- /dev/null</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/keyPicker.ftl</span>
<a href="#l25.4"></a><span id="l25.4" class="difflineat">@@ -0,0 +1,33 @@</span>
<a href="#l25.5"></a><span id="l25.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.6"></a><span id="l25.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.7"></a><span id="l25.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l25.8"></a><span id="l25.8" class="difflineplus">+</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineplus">+key-picker-button-cancel =</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineplus">+    .label = Cancel</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineplus">+    .accesskey = C</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+key-picker-intro =</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+    .value = Select the personal OpenPGP key that you want to use for this identity</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+key-picker-window =</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+    .title = Select a Personal OpenPGP Key</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+key-picker-user-id =</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+    .label = User ID</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineplus">+key-picker-key-id =</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+    .label = Key ID</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineplus">+</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineplus">+key-picker-key-created =</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineplus">+    .label = Created</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineplus">+</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineplus">+key-picker-key-expiration =</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineplus">+    .label = Expiration</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineplus">+</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineplus">+key-picker-button-cancel =</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+    .label = Cancel</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineplus">+    .accesskey = C</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+key-picker-button-ok =</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+    .label = OK</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineplus">+    .accesskey = O</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">new file mode 100644</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineminus">--- /dev/null</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/keyPicker.js</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineat">@@ -0,0 +1,88 @@</span>
<a href="#l26.5"></a><span id="l26.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.6"></a><span id="l26.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.7"></a><span id="l26.7" class="difflineplus">+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l26.8"></a><span id="l26.8" class="difflineplus">+</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineplus">+var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineplus">+var { AppConstants } = ChromeUtils.import(</span>
<a href="#l26.11"></a><span id="l26.11" class="difflineplus">+  &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineplus">+);</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+var gKeyPicker = {</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+  _bundle: null,</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineplus">+  _list: null,</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineplus">+</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineplus">+  gParams: null,</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineplus">+</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineplus">+  onLoad() {</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineplus">+    this.gParams = window.arguments[0];</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineplus">+    document.mozSubdialogReady = this.init();</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineplus">+  },</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineplus">+</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineplus">+  async init() {</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineplus">+    this._list = document.getElementById(&quot;keyIDBox&quot;);</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineplus">+</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineplus">+    let frag = document.createDocumentFragment();</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineplus">+</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineplus">+    for (let key of this.gParams.keys) {</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineplus">+      let richlistitem = this._createListItem(key);</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+      frag.appendChild(richlistitem);</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineplus">+    }</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineplus">+</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineplus">+    this._list.appendChild(frag);</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineplus">+</span>
<a href="#l26.37"></a><span id="l26.37" class="difflineplus">+    document.getElementById(&quot;identityAddress&quot;).value = this.gParams.identity;</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineplus">+  },</span>
<a href="#l26.39"></a><span id="l26.39" class="difflineplus">+</span>
<a href="#l26.40"></a><span id="l26.40" class="difflineplus">+  _createListItem(key) {</span>
<a href="#l26.41"></a><span id="l26.41" class="difflineplus">+    let richlistitem = document.createXULElement(&quot;richlistitem&quot;);</span>
<a href="#l26.42"></a><span id="l26.42" class="difflineplus">+</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineplus">+    let row = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l26.44"></a><span id="l26.44" class="difflineplus">+    row.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l26.45"></a><span id="l26.45" class="difflineplus">+</span>
<a href="#l26.46"></a><span id="l26.46" class="difflineplus">+    let hbox = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l26.47"></a><span id="l26.47" class="difflineplus">+    let user = document.createXULElement(&quot;label&quot;);</span>
<a href="#l26.48"></a><span id="l26.48" class="difflineplus">+    user.setAttribute(&quot;value&quot;, key.userId);</span>
<a href="#l26.49"></a><span id="l26.49" class="difflineplus">+    hbox.setAttribute(&quot;width&quot;, &quot;0&quot;);</span>
<a href="#l26.50"></a><span id="l26.50" class="difflineplus">+    hbox.setAttribute(&quot;class&quot;, &quot;info-name&quot;);</span>
<a href="#l26.51"></a><span id="l26.51" class="difflineplus">+    hbox.setAttribute(&quot;flex&quot;, &quot;3&quot;);</span>
<a href="#l26.52"></a><span id="l26.52" class="difflineplus">+    hbox.appendChild(user);</span>
<a href="#l26.53"></a><span id="l26.53" class="difflineplus">+    row.appendChild(hbox);</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineplus">+</span>
<a href="#l26.55"></a><span id="l26.55" class="difflineplus">+    hbox = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineplus">+    let id = document.createXULElement(&quot;label&quot;);</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineplus">+    id.setAttribute(&quot;value&quot;, key.keyId);</span>
<a href="#l26.58"></a><span id="l26.58" class="difflineplus">+    hbox.setAttribute(&quot;width&quot;, &quot;0&quot;);</span>
<a href="#l26.59"></a><span id="l26.59" class="difflineplus">+    hbox.setAttribute(&quot;class&quot;, &quot;info-name&quot;);</span>
<a href="#l26.60"></a><span id="l26.60" class="difflineplus">+    hbox.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l26.61"></a><span id="l26.61" class="difflineplus">+    hbox.appendChild(id);</span>
<a href="#l26.62"></a><span id="l26.62" class="difflineplus">+    row.appendChild(hbox);</span>
<a href="#l26.63"></a><span id="l26.63" class="difflineplus">+</span>
<a href="#l26.64"></a><span id="l26.64" class="difflineplus">+    hbox = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l26.65"></a><span id="l26.65" class="difflineplus">+    let created = document.createXULElement(&quot;label&quot;);</span>
<a href="#l26.66"></a><span id="l26.66" class="difflineplus">+    created.setAttribute(&quot;value&quot;, key.created);</span>
<a href="#l26.67"></a><span id="l26.67" class="difflineplus">+    hbox.setAttribute(&quot;width&quot;, &quot;0&quot;);</span>
<a href="#l26.68"></a><span id="l26.68" class="difflineplus">+    hbox.setAttribute(&quot;class&quot;, &quot;info-name&quot;);</span>
<a href="#l26.69"></a><span id="l26.69" class="difflineplus">+    hbox.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l26.70"></a><span id="l26.70" class="difflineplus">+    hbox.appendChild(created);</span>
<a href="#l26.71"></a><span id="l26.71" class="difflineplus">+    row.appendChild(hbox);</span>
<a href="#l26.72"></a><span id="l26.72" class="difflineplus">+</span>
<a href="#l26.73"></a><span id="l26.73" class="difflineplus">+    hbox = document.createXULElement(&quot;hbox&quot;);</span>
<a href="#l26.74"></a><span id="l26.74" class="difflineplus">+    let expiry = document.createXULElement(&quot;label&quot;);</span>
<a href="#l26.75"></a><span id="l26.75" class="difflineplus">+    expiry.setAttribute(&quot;value&quot;, key.expiry);</span>
<a href="#l26.76"></a><span id="l26.76" class="difflineplus">+    hbox.setAttribute(&quot;width&quot;, &quot;0&quot;);</span>
<a href="#l26.77"></a><span id="l26.77" class="difflineplus">+    hbox.setAttribute(&quot;class&quot;, &quot;info-name&quot;);</span>
<a href="#l26.78"></a><span id="l26.78" class="difflineplus">+    hbox.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l26.79"></a><span id="l26.79" class="difflineplus">+    hbox.appendChild(expiry);</span>
<a href="#l26.80"></a><span id="l26.80" class="difflineplus">+    row.appendChild(hbox);</span>
<a href="#l26.81"></a><span id="l26.81" class="difflineplus">+</span>
<a href="#l26.82"></a><span id="l26.82" class="difflineplus">+    richlistitem.appendChild(row);</span>
<a href="#l26.83"></a><span id="l26.83" class="difflineplus">+    return richlistitem;</span>
<a href="#l26.84"></a><span id="l26.84" class="difflineplus">+  },</span>
<a href="#l26.85"></a><span id="l26.85" class="difflineplus">+</span>
<a href="#l26.86"></a><span id="l26.86" class="difflineplus">+  onApplyChanges() {</span>
<a href="#l26.87"></a><span id="l26.87" class="difflineplus">+    this.gParams.canceled = false;</span>
<a href="#l26.88"></a><span id="l26.88" class="difflineplus">+    this.gParams.index = this._list.selectedIndex;</span>
<a href="#l26.89"></a><span id="l26.89" class="difflineplus">+</span>
<a href="#l26.90"></a><span id="l26.90" class="difflineplus">+    window.close();</span>
<a href="#l26.91"></a><span id="l26.91" class="difflineplus">+  },</span>
<a href="#l26.92"></a><span id="l26.92" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1">new file mode 100644</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineminus">--- /dev/null</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/keyPicker.xhtml</span>
<a href="#l27.4"></a><span id="l27.4" class="difflineat">@@ -0,0 +1,50 @@</span>
<a href="#l27.5"></a><span id="l27.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l27.6"></a><span id="l27.6" class="difflineplus">+&lt;!--</span>
<a href="#l27.7"></a><span id="l27.7" class="difflineplus">+ * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.8"></a><span id="l27.8" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.9"></a><span id="l27.9" class="difflineplus">+ * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l27.10"></a><span id="l27.10" class="difflineplus">+--&gt;</span>
<a href="#l27.11"></a><span id="l27.11" class="difflineplus">+</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/dialogs.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://openpgp/content/ui/keyPicker.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://messenger/skin/input-fields.css&quot;?&gt;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineplus">+</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineplus">+&lt;window id=&quot;keyPickerDialog&quot;</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineplus">+        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineplus">+        data-l10n-id=&quot;key-picker-window&quot;</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineplus">+        data-l10n-attrs=&quot;title, style&quot;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineplus">+        onload=&quot;gKeyPicker.onLoad();&quot;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+        persist=&quot;screenX screenY width height&quot;&gt;</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineplus">+</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineplus">+  &lt;linkset&gt;</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineplus">+    &lt;html:link rel=&quot;localization&quot; href=&quot;openpgp/content/ui/keyPicker.ftl&quot;/&gt;</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineplus">+  &lt;/linkset&gt;</span>
<a href="#l27.28"></a><span id="l27.28" class="difflineplus">+</span>
<a href="#l27.29"></a><span id="l27.29" class="difflineplus">+  &lt;script src=&quot;chrome://openpgp/content/ui/keyPicker.js&quot;/&gt;</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineplus">+</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineplus">+  &lt;vbox class=&quot;contentPane&quot;&gt;</span>
<a href="#l27.32"></a><span id="l27.32" class="difflineplus">+    &lt;label id=&quot;keyPickerText&quot; data-l10n-id=&quot;key-picker-intro&quot; flex=&quot;1&quot; value=&quot;initial value&quot;/&gt;</span>
<a href="#l27.33"></a><span id="l27.33" class="difflineplus">+    &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l27.34"></a><span id="l27.34" class="difflineplus">+    &lt;label id=&quot;identityAddress&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l27.35"></a><span id="l27.35" class="difflineplus">+    &lt;listheader&gt;</span>
<a href="#l27.36"></a><span id="l27.36" class="difflineplus">+      &lt;treecol id=&quot;userID&quot; data-l10n-id=&quot;key-picker-user-id&quot; flex=&quot;4&quot;/&gt;</span>
<a href="#l27.37"></a><span id="l27.37" class="difflineplus">+      &lt;treecol id=&quot;keyID&quot; data-l10n-id=&quot;key-picker-key-id&quot; flex=&quot;2&quot;/&gt;</span>
<a href="#l27.38"></a><span id="l27.38" class="difflineplus">+      &lt;treecol id=&quot;keyCreated&quot; data-l10n-id=&quot;key-picker-key-created&quot; flex=&quot;1&quot;</span>
<a href="#l27.39"></a><span id="l27.39" class="difflineplus">+               data-isCurrentSortCol=&quot;true&quot;/&gt;</span>
<a href="#l27.40"></a><span id="l27.40" class="difflineplus">+      &lt;treecol id=&quot;keyExpiration&quot; data-l10n-id=&quot;key-picker-key-expiration&quot; flex=&quot;1&quot;</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineplus">+               data-isCurrentSortCol=&quot;true&quot;/&gt;</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineplus">+    &lt;/listheader&gt;</span>
<a href="#l27.43"></a><span id="l27.43" class="difflineplus">+    &lt;richlistbox id=&quot;keyIDBox&quot; flex=&quot;1&quot; selected=&quot;true&quot;/&gt;</span>
<a href="#l27.44"></a><span id="l27.44" class="difflineplus">+  &lt;/vbox&gt;</span>
<a href="#l27.45"></a><span id="l27.45" class="difflineplus">+</span>
<a href="#l27.46"></a><span id="l27.46" class="difflineplus">+</span>
<a href="#l27.47"></a><span id="l27.47" class="difflineplus">+  &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l27.48"></a><span id="l27.48" class="difflineplus">+  &lt;hbox class=&quot;actionButtons&quot; pack=&quot;end&quot;&gt;</span>
<a href="#l27.49"></a><span id="l27.49" class="difflineplus">+    &lt;button oncommand=&quot;window.close();&quot; icon=&quot;close&quot;</span>
<a href="#l27.50"></a><span id="l27.50" class="difflineplus">+            data-l10n-id=&quot;key-picker-button-cancel&quot;/&gt;</span>
<a href="#l27.51"></a><span id="l27.51" class="difflineplus">+    &lt;button id=&quot;btnApplyChanges&quot; oncommand=&quot;gKeyPicker.onApplyChanges();&quot; icon=&quot;save&quot;</span>
<a href="#l27.52"></a><span id="l27.52" class="difflineplus">+            data-l10n-id=&quot;key-picker-button-ok&quot;/&gt;</span>
<a href="#l27.53"></a><span id="l27.53" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l27.54"></a><span id="l27.54" class="difflineplus">+&lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mail/extensions/openpgp/jar.mn</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mail/extensions/openpgp/jar.mn</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,23 +1,26 @@</span>
<a href="#l28.4"></a><span id="l28.4" class="difflineplus">+#filter substitution</span>
<a href="#l28.5"></a><span id="l28.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.6"></a><span id="l28.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.7"></a><span id="l28.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l28.8"></a><span id="l28.8"> </span>
<a href="#l28.9"></a><span id="l28.9"> openpgp.jar:</span>
<a href="#l28.10"></a><span id="l28.10"> % content openpgp %content/openpgp/</span>
<a href="#l28.11"></a><span id="l28.11">   content/openpgp/BondOpenPGP.jsm              (content/BondOpenPGP.jsm)</span>
<a href="#l28.12"></a><span id="l28.12">   content/openpgp/modules                      (content/modules/*.js*)</span>
<a href="#l28.13"></a><span id="l28.13">   content/openpgp/modules/stdlib               (content/modules/stdlib/*.js*)</span>
<a href="#l28.14"></a><span id="l28.14">   content/openpgp/modules/cryptoAPI            (content/modules/cryptoAPI/*.js*)</span>
<a href="#l28.15"></a><span id="l28.15">   content/openpgp/strings/enigmail.properties  (content/strings/enigmail.properties)</span>
<a href="#l28.16"></a><span id="l28.16">   content/openpgp/strings/enigmail.dtd         (content/strings/enigmail.dtd)</span>
<a href="#l28.17"></a><span id="l28.17">   content/openpgp/strings/bond.dtd             (content/strings/bond.dtd)</span>
<a href="#l28.18"></a><span id="l28.18" class="difflineminus">-  content/openpgp/ui                           (content/ui/*)</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineplus">+  content/openpgp/ui                           (content/ui/*.js)</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineplus">+  content/openpgp/ui                           (content/ui/*.xhtml)</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineplus">+  content/openpgp/ui                           (content/ui/*.css)</span>
<a href="#l28.22"></a><span id="l28.22"> % skin openpgp classic/1.0 %skin/tb-mac/ os=Darwin</span>
<a href="#l28.23"></a><span id="l28.23"> % skin openpgp classic/1.0 %skin/tb-win/ os=WINNT</span>
<a href="#l28.24"></a><span id="l28.24"> % skin openpgp classic/1.0 %skin/tb-linux/</span>
<a href="#l28.25"></a><span id="l28.25">   skin/tb-mac                                  (skin/tb-mac/*)</span>
<a href="#l28.26"></a><span id="l28.26">   skin/tb-win                                  (skin/tb-win/*)</span>
<a href="#l28.27"></a><span id="l28.27">   skin/tb-linux                                (skin/tb-linux/*)</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineminus">-  am-enigprefs.properties                      (content/strings/am-enigprefs.properties)</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineminus">-  content/openpgp/am-enigprefs.xhtml           (content/am-enigprefs.xhtml)</span>
<a href="#l28.30"></a><span id="l28.30"> </span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+[localization] @AB_CD@.jar:</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+  openpgp/content/ui/keyPicker.ftl             (content/ui/keyPicker.ftl)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mail/extensions/openpgp/locale/jar.mn</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mail/extensions/openpgp/locale/jar.mn</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -1,10 +1,6 @@</span>
<a href="#l29.4"></a><span id="l29.4"> #filter substitution</span>
<a href="#l29.5"></a><span id="l29.5"> </span>
<a href="#l29.6"></a><span id="l29.6"> #openpgp.jar:</span>
<a href="#l29.7"></a><span id="l29.7"> #% locale openpgp @AB_CD@ %</span>
<a href="#l29.8"></a><span id="l29.8"> #  locale/openpgp/enigmail.properties  (%enigmail.properties)</span>
<a href="#l29.9"></a><span id="l29.9"> #  locale/openpgp/enigmail.dtd         (%enigmail.dtd)</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineminus">-</span>
<a href="#l29.11"></a><span id="l29.11" class="difflineminus">-</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-#@AB_CD@.jar:</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-#  locale/@AB_CD@/messenger/am-enigprefs.properties  (%am-enigprefs.properties)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/extensions/openpgp/moz.build</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/extensions/openpgp/moz.build</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -2,12 +2,8 @@</span>
<a href="#l30.4"></a><span id="l30.4"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l30.5"></a><span id="l30.5"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l30.6"></a><span id="l30.6"> </span>
<a href="#l30.7"></a><span id="l30.7"> JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l30.8"></a><span id="l30.8"> </span>
<a href="#l30.9"></a><span id="l30.9"> #DIRS += [</span>
<a href="#l30.10"></a><span id="l30.10"> #    'locale',</span>
<a href="#l30.11"></a><span id="l30.11"> #]</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-JS_PREFERENCE_FILES += [</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineminus">-    'prefs/openpgp-prefs.js',</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineminus">-]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mail/extensions/smime/jar.mn</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mail/extensions/smime/jar.mn</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1,18 +1,16 @@</span>
<a href="#l31.4"></a><span id="l31.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l31.5"></a><span id="l31.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l31.6"></a><span id="l31.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8"> messenger.jar:</span>
<a href="#l31.9"></a><span id="l31.9"> % content messenger-smime %content/messenger-smime/</span>
<a href="#l31.10"></a><span id="l31.10">    content/messenger-smime/msgCompSMIMEOverlay.js                   (content/msgCompSMIMEOverlay.js)</span>
<a href="#l31.11"></a><span id="l31.11">    content/messenger-smime/msgHdrViewSMIMEOverlay.js                (content/msgHdrViewSMIMEOverlay.js)</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-*  content/messenger/am-smime.xhtml                                 (../../../mailnews/extensions/smime/content/am-smime.xhtml)</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-   content/messenger/am-smime.js                                    (../../../mailnews/extensions/smime/content/am-smime.js)</span>
<a href="#l31.14"></a><span id="l31.14">    content/messenger/certpicker.js                                  (../../../mailnews/extensions/smime/content/certpicker.js)</span>
<a href="#l31.15"></a><span id="l31.15">    content/messenger/certpicker.xhtml                               (../../../mailnews/extensions/smime/content/certpicker.xhtml)</span>
<a href="#l31.16"></a><span id="l31.16">    content/messenger-smime/msgReadSMIMEOverlay.js                   (../../../mailnews/extensions/smime/content/msgReadSMIMEOverlay.js)</span>
<a href="#l31.17"></a><span id="l31.17">    content/messenger-smime/msgCompSecurityInfo.js                   (../../../mailnews/extensions/smime/content/msgCompSecurityInfo.js)</span>
<a href="#l31.18"></a><span id="l31.18">    content/messenger-smime/msgCompSecurityInfo.xhtml                (../../../mailnews/extensions/smime/content/msgCompSecurityInfo.xhtml)</span>
<a href="#l31.19"></a><span id="l31.19">    content/messenger-smime/msgReadSecurityInfo.xhtml                (../../../mailnews/extensions/smime/content/msgReadSecurityInfo.xhtml)</span>
<a href="#l31.20"></a><span id="l31.20">    content/messenger-smime/msgReadSecurityInfo.js                   (../../../mailnews/extensions/smime/content/msgReadSecurityInfo.js)</span>
<a href="#l31.21"></a><span id="l31.21">    content/messenger-smime/certFetchingStatus.xhtml                 (../../../mailnews/extensions/smime/content/certFetchingStatus.xhtml)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/installer/package-manifest.in</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/installer/package-manifest.in</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -272,17 +272,17 @@</span>
<a href="#l32.4"></a><span id="l32.4"> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<a href="#l32.5"></a><span id="l32.5"> </span>
<a href="#l32.6"></a><span id="l32.6"> ; default pref files</span>
<a href="#l32.7"></a><span id="l32.7"> @RESPATH@/defaults/pref/all-thunderbird.js</span>
<a href="#l32.8"></a><span id="l32.8"> @RESPATH@/defaults/pref/channel-prefs.js</span>
<a href="#l32.9"></a><span id="l32.9"> @RESPATH@/defaults/pref/composer.js</span>
<a href="#l32.10"></a><span id="l32.10"> @RESPATH@/defaults/pref/mailnews.js</span>
<a href="#l32.11"></a><span id="l32.11"> @RESPATH@/defaults/pref/mdn.js</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-@RESPATH@/defaults/pref/smime.js</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+@RESPATH@/defaults/pref/e2e-prefs.js</span>
<a href="#l32.14"></a><span id="l32.14"> @RESPATH@/defaults/pref/thunderbird-branding.js</span>
<a href="#l32.15"></a><span id="l32.15"> @RESPATH@/defaults/permissions</span>
<a href="#l32.16"></a><span id="l32.16"> @RESPATH@/defaults/settings/blocklists</span>
<a href="#l32.17"></a><span id="l32.17"> @RESPATH@/defaults/settings/pinning</span>
<a href="#l32.18"></a><span id="l32.18"> @RESPATH@/defaults/settings/main</span>
<a href="#l32.19"></a><span id="l32.19"> @RESPATH@/greprefs.js</span>
<a href="#l32.20"></a><span id="l32.20"> </span>
<a href="#l32.21"></a><span id="l32.21"> #ifdef MOZ_OPENPGP</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1">deleted file mode 100644</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger-smime/msgCompSMIMEOverlay.properties</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineplus">+++ /dev/null</span>
<a href="#l33.4"></a><span id="l33.4" class="difflineat">@@ -1,6 +0,0 @@</span>
<a href="#l33.5"></a><span id="l33.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.6"></a><span id="l33.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l33.7"></a><span id="l33.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l33.8"></a><span id="l33.8" class="difflineminus">-</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineminus">-## S/MIME mail compose window error strings.</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineminus">-NeedSetup=You need to set up one or more personal certificates before you can use this security feature. Would you like to do so now?</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1">new file mode 100644</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineminus">--- /dev/null</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/am-e2e.properties</span>
<a href="#l34.4"></a><span id="l34.4" class="difflineat">@@ -0,0 +1,5 @@</span>
<a href="#l34.5"></a><span id="l34.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.6"></a><span id="l34.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.7"></a><span id="l34.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l34.8"></a><span id="l34.8" class="difflineplus">+</span>
<a href="#l34.9"></a><span id="l34.9" class="difflineplus">+prefPanel-e2e=End-To-End Encryption</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/am-smime.dtd</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/am-smime.dtd</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,37 +1,57 @@</span>
<a href="#l35.4"></a><span id="l35.4"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.6"></a><span id="l35.6">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8" class="difflineminus">-&lt;!ENTITY securityTitle.label &quot;Security&quot;&gt;</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineminus">-&lt;!ENTITY securityTab.label &quot;Security&quot;&gt;</span>
<a href="#l35.10"></a><span id="l35.10" class="difflineminus">-&lt;!ENTITY securityHeading.label &quot;To send and receive signed or encrypted messages, you should specify both a digital signing certificate and an encryption certificate.&quot;&gt;</span>
<a href="#l35.11"></a><span id="l35.11" class="difflineminus">-&lt;!ENTITY encryptionGroupTitle.label &quot;Encryption&quot;&gt;</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-&lt;!ENTITY encryptionChoiceLabel.label &quot;Default encryption setting when sending messages:&quot;&gt;</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-&lt;!ENTITY neverEncrypt.label &quot;Never (do not use encryption)&quot;&gt;</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineminus">-&lt;!ENTITY neverEncrypt.accesskey &quot;N&quot;&gt;</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineminus">-&lt;!ENTITY alwaysEncryptMessage.label &quot;Required (can't send message unless all recipients have certificates)&quot;&gt;</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineminus">-&lt;!ENTITY alwaysEncryptMessage.accesskey &quot;u&quot;&gt;</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineminus">-&lt;!ENTITY encryptionCert.message &quot;Use this certificate to encrypt &amp;amp; decrypt messages sent to you:&quot;&gt;</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineplus">+&lt;!ENTITY e2eTitle.label &quot;End-To-End Encryption&quot;&gt;</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineplus">+&lt;!ENTITY e2eIntro.description &quot;To send encrypted or digitally signed messages, you need to configure an encryption technology, either OpenPGP or S/MIME.&quot;&gt;</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineplus">+&lt;!ENTITY e2eLearnMore.label &quot;Learn more&quot;&gt;</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineplus">+</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineplus">+&lt;!ENTITY e2eEnc.description &quot;Without end-to-end encryption the contents of messages are easily exposed to your email provider and to mass surveillance.&quot;&gt;</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineplus">+&lt;!ENTITY e2eeReqWarning.description &quot;If you require encryption, to send a message you must have the public key or certificate of every recipient.&quot;&gt;</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineplus">+</span>
<a href="#l35.25"></a><span id="l35.25" class="difflineplus">+&lt;!ENTITY e2eSigning.description &quot;A digital signature allows recipients to verify the message was sent by you, and that the content has not been changed.&quot;&gt;</span>
<a href="#l35.26"></a><span id="l35.26" class="difflineplus">+&lt;!ENTITY e2eTechPref.description &quot;Preferred encryption technology:&quot;&gt;</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineplus">+&lt;!ENTITY doNotEncrypt.label &quot;Do not enable encryption by default&quot;&gt;</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+&lt;!ENTITY doNotEncrypt.accesskey &quot;N&quot;&gt;</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+&lt;!ENTITY requireEncryptMessage.label &quot;Require encryption by default&quot;&gt;</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineplus">+&lt;!ENTITY requireEncryptMessage.accesskey &quot;u&quot;&gt;</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineplus">+&lt;!ENTITY encryptionCert2.message &quot;Personal certificate for encryption:&quot;&gt;</span>
<a href="#l35.33"></a><span id="l35.33"> &lt;!ENTITY digitalSign.certificate.button &quot;Select&quot;&gt;</span>
<a href="#l35.34"></a><span id="l35.34"> &lt;!ENTITY digitalSign.certificate.accesskey &quot;S&quot;&gt;</span>
<a href="#l35.35"></a><span id="l35.35"> &lt;!ENTITY digitalSign.certificate_clear.button &quot;Clear&quot;&gt;</span>
<a href="#l35.36"></a><span id="l35.36"> &lt;!ENTITY digitalSign.certificate_clear.accesskey &quot;C&quot;&gt;</span>
<a href="#l35.37"></a><span id="l35.37"> &lt;!ENTITY encryption.certificate.button &quot;Select&quot;&gt;</span>
<a href="#l35.38"></a><span id="l35.38"> &lt;!ENTITY encryption.certificate.accesskey &quot;t&quot;&gt;</span>
<a href="#l35.39"></a><span id="l35.39"> &lt;!ENTITY encryption.certificate_clear.button &quot;Clear&quot;&gt;</span>
<a href="#l35.40"></a><span id="l35.40"> &lt;!ENTITY encryption.certificate_clear.accesskey &quot;e&quot;&gt;</span>
<a href="#l35.41"></a><span id="l35.41"> &lt;!ENTITY signingGroupTitle.label &quot;Digital Signing&quot;&gt;</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineminus">-&lt;!ENTITY signMessage.label &quot;Digitally sign messages (by default)&quot;&gt;</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+&lt;!ENTITY signMessage2.label &quot;Add my digital signature by default&quot;&gt;</span>
<a href="#l35.44"></a><span id="l35.44"> &lt;!ENTITY signMessage.accesskey &quot;D&quot;&gt;</span>
<a href="#l35.45"></a><span id="l35.45" class="difflineminus">-&lt;!ENTITY signingCert.message &quot;Use this certificate to digitally sign messages you send:&quot;&gt;</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineplus">+&lt;!ENTITY signingCert2.message &quot;Personal certificate for digital signing:&quot;&gt;</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineplus">+</span>
<a href="#l35.48"></a><span id="l35.48" class="difflineplus">+&lt;!ENTITY sendingDefaults.label &quot;Default settings for sending messages&quot;&gt;</span>
<a href="#l35.49"></a><span id="l35.49" class="difflineplus">+</span>
<a href="#l35.50"></a><span id="l35.50" class="difflineplus">+&lt;!ENTITY technologyAutomatic.label &quot;Select automatically based on available keys or certificates&quot;&gt;</span>
<a href="#l35.51"></a><span id="l35.51"> </span>
<a href="#l35.52"></a><span id="l35.52" class="difflineminus">-&lt;!ENTITY certificates.label &quot;Certificates&quot;&gt;</span>
<a href="#l35.53"></a><span id="l35.53" class="difflineminus">-&lt;!ENTITY manageCerts2.label &quot;Manage Certificates&quot;&gt;</span>
<a href="#l35.54"></a><span id="l35.54" class="difflineminus">-&lt;!ENTITY manageCerts2.accesskey &quot;M&quot;&gt;</span>
<a href="#l35.55"></a><span id="l35.55" class="difflineminus">-&lt;!ENTITY manageDevices.label &quot;Security Devices&quot;&gt;</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineminus">-&lt;!ENTITY manageDevices.accesskey &quot;y&quot;&gt;</span>
<a href="#l35.57"></a><span id="l35.57" class="difflineplus">+&lt;!ENTITY certificates2.label &quot;S/MIME&quot;&gt;</span>
<a href="#l35.58"></a><span id="l35.58" class="difflineplus">+&lt;!ENTITY manageCerts3.label &quot;Manage S/MIME Certificates&quot;&gt;</span>
<a href="#l35.59"></a><span id="l35.59" class="difflineplus">+&lt;!ENTITY manageCerts3.accesskey &quot;M&quot;&gt;</span>
<a href="#l35.60"></a><span id="l35.60" class="difflineplus">+&lt;!ENTITY manageDevices2.label &quot;S/MIME Security Devices&quot;&gt;</span>
<a href="#l35.61"></a><span id="l35.61" class="difflineplus">+&lt;!ENTITY manageDevices2.accesskey &quot;y&quot;&gt;</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineplus">+</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineplus">+&lt;!ENTITY technologySMIME.label &quot;Prefer S/MIME&quot;&gt;</span>
<a href="#l35.64"></a><span id="l35.64" class="difflineplus">+&lt;!ENTITY technologyOpenPGP.label &quot;Prefer OpenPGP&quot;&gt;</span>
<a href="#l35.65"></a><span id="l35.65" class="difflineplus">+</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineplus">+&lt;!ENTITY openpgpKeys.label &quot;OpenPGP&quot;&gt;</span>
<a href="#l35.67"></a><span id="l35.67" class="difflineplus">+&lt;!ENTITY manageKeys.label &quot;Manage OpenPGP Keys&quot;&gt;</span>
<a href="#l35.68"></a><span id="l35.68" class="difflineplus">+&lt;!ENTITY manageKeys.accesskey &quot;K&quot;&gt;</span>
<a href="#l35.69"></a><span id="l35.69"> </span>
<a href="#l35.70"></a><span id="l35.70"> &lt;!-- Strings for the cert picker dialog --&gt;</span>
<a href="#l35.71"></a><span id="l35.71"> &lt;!ENTITY certPicker.title &quot;Select Certificate&quot;&gt;</span>
<a href="#l35.72"></a><span id="l35.72"> &lt;!ENTITY certPicker.info  &quot;Certificate:&quot;&gt;</span>
<a href="#l35.73"></a><span id="l35.73"> &lt;!ENTITY certPicker.detailsLabel &quot;Details of selected certificate:&quot;&gt;</span>
<a href="#l35.74"></a><span id="l35.74" class="difflineplus">+</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineplus">+&lt;!ENTITY openpgpKey.message &quot;Personal key for encryption and digital signing:&quot;&gt;</span>
<a href="#l35.76"></a><span id="l35.76" class="difflineplus">+&lt;!ENTITY openpgpKey.button &quot;Set Personal Key&quot;&gt;</span>
<a href="#l35.77"></a><span id="l35.77" class="difflineplus">+&lt;!ENTITY openpgpKey.accesskey &quot;o&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/am-smime.properties</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/am-smime.properties</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -6,17 +6,16 @@</span>
<a href="#l36.4"></a><span id="l36.4"> ## Note to localization: %S is a placeholder</span>
<a href="#l36.5"></a><span id="l36.5"> NoSenderSigningCert=You specified that this message should be digitally signed, but the application either failed to find the signing certificate specified in your Mail &amp; Newsgroup Account Settings, or the certificate has expired.</span>
<a href="#l36.6"></a><span id="l36.6"> NoSenderEncryptionCert=You specified encryption for this message, but the application either failed to find the encryption certificate specified in your Mail &amp; Newsgroup Account Settings, or the certificate has expired.</span>
<a href="#l36.7"></a><span id="l36.7"> MissingRecipientEncryptionCert=You specified encryption for this message, but the application failed to find an encryption certificate for %S.</span>
<a href="#l36.8"></a><span id="l36.8"> ErrorEncryptMail=Unable to encrypt message. Please check that you have a valid email certificate for each recipient. Please check that the certificates specified in Mail &amp; Newsgroups Account Settings for this mail account are valid and trusted for mail.</span>
<a href="#l36.9"></a><span id="l36.9"> ErrorCanNotSignMail=Unable to sign message. Please check that the certificates specified in Mail &amp; Newsgroups Account Settings for this mail account are valid and trusted for mail.</span>
<a href="#l36.10"></a><span id="l36.10"> </span>
<a href="#l36.11"></a><span id="l36.11"> ## Strings used for in the prefs.</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-prefPanel-smime=Security</span>
<a href="#l36.13"></a><span id="l36.13"> NoSigningCert=Certificate Manager can't locate a valid certificate that can be used to digitally sign your messages.</span>
<a href="#l36.14"></a><span id="l36.14"> NoSigningCertForThisAddress=Certificate Manager can't locate a valid certificate that can be used to digitally sign your messages with an address of &lt;%S&gt;.</span>
<a href="#l36.15"></a><span id="l36.15"> NoEncryptionCert=Certificate Manager can't locate a valid certificate that other people can use to send you encrypted email messages.</span>
<a href="#l36.16"></a><span id="l36.16"> NoEncryptionCertForThisAddress=Certificate Manager can't locate a valid certificate that other people can use to send you encrypted email messages to the address &lt;%S&gt;.</span>
<a href="#l36.17"></a><span id="l36.17"> </span>
<a href="#l36.18"></a><span id="l36.18"> encryption_needCertWantSame=You should also specify a certificate for other people to use when they send you encrypted messages. Do you want to use the same certificate to encrypt &amp; decrypt messages sent to you?</span>
<a href="#l36.19"></a><span id="l36.19"> encryption_wantSame=Do you want to use the same certificate to encrypt &amp; decrypt messages sent to you?</span>
<a href="#l36.20"></a><span id="l36.20"> encryption_needCertWantToSelect=You should also specify a certificate for other people to use when they send you encrypted messages. Do you want to configure an encryption certificate now?</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -70,16 +70,17 @@</span>
<a href="#l37.4"></a><span id="l37.4">   locale/@AB_CD@/messenger/am-identity-edit.dtd                         (%chrome/messenger/am-identity-edit.dtd)</span>
<a href="#l37.5"></a><span id="l37.5">   locale/@AB_CD@/messenger/am-im.dtd                                    (%chrome/messenger/am-im.dtd)</span>
<a href="#l37.6"></a><span id="l37.6">   locale/@AB_CD@/messenger/am-serverwithnoidentities.dtd                (%chrome/messenger/am-serverwithnoidentities.dtd)</span>
<a href="#l37.7"></a><span id="l37.7">   locale/@AB_CD@/messenger/am-junk.dtd                                  (%chrome/messenger/am-junk.dtd)</span>
<a href="#l37.8"></a><span id="l37.8">   locale/@AB_CD@/messenger/prefs.properties                             (%chrome/messenger/prefs.properties)</span>
<a href="#l37.9"></a><span id="l37.9">   locale/@AB_CD@/messenger/smtpEditOverlay.dtd                          (%chrome/messenger/smtpEditOverlay.dtd)</span>
<a href="#l37.10"></a><span id="l37.10">   locale/@AB_CD@/messenger/am-smime.dtd                                 (%chrome/messenger/am-smime.dtd)</span>
<a href="#l37.11"></a><span id="l37.11">   locale/@AB_CD@/messenger/am-smime.properties                          (%chrome/messenger/am-smime.properties)</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineplus">+  locale/@AB_CD@/messenger/am-e2e.properties                            (%chrome/messenger/am-e2e.properties)</span>
<a href="#l37.13"></a><span id="l37.13">   locale/@AB_CD@/messenger/removeAccount.dtd                            (%chrome/messenger/removeAccount.dtd)</span>
<a href="#l37.14"></a><span id="l37.14">   locale/@AB_CD@/messenger/removeAccount.properties                     (%chrome/messenger/removeAccount.properties)</span>
<a href="#l37.15"></a><span id="l37.15">   locale/@AB_CD@/messenger/messenger.properties                         (%chrome/messenger/messenger.properties)</span>
<a href="#l37.16"></a><span id="l37.16">   locale/@AB_CD@/messenger/newFolderDialog.dtd                          (%chrome/messenger/newFolderDialog.dtd)</span>
<a href="#l37.17"></a><span id="l37.17">   locale/@AB_CD@/messenger/newTagDialog.dtd                             (%chrome/messenger/newTagDialog.dtd)</span>
<a href="#l37.18"></a><span id="l37.18">   locale/@AB_CD@/messenger/renameFolderDialog.dtd                       (%chrome/messenger/renameFolderDialog.dtd)</span>
<a href="#l37.19"></a><span id="l37.19">   locale/@AB_CD@/messenger/folderpane.dtd                               (%chrome/messenger/folderpane.dtd)</span>
<a href="#l37.20"></a><span id="l37.20">   locale/@AB_CD@/messenger/folderProps.dtd                              (%chrome/messenger/folderProps.dtd)</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineat">@@ -236,17 +237,16 @@</span>
<a href="#l37.22"></a><span id="l37.22"> % locale messenger-mapi @AB_CD@ %locale/@AB_CD@/messenger-mapi/</span>
<a href="#l37.23"></a><span id="l37.23">   locale/@AB_CD@/messenger-mapi/mapi.properties                         (%chrome/messenger-mapi/mapi.properties)</span>
<a href="#l37.24"></a><span id="l37.24"> % locale messenger-newsblog @AB_CD@ %locale/@AB_CD@/messenger-newsblog/</span>
<a href="#l37.25"></a><span id="l37.25">   locale/@AB_CD@/messenger-newsblog/newsblog.properties                 (%chrome/messenger-newsblog/newsblog.properties)</span>
<a href="#l37.26"></a><span id="l37.26">   locale/@AB_CD@/messenger-newsblog/feed-subscriptions.dtd              (%chrome/messenger-newsblog/feed-subscriptions.dtd)</span>
<a href="#l37.27"></a><span id="l37.27">   locale/@AB_CD@/messenger-newsblog/am-newsblog.dtd                     (%chrome/messenger-newsblog/am-newsblog.dtd)</span>
<a href="#l37.28"></a><span id="l37.28"> % locale messenger-smime @AB_CD@ %locale/@AB_CD@/messenger-smime/</span>
<a href="#l37.29"></a><span id="l37.29">   locale/@AB_CD@/messenger-smime/msgCompSMIMEOverlay.dtd                (%chrome/messenger-smime/msgCompSMIMEOverlay.dtd)</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineminus">-  locale/@AB_CD@/messenger-smime/msgCompSMIMEOverlay.properties         (%chrome/messenger-smime/msgCompSMIMEOverlay.properties)</span>
<a href="#l37.31"></a><span id="l37.31">   locale/@AB_CD@/messenger-smime/msgReadSMIMEOverlay.dtd                (%chrome/messenger-smime/msgReadSMIMEOverlay.dtd)</span>
<a href="#l37.32"></a><span id="l37.32">   locale/@AB_CD@/messenger-smime/msgReadSMIMEOverlay.properties         (%chrome/messenger-smime/msgReadSMIMEOverlay.properties)</span>
<a href="#l37.33"></a><span id="l37.33">   locale/@AB_CD@/messenger-smime/msgCompSecurityInfo.dtd                (%chrome/messenger-smime/msgCompSecurityInfo.dtd)</span>
<a href="#l37.34"></a><span id="l37.34">   locale/@AB_CD@/messenger-smime/msgCompSecurityInfo.properties         (%chrome/messenger-smime/msgCompSecurityInfo.properties)</span>
<a href="#l37.35"></a><span id="l37.35">   locale/@AB_CD@/messenger-smime/msgReadSecurityInfo.dtd                (%chrome/messenger-smime/msgReadSecurityInfo.dtd)</span>
<a href="#l37.36"></a><span id="l37.36">   locale/@AB_CD@/messenger-smime/certFetchingStatus.dtd                 (%chrome/messenger-smime/certFetchingStatus.dtd)</span>
<a href="#l37.37"></a><span id="l37.37">   locale/@AB_CD@/messenger-smime/msgSecurityInfo.properties             (%chrome/messenger-smime/msgSecurityInfo.properties)</span>
<a href="#l37.38"></a><span id="l37.38"> % locale messenger-region @AB_CD@ %locale/@AB_CD@/messenger-region/</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-help.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-help.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -17,17 +17,17 @@</span>
<a href="#l38.4"></a><span id="l38.4"> var pageTagPairs = {</span>
<a href="#l38.5"></a><span id="l38.5">   &quot;chrome://messenger/content/am-main.xhtml&quot;: &quot;mail_account_identity&quot;,</span>
<a href="#l38.6"></a><span id="l38.6">   &quot;chrome://messenger/content/am-server.xhtml&quot;: &quot;mail&quot;,</span>
<a href="#l38.7"></a><span id="l38.7">   &quot;chrome://messenger/content/am-copies.xhtml&quot;: &quot;mail_copies&quot;,</span>
<a href="#l38.8"></a><span id="l38.8">   &quot;chrome://messenger/content/am-addressing.xhtml&quot;: &quot;mail_addressing_settings&quot;,</span>
<a href="#l38.9"></a><span id="l38.9">   &quot;chrome://messenger/content/am-junk.xhtml&quot;: &quot;mail-account-junk&quot;,</span>
<a href="#l38.10"></a><span id="l38.10">   &quot;chrome://messenger/content/am-offline.xhtml&quot;: &quot;mail-offline-accounts&quot;,</span>
<a href="#l38.11"></a><span id="l38.11">   &quot;chrome://messenger/content/am-smtp.xhtml&quot;: &quot;mail_smtp&quot;,</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-  &quot;chrome://messenger/content/am-smime.xhtml&quot;: &quot;mail_security_settings&quot;,</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+  &quot;chrome://messenger/content/am-e2e.xhtml&quot;: &quot;mail_security_settings&quot;,</span>
<a href="#l38.14"></a><span id="l38.14">   &quot;chrome://messenger/content/am-serverwithnoidentities.xhtml&quot;:</span>
<a href="#l38.15"></a><span id="l38.15">     &quot;mail_local_folders_settings&quot;,</span>
<a href="#l38.16"></a><span id="l38.16">   &quot;chrome://messenger/content/am-mdn.xhtml&quot;: &quot;mail-account-receipts&quot;,</span>
<a href="#l38.17"></a><span id="l38.17"> };</span>
<a href="#l38.18"></a><span id="l38.18"> </span>
<a href="#l38.19"></a><span id="l38.19"> function doHelpButton() {</span>
<a href="#l38.20"></a><span id="l38.20">   // Get the URI of the page loaded in the AccountManager's content frame.</span>
<a href="#l38.21"></a><span id="l38.21">   var pageSourceURI = top.frames.contentFrame.location.href;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-identity-edit.xhtml</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-identity-edit.xhtml</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -11,18 +11,18 @@</span>
<a href="#l39.4"></a><span id="l39.4"> &lt;!ENTITY % identityEditDTD SYSTEM &quot;chrome://messenger/locale/am-identity-edit.dtd&quot; &gt;</span>
<a href="#l39.5"></a><span id="l39.5"> %identityEditDTD;</span>
<a href="#l39.6"></a><span id="l39.6"> &lt;!ENTITY % identityDTD SYSTEM &quot;chrome://messenger/locale/am-main.dtd&quot; &gt;</span>
<a href="#l39.7"></a><span id="l39.7"> %identityDTD;</span>
<a href="#l39.8"></a><span id="l39.8"> &lt;!ENTITY % copiesDTD SYSTEM &quot;chrome://messenger/locale/am-copies.dtd&quot;&gt;</span>
<a href="#l39.9"></a><span id="l39.9"> %copiesDTD;</span>
<a href="#l39.10"></a><span id="l39.10"> &lt;!ENTITY % addressingDTD SYSTEM &quot;chrome://messenger/locale/am-addressing.dtd&quot; &gt;</span>
<a href="#l39.11"></a><span id="l39.11"> %addressingDTD;</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-&lt;!ENTITY % smimeDTD SYSTEM &quot;chrome://messenger/locale/am-smime.dtd&quot; &gt;</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineminus">-%smimeDTD;</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+&lt;!ENTITY % e2eDTD SYSTEM &quot;chrome://messenger/locale/am-smime.dtd&quot; &gt;</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineplus">+%e2eDTD;</span>
<a href="#l39.16"></a><span id="l39.16"> ]&gt;</span>
<a href="#l39.17"></a><span id="l39.17"> </span>
<a href="#l39.18"></a><span id="l39.18"> &lt;window xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l39.19"></a><span id="l39.19">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l39.20"></a><span id="l39.20">         onload=&quot;onLoadIdentityProperties();&quot;</span>
<a href="#l39.21"></a><span id="l39.21">         style=&quot;width: 75ch; height: 56em;&quot;&gt;</span>
<a href="#l39.22"></a><span id="l39.22"> &lt;dialog id=&quot;identityDialog&quot;&gt;</span>
<a href="#l39.23"></a><span id="l39.23">   &lt;stringbundle id=&quot;bundle_prefs&quot;</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineat">@@ -32,32 +32,32 @@</span>
<a href="#l39.25"></a><span id="l39.25"> </span>
<a href="#l39.26"></a><span id="l39.26">   &lt;script src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l39.27"></a><span id="l39.27">   &lt;script src=&quot;chrome://global/content/editMenuOverlay.js&quot;/&gt;</span>
<a href="#l39.28"></a><span id="l39.28">   &lt;script src=&quot;chrome://messenger/content/am-prefs.js&quot;/&gt;</span>
<a href="#l39.29"></a><span id="l39.29">   &lt;script src=&quot;chrome://messenger/content/am-identity-edit.js&quot;/&gt;</span>
<a href="#l39.30"></a><span id="l39.30">   &lt;script src=&quot;chrome://messenger/content/amUtils.js&quot;/&gt;</span>
<a href="#l39.31"></a><span id="l39.31">   &lt;script src=&quot;chrome://messenger/content/am-copies.js&quot;/&gt;</span>
<a href="#l39.32"></a><span id="l39.32">   &lt;script src=&quot;chrome://messenger/content/am-addressing.js&quot;/&gt;</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineminus">-  &lt;script src=&quot;chrome://messenger/content/am-smime.js&quot;/&gt;</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+  &lt;script src=&quot;chrome://messenger/content/am-e2e.js&quot;/&gt;</span>
<a href="#l39.35"></a><span id="l39.35">   &lt;script&gt;</span>
<a href="#l39.36"></a><span id="l39.36">   &lt;![CDATA[</span>
<a href="#l39.37"></a><span id="l39.37" class="difflineminus">-    window.addEventListener(&quot;load&quot;, smimeOnLoadEditor, false);</span>
<a href="#l39.38"></a><span id="l39.38" class="difflineplus">+    window.addEventListener(&quot;load&quot;, e2eOnLoadEditor, false);</span>
<a href="#l39.39"></a><span id="l39.39">   ]]&gt;</span>
<a href="#l39.40"></a><span id="l39.40">   &lt;/script&gt;</span>
<a href="#l39.41"></a><span id="l39.41"> </span>
<a href="#l39.42"></a><span id="l39.42">   &lt;description&gt;&amp;identityListDesc.label;&lt;/description&gt;</span>
<a href="#l39.43"></a><span id="l39.43">   &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l39.44"></a><span id="l39.44"> </span>
<a href="#l39.45"></a><span id="l39.45">   &lt;tabbox flex=&quot;1&quot; style=&quot;overflow: auto;&quot;&gt;</span>
<a href="#l39.46"></a><span id="l39.46">     &lt;tabs id=&quot;identitySettings&quot;&gt;</span>
<a href="#l39.47"></a><span id="l39.47">       &lt;tab label=&quot;&amp;settingsTab.label;&quot;/&gt;</span>
<a href="#l39.48"></a><span id="l39.48">       &lt;tab label=&quot;&amp;copiesFoldersTab.label;&quot;/&gt;</span>
<a href="#l39.49"></a><span id="l39.49">       &lt;tab label=&quot;&amp;addressingTab.label;&quot;/&gt;</span>
<a href="#l39.50"></a><span id="l39.50" class="difflineminus">-      &lt;tab label=&quot;&amp;securityTab.label;&quot;/&gt;</span>
<a href="#l39.51"></a><span id="l39.51" class="difflineplus">+      &lt;tab label=&quot;&amp;e2eTitle.label;&quot;/&gt;</span>
<a href="#l39.52"></a><span id="l39.52">     &lt;/tabs&gt;</span>
<a href="#l39.53"></a><span id="l39.53"> </span>
<a href="#l39.54"></a><span id="l39.54">     &lt;tabpanels id=&quot;identityTabsPanels&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l39.55"></a><span id="l39.55">       &lt;!-- Identity Settings Tab --&gt;</span>
<a href="#l39.56"></a><span id="l39.56">       &lt;vbox flex=&quot;1&quot; name=&quot;settings&quot;&gt;</span>
<a href="#l39.57"></a><span id="l39.57">         &lt;html:fieldset&gt;</span>
<a href="#l39.58"></a><span id="l39.58">           &lt;html:legend&gt;&amp;publicData.label;&lt;/html:legend&gt;</span>
<a href="#l39.59"></a><span id="l39.59">           &lt;html:table class=&quot;identity-table&quot;&gt;</span>
<a href="#l39.60"></a><span id="l39.60" class="difflineat">@@ -205,14 +205,14 @@</span>
<a href="#l39.61"></a><span id="l39.61"> </span>
<a href="#l39.62"></a><span id="l39.62">       &lt;!-- Copies &amp; Folders Tab --&gt;</span>
<a href="#l39.63"></a><span id="l39.63"> #include am-copies.inc.xhtml</span>
<a href="#l39.64"></a><span id="l39.64"> </span>
<a href="#l39.65"></a><span id="l39.65">       &lt;!-- Composition &amp; Addressing Tab --&gt;</span>
<a href="#l39.66"></a><span id="l39.66"> #include am-addressing.inc.xhtml</span>
<a href="#l39.67"></a><span id="l39.67"> </span>
<a href="#l39.68"></a><span id="l39.68">       &lt;!-- Security Tab --&gt;</span>
<a href="#l39.69"></a><span id="l39.69" class="difflineminus">-#include ../../../extensions/smime/content/am-smime.inc.xhtml</span>
<a href="#l39.70"></a><span id="l39.70" class="difflineplus">+#include ../../../../mail/extensions/am-e2e/am-e2e.inc.xhtml</span>
<a href="#l39.71"></a><span id="l39.71"> </span>
<a href="#l39.72"></a><span id="l39.72">     &lt;/tabpanels&gt;</span>
<a href="#l39.73"></a><span id="l39.73">   &lt;/tabbox&gt;</span>
<a href="#l39.74"></a><span id="l39.74"> &lt;/dialog&gt;</span>
<a href="#l39.75"></a><span id="l39.75"> &lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mailnews/extensions/smime/content/certpicker.xhtml</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/certpicker.xhtml</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -1,18 +1,18 @@</span>
<a href="#l40.4"></a><span id="l40.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l40.5"></a><span id="l40.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l40.6"></a><span id="l40.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l40.7"></a><span id="l40.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l40.8"></a><span id="l40.8"> </span>
<a href="#l40.9"></a><span id="l40.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l40.10"></a><span id="l40.10"> </span>
<a href="#l40.11"></a><span id="l40.11"> &lt;!DOCTYPE window [</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-&lt;!ENTITY % amSMIMEDTD SYSTEM &quot;chrome://messenger/locale/am-smime.dtd&quot; &gt;</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineminus">-%amSMIMEDTD;</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineplus">+&lt;!ENTITY % amE2EDTD SYSTEM &quot;chrome://messenger/locale/am-smime.dtd&quot; &gt;</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+%amE2EDTD;</span>
<a href="#l40.16"></a><span id="l40.16"> ]&gt;</span>
<a href="#l40.17"></a><span id="l40.17"> </span>
<a href="#l40.18"></a><span id="l40.18"> &lt;window title=&quot;&amp;certPicker.title;&quot;</span>
<a href="#l40.19"></a><span id="l40.19">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l40.20"></a><span id="l40.20">         xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l40.21"></a><span id="l40.21">         style=&quot;width: 50em;&quot;</span>
<a href="#l40.22"></a><span id="l40.22">         onload=&quot;onLoad();&quot;&gt;</span>
<a href="#l40.23"></a><span id="l40.23"> &lt;dialog id=&quot;certPicker&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1">deleted file mode 100644</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineminus">--- a/mailnews/extensions/smime/content/smime.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineplus">+++ /dev/null</span>
<a href="#l41.4"></a><span id="l41.4" class="difflineat">@@ -1,12 +0,0 @@</span>
<a href="#l41.5"></a><span id="l41.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l41.6"></a><span id="l41.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l41.7"></a><span id="l41.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l41.8"></a><span id="l41.8" class="difflineminus">-</span>
<a href="#l41.9"></a><span id="l41.9" class="difflineminus">-/*</span>
<a href="#l41.10"></a><span id="l41.10" class="difflineminus">-   Add any default pref values we want for smime</span>
<a href="#l41.11"></a><span id="l41.11" class="difflineminus">-*/</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineminus">-pref(&quot;mail.identity.default.encryption_cert_name&quot;, &quot;&quot;);</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineminus">-pref(&quot;mail.identity.default.encryptionpolicy&quot;, 0);</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineminus">-pref(&quot;mail.identity.default.signing_cert_name&quot;, &quot;&quot;);</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-pref(&quot;mail.identity.default.sign_mail&quot;, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mailnews/extensions/smime/moz.build</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mailnews/extensions/smime/moz.build</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -3,11 +3,8 @@</span>
<a href="#l42.4"></a><span id="l42.4"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l42.5"></a><span id="l42.5"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l42.6"></a><span id="l42.6"> </span>
<a href="#l42.7"></a><span id="l42.7"> DIRS += [</span>
<a href="#l42.8"></a><span id="l42.8">     'public',</span>
<a href="#l42.9"></a><span id="l42.9">     'src',</span>
<a href="#l42.10"></a><span id="l42.10"> ]</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-JS_PREFERENCE_FILES += [</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-    'content/smime.js',</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineminus">-]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mailnews/extensions/smime/src/moz.build</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mailnews/extensions/smime/src/moz.build</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -5,22 +5,14 @@</span>
<a href="#l43.4"></a><span id="l43.4"> </span>
<a href="#l43.5"></a><span id="l43.5"> SOURCES += [</span>
<a href="#l43.6"></a><span id="l43.6">     'nsCertPicker.cpp',</span>
<a href="#l43.7"></a><span id="l43.7">     'nsEncryptedSMIMEURIsService.cpp',</span>
<a href="#l43.8"></a><span id="l43.8">     'nsMsgComposeSecure.cpp',</span>
<a href="#l43.9"></a><span id="l43.9">     'nsSMimeJSHelper.cpp',</span>
<a href="#l43.10"></a><span id="l43.10"> ]</span>
<a href="#l43.11"></a><span id="l43.11"> </span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-EXTRA_JS_MODULES += [</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineminus">-    'SMIMEService.jsm',</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineminus">-]</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineminus">-</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineminus">-XPCOM_MANIFESTS += [</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineminus">-    'components.conf',</span>
<a href="#l43.18"></a><span id="l43.18" class="difflineminus">-]</span>
<a href="#l43.19"></a><span id="l43.19" class="difflineminus">-</span>
<a href="#l43.20"></a><span id="l43.20"> FINAL_LIBRARY = 'mail'</span>
<a href="#l43.21"></a><span id="l43.21"> </span>
<a href="#l43.22"></a><span id="l43.22"> LOCAL_INCLUDES += [</span>
<a href="#l43.23"></a><span id="l43.23">     '/%s/security/manager/pki' % CONFIG['mozreltopsrcdir'],</span>
<a href="#l43.24"></a><span id="l43.24">     '/%s/security/manager/ssl' % CONFIG['mozreltopsrcdir']</span>
<a href="#l43.25"></a><span id="l43.25"> ]</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

