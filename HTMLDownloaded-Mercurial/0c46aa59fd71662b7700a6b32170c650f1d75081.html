<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 13431:0c46aa59fd71662b7700a6b32170c650f1d75081</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 0c46aa59fd71662b7700a6b32170c650f1d75081" />
<meta property="og:url" content="/comm-central/rev/0c46aa59fd71662b7700a6b32170c650f1d75081" />
<meta property="og:description" content="Bug 707489 - About Thunderbird dialog &quot;Check for Updates&quot; button disregards user prefs - available update(s) are downloaded and queued for installation. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 0c46aa59fd71662b7700a6b32170c650f1d75081 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/0c46aa59fd71662b7700a6b32170c650f1d75081">shortlog</a> |
<a href="/comm-central/log/0c46aa59fd71662b7700a6b32170c650f1d75081">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/0c46aa59fd71662b7700a6b32170c650f1d75081">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/0c46aa59fd71662b7700a6b32170c650f1d75081">files</a> |
changeset |
<a href="/comm-central/raw-rev/0c46aa59fd71662b7700a6b32170c650f1d75081">raw</a>  | <a href="/comm-central/archive/0c46aa59fd71662b7700a6b32170c650f1d75081.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=707489">Bug 707489</a> - About Thunderbird dialog &quot;Check for Updates&quot; button disregards user prefs - available update(s) are downloaded and queued for installation. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#110;&#116;&#111;&#110;&#105;&#111;&#32;&#77;&#105;&#114;&#97;&#115;&#32;&#60;&#97;&#109;&#97;&#114;&#111;&#115;&#116;&#101;&#103;&#117;&#105;&#64;&#111;&#117;&#116;&#108;&#111;&#111;&#107;&#46;&#101;&#115;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 02 Jan 2014 15:38:34 -0500</td></tr>

<tr>
 <td>changeset 13431</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/0c46aa59fd71662b7700a6b32170c650f1d75081">0c46aa59fd71662b7700a6b32170c650f1d75081</a></td>
</tr>



<tr>
<td>parent 13430</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/15eac4288d80d669d8db2763b018f30767feceb9">15eac4288d80d669d8db2763b018f30767feceb9</a>
</td>
</tr>

<tr>
<td>child 13432</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e85ea148b04d62c08c29ebd814f712e58a9cca6c">e85ea148b04d62c08c29ebd814f712e58a9cca6c</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=0c46aa59fd71662b7700a6b32170c650f1d75081">9748</a></td></tr>
<tr><td>push user</td><td>ryanvm@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 02 Jan 2014 20:45:55 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@f0958a2158b8 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f0958a2158b8b89a3ff4379a527787889ffae13f">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f0958a2158b8b89a3ff4379a527787889ffae13f&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f0958a2158b8b89a3ff4379a527787889ffae13f&newProject=comm-central&newRevision=0c46aa59fd71662b7700a6b32170c650f1d75081&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f0958a2158b8b89a3ff4379a527787889ffae13f&newProject=comm-central&newRevision=0c46aa59fd71662b7700a6b32170c650f1d75081&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f0958a2158b8b89a3ff4379a527787889ffae13f&newProject=comm-central&newRevision=0c46aa59fd71662b7700a6b32170c650f1d75081&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=707489">707489</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=707489">Bug 707489</a> - About Thunderbird dialog &quot;Check for Updates&quot; button disregards user prefs - available update(s) are downloaded and queued for installation. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.js">mail/base/content/aboutDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.js">file</a> |
<a href="/comm-central/annotate/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.js">annotate</a> |
<a href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.js">diff</a> |
<a href="/comm-central/comparison/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.js">comparison</a> |
<a href="/comm-central/log/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.xul">mail/base/content/aboutDialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.xul">file</a> |
<a href="/comm-central/annotate/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.xul">annotate</a> |
<a href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.xul">diff</a> |
<a href="/comm-central/comparison/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.xul">comparison</a> |
<a href="/comm-central/log/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/base/content/aboutDialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/aboutDialog.dtd">mail/locales/en-US/chrome/messenger/aboutDialog.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/aboutDialog.dtd">file</a> |
<a href="/comm-central/annotate/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/aboutDialog.dtd">annotate</a> |
<a href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/aboutDialog.dtd">diff</a> |
<a href="/comm-central/comparison/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/aboutDialog.dtd">comparison</a> |
<a href="/comm-central/log/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/aboutDialog.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/messenger.properties">mail/locales/en-US/chrome/messenger/messenger.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/messenger.properties">file</a> |
<a href="/comm-central/annotate/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/messenger.properties">annotate</a> |
<a href="/comm-central/diff/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/messenger.properties">diff</a> |
<a href="/comm-central/comparison/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/messenger.properties">comparison</a> |
<a href="/comm-central/log/0c46aa59fd71662b7700a6b32170c650f1d75081/mail/locales/en-US/chrome/messenger/messenger.properties">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/aboutDialog.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/aboutDialog.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -122,55 +122,52 @@ function appUpdater()</span>
<a href="#l1.4"></a><span id="l1.4">                                      &quot;nsIUpdateChecker&quot;);</span>
<a href="#l1.5"></a><span id="l1.5">   XPCOMUtils.defineLazyServiceGetter(this, &quot;um&quot;,</span>
<a href="#l1.6"></a><span id="l1.6">                                      &quot;@mozilla.org/updates/update-manager;1&quot;,</span>
<a href="#l1.7"></a><span id="l1.7">                                      &quot;nsIUpdateManager&quot;);</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">   this.bundle = Services.strings.</span>
<a href="#l1.10"></a><span id="l1.10">                 createBundle(&quot;chrome://messenger/locale/messenger.properties&quot;);</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-  this.updateBtn = document.getElementById(&quot;updateButton&quot;);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-  // The button label value must be set so its height is correct.</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-  this.setupUpdateButton(&quot;update.checkInsideButton&quot;);</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-</span>
<a href="#l1.17"></a><span id="l1.17">   let manualURL = Services.urlFormatter.formatURLPref(&quot;app.update.url.manual&quot;);</span>
<a href="#l1.18"></a><span id="l1.18">   document.getElementById(&quot;manualLink&quot;)</span>
<a href="#l1.19"></a><span id="l1.19">           .setAttribute(&quot;onclick&quot;, 'openURL(&quot;' + manualURL + '&quot;);');</span>
<a href="#l1.20"></a><span id="l1.20">   document.getElementById(&quot;failedLink&quot;)</span>
<a href="#l1.21"></a><span id="l1.21">           .setAttribute(&quot;onclick&quot;, 'openURL(&quot;' + manualURL + '&quot;);');</span>
<a href="#l1.22"></a><span id="l1.22"> </span>
<a href="#l1.23"></a><span id="l1.23">   if (this.updateDisabledAndLocked) {</span>
<a href="#l1.24"></a><span id="l1.24">     this.selectPanel(&quot;adminDisabled&quot;);</span>
<a href="#l1.25"></a><span id="l1.25">     return;</span>
<a href="#l1.26"></a><span id="l1.26">   }</span>
<a href="#l1.27"></a><span id="l1.27"> </span>
<a href="#l1.28"></a><span id="l1.28" class="difflineminus">-  if (this.isPending) {</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-    this.setupUpdateButton(&quot;update.restart.&quot; +</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineminus">-                           (this.isMajor ? &quot;upgradeButton&quot; : &quot;updateButton&quot;));</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-    return;</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-  }</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-  if (this.isApplied) {</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-    this.setupUpdateButton(&quot;update.restart.&quot; +</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-                           (this.isMajor ? &quot;upgradeButton&quot; : &quot;restartButton&quot;));</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineplus">+  if (this.isPending || this.isApplied) {</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+    this.selectPanel(&quot;apply&quot;);</span>
<a href="#l1.39"></a><span id="l1.39">     return;</span>
<a href="#l1.40"></a><span id="l1.40">   }</span>
<a href="#l1.41"></a><span id="l1.41"> </span>
<a href="#l1.42"></a><span id="l1.42">   if (this.isDownloading) {</span>
<a href="#l1.43"></a><span id="l1.43">     this.startDownload();</span>
<a href="#l1.44"></a><span id="l1.44">     return;</span>
<a href="#l1.45"></a><span id="l1.45">   }</span>
<a href="#l1.46"></a><span id="l1.46"> </span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-  if (this.updateEnabled &amp;&amp; this.updateAuto) {</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineminus">-    this.selectPanel(&quot;checkingForUpdates&quot;);</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-    this.isChecking = true;</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-    this.checker.checkForUpdates(this.updateCheckListener, true);</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineplus">+  // Honor the &quot;Never check for updates&quot; option by not only disabling background</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineplus">+  // update checks, but also in the About dialog, by presenting a</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineplus">+  // &quot;Check for updates&quot; button.</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineplus">+  // If updates are found, the user is then asked if he wants to &quot;Update to &lt;version&gt;&quot;.</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineplus">+  if (!this.updateEnabled) {</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineplus">+    this.selectPanel(&quot;checkForUpdates&quot;);</span>
<a href="#l1.57"></a><span id="l1.57">     return;</span>
<a href="#l1.58"></a><span id="l1.58">   }</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineplus">+</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineplus">+  // That leaves the options</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineplus">+  // &quot;Check for updates, but let me choose whether to install them&quot;, and</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineplus">+  // &quot;Automatically install updates&quot;.</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineplus">+  // In both cases, we check for updates without asking.</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineplus">+  // In the &quot;let me choose&quot; case, we ask before downloading though, in onCheckComplete.</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineplus">+  this.checkForUpdates();</span>
<a href="#l1.66"></a><span id="l1.66"> }</span>
<a href="#l1.67"></a><span id="l1.67"> </span>
<a href="#l1.68"></a><span id="l1.68"> appUpdater.prototype =</span>
<a href="#l1.69"></a><span id="l1.69"> {</span>
<a href="#l1.70"></a><span id="l1.70">   // true when there is an update check in progress.</span>
<a href="#l1.71"></a><span id="l1.71">   isChecking: false,</span>
<a href="#l1.72"></a><span id="l1.72"> </span>
<a href="#l1.73"></a><span id="l1.73">   // true when there is an update already staged / ready to be applied.</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineat">@@ -197,23 +194,16 @@ appUpdater.prototype =</span>
<a href="#l1.75"></a><span id="l1.75">   // true when there is an update download in progress.</span>
<a href="#l1.76"></a><span id="l1.76">   get isDownloading() {</span>
<a href="#l1.77"></a><span id="l1.77">     if (this.update)</span>
<a href="#l1.78"></a><span id="l1.78">       return this.update.state == &quot;downloading&quot;;</span>
<a href="#l1.79"></a><span id="l1.79">     return this.um.activeUpdate &amp;&amp;</span>
<a href="#l1.80"></a><span id="l1.80">            this.um.activeUpdate.state == &quot;downloading&quot;;</span>
<a href="#l1.81"></a><span id="l1.81">   },</span>
<a href="#l1.82"></a><span id="l1.82"> </span>
<a href="#l1.83"></a><span id="l1.83" class="difflineminus">-  // true when the update type is major.</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineminus">-  get isMajor() {</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineminus">-    if (this.update)</span>
<a href="#l1.86"></a><span id="l1.86" class="difflineminus">-      return this.update.type == &quot;major&quot;;</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineminus">-    return this.um.activeUpdate.type == &quot;major&quot;;</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineminus">-  },</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineminus">-</span>
<a href="#l1.90"></a><span id="l1.90">   // true when updating is disabled by an administrator.</span>
<a href="#l1.91"></a><span id="l1.91">   get updateDisabledAndLocked() {</span>
<a href="#l1.92"></a><span id="l1.92">     return !this.updateEnabled &amp;&amp;</span>
<a href="#l1.93"></a><span id="l1.93">            Services.prefs.prefIsLocked(&quot;app.update.enabled&quot;);</span>
<a href="#l1.94"></a><span id="l1.94">   },</span>
<a href="#l1.95"></a><span id="l1.95"> </span>
<a href="#l1.96"></a><span id="l1.96">   // true when updating is enabled.</span>
<a href="#l1.97"></a><span id="l1.97">   get updateEnabled() {</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineat">@@ -235,46 +225,75 @@ appUpdater.prototype =</span>
<a href="#l1.99"></a><span id="l1.99">     try {</span>
<a href="#l1.100"></a><span id="l1.100">       return Services.prefs.getBoolPref(&quot;app.update.auto&quot;);</span>
<a href="#l1.101"></a><span id="l1.101">     }</span>
<a href="#l1.102"></a><span id="l1.102">     catch (e) { }</span>
<a href="#l1.103"></a><span id="l1.103">     return true; // Thunderbird default is true</span>
<a href="#l1.104"></a><span id="l1.104">   },</span>
<a href="#l1.105"></a><span id="l1.105"> </span>
<a href="#l1.106"></a><span id="l1.106">   /**</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineminus">-   * Sets the deck's selected panel.</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineplus">+   * Sets the panel of the updateDeck.</span>
<a href="#l1.109"></a><span id="l1.109">    *</span>
<a href="#l1.110"></a><span id="l1.110">    * @param  aChildID</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineminus">-   *         The id of the deck's child to select.</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineplus">+   *         The id of the deck's child to select, e.g. &quot;apply&quot;.</span>
<a href="#l1.113"></a><span id="l1.113">    */</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineplus">+</span>
<a href="#l1.115"></a><span id="l1.115">   selectPanel: function(aChildID) {</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineminus">-    this.updateDeck.selectedPanel = document.getElementById(aChildID);</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-    this.updateBtn.disabled = (aChildID != &quot;updateButtonBox&quot;);</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineplus">+    let panel = document.getElementById(aChildID);</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineplus">+</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineplus">+    if (panel.firstChild.localName == &quot;button&quot;) {</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineplus">+      let button = panel.firstChild;</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineplus">+      if (aChildID == &quot;downloadAndInstall&quot;) {</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineplus">+        let updateVersion = gAppUpdater.update.displayVersion;</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineplus">+        button.label = this.bundle.formatStringFromName(&quot;update.downloadAndInstallButton.label&quot;, [updateVersion], 1);</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineplus">+        button.accessKey = this.bundle.GetStringFromName(&quot;update.downloadAndInstallButton.accesskey&quot;);</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineplus">+      }</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineplus">+      this.updateDeck.selectedPanel = panel;</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+      if (!document.commandDispatcher.focusedElement || // don't steal the focus</span>
<a href="#l1.129"></a><span id="l1.129" class="difflineplus">+          document.commandDispatcher.focusedElement.localName == &quot;button&quot;) // except from the other buttons</span>
<a href="#l1.130"></a><span id="l1.130" class="difflineplus">+        button.focus();</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineplus">+</span>
<a href="#l1.132"></a><span id="l1.132" class="difflineplus">+    } else {</span>
<a href="#l1.133"></a><span id="l1.133" class="difflineplus">+      this.updateDeck.selectedPanel = panel;</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineplus">+    }</span>
<a href="#l1.135"></a><span id="l1.135">   },</span>
<a href="#l1.136"></a><span id="l1.136"> </span>
<a href="#l1.137"></a><span id="l1.137">   /**</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineminus">-   * Sets the update button's label and accesskey.</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineminus">-   *</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineminus">-   * @param  aKeyPrefix</span>
<a href="#l1.141"></a><span id="l1.141" class="difflineminus">-   *         The prefix for the properties file entry to use for setting the</span>
<a href="#l1.142"></a><span id="l1.142" class="difflineminus">-   *         label and accesskey.</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineplus">+   * Check for updates</span>
<a href="#l1.144"></a><span id="l1.144">    */</span>
<a href="#l1.145"></a><span id="l1.145" class="difflineminus">-  setupUpdateButton: function(aKeyPrefix) {</span>
<a href="#l1.146"></a><span id="l1.146" class="difflineminus">-    this.updateBtn.label = this.bundle.GetStringFromName(aKeyPrefix + &quot;.label&quot;);</span>
<a href="#l1.147"></a><span id="l1.147" class="difflineminus">-    this.updateBtn.accessKey = this.bundle.GetStringFromName(aKeyPrefix + &quot;.accesskey&quot;);</span>
<a href="#l1.148"></a><span id="l1.148" class="difflineminus">-    if (!document.commandDispatcher.focusedElement ||</span>
<a href="#l1.149"></a><span id="l1.149" class="difflineminus">-        document.commandDispatcher.focusedElement == this.updateBtn)</span>
<a href="#l1.150"></a><span id="l1.150" class="difflineminus">-      this.updateBtn.focus();</span>
<a href="#l1.151"></a><span id="l1.151" class="difflineplus">+  checkForUpdates: function() {</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineplus">+    this.selectPanel(&quot;checkingForUpdates&quot;);</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineplus">+    this.isChecking = true;</span>
<a href="#l1.154"></a><span id="l1.154" class="difflineplus">+    this.checker.checkForUpdates(this.updateCheckListener, true);</span>
<a href="#l1.155"></a><span id="l1.155" class="difflineplus">+    // after checking, onCheckComplete() is called</span>
<a href="#l1.156"></a><span id="l1.156">   },</span>
<a href="#l1.157"></a><span id="l1.157"> </span>
<a href="#l1.158"></a><span id="l1.158">   /**</span>
<a href="#l1.159"></a><span id="l1.159" class="difflineminus">-   * Handles oncommand for the update button.</span>
<a href="#l1.160"></a><span id="l1.160" class="difflineplus">+   * Check for addon compat, or start the download right away</span>
<a href="#l1.161"></a><span id="l1.161">    */</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineminus">-  buttonOnCommand: function() {</span>
<a href="#l1.163"></a><span id="l1.163" class="difflineminus">-    if (this.isPending || this.isApplied) {</span>
<a href="#l1.164"></a><span id="l1.164" class="difflineplus">+  doUpdate: function() {</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineplus">+    // skip the compatibility check if the update doesn't provide appVersion,</span>
<a href="#l1.166"></a><span id="l1.166" class="difflineplus">+    // or the appVersion is unchanged, e.g. nightly update</span>
<a href="#l1.167"></a><span id="l1.167" class="difflineplus">+    if (!this.update.appVersion ||</span>
<a href="#l1.168"></a><span id="l1.168" class="difflineplus">+        Services.vc.compare(gAppUpdater.update.appVersion,</span>
<a href="#l1.169"></a><span id="l1.169" class="difflineplus">+                            Services.appinfo.version) == 0) {</span>
<a href="#l1.170"></a><span id="l1.170" class="difflineplus">+      this.startDownload();</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineplus">+    } else {</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineplus">+      this.checkAddonCompatibility();</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineplus">+    }</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineplus">+  },</span>
<a href="#l1.175"></a><span id="l1.175" class="difflineplus">+</span>
<a href="#l1.176"></a><span id="l1.176" class="difflineplus">+  /**</span>
<a href="#l1.177"></a><span id="l1.177" class="difflineplus">+   * Handles oncommand for the &quot;Restart to Update&quot; button</span>
<a href="#l1.178"></a><span id="l1.178" class="difflineplus">+   * which is presented after the download has been downloaded.</span>
<a href="#l1.179"></a><span id="l1.179" class="difflineplus">+   */</span>
<a href="#l1.180"></a><span id="l1.180" class="difflineplus">+  buttonRestartAfterDownload: function() {</span>
<a href="#l1.181"></a><span id="l1.181" class="difflineplus">+    if (!this.isPending &amp;&amp; !this.isApplied)</span>
<a href="#l1.182"></a><span id="l1.182" class="difflineplus">+      return;</span>
<a href="#l1.183"></a><span id="l1.183" class="difflineplus">+</span>
<a href="#l1.184"></a><span id="l1.184">       // Notify all windows that an application quit has been requested.</span>
<a href="#l1.185"></a><span id="l1.185">       let cancelQuit = Components.classes[&quot;@mozilla.org/supports-PRBool;1&quot;].</span>
<a href="#l1.186"></a><span id="l1.186">                        createInstance(Components.interfaces.nsISupportsPRBool);</span>
<a href="#l1.187"></a><span id="l1.187">       Services.obs.notifyObservers(cancelQuit, &quot;quit-application-requested&quot;, &quot;restart&quot;);</span>
<a href="#l1.188"></a><span id="l1.188"> </span>
<a href="#l1.189"></a><span id="l1.189">       // Something aborted the quit process.</span>
<a href="#l1.190"></a><span id="l1.190">       if (cancelQuit.data)</span>
<a href="#l1.191"></a><span id="l1.191">         return;</span>
<a href="#l1.192"></a><span id="l1.192" class="difflineat">@@ -283,35 +302,29 @@ appUpdater.prototype =</span>
<a href="#l1.193"></a><span id="l1.193">       if (Services.appinfo.inSafeMode) {</span>
<a href="#l1.194"></a><span id="l1.194">         let env = Components.classes[&quot;@mozilla.org/process/environment;1&quot;].</span>
<a href="#l1.195"></a><span id="l1.195">                   getService(Components.interfaces.nsIEnvironment);</span>
<a href="#l1.196"></a><span id="l1.196">         env.set(&quot;MOZ_SAFE_MODE_RESTART&quot;, &quot;1&quot;);</span>
<a href="#l1.197"></a><span id="l1.197">       }</span>
<a href="#l1.198"></a><span id="l1.198"> </span>
<a href="#l1.199"></a><span id="l1.199">       Services.startup.quit(Components.interfaces.nsIAppStartup.eAttemptQuit |</span>
<a href="#l1.200"></a><span id="l1.200">                             Components.interfaces.nsIAppStartup.eRestart);</span>
<a href="#l1.201"></a><span id="l1.201" class="difflineminus">-      return;</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineminus">-    }</span>
<a href="#l1.203"></a><span id="l1.203" class="difflineplus">+    },</span>
<a href="#l1.204"></a><span id="l1.204"> </span>
<a href="#l1.205"></a><span id="l1.205" class="difflineplus">+  /**</span>
<a href="#l1.206"></a><span id="l1.206" class="difflineplus">+   * Handles oncommand for the &quot;Apply Update…&quot; button</span>
<a href="#l1.207"></a><span id="l1.207" class="difflineplus">+   * which is presented if we need to show the billboard or license.</span>
<a href="#l1.208"></a><span id="l1.208" class="difflineplus">+   */</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+  buttonApplyBillboard: function() {</span>
<a href="#l1.210"></a><span id="l1.210">     const URI_UPDATE_PROMPT_DIALOG = &quot;chrome://mozapps/content/update/updates.xul&quot;;</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineminus">-    // Thunderbird no longer displays a license for updates and the licenseURL check</span>
<a href="#l1.212"></a><span id="l1.212" class="difflineminus">-    // is just in case a distibution does.</span>
<a href="#l1.213"></a><span id="l1.213" class="difflineminus">-    if (this.update &amp;&amp; (this.update.billboardURL || this.update.licenseURL ||</span>
<a href="#l1.214"></a><span id="l1.214" class="difflineminus">-        this.addons.length != 0)) {</span>
<a href="#l1.215"></a><span id="l1.215" class="difflineminus">-      var ary = toXPCOMArray([this.update],</span>
<a href="#l1.216"></a><span id="l1.216" class="difflineminus">-        Components.interfaces.nsIMutableArray);</span>
<a href="#l1.217"></a><span id="l1.217" class="difflineminus">-      var openFeatures = &quot;chrome,centerscreen,dialog=no,resizable=no,titlebar,toolbar=no&quot;;</span>
<a href="#l1.218"></a><span id="l1.218" class="difflineminus">-      Services.ww.openWindow(null, URI_UPDATE_PROMPT_DIALOG, &quot;&quot;, openFeatures, ary);</span>
<a href="#l1.219"></a><span id="l1.219" class="difflineminus">-      window.close();</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineminus">-      return;</span>
<a href="#l1.221"></a><span id="l1.221" class="difflineminus">-    }</span>
<a href="#l1.222"></a><span id="l1.222" class="difflineminus">-</span>
<a href="#l1.223"></a><span id="l1.223" class="difflineminus">-    this.selectPanel(&quot;checkingForUpdates&quot;);</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineminus">-    this.isChecking = true;</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineminus">-    this.checker.checkForUpdates(this.updateCheckListener, true);</span>
<a href="#l1.226"></a><span id="l1.226" class="difflineplus">+    var ary = toXPCOMArray([this.update],</span>
<a href="#l1.227"></a><span id="l1.227" class="difflineplus">+    Components.interfaces.nsIMutableArray);</span>
<a href="#l1.228"></a><span id="l1.228" class="difflineplus">+    var openFeatures = &quot;chrome,centerscreen,dialog=no,resizable=no,titlebar,toolbar=no&quot;;</span>
<a href="#l1.229"></a><span id="l1.229" class="difflineplus">+    Services.ww.openWindow(null, URI_UPDATE_PROMPT_DIALOG, &quot;&quot;, openFeatures, ary);</span>
<a href="#l1.230"></a><span id="l1.230" class="difflineplus">+    window.close();</span>
<a href="#l1.231"></a><span id="l1.231">   },</span>
<a href="#l1.232"></a><span id="l1.232"> </span>
<a href="#l1.233"></a><span id="l1.233">   /**</span>
<a href="#l1.234"></a><span id="l1.234">    * Implements nsIUpdateCheckListener. The methods implemented by</span>
<a href="#l1.235"></a><span id="l1.235">    * nsIUpdateCheckListener are in a different scope from nsIIncrementalDownload</span>
<a href="#l1.236"></a><span id="l1.236">    * to make it clear which are used by each interface.</span>
<a href="#l1.237"></a><span id="l1.237">    */</span>
<a href="#l1.238"></a><span id="l1.238">   updateCheckListener: {</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineat">@@ -341,31 +354,24 @@ appUpdater.prototype =</span>
<a href="#l1.240"></a><span id="l1.240">       if (!gAppUpdater.aus.canApplyUpdates) {</span>
<a href="#l1.241"></a><span id="l1.241">         gAppUpdater.selectPanel(&quot;manualUpdate&quot;);</span>
<a href="#l1.242"></a><span id="l1.242">         return;</span>
<a href="#l1.243"></a><span id="l1.243">       }</span>
<a href="#l1.244"></a><span id="l1.244"> </span>
<a href="#l1.245"></a><span id="l1.245">       // Thunderbird no longer displays a license for updates and the licenseURL</span>
<a href="#l1.246"></a><span id="l1.246">       // check is just in case a distibution does.</span>
<a href="#l1.247"></a><span id="l1.247">       if (gAppUpdater.update.billboardURL || gAppUpdater.update.licenseURL) {</span>
<a href="#l1.248"></a><span id="l1.248" class="difflineminus">-        gAppUpdater.selectPanel(&quot;updateButtonBox&quot;);</span>
<a href="#l1.249"></a><span id="l1.249" class="difflineminus">-        gAppUpdater.setupUpdateButton(&quot;update.openUpdateUI.&quot; +</span>
<a href="#l1.250"></a><span id="l1.250" class="difflineminus">-                                      (this.isMajor ? &quot;upgradeButton&quot;</span>
<a href="#l1.251"></a><span id="l1.251" class="difflineminus">-                                                    : &quot;applyButton&quot;));</span>
<a href="#l1.252"></a><span id="l1.252" class="difflineplus">+        gAppUpdater.selectPanel(&quot;applyBillboard&quot;);</span>
<a href="#l1.253"></a><span id="l1.253">         return;</span>
<a href="#l1.254"></a><span id="l1.254">       }</span>
<a href="#l1.255"></a><span id="l1.255"> </span>
<a href="#l1.256"></a><span id="l1.256" class="difflineminus">-      if (!gAppUpdater.update.appVersion ||</span>
<a href="#l1.257"></a><span id="l1.257" class="difflineminus">-          Services.vc.compare(gAppUpdater.update.appVersion,</span>
<a href="#l1.258"></a><span id="l1.258" class="difflineminus">-                              Services.appinfo.version) == 0) {</span>
<a href="#l1.259"></a><span id="l1.259" class="difflineminus">-        gAppUpdater.startDownload();</span>
<a href="#l1.260"></a><span id="l1.260" class="difflineminus">-        return;</span>
<a href="#l1.261"></a><span id="l1.261" class="difflineminus">-      }</span>
<a href="#l1.262"></a><span id="l1.262" class="difflineminus">-</span>
<a href="#l1.263"></a><span id="l1.263" class="difflineminus">-      gAppUpdater.checkAddonCompatibility();</span>
<a href="#l1.264"></a><span id="l1.264" class="difflineplus">+      if (gAppUpdater.updateAuto) // automatically download and install</span>
<a href="#l1.265"></a><span id="l1.265" class="difflineplus">+        gAppUpdater.doUpdate();</span>
<a href="#l1.266"></a><span id="l1.266" class="difflineplus">+      else // ask</span>
<a href="#l1.267"></a><span id="l1.267" class="difflineplus">+        gAppUpdater.selectPanel(&quot;downloadAndInstall&quot;);</span>
<a href="#l1.268"></a><span id="l1.268">     },</span>
<a href="#l1.269"></a><span id="l1.269"> </span>
<a href="#l1.270"></a><span id="l1.270">     /**</span>
<a href="#l1.271"></a><span id="l1.271">      * See nsIUpdateService.idl</span>
<a href="#l1.272"></a><span id="l1.272">      */</span>
<a href="#l1.273"></a><span id="l1.273">     onError: function(aRequest, aUpdate) {</span>
<a href="#l1.274"></a><span id="l1.274">       // Errors in the update check are treated as no updates found. If the</span>
<a href="#l1.275"></a><span id="l1.275">       // update check fails repeatedly without a success the user will be</span>
<a href="#l1.276"></a><span id="l1.276" class="difflineat">@@ -484,19 +490,17 @@ appUpdater.prototype =</span>
<a href="#l1.277"></a><span id="l1.277">       return;</span>
<a href="#l1.278"></a><span id="l1.278"> </span>
<a href="#l1.279"></a><span id="l1.279">     if (this.addons.length == 0) {</span>
<a href="#l1.280"></a><span id="l1.280">       // Compatibility updates or new version updates were found for all add-ons</span>
<a href="#l1.281"></a><span id="l1.281">       this.startDownload();</span>
<a href="#l1.282"></a><span id="l1.282">       return;</span>
<a href="#l1.283"></a><span id="l1.283">     }</span>
<a href="#l1.284"></a><span id="l1.284"> </span>
<a href="#l1.285"></a><span id="l1.285" class="difflineminus">-    this.selectPanel(&quot;updateButtonBox&quot;);</span>
<a href="#l1.286"></a><span id="l1.286" class="difflineminus">-    this.setupUpdateButton(&quot;update.openUpdateUI.&quot; +</span>
<a href="#l1.287"></a><span id="l1.287" class="difflineminus">-                           (this.isMajor ? &quot;upgradeButton&quot; : &quot;applyButton&quot;));</span>
<a href="#l1.288"></a><span id="l1.288" class="difflineplus">+    this.selectPanel(&quot;apply&quot;);</span>
<a href="#l1.289"></a><span id="l1.289">   },</span>
<a href="#l1.290"></a><span id="l1.290"> </span>
<a href="#l1.291"></a><span id="l1.291">   /**</span>
<a href="#l1.292"></a><span id="l1.292">    * Starts the download of an update mar.</span>
<a href="#l1.293"></a><span id="l1.293">    */</span>
<a href="#l1.294"></a><span id="l1.294">   startDownload: function() {</span>
<a href="#l1.295"></a><span id="l1.295">     if (!this.update)</span>
<a href="#l1.296"></a><span id="l1.296">       this.update = this.um.activeUpdate;</span>
<a href="#l1.297"></a><span id="l1.297" class="difflineat">@@ -554,40 +558,35 @@ appUpdater.prototype =</span>
<a href="#l1.298"></a><span id="l1.298">         let update = this.um.activeUpdate;</span>
<a href="#l1.299"></a><span id="l1.299">         let self = this;</span>
<a href="#l1.300"></a><span id="l1.300">         Services.obs.addObserver(function (aSubject, aTopic, aData) {</span>
<a href="#l1.301"></a><span id="l1.301">           // Update the UI when the background updater is finished</span>
<a href="#l1.302"></a><span id="l1.302">           let status = update.state;</span>
<a href="#l1.303"></a><span id="l1.303">           if (status == &quot;applied&quot; || status == &quot;applied-service&quot; ||</span>
<a href="#l1.304"></a><span id="l1.304">               status == &quot;pending&quot; || status == &quot;pending-service&quot;) {</span>
<a href="#l1.305"></a><span id="l1.305">             // If the update is successfully applied, or if the updater has</span>
<a href="#l1.306"></a><span id="l1.306" class="difflineminus">-            // fallen back to non-staged updates, show the Restart to Update</span>
<a href="#l1.307"></a><span id="l1.307" class="difflineplus">+            // fallen back to non-staged updates, show the &quot;Restart to Update&quot;</span>
<a href="#l1.308"></a><span id="l1.308">             // button.</span>
<a href="#l1.309"></a><span id="l1.309" class="difflineminus">-            self.selectPanel(&quot;updateButtonBox&quot;);</span>
<a href="#l1.310"></a><span id="l1.310" class="difflineminus">-            self.setupUpdateButton(&quot;update.restart.&quot; +</span>
<a href="#l1.311"></a><span id="l1.311" class="difflineminus">-                                   (self.isMajor ? &quot;upgradeButton&quot; : &quot;restartButton&quot;));</span>
<a href="#l1.312"></a><span id="l1.312" class="difflineplus">+            self.selectPanel(&quot;apply&quot;);</span>
<a href="#l1.313"></a><span id="l1.313">           } else if (status == &quot;failed&quot;) {</span>
<a href="#l1.314"></a><span id="l1.314">             // Background update has failed, let's show the UI responsible for</span>
<a href="#l1.315"></a><span id="l1.315">             // prompting the user to update manually.</span>
<a href="#l1.316"></a><span id="l1.316">             self.selectPanel(&quot;downloadFailed&quot;);</span>
<a href="#l1.317"></a><span id="l1.317">           }</span>
<a href="#l1.318"></a><span id="l1.318">           Services.obs.removeObserver(arguments.callee, &quot;update-staged&quot;);</span>
<a href="#l1.319"></a><span id="l1.319">         }, &quot;update-staged&quot;, false);</span>
<a href="#l1.320"></a><span id="l1.320">       } else {</span>
<a href="#l1.321"></a><span id="l1.321" class="difflineminus">-        this.selectPanel(&quot;updateButtonBox&quot;);</span>
<a href="#l1.322"></a><span id="l1.322" class="difflineminus">-        this.setupUpdateButton(&quot;update.restart.&quot; +</span>
<a href="#l1.323"></a><span id="l1.323" class="difflineminus">-                               (this.isMajor ? &quot;upgradeButton&quot; : &quot;updateButton&quot;));</span>
<a href="#l1.324"></a><span id="l1.324" class="difflineplus">+        this.selectPanel(&quot;apply&quot;);</span>
<a href="#l1.325"></a><span id="l1.325">       }</span>
<a href="#l1.326"></a><span id="l1.326">       break;</span>
<a href="#l1.327"></a><span id="l1.327">     default:</span>
<a href="#l1.328"></a><span id="l1.328">       this.removeDownloadListener();</span>
<a href="#l1.329"></a><span id="l1.329">       this.selectPanel(&quot;downloadFailed&quot;);</span>
<a href="#l1.330"></a><span id="l1.330">       break;</span>
<a href="#l1.331"></a><span id="l1.331">     }</span>
<a href="#l1.332"></a><span id="l1.332" class="difflineminus">-</span>
<a href="#l1.333"></a><span id="l1.333">   },</span>
<a href="#l1.334"></a><span id="l1.334"> </span>
<a href="#l1.335"></a><span id="l1.335">   /**</span>
<a href="#l1.336"></a><span id="l1.336">    * See nsIProgressEventSink.idl</span>
<a href="#l1.337"></a><span id="l1.337">    */</span>
<a href="#l1.338"></a><span id="l1.338">   onStatus: function(aRequest, aContext, aStatus, aStatusArg) {</span>
<a href="#l1.339"></a><span id="l1.339">   },</span>
<a href="#l1.340"></a><span id="l1.340"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/aboutDialog.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/aboutDialog.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -44,27 +44,46 @@</span>
<a href="#l2.4"></a><span id="l2.4"> #expand &lt;label id=&quot;version&quot;&gt;__MOZ_APP_VERSION__&lt;/label&gt;</span>
<a href="#l2.5"></a><span id="l2.5">         &lt;label id=&quot;distribution&quot; class=&quot;text-blurb&quot;/&gt;</span>
<a href="#l2.6"></a><span id="l2.6">         &lt;label id=&quot;distributionId&quot; class=&quot;text-blurb&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8">         &lt;vbox id=&quot;detailsBox&quot;&gt;</span>
<a href="#l2.9"></a><span id="l2.9">           &lt;vbox id=&quot;updateBox&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10"> #ifdef MOZ_UPDATER</span>
<a href="#l2.11"></a><span id="l2.11">             &lt;deck id=&quot;updateDeck&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-              &lt;hbox id=&quot;updateButtonBox&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-                &lt;button id=&quot;updateButton&quot; align=&quot;start&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-                        oncommand=&quot;gAppUpdater.buttonOnCommand();&quot;/&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+              &lt;hbox id=&quot;checkForUpdates&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+                &lt;button id=&quot;checkForUpdatesButton&quot; align=&quot;start&quot;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+                        label=&quot;&amp;update.checkForUpdatesButton.label;&quot;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+                        accesskey=&quot;&amp;update.checkForUpdatesButton.accesskey;&quot;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+                        oncommand=&quot;gAppUpdater.checkForUpdates();&quot;/&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+                &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+              &lt;hbox id=&quot;downloadAndInstall&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+                &lt;button id=&quot;downloadAndInstallButton&quot;</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+                        oncommand=&quot;gAppUpdater.doUpdate();&quot;/&gt;</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+                        &lt;!-- label and accesskey will be filled by JS --&gt;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+                &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+              &lt;hbox id=&quot;apply&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineplus">+                &lt;button id=&quot;updateButton&quot;</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+                        label=&quot;&amp;update.updateButton.label;&quot;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+                        accesskey=&quot;&amp;update.updateButton.accesskey;&quot;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+                        oncommand=&quot;gAppUpdater.buttonRestartAfterDownload();&quot;/&gt;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+                &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+              &lt;/hbox&gt;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+              &lt;hbox id=&quot;applyBillboard&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+                &lt;button id=&quot;applyButtonBillboard&quot;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+                        label=&quot;&amp;update.applyButtonBillboard.label;&quot;</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+                        accesskey=&quot;&amp;update.applyButtonBillboard.accesskey;&quot;</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineplus">+                        oncommand=&quot;gAppUpdater.buttonApplyBillboard();&quot;/&gt;</span>
<a href="#l2.40"></a><span id="l2.40">                 &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.41"></a><span id="l2.41">               &lt;/hbox&gt;</span>
<a href="#l2.42"></a><span id="l2.42">               &lt;hbox id=&quot;checkingForUpdates&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.43"></a><span id="l2.43">                 &lt;image class=&quot;update-throbber&quot;/&gt;&lt;label&gt;&amp;update.checkingForUpdates;&lt;/label&gt;</span>
<a href="#l2.44"></a><span id="l2.44">               &lt;/hbox&gt;</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-              &lt;hbox id=&quot;checkingAddonCompat&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">-                &lt;image class=&quot;update-throbber&quot;/&gt;&lt;label&gt;&amp;update.checkingAddonCompat;&lt;/label&gt;</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineminus">-              &lt;/hbox&gt;</span>
<a href="#l2.48"></a><span id="l2.48">               &lt;hbox id=&quot;downloading&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.49"></a><span id="l2.49">                 &lt;image class=&quot;update-throbber&quot;/&gt;&lt;label&gt;&amp;update.downloading.start;&lt;/label&gt;&lt;label id=&quot;downloadStatus&quot;/&gt;&lt;label&gt;&amp;update.downloading.end;&lt;/label&gt;</span>
<a href="#l2.50"></a><span id="l2.50">               &lt;/hbox&gt;</span>
<a href="#l2.51"></a><span id="l2.51">               &lt;hbox id=&quot;applying&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.52"></a><span id="l2.52">                 &lt;image class=&quot;update-throbber&quot;/&gt;&lt;label&gt;&amp;update.applying;&lt;/label&gt;</span>
<a href="#l2.53"></a><span id="l2.53">               &lt;/hbox&gt;</span>
<a href="#l2.54"></a><span id="l2.54">              &lt;hbox id=&quot;downloadFailed&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.55"></a><span id="l2.55">                 &lt;label&gt;&amp;update.failed.start;&lt;/label&gt;&lt;label id=&quot;failedLink&quot; class=&quot;text-link&quot;&gt;&amp;update.failed.linkText;&lt;/label&gt;&lt;label&gt;&amp;update.failed.end;&lt;/label&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/aboutDialog.dtd</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/aboutDialog.dtd</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,10 +1,23 @@</span>
<a href="#l3.4"></a><span id="l3.4"> &lt;!ENTITY aboutDialog.title          &quot;About &amp;brandFullName;&quot;&gt;</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6" class="difflineplus">+</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (update.checkForUpdatesButton.*, update.updateButton.*, update.applyButtonBillboard.*):</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineplus">+# Only one button is present at a time.</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+# The button when displayed is located directly under the Thunderbird version in</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+# the about dialog.</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+--&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+&lt;!ENTITY update.checkForUpdatesButton.label       &quot;Check for Updates&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+&lt;!ENTITY update.checkForUpdatesButton.accesskey   &quot;C&quot;&gt;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+&lt;!ENTITY update.updateButton.label                &quot;Restart to Update&quot;&gt;</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+&lt;!ENTITY update.updateButton.accesskey            &quot;R&quot;&gt;</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+&lt;!ENTITY update.applyButtonBillboard.label        &quot;Apply Update…&quot;&gt;</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+&lt;!ENTITY update.applyButtonBillboard.accesskey    &quot;A&quot;&gt;</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+</span>
<a href="#l3.19"></a><span id="l3.19"> &lt;!ENTITY community.start2           &quot;&amp;brandShortName; is designed by &quot;&gt;</span>
<a href="#l3.20"></a><span id="l3.20"> &lt;!-- LOCALIZATION NOTE (community.mozillaLink): This is a link title that links to http://www.mozilla.org/. --&gt;</span>
<a href="#l3.21"></a><span id="l3.21"> &lt;!ENTITY community.mozillaLink      &quot;&amp;vendorShortName;&quot;&gt;</span>
<a href="#l3.22"></a><span id="l3.22"> &lt;!ENTITY community.middle2          &quot;, a &quot;&gt;</span>
<a href="#l3.23"></a><span id="l3.23"> &lt;!-- LOCALIZATION NOTE (community.creditsLink): This is a link title that links to about:credits. --&gt;</span>
<a href="#l3.24"></a><span id="l3.24"> &lt;!ENTITY community.creditsLink      &quot;global community&quot;&gt;</span>
<a href="#l3.25"></a><span id="l3.25"> &lt;!ENTITY community.end2             &quot; working together to make the Internet better. We believe that the Internet should be open, public, and accessible to everyone without any restrictions.&quot;&gt;</span>
<a href="#l3.26"></a><span id="l3.26"> </span>
<a href="#l3.27"></a><span id="l3.27" class="difflineat">@@ -19,18 +32,16 @@</span>
<a href="#l3.28"></a><span id="l3.28"> &lt;!-- LOCALIZATION NOTE (bottomLinks.rights): This is a link title that links to about:rights. --&gt;</span>
<a href="#l3.29"></a><span id="l3.29"> &lt;!ENTITY bottomLinks.rights         &quot;End-User Rights&quot;&gt;</span>
<a href="#l3.30"></a><span id="l3.30"> </span>
<a href="#l3.31"></a><span id="l3.31"> &lt;!-- LOCALIZATION NOTE (bottomLinks.privacy): This is a link title that links to https://www.mozilla.org/legal/privacy/. --&gt;</span>
<a href="#l3.32"></a><span id="l3.32"> &lt;!ENTITY bottomLinks.privacy        &quot;Privacy Policy&quot;&gt;</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34"> &lt;!-- LOCALIZATION NOTE (update.checkingForUpdates): try to make the localized text short (see bug 596813 for screenshots). --&gt;</span>
<a href="#l3.35"></a><span id="l3.35"> &lt;!ENTITY update.checkingForUpdates  &quot;Checking for updates…&quot;&gt;</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">-&lt;!-- LOCALIZATION NOTE (update.checkingAddonCompat): try to make the localized text short (see bug 596813 for screenshots). --&gt;</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-&lt;!ENTITY update.checkingAddonCompat &quot;Checking Add-on compatibility…&quot;&gt;</span>
<a href="#l3.38"></a><span id="l3.38"> &lt;!-- LOCALIZATION NOTE (update.noUpdatesFound): try to make the localized text short (see bug 596813 for screenshots). --&gt;</span>
<a href="#l3.39"></a><span id="l3.39"> &lt;!ENTITY update.noUpdatesFound      &quot;&amp;brandShortName; is up to date&quot;&gt;</span>
<a href="#l3.40"></a><span id="l3.40"> &lt;!-- LOCALIZATION NOTE (update.adminDisabled): try to make the localized text short (see bug 596813 for screenshots). --&gt;</span>
<a href="#l3.41"></a><span id="l3.41"> &lt;!ENTITY update.adminDisabled       &quot;Updates disabled by your system administrator&quot;&gt;</span>
<a href="#l3.42"></a><span id="l3.42"> </span>
<a href="#l3.43"></a><span id="l3.43"> &lt;!-- LOCALIZATION NOTE (update.failed.start,update.failed.linkText,update.failed.end):</span>
<a href="#l3.44"></a><span id="l3.44">      update.failed.start, update.failed.linkText, and update.failed.end all go into</span>
<a href="#l3.45"></a><span id="l3.45">      one line with linkText being wrapped in an anchor that links to a site to download</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.properties</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.properties</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -694,36 +694,20 @@ lwthemePostInstallNotification.undoButto</span>
<a href="#l4.4"></a><span id="l4.4"> lwthemePostInstallNotification.manageButton=Manage Themes…</span>
<a href="#l4.5"></a><span id="l4.5"> lwthemePostInstallNotification.manageButton.accesskey=M</span>
<a href="#l4.6"></a><span id="l4.6"> </span>
<a href="#l4.7"></a><span id="l4.7"> # safeModeRestart</span>
<a href="#l4.8"></a><span id="l4.8"> safeModeRestartPromptTitle=Restart with Add-ons Disabled</span>
<a href="#l4.9"></a><span id="l4.9"> safeModeRestartPromptMessage=Are you sure you want to disable all add-ons and restart?</span>
<a href="#l4.10"></a><span id="l4.10"> safeModeRestartButton=Restart</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-# Check for Updates in the About Dialog - button labels and accesskeys</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-# LOCALIZATION NOTE - all of the following update buttons labels will only be</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-# displayed one at a time. So, if a button is displayed nothing else will</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-# be displayed alongside of the button. The button when displayed is located</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-# directly under the Thunderbird version in the about dialog (see bug 596813 for</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-# screenshots).</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-update.checkInsideButton.label=Check for Updates</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-update.checkInsideButton.accesskey=C</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-update.resumeButton.label=Resume Downloading %S…</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-update.resumeButton.accesskey=D</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-update.openUpdateUI.applyButton.label=Apply Update…</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-update.openUpdateUI.applyButton.accesskey=A</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-update.restart.updateButton.label=Restart to Update</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-update.restart.updateButton.accesskey=R</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-update.restart.restartButton.label=Update &amp; Restart</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-update.restart.restartButton.accesskey=R</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineminus">-update.openUpdateUI.upgradeButton.label=Upgrade Now…</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-update.openUpdateUI.upgradeButton.accesskey=U</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-update.restart.upgradeButton.label=Upgrade Now</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-update.restart.upgradeButton.accesskey=U</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+# LOCALIZATION NOTE (downloadAndInstallButton.label): %S is replaced by the</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+# version of the update: &quot;Update to 28.0&quot;.</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+update.downloadAndInstallButton.label=Update to %S</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+update.downloadAndInstallButton.accesskey=U</span>
<a href="#l4.36"></a><span id="l4.36"> </span>
<a href="#l4.37"></a><span id="l4.37"> websearch.setDefault=Set this search engine as the default</span>
<a href="#l4.38"></a><span id="l4.38"> websearch.isDefault=This search engine is currently the default</span>
<a href="#l4.39"></a><span id="l4.39"> </span>
<a href="#l4.40"></a><span id="l4.40"> # missing plugin installer</span>
<a href="#l4.41"></a><span id="l4.41"> missingpluginsMessage.title=Additional plugins are required to display all the media on this page.</span>
<a href="#l4.42"></a><span id="l4.42"> missingpluginsMessage.button.label=Install Missing Plugins…</span>
<a href="#l4.43"></a><span id="l4.43"> missingpluginsMessage.button.accesskey=I</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

