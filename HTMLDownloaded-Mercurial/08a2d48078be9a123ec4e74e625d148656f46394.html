<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 266:08a2d48078be9a123ec4e74e625d148656f46394</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 08a2d48078be9a123ec4e74e625d148656f46394" />
<meta property="og:url" content="/comm-central/rev/08a2d48078be9a123ec4e74e625d148656f46394" />
<meta property="og:description" content="Bug 441403 - Migrate SeaMonkey's popup preferences to new pref window" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 08a2d48078be9a123ec4e74e625d148656f46394 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/08a2d48078be9a123ec4e74e625d148656f46394">shortlog</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/08a2d48078be9a123ec4e74e625d148656f46394">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394">files</a> |
changeset |
<a href="/comm-central/raw-rev/08a2d48078be9a123ec4e74e625d148656f46394">raw</a>  | <a href="/comm-central/archive/08a2d48078be9a123ec4e74e625d148656f46394.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=441403">Bug 441403</a> - Migrate SeaMonkey's popup preferences to new pref window
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#73;&#97;&#110;&#32;&#78;&#101;&#97;&#108;&#32;&#60;&#105;&#97;&#110;&#110;&#95;&#99;&#118;&#115;&#64;&#98;&#108;&#117;&#101;&#121;&#111;&#110;&#100;&#101;&#114;&#46;&#99;&#111;&#46;&#117;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 05 Sep 2008 22:24:09 +0100</td></tr>

<tr>
 <td>changeset 266</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/08a2d48078be9a123ec4e74e625d148656f46394">08a2d48078be9a123ec4e74e625d148656f46394</a></td>
</tr>



<tr>
<td>parent 265</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d6e5d976103e615ae181ad9103f7c726fb840859">d6e5d976103e615ae181ad9103f7c726fb840859</a>
</td>
</tr>

<tr>
<td>child 267</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bbfb7a0983374560b721208ab044dec0fb6d0e65">bbfb7a0983374560b721208ab044dec0fb6d0e65</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=08a2d48078be9a123ec4e74e625d148656f46394">237</a></td></tr>
<tr><td>push user</td><td>iann_cvs@blueyonder.co.uk</td></tr>
<tr><td>push date</td><td class="date age">Fri, 05 Sep 2008 21:24:43 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@08a2d48078be [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=08a2d48078be9a123ec4e74e625d148656f46394">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=08a2d48078be9a123ec4e74e625d148656f46394&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=08a2d48078be9a123ec4e74e625d148656f46394&newProject=comm-central&newRevision=08a2d48078be9a123ec4e74e625d148656f46394&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=08a2d48078be9a123ec4e74e625d148656f46394&newProject=comm-central&newRevision=08a2d48078be9a123ec4e74e625d148656f46394&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=08a2d48078be9a123ec4e74e625d148656f46394&newProject=comm-central&newRevision=08a2d48078be9a123ec4e74e625d148656f46394&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>

<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=441403">441403</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=441403">Bug 441403</a> - Migrate SeaMonkey's popup preferences to new pref window
r=mnyromyr sr=neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/browser/browser-prefs.js">suite/browser/browser-prefs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/browser/browser-prefs.js">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/browser/browser-prefs.js">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/browser/browser-prefs.js">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/browser/browser-prefs.js">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/browser/browser-prefs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/bindings/notification.xml">suite/common/bindings/notification.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/bindings/notification.xml">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/bindings/notification.xml">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/bindings/notification.xml">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/bindings/notification.xml">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/bindings/notification.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/jar.mn">suite/common/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/jar.mn">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/jar.mn">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/jar.mn">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/jar.mn">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.js">suite/common/pref/pref-popups.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.js">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.js">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.js">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.js">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.xul">suite/common/pref/pref-popups.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.xul">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.xul">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.xul">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.xul">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/pref-popups.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preferences.xul">suite/common/pref/preferences.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preferences.xul">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preferences.xul">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preferences.xul">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preferences.xul">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preferences.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preftree.xul">suite/common/pref/preftree.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preftree.xul">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preftree.xul">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preftree.xul">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preftree.xul">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/common/pref/preftree.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/locales/en-US/chrome/common/pref/pref-popups.dtd">suite/locales/en-US/chrome/common/pref/pref-popups.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/locales/en-US/chrome/common/pref/pref-popups.dtd">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/locales/en-US/chrome/common/pref/pref-popups.dtd">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/locales/en-US/chrome/common/pref/pref-popups.dtd">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/locales/en-US/chrome/common/pref/pref-popups.dtd">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/locales/en-US/chrome/common/pref/pref-popups.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp">suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/08a2d48078be9a123ec4e74e625d148656f46394/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp">file</a> |
<a href="/comm-central/annotate/08a2d48078be9a123ec4e74e625d148656f46394/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp">annotate</a> |
<a href="/comm-central/diff/08a2d48078be9a123ec4e74e625d148656f46394/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp">diff</a> |
<a href="/comm-central/comparison/08a2d48078be9a123ec4e74e625d148656f46394/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp">comparison</a> |
<a href="/comm-central/log/08a2d48078be9a123ec4e74e625d148656f46394/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/browser/browser-prefs.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/browser/browser-prefs.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -392,16 +392,17 @@ pref(&quot;alerts.slideIncrementTime&quot;, 10);</span>
<a href="#l1.4"></a><span id="l1.4"> pref(&quot;alerts.totalOpenTime&quot;, 4000);</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> // 0 opens the download manager</span>
<a href="#l1.7"></a><span id="l1.7"> // 1 opens a progress dialog</span>
<a href="#l1.8"></a><span id="l1.8"> // 2 and other values, no download manager, no progress dialog. </span>
<a href="#l1.9"></a><span id="l1.9"> pref(&quot;browser.downloadmanager.behavior&quot;, 0);</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11"> pref(&quot;privacy.popups.sound_enabled&quot;,              false);</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+pref(&quot;privacy.popups.sound_type&quot;,                 1);</span>
<a href="#l1.13"></a><span id="l1.13"> pref(&quot;privacy.popups.sound_url&quot;,                  &quot;&quot;);</span>
<a href="#l1.14"></a><span id="l1.14"> pref(&quot;privacy.popups.statusbar_icon_enabled&quot;,     true);</span>
<a href="#l1.15"></a><span id="l1.15"> pref(&quot;privacy.popups.prefill_whitelist&quot;,          false);</span>
<a href="#l1.16"></a><span id="l1.16"> pref(&quot;privacy.popups.remove_blacklist&quot;,           true);</span>
<a href="#l1.17"></a><span id="l1.17"> pref(&quot;privacy.popups.showBrowserMessage&quot;,         true);</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19"> // sanitize (clear private data) options</span>
<a href="#l1.20"></a><span id="l1.20"> // XXX: turn on sanitize for downloads once we support toolkit' download manager</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/common/bindings/notification.xml</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/common/bindings/notification.xml</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -274,38 +274,39 @@</span>
<a href="#l2.4"></a><span id="l2.4">             aEvent.preventDefault();</span>
<a href="#l2.5"></a><span id="l2.5">           ]]&gt;</span>
<a href="#l2.6"></a><span id="l2.6">         &lt;/body&gt;</span>
<a href="#l2.7"></a><span id="l2.7">       &lt;/method&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">       &lt;method name=&quot;playSoundForBlockedPopup&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10">         &lt;body&gt;</span>
<a href="#l2.11"></a><span id="l2.11">           &lt;![CDATA[</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+            const kCustomSound = 1;</span>
<a href="#l2.13"></a><span id="l2.13">             var playSound = this._prefs.getBoolPref(&quot;privacy.popups.sound_enabled&quot;);</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15">             if (playSound) {</span>
<a href="#l2.16"></a><span id="l2.16">               var sound = Components.classes[&quot;@mozilla.org/sound;1&quot;]</span>
<a href="#l2.17"></a><span id="l2.17">                                     .createInstance(Components.interfaces.nsISound);</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19" class="difflineminus">-              var soundUrlSpec = this._prefs.getCharPref(&quot;privacy.popups.sound_url&quot;);</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineminus">-              if (!soundUrlSpec) {</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-                sound.beep();</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-                return;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineminus">-              }</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-              if (soundUrlSpec.substr(0, 7) == &quot;file://&quot;) {</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+              var soundType = this._prefs.getIntPref(&quot;privacy.popups.sound_type&quot;);</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+              if (soundType == kCustomSound) {</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+                var soundUrlSpec = this._prefs.getCharPref(&quot;privacy.popups.sound_url&quot;);</span>
<a href="#l2.28"></a><span id="l2.28">                 var fileHandler = Components.classes[&quot;@mozilla.org/network/protocol;1?name=file&quot;]</span>
<a href="#l2.29"></a><span id="l2.29">                                             .getService(Components.interfaces.nsIFileProtocolHandler);</span>
<a href="#l2.30"></a><span id="l2.30">                 var file = fileHandler.getFileFromURLSpec(soundUrlSpec);</span>
<a href="#l2.31"></a><span id="l2.31">                 if (file.exists()) {</span>
<a href="#l2.32"></a><span id="l2.32">                   var soundUrl = fileHandler.newFileURI(file);</span>
<a href="#l2.33"></a><span id="l2.33">                   sound.play(soundUrl);</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+                  return;</span>
<a href="#l2.35"></a><span id="l2.35">                 }</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineminus">-              } else {</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-                sound.playSystemSound(soundUrlSpec);</span>
<a href="#l2.38"></a><span id="l2.38">               }</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineplus">+</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineplus">+              // Either a custom sound is selected which does not exist</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+              // or the system beep was selected, so make the system beep.</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+              sound.beep();</span>
<a href="#l2.43"></a><span id="l2.43">             }</span>
<a href="#l2.44"></a><span id="l2.44">           ]]&gt;</span>
<a href="#l2.45"></a><span id="l2.45">         &lt;/body&gt;</span>
<a href="#l2.46"></a><span id="l2.46">       &lt;/method&gt;</span>
<a href="#l2.47"></a><span id="l2.47"> </span>
<a href="#l2.48"></a><span id="l2.48">       &lt;field name=&quot;popupCount&quot;&gt;0&lt;/field&gt;</span>
<a href="#l2.49"></a><span id="l2.49"> </span>
<a href="#l2.50"></a><span id="l2.50">       &lt;method name=&quot;notifyPopupCountChanged&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/common/jar.mn</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/common/jar.mn</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -184,16 +184,17 @@ comm.jar:</span>
<a href="#l3.4"></a><span id="l3.4">    content/communicator/pref/pref-locationbar.js                    (pref/pref-locationbar.js)</span>
<a href="#l3.5"></a><span id="l3.5">    content/communicator/pref/pref-locationbar.xul                   (pref/pref-locationbar.xul)</span>
<a href="#l3.6"></a><span id="l3.6">    content/communicator/pref/pref-mousewheel.js                     (pref/pref-mousewheel.js)</span>
<a href="#l3.7"></a><span id="l3.7">    content/communicator/pref/pref-mousewheel.xul                    (pref/pref-mousewheel.xul)</span>
<a href="#l3.8"></a><span id="l3.8">    content/communicator/pref/pref-navigator.js                      (pref/pref-navigator.js)</span>
<a href="#l3.9"></a><span id="l3.9">    content/communicator/pref/pref-navigator.xul                     (pref/pref-navigator.xul)</span>
<a href="#l3.10"></a><span id="l3.10">    content/communicator/pref/pref-offline.xul                       (pref/pref-offline.xul)</span>
<a href="#l3.11"></a><span id="l3.11">    content/communicator/pref/pref-policies.xul                      (pref/pref-policies.xul)</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+   content/communicator/pref/pref-popups.js                         (pref/pref-popups.js)</span>
<a href="#l3.13"></a><span id="l3.13">    content/communicator/pref/pref-popups.xul                        (pref/pref-popups.xul)</span>
<a href="#l3.14"></a><span id="l3.14">    content/communicator/pref/pref-proxies.js                        (pref/pref-proxies.js)</span>
<a href="#l3.15"></a><span id="l3.15">    content/communicator/pref/pref-proxies.xul                       (pref/pref-proxies.xul)</span>
<a href="#l3.16"></a><span id="l3.16">    content/communicator/pref/pref-proxies-advanced.xul              (pref/pref-proxies-advanced.xul)</span>
<a href="#l3.17"></a><span id="l3.17">    content/communicator/pref/pref-scripts.js                        (pref/pref-scripts.js)</span>
<a href="#l3.18"></a><span id="l3.18">    content/communicator/pref/pref-scripts.xul                       (pref/pref-scripts.xul)</span>
<a href="#l3.19"></a><span id="l3.19">    content/communicator/pref/pref-search.js                         (pref/pref-search.js)</span>
<a href="#l3.20"></a><span id="l3.20">    content/communicator/pref/pref-search.xul                        (pref/pref-search.xul)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">new file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- /dev/null</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ b/suite/common/pref/pref-popups.js</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -0,0 +1,184 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineplus">+* Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+*</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+* The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+* 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+* the License. You may obtain a copy of the License at</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+* http://www.mozilla.org/MPL/</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+*</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+* Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+* WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+* for the specific language governing rights and limitations under the</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+* License.</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+*</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+* The Original Code is mozilla.org code.</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+*</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+* The Initial Developer of the Original Code is</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+* Netscape Communications Corporation.</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+* Portions created by the Initial Developer are Copyright (C) 2002</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+* the Initial Developer. All Rights Reserved.</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+*</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+* Contributor(s):</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+*   Ian Neal &lt;iann_bugzilla@blueyonder.co.uk&gt;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+*</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+* Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+* either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+* the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+* in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+* of those above. If you wish to allow use of your version of this file only</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+* under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+* use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+* decision by deleting the provisions above and replace them with the notice</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+* and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+* the provisions above, a recipient may use your version of this file under</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+* the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+*</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+* ***** END LICENSE BLOCK ***** */</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+const nsIFileProtocolHandler = Components.interfaces.nsIFileProtocolHandler;</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+var gSoundUrlPref;</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+var gSelectSound;</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+var gIOService;</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+var gFileHandler;</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+function Startup()</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+{</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+  gSoundUrlPref = document.getElementById(&quot;privacy.popups.sound_url&quot;);</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+  gSelectSound = document.getElementById(&quot;selectSound&quot;);</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+  gIOService = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+                         .getService(Components.interfaces.nsIIOService);</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+  gFileHandler = gIOService.getProtocolHandler(&quot;file&quot;)</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+                           .QueryInterface(nsIFileProtocolHandler);</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+  SetLists();</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+  SetButtons();</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+}</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+function SetLists()</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+{</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+  const kPopupType = &quot;popup&quot;;</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineplus">+  const nsIPermissionManager = Components.interfaces.nsIPermissionManager;</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+  const nsIPermission = Components.interfaces.nsIPermission;</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+  var permissionManager = Components.classes[&quot;@mozilla.org/permissionmanager;1&quot;]</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+                                    .getService(nsIPermissionManager);</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+  var pref = document.getElementById(&quot;privacy.popups.remove_blacklist&quot;);</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+  if (pref.value)</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+  {</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineplus">+    var enumerator = permissionManager.enumerator;</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineplus">+    var hosts = [];</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineplus">+</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+    while (enumerator.hasMoreElements())</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+    {                </span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+      var permission = enumerator.getNext();</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+      if (permission instanceof nsIPermission)</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+      {</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+        if ((permission.type == kPopupType) &amp;&amp;</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+            (permission.capability == nsIPermissionManager.DENY_ACTION))</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+          hosts.push(permission.host);</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+      }</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+    }</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+    for (var i in hosts)</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+      permissionManager.remove(hosts[i], kPopupType);</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+    pref.value = false;</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+  }</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+  pref = document.getElementById(&quot;privacy.popups.prefill_whitelist&quot;);</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+  if (pref.value)</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+  {</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+    try</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+    { </span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+      var whitelist = document.getElementById(&quot;privacy.popups.default_whitelist&quot;).value;</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+      var hosts = whitelist.split(&quot;,&quot;);</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineplus">+      for (var i in hosts)</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineplus">+      {</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineplus">+        var host = &quot;http://&quot; + hosts[i];</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+        var uri = gIOService.newURI(host, null, null);</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+        permissionManager.add(uri, kPopupType, true);</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineplus">+      }</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineplus">+    } </span>
<a href="#l4.113"></a><span id="l4.113" class="difflineplus">+    catch (ex) {}</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineplus">+</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineplus">+    pref.value = false;</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineplus">+  }  </span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+}</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineplus">+</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+function SetButtons()</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+{</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+  var prefString = document.getElementById(&quot;popupPolicy&quot;)</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+                           .getAttribute(&quot;preference&quot;);</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineplus">+  var enable = document.getElementById(prefString).value;</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineplus">+  EnableElementById(&quot;exceptionsButton&quot;, enable, false);</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineplus">+  EnableElementById(&quot;displayIcon&quot;, enable, false);</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineplus">+</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineplus">+  var element = document.getElementById(&quot;playSound&quot;);</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineplus">+  EnableElement(element, enable, false);</span>
<a href="#l4.129"></a><span id="l4.129" class="difflineplus">+</span>
<a href="#l4.130"></a><span id="l4.130" class="difflineplus">+  prefString = element.getAttribute(&quot;preference&quot;);</span>
<a href="#l4.131"></a><span id="l4.131" class="difflineplus">+  EnableSoundRadio(enable &amp;&amp; document.getElementById(prefString).value);</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineplus">+}</span>
<a href="#l4.133"></a><span id="l4.133" class="difflineplus">+</span>
<a href="#l4.134"></a><span id="l4.134" class="difflineplus">+function EnableSoundRadio(aSoundChecked)</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineplus">+{</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineplus">+  const kCustomSound = 1;</span>
<a href="#l4.137"></a><span id="l4.137" class="difflineplus">+</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineplus">+  var element = document.getElementById(&quot;popupSoundType&quot;);</span>
<a href="#l4.139"></a><span id="l4.139" class="difflineplus">+  EnableElement(element, aSoundChecked, false);</span>
<a href="#l4.140"></a><span id="l4.140" class="difflineplus">+  var pref = document.getElementById(element.getAttribute(&quot;preference&quot;));</span>
<a href="#l4.141"></a><span id="l4.141" class="difflineplus">+  EnableSoundUrl(aSoundChecked &amp;&amp; (pref.value == kCustomSound));</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineplus">+}</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineplus">+</span>
<a href="#l4.144"></a><span id="l4.144" class="difflineplus">+function EnableSoundUrl(aCustomSelected)</span>
<a href="#l4.145"></a><span id="l4.145" class="difflineplus">+{</span>
<a href="#l4.146"></a><span id="l4.146" class="difflineplus">+  EnableElementById(&quot;playSoundUrl&quot;, aCustomSelected, false);</span>
<a href="#l4.147"></a><span id="l4.147" class="difflineplus">+  EnableElement(gSelectSound, aCustomSelected, false);</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineplus">+  EnableElementById(&quot;previewSound&quot;, aCustomSelected, false);</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineplus">+}</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineplus">+</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineplus">+function ReadSoundLocation(aElement)</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+{</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineplus">+  aElement.value = gSoundUrlPref.value;</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineplus">+  if (aElement.value)</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineplus">+    aElement.file = gFileHandler.getFileFromURLSpec(aElement.value);</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineplus">+}</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineplus">+</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+function SelectSound()</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineplus">+{</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineplus">+  const nsILocalFile = Components.interfaces.nsILocalFile;</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineplus">+  const nsIFilePicker = Components.interfaces.nsIFilePicker;</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineplus">+  var filepicker = Components.classes[&quot;@mozilla.org/filepicker;1&quot;]</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineplus">+                             .createInstance(nsIFilePicker);</span>
<a href="#l4.164"></a><span id="l4.164" class="difflineplus">+</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineplus">+  filepicker.init(window,</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineplus">+                  gSelectSound.getAttribute(&quot;filepickertitle&quot;),</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineplus">+                  nsIFilePicker.modeOpen);</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineplus">+  if (gSoundUrlPref.value)</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+    filepicker.displayDirectory = gFileHandler.getFileFromURLSpec(gSoundUrlPref.value).parent;</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineplus">+</span>
<a href="#l4.171"></a><span id="l4.171" class="difflineplus">+  filepicker.appendFilter(gSelectSound.getAttribute(&quot;filepickerfilter&quot;),</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineplus">+                          &quot;*.wav; *.wave&quot;);</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineplus">+  filepicker.appendFilters(nsIFilePicker.filterAll);</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineplus">+</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineplus">+  if (filepicker.show() == nsIFilePicker.returnOK)</span>
<a href="#l4.176"></a><span id="l4.176" class="difflineplus">+    gSoundUrlPref.value = filepicker.fileURL.spec;</span>
<a href="#l4.177"></a><span id="l4.177" class="difflineplus">+}</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineplus">+</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineplus">+function PreviewSound()</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineplus">+{</span>
<a href="#l4.181"></a><span id="l4.181" class="difflineplus">+  var soundUrl = gSoundUrlPref.value;</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineplus">+  var sound = Components.classes[&quot;@mozilla.org/sound;1&quot;]</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineplus">+                        .createInstance(Components.interfaces.nsISound);</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+  if (soundUrl)</span>
<a href="#l4.185"></a><span id="l4.185" class="difflineplus">+    sound.play(gIOService.newURI(soundUrl, null, null));</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineplus">+  else</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineplus">+    sound.beep();</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/suite/common/pref/pref-popups.xul</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/suite/common/pref/pref-popups.xul</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7"> &lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.8"></a><span id="l5.8">    - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.9"></a><span id="l5.9">    -</span>
<a href="#l5.10"></a><span id="l5.10">    - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.11"></a><span id="l5.11">    - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.12"></a><span id="l5.12">    - the License. You may obtain a copy of the License at</span>
<a href="#l5.13"></a><span id="l5.13">    - http://www.mozilla.org/MPL/</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineat">@@ -16,237 +16,145 @@</span>
<a href="#l5.15"></a><span id="l5.15">    - The Original Code is mozilla.org code.</span>
<a href="#l5.16"></a><span id="l5.16">    -</span>
<a href="#l5.17"></a><span id="l5.17">    - The Initial Developer of the Original Code is</span>
<a href="#l5.18"></a><span id="l5.18">    - Netscape Communications Corporation.</span>
<a href="#l5.19"></a><span id="l5.19">    - Portions created by the Initial Developer are Copyright (C) 2002</span>
<a href="#l5.20"></a><span id="l5.20">    - the Initial Developer. All Rights Reserved.</span>
<a href="#l5.21"></a><span id="l5.21">    -</span>
<a href="#l5.22"></a><span id="l5.22">    - Contributor(s):</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+   -   Ian Neal &lt;iann_bugzilla@blueyonder.co.uk&gt;</span>
<a href="#l5.24"></a><span id="l5.24">    -</span>
<a href="#l5.25"></a><span id="l5.25">    - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.26"></a><span id="l5.26">    - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l5.27"></a><span id="l5.27">    - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.28"></a><span id="l5.28">    - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.29"></a><span id="l5.29">    - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.30"></a><span id="l5.30">    - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.31"></a><span id="l5.31">    - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.32"></a><span id="l5.32">    - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-   - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+   - and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.35"></a><span id="l5.35">    - the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.36"></a><span id="l5.36">    - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.37"></a><span id="l5.37">    -</span>
<a href="#l5.38"></a><span id="l5.38">    - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40"> &lt;?xml-stylesheet href=&quot;chrome://communicator/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.41"></a><span id="l5.41"> </span>
<a href="#l5.42"></a><span id="l5.42" class="difflineminus">-&lt;!DOCTYPE page [</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineminus">-&lt;!ENTITY % prefPopupsDTD SYSTEM &quot;chrome://communicator/locale/pref/pref-popups.dtd&quot; &gt;</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+&lt;!DOCTYPE overlay [</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+&lt;!ENTITY % prefPopupsDTD SYSTEM &quot;chrome://communicator/locale/pref/pref-popups.dtd&quot;&gt;</span>
<a href="#l5.46"></a><span id="l5.46"> %prefPopupsDTD;</span>
<a href="#l5.47"></a><span id="l5.47"> ]&gt;</span>
<a href="#l5.48"></a><span id="l5.48"> </span>
<a href="#l5.49"></a><span id="l5.49" class="difflineminus">-&lt;page xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-      id=&quot;popupsPanel&quot;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineminus">-      onload=&quot;parent.initPanel('chrome://communicator/content/pref/pref-popups.xul');&quot;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineminus">-      headertitle=&quot;&amp;pref.popups.title;&quot;&gt;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-          </span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-  &lt;script type=&quot;application/x-javascript&quot; src=&quot;chrome://communicator/content/permissions/permissionsOverlay.js&quot;/&gt;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineminus">-</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineminus">-  &lt;script type=&quot;application/x-javascript&quot;&gt;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineminus">-    &lt;![CDATA[</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineminus">-</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineminus">-      var _elementIDs = [&quot;popupPolicy&quot;,&quot;playSound&quot;,&quot;playSoundUrl&quot;,&quot;displayIcon&quot;,&quot;removeBlacklist&quot;,&quot;prefillWhitelist&quot;];</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineminus">-</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineminus">-      const nsIPermissionManager = Components.interfaces.nsIPermissionManager;</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineminus">-      const popupType = &quot;popup&quot;;</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineminus">-</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineminus">-      var gPolicyCheckbox;</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineminus">-      var gSoundCheckbox;</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineminus">-      var gSoundUrlBox;</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineminus">-      var gSoundUrlButton;</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineminus">-      var gPreviewSoundButton;</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineminus">-      var gIconCheckbox;</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineminus">-</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineminus">-      var permissionManager;</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineminus">-      var ioService;</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineminus">-</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineminus">-      function Startup() {</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineminus">-        permissionManager = Components.classes[&quot;@mozilla.org/permissionmanager;1&quot;]</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineminus">-                                      .getService(nsIPermissionManager);</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineminus">-</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineminus">-        ioService = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineminus">-                              .getService(Components.interfaces.nsIIOService);</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineminus">-</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-        gPolicyCheckbox = document.getElementById(&quot;popupPolicy&quot;);</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineminus">-        gSoundCheckbox = document.getElementById(&quot;playSound&quot;);</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineminus">-        gSoundUrlBox = document.getElementById(&quot;playSoundUrl&quot;);</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineminus">-        gSoundUrlButton = document.getElementById(&quot;selectSound&quot;);</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineminus">-        gPreviewSoundButton = document.getElementById(&quot;previewSound&quot;);</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineminus">-        gIconCheckbox = document.getElementById(&quot;displayIcon&quot;);   </span>
<a href="#l5.87"></a><span id="l5.87" class="difflineminus">-</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineminus">-        var removeBlacklist = (document.getElementById(&quot;removeBlacklist&quot;).getAttribute(&quot;value&quot;) == &quot;true&quot;);</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineminus">-        if (removeBlacklist) {</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineminus">-          clearBlacklist();</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineminus">-          document.getElementById(&quot;removeBlacklist&quot;).setAttribute(&quot;value&quot;, false);</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineminus">-        }</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+  &lt;prefpane id=&quot;popups_pane&quot;</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+            label=&quot;&amp;pref.popups.title;&quot;</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+            script=&quot;chrome://communicator/content/pref/pref-popups.js&quot;&gt;</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+    &lt;preferences id=&quot;popups_preferences&quot;&gt;</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+      &lt;preference id=&quot;dom.disable_open_during_load&quot;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+                  name=&quot;dom.disable_open_during_load&quot;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+                  type=&quot;bool&quot;</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+                  onchange=&quot;SetButtons();&quot;/&gt;</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+      &lt;preference id=&quot;pref.advanced.popups.disable_button.view_popups&quot;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+                  name=&quot;pref.advanced.popups.disable_button.view_popups&quot;</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+                  type=&quot;bool&quot;/&gt;</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.sound_enabled&quot;</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+                  name=&quot;privacy.popups.sound_enabled&quot;</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+                  type=&quot;bool&quot;</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+                  onchange=&quot;EnableSoundRadio(this.value);&quot;/&gt;</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.sound_type&quot;</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+                  name=&quot;privacy.popups.sound_type&quot;</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+                  type=&quot;int&quot;</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineplus">+                  onchange=&quot;EnableSoundUrl(this.value == 1);&quot;/&gt;</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.sound_url&quot;</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineplus">+                  name=&quot;privacy.popups.sound_url&quot;</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineplus">+                  type=&quot;string&quot;</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+                  onchange=&quot;EnableElementById('previewSound', true, false);&quot;/&gt;</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineplus">+      &lt;preference id=&quot;pref.advanced.popups.disable_button.select_sound&quot;</span>
<a href="#l5.118"></a><span id="l5.118" class="difflineplus">+                  name=&quot;pref.advanced.popups.disable_button.select_sound&quot;</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineplus">+                  type=&quot;bool&quot;/&gt;</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+      &lt;preference id=&quot;pref.advanced.popups.disable_button.preview_sound&quot;</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineplus">+                  name=&quot;pref.advanced.popups.disable_button.preview_sound&quot;</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineplus">+                  type=&quot;bool&quot;/&gt;</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.statusbar_icon_enabled&quot;</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineplus">+                  name=&quot;privacy.popups.statusbar_icon_enabled&quot;</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineplus">+                  type=&quot;bool&quot;/&gt;</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.prefill_whitelist&quot;</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+                  name=&quot;privacy.popups.prefill_whitelist&quot;</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+                  type=&quot;bool&quot;/&gt;</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.remove_blacklist&quot;</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+                  name=&quot;privacy.popups.remove_blacklist&quot;</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineplus">+                  type=&quot;bool&quot;/&gt;</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+      &lt;preference id=&quot;privacy.popups.default_whitelist&quot;</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+                  name=&quot;privacy.popups.default_whitelist&quot;</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineplus">+                  type=&quot;string&quot;/&gt;</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+    &lt;/preferences&gt;</span>
<a href="#l5.136"></a><span id="l5.136"> </span>
<a href="#l5.137"></a><span id="l5.137" class="difflineminus">-        var prefillWhitelist = (document.getElementById(&quot;prefillWhitelist&quot;).getAttribute(&quot;value&quot;) == &quot;true&quot;);        </span>
<a href="#l5.138"></a><span id="l5.138" class="difflineminus">-        if (prefillWhitelist) {          </span>
<a href="#l5.139"></a><span id="l5.139" class="difflineminus">-          loadWhitelist();</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineminus">-          document.getElementById(&quot;prefillWhitelist&quot;).setAttribute(&quot;value&quot;, false);</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineminus">-        }</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineminus">-</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineminus">-        if (parent.queuedTag == &quot;chrome://communicator/content/pref/pref-popups.xul&quot;) {</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineminus">-          // opened from About Popups menuitem</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineminus">-          gPolicyCheckbox.checked = true;</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineminus">-          parent.queuedTag = null;</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineminus">-        }</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineminus">-</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineminus">-        setButtons();</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineminus">-      }</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineminus">-</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineminus">-      function clearBlacklist() {</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineminus">-        var enumerator = permissionManager.enumerator;</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineminus">-        var hosts = [];</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineminus">-  </span>
<a href="#l5.156"></a><span id="l5.156" class="difflineminus">-        while (enumerator.hasMoreElements()) {                </span>
<a href="#l5.157"></a><span id="l5.157" class="difflineminus">-          var permission = enumerator.getNext();</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineminus">-          if (permission) {</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineminus">-            permission = permission.QueryInterface(Components.interfaces.nsIPermission);</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineminus">-            if ((permission.type == popupType) &amp;&amp; (permission.capability == nsIPermissionManager.DENY_ACTION))</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineminus">-              hosts[hosts.length] = permission.host;</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineminus">-          }</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineminus">-        }</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineminus">-        </span>
<a href="#l5.165"></a><span id="l5.165" class="difflineminus">-        for (var i in hosts) {</span>
<a href="#l5.166"></a><span id="l5.166" class="difflineminus">-          permissionManager.remove(hosts[i], popupType);</span>
<a href="#l5.167"></a><span id="l5.167" class="difflineminus">-        }    </span>
<a href="#l5.168"></a><span id="l5.168" class="difflineminus">-      </span>
<a href="#l5.169"></a><span id="l5.169" class="difflineminus">-      }</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineminus">-</span>
<a href="#l5.171"></a><span id="l5.171" class="difflineminus">-      function loadWhitelist() {</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineminus">-        try {</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineminus">-          var whitelist = parent.hPrefWindow.getPref(&quot;localizedstring&quot;,</span>
<a href="#l5.174"></a><span id="l5.174" class="difflineminus">-                                                     &quot;privacy.popups.default_whitelist&quot;);</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineminus">-          var hosts = whitelist.split(&quot;,&quot;);</span>
<a href="#l5.176"></a><span id="l5.176" class="difflineminus">-</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineminus">-          for (var i in hosts) {</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineminus">-            var host = hosts[i];</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineminus">-            host = &quot;http://&quot; + host;</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineminus">-            var uri = ioService.newURI(host, null, null);</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineminus">-            permissionManager.add(uri, popupType, true);</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineminus">-          }</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineminus">-        } </span>
<a href="#l5.184"></a><span id="l5.184" class="difflineminus">-        catch (ex) { }</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineminus">-      }</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineminus">-</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineminus">-      function setButtons() {</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineminus">-        var exceptionsButton = document.getElementById(&quot;exceptionsButton&quot;);</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineminus">-        exceptionsButton.disabled = !gPolicyCheckbox.checked;</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineplus">+    &lt;groupbox id=&quot;popupsArea&quot;&gt;</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+      &lt;caption label=&quot;&amp;pref.popups.caption;&quot;/&gt;</span>
<a href="#l5.192"></a><span id="l5.192"> </span>
<a href="#l5.193"></a><span id="l5.193" class="difflineminus">-        if (!gPolicyCheckbox.checked) {</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineminus">-          gSoundCheckbox.disabled = true;</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineminus">-          gSoundUrlBox.disabled = true;</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineminus">-          gSoundUrlButton.disabled = true;</span>
<a href="#l5.197"></a><span id="l5.197" class="difflineminus">-          gPreviewSoundButton.disabled = true;</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineminus">-          gIconCheckbox.disabled = true;</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineminus">-        }</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineminus">-        else {</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineminus">-          gSoundCheckbox.disabled = false;</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineminus">-          gSoundUrlBox.disabled = false;</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineminus">-          gSoundUrlButton.disabled = false;</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineminus">-          gPreviewSoundButton.disabled = false;</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineminus">-          gIconCheckbox.disabled = false;</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineminus">-                  </span>
<a href="#l5.207"></a><span id="l5.207" class="difflineminus">-          enableSoundUrl(gSoundCheckbox.checked);</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineminus">-        }</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineminus">-      }</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineminus">-</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineminus">-      function selectSound() {</span>
<a href="#l5.212"></a><span id="l5.212" class="difflineminus">-        var nsIFilePicker = Components.interfaces.nsIFilePicker;</span>
<a href="#l5.213"></a><span id="l5.213" class="difflineminus">-        var filepicker = Components.classes[&quot;@mozilla.org/filepicker;1&quot;]</span>
<a href="#l5.214"></a><span id="l5.214" class="difflineminus">-                                   .createInstance(nsIFilePicker);</span>
<a href="#l5.215"></a><span id="l5.215" class="difflineminus">-</span>
<a href="#l5.216"></a><span id="l5.216" class="difflineminus">-        filepicker.init(window, document.getElementById(&quot;selectSound&quot;).getAttribute(&quot;filepickertitle&quot;), nsIFilePicker.modeOpen);</span>
<a href="#l5.217"></a><span id="l5.217" class="difflineminus">-        filepicker.appendFilters(nsIFilePicker.filterAll);</span>
<a href="#l5.218"></a><span id="l5.218" class="difflineminus">-</span>
<a href="#l5.219"></a><span id="l5.219" class="difflineminus">-        var ret = filepicker.show();</span>
<a href="#l5.220"></a><span id="l5.220" class="difflineminus">-        if (ret == nsIFilePicker.returnOK)</span>
<a href="#l5.221"></a><span id="l5.221" class="difflineminus">-          gSoundUrlBox.value = filepicker.file.path;</span>
<a href="#l5.222"></a><span id="l5.222" class="difflineminus">-        </span>
<a href="#l5.223"></a><span id="l5.223" class="difflineminus">-        onSoundInput();</span>
<a href="#l5.224"></a><span id="l5.224" class="difflineminus">-      }</span>
<a href="#l5.225"></a><span id="l5.225" class="difflineminus">-</span>
<a href="#l5.226"></a><span id="l5.226" class="difflineminus">-      function previewSound() {</span>
<a href="#l5.227"></a><span id="l5.227" class="difflineminus">-        var soundUrl = gSoundUrlBox.value;</span>
<a href="#l5.228"></a><span id="l5.228" class="difflineminus">-        var sound = Components.classes[&quot;@mozilla.org/sound;1&quot;]</span>
<a href="#l5.229"></a><span id="l5.229" class="difflineminus">-                              .createInstance(Components.interfaces.nsISound);</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineminus">-        if (soundUrl.indexOf(&quot;file://&quot;) == -1) {</span>
<a href="#l5.231"></a><span id="l5.231" class="difflineminus">-          sound.playSystemSound(soundUrl);</span>
<a href="#l5.232"></a><span id="l5.232" class="difflineminus">-        }</span>
<a href="#l5.233"></a><span id="l5.233" class="difflineminus">-        else {</span>
<a href="#l5.234"></a><span id="l5.234" class="difflineminus">-          var url = Components.classes[&quot;@mozilla.org/network/standard-url;1&quot;]</span>
<a href="#l5.235"></a><span id="l5.235" class="difflineminus">-                              .createInstance(Components.interfaces.nsIURL);</span>
<a href="#l5.236"></a><span id="l5.236" class="difflineminus">-          url.spec = soundUrl;</span>
<a href="#l5.237"></a><span id="l5.237" class="difflineminus">-          sound.play(url)</span>
<a href="#l5.238"></a><span id="l5.238" class="difflineminus">-        }        </span>
<a href="#l5.239"></a><span id="l5.239" class="difflineminus">-      }</span>
<a href="#l5.240"></a><span id="l5.240" class="difflineminus">-</span>
<a href="#l5.241"></a><span id="l5.241" class="difflineminus">-      function enableSoundUrl(soundChecked) {</span>
<a href="#l5.242"></a><span id="l5.242" class="difflineminus">-        gSoundUrlBox.disabled = !soundChecked;</span>
<a href="#l5.243"></a><span id="l5.243" class="difflineminus">-        gSoundUrlButton.disabled = !soundChecked;</span>
<a href="#l5.244"></a><span id="l5.244" class="difflineminus">-        if (soundChecked &amp;&amp; gSoundUrlBox.value) {</span>
<a href="#l5.245"></a><span id="l5.245" class="difflineminus">-          gPreviewSoundButton.disabled = false;</span>
<a href="#l5.246"></a><span id="l5.246" class="difflineminus">-        }</span>
<a href="#l5.247"></a><span id="l5.247" class="difflineminus">-        else</span>
<a href="#l5.248"></a><span id="l5.248" class="difflineminus">-          gPreviewSoundButton.disabled = true;</span>
<a href="#l5.249"></a><span id="l5.249" class="difflineminus">-      }</span>
<a href="#l5.250"></a><span id="l5.250" class="difflineminus">-</span>
<a href="#l5.251"></a><span id="l5.251" class="difflineminus">-      function onSoundInput() {</span>
<a href="#l5.252"></a><span id="l5.252" class="difflineminus">-        gPreviewSoundButton.disabled = gSoundUrlBox.value == &quot;&quot;;</span>
<a href="#l5.253"></a><span id="l5.253" class="difflineminus">-      }</span>
<a href="#l5.254"></a><span id="l5.254" class="difflineminus">-</span>
<a href="#l5.255"></a><span id="l5.255" class="difflineminus">-    ]]&gt;</span>
<a href="#l5.256"></a><span id="l5.256" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l5.257"></a><span id="l5.257" class="difflineminus">-</span>
<a href="#l5.258"></a><span id="l5.258" class="difflineminus">-  &lt;groupbox id=&quot;popupsArea&quot;&gt;</span>
<a href="#l5.259"></a><span id="l5.259" class="difflineminus">-    &lt;caption label=&quot;&amp;pref.popups.caption;&quot;/&gt;</span>
<a href="#l5.260"></a><span id="l5.260" class="difflineminus">-</span>
<a href="#l5.261"></a><span id="l5.261" class="difflineminus">-    &lt;hbox align=&quot;center&quot;&gt;      </span>
<a href="#l5.262"></a><span id="l5.262" class="difflineminus">-      &lt;checkbox id=&quot;popupPolicy&quot; label=&quot;&amp;popupBlock.label;&quot; accesskey=&quot;&amp;popupBlock.accesskey;&quot;</span>
<a href="#l5.263"></a><span id="l5.263" class="difflineminus">-                oncommand=&quot;setButtons()&quot;</span>
<a href="#l5.264"></a><span id="l5.264" class="difflineminus">-                preftype=&quot;bool&quot; prefstring=&quot;dom.disable_open_during_load&quot;</span>
<a href="#l5.265"></a><span id="l5.265" class="difflineminus">-                prefattribute=&quot;checked&quot;/&gt;   </span>
<a href="#l5.266"></a><span id="l5.266" class="difflineminus">-            &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l5.267"></a><span id="l5.267" class="difflineminus">-      &lt;button id=&quot;exceptionsButton&quot; label=&quot;&amp;popupExceptions.label;&quot;</span>
<a href="#l5.268"></a><span id="l5.268" class="difflineminus">-              accesskey=&quot;&amp;popupExceptions.accesskey;&quot;</span>
<a href="#l5.269"></a><span id="l5.269" class="difflineminus">-                    oncommand=&quot;viewPopups('');&quot;/&gt;</span>
<a href="#l5.270"></a><span id="l5.270" class="difflineminus">-          &lt;/hbox&gt;</span>
<a href="#l5.271"></a><span id="l5.271" class="difflineminus">-    &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l5.272"></a><span id="l5.272" class="difflineminus">-    &lt;description id=&quot;whenBlock&quot;&gt;&amp;whenBlock.description;&lt;/description&gt;</span>
<a href="#l5.273"></a><span id="l5.273" class="difflineminus">-    &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l5.274"></a><span id="l5.274" class="difflineminus">-      &lt;checkbox id=&quot;playSound&quot; label=&quot;&amp;playSound.label;&quot;</span>
<a href="#l5.275"></a><span id="l5.275" class="difflineminus">-                accesskey=&quot;&amp;playSound.accesskey;&quot;</span>
<a href="#l5.276"></a><span id="l5.276" class="difflineminus">-                oncommand=&quot;enableSoundUrl(this.checked);&quot;</span>
<a href="#l5.277"></a><span id="l5.277" class="difflineminus">-                preftype=&quot;bool&quot; prefstring=&quot;privacy.popups.sound_enabled&quot;</span>
<a href="#l5.278"></a><span id="l5.278" class="difflineminus">-                prefattribute=&quot;checked&quot;/&gt;</span>
<a href="#l5.279"></a><span id="l5.279" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l5.280"></a><span id="l5.280" class="difflineminus">-    &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l5.281"></a><span id="l5.281" class="difflineminus">-      &lt;textbox flex=&quot;1&quot; id=&quot;playSoundUrl&quot;</span>
<a href="#l5.282"></a><span id="l5.282" class="difflineminus">-               prefstring=&quot;privacy.popups.sound_url&quot; oninput=&quot;onSoundInput()&quot;/&gt;</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineminus">-      &lt;button id=&quot;selectSound&quot; label=&quot;&amp;selectSound.label;&quot; accesskey=&quot;&amp;selectSound.accesskey;&quot;</span>
<a href="#l5.284"></a><span id="l5.284" class="difflineminus">-              filepickertitle=&quot;&amp;selectSound.title;&quot; oncommand=&quot;selectSound();&quot;/&gt;</span>
<a href="#l5.285"></a><span id="l5.285" class="difflineminus">-      &lt;button id=&quot;previewSound&quot; label=&quot;&amp;previewSound.label;&quot; accesskey=&quot;&amp;previewSound.accesskey;&quot;</span>
<a href="#l5.286"></a><span id="l5.286" class="difflineminus">-              oncommand=&quot;previewSound();&quot;/&gt;</span>
<a href="#l5.287"></a><span id="l5.287" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l5.288"></a><span id="l5.288" class="difflineminus">-    &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l5.289"></a><span id="l5.289" class="difflineminus">-      &lt;checkbox id=&quot;displayIcon&quot; label=&quot;&amp;displayIcon.label;&quot;</span>
<a href="#l5.290"></a><span id="l5.290" class="difflineminus">-                accesskey=&quot;&amp;displayIcon.accesskey;&quot;</span>
<a href="#l5.291"></a><span id="l5.291" class="difflineminus">-                preftype=&quot;bool&quot; prefstring=&quot;privacy.popups.statusbar_icon_enabled&quot;</span>
<a href="#l5.292"></a><span id="l5.292" class="difflineminus">-                prefattribute=&quot;checked&quot;/&gt;</span>
<a href="#l5.293"></a><span id="l5.293" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l5.294"></a><span id="l5.294" class="difflineminus">-    &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l5.295"></a><span id="l5.295" class="difflineminus">-    &lt;description&gt;&amp;popupNote.description;&lt;/description&gt;</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineminus">-    &lt;data id=&quot;prefillWhitelist&quot; preftype=&quot;bool&quot; prefattribute=&quot;value&quot; prefstring=&quot;privacy.popups.prefill_whitelist&quot;/&gt;</span>
<a href="#l5.297"></a><span id="l5.297" class="difflineminus">-    &lt;data id=&quot;removeBlacklist&quot; preftype=&quot;bool&quot; prefattribute=&quot;value&quot; prefstring=&quot;privacy.popups.remove_blacklist&quot;/&gt;</span>
<a href="#l5.298"></a><span id="l5.298" class="difflineminus">-  &lt;/groupbox&gt;</span>
<a href="#l5.299"></a><span id="l5.299" class="difflineminus">-</span>
<a href="#l5.300"></a><span id="l5.300" class="difflineminus">-&lt;/page&gt;</span>
<a href="#l5.301"></a><span id="l5.301" class="difflineplus">+      &lt;hbox&gt;      </span>
<a href="#l5.302"></a><span id="l5.302" class="difflineplus">+        &lt;checkbox id=&quot;popupPolicy&quot;</span>
<a href="#l5.303"></a><span id="l5.303" class="difflineplus">+                  label=&quot;&amp;popupBlock.label;&quot;</span>
<a href="#l5.304"></a><span id="l5.304" class="difflineplus">+                  accesskey=&quot;&amp;popupBlock.accesskey;&quot;</span>
<a href="#l5.305"></a><span id="l5.305" class="difflineplus">+                  preference=&quot;dom.disable_open_during_load&quot;/&gt;   </span>
<a href="#l5.306"></a><span id="l5.306" class="difflineplus">+        &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l5.307"></a><span id="l5.307" class="difflineplus">+        &lt;button id=&quot;exceptionsButton&quot;</span>
<a href="#l5.308"></a><span id="l5.308" class="difflineplus">+                label=&quot;&amp;popupExceptions.label;&quot;</span>
<a href="#l5.309"></a><span id="l5.309" class="difflineplus">+                accesskey=&quot;&amp;popupExceptions.accesskey;&quot;</span>
<a href="#l5.310"></a><span id="l5.310" class="difflineplus">+                preference=&quot;pref.advanced.popups.disable_button.view_popups&quot;</span>
<a href="#l5.311"></a><span id="l5.311" class="difflineplus">+                oncommand=&quot;viewPopups('');&quot;/&gt;</span>
<a href="#l5.312"></a><span id="l5.312" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l5.313"></a><span id="l5.313" class="difflineplus">+      &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l5.314"></a><span id="l5.314" class="difflineplus">+      &lt;description id=&quot;whenBlock&quot;&gt;&amp;whenBlock.description;&lt;/description&gt;</span>
<a href="#l5.315"></a><span id="l5.315" class="difflineplus">+      &lt;hbox&gt;</span>
<a href="#l5.316"></a><span id="l5.316" class="difflineplus">+        &lt;checkbox id=&quot;playSound&quot;</span>
<a href="#l5.317"></a><span id="l5.317" class="difflineplus">+                  label=&quot;&amp;playSound.label;&quot;</span>
<a href="#l5.318"></a><span id="l5.318" class="difflineplus">+                  accesskey=&quot;&amp;playSound.accesskey;&quot;</span>
<a href="#l5.319"></a><span id="l5.319" class="difflineplus">+                  preference=&quot;privacy.popups.sound_enabled&quot;/&gt;</span>
<a href="#l5.320"></a><span id="l5.320" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l5.321"></a><span id="l5.321" class="difflineplus">+      &lt;hbox class=&quot;indent&quot;&gt;</span>
<a href="#l5.322"></a><span id="l5.322" class="difflineplus">+        &lt;radiogroup id=&quot;popupSoundType&quot;</span>
<a href="#l5.323"></a><span id="l5.323" class="difflineplus">+                    preference=&quot;privacy.popups.sound_type&quot;</span>
<a href="#l5.324"></a><span id="l5.324" class="difflineplus">+                    aria-labelledby=&quot;playSound&quot;&gt;</span>
<a href="#l5.325"></a><span id="l5.325" class="difflineplus">+          &lt;radio id=&quot;popupSystemSound&quot;</span>
<a href="#l5.326"></a><span id="l5.326" class="difflineplus">+                 class=&quot;iconic&quot;</span>
<a href="#l5.327"></a><span id="l5.327" class="difflineplus">+                 value=&quot;0&quot;</span>
<a href="#l5.328"></a><span id="l5.328" class="difflineplus">+                 label=&quot;&amp;systemSound.label;&quot;</span>
<a href="#l5.329"></a><span id="l5.329" class="difflineplus">+                 accesskey=&quot;&amp;systemSound.accesskey;&quot;/&gt;</span>
<a href="#l5.330"></a><span id="l5.330" class="difflineplus">+          &lt;radio id=&quot;popupCustomSound&quot;</span>
<a href="#l5.331"></a><span id="l5.331" class="difflineplus">+                 class=&quot;iconic&quot;</span>
<a href="#l5.332"></a><span id="l5.332" class="difflineplus">+                 value=&quot;1&quot;</span>
<a href="#l5.333"></a><span id="l5.333" class="difflineplus">+                 label=&quot;&amp;customSound.label;&quot;</span>
<a href="#l5.334"></a><span id="l5.334" class="difflineplus">+                 accesskey=&quot;&amp;customSound.accesskey;&quot;/&gt;</span>
<a href="#l5.335"></a><span id="l5.335" class="difflineplus">+        &lt;/radiogroup&gt;</span>
<a href="#l5.336"></a><span id="l5.336" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l5.337"></a><span id="l5.337" class="difflineplus">+      &lt;hbox class=&quot;indent&quot;&gt;</span>
<a href="#l5.338"></a><span id="l5.338" class="difflineplus">+        &lt;filefield id=&quot;playSoundUrl&quot;</span>
<a href="#l5.339"></a><span id="l5.339" class="difflineplus">+                   flex=&quot;1&quot;</span>
<a href="#l5.340"></a><span id="l5.340" class="difflineplus">+                   preference=&quot;privacy.popups.sound_url&quot;</span>
<a href="#l5.341"></a><span id="l5.341" class="difflineplus">+                   preference-editable=&quot;true&quot;</span>
<a href="#l5.342"></a><span id="l5.342" class="difflineplus">+                   onsyncfrompreference=&quot;return document.getElementById('popups_pane').ReadSoundLocation(this);&quot;</span>
<a href="#l5.343"></a><span id="l5.343" class="difflineplus">+                   aria-labelledby=&quot;popupCustomSound&quot;/&gt;</span>
<a href="#l5.344"></a><span id="l5.344" class="difflineplus">+        &lt;button id=&quot;selectSound&quot;</span>
<a href="#l5.345"></a><span id="l5.345" class="difflineplus">+                label=&quot;&amp;selectSound.label;&quot;</span>
<a href="#l5.346"></a><span id="l5.346" class="difflineplus">+                accesskey=&quot;&amp;selectSound.accesskey;&quot;</span>
<a href="#l5.347"></a><span id="l5.347" class="difflineplus">+                preference=&quot;pref.advanced.popups.disable_button.select_sound&quot;</span>
<a href="#l5.348"></a><span id="l5.348" class="difflineplus">+                filepickertitle=&quot;&amp;selectSound.title;&quot;</span>
<a href="#l5.349"></a><span id="l5.349" class="difflineplus">+                filepickerfilter=&quot;&amp;selectSound.filter;&quot;</span>
<a href="#l5.350"></a><span id="l5.350" class="difflineplus">+                oncommand=&quot;SelectSound();&quot;/&gt;</span>
<a href="#l5.351"></a><span id="l5.351" class="difflineplus">+        &lt;button id=&quot;previewSound&quot;</span>
<a href="#l5.352"></a><span id="l5.352" class="difflineplus">+                label=&quot;&amp;previewSound.label;&quot;</span>
<a href="#l5.353"></a><span id="l5.353" class="difflineplus">+                accesskey=&quot;&amp;previewSound.accesskey;&quot;</span>
<a href="#l5.354"></a><span id="l5.354" class="difflineplus">+                preference=&quot;pref.advanced.popups.disable_button.preview_sound&quot;</span>
<a href="#l5.355"></a><span id="l5.355" class="difflineplus">+                oncommand=&quot;PreviewSound();&quot;/&gt;</span>
<a href="#l5.356"></a><span id="l5.356" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l5.357"></a><span id="l5.357" class="difflineplus">+      &lt;hbox&gt;</span>
<a href="#l5.358"></a><span id="l5.358" class="difflineplus">+        &lt;checkbox id=&quot;displayIcon&quot;</span>
<a href="#l5.359"></a><span id="l5.359" class="difflineplus">+                  label=&quot;&amp;displayIcon.label;&quot;</span>
<a href="#l5.360"></a><span id="l5.360" class="difflineplus">+                  accesskey=&quot;&amp;displayIcon.accesskey;&quot;</span>
<a href="#l5.361"></a><span id="l5.361" class="difflineplus">+                  preference=&quot;privacy.popups.statusbar_icon_enabled&quot;/&gt;</span>
<a href="#l5.362"></a><span id="l5.362" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l5.363"></a><span id="l5.363" class="difflineplus">+      &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l5.364"></a><span id="l5.364" class="difflineplus">+      &lt;description&gt;&amp;popupNote.description;&lt;/description&gt;</span>
<a href="#l5.365"></a><span id="l5.365" class="difflineplus">+    &lt;/groupbox&gt;</span>
<a href="#l5.366"></a><span id="l5.366" class="difflineplus">+  &lt;/prefpane&gt;</span>
<a href="#l5.367"></a><span id="l5.367" class="difflineplus">+&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/suite/common/pref/preferences.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/suite/common/pref/preferences.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -157,20 +157,22 @@</span>
<a href="#l6.4"></a><span id="l6.4">                 url=&quot;chrome://communicator/content/pref/pref-security.xul&quot;&gt;</span>
<a href="#l6.5"></a><span id="l6.5">         &lt;treechildren id=&quot;securityChildren&quot;&gt;</span>
<a href="#l6.6"></a><span id="l6.6">           &lt;treeitem id=&quot;cookiesItem&quot; label=&quot;&amp;cookies.label;&quot;</span>
<a href="#l6.7"></a><span id="l6.7">                     prefpane=&quot;cookies_pane&quot; helpTopic=&quot;cookies_prefs&quot;</span>
<a href="#l6.8"></a><span id="l6.8">                     url=&quot;chrome://communicator/content/pref/pref-cookies.xul&quot;/&gt;</span>
<a href="#l6.9"></a><span id="l6.9">           &lt;treeitem id=&quot;imagesItem&quot; label=&quot;&amp;images.label;&quot;</span>
<a href="#l6.10"></a><span id="l6.10">                     prefpane=&quot;images_pane&quot; helpTopic=&quot;images_prefs&quot;</span>
<a href="#l6.11"></a><span id="l6.11">                     url=&quot;chrome://communicator/content/pref/pref-images.xul&quot;/&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+          &lt;treeitem id=&quot;popupsItem&quot;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+                    label=&quot;&amp;popups.label;&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+                    prefpane=&quot;popups_pane&quot;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+                    helpTopic=&quot;pop_up_blocking&quot;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+                    url=&quot;chrome://communicator/content/pref/pref-popups.xul&quot;/&gt;</span>
<a href="#l6.17"></a><span id="l6.17"> &lt;!--</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-          &lt;treeitem id=&quot;popupspref&quot;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-                    label=&quot;&amp;popups.label;&quot;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-                    url=&quot;chrome://communicator/content/pref/pref-popups.xul&quot;/&gt;</span>
<a href="#l6.21"></a><span id="l6.21">           &lt;treeitem id=&quot;masterpassItem&quot;</span>
<a href="#l6.22"></a><span id="l6.22">                     label=&quot;&amp;masterpass.label;&quot;</span>
<a href="#l6.23"></a><span id="l6.23">                     prefpane=&quot;masterpass_pane&quot;</span>
<a href="#l6.24"></a><span id="l6.24">                     url=&quot;chrome://pippki/content/pref-masterpass.xul&quot;</span>
<a href="#l6.25"></a><span id="l6.25">                     helpTopic=&quot;passwords_master&quot;/&gt;</span>
<a href="#l6.26"></a><span id="l6.26">           &lt;treeitem id=&quot;sslItem&quot;</span>
<a href="#l6.27"></a><span id="l6.27">                     label=&quot;&amp;ssl.label;&quot;</span>
<a href="#l6.28"></a><span id="l6.28">                     prefpane=&quot;ssl_pane&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/suite/common/pref/preftree.xul</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/suite/common/pref/preftree.xul</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -134,18 +134,17 @@</span>
<a href="#l7.4"></a><span id="l7.4">         &lt;/treeitem&gt;</span>
<a href="#l7.5"></a><span id="l7.5">         &lt;treeitem&gt;</span>
<a href="#l7.6"></a><span id="l7.6">           &lt;treerow&gt;</span>
<a href="#l7.7"></a><span id="l7.7">             &lt;treecell label=&quot;(Migrated: &amp;images.label;)&quot;/&gt; </span>
<a href="#l7.8"></a><span id="l7.8">           &lt;/treerow&gt;</span>
<a href="#l7.9"></a><span id="l7.9">         &lt;/treeitem&gt;</span>
<a href="#l7.10"></a><span id="l7.10">         &lt;treeitem id=&quot;popupspref&quot;&gt;</span>
<a href="#l7.11"></a><span id="l7.11">           &lt;treerow&gt;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-            &lt;treecell url=&quot;chrome://communicator/content/pref/pref-popups.xul&quot;</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-                      label=&quot;&amp;popups.label;&quot;/&gt; </span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+            &lt;treecell label=&quot;(Migrated: &amp;popups.label;)&quot;/&gt; </span>
<a href="#l7.15"></a><span id="l7.15">           &lt;/treerow&gt;</span>
<a href="#l7.16"></a><span id="l7.16">         &lt;/treeitem&gt;</span>
<a href="#l7.17"></a><span id="l7.17">       &lt;/treechildren&gt;</span>
<a href="#l7.18"></a><span id="l7.18">     &lt;/treeitem&gt;</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20">     &lt;treeitem container=&quot;true&quot; id=&quot;advancedItem&quot;&gt;</span>
<a href="#l7.21"></a><span id="l7.21">       &lt;treerow&gt;</span>
<a href="#l7.22"></a><span id="l7.22">         &lt;treecell label=&quot;(Migrated: &amp;advance.label;)&quot;/&gt; </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/pref/pref-popups.dtd</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/pref/pref-popups.dtd</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -7,21 +7,26 @@</span>
<a href="#l8.4"></a><span id="l8.4"> &lt;!ENTITY popupBlock.label               &quot;Block unrequested popup windows&quot;&gt;</span>
<a href="#l8.5"></a><span id="l8.5"> &lt;!ENTITY popupBlock.accesskey           &quot;B&quot;&gt;</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7"> &lt;!ENTITY popupExceptions.label          &quot;Allowed Sites&quot;&gt;</span>
<a href="#l8.8"></a><span id="l8.8"> &lt;!ENTITY popupExceptions.accesskey      &quot;A&quot;&gt;</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10"> &lt;!ENTITY whenBlock.description          &quot;When a popup window has been blocked:&quot;&gt;</span>
<a href="#l8.11"></a><span id="l8.11"> &lt;!ENTITY playSound.label                &quot;Play a sound:&quot;&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-&lt;!ENTITY playSound.accesskey            &quot;s&quot;&gt;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+&lt;!ENTITY playSound.accesskey            &quot;P&quot;&gt;</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+&lt;!ENTITY systemSound.label              &quot;System beep&quot;&gt;</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+&lt;!ENTITY systemSound.accesskey          &quot;S&quot;&gt;</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+&lt;!ENTITY customSound.label              &quot;Custom sound file&quot;&gt;</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+&lt;!ENTITY customSound.accesskey          &quot;C&quot;&gt;</span>
<a href="#l8.18"></a><span id="l8.18"> </span>
<a href="#l8.19"></a><span id="l8.19"> &lt;!ENTITY selectSound.label              &quot;Browse&quot;&gt;</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineminus">-&lt;!ENTITY selectSound.accesskey          &quot;r&quot;&gt;</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+&lt;!ENTITY selectSound.accesskey          &quot;o&quot;&gt;</span>
<a href="#l8.22"></a><span id="l8.22"> &lt;!ENTITY previewSound.label             &quot;Preview&quot;&gt;</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineminus">-&lt;!ENTITY previewSound.accesskey         &quot;P&quot;&gt;</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+&lt;!ENTITY previewSound.accesskey         &quot;v&quot;&gt;</span>
<a href="#l8.25"></a><span id="l8.25"> &lt;!ENTITY selectSound.title              &quot;Select Popup Block Sound&quot;&gt;</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+&lt;!ENTITY selectSound.filter             &quot;Sounds&quot;&gt;</span>
<a href="#l8.27"></a><span id="l8.27"> </span>
<a href="#l8.28"></a><span id="l8.28"> &lt;!ENTITY displayIcon.label              &quot;Display an icon in the browser status bar&quot;&gt;</span>
<a href="#l8.29"></a><span id="l8.29"> &lt;!ENTITY displayIcon.accesskey          &quot;D&quot;&gt;</span>
<a href="#l8.30"></a><span id="l8.30"> </span>
<a href="#l8.31"></a><span id="l8.31"> &lt;!ENTITY popupNote.description          &quot;Note: Blocking all popups may prevent important features of some websites from working, such as login windows for banks and shopping sites. For details of how to allow specific sites to use popups while blocking all others, click Help. Even if blocked, sites may use other methods to show popups.&quot;&gt;</span>
<a href="#l8.32"></a><span id="l8.32"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/suite/profile/migration/src/nsSeamonkeyProfileMigrator.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -548,16 +548,24 @@ nsSeamonkeyProfileMigrator::PrefTransfor</span>
<a href="#l9.4"></a><span id="l9.4">   MAKESAMETYPEPREFTRANSFORM(&quot;offline.download.download_messages&quot;,      Int),</span>
<a href="#l9.5"></a><span id="l9.5">   MAKESAMETYPEPREFTRANSFORM(&quot;offline.send.unsent_messages&quot;,            Int),</span>
<a href="#l9.6"></a><span id="l9.6">   MAKESAMETYPEPREFTRANSFORM(&quot;offline.startup_state&quot;,                   Int),</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">   MAKESAMETYPEPREFTRANSFORM(&quot;permissions.default.image&quot;,               Int),</span>
<a href="#l9.9"></a><span id="l9.9">   MAKESAMETYPEPREFTRANSFORM(&quot;plugin.override_internal_types&quot;,          Bool),</span>
<a href="#l9.10"></a><span id="l9.10">   MAKESAMETYPEPREFTRANSFORM(&quot;plugin.expose_full_path&quot;,                 Bool),</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+  MAKESAMETYPEPREFTRANSFORM(&quot;privacy.popups.disable_from_plugins&quot;,     Int),</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+  MAKESAMETYPEPREFTRANSFORM(&quot;privacy.popups.prefill_whitelist&quot;,        Bool),</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+  MAKESAMETYPEPREFTRANSFORM(&quot;privacy.popups.remove_blacklist&quot;,         Bool),</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+  MAKESAMETYPEPREFTRANSFORM(&quot;privacy.popups.showBrowserMessage&quot;,       Bool),</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+  MAKESAMETYPEPREFTRANSFORM(&quot;privacy.popups.sound_enabled&quot;,            Bool),</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+  MAKEPREFTRANSFORM(&quot;privacy.popups.sound_url&quot;, &quot;privacy.popups.sound_type&quot;, String, File),</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+  MAKESAMETYPEPREFTRANSFORM(&quot;privacy.popups.statusbar_icon_enabled&quot;,   Bool),</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+</span>
<a href="#l9.20"></a><span id="l9.20">   MAKESAMETYPEPREFTRANSFORM(&quot;security.default_personal_cert&quot;,          String),</span>
<a href="#l9.21"></a><span id="l9.21">   MAKESAMETYPEPREFTRANSFORM(&quot;security.enable_ssl2&quot;,                    Bool),</span>
<a href="#l9.22"></a><span id="l9.22">   MAKESAMETYPEPREFTRANSFORM(&quot;security.enable_ssl3&quot;,                    Bool),</span>
<a href="#l9.23"></a><span id="l9.23">   MAKESAMETYPEPREFTRANSFORM(&quot;security.enable_tls&quot;,                     Bool),</span>
<a href="#l9.24"></a><span id="l9.24">   MAKESAMETYPEPREFTRANSFORM(&quot;security.enable_java&quot;,                    Bool),</span>
<a href="#l9.25"></a><span id="l9.25">   MAKESAMETYPEPREFTRANSFORM(&quot;security.password_lifetime&quot;,              Int),</span>
<a href="#l9.26"></a><span id="l9.26">   MAKESAMETYPEPREFTRANSFORM(&quot;security.warn_entering_secure&quot;,           Bool),</span>
<a href="#l9.27"></a><span id="l9.27">   MAKESAMETYPEPREFTRANSFORM(&quot;security.warn_entering_weak&quot;,             Bool),</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineat">@@ -648,17 +656,18 @@ nsSeamonkeyProfileMigrator::TransformPre</span>
<a href="#l9.29"></a><span id="l9.29">     &quot;mail.toolbars.&quot;,</span>
<a href="#l9.30"></a><span id="l9.30">     &quot;mailnews.labels.&quot;,</span>
<a href="#l9.31"></a><span id="l9.31">     &quot;mailnews.reply_&quot;,</span>
<a href="#l9.32"></a><span id="l9.32">     &quot;mailnews.tags.&quot;,</span>
<a href="#l9.33"></a><span id="l9.33">     &quot;middlemouse.&quot;,</span>
<a href="#l9.34"></a><span id="l9.34">     &quot;mousewheel.&quot;,</span>
<a href="#l9.35"></a><span id="l9.35">     &quot;network.http.&quot;,</span>
<a href="#l9.36"></a><span id="l9.36">     &quot;print.&quot;,</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineminus">-    &quot;privacy.&quot;,</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+    &quot;privacy.item.&quot;,</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+    &quot;privacy.sanitize.&quot;,</span>
<a href="#l9.40"></a><span id="l9.40">     &quot;security.OSCP.&quot;,</span>
<a href="#l9.41"></a><span id="l9.41">     &quot;security.crl.&quot;,</span>
<a href="#l9.42"></a><span id="l9.42">     &quot;ui.key.&quot;</span>
<a href="#l9.43"></a><span id="l9.43">   };</span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45">   PBStructArray branches[NS_ARRAY_LENGTH(branchNames)];</span>
<a href="#l9.46"></a><span id="l9.46">   PRUint32 i;</span>
<a href="#l9.47"></a><span id="l9.47">   for (i = 0; i &lt; NS_ARRAY_LENGTH(branchNames); ++i)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

