<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 19453:a6468040d468e4b88e0f2dbf812a3662014982bf</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ a6468040d468e4b88e0f2dbf812a3662014982bf" />
<meta property="og:url" content="/comm-central/rev/a6468040d468e4b88e0f2dbf812a3662014982bf" />
<meta property="og:description" content="Bug 1231098 - attached webpage (url) not displayed in event invitation;r=philipp" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / a6468040d468e4b88e0f2dbf812a3662014982bf 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/a6468040d468e4b88e0f2dbf812a3662014982bf">shortlog</a> |
<a href="/comm-central/log/a6468040d468e4b88e0f2dbf812a3662014982bf">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/a6468040d468e4b88e0f2dbf812a3662014982bf">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/a6468040d468e4b88e0f2dbf812a3662014982bf">files</a> |
changeset |
<a href="/comm-central/raw-rev/a6468040d468e4b88e0f2dbf812a3662014982bf">raw</a>  | <a href="/comm-central/archive/a6468040d468e4b88e0f2dbf812a3662014982bf.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1231098">Bug 1231098</a> - attached webpage (url) not displayed in event invitation;r=philipp
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#107;&#101;&#77;&#121;&#68;&#97;&#121;&#32;&#60;&#109;&#97;&#107;&#101;&#109;&#121;&#100;&#97;&#121;&#64;&#103;&#109;&#120;&#45;&#116;&#111;&#112;&#109;&#97;&#105;&#108;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 11 Jun 2016 12:55:36 +0200</td></tr>

<tr>
 <td>changeset 19453</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/a6468040d468e4b88e0f2dbf812a3662014982bf">a6468040d468e4b88e0f2dbf812a3662014982bf</a></td>
</tr>



<tr>
<td>parent 19452</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e7e4387b20c4d4837d2d7245f9a2e47ba42cb253">e7e4387b20c4d4837d2d7245f9a2e47ba42cb253</a>
</td>
</tr>

<tr>
<td>child 19454</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/092a6d3d82f1ee2045563cc5ba59ce042b96cc72">092a6d3d82f1ee2045563cc5ba59ce042b96cc72</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=a6468040d468e4b88e0f2dbf812a3662014982bf">11974</a></td></tr>
<tr><td>push user</td><td>makemyday@gmx-topmail.de</td></tr>
<tr><td>push date</td><td class="date age">Sat, 11 Jun 2016 11:08:31 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@a6468040d468 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a6468040d468e4b88e0f2dbf812a3662014982bf">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a6468040d468e4b88e0f2dbf812a3662014982bf&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a6468040d468e4b88e0f2dbf812a3662014982bf&newProject=comm-central&newRevision=0c0143fa38d8456115d2331c71fb72fb3d05c7c8&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a6468040d468e4b88e0f2dbf812a3662014982bf&newProject=comm-central&newRevision=0c0143fa38d8456115d2331c71fb72fb3d05c7c8&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a6468040d468e4b88e0f2dbf812a3662014982bf&newProject=comm-central&newRevision=0c0143fa38d8456115d2331c71fb72fb3d05c7c8&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philipp%29&revcount=50">philipp</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1231098">1231098</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1231098">Bug 1231098</a> - attached webpage (url) not displayed in event invitation;r=philipp</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/content/lightning-invitation.xhtml">calendar/lightning/content/lightning-invitation.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/content/lightning-invitation.xhtml">file</a> |
<a href="/comm-central/annotate/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/content/lightning-invitation.xhtml">annotate</a> |
<a href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/content/lightning-invitation.xhtml">diff</a> |
<a href="/comm-central/comparison/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/content/lightning-invitation.xhtml">comparison</a> |
<a href="/comm-central/log/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/content/lightning-invitation.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/locales/en-US/chrome/lightning/lightning.properties">calendar/locales/en-US/chrome/lightning/lightning.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/locales/en-US/chrome/lightning/lightning.properties">file</a> |
<a href="/comm-central/annotate/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/locales/en-US/chrome/lightning/lightning.properties">annotate</a> |
<a href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/locales/en-US/chrome/lightning/lightning.properties">diff</a> |
<a href="/comm-central/comparison/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/locales/en-US/chrome/lightning/lightning.properties">comparison</a> |
<a href="/comm-central/log/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/locales/en-US/chrome/lightning/lightning.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/test/unit/test_ltninvitationutils.js">calendar/test/unit/test_ltninvitationutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/test/unit/test_ltninvitationutils.js">file</a> |
<a href="/comm-central/annotate/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/test/unit/test_ltninvitationutils.js">annotate</a> |
<a href="/comm-central/diff/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/test/unit/test_ltninvitationutils.js">diff</a> |
<a href="/comm-central/comparison/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/test/unit/test_ltninvitationutils.js">comparison</a> |
<a href="/comm-central/log/a6468040d468e4b88e0f2dbf812a3662014982bf/calendar/test/unit/test_ltninvitationutils.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/lightning/content/lightning-invitation.xhtml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-invitation.xhtml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -41,26 +41,34 @@</span>
<a href="#l1.4"></a><span id="l1.4">         &lt;td class=&quot;content&quot;&gt;</span>
<a href="#l1.5"></a><span id="l1.5">           &lt;table id=&quot;organizer-table&quot;/&gt;</span>
<a href="#l1.6"></a><span id="l1.6">         &lt;/td&gt;</span>
<a href="#l1.7"></a><span id="l1.7">       &lt;/tr&gt;</span>
<a href="#l1.8"></a><span id="l1.8">       &lt;tr id=&quot;imipHtml-description-row&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l1.9"></a><span id="l1.9">         &lt;td class=&quot;description&quot;&gt;&lt;p id=&quot;imipHtml-description-descr&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.10"></a><span id="l1.10">         &lt;td class=&quot;content&quot;&gt;&lt;p id=&quot;imipHtml-description-content&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.11"></a><span id="l1.11">       &lt;/tr&gt;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+      &lt;tr id=&quot;imipHtml-attachments-row&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+        &lt;td class=&quot;description&quot;&gt;&lt;p id=&quot;imipHtml-attachments-descr&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+        &lt;td class=&quot;content&quot;&gt;&lt;p id=&quot;imipHtml-attachments-content&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+      &lt;/tr&gt;</span>
<a href="#l1.16"></a><span id="l1.16">       &lt;tr id=&quot;imipHtml-comment-row&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l1.17"></a><span id="l1.17">         &lt;td class=&quot;description&quot;&gt;&lt;p id=&quot;imipHtml-comment-descr&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.18"></a><span id="l1.18">         &lt;td class=&quot;content&quot;&gt;&lt;p id=&quot;imipHtml-comment-content&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.19"></a><span id="l1.19">       &lt;/tr&gt;</span>
<a href="#l1.20"></a><span id="l1.20">       &lt;tr id=&quot;imipHtml-attendees-row&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l1.21"></a><span id="l1.21">         &lt;td class=&quot;description&quot;&gt;&lt;p id=&quot;imipHtml-attendees-descr&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.22"></a><span id="l1.22">         &lt;td class=&quot;content&quot;&gt;</span>
<a href="#l1.23"></a><span id="l1.23">           &lt;table id=&quot;attendee-table&quot;&gt;</span>
<a href="#l1.24"></a><span id="l1.24">             &lt;tr id=&quot;attendee-template&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l1.25"></a><span id="l1.25">               &lt;td&gt;&lt;p class=&quot;itip-icon&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.26"></a><span id="l1.26">               &lt;td class=&quot;attendee-name&quot;/&gt;</span>
<a href="#l1.27"></a><span id="l1.27">             &lt;/tr&gt;</span>
<a href="#l1.28"></a><span id="l1.28">           &lt;/table&gt;</span>
<a href="#l1.29"></a><span id="l1.29">         &lt;/td&gt;</span>
<a href="#l1.30"></a><span id="l1.30">       &lt;/tr&gt;</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+      &lt;tr id=&quot;imipHtml-url-row&quot; hidden=&quot;true&quot;&gt;</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+        &lt;td class=&quot;description&quot;&gt;&lt;p id=&quot;imipHtml-url-descr&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+        &lt;td class=&quot;content&quot;&gt;&lt;p id=&quot;imipHtml-url-content&quot;/&gt;&lt;/td&gt;</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+      &lt;/tr&gt;</span>
<a href="#l1.35"></a><span id="l1.35">     &lt;/table&gt;</span>
<a href="#l1.36"></a><span id="l1.36">   &lt;/body&gt;</span>
<a href="#l1.37"></a><span id="l1.37"> &lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -184,16 +184,29 @@ ltn.invitation = {</span>
<a href="#l2.4"></a><span id="l2.4">         field(&quot;comment&quot;, aEvent.getProperty(&quot;COMMENT&quot;), true);</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">         // DESCRIPTION field</span>
<a href="#l2.7"></a><span id="l2.7">         let eventDescription = (aEvent.getProperty(&quot;DESCRIPTION&quot;) || &quot;&quot;)</span>
<a href="#l2.8"></a><span id="l2.8">                                     /* Remove the useless &quot;Outlookism&quot; squiggle. */</span>
<a href="#l2.9"></a><span id="l2.9">                                     .replace(&quot;*~*~*~*~*~*~*~*~*~*&quot;, &quot;&quot;);</span>
<a href="#l2.10"></a><span id="l2.10">         field(&quot;description&quot;, eventDescription, true);</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+        // URL</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        field(&quot;url&quot;, aEvent.getProperty(&quot;URL&quot;), true);</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+        // ATTACH - we only display URI but no BINARY type attachments here</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+        let links = new Array();</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+        let attachments = aEvent.getAttachments({});</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+        for (let attachment of attachments) {</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+            if (attachment.uri) {</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+                links.push(attachment.uri.spec);</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+            }</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+        }</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+        field(&quot;attachments&quot;, links.join(&quot;&lt;br&gt;&quot;), true);</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+</span>
<a href="#l2.25"></a><span id="l2.25">         // ATTENDEE and ORGANIZER fields</span>
<a href="#l2.26"></a><span id="l2.26">         let attendees = aEvent.getAttendees({});</span>
<a href="#l2.27"></a><span id="l2.27">         let attendeeTemplate = doc.getElementById(&quot;attendee-template&quot;);</span>
<a href="#l2.28"></a><span id="l2.28">         let attendeeTable = doc.getElementById(&quot;attendee-table&quot;);</span>
<a href="#l2.29"></a><span id="l2.29">         let organizerTable = doc.getElementById(&quot;organizer-table&quot;);</span>
<a href="#l2.30"></a><span id="l2.30">         doc.getElementById(&quot;imipHtml-attendees-row&quot;).hidden = (attendees.length &lt; 1);</span>
<a href="#l2.31"></a><span id="l2.31">         doc.getElementById(&quot;imipHtml-organizer-row&quot;).hidden = !aEvent.organizer;</span>
<a href="#l2.32"></a><span id="l2.32"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/lightning/lightning.properties</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/lightning/lightning.properties</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -19,18 +19,24 @@ tabTitleTasks=Tasks</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> # Html event display in message</span>
<a href="#l3.6"></a><span id="l3.6"> imipHtml.header=Event Invitation</span>
<a href="#l3.7"></a><span id="l3.7"> imipHtml.summary=Title:</span>
<a href="#l3.8"></a><span id="l3.8"> imipHtml.location=Location:</span>
<a href="#l3.9"></a><span id="l3.9"> imipHtml.when=When:</span>
<a href="#l3.10"></a><span id="l3.10"> imipHtml.organizer=Organizer:</span>
<a href="#l3.11"></a><span id="l3.11"> imipHtml.description=Description:</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+# LOCALIZATION_NOTE(imipHtml.attachments): This is a label for one or more (additional) links to</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+# documents or websites attached to this event.</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+imipHtml.attachments=Attachments:</span>
<a href="#l3.15"></a><span id="l3.15"> imipHtml.comment=Comment:</span>
<a href="#l3.16"></a><span id="l3.16"> imipHtml.attendees=Attendees:</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+# LOCALIZATION_NOTE(imipHtml.url): This is a label for a reference to an (alternate) online</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+# representation of the event (either directly human readable or not).</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+imipHtml.url=Related Link:</span>
<a href="#l3.20"></a><span id="l3.20"> imipHtml.canceledOccurrences=Canceled Occurrences:</span>
<a href="#l3.21"></a><span id="l3.21"> imipHtml.modifiedOccurrences=Modified Occurrences:</span>
<a href="#l3.22"></a><span id="l3.22"> imipHtml.newLocation=New Location: %1$S</span>
<a href="#l3.23"></a><span id="l3.23"> # LOCALIZATION_NOTE(imipHtml.attendeeDelegatedFrom): this is appended behind an attendee name in the</span>
<a href="#l3.24"></a><span id="l3.24"> # email invitation preview - don't add leading/trailing whitespaces here</span>
<a href="#l3.25"></a><span id="l3.25"> # %1$S - a single delegator or a comma separated list of delegators</span>
<a href="#l3.26"></a><span id="l3.26"> imipHtml.attendeeDelegatedFrom=(delegated from %1$S)</span>
<a href="#l3.27"></a><span id="l3.27"> # LOCALIZATION_NOTE(imipHtml.attendeeDelegatedTo): this is appended behind an attendee name in the</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/test/unit/test_ltninvitationutils.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/test/unit/test_ltninvitationutils.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -46,16 +46,18 @@ function getIcs() {</span>
<a href="#l4.4"></a><span id="l4.4">         &quot;ORGANIZER;RSVP=TRUE;CN=Organizer;PARTSTAT=ACCEPTED;ROLE=CHAIR:mailto:organizer@example.net&quot;,</span>
<a href="#l4.5"></a><span id="l4.5">         &quot;ATTENDEE;RSVP=TRUE;CN=Attendee;PARTSTAT=NEEDS-ACTION;ROLE=REQ-PARTICIPANT:mailto:attende&quot; +</span>
<a href="#l4.6"></a><span id="l4.6">         &quot;e@example.net&quot;,</span>
<a href="#l4.7"></a><span id="l4.7">         &quot;DTSTART;TZID=Europe/Berlin:20150909T210000&quot;,</span>
<a href="#l4.8"></a><span id="l4.8">         &quot;DTEND;TZID=Europe/Berlin:20150909T220000&quot;,</span>
<a href="#l4.9"></a><span id="l4.9">         &quot;TRANSP:OPAQUE&quot;,</span>
<a href="#l4.10"></a><span id="l4.10">         &quot;LOCATION:Room 1&quot;,</span>
<a href="#l4.11"></a><span id="l4.11">         &quot;DESCRIPTION:Let us get together&quot;,</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+        &quot;URL:http://www.example.com&quot;,</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+        &quot;ATTACH:http://www.example.com&quot;,</span>
<a href="#l4.14"></a><span id="l4.14">         &quot;END:VEVENT&quot;,</span>
<a href="#l4.15"></a><span id="l4.15">         &quot;END:VCALENDAR&quot;].join(&quot;\r\n&quot;);</span>
<a href="#l4.16"></a><span id="l4.16"> }</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18"> add_task(function* getItipHeader_test() {</span>
<a href="#l4.19"></a><span id="l4.19">     let data = [{</span>
<a href="#l4.20"></a><span id="l4.20">         input: {</span>
<a href="#l4.21"></a><span id="l4.21">             method: &quot;METHOD:REQUEST\r\n&quot;,</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -154,16 +156,50 @@ add_task(function* createInvitationOverl</span>
<a href="#l4.23"></a><span id="l4.23">         input: {</span>
<a href="#l4.24"></a><span id="l4.24">             description: &quot;DESCRIPTION:It's up to you ;-)\r\n&quot;},</span>
<a href="#l4.25"></a><span id="l4.25">         expected: {</span>
<a href="#l4.26"></a><span id="l4.26">             node: &quot;imipHtml-description-content&quot;,</span>
<a href="#l4.27"></a><span id="l4.27">             value: &quot;It's up to you &lt;span xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-smile&quot; +</span>
<a href="#l4.28"></a><span id="l4.28">                    &quot;y-s3\&quot; title=\&quot;;-)\&quot;&gt;&lt;span&gt;;-)&lt;/span&gt;&lt;/span&gt;&quot;}</span>
<a href="#l4.29"></a><span id="l4.29">     }, {</span>
<a href="#l4.30"></a><span id="l4.30">         input: {</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+            url: &quot;URL:http://www.example.org/event.ics\r\n&quot;},</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+        expected: {</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+            node: &quot;imipHtml-url-content&quot;,</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+            value: &quot;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; hre&quot; +</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+                   &quot;f=\&quot;http://www.example.org/event.ics\&quot;&gt;http://www.example.org/event.ics&lt;/a&gt;&quot;}</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+    }, {</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+        input: {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+            attach: &quot;ATTACH:http://www.example.org\r\n&quot;},</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+        expected: {</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+            node: &quot;imipHtml-attachments-content&quot;,</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+            value: &quot;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; hre&quot; +</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+                   &quot;f=\&quot;http://www.example.org/\&quot;&gt;http://www.example.org/&lt;/a&gt;&quot;}</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+    }, {</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+        input: {</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+            attach: &quot;ATTACH;FMTTYPE=text/plain;ENCODING=BASE64;VALUE=BINARY:VGhlIHF1aWNrIGJyb3duI&quot; +</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+                    &quot;GZveCBqdW1wcyBvdmVyIHRoZSBsYXp5IGRvZy4\r\n&quot;},</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+        expected: {</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+            node: &quot;imipHtml-attachments-content&quot;,</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+            value: &quot;&quot;}</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+    }, {</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+        input: {</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+            attach: &quot;ATTACH:http://www.example.org/first/\r\n&quot; +</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+                    &quot;ATTACH:http://www.example.org/second\r\n&quot; +</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+                    &quot;ATTACH:file:///N:/folder/third.file\r\n&quot;},</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+        expected: {</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+            node: &quot;imipHtml-attachments-content&quot;,</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+            value: &quot;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; hre&quot; +</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+                   &quot;f=\&quot;http://www.example.org/first/\&quot;&gt;http://www.example.org/first/&lt;/a&gt;&amp;lt;br&amp;g&quot; +</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+                   &quot;t;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot; h&quot; +</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+                   &quot;ref=\&quot;http://www.example.org/second\&quot;&gt;http://www.example.org/second&lt;/a&gt;&amp;lt;br&quot; +</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+                   &quot;&amp;gt;&lt;a xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; class=\&quot;moz-txt-link-freetext\&quot;&quot; +</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+                   &quot; href=\&quot;file:///N:/folder/third.file\&quot;&gt;file:///N:/folder/third.file&lt;/a&gt;&quot;}</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+    }, {</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+        input: {</span>
<a href="#l4.65"></a><span id="l4.65">             attendee: &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=NEEDS-ACTION;ROLE=OPT-PARTICIPANT;CUTYPE=INDIV&quot; +</span>
<a href="#l4.66"></a><span id="l4.66">                       &quot;IDUAL;CN=\&quot;Attendee 1\&quot;:mailto:attendee1@example.net\r\n&quot; +</span>
<a href="#l4.67"></a><span id="l4.67"> </span>
<a href="#l4.68"></a><span id="l4.68">                       &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=ACCEPTED;ROLE=NON-PARTICIPANT;CUTYPE=GROUP:mai&quot; +</span>
<a href="#l4.69"></a><span id="l4.69">                       &quot;lto:attendee2@example.net\r\n&quot; +</span>
<a href="#l4.70"></a><span id="l4.70"> </span>
<a href="#l4.71"></a><span id="l4.71">                       &quot;ATTENDEE;RSVP=TRUE;PARTSTAT=TENTATIVE;ROLE=REQ-PARTICIPANT;CUTYPE=RESOURCE&quot; +</span>
<a href="#l4.72"></a><span id="l4.72">                       &quot;:mailto:attendee3@example.net\r\n&quot; +</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineat">@@ -248,16 +284,22 @@ add_task(function* createInvitationOverl</span>
<a href="#l4.74"></a><span id="l4.74">                     item = item.replace(/DESCRIPTION:[^\r]+\r\n/, test.input.description);</span>
<a href="#l4.75"></a><span id="l4.75">                     break;</span>
<a href="#l4.76"></a><span id="l4.76">                 case &quot;attendee&quot;:</span>
<a href="#l4.77"></a><span id="l4.77">                     item = item.replace(/ATTENDEE;[^\r]+\r\n/, test.input.attendee);</span>
<a href="#l4.78"></a><span id="l4.78">                     break;</span>
<a href="#l4.79"></a><span id="l4.79">                 case &quot;organizer&quot;:</span>
<a href="#l4.80"></a><span id="l4.80">                     item = item.replace(/ORGANIZER;[^\r]+\r\n/, test.input.organizer);</span>
<a href="#l4.81"></a><span id="l4.81">                     break;</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+                case &quot;attach&quot;:</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+                    item = item.replace(/ATTACH:[^\r]+\r\n/, test.input.attach);</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+                    break;</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+                case &quot;url&quot;:</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+                    item = item.replace(/URL:[^\r]+\r\n/, test.input.url);</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+                    break;</span>
<a href="#l4.88"></a><span id="l4.88">             }</span>
<a href="#l4.89"></a><span id="l4.89">         }</span>
<a href="#l4.90"></a><span id="l4.90">         let itipItem = Components.classes[&quot;@mozilla.org/calendar/itip-item;1&quot;]</span>
<a href="#l4.91"></a><span id="l4.91">                                  .createInstance(Components.interfaces.calIItipItem);</span>
<a href="#l4.92"></a><span id="l4.92">         itipItem.init(item);</span>
<a href="#l4.93"></a><span id="l4.93">         let parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l4.94"></a><span id="l4.94">                                .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l4.95"></a><span id="l4.95">         parser.parseString(item);</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

