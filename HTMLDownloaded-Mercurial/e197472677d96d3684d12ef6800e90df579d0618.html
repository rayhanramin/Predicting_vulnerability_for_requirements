<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 18917:e197472677d96d3684d12ef6800e90df579d0618</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ e197472677d96d3684d12ef6800e90df579d0618" />
<meta property="og:url" content="/comm-central/rev/e197472677d96d3684d12ef6800e90df579d0618" />
<meta property="og:description" content="Bug 1244434 - convert some 'for .. in Iterator(array)' constructs to for..of loops in /mail. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / e197472677d96d3684d12ef6800e90df579d0618 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/e197472677d96d3684d12ef6800e90df579d0618">shortlog</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/e197472677d96d3684d12ef6800e90df579d0618">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618">files</a> |
changeset |
<a href="/comm-central/raw-rev/e197472677d96d3684d12ef6800e90df579d0618">raw</a>  | <a href="/comm-central/archive/e197472677d96d3684d12ef6800e90df579d0618.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1244434">Bug 1244434</a> - convert some 'for .. in Iterator(array)' constructs to for..of loops in /mail. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#97;&#99;&#101;&#109;&#97;&#110;&#32;&#60;&#97;&#99;&#101;&#108;&#105;&#115;&#116;&#115;&#64;&#97;&#116;&#108;&#97;&#115;&#46;&#115;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 30 Jan 2016 23:16:16 +0100</td></tr>

<tr>
 <td>changeset 18917</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/e197472677d96d3684d12ef6800e90df579d0618">e197472677d96d3684d12ef6800e90df579d0618</a></td>
</tr>



<tr>
<td>parent 18916</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bdce18b8b98e4242ca9dd739107ed00fa840e500">bdce18b8b98e4242ca9dd739107ed00fa840e500</a>
</td>
</tr>

<tr>
<td>child 18918</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bd360247708a91a220b79303b4c0f59be61520f9">bd360247708a91a220b79303b4c0f59be61520f9</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=e197472677d96d3684d12ef6800e90df579d0618">11599</a></td></tr>
<tr><td>push user</td><td>acelists@atlas.sk</td></tr>
<tr><td>push date</td><td class="date age">Sat, 30 Jan 2016 22:17:28 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@bd360247708a [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=bd360247708a91a220b79303b4c0f59be61520f9">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=bd360247708a91a220b79303b4c0f59be61520f9&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bd360247708a91a220b79303b4c0f59be61520f9&newProject=comm-central&newRevision=d468c5939d660f0e3de9773bf302c96675d1cd56&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bd360247708a91a220b79303b4c0f59be61520f9&newProject=comm-central&newRevision=d468c5939d660f0e3de9773bf302c96675d1cd56&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bd360247708a91a220b79303b4c0f59be61520f9&newProject=comm-central&newRevision=d468c5939d660f0e3de9773bf302c96675d1cd56&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1244434">1244434</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1244434">Bug 1244434</a> - convert some 'for .. in Iterator(array)' constructs to for..of loops in /mail. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderDisplay.js">mail/base/content/folderDisplay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderDisplay.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderDisplay.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderDisplay.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderDisplay.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderDisplay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderPane.js">mail/base/content/folderPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderPane.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderPane.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderPane.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderPane.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/folderPane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/mailCore.js">mail/base/content/mailCore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/mailCore.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/mailCore.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/mailCore.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/mailCore.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/base/content/mailCore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/modules/dbViewWrapper.js">mail/base/modules/dbViewWrapper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/base/modules/dbViewWrapper.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/base/modules/dbViewWrapper.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/base/modules/dbViewWrapper.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/base/modules/dbViewWrapper.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/base/modules/dbViewWrapper.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/cloudFileAccounts.js">mail/components/cloudfile/cloudFileAccounts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/cloudFileAccounts.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/cloudFileAccounts.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/cloudFileAccounts.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/cloudFileAccounts.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/cloudFileAccounts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/content/addAccountDialog.js">mail/components/cloudfile/content/addAccountDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/content/addAccountDialog.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/content/addAccountDialog.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/content/addAccountDialog.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/content/addAccountDialog.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/cloudfile/content/addAccountDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/cloudAttachmentLinkManager.js">mail/components/compose/content/cloudAttachmentLinkManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/cloudAttachmentLinkManager.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/cloudAttachmentLinkManager.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/cloudAttachmentLinkManager.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/cloudAttachmentLinkManager.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/compose/content/cloudAttachmentLinkManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/newmailaccount/content/accountProvisioner.js">mail/components/newmailaccount/content/accountProvisioner.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/newmailaccount/content/accountProvisioner.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/newmailaccount/content/accountProvisioner.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/newmailaccount/content/accountProvisioner.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/newmailaccount/content/accountProvisioner.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/newmailaccount/content/accountProvisioner.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/applications.js">mail/components/preferences/applications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/applications.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/applications.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/applications.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/applications.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/applications.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/display.js">mail/components/preferences/display.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/display.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/display.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/display.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/display.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/preferences/display.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/test/unit/test_about_support.js">mail/components/test/unit/test_about_support.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e197472677d96d3684d12ef6800e90df579d0618/mail/components/test/unit/test_about_support.js">file</a> |
<a href="/comm-central/annotate/e197472677d96d3684d12ef6800e90df579d0618/mail/components/test/unit/test_about_support.js">annotate</a> |
<a href="/comm-central/diff/e197472677d96d3684d12ef6800e90df579d0618/mail/components/test/unit/test_about_support.js">diff</a> |
<a href="/comm-central/comparison/e197472677d96d3684d12ef6800e90df579d0618/mail/components/test/unit/test_about_support.js">comparison</a> |
<a href="/comm-central/log/e197472677d96d3684d12ef6800e90df579d0618/mail/components/test/unit/test_about_support.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/folderDisplay.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/folderDisplay.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -574,17 +574,17 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">         if (state)</span>
<a href="#l1.6"></a><span id="l1.6">           return state;</span>
<a href="#l1.7"></a><span id="l1.7">       }</span>
<a href="#l1.8"></a><span id="l1.8">     }</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">     // if we are still here, use the defaults and helper functions</span>
<a href="#l1.11"></a><span id="l1.11">     let state = {};</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    for (let [, colId] in Iterator(this.DEFAULT_COLUMNS)) {</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    for (let colId of this.DEFAULT_COLUMNS) {</span>
<a href="#l1.14"></a><span id="l1.14">       let shouldShowColumn = true;</span>
<a href="#l1.15"></a><span id="l1.15">       if (colId in this.COLUMN_DEFAULT_TESTERS) {</span>
<a href="#l1.16"></a><span id="l1.16">         // This is potentially going to be used by extensions; avoid them</span>
<a href="#l1.17"></a><span id="l1.17">         //  killing us.</span>
<a href="#l1.18"></a><span id="l1.18">         try {</span>
<a href="#l1.19"></a><span id="l1.19">           shouldShowColumn = this.COLUMN_DEFAULT_TESTERS[colId](this.view);</span>
<a href="#l1.20"></a><span id="l1.20">         }</span>
<a href="#l1.21"></a><span id="l1.21">         catch (ex) {</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -2725,17 +2725,17 @@ FakeTreeBoxObject.prototype = {</span>
<a href="#l1.23"></a><span id="l1.23">  * Provide attribute and function implementations that complain very loudly if</span>
<a href="#l1.24"></a><span id="l1.24">  *  they are used.  Now, XPConnect will return an error to callers if we don't</span>
<a href="#l1.25"></a><span id="l1.25">  *  implement part of the interface signature, but this is unlikely to provide</span>
<a href="#l1.26"></a><span id="l1.26">  *  the visibility we desire.  In fact, since it is a simple nsresult error,</span>
<a href="#l1.27"></a><span id="l1.27">  *  it may make things completely crazy.  So this way we can yell via dump,</span>
<a href="#l1.28"></a><span id="l1.28">  *  throw an exception, etc.</span>
<a href="#l1.29"></a><span id="l1.29">  */</span>
<a href="#l1.30"></a><span id="l1.30"> function FTBO_stubOutAttributes(aObj, aAttribNames) {</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-  for (let [, attrName] in Iterator(aAttribNames)) {</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+  for (let attrName of aAttribNames) {</span>
<a href="#l1.33"></a><span id="l1.33">     let myAttrName = attrName;</span>
<a href="#l1.34"></a><span id="l1.34">     aObj.__defineGetter__(attrName,</span>
<a href="#l1.35"></a><span id="l1.35">       function() {</span>
<a href="#l1.36"></a><span id="l1.36">         let msg = &quot;Read access to stubbed attribute &quot; + myAttrName;</span>
<a href="#l1.37"></a><span id="l1.37">         dump(msg + &quot;\n&quot;);</span>
<a href="#l1.38"></a><span id="l1.38">         debugger;</span>
<a href="#l1.39"></a><span id="l1.39">         throw new Error(msg);</span>
<a href="#l1.40"></a><span id="l1.40">       });</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineat">@@ -2744,17 +2744,17 @@ function FTBO_stubOutAttributes(aObj, aA</span>
<a href="#l1.42"></a><span id="l1.42">         let msg = &quot;Write access to stubbed attribute &quot; + myAttrName;</span>
<a href="#l1.43"></a><span id="l1.43">         dump(msg + &quot;\n&quot;);</span>
<a href="#l1.44"></a><span id="l1.44">         debugger;</span>
<a href="#l1.45"></a><span id="l1.45">         throw new Error(msg);</span>
<a href="#l1.46"></a><span id="l1.46">       });</span>
<a href="#l1.47"></a><span id="l1.47">   }</span>
<a href="#l1.48"></a><span id="l1.48"> }</span>
<a href="#l1.49"></a><span id="l1.49"> function FTBO_stubOutMethods(aObj, aMethodNames) {</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-  for (let [, methodName] in Iterator(aMethodNames)) {</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineplus">+  for (let methodName of aMethodNames) {</span>
<a href="#l1.52"></a><span id="l1.52">     let myMethodName = methodName;</span>
<a href="#l1.53"></a><span id="l1.53">     aObj[myMethodName] = function() {</span>
<a href="#l1.54"></a><span id="l1.54">       let msg = &quot;Call to stubbed method &quot; + myMethodName;</span>
<a href="#l1.55"></a><span id="l1.55">       dump(msg + &quot;\n&quot;);</span>
<a href="#l1.56"></a><span id="l1.56">       debugger;</span>
<a href="#l1.57"></a><span id="l1.57">       throw new Error(msg);</span>
<a href="#l1.58"></a><span id="l1.58">     };</span>
<a href="#l1.59"></a><span id="l1.59">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/folderPane.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/folderPane.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1391,17 +1391,17 @@ var gFolderTreeView = {</span>
<a href="#l2.4"></a><span id="l2.4">     if (this._tree)</span>
<a href="#l2.5"></a><span id="l2.5">     {</span>
<a href="#l2.6"></a><span id="l2.6">       if (oldCount !== null)</span>
<a href="#l2.7"></a><span id="l2.7">           this._tree.rowCountChanged(0, this._rowMap.length - oldCount);</span>
<a href="#l2.8"></a><span id="l2.8">       this._tree.invalidate();</span>
<a href="#l2.9"></a><span id="l2.9">     }</span>
<a href="#l2.10"></a><span id="l2.10">     this._restoreOpenStates();</span>
<a href="#l2.11"></a><span id="l2.11">     // restore selection.</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-    for (let [, folder] in Iterator(selectedFolders)) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+    for (let folder of selectedFolders) {</span>
<a href="#l2.14"></a><span id="l2.14">       if (folder) {</span>
<a href="#l2.15"></a><span id="l2.15">         let index = this.getIndexOfFolder(folder);</span>
<a href="#l2.16"></a><span id="l2.16">         if (index != null)</span>
<a href="#l2.17"></a><span id="l2.17">           this.selection.toggleSelect(index);</span>
<a href="#l2.18"></a><span id="l2.18">       }</span>
<a href="#l2.19"></a><span id="l2.19">     }</span>
<a href="#l2.20"></a><span id="l2.20">   },</span>
<a href="#l2.21"></a><span id="l2.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/mailCore.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/mailCore.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -266,17 +266,17 @@ function onViewToolbarsPopupShowing(aEve</span>
<a href="#l3.4"></a><span id="l3.4">     if (deadItem.hasAttribute(&quot;iscollapsible&quot;))</span>
<a href="#l3.5"></a><span id="l3.5">       deadItem.remove();</span>
<a href="#l3.6"></a><span id="l3.6">   }</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8">   // We'll insert the menuitems before the first item in the list if no insert</span>
<a href="#l3.9"></a><span id="l3.9">   // point is defined.</span>
<a href="#l3.10"></a><span id="l3.10">   let firstMenuItem = aInsertPoint || popup.firstChild;</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  for (let [, toolboxId] in Iterator(toolboxIds)) {</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  for (let toolboxId of toolboxIds) {</span>
<a href="#l3.14"></a><span id="l3.14">     let toolbox = document.getElementById(toolboxId);</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16">     // We'll consider either childnodes that have a toolbarname attribute,</span>
<a href="#l3.17"></a><span id="l3.17">     // or externalToolbars.</span>
<a href="#l3.18"></a><span id="l3.18">     let potentialToolbars = Array.slice(</span>
<a href="#l3.19"></a><span id="l3.19">       toolbox.querySelectorAll(&quot;[toolbarname]&quot;)</span>
<a href="#l3.20"></a><span id="l3.20">     );</span>
<a href="#l3.21"></a><span id="l3.21">     for (let externalToolbar of toolbox.externalToolbars) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/modules/dbViewWrapper.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/modules/dbViewWrapper.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -2030,16 +2030,16 @@ DBViewWrapper.prototype = {</span>
<a href="#l4.4"></a><span id="l4.4">    *     view.  (The search may be filtering it out.)</span>
<a href="#l4.5"></a><span id="l4.5">    */</span>
<a href="#l4.6"></a><span id="l4.6">   getMsgHdrForMessageID: function DBViewWrapper_getMsgHdrForMessageID(</span>
<a href="#l4.7"></a><span id="l4.7">       aMessageId) {</span>
<a href="#l4.8"></a><span id="l4.8">     if (this._syntheticView)</span>
<a href="#l4.9"></a><span id="l4.9">       return this._syntheticView.getMsgHdrForMessageID(aMessageId);</span>
<a href="#l4.10"></a><span id="l4.10">     if (!this._underlyingFolders)</span>
<a href="#l4.11"></a><span id="l4.11">       return null;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    for (let [, folder] in Iterator(this._underlyingFolders)) {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+    for (let folder of this._underlyingFolders) {</span>
<a href="#l4.14"></a><span id="l4.14">       let msgHdr = folder.msgDatabase.getMsgHdrForMessageID(aMessageId);</span>
<a href="#l4.15"></a><span id="l4.15">       if (msgHdr)</span>
<a href="#l4.16"></a><span id="l4.16">         return msgHdr;</span>
<a href="#l4.17"></a><span id="l4.17">     }</span>
<a href="#l4.18"></a><span id="l4.18">     return null;</span>
<a href="#l4.19"></a><span id="l4.19">   },</span>
<a href="#l4.20"></a><span id="l4.20"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/components/cloudfile/cloudFileAccounts.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/components/cloudfile/cloudFileAccounts.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -26,17 +26,17 @@ var cloudFileAccounts = {</span>
<a href="#l5.4"></a><span id="l5.4">   get kTokenRealm() {</span>
<a href="#l5.5"></a><span id="l5.5">     return PWDMGR_REALM;</span>
<a href="#l5.6"></a><span id="l5.6">   },</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8">   get _accountKeys() {</span>
<a href="#l5.9"></a><span id="l5.9">     let accountKeySet = {};</span>
<a href="#l5.10"></a><span id="l5.10">     let branch = Services.prefs.getBranch(ACCOUNT_ROOT);</span>
<a href="#l5.11"></a><span id="l5.11">     let children = branch.getChildList(&quot;&quot;, {});</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    for (let [,child] in Iterator(children)) {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    for (let child of children) {</span>
<a href="#l5.14"></a><span id="l5.14">       let subbranch = child.substr(0, child.indexOf(&quot;.&quot;));</span>
<a href="#l5.15"></a><span id="l5.15">       accountKeySet[subbranch] = 1;</span>
<a href="#l5.16"></a><span id="l5.16">     }</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18">     // TODO: sort by ordinal</span>
<a href="#l5.19"></a><span id="l5.19">     return Object.keys(accountKeySet);</span>
<a href="#l5.20"></a><span id="l5.20">   },</span>
<a href="#l5.21"></a><span id="l5.21"> </span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -174,19 +174,18 @@ var cloudFileAccounts = {</span>
<a href="#l5.23"></a><span id="l5.23">   get accounts() {</span>
<a href="#l5.24"></a><span id="l5.24">     return this._accountKeys.filter(key =&gt; this.getAccount(key) != null).</span>
<a href="#l5.25"></a><span id="l5.25">       map(key =&gt; this.getAccount(key));</span>
<a href="#l5.26"></a><span id="l5.26">   },</span>
<a href="#l5.27"></a><span id="l5.27"> </span>
<a href="#l5.28"></a><span id="l5.28">   getAccountsForType: function CFA_getAccountsForType(aType) {</span>
<a href="#l5.29"></a><span id="l5.29">     let result = [];</span>
<a href="#l5.30"></a><span id="l5.30"> </span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-    for (let [, accountKey] in Iterator(this._accountKeys)) {</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-      let type = Services.prefs.getCharPref(ACCOUNT_ROOT + accountKey</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-                                            + &quot;.type&quot;);</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+    for (let accountKey of this._accountKeys) {</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+      let type = Services.prefs.getCharPref(ACCOUNT_ROOT + accountKey + &quot;.type&quot;);</span>
<a href="#l5.36"></a><span id="l5.36">       if (type === aType)</span>
<a href="#l5.37"></a><span id="l5.37">         result.push(this.getAccount(accountKey));</span>
<a href="#l5.38"></a><span id="l5.38">     }</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40">     return result;</span>
<a href="#l5.41"></a><span id="l5.41">   },</span>
<a href="#l5.42"></a><span id="l5.42"> </span>
<a href="#l5.43"></a><span id="l5.43">   addAccountDialog: function CFA_addAccountDialog() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/components/cloudfile/content/addAccountDialog.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/components/cloudfile/content/addAccountDialog.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -122,17 +122,17 @@ var addAccountDialog = {</span>
<a href="#l6.4"></a><span id="l6.4">     }</span>
<a href="#l6.5"></a><span id="l6.5">   },</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7">   onIFrameLoaded: function AAD_onIFrameLoaded(aEvent) {</span>
<a href="#l6.8"></a><span id="l6.8">     let doc = this._settings.contentDocument;</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10">     let links = doc.getElementsByTagName(&quot;a&quot;);</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    for (let [, link] in Iterator(links))</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    for (let link of links)</span>
<a href="#l6.14"></a><span id="l6.14">       link.addEventListener(&quot;click&quot;, this.onClickLink);</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16">     let form = doc.getElementById(kFormId);</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18">     if (form)</span>
<a href="#l6.19"></a><span id="l6.19">       form.addEventListener(&quot;input&quot;, this.onInput.bind(this));</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21">     this.onInput();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1159,17 +1159,17 @@ function updateSendCommands(aHaveControl</span>
<a href="#l7.4"></a><span id="l7.4">   }</span>
<a href="#l7.5"></a><span id="l7.5"> }</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7"> function addAttachCloudMenuItems(aParentMenu)</span>
<a href="#l7.8"></a><span id="l7.8"> {</span>
<a href="#l7.9"></a><span id="l7.9">   while (aParentMenu.hasChildNodes())</span>
<a href="#l7.10"></a><span id="l7.10">     aParentMenu.lastChild.remove();</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  for (let [,cloudProvider] in Iterator(cloudFileAccounts.accounts)) {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  for (let cloudProvider of cloudFileAccounts.accounts) {</span>
<a href="#l7.14"></a><span id="l7.14">     let item = document.createElement(&quot;menuitem&quot;);</span>
<a href="#l7.15"></a><span id="l7.15">     let iconClass = cloudProvider.iconClass;</span>
<a href="#l7.16"></a><span id="l7.16">     item.cloudProvider = cloudProvider;</span>
<a href="#l7.17"></a><span id="l7.17">     item.setAttribute(&quot;label&quot;, cloudFileAccounts.getDisplayName(cloudProvider));</span>
<a href="#l7.18"></a><span id="l7.18"> </span>
<a href="#l7.19"></a><span id="l7.19">     if (iconClass) {</span>
<a href="#l7.20"></a><span id="l7.20">       item.setAttribute(&quot;class&quot;, &quot;menu-iconic&quot;);</span>
<a href="#l7.21"></a><span id="l7.21">       item.setAttribute(&quot;image&quot;, iconClass);</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -1185,17 +1185,17 @@ function addConvertCloudMenuItems(aParen</span>
<a href="#l7.23"></a><span id="l7.23">   while (afterNode.nextSibling)</span>
<a href="#l7.24"></a><span id="l7.24">     afterNode.nextSibling.remove();</span>
<a href="#l7.25"></a><span id="l7.25"> </span>
<a href="#l7.26"></a><span id="l7.26">   if (!attachment.sendViaCloud) {</span>
<a href="#l7.27"></a><span id="l7.27">     let item = document.getElementById(&quot;convertCloudMenuItems_popup_convertAttachment&quot;);</span>
<a href="#l7.28"></a><span id="l7.28">     item.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l7.29"></a><span id="l7.29">   }</span>
<a href="#l7.30"></a><span id="l7.30"> </span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-  for (let [,cloudProvider] in Iterator(cloudFileAccounts.accounts)) {</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+  for (let cloudProvider of cloudFileAccounts.accounts) {</span>
<a href="#l7.33"></a><span id="l7.33">     let item = document.createElement(&quot;menuitem&quot;);</span>
<a href="#l7.34"></a><span id="l7.34">     let iconClass = cloudProvider.iconClass;</span>
<a href="#l7.35"></a><span id="l7.35">     item.cloudProvider = cloudProvider;</span>
<a href="#l7.36"></a><span id="l7.36">     item.setAttribute(&quot;label&quot;, cloudFileAccounts.getDisplayName(cloudProvider));</span>
<a href="#l7.37"></a><span id="l7.37">     item.setAttribute(&quot;type&quot;, &quot;radio&quot;);</span>
<a href="#l7.38"></a><span id="l7.38">     item.setAttribute(&quot;name&quot;, aRadioGroup);</span>
<a href="#l7.39"></a><span id="l7.39"> </span>
<a href="#l7.40"></a><span id="l7.40">     if (attachment.cloudProvider &amp;&amp;</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineat">@@ -1559,17 +1559,17 @@ function convertListItemsToRegularAttach</span>
<a href="#l7.42"></a><span id="l7.42">   }</span>
<a href="#l7.43"></a><span id="l7.43"> </span>
<a href="#l7.44"></a><span id="l7.44">   dispatchAttachmentBucketEvent(&quot;attachments-converted&quot;, convertedAttachments);</span>
<a href="#l7.45"></a><span id="l7.45">   Services.obs.notifyObservers(convertedAttachments,</span>
<a href="#l7.46"></a><span id="l7.46">                                &quot;mail:attachmentsConverted&quot;, null);</span>
<a href="#l7.47"></a><span id="l7.47"> </span>
<a href="#l7.48"></a><span id="l7.48">   // We leave the content location in for the notifications because</span>
<a href="#l7.49"></a><span id="l7.49">   // it may be needed to identify the attachment. But clear it out now.</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-  for (let [,item] in Iterator(aItems))</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+  for (let item of aItems)</span>
<a href="#l7.52"></a><span id="l7.52">     delete item.attachment.contentLocation;</span>
<a href="#l7.53"></a><span id="l7.53"> }</span>
<a href="#l7.54"></a><span id="l7.54"> </span>
<a href="#l7.55"></a><span id="l7.55"> /**</span>
<a href="#l7.56"></a><span id="l7.56">  * Convert the selected attachments to regular (non-cloud) attachments.</span>
<a href="#l7.57"></a><span id="l7.57">  */</span>
<a href="#l7.58"></a><span id="l7.58"> function convertSelectedToRegularAttachment()</span>
<a href="#l7.59"></a><span id="l7.59"> {</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineat">@@ -1581,17 +1581,17 @@ function convertSelectedToRegularAttachm</span>
<a href="#l7.61"></a><span id="l7.61">  * Convert an array of nsIMsgAttachments to regular (non-cloud) attachments.</span>
<a href="#l7.62"></a><span id="l7.62">  *</span>
<a href="#l7.63"></a><span id="l7.63">  * @param aAttachments an array of nsIMsgAttachments</span>
<a href="#l7.64"></a><span id="l7.64">  */</span>
<a href="#l7.65"></a><span id="l7.65"> function convertToRegularAttachment(aAttachments)</span>
<a href="#l7.66"></a><span id="l7.66"> {</span>
<a href="#l7.67"></a><span id="l7.67">   let bucket = document.getElementById(&quot;attachmentBucket&quot;);</span>
<a href="#l7.68"></a><span id="l7.68">   let items = [];</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineminus">-  for (let [,attachment] in Iterator(aAttachments)) {</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+  for (let attachment of aAttachments) {</span>
<a href="#l7.71"></a><span id="l7.71">     let item = bucket.findItemForAttachment(attachment);</span>
<a href="#l7.72"></a><span id="l7.72">     if (item)</span>
<a href="#l7.73"></a><span id="l7.73">       items.push(item);</span>
<a href="#l7.74"></a><span id="l7.74">   }</span>
<a href="#l7.75"></a><span id="l7.75"> </span>
<a href="#l7.76"></a><span id="l7.76">   convertListItemsToRegularAttachment(items);</span>
<a href="#l7.77"></a><span id="l7.77"> }</span>
<a href="#l7.78"></a><span id="l7.78"> </span>
<a href="#l7.79"></a><span id="l7.79" class="difflineat">@@ -2217,17 +2217,17 @@ function ComposeStartup(recycled, aParam</span>
<a href="#l7.80"></a><span id="l7.80">         composeFields.newsgroups = args.newsgroups;</span>
<a href="#l7.81"></a><span id="l7.81">       if (args.subject)</span>
<a href="#l7.82"></a><span id="l7.82">         composeFields.subject = args.subject;</span>
<a href="#l7.83"></a><span id="l7.83">       if (args.attachment)</span>
<a href="#l7.84"></a><span id="l7.84">       {</span>
<a href="#l7.85"></a><span id="l7.85">         let attachmentList = args.attachment.split(&quot;,&quot;);</span>
<a href="#l7.86"></a><span id="l7.86">         let commandLine = Components.classes[&quot;@mozilla.org/toolkit/command-line;1&quot;]</span>
<a href="#l7.87"></a><span id="l7.87">                                     .createInstance();</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineminus">-        for (let [,attachmentName] in Iterator(attachmentList))</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineplus">+        for (let attachmentName of attachmentList)</span>
<a href="#l7.90"></a><span id="l7.90">         {</span>
<a href="#l7.91"></a><span id="l7.91">           // resolveURI does all the magic around working out what the</span>
<a href="#l7.92"></a><span id="l7.92">           // attachment is, including web pages, and generating the correct uri.</span>
<a href="#l7.93"></a><span id="l7.93">           let uri = commandLine.resolveURI(attachmentName);</span>
<a href="#l7.94"></a><span id="l7.94">           let attachment = Components.classes[&quot;@mozilla.org/messengercompose/attachment;1&quot;]</span>
<a href="#l7.95"></a><span id="l7.95">                                      .createInstance(Components.interfaces.nsIMsgAttachment);</span>
<a href="#l7.96"></a><span id="l7.96">           // If uri is for a file and it exists set the attachment size.</span>
<a href="#l7.97"></a><span id="l7.97">           if (uri instanceof Components.interfaces.nsIFileURL)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/components/compose/content/cloudAttachmentLinkManager.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/components/compose/content/cloudAttachmentLinkManager.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -476,17 +476,17 @@ var gCloudAttachmentLinkManager = {</span>
<a href="#l8.4"></a><span id="l8.4">       root.appendChild(list);</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6">       editor.insertElementAtSelection(root, false);</span>
<a href="#l8.7"></a><span id="l8.7">     }</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9">     selection.collapse(originalAnchor, originalOffset);</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11">     // Restore the selection ranges.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    for (let [,range] in Iterator(ranges))</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    for (let range of ranges)</span>
<a href="#l8.14"></a><span id="l8.14">       selection.addRange(range);</span>
<a href="#l8.15"></a><span id="l8.15">   },</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17">   /**</span>
<a href="#l8.18"></a><span id="l8.18">    * Updates the count of how many attachments have been added</span>
<a href="#l8.19"></a><span id="l8.19">    * in HTML emails.</span>
<a href="#l8.20"></a><span id="l8.20">    *</span>
<a href="#l8.21"></a><span id="l8.21">    * @aDocument the document that contains the cloudAttachmentListHeader node.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/components/newmailaccount/content/accountProvisioner.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/components/newmailaccount/content/accountProvisioner.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -578,17 +578,17 @@ var EmailAccountProvisioner = {</span>
<a href="#l9.4"></a><span id="l9.4">   },</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6">   providerHasCorrectFields: function EAP_providerHasCorrectFields(provider) {</span>
<a href="#l9.7"></a><span id="l9.7">     let result = true;</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9">     let required = [&quot;id&quot;, &quot;label&quot;, &quot;paid&quot;, &quot;languages&quot;, &quot;api&quot;, &quot;tos_url&quot;,</span>
<a href="#l9.10"></a><span id="l9.10">                     &quot;privacy_url&quot;];</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    for (let [index, aField] in Iterator(required)) {</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    for (let aField of required) {</span>
<a href="#l9.14"></a><span id="l9.14">       let fieldExists = (aField in provider);</span>
<a href="#l9.15"></a><span id="l9.15">       result &amp;= fieldExists;</span>
<a href="#l9.16"></a><span id="l9.16"> </span>
<a href="#l9.17"></a><span id="l9.17">       if (!fieldExists)</span>
<a href="#l9.18"></a><span id="l9.18">         gLog.error(&quot;A provider did not have the field &quot; + aField</span>
<a href="#l9.19"></a><span id="l9.19">                    + &quot;, and will be skipped.&quot;);</span>
<a href="#l9.20"></a><span id="l9.20">     };</span>
<a href="#l9.21"></a><span id="l9.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/components/preferences/applications.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/components/preferences/applications.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -615,17 +615,17 @@ var gCloudFileTab = {</span>
<a href="#l10.4"></a><span id="l10.4">         return -1;</span>
<a href="#l10.5"></a><span id="l10.5">       if (aName &gt; bName)</span>
<a href="#l10.6"></a><span id="l10.6">         return 1;</span>
<a href="#l10.7"></a><span id="l10.7">       return 0;</span>
<a href="#l10.8"></a><span id="l10.8">     }</span>
<a href="#l10.9"></a><span id="l10.9"> </span>
<a href="#l10.10"></a><span id="l10.10">     accounts.sort(sortAccounts);</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    for (let [, account] in Iterator(accounts)) {</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+    for (let account of accounts) {</span>
<a href="#l10.14"></a><span id="l10.14">       let rli = this.makeRichListItemForAccount(account);</span>
<a href="#l10.15"></a><span id="l10.15">       this._list.appendChild(rli);</span>
<a href="#l10.16"></a><span id="l10.16">       if (!(account.accountKey in this._accountCache))</span>
<a href="#l10.17"></a><span id="l10.17">         this.requestUserInfoForItem(rli, false);</span>
<a href="#l10.18"></a><span id="l10.18">     }</span>
<a href="#l10.19"></a><span id="l10.19">   },</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21">   requestUserInfoForItem: function CFT_requestUserInfoForItem(aItem, aWithUI) {</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -755,17 +755,17 @@ var gCloudFileTab = {</span>
<a href="#l10.23"></a><span id="l10.23">       function addClickListeners(e) {</span>
<a href="#l10.24"></a><span id="l10.24">         iframe.contentWindow.removeEventListener(&quot;DOMContentLoaded&quot;,</span>
<a href="#l10.25"></a><span id="l10.25">                                                  addClickListeners,</span>
<a href="#l10.26"></a><span id="l10.26">                                                  false);</span>
<a href="#l10.27"></a><span id="l10.27"> </span>
<a href="#l10.28"></a><span id="l10.28">         let doc = e.originalTarget;</span>
<a href="#l10.29"></a><span id="l10.29">         let links = doc.getElementsByTagName(&quot;a&quot;);</span>
<a href="#l10.30"></a><span id="l10.30"> </span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-        for (let [, link] in Iterator(links))</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+        for (let link of links)</span>
<a href="#l10.33"></a><span id="l10.33">           link.addEventListener(&quot;click&quot;, gCloudFileTab._onClickLink);</span>
<a href="#l10.34"></a><span id="l10.34">       }, false);</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36">     CommandUpdate_CloudFile();</span>
<a href="#l10.37"></a><span id="l10.37">   },</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39">   _onClickLink: function CFT__onClickLink(aEvent) {</span>
<a href="#l10.40"></a><span id="l10.40">     aEvent.preventDefault();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/components/preferences/display.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/components/preferences/display.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -149,17 +149,17 @@ var gDisplayPane = {</span>
<a href="#l11.4"></a><span id="l11.4">     let defaultType = this._readDefaultFontTypeForLanguage(languagePref.value);</span>
<a href="#l11.5"></a><span id="l11.5">     let listPref = document.getElementById(&quot;font.name-list.&quot; + defaultType +</span>
<a href="#l11.6"></a><span id="l11.6">                                            &quot;.&quot; + languagePref.value);</span>
<a href="#l11.7"></a><span id="l11.7">     if (!listPref)</span>
<a href="#l11.8"></a><span id="l11.8">       return defaultValue;</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10">     let fontNames = listPref.value.split(&quot;,&quot;);</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    for (let [, fontName] in Iterator(fontNames)) {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    for (let fontName of fontNames) {</span>
<a href="#l11.14"></a><span id="l11.14">       let fontItem = element.querySelector('[value=&quot;' + fontName.trim() + '&quot;]');</span>
<a href="#l11.15"></a><span id="l11.15">       if (fontItem)</span>
<a href="#l11.16"></a><span id="l11.16">         return fontItem.getAttribute(&quot;value&quot;);</span>
<a href="#l11.17"></a><span id="l11.17">     }</span>
<a href="#l11.18"></a><span id="l11.18">     return defaultValue;</span>
<a href="#l11.19"></a><span id="l11.19">   },</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21">   tabSelectionChanged: function ()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/components/test/unit/test_about_support.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/components/test/unit/test_about_support.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -69,26 +69,26 @@ var gSensitiveData = [];</span>
<a href="#l12.4"></a><span id="l12.4"> /**</span>
<a href="#l12.5"></a><span id="l12.5">  * Set up accounts based on the given data.</span>
<a href="#l12.6"></a><span id="l12.6">  */</span>
<a href="#l12.7"></a><span id="l12.7"> function setup_accounts() {</span>
<a href="#l12.8"></a><span id="l12.8">   // First make sure the local folders account is set up.</span>
<a href="#l12.9"></a><span id="l12.9">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11">   // Now run through the details and set up accounts accordingly.</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  for (let [, details] in Iterator(gAccountList)) {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  for (let details of gAccountList) {</span>
<a href="#l12.14"></a><span id="l12.14">     let server = localAccountUtils.create_incoming_server(details.type, details.port,</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-							  details.user, details.password);</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+                                                          details.user, details.password);</span>
<a href="#l12.17"></a><span id="l12.17">     server.socketType = details.socketType;</span>
<a href="#l12.18"></a><span id="l12.18">     server.authMethod = details.authMethod;</span>
<a href="#l12.19"></a><span id="l12.19">     gSensitiveData.push(details.password);</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-    for (let [, smtpDetails] in Iterator(details.smtpServers)) {</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+    for (let smtpDetails of details.smtpServers) {</span>
<a href="#l12.22"></a><span id="l12.22">       let outgoing = localAccountUtils.create_outgoing_server(smtpDetails.port,</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-							      smtpDetails.user,</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-							      smtpDetails.password);</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+                                                              smtpDetails.user,</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+                                                              smtpDetails.password);</span>
<a href="#l12.27"></a><span id="l12.27">       outgoing.socketType = smtpDetails.socketType;</span>
<a href="#l12.28"></a><span id="l12.28">       outgoing.authMethod = smtpDetails.authMethod;</span>
<a href="#l12.29"></a><span id="l12.29">       localAccountUtils.associate_servers(server, outgoing, smtpDetails.isDefault);</span>
<a href="#l12.30"></a><span id="l12.30">       gSensitiveData.push(smtpDetails.password);</span>
<a href="#l12.31"></a><span id="l12.31"> </span>
<a href="#l12.32"></a><span id="l12.32">       // Add the SMTP server to our server name -&gt; server map</span>
<a href="#l12.33"></a><span id="l12.33">       gSMTPMap[&quot;localhost:&quot; + smtpDetails.port] = smtpDetails;</span>
<a href="#l12.34"></a><span id="l12.34">     }</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineat">@@ -109,17 +109,17 @@ function verify_account_details(aDetails</span>
<a href="#l12.36"></a><span id="l12.36">     expectedDetails.port;</span>
<a href="#l12.37"></a><span id="l12.37">   do_check_eq(aDetails.hostDetails, expectedHostDetails);</span>
<a href="#l12.38"></a><span id="l12.38">   do_check_eq(aDetails.socketType, expectedDetails.socketType);</span>
<a href="#l12.39"></a><span id="l12.39">   do_check_eq(aDetails.authMethod, expectedDetails.authMethod);</span>
<a href="#l12.40"></a><span id="l12.40"> </span>
<a href="#l12.41"></a><span id="l12.41">   let smtpToSee = expectedDetails.smtpServers.map(smtpDetails =&gt;</span>
<a href="#l12.42"></a><span id="l12.42">                     &quot;localhost:&quot; + smtpDetails.port);</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44" class="difflineminus">-  for (let [, smtpDetails] in Iterator(aDetails.smtpServers)) {</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+  for (let smtpDetails of aDetails.smtpServers) {</span>
<a href="#l12.46"></a><span id="l12.46">     // Check that we're expecting to see this server</span>
<a href="#l12.47"></a><span id="l12.47">     let toSeeIndex = smtpToSee.indexOf(smtpDetails.name);</span>
<a href="#l12.48"></a><span id="l12.48">     do_check_neq(toSeeIndex, -1);</span>
<a href="#l12.49"></a><span id="l12.49">     smtpToSee.splice(toSeeIndex, 1);</span>
<a href="#l12.50"></a><span id="l12.50"> </span>
<a href="#l12.51"></a><span id="l12.51">     let expectedSMTPDetails = gSMTPMap[smtpDetails.name];</span>
<a href="#l12.52"></a><span id="l12.52">     do_check_eq(smtpDetails.socketType, expectedSMTPDetails.socketType);</span>
<a href="#l12.53"></a><span id="l12.53">     do_check_eq(smtpDetails.authMethod, expectedSMTPDetails.authMethod);</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineat">@@ -151,20 +151,20 @@ function test_get_file_system_type() {</span>
<a href="#l12.55"></a><span id="l12.55">  */</span>
<a href="#l12.56"></a><span id="l12.56"> function test_get_account_details() {</span>
<a href="#l12.57"></a><span id="l12.57">   let accountDetails = AboutSupport.getAccountDetails();</span>
<a href="#l12.58"></a><span id="l12.58">   let accountDetailsText = uneval(accountDetails);</span>
<a href="#l12.59"></a><span id="l12.59">   // The list of accounts we are looking for</span>
<a href="#l12.60"></a><span id="l12.60">   let accountsToSee = Object.keys(gAccountMap);</span>
<a href="#l12.61"></a><span id="l12.61"> </span>
<a href="#l12.62"></a><span id="l12.62">   // Our first check is to see that no sensitive data has crept in</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineminus">-  for (let [, data] in Iterator(gSensitiveData))</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+  for (let data of gSensitiveData)</span>
<a href="#l12.65"></a><span id="l12.65">     do_check_false(accountDetailsText.includes(data));</span>
<a href="#l12.66"></a><span id="l12.66"> </span>
<a href="#l12.67"></a><span id="l12.67" class="difflineminus">-  for (let [, details] in Iterator(accountDetails)) {</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+  for (let details of accountDetails) {</span>
<a href="#l12.69"></a><span id="l12.69">     // We're going to make one exception: for the local folders server. We don't</span>
<a href="#l12.70"></a><span id="l12.70">     // care too much about its details.</span>
<a href="#l12.71"></a><span id="l12.71">     if (details.key == localAccountUtils.msgAccount.key)</span>
<a href="#l12.72"></a><span id="l12.72">       continue;</span>
<a href="#l12.73"></a><span id="l12.73"> </span>
<a href="#l12.74"></a><span id="l12.74">     // Check that we're expecting to see this server</span>
<a href="#l12.75"></a><span id="l12.75">     let toSeeIndex = accountsToSee.indexOf(details.key);</span>
<a href="#l12.76"></a><span id="l12.76">     do_check_neq(toSeeIndex, -1);</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineat">@@ -187,11 +187,11 @@ function run_test() {</span>
<a href="#l12.78"></a><span id="l12.78">     // assertions about g_type_init not being called.</span>
<a href="#l12.79"></a><span id="l12.79">     Cc[&quot;@mozilla.org/gnome-gconf-service;1&quot;].getService();</span>
<a href="#l12.80"></a><span id="l12.80">   }</span>
<a href="#l12.81"></a><span id="l12.81"> </span>
<a href="#l12.82"></a><span id="l12.82">   Components.utils.import(&quot;resource:///modules/aboutSupport.js&quot;);</span>
<a href="#l12.83"></a><span id="l12.83"> </span>
<a href="#l12.84"></a><span id="l12.84">   setup_accounts();</span>
<a href="#l12.85"></a><span id="l12.85"> </span>
<a href="#l12.86"></a><span id="l12.86" class="difflineminus">-  for (let [, test] in Iterator(tests))</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+  for (let test of tests)</span>
<a href="#l12.88"></a><span id="l12.88">     test();</span>
<a href="#l12.89"></a><span id="l12.89"> }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

