<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20084:f9a68cf569d341c8eb707d0b9715aeddf893f957</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ f9a68cf569d341c8eb707d0b9715aeddf893f957" />
<meta property="og:url" content="/comm-central/rev/f9a68cf569d341c8eb707d0b9715aeddf893f957" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable no-mixed-operators rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / f9a68cf569d341c8eb707d0b9715aeddf893f957 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/f9a68cf569d341c8eb707d0b9715aeddf893f957">shortlog</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/f9a68cf569d341c8eb707d0b9715aeddf893f957">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957">files</a> |
changeset |
<a href="/comm-central/raw-rev/f9a68cf569d341c8eb707d0b9715aeddf893f957">raw</a>  | <a href="/comm-central/archive/f9a68cf569d341c8eb707d0b9715aeddf893f957.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable no-mixed-operators rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 14:10:09 +0200</td></tr>

<tr>
 <td>changeset 20084</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/f9a68cf569d341c8eb707d0b9715aeddf893f957">f9a68cf569d341c8eb707d0b9715aeddf893f957</a></td>
</tr>



<tr>
<td>parent 20083</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/54ba39e1100154bd06b37aca95f26f3e771250bb">54ba39e1100154bd06b37aca95f26f3e771250bb</a>
</td>
</tr>

<tr>
<td>child 20085</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/aa2a09835126b3cc60886ea7e9a16cfe0f268a51">aa2a09835126b3cc60886ea7e9a16cfe0f268a51</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=f9a68cf569d341c8eb707d0b9715aeddf893f957">12310</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Sat, 17 Sep 2016 23:32:52 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@d0755bd52da8 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d0755bd52da8189fbed8fa4b7496f29bc1854289">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d0755bd52da8189fbed8fa4b7496f29bc1854289&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d0755bd52da8189fbed8fa4b7496f29bc1854289&newProject=comm-central&newRevision=289338a394d31814b30269ba6752035e303e04a3&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d0755bd52da8189fbed8fa4b7496f29bc1854289&newProject=comm-central&newRevision=289338a394d31814b30269ba6752035e303e04a3&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d0755bd52da8189fbed8fa4b7496f29bc1854289&newProject=comm-central&newRevision=289338a394d31814b30269ba6752035e303e04a3&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable no-mixed-operators rule. r=MakeMyDay

MozReview-Commit-ID: EYazS6HGjP2</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/today-pane.js">calendar/base/content/today-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/today-pane.js">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/today-pane.js">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/today-pane.js">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/today-pane.js">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/content/today-pane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/modules/calRecurrenceUtils.jsm">calendar/base/modules/calRecurrenceUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/modules/calRecurrenceUtils.jsm">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/modules/calRecurrenceUtils.jsm">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/modules/calRecurrenceUtils.jsm">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/modules/calRecurrenceUtils.jsm">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/modules/calRecurrenceUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calCachedCalendar.js">calendar/base/src/calCachedCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calCachedCalendar.js">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calCachedCalendar.js">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calCachedCalendar.js">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calCachedCalendar.js">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calCachedCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/providers/wcap/calWcapCalendarItems.js">calendar/providers/wcap/calWcapCalendarItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/providers/wcap/calWcapCalendarItems.js">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/providers/wcap/calWcapCalendarItems.js">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/providers/wcap/calWcapCalendarItems.js">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/providers/wcap/calWcapCalendarItems.js">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/providers/wcap/calWcapCalendarItems.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/test/unit/test_alarm.js">calendar/test/unit/test_alarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/test/unit/test_alarm.js">file</a> |
<a href="/comm-central/annotate/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/test/unit/test_alarm.js">annotate</a> |
<a href="/comm-central/diff/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/test/unit/test_alarm.js">diff</a> |
<a href="/comm-central/comparison/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/test/unit/test_alarm.js">comparison</a> |
<a href="/comm-central/log/f9a68cf569d341c8eb707d0b9715aeddf893f957/calendar/test/unit/test_alarm.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -398,13 +398,24 @@</span>
<a href="#l1.4"></a><span id="l1.4">     &quot;object-curly-newline&quot;: [2, { &quot;multiline&quot;: true }],</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6">     // Disallow whitespace before properties</span>
<a href="#l1.7"></a><span id="l1.7">     &quot;no-whitespace-before-property&quot;: 2,</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">     // Disallow unnecessary escape usage</span>
<a href="#l1.10"></a><span id="l1.10">     &quot;no-useless-escape&quot;: 2,</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // Disallow mixes of different operators, but allow simple math operations.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    &quot;no-mixed-operators&quot;: [2, {</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+        &quot;groups&quot;: [</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+            /* [&quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;, &quot;%&quot;, &quot;**&quot;], */</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+            [&quot;&amp;&quot;, &quot;|&quot;, &quot;^&quot;, &quot;~&quot;, &quot;&lt;&lt;&quot;, &quot;&gt;&gt;&quot;, &quot;&gt;&gt;&gt;&quot;],</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+            [&quot;==&quot;, &quot;!=&quot;, &quot;===&quot;, &quot;!==&quot;, &quot;&gt;&quot;, &quot;&gt;=&quot;, &quot;&lt;&quot;, &quot;&lt;=&quot;],</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineplus">+            [&quot;&amp;&amp;&quot;, &quot;||&quot;],</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+            [&quot;in&quot;, &quot;instanceof&quot;]</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+        ]</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+    }],</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineplus">+</span>
<a href="#l1.23"></a><span id="l1.23">     // The following rules will not be enabled currently, but are kept here for</span>
<a href="#l1.24"></a><span id="l1.24">     // easier updates in the future.</span>
<a href="#l1.25"></a><span id="l1.25">     &quot;no-else-return&quot;: 0,</span>
<a href="#l1.26"></a><span id="l1.26">   }</span>
<a href="#l1.27"></a><span id="l1.27"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -113,17 +113,17 @@</span>
<a href="#l2.4"></a><span id="l2.4">                     occs = aOldItem.getOccurrencesBetween(this.calView.startDate,</span>
<a href="#l2.5"></a><span id="l2.5">                                                           this.calView.queryEndDate,</span>
<a href="#l2.6"></a><span id="l2.6">                                                           {});</span>
<a href="#l2.7"></a><span id="l2.7">                     for (let occ of occs) {</span>
<a href="#l2.8"></a><span id="l2.8">                         this.calView.doDeleteItem(occ);</span>
<a href="#l2.9"></a><span id="l2.9">                     }</span>
<a href="#l2.10"></a><span id="l2.10">                 }</span>
<a href="#l2.11"></a><span id="l2.11">                 if (cal.isToDo(aNewItem)) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-                    if (!aNewItem.entryDate &amp;&amp; !aNewItem.dueDate || !this.calView.mTasksInView) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+                    if ((!aNewItem.entryDate &amp;&amp; !aNewItem.dueDate) || !this.calView.mTasksInView) {</span>
<a href="#l2.14"></a><span id="l2.14">                         return;</span>
<a href="#l2.15"></a><span id="l2.15">                     }</span>
<a href="#l2.16"></a><span id="l2.16">                     if (aNewItem.isCompleted &amp;&amp; !this.calView.mShowCompleted) {</span>
<a href="#l2.17"></a><span id="l2.17">                         return;</span>
<a href="#l2.18"></a><span id="l2.18">                     }</span>
<a href="#l2.19"></a><span id="l2.19">                 }</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21">                 occs = aNewItem.getOccurrencesBetween(this.calView.startDate,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -3614,18 +3614,18 @@</span>
<a href="#l3.4"></a><span id="l3.4">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.5"></a><span id="l3.5">       &lt;/method&gt;</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7">       &lt;method name=&quot;adjustScrollbarSpacersForAlldayEvents&quot;&gt;</span>
<a href="#l3.8"></a><span id="l3.8">         &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l3.9"></a><span id="l3.9">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.10"></a><span id="l3.10">           let startDate = aEvent[calGetStartDateProp(aEvent)];</span>
<a href="#l3.11"></a><span id="l3.11">           let endDate = aEvent[calGetEndDateProp(aEvent)];</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-          if (startDate &amp;&amp; startDate.isDate ||</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-              endDate &amp;&amp; endDate.isDate) {</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+          if ((startDate &amp;&amp; startDate.isDate) ||</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+              (endDate &amp;&amp; endDate.isDate)) {</span>
<a href="#l3.16"></a><span id="l3.16">               // If this is an all day event, then the header with allday</span>
<a href="#l3.17"></a><span id="l3.17">               // events could possibly get a scrollbar. Readjust them.</span>
<a href="#l3.18"></a><span id="l3.18">               this.adjustScrollBarSpacers();</span>
<a href="#l3.19"></a><span id="l3.19">           }</span>
<a href="#l3.20"></a><span id="l3.20">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.21"></a><span id="l3.21">       &lt;/method&gt;</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23">       &lt;method name=&quot;doAddItem&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/today-pane.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/today-pane.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -455,18 +455,19 @@ var TodayPane = {</span>
<a href="#l4.4"></a><span id="l4.4">     },</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">     /**</span>
<a href="#l4.7"></a><span id="l4.7">      * Generates the todaypane toggle command when the today-splitter</span>
<a href="#l4.8"></a><span id="l4.8">      * is being collapsed or uncollapsed.</span>
<a href="#l4.9"></a><span id="l4.9">      */</span>
<a href="#l4.10"></a><span id="l4.10">     onCommandTodaySplitter: function() {</span>
<a href="#l4.11"></a><span id="l4.11">         let todaypane = document.getElementById(&quot;today-pane-panel&quot;);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-        let splitterState = document.getElementById(&quot;today-splitter&quot;).getAttribute(&quot;state&quot;);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-        if (splitterState == &quot;collapsed&quot; &amp;&amp; todaypane.isVisible() ||</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-            splitterState != &quot;collapsed&quot; &amp;&amp; !todaypane.isVisible()) {</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-              document.getElementById(&quot;calendar_toggle_todaypane_command&quot;).doCommand();</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+        let splitter = document.getElementById(&quot;today-splitter&quot;);</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+        let splitterCollapsed = splitter.getAttribute(&quot;state&quot;) == &quot;collapsed&quot;;</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+        if (splitterCollapsed == todaypane.isVisible()) {</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+            document.getElementById(&quot;calendar_toggle_todaypane_command&quot;).doCommand();</span>
<a href="#l4.21"></a><span id="l4.21">         }</span>
<a href="#l4.22"></a><span id="l4.22">     }</span>
<a href="#l4.23"></a><span id="l4.23"> };</span>
<a href="#l4.24"></a><span id="l4.24"> </span>
<a href="#l4.25"></a><span id="l4.25"> window.addEventListener(&quot;load&quot;, TodayPane.onLoad, false);</span>
<a href="#l4.26"></a><span id="l4.26"> window.addEventListener(&quot;unload&quot;, TodayPane.onUnload, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -230,18 +230,18 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l5.4"></a><span id="l5.4">                 let bymonthday = null;</span>
<a href="#l5.5"></a><span id="l5.5">                 let bymonth = null;</span>
<a href="#l5.6"></a><span id="l5.6">                 if (checkRecurrenceRule(rule, [&quot;BYMONTHDAY&quot;])) {</span>
<a href="#l5.7"></a><span id="l5.7">                     bymonthday = rule.getComponent(&quot;BYMONTHDAY&quot;, {});</span>
<a href="#l5.8"></a><span id="l5.8">                 }</span>
<a href="#l5.9"></a><span id="l5.9">                 if (checkRecurrenceRule(rule, [&quot;BYMONTH&quot;])) {</span>
<a href="#l5.10"></a><span id="l5.10">                     bymonth = rule.getComponent(&quot;BYMONTH&quot;, {});</span>
<a href="#l5.11"></a><span id="l5.11">                 }</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-                if (bymonth &amp;&amp; bymonth.length &gt; 1 ||</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-                    bymonthday &amp;&amp; (bymonthday.length &gt; 1 || bymonthday[0] &lt; -1)) {</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+                if ((bymonth &amp;&amp; bymonth.length &gt; 1) ||</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+                    (bymonthday &amp;&amp; (bymonthday.length &gt; 1 || bymonthday[0] &lt; -1))) {</span>
<a href="#l5.16"></a><span id="l5.16">                     // Don't build a string for a recurrence rule that the UI</span>
<a href="#l5.17"></a><span id="l5.17">                     // currently can't show completely (with more than one month</span>
<a href="#l5.18"></a><span id="l5.18">                     // or than one monthday, or bymonthdays lesser than -1).</span>
<a href="#l5.19"></a><span id="l5.19">                     return getRString(&quot;ruleTooComplex&quot;);</span>
<a href="#l5.20"></a><span id="l5.20">                 }</span>
<a href="#l5.21"></a><span id="l5.21"> </span>
<a href="#l5.22"></a><span id="l5.22">                 if (checkRecurrenceRule(rule, [&quot;BYMONTHDAY&quot;]) &amp;&amp;</span>
<a href="#l5.23"></a><span id="l5.23">                     (checkRecurrenceRule(rule, [&quot;BYMONTH&quot;]) || !checkRecurrenceRule(rule, [&quot;BYDAY&quot;]))) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/src/calCachedCalendar.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/src/calCachedCalendar.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -576,17 +576,17 @@ calCachedCalendar.prototype = {</span>
<a href="#l6.4"></a><span id="l6.4">             }</span>
<a href="#l6.5"></a><span id="l6.5">         };</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7">         this.mCachedCalendar.getItems(calICalendar.ITEM_FILTER_ALL_ITEMS | filter,</span>
<a href="#l6.8"></a><span id="l6.8">                                       0, null, null, getListener);</span>
<a href="#l6.9"></a><span id="l6.9">     },</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">     get superCalendar() {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-        return this.mSuperCalendar &amp;&amp; this.mSuperCalendar.superCalendar || this;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+        return (this.mSuperCalendar &amp;&amp; this.mSuperCalendar.superCalendar) || this;</span>
<a href="#l6.14"></a><span id="l6.14">     },</span>
<a href="#l6.15"></a><span id="l6.15">     set superCalendar(val) {</span>
<a href="#l6.16"></a><span id="l6.16">         return (this.mSuperCalendar = val);</span>
<a href="#l6.17"></a><span id="l6.17">     },</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">     get offline() {</span>
<a href="#l6.20"></a><span id="l6.20">         return Services.io.offline;</span>
<a href="#l6.21"></a><span id="l6.21">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1501,49 +1501,49 @@ function getParentNodeOrThisByAttribute(</span>
<a href="#l7.4"></a><span id="l7.4"> }</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6"> function setItemProperty(item, propertyName, aValue, aCapability) {</span>
<a href="#l7.7"></a><span id="l7.7">     let isSupported = (item.calendar.getProperty(&quot;capabilities.&quot; + aCapability + &quot;.supported&quot;) !== false);</span>
<a href="#l7.8"></a><span id="l7.8">     let value = (aCapability &amp;&amp; !isSupported ? null : aValue);</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10">     switch (propertyName) {</span>
<a href="#l7.11"></a><span id="l7.11">         case &quot;startDate&quot;:</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-            if (value.isDate &amp;&amp; !item.startDate.isDate ||</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-                !value.isDate &amp;&amp; item.startDate.isDate ||</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+            if ((value.isDate &amp;&amp; !item.startDate.isDate) ||</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+                (!value.isDate &amp;&amp; item.startDate.isDate) ||</span>
<a href="#l7.16"></a><span id="l7.16">                 !compareObjects(value.timezone, item.startDate.timezone) ||</span>
<a href="#l7.17"></a><span id="l7.17">                 value.compare(item.startDate) != 0) {</span>
<a href="#l7.18"></a><span id="l7.18">                 item.startDate = value;</span>
<a href="#l7.19"></a><span id="l7.19">             }</span>
<a href="#l7.20"></a><span id="l7.20">             break;</span>
<a href="#l7.21"></a><span id="l7.21">         case &quot;endDate&quot;:</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-            if (value.isDate &amp;&amp; !item.endDate.isDate ||</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-                !value.isDate &amp;&amp; item.endDate.isDate ||</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+            if ((value.isDate &amp;&amp; !item.endDate.isDate) ||</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+                (!value.isDate &amp;&amp; item.endDate.isDate) ||</span>
<a href="#l7.26"></a><span id="l7.26">                 !compareObjects(value.timezone, item.endDate.timezone) ||</span>
<a href="#l7.27"></a><span id="l7.27">                 value.compare(item.endDate) != 0) {</span>
<a href="#l7.28"></a><span id="l7.28">                 item.endDate = value;</span>
<a href="#l7.29"></a><span id="l7.29">             }</span>
<a href="#l7.30"></a><span id="l7.30">             break;</span>
<a href="#l7.31"></a><span id="l7.31">         case &quot;entryDate&quot;:</span>
<a href="#l7.32"></a><span id="l7.32">             if (value == item.entryDate) {</span>
<a href="#l7.33"></a><span id="l7.33">                 break;</span>
<a href="#l7.34"></a><span id="l7.34">             }</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-            if (value &amp;&amp; !item.entryDate ||</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineminus">-                !value &amp;&amp; item.entryDate ||</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+            if ((value &amp;&amp; !item.entryDate) ||</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+                (!value &amp;&amp; item.entryDate) ||</span>
<a href="#l7.39"></a><span id="l7.39">                 value.isDate != item.entryDate.isDate ||</span>
<a href="#l7.40"></a><span id="l7.40">                 !compareObjects(value.timezone, item.entryDate.timezone) ||</span>
<a href="#l7.41"></a><span id="l7.41">                 value.compare(item.entryDate) != 0) {</span>
<a href="#l7.42"></a><span id="l7.42">                 item.entryDate = value;</span>
<a href="#l7.43"></a><span id="l7.43">             }</span>
<a href="#l7.44"></a><span id="l7.44">             break;</span>
<a href="#l7.45"></a><span id="l7.45">         case &quot;dueDate&quot;:</span>
<a href="#l7.46"></a><span id="l7.46">             if (value == item.dueDate) {</span>
<a href="#l7.47"></a><span id="l7.47">                 break;</span>
<a href="#l7.48"></a><span id="l7.48">             }</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineminus">-            if (value &amp;&amp; !item.dueDate ||</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-                !value &amp;&amp; item.dueDate ||</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+            if ((value &amp;&amp; !item.dueDate) ||</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+                (!value &amp;&amp; item.dueDate) ||</span>
<a href="#l7.53"></a><span id="l7.53">                 value.isDate != item.dueDate.isDate ||</span>
<a href="#l7.54"></a><span id="l7.54">                 !compareObjects(value.timezone, item.dueDate.timezone) ||</span>
<a href="#l7.55"></a><span id="l7.55">                 value.compare(item.dueDate) != 0) {</span>
<a href="#l7.56"></a><span id="l7.56">                 item.dueDate = value;</span>
<a href="#l7.57"></a><span id="l7.57">             }</span>
<a href="#l7.58"></a><span id="l7.58">             break;</span>
<a href="#l7.59"></a><span id="l7.59">         case &quot;isCompleted&quot;:</span>
<a href="#l7.60"></a><span id="l7.60">             if (value != item.isCompleted) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -223,26 +223,26 @@ calWcapCalendar.prototype.canNotify = fu</span>
<a href="#l8.4"></a><span id="l8.4">         case &quot;REPLY&quot;: // only if we we're invited from cs, and find matching X-S1CS-CALID:</span>
<a href="#l8.5"></a><span id="l8.5">             return (getAttendeeByCalId(item.getAttendees({}), calId) != null);</span>
<a href="#l8.6"></a><span id="l8.6">         default:</span>
<a href="#l8.7"></a><span id="l8.7">             return false;</span>
<a href="#l8.8"></a><span id="l8.8">     }</span>
<a href="#l8.9"></a><span id="l8.9"> };</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11"> function equalDatetimes(one, two) {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    return !one &amp;&amp; !two ||</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-           (one &amp;&amp; two &amp;&amp;</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-            one.isDate == two.isDate &amp;&amp;</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-            one.compare(two) == 0);</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+    return (!one &amp;&amp; !two) ||</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+            (one &amp;&amp; two &amp;&amp;</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+             one.isDate == two.isDate &amp;&amp;</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+             one.compare(two) == 0);</span>
<a href="#l8.20"></a><span id="l8.20"> }</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22"> function identicalDatetimes(one, two) {</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineminus">-    return !one &amp;&amp; !two ||</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineminus">-           (equalDatetimes(one, two) &amp;&amp;</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-            compareObjects(one.timezone, two.timezone));</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+    return (!one &amp;&amp; !two) ||</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+            (equalDatetimes(one, two) &amp;&amp;</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+             compareObjects(one.timezone, two.timezone));</span>
<a href="#l8.29"></a><span id="l8.29"> }</span>
<a href="#l8.30"></a><span id="l8.30"> </span>
<a href="#l8.31"></a><span id="l8.31"> // @return null if nothing has changed else value to be written</span>
<a href="#l8.32"></a><span id="l8.32"> function diffProperty(newItem, oldItem, propName) {</span>
<a href="#l8.33"></a><span id="l8.33">     let val = newItem.getProperty(propName);</span>
<a href="#l8.34"></a><span id="l8.34">     let oldVal = (oldItem ? oldItem.getProperty(propName) : null);</span>
<a href="#l8.35"></a><span id="l8.35">     if (val === null) {</span>
<a href="#l8.36"></a><span id="l8.36">         // force being set when - no old item, eg when adding new item</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/test/unit/test_alarm.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/test/unit/test_alarm.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -450,18 +450,18 @@ function test_clone() {</span>
<a href="#l9.4"></a><span id="l9.4">     // Check if item is still the same</span>
<a href="#l9.5"></a><span id="l9.5">     // TODO This is not quite optimal, maybe someone can find a better way to do</span>
<a href="#l9.6"></a><span id="l9.6">     // the comparisons.</span>
<a href="#l9.7"></a><span id="l9.7">     for (let prop in propMap) {</span>
<a href="#l9.8"></a><span id="l9.8">         if (prop == &quot;item&quot;) {</span>
<a href="#l9.9"></a><span id="l9.9">             equal(alarm.item.icalString, newAlarm.item.icalString);</span>
<a href="#l9.10"></a><span id="l9.10">         } else if ((alarm[prop] instanceof Ci.nsISupports &amp;&amp;</span>
<a href="#l9.11"></a><span id="l9.11">                     alarm[prop].icalString != newAlarm[prop].icalString) ||</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-                   !(alarm[prop] instanceof Ci.nsISupports) &amp;&amp;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-                     alarm[prop] != newAlarm[prop]) {</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+                   (!(alarm[prop] instanceof Ci.nsISupports) &amp;&amp;</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+                     alarm[prop] != newAlarm[prop])) {</span>
<a href="#l9.16"></a><span id="l9.16">             do_throw(prop + &quot; differs, &quot; + alarm[prop] + &quot; == &quot; + newAlarm[prop]);</span>
<a href="#l9.17"></a><span id="l9.17">         }</span>
<a href="#l9.18"></a><span id="l9.18">     }</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20">     // Check if changes on the cloned object do not affect the original object.</span>
<a href="#l9.21"></a><span id="l9.21">     for (let prop in clonePropMap) {</span>
<a href="#l9.22"></a><span id="l9.22">         newAlarm[prop] = clonePropMap[prop];</span>
<a href="#l9.23"></a><span id="l9.23">         dump(&quot;Checking &quot; + prop + &quot;...&quot;);</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

