<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 23278:13506ae35338ac22f05c00a7c2f99f44546ea61a</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 13506ae35338ac22f05c00a7c2f99f44546ea61a" />
<meta property="og:url" content="/comm-central/rev/13506ae35338ac22f05c00a7c2f99f44546ea61a" />
<meta property="og:description" content="Bug 1399756 - remove trailing spaces from JS/JSM files in mailnews/. rs=white-space-only" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 13506ae35338ac22f05c00a7c2f99f44546ea61a 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/13506ae35338ac22f05c00a7c2f99f44546ea61a">shortlog</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/13506ae35338ac22f05c00a7c2f99f44546ea61a">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a">files</a> |
changeset |
<a href="/comm-central/raw-rev/13506ae35338ac22f05c00a7c2f99f44546ea61a">raw</a>  | <a href="/comm-central/archive/13506ae35338ac22f05c00a7c2f99f44546ea61a.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1399756">Bug 1399756</a> - remove trailing spaces from JS/JSM files in mailnews/. rs=white-space-only
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 10 Feb 2018 00:38:07 +0100</td></tr>

<tr>
 <td>changeset 23278</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/13506ae35338ac22f05c00a7c2f99f44546ea61a">13506ae35338ac22f05c00a7c2f99f44546ea61a</a></td>
</tr>



<tr>
<td>parent 23277</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/25aad613d94ba2f53b9aace428c0539030f6e7dc">25aad613d94ba2f53b9aace428c0539030f6e7dc</a>
</td>
</tr>

<tr>
<td>child 23279</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/bc5489c5c959f235bdb90a27275d0123225b888c">bc5489c5c959f235bdb90a27275d0123225b888c</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=13506ae35338ac22f05c00a7c2f99f44546ea61a">14069</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Sat, 10 Feb 2018 00:14:31 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@bc5489c5c959 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=bc5489c5c959f235bdb90a27275d0123225b888c">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=bc5489c5c959f235bdb90a27275d0123225b888c&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bc5489c5c959f235bdb90a27275d0123225b888c&newProject=comm-central&newRevision=25aad613d94ba2f53b9aace428c0539030f6e7dc&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bc5489c5c959f235bdb90a27275d0123225b888c&newProject=comm-central&newRevision=25aad613d94ba2f53b9aace428c0539030f6e7dc&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bc5489c5c959f235bdb90a27275d0123225b888c&newProject=comm-central&newRevision=25aad613d94ba2f53b9aace428c0539030f6e7dc&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28white-space-only%29&revcount=50">white-space-only</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1399756">1399756</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1399756">Bug 1399756</a> - remove trailing spaces from JS/JSM files in mailnews/. rs=white-space-only
[skip-blame]</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abDragDrop.js">mailnews/addrbook/content/abDragDrop.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abDragDrop.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abDragDrop.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abDragDrop.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abDragDrop.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abDragDrop.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abMailListDialog.js">mailnews/addrbook/content/abMailListDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abMailListDialog.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abMailListDialog.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abMailListDialog.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abMailListDialog.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abMailListDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abResultsPane.js">mailnews/addrbook/content/abResultsPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abResultsPane.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abResultsPane.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abResultsPane.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abResultsPane.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/content/abResultsPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/prefs/content/pref-directory-add.js">mailnews/addrbook/prefs/content/pref-directory-add.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/prefs/content/pref-directory-add.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/prefs/content/pref-directory-add.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/prefs/content/pref-directory-add.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/prefs/content/pref-directory-add.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/prefs/content/pref-directory-add.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js">mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_notifications.js">mailnews/addrbook/test/unit/test_notifications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_notifications.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_notifications.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_notifications.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_notifications.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_notifications.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js">mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/dateFormat.js">mailnews/base/content/dateFormat.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/dateFormat.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/dateFormat.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/dateFormat.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/dateFormat.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/dateFormat.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/jsTreeView.js">mailnews/base/content/jsTreeView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/jsTreeView.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/jsTreeView.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/jsTreeView.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/jsTreeView.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/jsTreeView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/markByDate.js">mailnews/base/content/markByDate.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/markByDate.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/markByDate.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/markByDate.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/markByDate.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/markByDate.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgFolderPickerOverlay.js">mailnews/base/content/msgFolderPickerOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgFolderPickerOverlay.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgFolderPickerOverlay.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgFolderPickerOverlay.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgFolderPickerOverlay.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgFolderPickerOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgPrintEngine.js">mailnews/base/content/msgPrintEngine.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgPrintEngine.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgPrintEngine.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgPrintEngine.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgPrintEngine.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgPrintEngine.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgSynchronize.js">mailnews/base/content/msgSynchronize.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgSynchronize.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgSynchronize.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgSynchronize.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgSynchronize.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/msgSynchronize.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/shutdownWindow.js">mailnews/base/content/shutdownWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/shutdownWindow.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/shutdownWindow.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/shutdownWindow.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/shutdownWindow.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/shutdownWindow.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/virtualFolderProperties.js">mailnews/base/content/virtualFolderProperties.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/virtualFolderProperties.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/virtualFolderProperties.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/virtualFolderProperties.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/virtualFolderProperties.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/content/virtualFolderProperties.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/AccountWizard.js">mailnews/base/prefs/content/AccountWizard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/AccountWizard.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/AccountWizard.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/AccountWizard.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/AccountWizard.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/AccountWizard.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/accountUtils.js">mailnews/base/prefs/content/accountUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/accountUtils.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/accountUtils.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/accountUtils.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/accountUtils.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/accountUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-help.js">mailnews/base/prefs/content/am-help.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-help.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-help.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-help.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-help.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-help.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-main.js">mailnews/base/prefs/content/am-main.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-main.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-main.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-main.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-main.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-main.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-offline.js">mailnews/base/prefs/content/am-offline.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-offline.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-offline.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-offline.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-offline.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-offline.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-server-advanced.js">mailnews/base/prefs/content/am-server-advanced.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-server-advanced.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-server-advanced.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-server-advanced.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-server-advanced.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/am-server-advanced.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accname.js">mailnews/base/prefs/content/aw-accname.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accname.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accname.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accname.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accname.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accname.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accounttype.js">mailnews/base/prefs/content/aw-accounttype.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accounttype.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accounttype.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accounttype.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accounttype.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-accounttype.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-done.js">mailnews/base/prefs/content/aw-done.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-done.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-done.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-done.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-done.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-done.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-identity.js">mailnews/base/prefs/content/aw-identity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-identity.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-identity.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-identity.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-identity.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-identity.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-incoming.js">mailnews/base/prefs/content/aw-incoming.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-incoming.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-incoming.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-incoming.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-incoming.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-incoming.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-outgoing.js">mailnews/base/prefs/content/aw-outgoing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-outgoing.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-outgoing.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-outgoing.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-outgoing.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/aw-outgoing.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/ispUtils.js">mailnews/base/prefs/content/ispUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/ispUtils.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/ispUtils.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/ispUtils.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/ispUtils.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/prefs/content/ispUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/CustomHeaders.js">mailnews/base/search/content/CustomHeaders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/CustomHeaders.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/CustomHeaders.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/CustomHeaders.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/CustomHeaders.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/CustomHeaders.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/FilterEditor.js">mailnews/base/search/content/FilterEditor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/FilterEditor.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/FilterEditor.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/FilterEditor.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/FilterEditor.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/FilterEditor.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/searchTermOverlay.js">mailnews/base/search/content/searchTermOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/searchTermOverlay.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/searchTermOverlay.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/searchTermOverlay.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/searchTermOverlay.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/search/content/searchTermOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/src/newMailNotificationService.js">mailnews/base/src/newMailNotificationService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/src/newMailNotificationService.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/src/newMailNotificationService.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/src/newMailNotificationService.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/src/newMailNotificationService.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/src/newMailNotificationService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_autoconfigXML.js">mailnews/base/test/unit/test_autoconfigXML.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_autoconfigXML.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_autoconfigXML.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_autoconfigXML.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_autoconfigXML.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_autoconfigXML.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bccInDatabase.js">mailnews/base/test/unit/test_bccInDatabase.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bccInDatabase.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bccInDatabase.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bccInDatabase.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bccInDatabase.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bccInDatabase.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug366491.js">mailnews/base/test/unit/test_bug366491.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug366491.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug366491.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug366491.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug366491.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug366491.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug428427.js">mailnews/base/test/unit/test_bug428427.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug428427.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug428427.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug428427.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug428427.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug428427.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug434810.js">mailnews/base/test/unit/test_bug434810.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug434810.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug434810.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug434810.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug434810.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug434810.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug465805.js">mailnews/base/test/unit/test_bug465805.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug465805.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug465805.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug465805.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug465805.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug465805.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug471682.js">mailnews/base/test/unit/test_bug471682.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug471682.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug471682.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug471682.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug471682.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug471682.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug514945.js">mailnews/base/test/unit/test_bug514945.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug514945.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug514945.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug514945.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug514945.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_bug514945.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_compactColumnSave.js">mailnews/base/test/unit/test_compactColumnSave.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_compactColumnSave.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_compactColumnSave.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_compactColumnSave.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_compactColumnSave.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_compactColumnSave.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_copyChaining.js">mailnews/base/test/unit/test_copyChaining.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_copyChaining.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_copyChaining.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_copyChaining.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_copyChaining.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_copyChaining.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_emptyTrash.js">mailnews/base/test/unit/test_emptyTrash.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_emptyTrash.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_emptyTrash.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_emptyTrash.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_emptyTrash.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_emptyTrash.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_folderCompact.js">mailnews/base/test/unit/test_folderCompact.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_folderCompact.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_folderCompact.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_folderCompact.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_folderCompact.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_folderCompact.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_imapPump.js">mailnews/base/test/unit/test_imapPump.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_imapPump.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_imapPump.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_imapPump.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_imapPump.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_imapPump.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_inheritedFolderProperties.js">mailnews/base/test/unit/test_inheritedFolderProperties.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_inheritedFolderProperties.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_inheritedFolderProperties.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_inheritedFolderProperties.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_inheritedFolderProperties.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_inheritedFolderProperties.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_junkWhitelisting.js">mailnews/base/test/unit/test_junkWhitelisting.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_junkWhitelisting.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_junkWhitelisting.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_junkWhitelisting.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_junkWhitelisting.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_junkWhitelisting.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_loadVirtualFolders.js">mailnews/base/test/unit/test_loadVirtualFolders.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_loadVirtualFolders.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_loadVirtualFolders.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_loadVirtualFolders.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_loadVirtualFolders.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_loadVirtualFolders.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgTagService.js">mailnews/base/test/unit/test_nsIMsgTagService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgTagService.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgTagService.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgTagService.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgTagService.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_nsIMsgTagService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_search.js">mailnews/base/test/unit/test_search.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_search.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_search.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_search.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_search.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_search.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchAddressInAb.js">mailnews/base/test/unit/test_searchAddressInAb.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchAddressInAb.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchAddressInAb.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchAddressInAb.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchAddressInAb.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchAddressInAb.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBody.js">mailnews/base/test/unit/test_searchBody.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBody.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBody.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBody.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBody.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBody.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBoolean.js">mailnews/base/test/unit/test_searchBoolean.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBoolean.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBoolean.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBoolean.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBoolean.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchBoolean.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchChaining.js">mailnews/base/test/unit/test_searchChaining.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchChaining.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchChaining.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchChaining.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchChaining.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchChaining.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchCustomTerm.js">mailnews/base/test/unit/test_searchCustomTerm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchCustomTerm.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchCustomTerm.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchCustomTerm.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchCustomTerm.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchCustomTerm.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchJunk.js">mailnews/base/test/unit/test_searchJunk.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchJunk.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchJunk.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchJunk.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchJunk.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchJunk.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchLocalizationStrings.js">mailnews/base/test/unit/test_searchLocalizationStrings.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchLocalizationStrings.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchLocalizationStrings.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchLocalizationStrings.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchLocalizationStrings.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchLocalizationStrings.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchTag.js">mailnews/base/test/unit/test_searchTag.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchTag.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchTag.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchTag.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchTag.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchTag.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchUint32HdrProperty.js">mailnews/base/test/unit/test_searchUint32HdrProperty.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchUint32HdrProperty.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchUint32HdrProperty.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchUint32HdrProperty.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchUint32HdrProperty.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/test/unit/test_searchUint32HdrProperty.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/util/JXON.js">mailnews/base/util/JXON.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/util/JXON.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/util/JXON.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/util/JXON.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/util/JXON.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/base/util/JXON.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug155172.js">mailnews/compose/test/unit/test_bug155172.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug155172.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug155172.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug155172.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug155172.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug155172.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug474774.js">mailnews/compose/test/unit/test_bug474774.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug474774.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug474774.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug474774.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug474774.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_bug474774.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose1.js">mailnews/compose/test/unit/test_nsMsgCompose1.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose1.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose1.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose1.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose1.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose1.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose2.js">mailnews/compose/test/unit/test_nsMsgCompose2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose2.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose2.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose2.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose2.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose2.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose4.js">mailnews/compose/test/unit/test_nsMsgCompose4.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose4.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose4.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose4.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose4.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsMsgCompose4.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsSmtpService1.js">mailnews/compose/test/unit/test_nsSmtpService1.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsSmtpService1.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsSmtpService1.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsSmtpService1.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsSmtpService1.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_nsSmtpService1.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendBackground.js">mailnews/compose/test/unit/test_sendBackground.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendBackground.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendBackground.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendBackground.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendBackground.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendBackground.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMailMessage.js">mailnews/compose/test/unit/test_sendMailMessage.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMailMessage.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMailMessage.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMailMessage.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMailMessage.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMailMessage.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageFile.js">mailnews/compose/test/unit/test_sendMessageFile.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageFile.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageFile.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageFile.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageFile.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageFile.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater2.js">mailnews/compose/test/unit/test_sendMessageLater2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater2.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater2.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater2.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater2.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater2.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater3.js">mailnews/compose/test/unit/test_sendMessageLater3.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater3.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater3.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater3.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater3.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_sendMessageLater3.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtp8bitMime.js">mailnews/compose/test/unit/test_smtp8bitMime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtp8bitMime.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtp8bitMime.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtp8bitMime.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtp8bitMime.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtp8bitMime.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtpPassword.js">mailnews/compose/test/unit/test_smtpPassword.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtpPassword.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtpPassword.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtpPassword.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtpPassword.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/compose/test/unit/test_smtpPassword.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/collection.js">mailnews/db/gloda/modules/collection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/collection.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/collection.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/collection.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/collection.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/collection.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/suffixtree.js">mailnews/db/gloda/modules/suffixtree.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/suffixtree.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/suffixtree.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/suffixtree.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/suffixtree.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/modules/suffixtree.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/base_index_messages.js">mailnews/db/gloda/test/unit/base_index_messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/base_index_messages.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/base_index_messages.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/base_index_messages.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/base_index_messages.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/base_index_messages.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js">mailnews/db/gloda/test/unit/test_mime_attachments_size.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_maildb.js">mailnews/db/msgdb/test/unit/test_maildb.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_maildb.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_maildb.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_maildb.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_maildb.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_maildb.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_references_parsing.js">mailnews/db/msgdb/test/unit/test_references_parsing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_references_parsing.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_references_parsing.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_references_parsing.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_references_parsing.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/db/msgdb/test/unit/test_references_parsing.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js">mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js">mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js">mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/dsn/content/am-dsn.js">mailnews/extensions/dsn/content/am-dsn.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/dsn/content/am-dsn.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/dsn/content/am-dsn.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/dsn/content/am-dsn.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/dsn/content/am-dsn.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/dsn/content/am-dsn.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/am-mdn.js">mailnews/extensions/mdn/content/am-mdn.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/am-mdn.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/am-mdn.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/am-mdn.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/am-mdn.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/am-mdn.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/mdn.js">mailnews/extensions/mdn/content/mdn.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/mdn.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/mdn.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/mdn.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/mdn.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/content/mdn.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_askuser.js">mailnews/extensions/mdn/test/unit/test_askuser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_askuser.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_askuser.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_askuser.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_askuser.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_askuser.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">mailnews/extensions/mdn/test/unit/test_mdnFlags.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/am-smime.js">mailnews/extensions/smime/content/am-smime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/am-smime.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/am-smime.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/am-smime.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/am-smime.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/am-smime.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgCompSecurityInfo.js">mailnews/extensions/smime/content/msgCompSecurityInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgCompSecurityInfo.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgCompSecurityInfo.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgCompSecurityInfo.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgCompSecurityInfo.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgCompSecurityInfo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgReadSecurityInfo.js">mailnews/extensions/smime/content/msgReadSecurityInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgReadSecurityInfo.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgReadSecurityInfo.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgReadSecurityInfo.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgReadSecurityInfo.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/msgReadSecurityInfo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/smime.js">mailnews/extensions/smime/content/smime.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/smime.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/smime.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/smime.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/smime.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/extensions/smime/content/smime.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_bug460636.js">mailnews/imap/test/unit/test_bug460636.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_bug460636.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_bug460636.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_bug460636.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_bug460636.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_bug460636.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_dod.js">mailnews/imap/test/unit/test_dod.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_dod.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_dod.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_dod.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_dod.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_dod.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_downloadOffline.js">mailnews/imap/test/unit/test_downloadOffline.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_downloadOffline.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_downloadOffline.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_downloadOffline.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_downloadOffline.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_downloadOffline.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapAttachmentSaves.js">mailnews/imap/test/unit/test_imapAttachmentSaves.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapAttachmentSaves.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapAttachmentSaves.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapAttachmentSaves.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapAttachmentSaves.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapAttachmentSaves.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapChunks.js">mailnews/imap/test/unit/test_imapChunks.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapChunks.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapChunks.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapChunks.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapChunks.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapChunks.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapContentLength.js">mailnews/imap/test/unit/test_imapContentLength.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapContentLength.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapContentLength.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapContentLength.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapContentLength.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapContentLength.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFilterActions.js">mailnews/imap/test/unit/test_imapFilterActions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFilterActions.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFilterActions.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFilterActions.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFilterActions.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFilterActions.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFlagChange.js">mailnews/imap/test/unit/test_imapFlagChange.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFlagChange.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFlagChange.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFlagChange.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFlagChange.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapFlagChange.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapHighWater.js">mailnews/imap/test/unit/test_imapHighWater.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapHighWater.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapHighWater.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapHighWater.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapHighWater.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapHighWater.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js">mailnews/imap/test/unit/test_imapStoreMsgOffline.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_localToImapFilter.js">mailnews/imap/test/unit/test_localToImapFilter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_localToImapFilter.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_localToImapFilter.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_localToImapFilter.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_localToImapFilter.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_localToImapFilter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_offlineStoreLocking.js">mailnews/imap/test/unit/test_offlineStoreLocking.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_offlineStoreLocking.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_offlineStoreLocking.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_offlineStoreLocking.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_offlineStoreLocking.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_offlineStoreLocking.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_partsOnDemand.js">mailnews/imap/test/unit/test_partsOnDemand.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_partsOnDemand.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_partsOnDemand.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_partsOnDemand.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_partsOnDemand.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_partsOnDemand.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_preserveDataOnMove.js">mailnews/imap/test/unit/test_preserveDataOnMove.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_preserveDataOnMove.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_preserveDataOnMove.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_preserveDataOnMove.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_preserveDataOnMove.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_preserveDataOnMove.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_syncChanges.js">mailnews/imap/test/unit/test_syncChanges.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_syncChanges.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_syncChanges.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_syncChanges.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_syncChanges.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_syncChanges.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_trustSpamAssassin.js">mailnews/imap/test/unit/test_trustSpamAssassin.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_trustSpamAssassin.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_trustSpamAssassin.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_trustSpamAssassin.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_trustSpamAssassin.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/imap/test/unit/test_trustSpamAssassin.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/content/fieldMapImport.js">mailnews/import/content/fieldMapImport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/content/fieldMapImport.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/content/fieldMapImport.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/content/fieldMapImport.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/content/fieldMapImport.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/content/fieldMapImport.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/addressbook.json">mailnews/import/test/unit/resources/addressbook.json</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/addressbook.json">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/addressbook.json">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/addressbook.json">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/addressbook.json">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/addressbook.json">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/import_helper.js">mailnews/import/test/unit/resources/import_helper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/import_helper.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/import_helper.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/import_helper.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/import_helper.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/import/test/unit/resources/import_helper.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/intl/test/unit/CharsetConversionTests.js">mailnews/intl/test/unit/CharsetConversionTests.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/intl/test/unit/CharsetConversionTests.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/intl/test/unit/CharsetConversionTests.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/intl/test/unit/CharsetConversionTests.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/intl/test/unit/CharsetConversionTests.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/intl/test/unit/CharsetConversionTests.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_folderLoaded.js">mailnews/local/test/unit/test_folderLoaded.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_folderLoaded.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_folderLoaded.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_folderLoaded.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_folderLoaded.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_folderLoaded.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_msgCopy.js">mailnews/local/test/unit/test_msgCopy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_msgCopy.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_msgCopy.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_msgCopy.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_msgCopy.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/local/test/unit/test_msgCopy.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mailnews.js">mailnews/mailnews.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mailnews.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mailnews.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mailnews.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mailnews.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mailnews.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/jsmime/test/test_header_emitter.js">mailnews/mime/jsmime/test/test_header_emitter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/jsmime/test/test_header_emitter.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/jsmime/test/test_header_emitter.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/jsmime/test/test_header_emitter.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/jsmime/test/test_header_emitter.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/jsmime/test/test_header_emitter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_alternate_p7m_handling.js">mailnews/mime/test/unit/test_alternate_p7m_handling.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_alternate_p7m_handling.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_alternate_p7m_handling.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_alternate_p7m_handling.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_alternate_p7m_handling.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_alternate_p7m_handling.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_mimeStreaming.js">mailnews/mime/test/unit/test_mimeStreaming.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_mimeStreaming.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_mimeStreaming.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_mimeStreaming.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_mimeStreaming.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/mime/test/unit/test_mimeStreaming.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_getNewsMessage.js">mailnews/news/test/unit/test_getNewsMessage.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_getNewsMessage.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_getNewsMessage.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_getNewsMessage.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_getNewsMessage.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_getNewsMessage.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpPassword2.js">mailnews/news/test/unit/test_nntpPassword2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpPassword2.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpPassword2.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpPassword2.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpPassword2.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpPassword2.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpUrl.js">mailnews/news/test/unit/test_nntpUrl.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpUrl.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpUrl.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpUrl.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpUrl.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/news/test/unit/test_nntpUrl.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/maild.js">mailnews/test/fakeserver/maild.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/maild.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/maild.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/maild.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/maild.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/maild.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/nntpd.js">mailnews/test/fakeserver/nntpd.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/nntpd.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/nntpd.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/nntpd.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/nntpd.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/nntpd.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/pop3d.js">mailnews/test/fakeserver/pop3d.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/pop3d.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/pop3d.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/pop3d.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/pop3d.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/fakeserver/pop3d.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/alertTestUtils.js">mailnews/test/resources/alertTestUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/alertTestUtils.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/alertTestUtils.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/alertTestUtils.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/alertTestUtils.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/alertTestUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/mailShutdown.js">mailnews/test/resources/mailShutdown.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/mailShutdown.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/mailShutdown.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/mailShutdown.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/mailShutdown.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/mailShutdown.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/msgFolderListenerSetup.js">mailnews/test/resources/msgFolderListenerSetup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/msgFolderListenerSetup.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/msgFolderListenerSetup.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/msgFolderListenerSetup.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/msgFolderListenerSetup.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/msgFolderListenerSetup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/searchTestUtils.js">mailnews/test/resources/searchTestUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/searchTestUtils.js">file</a> |
<a href="/comm-central/annotate/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/searchTestUtils.js">annotate</a> |
<a href="/comm-central/diff/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/searchTestUtils.js">diff</a> |
<a href="/comm-central/comparison/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/searchTestUtils.js">comparison</a> |
<a href="/comm-central/log/13506ae35338ac22f05c00a7c2f99f44546ea61a/mailnews/test/resources/searchTestUtils.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/addrbook/content/abDragDrop.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/addrbook/content/abDragDrop.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -325,21 +325,21 @@ var abDirTreeObserver = {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">   onToggleOpenState: function()</span>
<a href="#l1.6"></a><span id="l1.6">   {</span>
<a href="#l1.7"></a><span id="l1.7">   },</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9">   onCycleHeader: function(colID, elt)</span>
<a href="#l1.10"></a><span id="l1.10">   {</span>
<a href="#l1.11"></a><span id="l1.11">   },</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-      </span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+</span>
<a href="#l1.14"></a><span id="l1.14">   onCycleCell: function(row, colID)</span>
<a href="#l1.15"></a><span id="l1.15">   {</span>
<a href="#l1.16"></a><span id="l1.16">   },</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-      </span>
<a href="#l1.18"></a><span id="l1.18" class="difflineplus">+</span>
<a href="#l1.19"></a><span id="l1.19">   onSelectionChanged: function()</span>
<a href="#l1.20"></a><span id="l1.20">   {</span>
<a href="#l1.21"></a><span id="l1.21">   },</span>
<a href="#l1.22"></a><span id="l1.22"> </span>
<a href="#l1.23"></a><span id="l1.23">   onPerformAction: function(action)</span>
<a href="#l1.24"></a><span id="l1.24">   {</span>
<a href="#l1.25"></a><span id="l1.25">   },</span>
<a href="#l1.26"></a><span id="l1.26"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/addrbook/content/abMailListDialog.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/addrbook/content/abMailListDialog.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -221,17 +221,17 @@ function OnLoadNewMailList()</span>
<a href="#l2.4"></a><span id="l2.4"> }</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6"> function EditListOKButton()</span>
<a href="#l2.7"></a><span id="l2.7"> {</span>
<a href="#l2.8"></a><span id="l2.8">   //edit mailing list in database</span>
<a href="#l2.9"></a><span id="l2.9">   if (GetListValue(gEditList, false))</span>
<a href="#l2.10"></a><span id="l2.10">   {</span>
<a href="#l2.11"></a><span id="l2.11">     if (gListCard) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-      // modify the list card (for the results pane) from the mailing list </span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+      // modify the list card (for the results pane) from the mailing list</span>
<a href="#l2.14"></a><span id="l2.14">       gListCard.displayName = gEditList.dirName;</span>
<a href="#l2.15"></a><span id="l2.15">       gListCard.lastName = gEditList.dirName;</span>
<a href="#l2.16"></a><span id="l2.16">       gListCard.setProperty(&quot;NickName&quot;, gEditList.listNickName);</span>
<a href="#l2.17"></a><span id="l2.17">       gListCard.setProperty(&quot;Notes&quot;, gEditList.description);</span>
<a href="#l2.18"></a><span id="l2.18">     }</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">     NotifySaveListeners(gEditList);</span>
<a href="#l2.21"></a><span id="l2.21">     gEditList.editMailListToDatabase(gListCard);</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -304,17 +304,17 @@ function OnLoadEditList()</span>
<a href="#l2.23"></a><span id="l2.23">   // the display, the value of the textbox inside the new row isn't inherited into the input -</span>
<a href="#l2.24"></a><span id="l2.24">   // the first row then appears to be duplicated at the end although it is actually empty.</span>
<a href="#l2.25"></a><span id="l2.25">   // see awAppendNewRow which copies first row and clears it</span>
<a href="#l2.26"></a><span id="l2.26">   setTimeout(AppendLastRow, 0);</span>
<a href="#l2.27"></a><span id="l2.27">   NotifyLoadListeners(gEditList);</span>
<a href="#l2.28"></a><span id="l2.28"> }</span>
<a href="#l2.29"></a><span id="l2.29"> </span>
<a href="#l2.30"></a><span id="l2.30"> function AppendLastRow()</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-{ </span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+{</span>
<a href="#l2.33"></a><span id="l2.33">   AppendNewRowAndSetFocus();</span>
<a href="#l2.34"></a><span id="l2.34">   awFitDummyRows(1);</span>
<a href="#l2.35"></a><span id="l2.35"> </span>
<a href="#l2.36"></a><span id="l2.36">   // focus on first name</span>
<a href="#l2.37"></a><span id="l2.37">   var listName = document.getElementById('ListName');</span>
<a href="#l2.38"></a><span id="l2.38">   if (listName)</span>
<a href="#l2.39"></a><span id="l2.39">     listName.focus();</span>
<a href="#l2.40"></a><span id="l2.40"> }</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineat">@@ -427,17 +427,17 @@ function awAppendNewRow(setFocus)</span>
<a href="#l2.42"></a><span id="l2.42">   if (body &amp;&amp; listitem1)</span>
<a href="#l2.43"></a><span id="l2.43">   {</span>
<a href="#l2.44"></a><span id="l2.44">     var nextDummy = awGetNextDummyRow();</span>
<a href="#l2.45"></a><span id="l2.45">     var newNode = listitem1.cloneNode(true);</span>
<a href="#l2.46"></a><span id="l2.46">     if (nextDummy)</span>
<a href="#l2.47"></a><span id="l2.47">       body.replaceChild(newNode, nextDummy);</span>
<a href="#l2.48"></a><span id="l2.48">     else</span>
<a href="#l2.49"></a><span id="l2.49">       body.appendChild(newNode);</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineminus">-    </span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+</span>
<a href="#l2.52"></a><span id="l2.52">     top.MAX_RECIPIENTS++;</span>
<a href="#l2.53"></a><span id="l2.53"> </span>
<a href="#l2.54"></a><span id="l2.54">     var input = newNode.getElementsByTagName(awInputElementName());</span>
<a href="#l2.55"></a><span id="l2.55">     if (input &amp;&amp; input.length == 1)</span>
<a href="#l2.56"></a><span id="l2.56">     {</span>
<a href="#l2.57"></a><span id="l2.57">       input[0].setAttribute(&quot;value&quot;, &quot;&quot;);</span>
<a href="#l2.58"></a><span id="l2.58">       input[0].setAttribute(&quot;id&quot;, &quot;addressCol1#&quot; + top.MAX_RECIPIENTS);</span>
<a href="#l2.59"></a><span id="l2.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/content/abResultsPane.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/content/abResultsPane.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -215,17 +215,17 @@ function GetSelectedAbCards()</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5">     abView.selection.getRangeAt(i, start, end);</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7">     for (let j = start.value; j &lt;= end.value; ++j) {</span>
<a href="#l3.8"></a><span id="l3.8">       // avoid inserting null element into the list. GetRangeAt() may be buggy.</span>
<a href="#l3.9"></a><span id="l3.9">       let tmp = abView.getCardFromRow(j);</span>
<a href="#l3.10"></a><span id="l3.10">       if (tmp) {</span>
<a href="#l3.11"></a><span id="l3.11"> 	cards.push(tmp);</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-      } </span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+      }</span>
<a href="#l3.14"></a><span id="l3.14">     }</span>
<a href="#l3.15"></a><span id="l3.15">   }</span>
<a href="#l3.16"></a><span id="l3.16">   return cards;</span>
<a href="#l3.17"></a><span id="l3.17"> }</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> // XXX todo</span>
<a href="#l3.20"></a><span id="l3.20"> // an optimization might be to make this return</span>
<a href="#l3.21"></a><span id="l3.21"> // the selected ranges, which would be faster</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/addrbook/prefs/content/pref-directory-add.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/addrbook/prefs/content/pref-directory-add.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -42,17 +42,17 @@ function Startup()</span>
<a href="#l4.4"></a><span id="l4.4">   document.getElementById(&quot;download&quot;).accessKey =</span>
<a href="#l4.5"></a><span id="l4.5">     gReplicationBundle.getString(&quot;downloadButton.accesskey&quot;);</span>
<a href="#l4.6"></a><span id="l4.6"> </span>
<a href="#l4.7"></a><span id="l4.7">   if (&quot;arguments&quot; in window &amp;&amp; window.arguments[0]) {</span>
<a href="#l4.8"></a><span id="l4.8">     gCurrentDirectory = window.arguments[0].selectedDirectory;</span>
<a href="#l4.9"></a><span id="l4.9">     try {</span>
<a href="#l4.10"></a><span id="l4.10">       fillSettings();</span>
<a href="#l4.11"></a><span id="l4.11">     } catch (ex) {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-      dump(&quot;pref-directory-add.js:Startup(): fillSettings() exception: &quot; </span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+      dump(&quot;pref-directory-add.js:Startup(): fillSettings() exception: &quot;</span>
<a href="#l4.14"></a><span id="l4.14">            + ex + &quot;\n&quot;);</span>
<a href="#l4.15"></a><span id="l4.15">     }</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17">     let oldListName = gCurrentDirectory.dirName;</span>
<a href="#l4.18"></a><span id="l4.18">     document.title = gReplicationBundle.getFormattedString(&quot;directoryTitleEdit&quot;, [oldListName]);</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20">     // Only set up the download button for online/offline status toggling</span>
<a href="#l4.21"></a><span id="l4.21">     // if the pref isn't locked to disable the button.</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -69,17 +69,17 @@ function Startup()</span>
<a href="#l4.23"></a><span id="l4.23">     document.title = gReplicationBundle.getString(&quot;directoryTitleNew&quot;);</span>
<a href="#l4.24"></a><span id="l4.24">     fillDefaultSettings();</span>
<a href="#l4.25"></a><span id="l4.25">     // Don't add observer here as it doesn't make any sense.</span>
<a href="#l4.26"></a><span id="l4.26">   }</span>
<a href="#l4.27"></a><span id="l4.27"> }</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29"> function onUnload()</span>
<a href="#l4.30"></a><span id="l4.30"> {</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-  if (&quot;arguments&quot; in window &amp;&amp; </span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+  if (&quot;arguments&quot; in window &amp;&amp;</span>
<a href="#l4.33"></a><span id="l4.33">       window.arguments[0] &amp;&amp;</span>
<a href="#l4.34"></a><span id="l4.34">       !Services.prefs.prefIsLocked(gCurrentDirectory.dirPrefId +</span>
<a href="#l4.35"></a><span id="l4.35">                                    &quot;.disable_button_download&quot;)) {</span>
<a href="#l4.36"></a><span id="l4.36">     // Remove the observer that we put in on dialog startup</span>
<a href="#l4.37"></a><span id="l4.37">     Services.obs.removeObserver(ldapOfflineObserver,</span>
<a href="#l4.38"></a><span id="l4.38">                                 &quot;network:offline-status-changed&quot;);</span>
<a href="#l4.39"></a><span id="l4.39">   }</span>
<a href="#l4.40"></a><span id="l4.40"> }</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineat">@@ -94,17 +94,17 @@ var progressListener = {</span>
<a href="#l4.42"></a><span id="l4.42">                                                          &quot;replicationStarted&quot; :</span>
<a href="#l4.43"></a><span id="l4.43">                                                          &quot;changesStarted&quot;);</span>
<a href="#l4.44"></a><span id="l4.44">       gDownloadInProgress = true;</span>
<a href="#l4.45"></a><span id="l4.45">       document.getElementById(&quot;download&quot;).label =</span>
<a href="#l4.46"></a><span id="l4.46">         gReplicationBundle.getString(&quot;cancelDownloadButton&quot;);</span>
<a href="#l4.47"></a><span id="l4.47">       document.getElementById(&quot;download&quot;).accessKey =</span>
<a href="#l4.48"></a><span id="l4.48">         gReplicationBundle.getString(&quot;cancelDownloadButton.accesskey&quot;);</span>
<a href="#l4.49"></a><span id="l4.49">     }</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-    </span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+</span>
<a href="#l4.52"></a><span id="l4.52">     if (aStateFlags &amp; Components.interfaces.nsIWebProgressListener.STATE_STOP) {</span>
<a href="#l4.53"></a><span id="l4.53">       EndDownload(aStatus);</span>
<a href="#l4.54"></a><span id="l4.54">     }</span>
<a href="#l4.55"></a><span id="l4.55">   },</span>
<a href="#l4.56"></a><span id="l4.56">   onProgressChange: function(aWebProgress, aRequest, aCurSelfProgress, aMaxSelfProgress, aCurTotalProgress, aMaxTotalProgress)</span>
<a href="#l4.57"></a><span id="l4.57">   {</span>
<a href="#l4.58"></a><span id="l4.58">     gProgressText.value = gReplicationBundle.getFormattedString(&quot;currentCount&quot;,</span>
<a href="#l4.59"></a><span id="l4.59">                                                                 [aCurSelfProgress]);</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineat">@@ -115,18 +115,18 @@ var progressListener = {</span>
<a href="#l4.61"></a><span id="l4.61">   onStatusChange: function(aWebProgress, aRequest, aStatus, aMessage)</span>
<a href="#l4.62"></a><span id="l4.62">   {</span>
<a href="#l4.63"></a><span id="l4.63">   },</span>
<a href="#l4.64"></a><span id="l4.64">   onSecurityChange: function(aWebProgress, aRequest, state)</span>
<a href="#l4.65"></a><span id="l4.65">   {</span>
<a href="#l4.66"></a><span id="l4.66">   },</span>
<a href="#l4.67"></a><span id="l4.67">   QueryInterface : function(iid)</span>
<a href="#l4.68"></a><span id="l4.68">   {</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-    if (iid.equals(Components.interfaces.nsIWebProgressListener) || </span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-        iid.equals(Components.interfaces.nsISupportsWeakReference) || </span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+    if (iid.equals(Components.interfaces.nsIWebProgressListener) ||</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+        iid.equals(Components.interfaces.nsISupportsWeakReference) ||</span>
<a href="#l4.73"></a><span id="l4.73">         iid.equals(Components.interfaces.nsISupports))</span>
<a href="#l4.74"></a><span id="l4.74">       return this;</span>
<a href="#l4.75"></a><span id="l4.75">     throw Components.results.NS_NOINTERFACE;</span>
<a href="#l4.76"></a><span id="l4.76">   }</span>
<a href="#l4.77"></a><span id="l4.77"> };</span>
<a href="#l4.78"></a><span id="l4.78"> </span>
<a href="#l4.79"></a><span id="l4.79"> function DownloadNow()</span>
<a href="#l4.80"></a><span id="l4.80"> {</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineat">@@ -150,17 +150,17 @@ function DownloadNow()</span>
<a href="#l4.82"></a><span id="l4.82">     }</span>
<a href="#l4.83"></a><span id="l4.83">   } else {</span>
<a href="#l4.84"></a><span id="l4.84">     gReplicationCancelled = true;</span>
<a href="#l4.85"></a><span id="l4.85">     try {</span>
<a href="#l4.86"></a><span id="l4.86">       gReplicationService.cancelReplication(gCurrentDirectory.dirPrefId);</span>
<a href="#l4.87"></a><span id="l4.87">     }</span>
<a href="#l4.88"></a><span id="l4.88">     catch (ex) {</span>
<a href="#l4.89"></a><span id="l4.89">       // XXX todo</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineminus">-      // perhaps replication hasn't started yet?  This can happen if you hit cancel after attempting to replication when offline </span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+      // perhaps replication hasn't started yet?  This can happen if you hit cancel after attempting to replication when offline</span>
<a href="#l4.92"></a><span id="l4.92">       dump(&quot;unexpected failure while cancelling.  ex=&quot; + ex + &quot;\n&quot;);</span>
<a href="#l4.93"></a><span id="l4.93">     }</span>
<a href="#l4.94"></a><span id="l4.94">   }</span>
<a href="#l4.95"></a><span id="l4.95"> }</span>
<a href="#l4.96"></a><span id="l4.96"> </span>
<a href="#l4.97"></a><span id="l4.97"> function EndDownload(aStatus)</span>
<a href="#l4.98"></a><span id="l4.98"> {</span>
<a href="#l4.99"></a><span id="l4.99">   document.getElementById(&quot;download&quot;).label =</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineat">@@ -175,17 +175,17 @@ function EndDownload(aStatus)</span>
<a href="#l4.101"></a><span id="l4.101"> </span>
<a href="#l4.102"></a><span id="l4.102">   gDownloadInProgress = false;</span>
<a href="#l4.103"></a><span id="l4.103">   gProgressText.value =</span>
<a href="#l4.104"></a><span id="l4.104">     gReplicationBundle.getString(aStatus ? &quot;replicationSucceeded&quot; :</span>
<a href="#l4.105"></a><span id="l4.105">                                  gReplicationCancelled ? &quot;replicationCancelled&quot; :</span>
<a href="#l4.106"></a><span id="l4.106">                                   &quot;replicationFailed&quot;);</span>
<a href="#l4.107"></a><span id="l4.107"> }</span>
<a href="#l4.108"></a><span id="l4.108"> </span>
<a href="#l4.109"></a><span id="l4.109" class="difflineminus">-// fill the settings panel with the data from the preferences. </span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+// fill the settings panel with the data from the preferences.</span>
<a href="#l4.111"></a><span id="l4.111"> //</span>
<a href="#l4.112"></a><span id="l4.112"> function fillSettings()</span>
<a href="#l4.113"></a><span id="l4.113"> {</span>
<a href="#l4.114"></a><span id="l4.114">   document.getElementById(&quot;description&quot;).value = gCurrentDirectory.dirName;</span>
<a href="#l4.115"></a><span id="l4.115"> </span>
<a href="#l4.116"></a><span id="l4.116">   if (gCurrentDirectory instanceof Components.interfaces.nsIAbLDAPDirectory) {</span>
<a href="#l4.117"></a><span id="l4.117">     var ldapUrl = gCurrentDirectory.lDAPURL;</span>
<a href="#l4.118"></a><span id="l4.118"> </span>
<a href="#l4.119"></a><span id="l4.119" class="difflineat">@@ -199,17 +199,17 @@ function fillSettings()</span>
<a href="#l4.120"></a><span id="l4.120">     switch(ldapUrl.scope) {</span>
<a href="#l4.121"></a><span id="l4.121">     case Components.interfaces.nsILDAPURL.SCOPE_ONELEVEL:</span>
<a href="#l4.122"></a><span id="l4.122">       sub.radioGroup.selectedItem = document.getElementById(&quot;one&quot;);</span>
<a href="#l4.123"></a><span id="l4.123">       break;</span>
<a href="#l4.124"></a><span id="l4.124">     default:</span>
<a href="#l4.125"></a><span id="l4.125">       sub.radioGroup.selectedItem = sub;</span>
<a href="#l4.126"></a><span id="l4.126">       break;</span>
<a href="#l4.127"></a><span id="l4.127">     }</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineminus">-    </span>
<a href="#l4.129"></a><span id="l4.129" class="difflineplus">+</span>
<a href="#l4.130"></a><span id="l4.130">     var sasl = document.getElementById(&quot;saslMechanism&quot;);</span>
<a href="#l4.131"></a><span id="l4.131">     switch (gCurrentDirectory.saslMechanism) {</span>
<a href="#l4.132"></a><span id="l4.132">     case &quot;GSSAPI&quot;:</span>
<a href="#l4.133"></a><span id="l4.133">       sasl.selectedItem = document.getElementById(&quot;GSSAPI&quot;);</span>
<a href="#l4.134"></a><span id="l4.134">       break;</span>
<a href="#l4.135"></a><span id="l4.135">     default:</span>
<a href="#l4.136"></a><span id="l4.136">       sasl.selectedItem = document.getElementById(&quot;Simple&quot;);</span>
<a href="#l4.137"></a><span id="l4.137">       break;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPAutoCompleteSearch.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -240,17 +240,17 @@ nsAbLDAPAutoCompleteSearch.prototype = {</span>
<a href="#l5.4"></a><span id="l5.4">     this._timer.init(this, 60000, Components.interfaces.nsITimer.TYPE_ONE_SHOT);</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6">     var args =</span>
<a href="#l5.7"></a><span id="l5.7">       Components.classes[&quot;@mozilla.org/addressbook/directory/query-arguments;1&quot;]</span>
<a href="#l5.8"></a><span id="l5.8">                 .createInstance(Components.interfaces.nsIAbDirectoryQueryArguments);</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10">     var filterTemplate = this._book.getStringValue(&quot;autoComplete.filterTemplate&quot;, &quot;&quot;);</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    // Use default value when preference is not set or it contains empty string    </span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    // Use default value when preference is not set or it contains empty string</span>
<a href="#l5.14"></a><span id="l5.14">     if (!filterTemplate)</span>
<a href="#l5.15"></a><span id="l5.15">       filterTemplate = &quot;(|(cn=%v1*%v2-*)(mail=%v1*%v2-*)(sn=%v1*%v2-*))&quot;;</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17">     // Create filter from filter template and search string</span>
<a href="#l5.18"></a><span id="l5.18">     var ldapSvc = Components.classes[&quot;@mozilla.org/network/ldap-service;1&quot;]</span>
<a href="#l5.19"></a><span id="l5.19">                             .getService(Components.interfaces.nsILDAPService);</span>
<a href="#l5.20"></a><span id="l5.20">     var filter = ldapSvc.createFilter(1024, filterTemplate, &quot;&quot;, &quot;&quot;, &quot;&quot;, aSearchString);</span>
<a href="#l5.21"></a><span id="l5.21">     if (!filter)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/test/unit/test_notifications.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/test/unit/test_notifications.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -96,17 +96,17 @@ function run_test() {</span>
<a href="#l6.4"></a><span id="l6.4">   mailList.listNickName = &quot;test&quot;;</span>
<a href="#l6.5"></a><span id="l6.5">   mailList.description = &quot;testdescription&quot;;</span>
<a href="#l6.6"></a><span id="l6.6"> </span>
<a href="#l6.7"></a><span id="l6.7">   // For mailing list addition, we expect 2 results, one for the card, one</span>
<a href="#l6.8"></a><span id="l6.8">   // for the directory</span>
<a href="#l6.9"></a><span id="l6.9">   abListener.maxResults = 2;</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11">   AB.addMailList(mailList);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">- </span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+</span>
<a href="#l6.14"></a><span id="l6.14">   Assert.equal(abListener.result.length, 2);</span>
<a href="#l6.15"></a><span id="l6.15">   Assert.equal(abListener.result[0][0], &quot;onItemAdded&quot;);</span>
<a href="#l6.16"></a><span id="l6.16">   Assert.equal(abListener.result[0][1], AB);</span>
<a href="#l6.17"></a><span id="l6.17">   Assert.equal(abListener.result[1][0], &quot;onItemAdded&quot;);</span>
<a href="#l6.18"></a><span id="l6.18">   Assert.equal(abListener.result[1][1], AB);</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20">   // Now verify the card and the directory</span>
<a href="#l6.21"></a><span id="l6.21">   card = abListener.result[0][2].QueryInterface(Ci.nsIAbCard);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/test/unit/test_nsAbAutoCompleteSearch5.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l7.4"></a><span id="l7.4"> /* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l7.5"></a><span id="l7.5"> /*</span>
<a href="#l7.6"></a><span id="l7.6">  * This suite ensures that we can correctly read and re-set the popularity</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineminus">- * indexes on a </span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+ * indexes on a</span>
<a href="#l7.9"></a><span id="l7.9">  */</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11"> var ACR = Components.interfaces.nsIAutoCompleteResult;</span>
<a href="#l7.12"></a><span id="l7.12"> </span>
<a href="#l7.13"></a><span id="l7.13"> var results = [ { email: &quot;d &lt;ema@test.invalid&gt;&quot;, dirName: kPABData.dirName },</span>
<a href="#l7.14"></a><span id="l7.14">                   { email: &quot;di &lt;emai@test.invalid&gt;&quot;, dirName: kPABData.dirName },</span>
<a href="#l7.15"></a><span id="l7.15">                   { email: &quot;dis &lt;email@test.invalid&gt;&quot;, dirName: kPABData.dirName },</span>
<a href="#l7.16"></a><span id="l7.16">                   { email: &quot;disp &lt;e@test.invalid&gt;&quot;, dirName: kPABData.dirName },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/content/dateFormat.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/content/dateFormat.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -116,17 +116,17 @@ function initializeSearchDateFormat()</span>
<a href="#l8.4"></a><span id="l8.4"> }</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> function convertPRTimeToString(tm)</span>
<a href="#l8.7"></a><span id="l8.7"> {</span>
<a href="#l8.8"></a><span id="l8.8">   var time = new Date();</span>
<a href="#l8.9"></a><span id="l8.9">   // PRTime is in microseconds, JavaScript time is in milliseconds</span>
<a href="#l8.10"></a><span id="l8.10">   // so divide by 1000 when converting</span>
<a href="#l8.11"></a><span id="l8.11">   time.setTime(tm / 1000);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  </span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+</span>
<a href="#l8.14"></a><span id="l8.14">   return convertDateToString(time);</span>
<a href="#l8.15"></a><span id="l8.15"> }</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17"> function convertDateToString(time)</span>
<a href="#l8.18"></a><span id="l8.18"> {</span>
<a href="#l8.19"></a><span id="l8.19">   initializeSearchDateFormat();</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21">   var year = time.getFullYear();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/content/jsTreeView.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/content/jsTreeView.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -224,12 +224,12 @@ PROTO_TREE_VIEW.prototype = {</span>
<a href="#l9.4"></a><span id="l9.4">         this.toggleOpenState(i);</span>
<a href="#l9.5"></a><span id="l9.5">     }</span>
<a href="#l9.6"></a><span id="l9.6">   },</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">   QueryInterface: function QueryInterface(aIID) {</span>
<a href="#l9.9"></a><span id="l9.9">     if (aIID.equals(Components.interfaces.nsITreeView) ||</span>
<a href="#l9.10"></a><span id="l9.10">         aIID.equals(Components.interfaces.nsISupports))</span>
<a href="#l9.11"></a><span id="l9.11">       return this;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">- </span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+</span>
<a href="#l9.14"></a><span id="l9.14">     throw Components.results.NS_ERROR_NO_INTERFACE;</span>
<a href="#l9.15"></a><span id="l9.15">   }</span>
<a href="#l9.16"></a><span id="l9.16"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/content/markByDate.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/content/markByDate.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -111,17 +111,17 @@ function markInDatabase( lower, upper )</span>
<a href="#l10.4"></a><span id="l10.4">     value = searchTerm.value;</span>
<a href="#l10.5"></a><span id="l10.5">     value.attrib = nsMsgSearchAttrib.Date;</span>
<a href="#l10.6"></a><span id="l10.6">     value.date = lower;</span>
<a href="#l10.7"></a><span id="l10.7">     searchTerm.value = value;</span>
<a href="#l10.8"></a><span id="l10.8">     searchTerms.appendElement( searchTerm );</span>
<a href="#l10.9"></a><span id="l10.9">   }</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11">   var filterEnumerator = messageDatabase.getFilterEnumerator( searchTerms );</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  </span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+</span>
<a href="#l10.14"></a><span id="l10.14">   if ( filterEnumerator )</span>
<a href="#l10.15"></a><span id="l10.15">   {</span>
<a href="#l10.16"></a><span id="l10.16">     var keepGoing;</span>
<a href="#l10.17"></a><span id="l10.17">     var numMatches = {};</span>
<a href="#l10.18"></a><span id="l10.18">     do</span>
<a href="#l10.19"></a><span id="l10.19">     {</span>
<a href="#l10.20"></a><span id="l10.20">       keepGoing = messageDatabase.nextMatchingHdrs(filterEnumerator, 0, 0, headers, numMatches);</span>
<a href="#l10.21"></a><span id="l10.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/content/msgFolderPickerOverlay.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/content/msgFolderPickerOverlay.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -6,31 +6,31 @@</span>
<a href="#l11.4"></a><span id="l11.4"> ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6"> var gMessengerBundle;</span>
<a href="#l11.7"></a><span id="l11.7"> </span>
<a href="#l11.8"></a><span id="l11.8"> // call this from dialog onload() to set the menu item to the correct value</span>
<a href="#l11.9"></a><span id="l11.9"> function MsgFolderPickerOnLoad(pickerID)</span>
<a href="#l11.10"></a><span id="l11.10"> {</span>
<a href="#l11.11"></a><span id="l11.11"> 	var uri = null;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-	try { </span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+	try {</span>
<a href="#l11.14"></a><span id="l11.14"> 		uri = window.arguments[0].preselectedURI;</span>
<a href="#l11.15"></a><span id="l11.15"> 	}</span>
<a href="#l11.16"></a><span id="l11.16"> 	catch (ex) {</span>
<a href="#l11.17"></a><span id="l11.17"> 		uri = null;</span>
<a href="#l11.18"></a><span id="l11.18"> 	}</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> 	if (uri) {</span>
<a href="#l11.21"></a><span id="l11.21"> 		//dump(&quot;on loading, set titled button to &quot; + uri + &quot;\n&quot;);</span>
<a href="#l11.22"></a><span id="l11.22"> </span>
<a href="#l11.23"></a><span id="l11.23"> 		// verify that the value we are attempting to</span>
<a href="#l11.24"></a><span id="l11.24"> 		// pre-flight the menu with is valid for this</span>
<a href="#l11.25"></a><span id="l11.25"> 		// picker type</span>
<a href="#l11.26"></a><span id="l11.26"> 		var msgfolder = MailUtils.getFolderForURI(uri, true);</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineminus">-        	if (!msgfolder) return; </span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+        	if (!msgfolder) return;</span>
<a href="#l11.29"></a><span id="l11.29"> 		</span>
<a href="#l11.30"></a><span id="l11.30"> 		var verifyFunction = null;</span>
<a href="#l11.31"></a><span id="l11.31"> </span>
<a href="#l11.32"></a><span id="l11.32"> 		switch (pickerID) {</span>
<a href="#l11.33"></a><span id="l11.33"> 			case &quot;msgNewFolderPicker&quot;:</span>
<a href="#l11.34"></a><span id="l11.34"> 				verifyFunction = msgfolder.canCreateSubfolders;</span>
<a href="#l11.35"></a><span id="l11.35"> 				break;</span>
<a href="#l11.36"></a><span id="l11.36"> 			case &quot;msgRenameFolderPicker&quot;:</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineat">@@ -46,23 +46,23 @@ function MsgFolderPickerOnLoad(pickerID)</span>
<a href="#l11.38"></a><span id="l11.38"> 		}</span>
<a href="#l11.39"></a><span id="l11.39"> 	}</span>
<a href="#l11.40"></a><span id="l11.40"> }</span>
<a href="#l11.41"></a><span id="l11.41"> </span>
<a href="#l11.42"></a><span id="l11.42"> function PickedMsgFolder(selection,pickerID)</span>
<a href="#l11.43"></a><span id="l11.43"> {</span>
<a href="#l11.44"></a><span id="l11.44">   var selectedUri = selection.getAttribute('id');</span>
<a href="#l11.45"></a><span id="l11.45">   SetFolderPicker(selectedUri,pickerID);</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineminus">-}     </span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+}</span>
<a href="#l11.48"></a><span id="l11.48"> </span>
<a href="#l11.49"></a><span id="l11.49"> function SetFolderPickerElement(uri, picker)</span>
<a href="#l11.50"></a><span id="l11.50"> {</span>
<a href="#l11.51"></a><span id="l11.51">   var msgfolder = MailUtils.getFolderForURI(uri, true);</span>
<a href="#l11.52"></a><span id="l11.52"> </span>
<a href="#l11.53"></a><span id="l11.53" class="difflineminus">-  if (!msgfolder) </span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+  if (!msgfolder)</span>
<a href="#l11.55"></a><span id="l11.55">     return;</span>
<a href="#l11.56"></a><span id="l11.56"> </span>
<a href="#l11.57"></a><span id="l11.57">   var selectedValue = null;</span>
<a href="#l11.58"></a><span id="l11.58">   var serverName;</span>
<a href="#l11.59"></a><span id="l11.59"> </span>
<a href="#l11.60"></a><span id="l11.60">   if (msgfolder.isServer)</span>
<a href="#l11.61"></a><span id="l11.61">     selectedValue = msgfolder.name;</span>
<a href="#l11.62"></a><span id="l11.62">   else {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/content/msgPrintEngine.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/content/msgPrintEngine.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -117,17 +117,17 @@ function InitPrintEngineWindow()</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5">   /* Tell the nsIPrintEngine object what window is rendering the email */</span>
<a href="#l12.6"></a><span id="l12.6">   printEngine.setWindow(window);</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8">   /* hide the printEngine window.  see bug #73995 */</span>
<a href="#l12.9"></a><span id="l12.9"> </span>
<a href="#l12.10"></a><span id="l12.10">   /* See if we got arguments.</span>
<a href="#l12.11"></a><span id="l12.11">    * Window was opened via window.openDialog.  Copy argument</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-   * and perform compose initialization </span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+   * and perform compose initialization</span>
<a href="#l12.14"></a><span id="l12.14">    */</span>
<a href="#l12.15"></a><span id="l12.15">   if (window.arguments &amp;&amp; window.arguments[0] != null) {</span>
<a href="#l12.16"></a><span id="l12.16">     var numSelected = window.arguments[0];</span>
<a href="#l12.17"></a><span id="l12.17">     var uriArray = window.arguments[1];</span>
<a href="#l12.18"></a><span id="l12.18">     var statusFeedback = window.arguments[2];</span>
<a href="#l12.19"></a><span id="l12.19"> </span>
<a href="#l12.20"></a><span id="l12.20">     if (window.arguments[3]) {</span>
<a href="#l12.21"></a><span id="l12.21">       printEngine.doPrintPreview = window.arguments[3];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/content/msgSynchronize.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/content/msgSynchronize.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -87,17 +87,17 @@ function selectOnLoad()</span>
<a href="#l13.4"></a><span id="l13.4">     gMsgWindow = Components.classes[&quot;@mozilla.org/messenger/msgwindow;1&quot;]</span>
<a href="#l13.5"></a><span id="l13.5">                            .createInstance(Components.interfaces.nsIMsgWindow);</span>
<a href="#l13.6"></a><span id="l13.6">     gMsgWindow.domWindow = window;</span>
<a href="#l13.7"></a><span id="l13.7">     gMsgWindow.rootDocShell.appType = Components.interfaces.nsIDocShell.APP_TYPE_MAIL;</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9">     gSynchronizeTree = document.getElementById('synchronizeTree');</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">     SortSynchronizePane('folderNameCol', '?folderTreeNameSort');</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-} </span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+}</span>
<a href="#l13.14"></a><span id="l13.14"> </span>
<a href="#l13.15"></a><span id="l13.15"> function SortSynchronizePane(column, sortKey)</span>
<a href="#l13.16"></a><span id="l13.16"> {</span>
<a href="#l13.17"></a><span id="l13.17">     var node = FindInWindow(window, column);</span>
<a href="#l13.18"></a><span id="l13.18">     if(!node) {</span>
<a href="#l13.19"></a><span id="l13.19">         dump('Couldnt find sort column\n');</span>
<a href="#l13.20"></a><span id="l13.20">         return;</span>
<a href="#l13.21"></a><span id="l13.21">     }</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -155,29 +155,29 @@ function onSynchronizeClick(event)</span>
<a href="#l13.23"></a><span id="l13.23">                 var imapFolder = folderResource.QueryInterface(Components.interfaces.nsIMsgImapMailFolder);</span>
<a href="#l13.24"></a><span id="l13.24">                 if (imapFolder) {</span>
<a href="#l13.25"></a><span id="l13.25">                   imapFolder.performExpand(gMsgWindow);</span>
<a href="#l13.26"></a><span id="l13.26">                 }</span>
<a href="#l13.27"></a><span id="l13.27">             }</span>
<a href="#l13.28"></a><span id="l13.28">         }</span>
<a href="#l13.29"></a><span id="l13.29">     }</span>
<a href="#l13.30"></a><span id="l13.30">     else {</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-      if (col.value.id == &quot;syncCol&quot;) {   </span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+      if (col.value.id == &quot;syncCol&quot;) {</span>
<a href="#l13.33"></a><span id="l13.33">         UpdateNode(GetFolderResource(gSynchronizeTree, row.value), row.value);</span>
<a href="#l13.34"></a><span id="l13.34">       }</span>
<a href="#l13.35"></a><span id="l13.35">     }</span>
<a href="#l13.36"></a><span id="l13.36"> }</span>
<a href="#l13.37"></a><span id="l13.37"> </span>
<a href="#l13.38"></a><span id="l13.38"> function onSynchronizeTreeKeyPress(event)</span>
<a href="#l13.39"></a><span id="l13.39"> {</span>
<a href="#l13.40"></a><span id="l13.40">     // for now, only do something on space key</span>
<a href="#l13.41"></a><span id="l13.41">     if (event.charCode != KeyEvent.DOM_VK_SPACE)</span>
<a href="#l13.42"></a><span id="l13.42">       return;</span>
<a href="#l13.43"></a><span id="l13.43"> </span>
<a href="#l13.44"></a><span id="l13.44" class="difflineminus">-    var treeSelection = gSynchronizeTree.view.selection; </span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+    var treeSelection = gSynchronizeTree.view.selection;</span>
<a href="#l13.46"></a><span id="l13.46">     for (var i=0;i&lt;treeSelection.getRangeCount();i++) {</span>
<a href="#l13.47"></a><span id="l13.47">       var start = {}, end = {};</span>
<a href="#l13.48"></a><span id="l13.48">       treeSelection.getRangeAt(i,start,end);</span>
<a href="#l13.49"></a><span id="l13.49">       for (var k=start.value;k&lt;=end.value;k++)</span>
<a href="#l13.50"></a><span id="l13.50">         UpdateNode(GetFolderResource(gSynchronizeTree, k), k);</span>
<a href="#l13.51"></a><span id="l13.51">     }</span>
<a href="#l13.52"></a><span id="l13.52"> }</span>
<a href="#l13.53"></a><span id="l13.53"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/content/shutdownWindow.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/content/shutdownWindow.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -42,22 +42,22 @@ function updateProgressMeter(inPercent)</span>
<a href="#l14.4"></a><span id="l14.4">   taskProgressmeter.value = inPercent;</span>
<a href="#l14.5"></a><span id="l14.5"> }</span>
<a href="#l14.6"></a><span id="l14.6"> </span>
<a href="#l14.7"></a><span id="l14.7"> function onCancel()</span>
<a href="#l14.8"></a><span id="l14.8"> {</span>
<a href="#l14.9"></a><span id="l14.9">   msgShutdownService.cancelShutdownTasks();</span>
<a href="#l14.10"></a><span id="l14.10"> }</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-function nsMsgShutdownTaskListener() </span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+function nsMsgShutdownTaskListener()</span>
<a href="#l14.14"></a><span id="l14.14"> {</span>
<a href="#l14.15"></a><span id="l14.15">   msgShutdownService.setShutdownListener(this);</span>
<a href="#l14.16"></a><span id="l14.16"> }</span>
<a href="#l14.17"></a><span id="l14.17"> </span>
<a href="#l14.18"></a><span id="l14.18" class="difflineminus">-nsMsgShutdownTaskListener.prototype = </span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+nsMsgShutdownTaskListener.prototype =</span>
<a href="#l14.20"></a><span id="l14.20"> {</span>
<a href="#l14.21"></a><span id="l14.21">   QueryInterface : function(iid)</span>
<a href="#l14.22"></a><span id="l14.22">   {</span>
<a href="#l14.23"></a><span id="l14.23">     if (iid.equals(Components.interfaces.nsIWebProgressListener) ||</span>
<a href="#l14.24"></a><span id="l14.24">         iid.equals(Components.interfaces.nsISupportsWeakReference) ||</span>
<a href="#l14.25"></a><span id="l14.25">         iid.equals(Components.interfaces.nsISupports))</span>
<a href="#l14.26"></a><span id="l14.26">       return this;</span>
<a href="#l14.27"></a><span id="l14.27"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/content/virtualFolderProperties.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/content/virtualFolderProperties.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -29,27 +29,27 @@ function onLoad()</span>
<a href="#l15.4"></a><span id="l15.4">   // call this when OK is pressed</span>
<a href="#l15.5"></a><span id="l15.5">   msgWindow = windowArgs.msgWindow;</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7">   initializeSearchWidgets();</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9">   setSearchScope(nsMsgSearchScope.offlineMail);</span>
<a href="#l15.10"></a><span id="l15.10">   if (windowArgs.editExistingFolder)</span>
<a href="#l15.11"></a><span id="l15.11">   {</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-    acceptButton.label = </span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+    acceptButton.label =</span>
<a href="#l15.14"></a><span id="l15.14">         document.documentElement.getAttribute(&quot;editFolderAcceptButtonLabel&quot;);</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-    acceptButton.accesskey = </span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+    acceptButton.accesskey =</span>
<a href="#l15.17"></a><span id="l15.17">         document.documentElement.getAttribute(&quot;editFolderAcceptButtonAccessKey&quot;);</span>
<a href="#l15.18"></a><span id="l15.18">     InitDialogWithVirtualFolder(windowArgs.folder);</span>
<a href="#l15.19"></a><span id="l15.19">   }</span>
<a href="#l15.20"></a><span id="l15.20">   else // we are creating a new virtual folder</span>
<a href="#l15.21"></a><span id="l15.21">   {</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-    acceptButton.label = </span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+    acceptButton.label =</span>
<a href="#l15.24"></a><span id="l15.24">         document.documentElement.getAttribute(&quot;newFolderAcceptButtonLabel&quot;);</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-    acceptButton.accesskey = </span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+    acceptButton.accesskey =</span>
<a href="#l15.27"></a><span id="l15.27">         document.documentElement.getAttribute(&quot;newFolderAcceptButtonAccessKey&quot;);</span>
<a href="#l15.28"></a><span id="l15.28">     // it is possible that we were given arguments to pre-fill the dialog with...</span>
<a href="#l15.29"></a><span id="l15.29">     gSearchTermSession = Components.classes[&quot;@mozilla.org/messenger/searchSession;1&quot;]</span>
<a href="#l15.30"></a><span id="l15.30">                                    .createInstance(Components.interfaces.nsIMsgSearchSession);</span>
<a href="#l15.31"></a><span id="l15.31"> </span>
<a href="#l15.32"></a><span id="l15.32">     if (windowArgs.searchTerms) // then add them to our search session</span>
<a href="#l15.33"></a><span id="l15.33">     {</span>
<a href="#l15.34"></a><span id="l15.34">       for (let searchTerm of fixIterator(windowArgs.searchTerms,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/prefs/content/AccountWizard.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/prefs/content/AccountWizard.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -7,37 +7,37 @@</span>
<a href="#l16.4"></a><span id="l16.4"> var okCallback = null;</span>
<a href="#l16.5"></a><span id="l16.5"> /* The account wizard creates new accounts */</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7"> /*</span>
<a href="#l16.8"></a><span id="l16.8">   data flow into the account wizard like this:</span>
<a href="#l16.9"></a><span id="l16.9"> </span>
<a href="#l16.10"></a><span id="l16.10">   For new accounts:</span>
<a href="#l16.11"></a><span id="l16.11">   * pageData -&gt; Array -&gt; createAccount -&gt; finishAccount</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  </span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+</span>
<a href="#l16.14"></a><span id="l16.14">   For accounts coming from the ISP setup:</span>
<a href="#l16.15"></a><span id="l16.15">   * RDF  -&gt; Array -&gt; pageData -&gt; Array -&gt; createAccount -&gt; finishAccount</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineminus">-  </span>
<a href="#l16.17"></a><span id="l16.17" class="difflineminus">-  for &quot;unfinished accounts&quot; </span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+  for &quot;unfinished accounts&quot;</span>
<a href="#l16.20"></a><span id="l16.20">   * account -&gt; Array -&gt; pageData -&gt; Array -&gt; finishAccount</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineminus">-  </span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+</span>
<a href="#l16.23"></a><span id="l16.23">   Where:</span>
<a href="#l16.24"></a><span id="l16.24">   pageData - the actual pages coming out of the Widget State Manager</span>
<a href="#l16.25"></a><span id="l16.25">   RDF      - the ISP datasource</span>
<a href="#l16.26"></a><span id="l16.26">   Array    - associative array of attributes, that very closely</span>
<a href="#l16.27"></a><span id="l16.27">              resembles the nsIMsgAccount/nsIMsgIncomingServer/nsIMsgIdentity</span>
<a href="#l16.28"></a><span id="l16.28">              structure</span>
<a href="#l16.29"></a><span id="l16.29">   createAccount() - creates an account from the above Array</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-  finishAccount() - fills an existing account with data from the above Array </span>
<a href="#l16.31"></a><span id="l16.31" class="difflineplus">+  finishAccount() - fills an existing account with data from the above Array</span>
<a href="#l16.32"></a><span id="l16.32"> </span>
<a href="#l16.33"></a><span id="l16.33"> */</span>
<a href="#l16.34"></a><span id="l16.34"> </span>
<a href="#l16.35"></a><span id="l16.35" class="difflineminus">-/* </span>
<a href="#l16.36"></a><span id="l16.36" class="difflineplus">+/*</span>
<a href="#l16.37"></a><span id="l16.37">    the account wizard path is something like:</span>
<a href="#l16.38"></a><span id="l16.38" class="difflineminus">-   </span>
<a href="#l16.39"></a><span id="l16.39" class="difflineplus">+</span>
<a href="#l16.40"></a><span id="l16.40">    accounttype -&gt; identity -&gt; server -&gt; login -&gt; accname -&gt; done</span>
<a href="#l16.41"></a><span id="l16.41">                              \-&gt; newsserver ----/</span>
<a href="#l16.42"></a><span id="l16.42"> </span>
<a href="#l16.43"></a><span id="l16.43">    where the accounttype determines which path to take</span>
<a href="#l16.44"></a><span id="l16.44">    (server vs. newsserver)</span>
<a href="#l16.45"></a><span id="l16.45"> */</span>
<a href="#l16.46"></a><span id="l16.46"> </span>
<a href="#l16.47"></a><span id="l16.47"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l16.48"></a><span id="l16.48" class="difflineat">@@ -71,17 +71,17 @@ function onAccountWizardLoad() {</span>
<a href="#l16.49"></a><span id="l16.49">   if (&quot;testingIspServices&quot; in this) {</span>
<a href="#l16.50"></a><span id="l16.50">     if (&quot;SetCustomizedWizardDimensions&quot; in this &amp;&amp; testingIspServices()) {</span>
<a href="#l16.51"></a><span id="l16.51">       SetCustomizedWizardDimensions();</span>
<a href="#l16.52"></a><span id="l16.52">     }</span>
<a href="#l16.53"></a><span id="l16.53">   }</span>
<a href="#l16.54"></a><span id="l16.54"> </span>
<a href="#l16.55"></a><span id="l16.55">   /* We are checking here for the callback argument */</span>
<a href="#l16.56"></a><span id="l16.56">   if (window.arguments &amp;&amp; window.arguments[0]) {</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineminus">-    if(window.arguments[0].okCallback ) </span>
<a href="#l16.58"></a><span id="l16.58" class="difflineplus">+    if(window.arguments[0].okCallback )</span>
<a href="#l16.59"></a><span id="l16.59">     {</span>
<a href="#l16.60"></a><span id="l16.60">       //dump(&quot;There is okCallback&quot;);</span>
<a href="#l16.61"></a><span id="l16.61">       top.okCallback = window.arguments[0].okCallback;</span>
<a href="#l16.62"></a><span id="l16.62">     }</span>
<a href="#l16.63"></a><span id="l16.63">   }</span>
<a href="#l16.64"></a><span id="l16.64"> </span>
<a href="#l16.65"></a><span id="l16.65">   checkForInvalidAccounts();</span>
<a href="#l16.66"></a><span id="l16.66"> </span>
<a href="#l16.67"></a><span id="l16.67" class="difflineat">@@ -96,24 +96,24 @@ function onAccountWizardLoad() {</span>
<a href="#l16.68"></a><span id="l16.68"> </span>
<a href="#l16.69"></a><span id="l16.69">   // Set default value for global inbox checkbox</span>
<a href="#l16.70"></a><span id="l16.70">   var checkGlobalInbox = document.getElementById(&quot;deferStorage&quot;);</span>
<a href="#l16.71"></a><span id="l16.71">   try {</span>
<a href="#l16.72"></a><span id="l16.72">     checkGlobalInbox.checked = Services.prefs.getBoolPref(&quot;mail.accountwizard.deferstorage&quot;);</span>
<a href="#l16.73"></a><span id="l16.73">   } catch(e) {}</span>
<a href="#l16.74"></a><span id="l16.74"> }</span>
<a href="#l16.75"></a><span id="l16.75"> </span>
<a href="#l16.76"></a><span id="l16.76" class="difflineminus">-function onCancel() </span>
<a href="#l16.77"></a><span id="l16.77" class="difflineplus">+function onCancel()</span>
<a href="#l16.78"></a><span id="l16.78"> {</span>
<a href="#l16.79"></a><span id="l16.79">   if (&quot;ActivationOnCancel&quot; in this &amp;&amp; ActivationOnCancel())</span>
<a href="#l16.80"></a><span id="l16.80">     return false;</span>
<a href="#l16.81"></a><span id="l16.81">   var firstInvalidAccount = getFirstInvalidAccount();</span>
<a href="#l16.82"></a><span id="l16.82">   var closeWizard = true;</span>
<a href="#l16.83"></a><span id="l16.83"> </span>
<a href="#l16.84"></a><span id="l16.84" class="difflineminus">-  // if the user cancels the the wizard when it pops up because of </span>
<a href="#l16.85"></a><span id="l16.85" class="difflineplus">+  // if the user cancels the the wizard when it pops up because of</span>
<a href="#l16.86"></a><span id="l16.86">   // an invalid account (example, a webmail account that activation started)</span>
<a href="#l16.87"></a><span id="l16.87">   // we just force create it by setting some values and calling the FinishAccount()</span>
<a href="#l16.88"></a><span id="l16.88">   // see bug #47521 for the full discussion</span>
<a href="#l16.89"></a><span id="l16.89">   if (firstInvalidAccount) {</span>
<a href="#l16.90"></a><span id="l16.90">     var pageData = GetPageData();</span>
<a href="#l16.91"></a><span id="l16.91">     // set the fullName if it doesn't exist</span>
<a href="#l16.92"></a><span id="l16.92">     if (!pageData.identity.fullName || !pageData.identity.fullName.value) {</span>
<a href="#l16.93"></a><span id="l16.93">       setPageData(pageData, &quot;identity&quot;, &quot;fullName&quot;, &quot;&quot;);</span>
<a href="#l16.94"></a><span id="l16.94" class="difflineat">@@ -134,78 +134,78 @@ function onCancel()</span>
<a href="#l16.95"></a><span id="l16.95">     // if the length of the account list is less than 1, there are no accounts</span>
<a href="#l16.96"></a><span id="l16.96">     if (MailServices.accounts.accounts.length &lt; 1) {</span>
<a href="#l16.97"></a><span id="l16.97">       let confirmMsg = gPrefsBundle.getString(&quot;cancelWizard&quot;);</span>
<a href="#l16.98"></a><span id="l16.98">       let confirmTitle = gPrefsBundle.getString(&quot;accountWizard&quot;);</span>
<a href="#l16.99"></a><span id="l16.99">       let result = Services.prompt.confirmEx(window, confirmTitle, confirmMsg,</span>
<a href="#l16.100"></a><span id="l16.100">         (Services.prompt.BUTTON_TITLE_IS_STRING * Services.prompt.BUTTON_POS_0) +</span>
<a href="#l16.101"></a><span id="l16.101">         (Services.prompt.BUTTON_TITLE_IS_STRING * Services.prompt.BUTTON_POS_1),</span>
<a href="#l16.102"></a><span id="l16.102">         gPrefsBundle.getString('WizardExit'),</span>
<a href="#l16.103"></a><span id="l16.103" class="difflineminus">-        gPrefsBundle.getString('WizardContinue'), </span>
<a href="#l16.104"></a><span id="l16.104" class="difflineplus">+        gPrefsBundle.getString('WizardContinue'),</span>
<a href="#l16.105"></a><span id="l16.105">         null, null, {value:0});</span>
<a href="#l16.106"></a><span id="l16.106"> </span>
<a href="#l16.107"></a><span id="l16.107">       if (result == 1)</span>
<a href="#l16.108"></a><span id="l16.108">         closeWizard = false;</span>
<a href="#l16.109"></a><span id="l16.109">     }</span>
<a href="#l16.110"></a><span id="l16.110"> </span>
<a href="#l16.111"></a><span id="l16.111">     if(top.okCallback &amp;&amp; closeWizard) {</span>
<a href="#l16.112"></a><span id="l16.112">       var state = false;</span>
<a href="#l16.113"></a><span id="l16.113">       top.okCallback(state);</span>
<a href="#l16.114"></a><span id="l16.114">     }</span>
<a href="#l16.115"></a><span id="l16.115">   }</span>
<a href="#l16.116"></a><span id="l16.116">   return closeWizard;</span>
<a href="#l16.117"></a><span id="l16.117"> }</span>
<a href="#l16.118"></a><span id="l16.118"> </span>
<a href="#l16.119"></a><span id="l16.119" class="difflineminus">-function FinishAccount() </span>
<a href="#l16.120"></a><span id="l16.120" class="difflineplus">+function FinishAccount()</span>
<a href="#l16.121"></a><span id="l16.121"> {</span>
<a href="#l16.122"></a><span id="l16.122">   try {</span>
<a href="#l16.123"></a><span id="l16.123">     var pageData = GetPageData();</span>
<a href="#l16.124"></a><span id="l16.124"> </span>
<a href="#l16.125"></a><span id="l16.125">     var accountData= gCurrentAccountData;</span>
<a href="#l16.126"></a><span id="l16.126" class="difflineminus">-    </span>
<a href="#l16.127"></a><span id="l16.127" class="difflineplus">+</span>
<a href="#l16.128"></a><span id="l16.128">     if (!accountData)</span>
<a href="#l16.129"></a><span id="l16.129">     {</span>
<a href="#l16.130"></a><span id="l16.130">       accountData = new Object;</span>
<a href="#l16.131"></a><span id="l16.131">       // Time to set the smtpRequiresUsername attribute</span>
<a href="#l16.132"></a><span id="l16.132">       if (!serverIsNntp(pageData))</span>
<a href="#l16.133"></a><span id="l16.133">         accountData.smtpRequiresUsername = true;</span>
<a href="#l16.134"></a><span id="l16.134">     }</span>
<a href="#l16.135"></a><span id="l16.135" class="difflineminus">-    </span>
<a href="#l16.136"></a><span id="l16.136" class="difflineplus">+</span>
<a href="#l16.137"></a><span id="l16.137">     // we may need local folders before account is &quot;Finished&quot;</span>
<a href="#l16.138"></a><span id="l16.138">     // if it's a pop3 account which defers to Local Folders.</span>
<a href="#l16.139"></a><span id="l16.139">     verifyLocalFoldersAccount();</span>
<a href="#l16.140"></a><span id="l16.140"> </span>
<a href="#l16.141"></a><span id="l16.141">     PageDataToAccountData(pageData, accountData);</span>
<a href="#l16.142"></a><span id="l16.142"> </span>
<a href="#l16.143"></a><span id="l16.143">     FixupAccountDataForIsp(accountData);</span>
<a href="#l16.144"></a><span id="l16.144" class="difflineminus">-    </span>
<a href="#l16.145"></a><span id="l16.145" class="difflineplus">+</span>
<a href="#l16.146"></a><span id="l16.146">     // we might be simply finishing another account</span>
<a href="#l16.147"></a><span id="l16.147">     if (!gCurrentAccount)</span>
<a href="#l16.148"></a><span id="l16.148">       gCurrentAccount = createAccount(accountData);</span>
<a href="#l16.149"></a><span id="l16.149"> </span>
<a href="#l16.150"></a><span id="l16.150">     // transfer all attributes from the accountdata</span>
<a href="#l16.151"></a><span id="l16.151">     finishAccount(gCurrentAccount, accountData);</span>
<a href="#l16.152"></a><span id="l16.152" class="difflineminus">-    </span>
<a href="#l16.153"></a><span id="l16.153" class="difflineplus">+</span>
<a href="#l16.154"></a><span id="l16.154">     setupCopiesAndFoldersServer(gCurrentAccount, getCurrentServerIsDeferred(pageData), accountData);</span>
<a href="#l16.155"></a><span id="l16.155"> </span>
<a href="#l16.156"></a><span id="l16.156">     if (gCurrentAccount.incomingServer.canBeDefaultServer)</span>
<a href="#l16.157"></a><span id="l16.157">       EnableCheckMailAtStartUpIfNeeded(gCurrentAccount);</span>
<a href="#l16.158"></a><span id="l16.158"> </span>
<a href="#l16.159"></a><span id="l16.159">     if (!document.getElementById(&quot;downloadMsgs&quot;).hidden) {</span>
<a href="#l16.160"></a><span id="l16.160">       // skip the default biff, we will load messages manually if needed</span>
<a href="#l16.161"></a><span id="l16.161">       window.opener.gLoadStartFolder = false;</span>
<a href="#l16.162"></a><span id="l16.162">       if (document.getElementById(&quot;downloadMsgs&quot;).checked) {</span>
<a href="#l16.163"></a><span id="l16.163">         window.opener.gNewAccountToLoad = gCurrentAccount; // load messages for new POP account</span>
<a href="#l16.164"></a><span id="l16.164">       }</span>
<a href="#l16.165"></a><span id="l16.165">     }</span>
<a href="#l16.166"></a><span id="l16.166"> </span>
<a href="#l16.167"></a><span id="l16.167">     // in case we crash, force us a save of the prefs file NOW</span>
<a href="#l16.168"></a><span id="l16.168">     try {</span>
<a href="#l16.169"></a><span id="l16.169">       MailServices.accounts.saveAccountInfo();</span>
<a href="#l16.170"></a><span id="l16.170" class="difflineminus">-    } </span>
<a href="#l16.171"></a><span id="l16.171" class="difflineplus">+    }</span>
<a href="#l16.172"></a><span id="l16.172">     catch (ex) {</span>
<a href="#l16.173"></a><span id="l16.173">       dump(&quot;Error saving account info: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l16.174"></a><span id="l16.174">     }</span>
<a href="#l16.175"></a><span id="l16.175">     window.close();</span>
<a href="#l16.176"></a><span id="l16.176">     if(top.okCallback)</span>
<a href="#l16.177"></a><span id="l16.177">     {</span>
<a href="#l16.178"></a><span id="l16.178">       var state = true;</span>
<a href="#l16.179"></a><span id="l16.179">       //dump(&quot;finish callback&quot;);</span>
<a href="#l16.180"></a><span id="l16.180" class="difflineat">@@ -223,23 +223,23 @@ function AccountDataToPageData(accountDa</span>
<a href="#l16.181"></a><span id="l16.181"> {</span>
<a href="#l16.182"></a><span id="l16.182">   if (!accountData) {</span>
<a href="#l16.183"></a><span id="l16.183">     dump(&quot;null account data! clearing..\n&quot;);</span>
<a href="#l16.184"></a><span id="l16.184">     // handle null accountData as if it were an empty object</span>
<a href="#l16.185"></a><span id="l16.185">     // so that we clear-out any old pagedata from a</span>
<a href="#l16.186"></a><span id="l16.186">     // previous accountdata. The trick is that</span>
<a href="#l16.187"></a><span id="l16.187">     // with an empty object, accountData.identity.slot is undefined,</span>
<a href="#l16.188"></a><span id="l16.188">     // so this will clear out the prefill data in setPageData</span>
<a href="#l16.189"></a><span id="l16.189" class="difflineminus">-    </span>
<a href="#l16.190"></a><span id="l16.190" class="difflineplus">+</span>
<a href="#l16.191"></a><span id="l16.191">     accountData = new Object;</span>
<a href="#l16.192"></a><span id="l16.192">     accountData.incomingServer = new Object;</span>
<a href="#l16.193"></a><span id="l16.193">     accountData.identity = new Object;</span>
<a href="#l16.194"></a><span id="l16.194">     accountData.smtp = new Object;</span>
<a href="#l16.195"></a><span id="l16.195">   }</span>
<a href="#l16.196"></a><span id="l16.196" class="difflineminus">-  </span>
<a href="#l16.197"></a><span id="l16.197" class="difflineplus">+</span>
<a href="#l16.198"></a><span id="l16.198">   var server = accountData.incomingServer;</span>
<a href="#l16.199"></a><span id="l16.199"> </span>
<a href="#l16.200"></a><span id="l16.200">   if (server.type == undefined) {</span>
<a href="#l16.201"></a><span id="l16.201">     // clear out the old server data</span>
<a href="#l16.202"></a><span id="l16.202">     //setPageData(pageData, &quot;accounttype&quot;, &quot;mailaccount&quot;, undefined);</span>
<a href="#l16.203"></a><span id="l16.203">     //        setPageData(pageData, &quot;accounttype&quot;, &quot;newsaccount&quot;, undefined);</span>
<a href="#l16.204"></a><span id="l16.204">     setPageData(pageData, &quot;server&quot;, &quot;servertype&quot;, undefined);</span>
<a href="#l16.205"></a><span id="l16.205">     setPageData(pageData, &quot;server&quot;, &quot;hostname&quot;, undefined);</span>
<a href="#l16.206"></a><span id="l16.206" class="difflineat">@@ -276,17 +276,17 @@ function AccountDataToPageData(accountDa</span>
<a href="#l16.207"></a><span id="l16.207">       identity = accountData.identities.queryElementAt(0, Components.interfaces.nsIMsgIdentity);</span>
<a href="#l16.208"></a><span id="l16.208">       dump(&quot;this is an account, id= &quot; + identity + &quot;\n&quot;);</span>
<a href="#l16.209"></a><span id="l16.209">   }</span>
<a href="#l16.210"></a><span id="l16.210"> </span>
<a href="#l16.211"></a><span id="l16.211">   setPageData(pageData, &quot;identity&quot;, &quot;email&quot;, identity.email || &quot;&quot;);</span>
<a href="#l16.212"></a><span id="l16.212">   setPageData(pageData, &quot;identity&quot;, &quot;fullName&quot;, identity.fullName || &quot;&quot;);</span>
<a href="#l16.213"></a><span id="l16.213"> </span>
<a href="#l16.214"></a><span id="l16.214">   var smtp;</span>
<a href="#l16.215"></a><span id="l16.215" class="difflineminus">-  </span>
<a href="#l16.216"></a><span id="l16.216" class="difflineplus">+</span>
<a href="#l16.217"></a><span id="l16.217">   if (accountData.smtp) {</span>
<a href="#l16.218"></a><span id="l16.218">       smtp = accountData.smtp;</span>
<a href="#l16.219"></a><span id="l16.219">       setPageData(pageData, &quot;server&quot;, &quot;smtphostname&quot;, smtp.hostname);</span>
<a href="#l16.220"></a><span id="l16.220">       setPageData(pageData, &quot;login&quot;, &quot;smtpusername&quot;, smtp.username);</span>
<a href="#l16.221"></a><span id="l16.221">   }</span>
<a href="#l16.222"></a><span id="l16.222"> }</span>
<a href="#l16.223"></a><span id="l16.223"> </span>
<a href="#l16.224"></a><span id="l16.224"> // take data from each page of pageData and dump it into accountData</span>
<a href="#l16.225"></a><span id="l16.225" class="difflineat">@@ -298,17 +298,17 @@ function PageDataToAccountData(pageData,</span>
<a href="#l16.226"></a><span id="l16.226">   if (!accountData.incomingServer)</span>
<a href="#l16.227"></a><span id="l16.227">     accountData.incomingServer = new Object;</span>
<a href="#l16.228"></a><span id="l16.228">   if (!accountData.smtp)</span>
<a href="#l16.229"></a><span id="l16.229">     accountData.smtp = new Object;</span>
<a href="#l16.230"></a><span id="l16.230">   if (!accountData.pop3)</span>
<a href="#l16.231"></a><span id="l16.231">     accountData.pop3 = new Object;</span>
<a href="#l16.232"></a><span id="l16.232">   if (!accountData.imap)</span>
<a href="#l16.233"></a><span id="l16.233">     accountData.imap = new Object;</span>
<a href="#l16.234"></a><span id="l16.234" class="difflineminus">-  </span>
<a href="#l16.235"></a><span id="l16.235" class="difflineplus">+</span>
<a href="#l16.236"></a><span id="l16.236">   var identity = accountData.identity;</span>
<a href="#l16.237"></a><span id="l16.237">   var server = accountData.incomingServer;</span>
<a href="#l16.238"></a><span id="l16.238">   var smtp = accountData.smtp;</span>
<a href="#l16.239"></a><span id="l16.239">   var pop3 = accountData.pop3;</span>
<a href="#l16.240"></a><span id="l16.240">   var imap = accountData.imap;</span>
<a href="#l16.241"></a><span id="l16.241"> </span>
<a href="#l16.242"></a><span id="l16.242">   if (pageData.identity.email)</span>
<a href="#l16.243"></a><span id="l16.243">     identity.email = pageData.identity.email.value;</span>
<a href="#l16.244"></a><span id="l16.244" class="difflineat">@@ -384,28 +384,28 @@ function PageDataToAccountData(pageData,</span>
<a href="#l16.245"></a><span id="l16.245"> }</span>
<a href="#l16.246"></a><span id="l16.246"> </span>
<a href="#l16.247"></a><span id="l16.247"> // given an accountData structure, create an account</span>
<a href="#l16.248"></a><span id="l16.248"> // (but don't fill in any fields, that's for finishAccount()</span>
<a href="#l16.249"></a><span id="l16.249"> function createAccount(accountData)</span>
<a href="#l16.250"></a><span id="l16.250"> {</span>
<a href="#l16.251"></a><span id="l16.251">   // Retrieve the server (data) from the account data.</span>
<a href="#l16.252"></a><span id="l16.252">   var server = accountData.incomingServer;</span>
<a href="#l16.253"></a><span id="l16.253" class="difflineminus">-  </span>
<a href="#l16.254"></a><span id="l16.254" class="difflineplus">+</span>
<a href="#l16.255"></a><span id="l16.255">   // for news, username is always null</span>
<a href="#l16.256"></a><span id="l16.256">   var username = (server.type == &quot;nntp&quot;) ? null : server.username;</span>
<a href="#l16.257"></a><span id="l16.257">   dump(&quot;MailServices.accounts.createIncomingServer(&quot; +</span>
<a href="#l16.258"></a><span id="l16.258">        username + &quot;, &quot; + server.hostName + &quot;, &quot; + server.type + &quot;)\n&quot;);</span>
<a href="#l16.259"></a><span id="l16.259">   // Create a (actual) server.</span>
<a href="#l16.260"></a><span id="l16.260">   server = MailServices.accounts.createIncomingServer(username, server.hostName, server.type);</span>
<a href="#l16.261"></a><span id="l16.261"> </span>
<a href="#l16.262"></a><span id="l16.262">   dump(&quot;MailServices.accounts.createAccount()\n&quot;);</span>
<a href="#l16.263"></a><span id="l16.263">   // Create an account.</span>
<a href="#l16.264"></a><span id="l16.264">   let account = MailServices.accounts.createAccount();</span>
<a href="#l16.265"></a><span id="l16.265" class="difflineminus">-  </span>
<a href="#l16.266"></a><span id="l16.266" class="difflineplus">+</span>
<a href="#l16.267"></a><span id="l16.267">   // only create an identity for this account if we really have one</span>
<a href="#l16.268"></a><span id="l16.268">   // (use the email address as a check)</span>
<a href="#l16.269"></a><span id="l16.269">   if (accountData.identity &amp;&amp; accountData.identity.email)</span>
<a href="#l16.270"></a><span id="l16.270">   {</span>
<a href="#l16.271"></a><span id="l16.271">     dump(&quot;MailServices.accounts.createIdentity()\n&quot;);</span>
<a href="#l16.272"></a><span id="l16.272">     // Create an identity.</span>
<a href="#l16.273"></a><span id="l16.273">     let identity = MailServices.accounts.createIdentity();</span>
<a href="#l16.274"></a><span id="l16.274"> </span>
<a href="#l16.275"></a><span id="l16.275" class="difflineat">@@ -424,17 +424,17 @@ function createAccount(accountData)</span>
<a href="#l16.276"></a><span id="l16.276">   // Set the new account to use the new server.</span>
<a href="#l16.277"></a><span id="l16.277">   account.incomingServer = server;</span>
<a href="#l16.278"></a><span id="l16.278">   server.valid = true;</span>
<a href="#l16.279"></a><span id="l16.279">   return account;</span>
<a href="#l16.280"></a><span id="l16.280"> }</span>
<a href="#l16.281"></a><span id="l16.281"> </span>
<a href="#l16.282"></a><span id="l16.282"> // given an accountData structure, copy the data into the</span>
<a href="#l16.283"></a><span id="l16.283"> // given account, incoming server, and so forth</span>
<a href="#l16.284"></a><span id="l16.284" class="difflineminus">-function finishAccount(account, accountData) </span>
<a href="#l16.285"></a><span id="l16.285" class="difflineplus">+function finishAccount(account, accountData)</span>
<a href="#l16.286"></a><span id="l16.286"> {</span>
<a href="#l16.287"></a><span id="l16.287">   if (accountData.incomingServer) {</span>
<a href="#l16.288"></a><span id="l16.288"> </span>
<a href="#l16.289"></a><span id="l16.289">     var destServer = account.incomingServer;</span>
<a href="#l16.290"></a><span id="l16.290">     var srcServer = accountData.incomingServer;</span>
<a href="#l16.291"></a><span id="l16.291">     copyObjectToInterface(destServer, srcServer, true);</span>
<a href="#l16.292"></a><span id="l16.292"> </span>
<a href="#l16.293"></a><span id="l16.293">     // see if there are any protocol-specific attributes</span>
<a href="#l16.294"></a><span id="l16.294" class="difflineat">@@ -454,44 +454,44 @@ function finishAccount(account, accountD</span>
<a href="#l16.295"></a><span id="l16.295">       if (IID) {</span>
<a href="#l16.296"></a><span id="l16.296">         destProtocolServer = destServer.QueryInterface(IID);</span>
<a href="#l16.297"></a><span id="l16.297">         srcProtocolServer = srcServer[&quot;ServerType-&quot; + srcServer.type];</span>
<a href="#l16.298"></a><span id="l16.298"> </span>
<a href="#l16.299"></a><span id="l16.299">         dump(&quot;Copying over &quot; + srcServer.type + &quot;-specific data\n&quot;);</span>
<a href="#l16.300"></a><span id="l16.300">         copyObjectToInterface(destProtocolServer, srcProtocolServer, false);</span>
<a href="#l16.301"></a><span id="l16.301">       }</span>
<a href="#l16.302"></a><span id="l16.302">     }</span>
<a href="#l16.303"></a><span id="l16.303" class="difflineminus">-      </span>
<a href="#l16.304"></a><span id="l16.304" class="difflineplus">+</span>
<a href="#l16.305"></a><span id="l16.305">     account.incomingServer.valid=true;</span>
<a href="#l16.306"></a><span id="l16.306">     // hack to cause an account loaded notification now the server is valid</span>
<a href="#l16.307"></a><span id="l16.307">     account.incomingServer = account.incomingServer;</span>
<a href="#l16.308"></a><span id="l16.308">   }</span>
<a href="#l16.309"></a><span id="l16.309"> </span>
<a href="#l16.310"></a><span id="l16.310">   // copy identity info</span>
<a href="#l16.311"></a><span id="l16.311">   var destIdentity = account.identities.length ?</span>
<a href="#l16.312"></a><span id="l16.312">                      account.identities.queryElementAt(0, nsIMsgIdentity) :</span>
<a href="#l16.313"></a><span id="l16.313">                      null;</span>
<a href="#l16.314"></a><span id="l16.314"> </span>
<a href="#l16.315"></a><span id="l16.315">   if (destIdentity) // does this account have an identity?</span>
<a href="#l16.316"></a><span id="l16.316" class="difflineminus">-  {   </span>
<a href="#l16.317"></a><span id="l16.317" class="difflineplus">+  {</span>
<a href="#l16.318"></a><span id="l16.318">       if (accountData.identity &amp;&amp; accountData.identity.email) {</span>
<a href="#l16.319"></a><span id="l16.319">           // fixup the email address if we have a default domain</span>
<a href="#l16.320"></a><span id="l16.320">           var emailArray = accountData.identity.email.split('@');</span>
<a href="#l16.321"></a><span id="l16.321">           if (emailArray.length &lt; 2 &amp;&amp; accountData.domain) {</span>
<a href="#l16.322"></a><span id="l16.322">               accountData.identity.email += '@' + accountData.domain;</span>
<a href="#l16.323"></a><span id="l16.323">           }</span>
<a href="#l16.324"></a><span id="l16.324"> </span>
<a href="#l16.325"></a><span id="l16.325">           copyObjectToInterface(destIdentity, accountData.identity, true);</span>
<a href="#l16.326"></a><span id="l16.326">           destIdentity.valid=true;</span>
<a href="#l16.327"></a><span id="l16.327">       }</span>
<a href="#l16.328"></a><span id="l16.328"> </span>
<a href="#l16.329"></a><span id="l16.329">       /**</span>
<a href="#l16.330"></a><span id="l16.330">        * If signature file need to be set, get the path to the signature file.</span>
<a href="#l16.331"></a><span id="l16.331">        * Signature files, if exist, are placed under default location. Get</span>
<a href="#l16.332"></a><span id="l16.332" class="difflineminus">-       * default files location for messenger using directory service. Signature </span>
<a href="#l16.333"></a><span id="l16.333" class="difflineplus">+       * default files location for messenger using directory service. Signature</span>
<a href="#l16.334"></a><span id="l16.334">        * file name should be extracted from the account data to build the complete</span>
<a href="#l16.335"></a><span id="l16.335">        * path for signature file. Once the path is built, set the identity's signature pref.</span>
<a href="#l16.336"></a><span id="l16.336">        */</span>
<a href="#l16.337"></a><span id="l16.337">       if (destIdentity.attachSignature)</span>
<a href="#l16.338"></a><span id="l16.338">       {</span>
<a href="#l16.339"></a><span id="l16.339">           var sigFileName = accountData.signatureFileName;</span>
<a href="#l16.340"></a><span id="l16.340">           let sigFile = MailServices.mailSession.getDataFilesDir(&quot;messenger&quot;);</span>
<a href="#l16.341"></a><span id="l16.341">           sigFile.append(sigFileName);</span>
<a href="#l16.342"></a><span id="l16.342" class="difflineat">@@ -520,17 +520,17 @@ function finishAccount(account, accountD</span>
<a href="#l16.343"></a><span id="l16.343"> </span>
<a href="#l16.344"></a><span id="l16.344">    if (this.FinishAccountHook != undefined) {</span>
<a href="#l16.345"></a><span id="l16.345">        FinishAccountHook(accountData.domain);</span>
<a href="#l16.346"></a><span id="l16.346">    }</span>
<a href="#l16.347"></a><span id="l16.347"> }</span>
<a href="#l16.348"></a><span id="l16.348"> </span>
<a href="#l16.349"></a><span id="l16.349"> // Helper method used by copyObjectToInterface which attempts to set dest[attribute] as a generic</span>
<a href="#l16.350"></a><span id="l16.350"> // attribute on the xpconnect object, src.</span>
<a href="#l16.351"></a><span id="l16.351" class="difflineminus">-// This routine skips any attribute that begins with ServerType- </span>
<a href="#l16.352"></a><span id="l16.352" class="difflineplus">+// This routine skips any attribute that begins with ServerType-</span>
<a href="#l16.353"></a><span id="l16.353"> function setGenericAttribute(dest, src, attribute)</span>
<a href="#l16.354"></a><span id="l16.354"> {</span>
<a href="#l16.355"></a><span id="l16.355">   if (!(attribute.toLowerCase().startsWith(&quot;servertype-&quot;)) &amp;&amp; src[attribute])</span>
<a href="#l16.356"></a><span id="l16.356">   {</span>
<a href="#l16.357"></a><span id="l16.357">     switch (typeof src[attribute])</span>
<a href="#l16.358"></a><span id="l16.358">     {</span>
<a href="#l16.359"></a><span id="l16.359">       case &quot;string&quot;:</span>
<a href="#l16.360"></a><span id="l16.360">         dest.setUnicharAttribute(attribute, src[attribute]);</span>
<a href="#l16.361"></a><span id="l16.361" class="difflineat">@@ -547,50 +547,50 @@ function setGenericAttribute(dest, src, </span>
<a href="#l16.362"></a><span id="l16.362">     }</span>
<a href="#l16.363"></a><span id="l16.363">   }</span>
<a href="#l16.364"></a><span id="l16.364"> }</span>
<a href="#l16.365"></a><span id="l16.365"> </span>
<a href="#l16.366"></a><span id="l16.366"> // copy over all attributes from dest into src that already exist in src</span>
<a href="#l16.367"></a><span id="l16.367"> // the assumption is that src is an XPConnect interface full of attributes</span>
<a href="#l16.368"></a><span id="l16.368"> // @param useGenericFallback if we can't set an attribute directly on src, then fall back</span>
<a href="#l16.369"></a><span id="l16.369"> //        and try setting it generically. This assumes that src supports setIntAttribute, setUnicharAttribute</span>
<a href="#l16.370"></a><span id="l16.370" class="difflineminus">-//        and setBoolAttribute. </span>
<a href="#l16.371"></a><span id="l16.371" class="difflineminus">-function copyObjectToInterface(dest, src, useGenericFallback) </span>
<a href="#l16.372"></a><span id="l16.372" class="difflineplus">+//        and setBoolAttribute.</span>
<a href="#l16.373"></a><span id="l16.373" class="difflineplus">+function copyObjectToInterface(dest, src, useGenericFallback)</span>
<a href="#l16.374"></a><span id="l16.374"> {</span>
<a href="#l16.375"></a><span id="l16.375">   if (!dest) return;</span>
<a href="#l16.376"></a><span id="l16.376">   if (!src) return;</span>
<a href="#l16.377"></a><span id="l16.377"> </span>
<a href="#l16.378"></a><span id="l16.378">   var attribute;</span>
<a href="#l16.379"></a><span id="l16.379" class="difflineminus">-  for (attribute in src) </span>
<a href="#l16.380"></a><span id="l16.380" class="difflineplus">+  for (attribute in src)</span>
<a href="#l16.381"></a><span id="l16.381">   {</span>
<a href="#l16.382"></a><span id="l16.382">     if (dest.__lookupSetter__(attribute))</span>
<a href="#l16.383"></a><span id="l16.383">     {</span>
<a href="#l16.384"></a><span id="l16.384">       if (dest[attribute] != src[attribute])</span>
<a href="#l16.385"></a><span id="l16.385">         dest[attribute] = src[attribute];</span>
<a href="#l16.386"></a><span id="l16.386" class="difflineminus">-    } </span>
<a href="#l16.387"></a><span id="l16.387" class="difflineplus">+    }</span>
<a href="#l16.388"></a><span id="l16.388">     else if (useGenericFallback) // fall back to setting the attribute generically</span>
<a href="#l16.389"></a><span id="l16.389">       setGenericAttribute(dest, src, attribute);</span>
<a href="#l16.390"></a><span id="l16.390">   } // for each attribute in src we want to copy</span>
<a href="#l16.391"></a><span id="l16.391"> }</span>
<a href="#l16.392"></a><span id="l16.392"> </span>
<a href="#l16.393"></a><span id="l16.393"> // check if there already is a &quot;Local Folders&quot;</span>
<a href="#l16.394"></a><span id="l16.394"> // if not, create it.</span>
<a href="#l16.395"></a><span id="l16.395" class="difflineminus">-function verifyLocalFoldersAccount() </span>
<a href="#l16.396"></a><span id="l16.396" class="difflineplus">+function verifyLocalFoldersAccount()</span>
<a href="#l16.397"></a><span id="l16.397"> {</span>
<a href="#l16.398"></a><span id="l16.398">   var localMailServer = null;</span>
<a href="#l16.399"></a><span id="l16.399">   try {</span>
<a href="#l16.400"></a><span id="l16.400">     localMailServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l16.401"></a><span id="l16.401">   }</span>
<a href="#l16.402"></a><span id="l16.402">   catch (ex) {</span>
<a href="#l16.403"></a><span id="l16.403">          // dump(&quot;exception in findserver: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l16.404"></a><span id="l16.404">     localMailServer = null;</span>
<a href="#l16.405"></a><span id="l16.405">   }</span>
<a href="#l16.406"></a><span id="l16.406"> </span>
<a href="#l16.407"></a><span id="l16.407">   try {</span>
<a href="#l16.408"></a><span id="l16.408" class="difflineminus">-    if (!localMailServer) </span>
<a href="#l16.409"></a><span id="l16.409" class="difflineplus">+    if (!localMailServer)</span>
<a href="#l16.410"></a><span id="l16.410">     {</span>
<a href="#l16.411"></a><span id="l16.411">       // dump(&quot;Creating local mail account\n&quot;);</span>
<a href="#l16.412"></a><span id="l16.412">       // creates a copy of the identity you pass in</span>
<a href="#l16.413"></a><span id="l16.413">       MailServices.accounts.createLocalMailAccount();</span>
<a href="#l16.414"></a><span id="l16.414">       try {</span>
<a href="#l16.415"></a><span id="l16.415">         localMailServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l16.416"></a><span id="l16.416">       }</span>
<a href="#l16.417"></a><span id="l16.417">       catch (ex) {</span>
<a href="#l16.418"></a><span id="l16.418" class="difflineat">@@ -613,21 +613,21 @@ function setupCopiesAndFoldersServer(acc</span>
<a href="#l16.419"></a><span id="l16.419">     if (server.type == &quot;rss&quot; || account.identities.length == 0)</span>
<a href="#l16.420"></a><span id="l16.420">       return false;</span>
<a href="#l16.421"></a><span id="l16.421">     let identity = account.identities.queryElementAt(0, Components.interfaces.nsIMsgIdentity);</span>
<a href="#l16.422"></a><span id="l16.422">     // For this server, do we default the folder prefs to this server, or to the &quot;Local Folders&quot; server</span>
<a href="#l16.423"></a><span id="l16.423">     // If it's deferred, we use the local folders account.</span>
<a href="#l16.424"></a><span id="l16.424">     var defaultCopiesAndFoldersPrefsToServer = !accountIsDeferred &amp;&amp; server.defaultCopiesAndFoldersPrefsToServer;</span>
<a href="#l16.425"></a><span id="l16.425"> </span>
<a href="#l16.426"></a><span id="l16.426">     var copiesAndFoldersServer = null;</span>
<a href="#l16.427"></a><span id="l16.427" class="difflineminus">-    if (defaultCopiesAndFoldersPrefsToServer) </span>
<a href="#l16.428"></a><span id="l16.428" class="difflineplus">+    if (defaultCopiesAndFoldersPrefsToServer)</span>
<a href="#l16.429"></a><span id="l16.429">     {</span>
<a href="#l16.430"></a><span id="l16.430">       copiesAndFoldersServer = server;</span>
<a href="#l16.431"></a><span id="l16.431">     }</span>
<a href="#l16.432"></a><span id="l16.432" class="difflineminus">-    else </span>
<a href="#l16.433"></a><span id="l16.433" class="difflineplus">+    else</span>
<a href="#l16.434"></a><span id="l16.434">     {</span>
<a href="#l16.435"></a><span id="l16.435">       if (!MailServices.accounts.localFoldersServer)</span>
<a href="#l16.436"></a><span id="l16.436">       {</span>
<a href="#l16.437"></a><span id="l16.437">         dump(&quot;error!  we should have a local mail server at this point\n&quot;);</span>
<a href="#l16.438"></a><span id="l16.438">         return false;</span>
<a href="#l16.439"></a><span id="l16.439">       }</span>
<a href="#l16.440"></a><span id="l16.440">       copiesAndFoldersServer = MailServices.accounts.localFoldersServer;</span>
<a href="#l16.441"></a><span id="l16.441">     }</span>
<a href="#l16.442"></a><span id="l16.442" class="difflineat">@@ -661,22 +661,22 @@ function setDefaultCopiesAndFoldersPrefs</span>
<a href="#l16.443"></a><span id="l16.443">   //</span>
<a href="#l16.444"></a><span id="l16.444">   // this makes the assumption that the server's draft, stationery fcc folder</span>
<a href="#l16.445"></a><span id="l16.445">   // are at the top level (ie subfolders of the root folder.)  this works</span>
<a href="#l16.446"></a><span id="l16.446">   // because we happen to be doing things that way, and if the user changes</span>
<a href="#l16.447"></a><span id="l16.447">   // that, it will work because to change the folder, it must be in rdf,</span>
<a href="#l16.448"></a><span id="l16.448">   // coming from the folder cache, in the worst case.</span>
<a href="#l16.449"></a><span id="l16.449">   var msgFolder = rootFolder.QueryInterface(Components.interfaces.nsIMsgFolder);</span>
<a href="#l16.450"></a><span id="l16.450"> </span>
<a href="#l16.451"></a><span id="l16.451" class="difflineminus">-  /** </span>
<a href="#l16.452"></a><span id="l16.452" class="difflineplus">+  /**</span>
<a href="#l16.453"></a><span id="l16.453">    * When a new account is created, folders 'Sent', 'Drafts'</span>
<a href="#l16.454"></a><span id="l16.454" class="difflineminus">-   * and 'Templates' are not created then, but created on demand at runtime. </span>
<a href="#l16.455"></a><span id="l16.455" class="difflineminus">-   * But we do need to present them as possible choices in the Copies and Folders </span>
<a href="#l16.456"></a><span id="l16.456" class="difflineminus">-   * UI. To do that, folder URIs have to be created and stored in the prefs file. </span>
<a href="#l16.457"></a><span id="l16.457" class="difflineminus">-   * So, if there is a need to build special folders, append the special folder </span>
<a href="#l16.458"></a><span id="l16.458" class="difflineplus">+   * and 'Templates' are not created then, but created on demand at runtime.</span>
<a href="#l16.459"></a><span id="l16.459" class="difflineplus">+   * But we do need to present them as possible choices in the Copies and Folders</span>
<a href="#l16.460"></a><span id="l16.460" class="difflineplus">+   * UI. To do that, folder URIs have to be created and stored in the prefs file.</span>
<a href="#l16.461"></a><span id="l16.461" class="difflineplus">+   * So, if there is a need to build special folders, append the special folder</span>
<a href="#l16.462"></a><span id="l16.462">    * names and create right URIs.</span>
<a href="#l16.463"></a><span id="l16.463">    */</span>
<a href="#l16.464"></a><span id="l16.464">   var folderDelim = &quot;/&quot;;</span>
<a href="#l16.465"></a><span id="l16.465"> </span>
<a href="#l16.466"></a><span id="l16.466">   /* we use internal names known to everyone like Sent, Templates and Drafts */</span>
<a href="#l16.467"></a><span id="l16.467">   /* if folder names were already given in isp rdf, we use them,</span>
<a href="#l16.468"></a><span id="l16.468">      otherwise we use internal names known to everyone like Sent, Templates and Drafts */</span>
<a href="#l16.469"></a><span id="l16.469"> </span>
<a href="#l16.470"></a><span id="l16.470" class="difflineat">@@ -742,31 +742,31 @@ function checkForInvalidAccounts()</span>
<a href="#l16.471"></a><span id="l16.471">       dump(&quot;Invalid account: Got &quot; + accountData + &quot;\n&quot;);</span>
<a href="#l16.472"></a><span id="l16.472"> </span>
<a href="#l16.473"></a><span id="l16.473">       // account -&gt; accountData -&gt; pageData</span>
<a href="#l16.474"></a><span id="l16.474">       accountData = AccountToAccountData(firstInvalidAccount, accountData);</span>
<a href="#l16.475"></a><span id="l16.475">     }</span>
<a href="#l16.476"></a><span id="l16.476">     else {</span>
<a href="#l16.477"></a><span id="l16.477">       accountData = getPreConfigDataForAccount(firstInvalidAccount);</span>
<a href="#l16.478"></a><span id="l16.478">     }</span>
<a href="#l16.479"></a><span id="l16.479" class="difflineminus">-    </span>
<a href="#l16.480"></a><span id="l16.480" class="difflineplus">+</span>
<a href="#l16.481"></a><span id="l16.481">     AccountDataToPageData(accountData, pageData);</span>
<a href="#l16.482"></a><span id="l16.482"> </span>
<a href="#l16.483"></a><span id="l16.483">     gCurrentAccountData = accountData;</span>
<a href="#l16.484"></a><span id="l16.484"> </span>
<a href="#l16.485"></a><span id="l16.485">     setupWizardPanels();</span>
<a href="#l16.486"></a><span id="l16.486">     // Set the page index to identity page.</span>
<a href="#l16.487"></a><span id="l16.487">     document.documentElement.pageIndex = 1;</span>
<a href="#l16.488"></a><span id="l16.488">   }</span>
<a href="#l16.489"></a><span id="l16.489"> }</span>
<a href="#l16.490"></a><span id="l16.490"> </span>
<a href="#l16.491"></a><span id="l16.491" class="difflineminus">-// Transfer all invalid account information to AccountData. Also, get those special </span>
<a href="#l16.492"></a><span id="l16.492" class="difflineminus">-// preferences (not associated with any interfaces but preconfigurable via prefs or rdf files) </span>
<a href="#l16.493"></a><span id="l16.493" class="difflineminus">-// like whether not the smtp server associated with this account requires </span>
<a href="#l16.494"></a><span id="l16.494" class="difflineminus">-// a user name (mail.identity.&lt;id_key&gt;.smtpRequiresUsername) and the choice of skipping </span>
<a href="#l16.495"></a><span id="l16.495" class="difflineplus">+// Transfer all invalid account information to AccountData. Also, get those special</span>
<a href="#l16.496"></a><span id="l16.496" class="difflineplus">+// preferences (not associated with any interfaces but preconfigurable via prefs or rdf files)</span>
<a href="#l16.497"></a><span id="l16.497" class="difflineplus">+// like whether not the smtp server associated with this account requires</span>
<a href="#l16.498"></a><span id="l16.498" class="difflineplus">+// a user name (mail.identity.&lt;id_key&gt;.smtpRequiresUsername) and the choice of skipping</span>
<a href="#l16.499"></a><span id="l16.499"> // panels (mail.identity.&lt;id_key&gt;.wizardSkipPanels).</span>
<a href="#l16.500"></a><span id="l16.500"> function getPreConfigDataForAccount(account)</span>
<a href="#l16.501"></a><span id="l16.501"> {</span>
<a href="#l16.502"></a><span id="l16.502">   var accountData = new Object;</span>
<a href="#l16.503"></a><span id="l16.503">   accountData = new Object;</span>
<a href="#l16.504"></a><span id="l16.504">   accountData.incomingServer = new Object;</span>
<a href="#l16.505"></a><span id="l16.505">   accountData.identity = new Object;</span>
<a href="#l16.506"></a><span id="l16.506">   accountData.smtp = new Object;</span>
<a href="#l16.507"></a><span id="l16.507" class="difflineat">@@ -785,17 +785,17 @@ function getPreConfigDataForAccount(acco</span>
<a href="#l16.508"></a><span id="l16.508"> </span>
<a href="#l16.509"></a><span id="l16.509">       var smtpRequiresUsername = false;</span>
<a href="#l16.510"></a><span id="l16.510">       var smtpRequiresPrefStr = &quot;mail.identity.&quot; + identity.key + &quot;.smtpRequiresUsername&quot;;</span>
<a href="#l16.511"></a><span id="l16.511">       smtpRequiresUsername = Services.prefs.getBoolPref(smtpRequiresPrefStr);</span>
<a href="#l16.512"></a><span id="l16.512">       accountData.smtpRequiresUsername = smtpRequiresUsername;</span>
<a href="#l16.513"></a><span id="l16.513">     }</span>
<a href="#l16.514"></a><span id="l16.514">   }</span>
<a href="#l16.515"></a><span id="l16.515">   catch(ex) {</span>
<a href="#l16.516"></a><span id="l16.516" class="difflineminus">-    // reached here as special identity pre-configuration prefs </span>
<a href="#l16.517"></a><span id="l16.517" class="difflineplus">+    // reached here as special identity pre-configuration prefs</span>
<a href="#l16.518"></a><span id="l16.518">     // (wizardSkipPanels, smtpRequiresUsername) are not defined.</span>
<a href="#l16.519"></a><span id="l16.519">   }</span>
<a href="#l16.520"></a><span id="l16.520"> </span>
<a href="#l16.521"></a><span id="l16.521">   return accountData;</span>
<a href="#l16.522"></a><span id="l16.522"> }</span>
<a href="#l16.523"></a><span id="l16.523"> </span>
<a href="#l16.524"></a><span id="l16.524"> function AccountToAccountData(account, defaultAccountData)</span>
<a href="#l16.525"></a><span id="l16.525"> {</span>
<a href="#l16.526"></a><span id="l16.526" class="difflineat">@@ -832,49 +832,49 @@ function setPageData(pageData, tag, slot</span>
<a href="#l16.527"></a><span id="l16.527"> function serverIsNntp(pageData) {</span>
<a href="#l16.528"></a><span id="l16.528">   if (pageData.accounttype.newsaccount)</span>
<a href="#l16.529"></a><span id="l16.529">     return pageData.accounttype.newsaccount.value;</span>
<a href="#l16.530"></a><span id="l16.530">   return false;</span>
<a href="#l16.531"></a><span id="l16.531"> }</span>
<a href="#l16.532"></a><span id="l16.532"> </span>
<a href="#l16.533"></a><span id="l16.533"> function getUsernameFromEmail(aEmail, aEnsureDomain)</span>
<a href="#l16.534"></a><span id="l16.534"> {</span>
<a href="#l16.535"></a><span id="l16.535" class="difflineminus">-  var username = aEmail.substr(0, aEmail.indexOf(&quot;@&quot;));  </span>
<a href="#l16.536"></a><span id="l16.536" class="difflineplus">+  var username = aEmail.substr(0, aEmail.indexOf(&quot;@&quot;));</span>
<a href="#l16.537"></a><span id="l16.537">   if (aEnsureDomain &amp;&amp; gCurrentAccountData &amp;&amp; gCurrentAccountData.domain)</span>
<a href="#l16.538"></a><span id="l16.538" class="difflineminus">-    username += '@' + gCurrentAccountData.domain;    </span>
<a href="#l16.539"></a><span id="l16.539" class="difflineplus">+    username += '@' + gCurrentAccountData.domain;</span>
<a href="#l16.540"></a><span id="l16.540">   return username;</span>
<a href="#l16.541"></a><span id="l16.541"> }</span>
<a href="#l16.542"></a><span id="l16.542"> </span>
<a href="#l16.543"></a><span id="l16.543"> function getCurrentUserName(pageData)</span>
<a href="#l16.544"></a><span id="l16.544"> {</span>
<a href="#l16.545"></a><span id="l16.545">   var userName = &quot;&quot;;</span>
<a href="#l16.546"></a><span id="l16.546"> </span>
<a href="#l16.547"></a><span id="l16.547">   if (pageData.login) {</span>
<a href="#l16.548"></a><span id="l16.548">     if (pageData.login.username) {</span>
<a href="#l16.549"></a><span id="l16.549">       userName = pageData.login.username.value;</span>
<a href="#l16.550"></a><span id="l16.550">     }</span>
<a href="#l16.551"></a><span id="l16.551">   }</span>
<a href="#l16.552"></a><span id="l16.552">   if (userName == &quot;&quot;) {</span>
<a href="#l16.553"></a><span id="l16.553">     var email = pageData.identity.email.value;</span>
<a href="#l16.554"></a><span id="l16.554" class="difflineminus">-    userName = getUsernameFromEmail(email, false); </span>
<a href="#l16.555"></a><span id="l16.555" class="difflineplus">+    userName = getUsernameFromEmail(email, false);</span>
<a href="#l16.556"></a><span id="l16.556">   }</span>
<a href="#l16.557"></a><span id="l16.557">   return userName;</span>
<a href="#l16.558"></a><span id="l16.558"> }</span>
<a href="#l16.559"></a><span id="l16.559"> </span>
<a href="#l16.560"></a><span id="l16.560"> function getCurrentServerType(pageData) {</span>
<a href="#l16.561"></a><span id="l16.561">   var servertype = &quot;pop3&quot;;    // hopefully don't resort to default!</span>
<a href="#l16.562"></a><span id="l16.562">   if (serverIsNntp(pageData))</span>
<a href="#l16.563"></a><span id="l16.563">     servertype = &quot;nntp&quot;;</span>
<a href="#l16.564"></a><span id="l16.564">   else if (pageData.server &amp;&amp; pageData.server.servertype)</span>
<a href="#l16.565"></a><span id="l16.565">     servertype = pageData.server.servertype.value;</span>
<a href="#l16.566"></a><span id="l16.566">   return servertype;</span>
<a href="#l16.567"></a><span id="l16.567"> }</span>
<a href="#l16.568"></a><span id="l16.568"> </span>
<a href="#l16.569"></a><span id="l16.569"> function getCurrentServerIsDeferred(pageData) {</span>
<a href="#l16.570"></a><span id="l16.570" class="difflineminus">-  var serverDeferred = false; </span>
<a href="#l16.571"></a><span id="l16.571" class="difflineplus">+  var serverDeferred = false;</span>
<a href="#l16.572"></a><span id="l16.572">   if (getCurrentServerType(pageData) == &quot;pop3&quot; &amp;&amp; pageData.server &amp;&amp; pageData.server.deferStorage)</span>
<a href="#l16.573"></a><span id="l16.573">     serverDeferred = pageData.server.deferStorage.value;</span>
<a href="#l16.574"></a><span id="l16.574"> </span>
<a href="#l16.575"></a><span id="l16.575">   return serverDeferred;</span>
<a href="#l16.576"></a><span id="l16.576"> }</span>
<a href="#l16.577"></a><span id="l16.577"> </span>
<a href="#l16.578"></a><span id="l16.578"> function getCurrentHostname(pageData) {</span>
<a href="#l16.579"></a><span id="l16.579">   if (serverIsNntp(pageData))</span>
<a href="#l16.580"></a><span id="l16.580" class="difflineat">@@ -891,17 +891,17 @@ function GetPageData()</span>
<a href="#l16.581"></a><span id="l16.581">   return gPageData;</span>
<a href="#l16.582"></a><span id="l16.582"> }</span>
<a href="#l16.583"></a><span id="l16.583"> </span>
<a href="#l16.584"></a><span id="l16.584"> function PrefillAccountForIsp(ispName)</span>
<a href="#l16.585"></a><span id="l16.585"> {</span>
<a href="#l16.586"></a><span id="l16.586">   dump(&quot;AccountWizard.prefillAccountForIsp(&quot; + ispName + &quot;)\n&quot;);</span>
<a href="#l16.587"></a><span id="l16.587"> </span>
<a href="#l16.588"></a><span id="l16.588">   var ispData = getIspDefaultsForUri(ispName);</span>
<a href="#l16.589"></a><span id="l16.589" class="difflineminus">-  </span>
<a href="#l16.590"></a><span id="l16.590" class="difflineplus">+</span>
<a href="#l16.591"></a><span id="l16.591">   var pageData = GetPageData();</span>
<a href="#l16.592"></a><span id="l16.592"> </span>
<a href="#l16.593"></a><span id="l16.593">   if (!ispData) {</span>
<a href="#l16.594"></a><span id="l16.594">     SetCurrentAccountData(null);</span>
<a href="#l16.595"></a><span id="l16.595">     return;</span>
<a href="#l16.596"></a><span id="l16.596">   }</span>
<a href="#l16.597"></a><span id="l16.597"> </span>
<a href="#l16.598"></a><span id="l16.598">   // prefill the rest of the wizard</span>
<a href="#l16.599"></a><span id="l16.599" class="difflineat">@@ -927,17 +927,17 @@ function FixupAccountDataForIsp(accountD</span>
<a href="#l16.600"></a><span id="l16.600"> </span>
<a href="#l16.601"></a><span id="l16.601">   // The identity might not have an email address, which is what the rest of</span>
<a href="#l16.602"></a><span id="l16.602">   // this function is looking for.</span>
<a href="#l16.603"></a><span id="l16.603">   if (!email)</span>
<a href="#l16.604"></a><span id="l16.604">     return;</span>
<a href="#l16.605"></a><span id="l16.605"> </span>
<a href="#l16.606"></a><span id="l16.606">   // fix up the username</span>
<a href="#l16.607"></a><span id="l16.607">   if (!accountData.incomingServer.username)</span>
<a href="#l16.608"></a><span id="l16.608" class="difflineminus">-    accountData.incomingServer.username = </span>
<a href="#l16.609"></a><span id="l16.609" class="difflineplus">+    accountData.incomingServer.username =</span>
<a href="#l16.610"></a><span id="l16.610">       getUsernameFromEmail(email, accountData.incomingServerUserNameRequiresDomain);</span>
<a href="#l16.611"></a><span id="l16.611"> </span>
<a href="#l16.612"></a><span id="l16.612">   if (!accountData.smtp.username &amp;&amp;</span>
<a href="#l16.613"></a><span id="l16.613">       accountData.smtpRequiresUsername) {</span>
<a href="#l16.614"></a><span id="l16.614">     // fix for bug #107953</span>
<a href="#l16.615"></a><span id="l16.615">     // if incoming hostname is same as smtp hostname</span>
<a href="#l16.616"></a><span id="l16.616">     // use the server username (instead of the email username)</span>
<a href="#l16.617"></a><span id="l16.617">     if (accountData.smtp.hostname == accountData.incomingServer.hostName &amp;&amp;</span>
<a href="#l16.618"></a><span id="l16.618" class="difflineat">@@ -962,31 +962,31 @@ function onFlush() {</span>
<a href="#l16.619"></a><span id="l16.619"> </span>
<a href="#l16.620"></a><span id="l16.620"> /** If there are no default accounts..</span>
<a href="#l16.621"></a><span id="l16.621">   * this is will be the new default, so enable</span>
<a href="#l16.622"></a><span id="l16.622">   * check for mail at startup</span>
<a href="#l16.623"></a><span id="l16.623">   */</span>
<a href="#l16.624"></a><span id="l16.624"> function EnableCheckMailAtStartUpIfNeeded(newAccount)</span>
<a href="#l16.625"></a><span id="l16.625"> {</span>
<a href="#l16.626"></a><span id="l16.626">   // Check if default account exists and if that account is alllowed to be</span>
<a href="#l16.627"></a><span id="l16.627" class="difflineminus">-  // a default account. If no such account, make this one as the default account </span>
<a href="#l16.628"></a><span id="l16.628" class="difflineminus">-  // and turn on the new mail check at startup for the current account   </span>
<a href="#l16.629"></a><span id="l16.629" class="difflineminus">-  if (!(gDefaultAccount &amp;&amp; gDefaultAccount.incomingServer.canBeDefaultServer)) { </span>
<a href="#l16.630"></a><span id="l16.630" class="difflineplus">+  // a default account. If no such account, make this one as the default account</span>
<a href="#l16.631"></a><span id="l16.631" class="difflineplus">+  // and turn on the new mail check at startup for the current account</span>
<a href="#l16.632"></a><span id="l16.632" class="difflineplus">+  if (!(gDefaultAccount &amp;&amp; gDefaultAccount.incomingServer.canBeDefaultServer)) {</span>
<a href="#l16.633"></a><span id="l16.633">     MailServices.accounts.defaultAccount = newAccount;</span>
<a href="#l16.634"></a><span id="l16.634">     newAccount.incomingServer.loginAtStartUp = true;</span>
<a href="#l16.635"></a><span id="l16.635">     newAccount.incomingServer.downloadOnBiff = true;</span>
<a href="#l16.636"></a><span id="l16.636">   }</span>
<a href="#l16.637"></a><span id="l16.637"> }</span>
<a href="#l16.638"></a><span id="l16.638"> </span>
<a href="#l16.639"></a><span id="l16.639" class="difflineminus">-function SetSmtpRequiresUsernameAttribute(accountData) </span>
<a href="#l16.640"></a><span id="l16.640" class="difflineplus">+function SetSmtpRequiresUsernameAttribute(accountData)</span>
<a href="#l16.641"></a><span id="l16.641"> {</span>
<a href="#l16.642"></a><span id="l16.642">   // If this is the default server, time to set the smtp user name</span>
<a href="#l16.643"></a><span id="l16.643">   // Set the generic attribute for requiring user name for smtp to true.</span>
<a href="#l16.644"></a><span id="l16.644">   // ISPs can override the pref via rdf files.</span>
<a href="#l16.645"></a><span id="l16.645" class="difflineminus">-  if (!(gDefaultAccount &amp;&amp; gDefaultAccount.incomingServer.canBeDefaultServer)) { </span>
<a href="#l16.646"></a><span id="l16.646" class="difflineplus">+  if (!(gDefaultAccount &amp;&amp; gDefaultAccount.incomingServer.canBeDefaultServer)) {</span>
<a href="#l16.647"></a><span id="l16.647">     accountData.smtpRequiresUsername = true;</span>
<a href="#l16.648"></a><span id="l16.648">   }</span>
<a href="#l16.649"></a><span id="l16.649"> }</span>
<a href="#l16.650"></a><span id="l16.650"> </span>
<a href="#l16.651"></a><span id="l16.651"> function setNextPage(currentPageId, nextPageId) {</span>
<a href="#l16.652"></a><span id="l16.652">   var currentPage = document.getElementById(currentPageId);</span>
<a href="#l16.653"></a><span id="l16.653">   currentPage.next = nextPageId;</span>
<a href="#l16.654"></a><span id="l16.654"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/base/prefs/content/accountUtils.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/base/prefs/content/accountUtils.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -51,17 +51,17 @@ function showMailIntegrationDialog() {</span>
<a href="#l17.4"></a><span id="l17.4"> </span>
<a href="#l17.5"></a><span id="l17.5">   try {</span>
<a href="#l17.6"></a><span id="l17.6">     var shellService = Components.classes[&quot;@mozilla.org/suite/shell-service;1&quot;]</span>
<a href="#l17.7"></a><span id="l17.7">                                  .getService(nsIShellService);</span>
<a href="#l17.8"></a><span id="l17.8">     var appTypesCheck = shellService.shouldBeDefaultClientFor &amp;</span>
<a href="#l17.9"></a><span id="l17.9">                         (nsIShellService.MAIL | nsIShellService.NEWS);</span>
<a href="#l17.10"></a><span id="l17.10"> </span>
<a href="#l17.11"></a><span id="l17.11">     // show the default client dialog only if we have at least one account,</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    // if we should check for the default client, and we want to check if we are </span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+    // if we should check for the default client, and we want to check if we are</span>
<a href="#l17.14"></a><span id="l17.14">     // the default for mail/news and are not the default client for mail/news</span>
<a href="#l17.15"></a><span id="l17.15">     if (appTypesCheck &amp;&amp; shellService.shouldCheckDefaultClient &amp;&amp;</span>
<a href="#l17.16"></a><span id="l17.16">         !shellService.isDefaultClient(true, appTypesCheck))</span>
<a href="#l17.17"></a><span id="l17.17">         window.openDialog(&quot;chrome://communicator/content/defaultClientDialog.xul&quot;,</span>
<a href="#l17.18"></a><span id="l17.18">                         &quot;DefaultClient&quot;, &quot;modal,centerscreen,chrome,resizable=no&quot;);</span>
<a href="#l17.19"></a><span id="l17.19">   } catch (ex) {}</span>
<a href="#l17.20"></a><span id="l17.20"> }</span>
<a href="#l17.21"></a><span id="l17.21"> </span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -255,38 +255,38 @@ function MsgAccountManager(selectPage, a</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24">         window.openDialog(&quot;chrome://messenger/content/AccountManager.xul&quot;,</span>
<a href="#l17.25"></a><span id="l17.25">                           &quot;AccountManager&quot;,</span>
<a href="#l17.26"></a><span id="l17.26">                           &quot;chrome,centerscreen,modal,titlebar,resizable&quot;,</span>
<a href="#l17.27"></a><span id="l17.27">                           { server: aServer, selectPage: selectPage });</span>
<a href="#l17.28"></a><span id="l17.28">     }</span>
<a href="#l17.29"></a><span id="l17.29"> }</span>
<a href="#l17.30"></a><span id="l17.30"> </span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-function loadInboxForNewAccount() </span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+function loadInboxForNewAccount()</span>
<a href="#l17.33"></a><span id="l17.33"> {</span>
<a href="#l17.34"></a><span id="l17.34">   // gNewAccountToLoad is set in the final screen of the Account Wizard if a POP account</span>
<a href="#l17.35"></a><span id="l17.35">   // was created, the download messages box is checked, and the wizard was opened from the 3pane</span>
<a href="#l17.36"></a><span id="l17.36">   if (gNewAccountToLoad) {</span>
<a href="#l17.37"></a><span id="l17.37">     var rootMsgFolder = gNewAccountToLoad.incomingServer.rootMsgFolder;</span>
<a href="#l17.38"></a><span id="l17.38">     const kInboxFlag = Components.interfaces.nsMsgFolderFlags.Inbox;</span>
<a href="#l17.39"></a><span id="l17.39">     var inboxFolder = rootMsgFolder.getFolderWithFlags(kInboxFlag);</span>
<a href="#l17.40"></a><span id="l17.40">     SelectFolder(inboxFolder.URI);</span>
<a href="#l17.41"></a><span id="l17.41">     window.focus();</span>
<a href="#l17.42"></a><span id="l17.42">     setTimeout(MsgGetMessage, 0);</span>
<a href="#l17.43"></a><span id="l17.43">     gNewAccountToLoad = null;</span>
<a href="#l17.44"></a><span id="l17.44">   }</span>
<a href="#l17.45"></a><span id="l17.45"> }</span>
<a href="#l17.46"></a><span id="l17.46"> </span>
<a href="#l17.47"></a><span id="l17.47"> // returns true if we migrated - it knows this because 4.x did not have the</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineminus">-// pref mailnews.quotingPrefs.version, so if it's not set, we're either </span>
<a href="#l17.49"></a><span id="l17.49" class="difflineplus">+// pref mailnews.quotingPrefs.version, so if it's not set, we're either</span>
<a href="#l17.50"></a><span id="l17.50"> // migrating from 4.x, or a much older version of Mozilla.</span>
<a href="#l17.51"></a><span id="l17.51"> function migrateGlobalQuotingPrefs(allIdentities)</span>
<a href="#l17.52"></a><span id="l17.52"> {</span>
<a href="#l17.53"></a><span id="l17.53">   // if reply_on_top and auto_quote exist then, if non-default</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineminus">-  // migrate and delete, if default just delete.  </span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+  // migrate and delete, if default just delete.</span>
<a href="#l17.56"></a><span id="l17.56">   var reply_on_top = 0;</span>
<a href="#l17.57"></a><span id="l17.57">   var auto_quote = true;</span>
<a href="#l17.58"></a><span id="l17.58">   var quotingPrefs = 0;</span>
<a href="#l17.59"></a><span id="l17.59">   var migrated = false;</span>
<a href="#l17.60"></a><span id="l17.60">   try {</span>
<a href="#l17.61"></a><span id="l17.61">     quotingPrefs = Services.prefs.getIntPref(&quot;mailnews.quotingPrefs.version&quot;);</span>
<a href="#l17.62"></a><span id="l17.62">   } catch (ex) {}</span>
<a href="#l17.63"></a><span id="l17.63"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-help.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-help.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -3,69 +3,69 @@</span>
<a href="#l18.4"></a><span id="l18.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.5"></a><span id="l18.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l18.6"></a><span id="l18.6"> </span>
<a href="#l18.7"></a><span id="l18.7"> /**</span>
<a href="#l18.8"></a><span id="l18.8">  * Key value pairs to derive the tag based on the page loaded.</span>
<a href="#l18.9"></a><span id="l18.9">  * Each key is the page loaded when user clicks on one of the items on</span>
<a href="#l18.10"></a><span id="l18.10">  * the accounttree of the AccountManager window.</span>
<a href="#l18.11"></a><span id="l18.11">  * Value is a tag that is preset which will be used to display</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">- * context sensitive help. </span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+ * context sensitive help.</span>
<a href="#l18.14"></a><span id="l18.14">  */</span>
<a href="#l18.15"></a><span id="l18.15"> var pageTagPairs = {</span>
<a href="#l18.16"></a><span id="l18.16">   &quot;chrome://messenger/content/am-main.xul&quot;: &quot;mail_account_identity&quot;,</span>
<a href="#l18.17"></a><span id="l18.17">   &quot;chrome://messenger/content/am-server.xul&quot;: &quot;mail&quot;,</span>
<a href="#l18.18"></a><span id="l18.18">   &quot;chrome://messenger/content/am-copies.xul&quot;: &quot;mail_copies&quot;,</span>
<a href="#l18.19"></a><span id="l18.19">   &quot;chrome://messenger/content/am-addressing.xul&quot;: &quot;mail_addressing_settings&quot;,</span>
<a href="#l18.20"></a><span id="l18.20">   &quot;chrome://messenger/content/am-junk.xul&quot;: &quot;mail-account-junk&quot;,</span>
<a href="#l18.21"></a><span id="l18.21">   &quot;chrome://messenger/content/am-offline.xul&quot;: &quot;mail-offline-accounts&quot;,</span>
<a href="#l18.22"></a><span id="l18.22">   &quot;chrome://messenger/content/am-smtp.xul&quot;: &quot;mail_smtp&quot;,</span>
<a href="#l18.23"></a><span id="l18.23">   &quot;chrome://messenger/content/am-smime.xul&quot;: &quot;mail_security_settings&quot;,</span>
<a href="#l18.24"></a><span id="l18.24">   &quot;chrome://messenger/content/am-serverwithnoidentities.xul&quot;: &quot;mail_local_folders_settings&quot;,</span>
<a href="#l18.25"></a><span id="l18.25">   &quot;chrome://messenger/content/am-mdn.xul&quot;: &quot;mail-account-receipts&quot;,</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">-} </span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+}</span>
<a href="#l18.28"></a><span id="l18.28"> </span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">-function doHelpButton() </span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+function doHelpButton()</span>
<a href="#l18.31"></a><span id="l18.31"> {</span>
<a href="#l18.32"></a><span id="l18.32">   // Get the URI of the page loaded in the AccountManager's content frame.</span>
<a href="#l18.33"></a><span id="l18.33">   var pageSourceURI = contentFrame.location.href;</span>
<a href="#l18.34"></a><span id="l18.34">   // Get the help tag corresponding to the page loaded.</span>
<a href="#l18.35"></a><span id="l18.35">   var helpTag = pageTagPairs[pageSourceURI];</span>
<a href="#l18.36"></a><span id="l18.36"> </span>
<a href="#l18.37"></a><span id="l18.37">   // If the help tag is generic or offline, check if there is a need to set tags per server type</span>
<a href="#l18.38"></a><span id="l18.38">   if ((helpTag == &quot;mail&quot;) || (helpTag == &quot;mail-offline-accounts&quot;)) {</span>
<a href="#l18.39"></a><span id="l18.39">     // Get server type, as we may need to set help tags per server type for some pages</span>
<a href="#l18.40"></a><span id="l18.40">     var serverType = GetServerType();</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineminus">-  </span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+</span>
<a href="#l18.43"></a><span id="l18.43">     /**</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineminus">-     * Check the page to be loaded. Following pages needed to be presented with the </span>
<a href="#l18.45"></a><span id="l18.45" class="difflineplus">+     * Check the page to be loaded. Following pages needed to be presented with the</span>
<a href="#l18.46"></a><span id="l18.46">      * help content that is based on server type. For any pages with such requirement</span>
<a href="#l18.47"></a><span id="l18.47">      * do add comments here about the page and a new case statement for pageSourceURI</span>
<a href="#l18.48"></a><span id="l18.48">      * switch.</span>
<a href="#l18.49"></a><span id="l18.49">      * - server settings (&quot;chrome://messenger/content/am-server.xul&quot;)</span>
<a href="#l18.50"></a><span id="l18.50">      * - offline/diskspace settings (&quot;chrome://messenger/content/am-offline.xul&quot;)</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineminus">-     */ </span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+     */</span>
<a href="#l18.53"></a><span id="l18.53">     switch (pageSourceURI) {</span>
<a href="#l18.54"></a><span id="l18.54">       case &quot;chrome://messenger/content/am-server.xul&quot;:</span>
<a href="#l18.55"></a><span id="l18.55">         helpTag = &quot;mail_server_&quot; + serverType;</span>
<a href="#l18.56"></a><span id="l18.56">         break;</span>
<a href="#l18.57"></a><span id="l18.57"> </span>
<a href="#l18.58"></a><span id="l18.58">       case &quot;chrome://messenger/content/am-offline.xul&quot;:</span>
<a href="#l18.59"></a><span id="l18.59">         helpTag = &quot;mail_offline_&quot; + serverType;</span>
<a href="#l18.60"></a><span id="l18.60">         break;</span>
<a href="#l18.61"></a><span id="l18.61"> </span>
<a href="#l18.62"></a><span id="l18.62">       default :</span>
<a href="#l18.63"></a><span id="l18.63">         break;</span>
<a href="#l18.64"></a><span id="l18.64">     }</span>
<a href="#l18.65"></a><span id="l18.65">   }</span>
<a href="#l18.66"></a><span id="l18.66"> </span>
<a href="#l18.67"></a><span id="l18.67" class="difflineminus">-  if ( helpTag ) </span>
<a href="#l18.68"></a><span id="l18.68" class="difflineminus">-  	openHelp(helpTag);  </span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+  if ( helpTag )</span>
<a href="#l18.70"></a><span id="l18.70" class="difflineplus">+  	openHelp(helpTag);</span>
<a href="#l18.71"></a><span id="l18.71">   else</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineminus">-	openHelp('mail'); </span>
<a href="#l18.73"></a><span id="l18.73" class="difflineplus">+	openHelp('mail');</span>
<a href="#l18.74"></a><span id="l18.74"> }</span>
<a href="#l18.75"></a><span id="l18.75"> </span>
<a href="#l18.76"></a><span id="l18.76"> /**</span>
<a href="#l18.77"></a><span id="l18.77">  * Get server type of the seleted item</span>
<a href="#l18.78"></a><span id="l18.78">  */</span>
<a href="#l18.79"></a><span id="l18.79"> function GetServerType()</span>
<a href="#l18.80"></a><span id="l18.80"> {</span>
<a href="#l18.81"></a><span id="l18.81">   var serverType = null;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-main.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-main.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -13,17 +13,17 @@ function onInit(aPageId, aServerId)</span>
<a href="#l19.4"></a><span id="l19.4">   if(accountName.value)</span>
<a href="#l19.5"></a><span id="l19.5">     titleValue = defaultTitle+&quot; - &lt;&quot;+accountName.value+&quot;&gt;&quot;;</span>
<a href="#l19.6"></a><span id="l19.6">   else</span>
<a href="#l19.7"></a><span id="l19.7">     titleValue = defaultTitle;</span>
<a href="#l19.8"></a><span id="l19.8"> </span>
<a href="#l19.9"></a><span id="l19.9">   title.setAttribute(&quot;title&quot;,titleValue);</span>
<a href="#l19.10"></a><span id="l19.10">   document.title = titleValue;</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  setupSignatureItems(); </span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  setupSignatureItems();</span>
<a href="#l19.14"></a><span id="l19.14"> }</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16"> function onPreInit(account, accountValues)</span>
<a href="#l19.17"></a><span id="l19.17"> {</span>
<a href="#l19.18"></a><span id="l19.18">   loadSMTPServerList();</span>
<a href="#l19.19"></a><span id="l19.19"> }</span>
<a href="#l19.20"></a><span id="l19.20"> </span>
<a href="#l19.21"></a><span id="l19.21"> function manageIdentities()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-offline.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-offline.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -9,17 +9,17 @@ var gIncomingServer;</span>
<a href="#l20.4"></a><span id="l20.4"> var gServerType;</span>
<a href="#l20.5"></a><span id="l20.5"> var gImapIncomingServer;</span>
<a href="#l20.6"></a><span id="l20.6"> var gPref = null;</span>
<a href="#l20.7"></a><span id="l20.7"> var gLockedPref = null;</span>
<a href="#l20.8"></a><span id="l20.8"> var gOfflineMap = null; // map of folder URLs to offline flags</span>
<a href="#l20.9"></a><span id="l20.9"> var gOfflineFolders;    // initial state of allFoldersOffline checkbox</span>
<a href="#l20.10"></a><span id="l20.10"> var gToggleOccurred = false;</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-function onInit(aPageId, aServerId) </span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+function onInit(aPageId, aServerId)</span>
<a href="#l20.14"></a><span id="l20.14"> {</span>
<a href="#l20.15"></a><span id="l20.15">     onLockPreference();	</span>
<a href="#l20.16"></a><span id="l20.16"> </span>
<a href="#l20.17"></a><span id="l20.17">     // init values here</span>
<a href="#l20.18"></a><span id="l20.18">     initServerSettings();</span>
<a href="#l20.19"></a><span id="l20.19">     initRetentionSettings();</span>
<a href="#l20.20"></a><span id="l20.20">     initDownloadSettings();</span>
<a href="#l20.21"></a><span id="l20.21">     initOfflineSettings();</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineat">@@ -301,18 +301,18 @@ function disableIfLocked( prefstrArray )</span>
<a href="#l20.23"></a><span id="l20.23">     }</span>
<a href="#l20.24"></a><span id="l20.24"> }</span>
<a href="#l20.25"></a><span id="l20.25"> </span>
<a href="#l20.26"></a><span id="l20.26"> // Disables xul elements that have associated preferences locked.</span>
<a href="#l20.27"></a><span id="l20.27"> function onLockPreference()</span>
<a href="#l20.28"></a><span id="l20.28"> {</span>
<a href="#l20.29"></a><span id="l20.29">     var isDownloadLocked = false;</span>
<a href="#l20.30"></a><span id="l20.30">     var isGetNewLocked = false;</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineminus">-    var initPrefString = &quot;mail.server&quot;; </span>
<a href="#l20.32"></a><span id="l20.32" class="difflineminus">-    var finalPrefString; </span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+    var initPrefString = &quot;mail.server&quot;;</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+    var finalPrefString;</span>
<a href="#l20.35"></a><span id="l20.35"> </span>
<a href="#l20.36"></a><span id="l20.36">     // This panel does not use the code in AccountManager.js to handle</span>
<a href="#l20.37"></a><span id="l20.37">     // the load/unload/disable.  keep in mind new prefstrings and changes</span>
<a href="#l20.38"></a><span id="l20.38">     // to code in AccountManager, and update these as well.</span>
<a href="#l20.39"></a><span id="l20.39">     var allPrefElements = [</span>
<a href="#l20.40"></a><span id="l20.40">       { prefstring:&quot;limit_offline_message_size&quot;, id:&quot;offline.notDownload&quot;},</span>
<a href="#l20.41"></a><span id="l20.41">       { prefstring:&quot;limit_offline_message_size&quot;, id:&quot;autosync.notDownload&quot;},</span>
<a href="#l20.42"></a><span id="l20.42">       { prefstring:&quot;max_size&quot;, id:&quot;offline.notDownloadMin&quot;},</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineat">@@ -328,17 +328,17 @@ function onLockPreference()</span>
<a href="#l20.44"></a><span id="l20.44">       { prefstring:&quot;disable_button.selectFolder&quot;, id:&quot;selectNewsgroupsButton&quot;},</span>
<a href="#l20.45"></a><span id="l20.45">       { prefstring:&quot;disable_button.selectFolder&quot;, id:&quot;selectImapFoldersButton&quot;}</span>
<a href="#l20.46"></a><span id="l20.46">     ];</span>
<a href="#l20.47"></a><span id="l20.47"> </span>
<a href="#l20.48"></a><span id="l20.48">     finalPrefString = initPrefString + &quot;.&quot; + gIncomingServer.key + &quot;.&quot;;</span>
<a href="#l20.49"></a><span id="l20.49">     gPref = Services.prefs.getBranch(finalPrefString);</span>
<a href="#l20.50"></a><span id="l20.50"> </span>
<a href="#l20.51"></a><span id="l20.51">     disableIfLocked( allPrefElements );</span>
<a href="#l20.52"></a><span id="l20.52" class="difflineminus">-} </span>
<a href="#l20.53"></a><span id="l20.53" class="difflineplus">+}</span>
<a href="#l20.54"></a><span id="l20.54"> </span>
<a href="#l20.55"></a><span id="l20.55"> function onCheckItem(changeElementId, checkElementId)</span>
<a href="#l20.56"></a><span id="l20.56"> {</span>
<a href="#l20.57"></a><span id="l20.57">     var element = document.getElementById(changeElementId);</span>
<a href="#l20.58"></a><span id="l20.58">     var checked = document.getElementById(checkElementId).checked;</span>
<a href="#l20.59"></a><span id="l20.59">     if(checked &amp;&amp; !gLockedPref[checkElementId] ) {</span>
<a href="#l20.60"></a><span id="l20.60">         element.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l20.61"></a><span id="l20.61">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-server-advanced.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-server-advanced.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -26,17 +26,17 @@ function getLocalFoldersAccount()</span>
<a href="#l21.4"></a><span id="l21.4">     .FindAccountForServer(MailServices.accounts.localFoldersServer);</span>
<a href="#l21.5"></a><span id="l21.5"> }</span>
<a href="#l21.6"></a><span id="l21.6"> </span>
<a href="#l21.7"></a><span id="l21.7"> function onLoad()</span>
<a href="#l21.8"></a><span id="l21.8"> {</span>
<a href="#l21.9"></a><span id="l21.9">   var prettyName = gServerSettings.serverPrettyName;</span>
<a href="#l21.10"></a><span id="l21.10"> </span>
<a href="#l21.11"></a><span id="l21.11">   if (prettyName)</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-    document.getElementById(&quot;serverPrettyName&quot;).value = </span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+    document.getElementById(&quot;serverPrettyName&quot;).value =</span>
<a href="#l21.14"></a><span id="l21.14">       document.getElementById(&quot;bundle_prefs&quot;)</span>
<a href="#l21.15"></a><span id="l21.15">               .getFormattedString(&quot;forAccount&quot;, [prettyName]);</span>
<a href="#l21.16"></a><span id="l21.16"> </span>
<a href="#l21.17"></a><span id="l21.17">   if (gServerSettings.serverType == &quot;imap&quot;)</span>
<a href="#l21.18"></a><span id="l21.18">   {</span>
<a href="#l21.19"></a><span id="l21.19">     document.getElementById(&quot;pop3Panel&quot;).hidden = true;</span>
<a href="#l21.20"></a><span id="l21.20">   }</span>
<a href="#l21.21"></a><span id="l21.21">   else if (gServerSettings.serverType == &quot;pop3&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-accname.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-accname.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l22.4"></a><span id="l22.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a href="#l22.5"></a><span id="l22.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.6"></a><span id="l22.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.7"></a><span id="l22.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9"> var gPrefsBundle;</span>
<a href="#l22.10"></a><span id="l22.10"> </span>
<a href="#l22.11"></a><span id="l22.11" class="difflineminus">-function acctNamePageValidate() </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineplus">+function acctNamePageValidate()</span>
<a href="#l22.13"></a><span id="l22.13"> {</span>
<a href="#l22.14"></a><span id="l22.14">   var accountname = document.getElementById(&quot;prettyName&quot;).value;</span>
<a href="#l22.15"></a><span id="l22.15">   var canAdvance = accountname ? true : false;</span>
<a href="#l22.16"></a><span id="l22.16"> </span>
<a href="#l22.17"></a><span id="l22.17">   // Check if this accountname already exists. If so, return false so that</span>
<a href="#l22.18"></a><span id="l22.18">   // user can enter a different unique account name.</span>
<a href="#l22.19"></a><span id="l22.19">   if (canAdvance &amp;&amp; accountNameExists(accountname))</span>
<a href="#l22.20"></a><span id="l22.20">     canAdvance = false;</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineat">@@ -23,25 +23,25 @@ function acctNamePageUnload() {</span>
<a href="#l22.22"></a><span id="l22.22"> </span>
<a href="#l22.23"></a><span id="l22.23">   // fix for bug #255473</span>
<a href="#l22.24"></a><span id="l22.24">   // allow for multiple RSS accounts.</span>
<a href="#l22.25"></a><span id="l22.25">   // if our isp.rdf file defines &quot;wizardAutoGenerateUniqueHostname&quot;</span>
<a href="#l22.26"></a><span id="l22.26">   // we generate a unique hostname until we have one that doesn't exist</span>
<a href="#l22.27"></a><span id="l22.27">   // for RSS accounts, in rss.rdf, userName, hostName and serverType</span>
<a href="#l22.28"></a><span id="l22.28">   // default to the same thing, so we need to do this to allow for</span>
<a href="#l22.29"></a><span id="l22.29">   // multiple RSS accounts.  Note, they can all have the same pretty name.</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-  if (gCurrentAccountData &amp;&amp; </span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-      gCurrentAccountData.wizardAutoGenerateUniqueHostname) </span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+  if (gCurrentAccountData &amp;&amp;</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineplus">+      gCurrentAccountData.wizardAutoGenerateUniqueHostname)</span>
<a href="#l22.34"></a><span id="l22.34">   {</span>
<a href="#l22.35"></a><span id="l22.35">     var serverType = parent.getCurrentServerType(pageData);</span>
<a href="#l22.36"></a><span id="l22.36">     var userName = parent.getCurrentUserName(pageData);</span>
<a href="#l22.37"></a><span id="l22.37">     var hostName = parent.getCurrentHostname(pageData);</span>
<a href="#l22.38"></a><span id="l22.38">     var hostNamePref = hostName;</span>
<a href="#l22.39"></a><span id="l22.39">     var i = 2;</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineminus">-    while (parent.AccountExists(userName, hostName, serverType)) </span>
<a href="#l22.41"></a><span id="l22.41" class="difflineplus">+    while (parent.AccountExists(userName, hostName, serverType))</span>
<a href="#l22.42"></a><span id="l22.42">     {</span>
<a href="#l22.43"></a><span id="l22.43">       // If &quot;Feeds&quot; exists, try &quot;Feeds-2&quot;, then &quot;Feeds-3&quot;, etc.</span>
<a href="#l22.44"></a><span id="l22.44">       hostName = hostNamePref + &quot;-&quot; + i;</span>
<a href="#l22.45"></a><span id="l22.45">       i++;</span>
<a href="#l22.46"></a><span id="l22.46">     }</span>
<a href="#l22.47"></a><span id="l22.47">     setPageData(pageData, &quot;server&quot;, &quot;hostname&quot;, hostName);</span>
<a href="#l22.48"></a><span id="l22.48">   }</span>
<a href="#l22.49"></a><span id="l22.49"> </span>
<a href="#l22.50"></a><span id="l22.50" class="difflineat">@@ -58,16 +58,16 @@ function acctNamePageInit()</span>
<a href="#l22.51"></a><span id="l22.51">     var accountNameInput = document.getElementById(&quot;prettyName&quot;);</span>
<a href="#l22.52"></a><span id="l22.52">     if (accountNameInput.value==&quot;&quot;) {</span>
<a href="#l22.53"></a><span id="l22.53">         var pageData = parent.GetPageData();</span>
<a href="#l22.54"></a><span id="l22.54">         var type = parent.getCurrentServerType(pageData);</span>
<a href="#l22.55"></a><span id="l22.55">         var accountName;</span>
<a href="#l22.56"></a><span id="l22.56"> </span>
<a href="#l22.57"></a><span id="l22.57">         if (gCurrentAccountData &amp;&amp; gCurrentAccountData.wizardAccountName)</span>
<a href="#l22.58"></a><span id="l22.58">             accountName = gCurrentAccountData.wizardAccountName;</span>
<a href="#l22.59"></a><span id="l22.59" class="difflineminus">-        else if (type == &quot;nntp&quot;) </span>
<a href="#l22.60"></a><span id="l22.60" class="difflineplus">+        else if (type == &quot;nntp&quot;)</span>
<a href="#l22.61"></a><span id="l22.61">             accountName = pageData.newsserver.hostname.value;</span>
<a href="#l22.62"></a><span id="l22.62">         else</span>
<a href="#l22.63"></a><span id="l22.63">             accountName = pageData.identity.email.value;</span>
<a href="#l22.64"></a><span id="l22.64">         accountNameInput.value = accountName;</span>
<a href="#l22.65"></a><span id="l22.65">     }</span>
<a href="#l22.66"></a><span id="l22.66">     acctNamePageValidate();</span>
<a href="#l22.67"></a><span id="l22.67"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-accounttype.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-accounttype.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l23.4"></a><span id="l23.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a href="#l23.5"></a><span id="l23.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.6"></a><span id="l23.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.7"></a><span id="l23.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9" class="difflineminus">-function setAccountTypeData() </span>
<a href="#l23.10"></a><span id="l23.10" class="difflineplus">+function setAccountTypeData()</span>
<a href="#l23.11"></a><span id="l23.11"> {</span>
<a href="#l23.12"></a><span id="l23.12">   var rg = document.getElementById(&quot;acctyperadio&quot;);</span>
<a href="#l23.13"></a><span id="l23.13">   var selectedItemId = rg.selectedItem.id;</span>
<a href="#l23.14"></a><span id="l23.14">   var mail = selectedItemId == &quot;mailaccount&quot;;</span>
<a href="#l23.15"></a><span id="l23.15">   var news = selectedItemId == &quot;newsaccount&quot;;</span>
<a href="#l23.16"></a><span id="l23.16"> </span>
<a href="#l23.17"></a><span id="l23.17">   var pageData = parent.GetPageData();</span>
<a href="#l23.18"></a><span id="l23.18">   setPageData(pageData, &quot;accounttype&quot;, &quot;mailaccount&quot;, mail);</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineat">@@ -31,17 +31,17 @@ function setupWizardPanels() {</span>
<a href="#l23.20"></a><span id="l23.20">       if (&quot;testingIspServices&quot; in this) {</span>
<a href="#l23.21"></a><span id="l23.21">         if (&quot;SetPageMappings&quot; in this &amp;&amp; testingIspServices()) {</span>
<a href="#l23.22"></a><span id="l23.22">           SetPageMappings(document.documentElement.currentPage.id, &quot;done&quot;);</span>
<a href="#l23.23"></a><span id="l23.23">         }</span>
<a href="#l23.24"></a><span id="l23.24">       }</span>
<a href="#l23.25"></a><span id="l23.25">     }</span>
<a href="#l23.26"></a><span id="l23.26"> </span>
<a href="#l23.27"></a><span id="l23.27">     var pageData = parent.GetPageData();</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-   </span>
<a href="#l23.29"></a><span id="l23.29" class="difflineplus">+</span>
<a href="#l23.30"></a><span id="l23.30">     // We default this to false, even though we could set it to true if we</span>
<a href="#l23.31"></a><span id="l23.31">     // are going to display the page. However as the accname page will set</span>
<a href="#l23.32"></a><span id="l23.32">     // it to true for us, we'll just default it to false and not work it out</span>
<a href="#l23.33"></a><span id="l23.33">     // twice.</span>
<a href="#l23.34"></a><span id="l23.34">     setPageData(pageData, &quot;accname&quot;, &quot;userset&quot;, false);</span>
<a href="#l23.35"></a><span id="l23.35"> </span>
<a href="#l23.36"></a><span id="l23.36">     // If we need to skip wizardpanels, set the wizard to jump to the</span>
<a href="#l23.37"></a><span id="l23.37">     // summary page i.e., last page. Otherwise, set the flow based</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineat">@@ -53,17 +53,17 @@ function setupWizardPanels() {</span>
<a href="#l23.39"></a><span id="l23.39">     } catch(ex) {}</span>
<a href="#l23.40"></a><span id="l23.40"> </span>
<a href="#l23.41"></a><span id="l23.41">       // &quot;done&quot; is the only required panel for all accounts. We used to require an identity panel but not anymore.</span>
<a href="#l23.42"></a><span id="l23.42">       // initialize wizardPanels with the optional mail/news panels</span>
<a href="#l23.43"></a><span id="l23.43">       var wizardPanels, i;</span>
<a href="#l23.44"></a><span id="l23.44">       var isMailAccount = pageData.accounttype.mailaccount;</span>
<a href="#l23.45"></a><span id="l23.45">       var isNewsAccount = pageData.accounttype.newsaccount;</span>
<a href="#l23.46"></a><span id="l23.46">       if (skipPanels == &quot;true&quot;) // Support old syntax of true/false for wizardSkipPanels</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineminus">-        wizardPanels = new Array(&quot;identitypage&quot;); </span>
<a href="#l23.48"></a><span id="l23.48" class="difflineplus">+        wizardPanels = new Array(&quot;identitypage&quot;);</span>
<a href="#l23.49"></a><span id="l23.49">       else if (isMailAccount &amp;&amp; isMailAccount.value)</span>
<a href="#l23.50"></a><span id="l23.50">         wizardPanels = new Array(&quot;identitypage&quot;, &quot;incomingpage&quot;, &quot;outgoingpage&quot;, &quot;accnamepage&quot;);</span>
<a href="#l23.51"></a><span id="l23.51">       else if (isNewsAccount &amp;&amp; isNewsAccount.value)</span>
<a href="#l23.52"></a><span id="l23.52">         wizardPanels = new Array(&quot;identitypage&quot;, &quot;newsserver&quot;, &quot;accnamepage&quot;);</span>
<a href="#l23.53"></a><span id="l23.53">       else { // An account created by an extension and XUL overlays</span>
<a href="#l23.54"></a><span id="l23.54">         var button = document.getElementById(&quot;acctyperadio&quot;).selectedItem;</span>
<a href="#l23.55"></a><span id="l23.55">         wizardPanels = button.value.split(/ *, */);</span>
<a href="#l23.56"></a><span id="l23.56">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-done.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-done.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -25,37 +25,37 @@ function donePageInit() {</span>
<a href="#l24.4"></a><span id="l24.4">           cancelButton.setAttribute(&quot;disabled&quot;, true);</span>
<a href="#l24.5"></a><span id="l24.5"> </span>
<a href="#l24.6"></a><span id="l24.6">           setPageData(pageData, &quot;identity&quot;, &quot;email&quot;, gEmailAddress);</span>
<a href="#l24.7"></a><span id="l24.7">           setPageData(pageData, &quot;identity&quot;, &quot;fullName&quot;, gUserFullName);</span>
<a href="#l24.8"></a><span id="l24.8">           setPageData(pageData, &quot;login&quot;, &quot;username&quot;, gScreenName);</span>
<a href="#l24.9"></a><span id="l24.9">         }</span>
<a href="#l24.10"></a><span id="l24.10">       }</span>
<a href="#l24.11"></a><span id="l24.11">     }</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-   </span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+</span>
<a href="#l24.14"></a><span id="l24.14">     gPrefsBundle = document.getElementById(&quot;bundle_prefs&quot;);</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-    var showMailServerDetails = true; </span>
<a href="#l24.16"></a><span id="l24.16" class="difflineplus">+    var showMailServerDetails = true;</span>
<a href="#l24.17"></a><span id="l24.17"> </span>
<a href="#l24.18"></a><span id="l24.18">     if (currentAccountData) {</span>
<a href="#l24.19"></a><span id="l24.19">         // find out if we need to hide server details</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineminus">-        showMailServerDetails = currentAccountData.showServerDetailsOnWizardSummary; </span>
<a href="#l24.21"></a><span id="l24.21" class="difflineplus">+        showMailServerDetails = currentAccountData.showServerDetailsOnWizardSummary;</span>
<a href="#l24.22"></a><span id="l24.22">         // Change the username field description to email field label in aw-identity</span>
<a href="#l24.23"></a><span id="l24.23">         if (currentAccountData.emailIDFieldTitle)</span>
<a href="#l24.24"></a><span id="l24.24">           setUserNameDescField(currentAccountData.emailIDFieldTitle);</span>
<a href="#l24.25"></a><span id="l24.25">     }</span>
<a href="#l24.26"></a><span id="l24.26"> </span>
<a href="#l24.27"></a><span id="l24.27">     // Find out if we need to hide details for incoming servers</span>
<a href="#l24.28"></a><span id="l24.28">     var hideIncoming = (gCurrentAccountData &amp;&amp; gCurrentAccountData.wizardHideIncoming);</span>
<a href="#l24.29"></a><span id="l24.29"> </span>
<a href="#l24.30"></a><span id="l24.30">     var email = &quot;&quot;;</span>
<a href="#l24.31"></a><span id="l24.31">     if (pageData.identity &amp;&amp; pageData.identity.email) {</span>
<a href="#l24.32"></a><span id="l24.32">         // fixup the email</span>
<a href="#l24.33"></a><span id="l24.33">         email = pageData.identity.email.value;</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineminus">-        if (email.split('@').length &lt; 2 &amp;&amp; </span>
<a href="#l24.35"></a><span id="l24.35" class="difflineminus">-                     currentAccountData &amp;&amp; </span>
<a href="#l24.36"></a><span id="l24.36" class="difflineplus">+        if (email.split('@').length &lt; 2 &amp;&amp;</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineplus">+                     currentAccountData &amp;&amp;</span>
<a href="#l24.38"></a><span id="l24.38">                      currentAccountData.domain)</span>
<a href="#l24.39"></a><span id="l24.39">             email += &quot;@&quot; + currentAccountData.domain;</span>
<a href="#l24.40"></a><span id="l24.40">     }</span>
<a href="#l24.41"></a><span id="l24.41">     setDivTextFromForm(&quot;identity.email&quot;, email);</span>
<a href="#l24.42"></a><span id="l24.42"> </span>
<a href="#l24.43"></a><span id="l24.43">     var userName=&quot;&quot;;</span>
<a href="#l24.44"></a><span id="l24.44">     if (pageData.login &amp;&amp; pageData.login.username)</span>
<a href="#l24.45"></a><span id="l24.45">         userName = pageData.login.username.value;</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineat">@@ -68,27 +68,27 @@ function donePageInit() {</span>
<a href="#l24.47"></a><span id="l24.47">     // Hide the &quot;username&quot; field if we don't want to show information</span>
<a href="#l24.48"></a><span id="l24.48">     // on the incoming server.</span>
<a href="#l24.49"></a><span id="l24.49">     setDivTextFromForm(&quot;server.username&quot;, hideIncoming ? null : userName);</span>
<a href="#l24.50"></a><span id="l24.50"> </span>
<a href="#l24.51"></a><span id="l24.51">     var smtpUserName=&quot;&quot;;</span>
<a href="#l24.52"></a><span id="l24.52">     if (pageData.login &amp;&amp; pageData.login.smtpusername)</span>
<a href="#l24.53"></a><span id="l24.53">         smtpUserName = pageData.login.smtpusername.value;</span>
<a href="#l24.54"></a><span id="l24.54">     if (!smtpUserName &amp;&amp; email)</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineminus">-        smtpUserName = getUsernameFromEmail(email, currentAccountData &amp;&amp; </span>
<a href="#l24.56"></a><span id="l24.56" class="difflineplus">+        smtpUserName = getUsernameFromEmail(email, currentAccountData &amp;&amp;</span>
<a href="#l24.57"></a><span id="l24.57">                                             currentAccountData.smtpUserNameRequiresDomain);</span>
<a href="#l24.58"></a><span id="l24.58">     setDivTextFromForm(&quot;smtpServer.username&quot;, smtpUserName);</span>
<a href="#l24.59"></a><span id="l24.59"> </span>
<a href="#l24.60"></a><span id="l24.60">     if (pageData.accname &amp;&amp; pageData.accname.prettyName) {</span>
<a href="#l24.61"></a><span id="l24.61">       // If currentAccountData has a pretty name (e.g. news link or from</span>
<a href="#l24.62"></a><span id="l24.62">       // isp data) only set the user name with the pretty name if the</span>
<a href="#l24.63"></a><span id="l24.63">       // pretty name originally came from ispdata</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineminus">-      if ((currentAccountData &amp;&amp; </span>
<a href="#l24.65"></a><span id="l24.65" class="difflineplus">+      if ((currentAccountData &amp;&amp;</span>
<a href="#l24.66"></a><span id="l24.66">            currentAccountData.incomingServer.prettyName) &amp;&amp;</span>
<a href="#l24.67"></a><span id="l24.67" class="difflineminus">-           (pageData.ispdata &amp;&amp; </span>
<a href="#l24.68"></a><span id="l24.68" class="difflineplus">+           (pageData.ispdata &amp;&amp;</span>
<a href="#l24.69"></a><span id="l24.69">             pageData.ispdata.supplied &amp;&amp;</span>
<a href="#l24.70"></a><span id="l24.70">             pageData.ispdata.supplied.value))</span>
<a href="#l24.71"></a><span id="l24.71">       {</span>
<a href="#l24.72"></a><span id="l24.72">         // Get the polished account name - if the user has modified the</span>
<a href="#l24.73"></a><span id="l24.73">         // account name then use that, otherwise use the userName.</span>
<a href="#l24.74"></a><span id="l24.74">         pageData.accname.prettyName.value =</span>
<a href="#l24.75"></a><span id="l24.75">           gPrefsBundle.getFormattedString(&quot;accountName&quot;,</span>
<a href="#l24.76"></a><span id="l24.76">                          [currentAccountData.incomingServer.prettyName,</span>
<a href="#l24.77"></a><span id="l24.77" class="difflineat">@@ -97,37 +97,37 @@ function donePageInit() {</span>
<a href="#l24.78"></a><span id="l24.78">       // else just use the default supplied name</span>
<a href="#l24.79"></a><span id="l24.79"> </span>
<a href="#l24.80"></a><span id="l24.80">       setDivTextFromForm(&quot;account.name&quot;, pageData.accname.prettyName.value);</span>
<a href="#l24.81"></a><span id="l24.81">     } else {</span>
<a href="#l24.82"></a><span id="l24.82">       setDivTextFromForm(&quot;account.name&quot;, &quot;&quot;);</span>
<a href="#l24.83"></a><span id="l24.83">     }</span>
<a href="#l24.84"></a><span id="l24.84"> </span>
<a href="#l24.85"></a><span id="l24.85">     // Show mail servers (incoming&amp;outgoing) details</span>
<a href="#l24.86"></a><span id="l24.86" class="difflineminus">-    // based on current account data. ISP can set </span>
<a href="#l24.87"></a><span id="l24.87" class="difflineplus">+    // based on current account data. ISP can set</span>
<a href="#l24.88"></a><span id="l24.88">     // rdf value of literal showServerDetailsOnWizardSummary</span>
<a href="#l24.89"></a><span id="l24.89">     // to false to hide server details</span>
<a href="#l24.90"></a><span id="l24.90">     if (showMailServerDetails &amp;&amp; !serverIsNntp(pageData)) {</span>
<a href="#l24.91"></a><span id="l24.91">         var incomingServerName=&quot;&quot;;</span>
<a href="#l24.92"></a><span id="l24.92">         if (pageData.server &amp;&amp; pageData.server.hostname) {</span>
<a href="#l24.93"></a><span id="l24.93">             incomingServerName = pageData.server.hostname.value;</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineminus">-            if (!incomingServerName &amp;&amp; </span>
<a href="#l24.95"></a><span id="l24.95" class="difflineminus">-                 currentAccountData &amp;&amp; </span>
<a href="#l24.96"></a><span id="l24.96" class="difflineplus">+            if (!incomingServerName &amp;&amp;</span>
<a href="#l24.97"></a><span id="l24.97" class="difflineplus">+                 currentAccountData &amp;&amp;</span>
<a href="#l24.98"></a><span id="l24.98">                  currentAccountData.incomingServer.hostname)</span>
<a href="#l24.99"></a><span id="l24.99">                 incomingServerName = currentAccountData.incomingServer.hostName;</span>
<a href="#l24.100"></a><span id="l24.100">         }</span>
<a href="#l24.101"></a><span id="l24.101">         // Hide the incoming server name field if the user specified</span>
<a href="#l24.102"></a><span id="l24.102">         // wizardHideIncoming in the ISP defaults file</span>
<a href="#l24.103"></a><span id="l24.103">         setDivTextFromForm(&quot;server.name&quot;, hideIncoming ? null : incomingServerName);</span>
<a href="#l24.104"></a><span id="l24.104">         setDivTextFromForm(&quot;server.port&quot;, pageData.server.port ? pageData.server.port.value : null);</span>
<a href="#l24.105"></a><span id="l24.105">         var incomingServerType=&quot;&quot;;</span>
<a href="#l24.106"></a><span id="l24.106">         if (pageData.server &amp;&amp; pageData.server.servertype) {</span>
<a href="#l24.107"></a><span id="l24.107">             incomingServerType = pageData.server.servertype.value;</span>
<a href="#l24.108"></a><span id="l24.108" class="difflineminus">-            if (!incomingServerType &amp;&amp; </span>
<a href="#l24.109"></a><span id="l24.109" class="difflineminus">-                 currentAccountData &amp;&amp; </span>
<a href="#l24.110"></a><span id="l24.110" class="difflineplus">+            if (!incomingServerType &amp;&amp;</span>
<a href="#l24.111"></a><span id="l24.111" class="difflineplus">+                 currentAccountData &amp;&amp;</span>
<a href="#l24.112"></a><span id="l24.112">                  currentAccountData.incomingServer.type)</span>
<a href="#l24.113"></a><span id="l24.113">                 incomingServerType = currentAccountData.incomingServer.type;</span>
<a href="#l24.114"></a><span id="l24.114">         }</span>
<a href="#l24.115"></a><span id="l24.115">         setDivTextFromForm(&quot;server.type&quot;, incomingServerType.toUpperCase());</span>
<a href="#l24.116"></a><span id="l24.116"> </span>
<a href="#l24.117"></a><span id="l24.117">         var smtpServerName=&quot;&quot;;</span>
<a href="#l24.118"></a><span id="l24.118">         if (pageData.server &amp;&amp; pageData.server.smtphostname) {</span>
<a href="#l24.119"></a><span id="l24.119">           let smtpServer = MailServices.smtp.defaultServer;</span>
<a href="#l24.120"></a><span id="l24.120" class="difflineat">@@ -176,17 +176,17 @@ function hideShowDownloadMsgsUI(isPop)</span>
<a href="#l24.121"></a><span id="l24.121">   if (isPop) {</span>
<a href="#l24.122"></a><span id="l24.122">     if (!Services.io.offline) {</span>
<a href="#l24.123"></a><span id="l24.123">       if (window.opener.location.href == &quot;chrome://messenger/content/messenger.xul&quot;) {</span>
<a href="#l24.124"></a><span id="l24.124">         downloadMsgs.hidden = false;</span>
<a href="#l24.125"></a><span id="l24.125">         return;</span>
<a href="#l24.126"></a><span id="l24.126">       }</span>
<a href="#l24.127"></a><span id="l24.127">     }</span>
<a href="#l24.128"></a><span id="l24.128">   }</span>
<a href="#l24.129"></a><span id="l24.129" class="difflineminus">- </span>
<a href="#l24.130"></a><span id="l24.130" class="difflineplus">+</span>
<a href="#l24.131"></a><span id="l24.131">   // else hide it</span>
<a href="#l24.132"></a><span id="l24.132">   downloadMsgs.hidden = true;</span>
<a href="#l24.133"></a><span id="l24.133"> }</span>
<a href="#l24.134"></a><span id="l24.134"> </span>
<a href="#l24.135"></a><span id="l24.135"> function setDivTextFromForm(divid, value) {</span>
<a href="#l24.136"></a><span id="l24.136"> </span>
<a href="#l24.137"></a><span id="l24.137">     // collapse the row if the div has no value</span>
<a href="#l24.138"></a><span id="l24.138">     var div = document.getElementById(divid);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-identity.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-identity.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -38,17 +38,17 @@ function identityPageUnload()</span>
<a href="#l25.4"></a><span id="l25.4">   var name = document.getElementById(&quot;fullName&quot;).value;</span>
<a href="#l25.5"></a><span id="l25.5">   let email = document.getElementById(&quot;email&quot;).value.trim();</span>
<a href="#l25.6"></a><span id="l25.6">   setPageData(pageData, &quot;identity&quot;, &quot;fullName&quot;, name);</span>
<a href="#l25.7"></a><span id="l25.7">   setPageData(pageData, &quot;identity&quot;, &quot;email&quot;, email);</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9">   return true;</span>
<a href="#l25.10"></a><span id="l25.10"> }</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-// This is for the case when the code appends the domain  </span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+// This is for the case when the code appends the domain</span>
<a href="#l25.14"></a><span id="l25.14"> // unnecessarily.</span>
<a href="#l25.15"></a><span id="l25.15"> // This simply gets rid  of &quot;@domain&quot; from &quot;foo@domain&quot;</span>
<a href="#l25.16"></a><span id="l25.16"> </span>
<a href="#l25.17"></a><span id="l25.17"> function fixPreFilledEmail()</span>
<a href="#l25.18"></a><span id="l25.18"> {</span>
<a href="#l25.19"></a><span id="l25.19">   var emailElement = document.getElementById(&quot;email&quot;);</span>
<a href="#l25.20"></a><span id="l25.20">   var email = emailElement.value;</span>
<a href="#l25.21"></a><span id="l25.21">   var emailArray = email.split('@');</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineat">@@ -64,32 +64,32 @@ function fixPreFilledEmail()</span>
<a href="#l25.23"></a><span id="l25.23"> </span>
<a href="#l25.24"></a><span id="l25.24"> /**</span>
<a href="#l25.25"></a><span id="l25.25">  * This function checks for common illegal characters.</span>
<a href="#l25.26"></a><span id="l25.26">  * It shouldn't be too strict, since we do more extensive tests later.</span>
<a href="#l25.27"></a><span id="l25.27">  */</span>
<a href="#l25.28"></a><span id="l25.28"> function emailNameIsLegal(aString)</span>
<a href="#l25.29"></a><span id="l25.29"> {</span>
<a href="#l25.30"></a><span id="l25.30">   return aString &amp;&amp; !/[^!-?A-~]/.test(aString);</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-} </span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+}</span>
<a href="#l25.33"></a><span id="l25.33"> </span>
<a href="#l25.34"></a><span id="l25.34"> function emailNameAndDomainAreLegal(aString)</span>
<a href="#l25.35"></a><span id="l25.35"> {</span>
<a href="#l25.36"></a><span id="l25.36">   return /^[!-?A-~]+\@[A-Za-z0-9.-]+$/.test(aString);</span>
<a href="#l25.37"></a><span id="l25.37"> }</span>
<a href="#l25.38"></a><span id="l25.38"> </span>
<a href="#l25.39"></a><span id="l25.39"> function identityPageInit()</span>
<a href="#l25.40"></a><span id="l25.40"> {</span>
<a href="#l25.41"></a><span id="l25.41">   gCurrentDomain = null;</span>
<a href="#l25.42"></a><span id="l25.42">   gPrefsBundle = document.getElementById(&quot;bundle_prefs&quot;);</span>
<a href="#l25.43"></a><span id="l25.43">   clearEmailTextItems();</span>
<a href="#l25.44"></a><span id="l25.44">   setEmailDescriptionText();</span>
<a href="#l25.45"></a><span id="l25.45">   checkForDomain();</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineminus">-  checkForFullName(); </span>
<a href="#l25.47"></a><span id="l25.47" class="difflineminus">-  checkForEmail(); </span>
<a href="#l25.48"></a><span id="l25.48" class="difflineplus">+  checkForFullName();</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineplus">+  checkForEmail();</span>
<a href="#l25.50"></a><span id="l25.50">   fixPreFilledEmail();</span>
<a href="#l25.51"></a><span id="l25.51">   identityPageValidate();</span>
<a href="#l25.52"></a><span id="l25.52"> }</span>
<a href="#l25.53"></a><span id="l25.53"> </span>
<a href="#l25.54"></a><span id="l25.54"> function clearEmailTextItems()</span>
<a href="#l25.55"></a><span id="l25.55"> {</span>
<a href="#l25.56"></a><span id="l25.56">   var emailDescText = document.getElementById(&quot;emailDescText&quot;);</span>
<a href="#l25.57"></a><span id="l25.57"> </span>
<a href="#l25.58"></a><span id="l25.58" class="difflineat">@@ -97,32 +97,32 @@ function clearEmailTextItems()</span>
<a href="#l25.59"></a><span id="l25.59">     emailDescText.firstChild.remove();</span>
<a href="#l25.60"></a><span id="l25.60"> </span>
<a href="#l25.61"></a><span id="l25.61">   var postEmailText = document.getElementById(&quot;postEmailText&quot;);</span>
<a href="#l25.62"></a><span id="l25.62">   postEmailText.setAttribute(&quot;value&quot;, &quot;&quot;);</span>
<a href="#l25.63"></a><span id="l25.63">   postEmailText.hidden = true;</span>
<a href="#l25.64"></a><span id="l25.64"> }</span>
<a href="#l25.65"></a><span id="l25.65"> </span>
<a href="#l25.66"></a><span id="l25.66"> // Use email example data that ISP has provided. ISP data, if avaialble</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineminus">-// for the choice user has made, will be read into CurrentAccountData. </span>
<a href="#l25.68"></a><span id="l25.68" class="difflineminus">-// Default example data from properties will be used when the info is missing. </span>
<a href="#l25.69"></a><span id="l25.69" class="difflineplus">+// for the choice user has made, will be read into CurrentAccountData.</span>
<a href="#l25.70"></a><span id="l25.70" class="difflineplus">+// Default example data from properties will be used when the info is missing.</span>
<a href="#l25.71"></a><span id="l25.71"> function setEmailDescriptionText()</span>
<a href="#l25.72"></a><span id="l25.72"> {</span>
<a href="#l25.73"></a><span id="l25.73">     var emailDescText = document.getElementById(&quot;emailDescText&quot;);</span>
<a href="#l25.74"></a><span id="l25.74">     var emailFieldLabel = document.getElementById(&quot;emailFieldLabel&quot;);</span>
<a href="#l25.75"></a><span id="l25.75">     var currentAccountData = parent.gCurrentAccountData;</span>
<a href="#l25.76"></a><span id="l25.76" class="difflineminus">-   </span>
<a href="#l25.77"></a><span id="l25.77" class="difflineplus">+</span>
<a href="#l25.78"></a><span id="l25.78">     var displayText =  null;</span>
<a href="#l25.79"></a><span id="l25.79">     var emailFieldLabelData =  null;</span>
<a href="#l25.80"></a><span id="l25.80" class="difflineminus">-    var setDefaultEmailDescStrings = true; </span>
<a href="#l25.81"></a><span id="l25.81" class="difflineplus">+    var setDefaultEmailDescStrings = true;</span>
<a href="#l25.82"></a><span id="l25.82"> </span>
<a href="#l25.83"></a><span id="l25.83">     // Set the default field label</span>
<a href="#l25.84"></a><span id="l25.84">     emailFieldLabel.setAttribute(&quot;value&quot;, gPrefsBundle.getString(&quot;emailFieldText&quot;));</span>
<a href="#l25.85"></a><span id="l25.85"> </span>
<a href="#l25.86"></a><span id="l25.86" class="difflineminus">-    // Get values for customized data from current account </span>
<a href="#l25.87"></a><span id="l25.87" class="difflineplus">+    // Get values for customized data from current account</span>
<a href="#l25.88"></a><span id="l25.88">     if (currentAccountData)</span>
<a href="#l25.89"></a><span id="l25.89">     {</span>
<a href="#l25.90"></a><span id="l25.90">         var emailProvider  = currentAccountData.emailProviderName;</span>
<a href="#l25.91"></a><span id="l25.91">         var sampleEmail    = currentAccountData.sampleEmail;</span>
<a href="#l25.92"></a><span id="l25.92">         var sampleUserName = currentAccountData.sampleUserName;</span>
<a href="#l25.93"></a><span id="l25.93">         var emailIDDesc    = currentAccountData.emailIDDescription;</span>
<a href="#l25.94"></a><span id="l25.94">         var emailIDTitle   = currentAccountData.emailIDFieldTitle;</span>
<a href="#l25.95"></a><span id="l25.95"> </span>
<a href="#l25.96"></a><span id="l25.96" class="difflineat">@@ -139,34 +139,34 @@ function setEmailDescriptionText()</span>
<a href="#l25.97"></a><span id="l25.97">                                                            sampleEmail,</span>
<a href="#l25.98"></a><span id="l25.98">                                                            sampleUserName]);</span>
<a href="#l25.99"></a><span id="l25.99"> </span>
<a href="#l25.100"></a><span id="l25.100">             // Set emailfield label</span>
<a href="#l25.101"></a><span id="l25.101">             emailFieldLabelData =  emailIDTitle;</span>
<a href="#l25.102"></a><span id="l25.102">             emailFieldLabel.setAttribute(&quot;value&quot;, emailFieldLabelData);</span>
<a href="#l25.103"></a><span id="l25.103"> </span>
<a href="#l25.104"></a><span id="l25.104">             // Need to display customized data. Turn off default settings.</span>
<a href="#l25.105"></a><span id="l25.105" class="difflineminus">-            setDefaultEmailDescStrings = false; </span>
<a href="#l25.106"></a><span id="l25.106" class="difflineplus">+            setDefaultEmailDescStrings = false;</span>
<a href="#l25.107"></a><span id="l25.107">         }</span>
<a href="#l25.108"></a><span id="l25.108">     }</span>
<a href="#l25.109"></a><span id="l25.109"> </span>
<a href="#l25.110"></a><span id="l25.110">     if (setDefaultEmailDescStrings)</span>
<a href="#l25.111"></a><span id="l25.111">     {</span>
<a href="#l25.112"></a><span id="l25.112">         // Check for obtained values and set with default values if needed</span>
<a href="#l25.113"></a><span id="l25.113" class="difflineminus">-        var username = gPrefsBundle.getString(&quot;exampleEmailUserName&quot;); </span>
<a href="#l25.114"></a><span id="l25.114" class="difflineminus">-        var domain = gPrefsBundle.getString(&quot;exampleEmailDomain&quot;); </span>
<a href="#l25.115"></a><span id="l25.115" class="difflineplus">+        var username = gPrefsBundle.getString(&quot;exampleEmailUserName&quot;);</span>
<a href="#l25.116"></a><span id="l25.116" class="difflineplus">+        var domain = gPrefsBundle.getString(&quot;exampleEmailDomain&quot;);</span>
<a href="#l25.117"></a><span id="l25.117"> </span>
<a href="#l25.118"></a><span id="l25.118">         displayText = gPrefsBundle.getFormattedString(&quot;defaultEmailText&quot;,</span>
<a href="#l25.119"></a><span id="l25.119">                                                       [username, domain]);</span>
<a href="#l25.120"></a><span id="l25.120">     }</span>
<a href="#l25.121"></a><span id="l25.121"> </span>
<a href="#l25.122"></a><span id="l25.122">     // Create a text nodes with text to be displayed</span>
<a href="#l25.123"></a><span id="l25.123">     var emailDescTextNode       =  document.createTextNode(displayText);</span>
<a href="#l25.124"></a><span id="l25.124"> </span>
<a href="#l25.125"></a><span id="l25.125" class="difflineminus">-    // Display the dynamically generated text for email description </span>
<a href="#l25.126"></a><span id="l25.126" class="difflineplus">+    // Display the dynamically generated text for email description</span>
<a href="#l25.127"></a><span id="l25.127">     emailDescText.appendChild(emailDescTextNode);</span>
<a href="#l25.128"></a><span id="l25.128"> }</span>
<a href="#l25.129"></a><span id="l25.129"> </span>
<a href="#l25.130"></a><span id="l25.130"> // retrieve the current domain from the parent wizard window,</span>
<a href="#l25.131"></a><span id="l25.131"> // and update the UI to add the @domain static text</span>
<a href="#l25.132"></a><span id="l25.132"> function checkForDomain()</span>
<a href="#l25.133"></a><span id="l25.133"> {</span>
<a href="#l25.134"></a><span id="l25.134">   var accountData = parent.gCurrentAccountData;</span>
<a href="#l25.135"></a><span id="l25.135" class="difflineat">@@ -188,25 +188,25 @@ function checkForFullName() {</span>
<a href="#l25.136"></a><span id="l25.136">             name.value = userInfo.fullname;</span>
<a href="#l25.137"></a><span id="l25.137">         }</span>
<a href="#l25.138"></a><span id="l25.138">         catch (ex) {</span>
<a href="#l25.139"></a><span id="l25.139">             // dump (&quot;checkForFullName failed: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l25.140"></a><span id="l25.140">         }</span>
<a href="#l25.141"></a><span id="l25.141">     }</span>
<a href="#l25.142"></a><span id="l25.142"> }</span>
<a href="#l25.143"></a><span id="l25.143"> </span>
<a href="#l25.144"></a><span id="l25.144" class="difflineminus">-function checkForEmail() </span>
<a href="#l25.145"></a><span id="l25.145" class="difflineplus">+function checkForEmail()</span>
<a href="#l25.146"></a><span id="l25.146"> {</span>
<a href="#l25.147"></a><span id="l25.147">     var email = document.getElementById(&quot;email&quot;);</span>
<a href="#l25.148"></a><span id="l25.148">     var pageData = parent.GetPageData();</span>
<a href="#l25.149"></a><span id="l25.149">     if (pageData &amp;&amp; pageData.identity &amp;&amp; pageData.identity.email) {</span>
<a href="#l25.150"></a><span id="l25.150">         email.value = pageData.identity.email.value;</span>
<a href="#l25.151"></a><span id="l25.151">     }</span>
<a href="#l25.152"></a><span id="l25.152">     if (email.value==&quot;&quot;) {</span>
<a href="#l25.153"></a><span id="l25.153">         try {</span>
<a href="#l25.154"></a><span id="l25.154">             var userInfo = Components.classes[&quot;@mozilla.org/userinfo;1&quot;].getService(Components.interfaces.nsIUserInfo);</span>
<a href="#l25.155"></a><span id="l25.155">             email.value = userInfo.emailAddress;</span>
<a href="#l25.156"></a><span id="l25.156">         }</span>
<a href="#l25.157"></a><span id="l25.157">         catch (ex) {</span>
<a href="#l25.158"></a><span id="l25.158" class="difflineminus">-            // dump (&quot;checkForEmail failed: &quot; + ex + &quot;\n&quot;); </span>
<a href="#l25.159"></a><span id="l25.159" class="difflineplus">+            // dump (&quot;checkForEmail failed: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l25.160"></a><span id="l25.160">         }</span>
<a href="#l25.161"></a><span id="l25.161">     }</span>
<a href="#l25.162"></a><span id="l25.162"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-incoming.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-incoming.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -70,47 +70,47 @@ function incomingPageInit() {</span>
<a href="#l26.4"></a><span id="l26.4">     var newsServer = document.getElementById(&quot;newsServer&quot;);</span>
<a href="#l26.5"></a><span id="l26.5">     var pageData = parent.GetPageData();</span>
<a href="#l26.6"></a><span id="l26.6">     try</span>
<a href="#l26.7"></a><span id="l26.7">     {</span>
<a href="#l26.8"></a><span id="l26.8">       newsServer.value = pageData.newsserver.hostname.value;</span>
<a href="#l26.9"></a><span id="l26.9">     }</span>
<a href="#l26.10"></a><span id="l26.10">     catch (ex){}</span>
<a href="#l26.11"></a><span id="l26.11">   }</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-    </span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+</span>
<a href="#l26.14"></a><span id="l26.14">   gHideIncoming = false;</span>
<a href="#l26.15"></a><span id="l26.15">   if (gCurrentAccountData &amp;&amp; gCurrentAccountData.wizardHideIncoming)</span>
<a href="#l26.16"></a><span id="l26.16">     gHideIncoming = true;</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineminus">-  </span>
<a href="#l26.18"></a><span id="l26.18" class="difflineplus">+</span>
<a href="#l26.19"></a><span id="l26.19">   var incomingServerbox = document.getElementById(&quot;incomingServerbox&quot;);</span>
<a href="#l26.20"></a><span id="l26.20">   var serverTypeBox = document.getElementById(&quot;serverTypeBox&quot;);</span>
<a href="#l26.21"></a><span id="l26.21">   if (incomingServerbox &amp;&amp; serverTypeBox) {</span>
<a href="#l26.22"></a><span id="l26.22">     if (gHideIncoming) {</span>
<a href="#l26.23"></a><span id="l26.23">       incomingServerbox.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l26.24"></a><span id="l26.24">       serverTypeBox.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l26.25"></a><span id="l26.25">     }</span>
<a href="#l26.26"></a><span id="l26.26">     else {</span>
<a href="#l26.27"></a><span id="l26.27">       incomingServerbox.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l26.28"></a><span id="l26.28">       serverTypeBox.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l26.29"></a><span id="l26.29">     }</span>
<a href="#l26.30"></a><span id="l26.30">   }</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-  </span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+</span>
<a href="#l26.33"></a><span id="l26.33">   // Server type selection (pop3 or imap) is for mail accounts only</span>
<a href="#l26.34"></a><span id="l26.34">   var pageData = parent.GetPageData();</span>
<a href="#l26.35"></a><span id="l26.35">   var isMailAccount = pageData.accounttype.mailaccount.value;</span>
<a href="#l26.36"></a><span id="l26.36">   var isOtherAccount = pageData.accounttype.otheraccount.value;</span>
<a href="#l26.37"></a><span id="l26.37">   if (isMailAccount &amp;&amp; !gHideIncoming) {</span>
<a href="#l26.38"></a><span id="l26.38">     var serverTypeRadioGroup = document.getElementById(&quot;servertype&quot;);</span>
<a href="#l26.39"></a><span id="l26.39" class="difflineminus">-    /* </span>
<a href="#l26.40"></a><span id="l26.40" class="difflineplus">+    /*</span>
<a href="#l26.41"></a><span id="l26.41">      * Check to see if the radiogroup has any value. If there is no</span>
<a href="#l26.42"></a><span id="l26.42">      * value, this must be the first time user visting this page in the</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineminus">-     * account setup process. So, the default is set to pop3. If there </span>
<a href="#l26.44"></a><span id="l26.44" class="difflineminus">-     * is a value (it's used automatically), user has already visited </span>
<a href="#l26.45"></a><span id="l26.45" class="difflineminus">-     * page and server type selection is done. Once user visits the page, </span>
<a href="#l26.46"></a><span id="l26.46" class="difflineminus">-     * the server type value from then on will persist (whether the selection </span>
<a href="#l26.47"></a><span id="l26.47" class="difflineplus">+     * account setup process. So, the default is set to pop3. If there</span>
<a href="#l26.48"></a><span id="l26.48" class="difflineplus">+     * is a value (it's used automatically), user has already visited</span>
<a href="#l26.49"></a><span id="l26.49" class="difflineplus">+     * page and server type selection is done. Once user visits the page,</span>
<a href="#l26.50"></a><span id="l26.50" class="difflineplus">+     * the server type value from then on will persist (whether the selection</span>
<a href="#l26.51"></a><span id="l26.51">      * came from the default or the user action).</span>
<a href="#l26.52"></a><span id="l26.52">      */</span>
<a href="#l26.53"></a><span id="l26.53">     if (!serverTypeRadioGroup.value) {</span>
<a href="#l26.54"></a><span id="l26.54">       /*</span>
<a href="#l26.55"></a><span id="l26.55">        * if server type was set to imap in isp data, then</span>
<a href="#l26.56"></a><span id="l26.56">        * we preset the server type radio group accordingly,</span>
<a href="#l26.57"></a><span id="l26.57">        * otherwise, use pop3 as the default.</span>
<a href="#l26.58"></a><span id="l26.58">        */</span>
<a href="#l26.59"></a><span id="l26.59" class="difflineat">@@ -146,17 +146,17 @@ function incomingPageInit() {</span>
<a href="#l26.60"></a><span id="l26.60">     if (gProtocolInfo.requiresUsername) {</span>
<a href="#l26.61"></a><span id="l26.61">       // since we require a username, use the uid from the email address</span>
<a href="#l26.62"></a><span id="l26.62">       loginNameInput.value = parent.getUsernameFromEmail(pageData.identity.email.value, gCurrentAccountData &amp;&amp;</span>
<a href="#l26.63"></a><span id="l26.63">                                                          gCurrentAccountData.incomingServerUserNameRequiresDomain);</span>
<a href="#l26.64"></a><span id="l26.64">     }</span>
<a href="#l26.65"></a><span id="l26.65">   }</span>
<a href="#l26.66"></a><span id="l26.66">   incomingPageValidate();</span>
<a href="#l26.67"></a><span id="l26.67"> }</span>
<a href="#l26.68"></a><span id="l26.68" class="difflineminus">- </span>
<a href="#l26.69"></a><span id="l26.69" class="difflineplus">+</span>
<a href="#l26.70"></a><span id="l26.70"> function setServerType()</span>
<a href="#l26.71"></a><span id="l26.71"> {</span>
<a href="#l26.72"></a><span id="l26.72">   var pageData = parent.GetPageData();</span>
<a href="#l26.73"></a><span id="l26.73">   var serverType = document.getElementById(&quot;servertype&quot;).value;</span>
<a href="#l26.74"></a><span id="l26.74">   var deferStorageBox = document.getElementById(&quot;deferStorageBox&quot;);</span>
<a href="#l26.75"></a><span id="l26.75">   var leaveMessages = document.getElementById(&quot;leaveMsgsOnSrvrBox&quot;);</span>
<a href="#l26.76"></a><span id="l26.76">   var port = serverType == &quot;pop3&quot; ? 110 : 143;</span>
<a href="#l26.77"></a><span id="l26.77"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/base/prefs/content/aw-outgoing.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/base/prefs/content/aw-outgoing.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -132,20 +132,20 @@ function hideShowLoginSettings(aEle, bEl</span>
<a href="#l27.4"></a><span id="l27.4"> }</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6"> var savedPassword=&quot;&quot;;</span>
<a href="#l27.7"></a><span id="l27.7"> </span>
<a href="#l27.8"></a><span id="l27.8"> function onSavePassword(target) {</span>
<a href="#l27.9"></a><span id="l27.9">     dump(&quot;savePassword changed! (&quot; + target.checked + &quot;)\n&quot;);</span>
<a href="#l27.10"></a><span id="l27.10">     var passwordField = document.getElementById(&quot;server.password&quot;);</span>
<a href="#l27.11"></a><span id="l27.11">     if (!passwordField) return;</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    </span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+</span>
<a href="#l27.14"></a><span id="l27.14">     if (target.checked) {</span>
<a href="#l27.15"></a><span id="l27.15">         passwordField.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l27.16"></a><span id="l27.16">         passwordField.value = savedPassword;</span>
<a href="#l27.17"></a><span id="l27.17">     }</span>
<a href="#l27.18"></a><span id="l27.18">     else {</span>
<a href="#l27.19"></a><span id="l27.19">         passwordField.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l27.20"></a><span id="l27.20">         savedPassword = passwordField.value;</span>
<a href="#l27.21"></a><span id="l27.21">         passwordField.value = &quot;&quot;;</span>
<a href="#l27.22"></a><span id="l27.22">     }</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineminus">-    </span>
<a href="#l27.24"></a><span id="l27.24" class="difflineplus">+</span>
<a href="#l27.25"></a><span id="l27.25"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/base/prefs/content/ispUtils.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/base/prefs/content/ispUtils.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -21,35 +21,35 @@ var ispDefaults;</span>
<a href="#l28.4"></a><span id="l28.4"> var nsIRDFResource = Components.interfaces.nsIRDFResource;</span>
<a href="#l28.5"></a><span id="l28.5"> var nsIRDFLiteral = Components.interfaces.nsIRDFLiteral;</span>
<a href="#l28.6"></a><span id="l28.6"> </span>
<a href="#l28.7"></a><span id="l28.7"> var ispRoot = rdf.GetResource(&quot;NC:ispinfo&quot;);</span>
<a href="#l28.8"></a><span id="l28.8"> </span>
<a href="#l28.9"></a><span id="l28.9"> // given an ISP's domain URI, look up all relevant information about it</span>
<a href="#l28.10"></a><span id="l28.10"> function getIspDefaultsForUri(domainURI)</span>
<a href="#l28.11"></a><span id="l28.11"> {</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-    if (!ispDefaults) </span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+    if (!ispDefaults)</span>
<a href="#l28.14"></a><span id="l28.14">         ispDefaults = rdf.GetDataSource(&quot;rdf:ispdefaults&quot;);</span>
<a href="#l28.15"></a><span id="l28.15"> </span>
<a href="#l28.16"></a><span id="l28.16">     var domainRes = rdf.GetResource(domainURI);</span>
<a href="#l28.17"></a><span id="l28.17"> </span>
<a href="#l28.18"></a><span id="l28.18">     var result = dataSourceToObject(ispDefaults, domainRes);</span>
<a href="#l28.19"></a><span id="l28.19"> </span>
<a href="#l28.20"></a><span id="l28.20">     if (!result) return null;</span>
<a href="#l28.21"></a><span id="l28.21"> </span>
<a href="#l28.22"></a><span id="l28.22" class="difflineminus">-    // The domainURI should be in the format domain:example.com. (Where </span>
<a href="#l28.23"></a><span id="l28.23" class="difflineplus">+    // The domainURI should be in the format domain:example.com. (Where</span>
<a href="#l28.24"></a><span id="l28.24">     // example.com is the domain name to use for all email addresses). If</span>
<a href="#l28.25"></a><span id="l28.25">     // it does not match this pattern, then it is possible no domain</span>
<a href="#l28.26"></a><span id="l28.26">     // has been specified, so we should leave it uninitialized.</span>
<a href="#l28.27"></a><span id="l28.27">     if (domainURI.startsWith(&quot;domain:&quot;)) {</span>
<a href="#l28.28"></a><span id="l28.28">         // add this extra attribute which is the domain itself</span>
<a href="#l28.29"></a><span id="l28.29">         var domainData = domainURI.split(':');</span>
<a href="#l28.30"></a><span id="l28.30">         if (domainData.length &gt; 1) {</span>
<a href="#l28.31"></a><span id="l28.31">           // To faciltate distributing two different account types for one ISP,</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineminus">-          // it's possible to add parameters to the domain URI </span>
<a href="#l28.33"></a><span id="l28.33" class="difflineplus">+          // it's possible to add parameters to the domain URI</span>
<a href="#l28.34"></a><span id="l28.34">           // - e.g. domain:example.com?type=imap.</span>
<a href="#l28.35"></a><span id="l28.35">           // This is necessary so RDF doesn't think they're the same.</span>
<a href="#l28.36"></a><span id="l28.36"> </span>
<a href="#l28.37"></a><span id="l28.37">           // Save the domain, but only the part up to the (possible) question mark.</span>
<a href="#l28.38"></a><span id="l28.38">           result.domain = domainData[1].replace(/\?.*/, &quot;&quot;);</span>
<a href="#l28.39"></a><span id="l28.39">         }</span>
<a href="#l28.40"></a><span id="l28.40">     }</span>
<a href="#l28.41"></a><span id="l28.41">     return result;</span>
<a href="#l28.42"></a><span id="l28.42" class="difflineat">@@ -57,17 +57,17 @@ function getIspDefaultsForUri(domainURI)</span>
<a href="#l28.43"></a><span id="l28.43"> </span>
<a href="#l28.44"></a><span id="l28.44"> // construct an ISP's domain URI based on it's domain</span>
<a href="#l28.45"></a><span id="l28.45"> // (i.e. turns example.com -&gt; domain:example.com)</span>
<a href="#l28.46"></a><span id="l28.46"> function getIspDefaultsForDomain(domain) {</span>
<a href="#l28.47"></a><span id="l28.47">     let domainURI = &quot;domain:&quot; + domain;</span>
<a href="#l28.48"></a><span id="l28.48">     return getIspDefaultsForUri(domainURI);</span>
<a href="#l28.49"></a><span id="l28.49"> }</span>
<a href="#l28.50"></a><span id="l28.50"> </span>
<a href="#l28.51"></a><span id="l28.51" class="difflineminus">-// Given an email address (like &quot;joe@example.com&quot;) look up </span>
<a href="#l28.52"></a><span id="l28.52" class="difflineplus">+// Given an email address (like &quot;joe@example.com&quot;) look up</span>
<a href="#l28.53"></a><span id="l28.53"> function getIspDefaultsForEmail(email) {</span>
<a href="#l28.54"></a><span id="l28.54"> </span>
<a href="#l28.55"></a><span id="l28.55">     var emailData = getEmailInfo(email);</span>
<a href="#l28.56"></a><span id="l28.56"> </span>
<a href="#l28.57"></a><span id="l28.57">     var ispData = null;</span>
<a href="#l28.58"></a><span id="l28.58">     if (emailData)</span>
<a href="#l28.59"></a><span id="l28.59">         ispData = getIspDefaultsForDomain(emailData.domain);</span>
<a href="#l28.60"></a><span id="l28.60"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/base/search/content/CustomHeaders.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/base/search/content/CustomHeaders.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -138,17 +138,17 @@ function duplicateHdrExists(hdr)</span>
<a href="#l29.4"></a><span id="l29.4"> {</span>
<a href="#l29.5"></a><span id="l29.5">   for (var i = 0;i &lt; gArrayHdrs.length; i++)</span>
<a href="#l29.6"></a><span id="l29.6">   {</span>
<a href="#l29.7"></a><span id="l29.7">     if (gArrayHdrs[i] == hdr)</span>
<a href="#l29.8"></a><span id="l29.8">       return true;</span>
<a href="#l29.9"></a><span id="l29.9">   }</span>
<a href="#l29.10"></a><span id="l29.10">   return false;</span>
<a href="#l29.11"></a><span id="l29.11"> }</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">- </span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+</span>
<a href="#l29.14"></a><span id="l29.14"> function onRemoveHeader()</span>
<a href="#l29.15"></a><span id="l29.15"> {</span>
<a href="#l29.16"></a><span id="l29.16">   var listitem = gHdrsList.selectedItems[0]</span>
<a href="#l29.17"></a><span id="l29.17">   if (!listitem) return;</span>
<a href="#l29.18"></a><span id="l29.18">   listitem.remove();</span>
<a href="#l29.19"></a><span id="l29.19">   var selectedHdr = GetListItemAttributeStr(listitem);</span>
<a href="#l29.20"></a><span id="l29.20">   var j=0;</span>
<a href="#l29.21"></a><span id="l29.21">   for (var i = 0; i &lt; gArrayHdrs.length; i++)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mailnews/base/search/content/FilterEditor.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mailnews/base/search/content/FilterEditor.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -808,17 +808,17 @@ function updateFilterType()</span>
<a href="#l30.4"></a><span id="l30.4"> </span>
<a href="#l30.5"></a><span id="l30.5">   // set valid actions</span>
<a href="#l30.6"></a><span id="l30.6">   var ruleActions = gFilterActionList.getElementsByAttribute('class', 'ruleaction');</span>
<a href="#l30.7"></a><span id="l30.7">   for (var i = 0; i &lt; ruleActions.length; i++)</span>
<a href="#l30.8"></a><span id="l30.8">     ruleActions[i].mRuleActionType.hideInvalidActions();</span>
<a href="#l30.9"></a><span id="l30.9"> }</span>
<a href="#l30.10"></a><span id="l30.10"> </span>
<a href="#l30.11"></a><span id="l30.11"> // Given a filter type, set the global search scope to the filter scope</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-function setFilterScope(aFilterType, aFilterList) </span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+function setFilterScope(aFilterType, aFilterList)</span>
<a href="#l30.14"></a><span id="l30.14"> {</span>
<a href="#l30.15"></a><span id="l30.15">   let filterScope = getFilterScope(getScopeFromFilterList(aFilterList),</span>
<a href="#l30.16"></a><span id="l30.16">                                    aFilterType, aFilterList);</span>
<a href="#l30.17"></a><span id="l30.17">   setSearchScope(filterScope);</span>
<a href="#l30.18"></a><span id="l30.18"> }</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20"> //</span>
<a href="#l30.21"></a><span id="l30.21"> // Given the base filter scope for a server, and the filter</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mailnews/base/search/content/searchTermOverlay.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mailnews/base/search/content/searchTermOverlay.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -5,17 +5,17 @@</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5"> var gTotalSearchTerms=0;</span>
<a href="#l31.6"></a><span id="l31.6"> var gSearchTermList;</span>
<a href="#l31.7"></a><span id="l31.7"> var gSearchTerms = new Array;</span>
<a href="#l31.8"></a><span id="l31.8"> var gSearchRemovedTerms = new Array;</span>
<a href="#l31.9"></a><span id="l31.9"> var gSearchScope;</span>
<a href="#l31.10"></a><span id="l31.10"> var gSearchBooleanRadiogroup;</span>
<a href="#l31.11"></a><span id="l31.11"> </span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-var gUniqueSearchTermCounter = 0; // gets bumped every time we add a search term so we can always </span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+var gUniqueSearchTermCounter = 0; // gets bumped every time we add a search term so we can always</span>
<a href="#l31.14"></a><span id="l31.14">                                   // dynamically generate unique IDs for the terms.</span>
<a href="#l31.15"></a><span id="l31.15"> </span>
<a href="#l31.16"></a><span id="l31.16"> // cache these so we don't have to hit the string bundle for them</span>
<a href="#l31.17"></a><span id="l31.17"> var gMoreButtonTooltipText;</span>
<a href="#l31.18"></a><span id="l31.18"> var gLessButtonTooltipText;</span>
<a href="#l31.19"></a><span id="l31.19"> var gLoading = true;</span>
<a href="#l31.20"></a><span id="l31.20"> </span>
<a href="#l31.21"></a><span id="l31.21"> </span>
<a href="#l31.22"></a><span id="l31.22" class="difflineat">@@ -110,17 +110,17 @@ searchTermContainer.prototype = {</span>
<a href="#l31.23"></a><span id="l31.23">           searchTerm.attrib = nsMsgSearchAttrib.Custom;</span>
<a href="#l31.24"></a><span id="l31.24">           searchTerm.customId = this.searchattribute.value;</span>
<a href="#l31.25"></a><span id="l31.25">         }</span>
<a href="#l31.26"></a><span id="l31.26">         else</span>
<a href="#l31.27"></a><span id="l31.27">         {</span>
<a href="#l31.28"></a><span id="l31.28">           searchTerm.attrib = this.searchattribute.value;</span>
<a href="#l31.29"></a><span id="l31.29">         }</span>
<a href="#l31.30"></a><span id="l31.30"> </span>
<a href="#l31.31"></a><span id="l31.31" class="difflineminus">-        if (this.searchattribute.value &gt; nsMsgSearchAttrib.OtherHeader &amp;&amp; this.searchattribute.value &lt; nsMsgSearchAttrib.kNumMsgSearchAttributes) </span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+        if (this.searchattribute.value &gt; nsMsgSearchAttrib.OtherHeader &amp;&amp; this.searchattribute.value &lt; nsMsgSearchAttrib.kNumMsgSearchAttributes)</span>
<a href="#l31.33"></a><span id="l31.33">           searchTerm.arbitraryHeader = this.searchattribute.label;</span>
<a href="#l31.34"></a><span id="l31.34">         searchTerm.op = this.searchoperator.value;</span>
<a href="#l31.35"></a><span id="l31.35">         if (this.searchvalue.value)</span>
<a href="#l31.36"></a><span id="l31.36">             this.searchvalue.save();</span>
<a href="#l31.37"></a><span id="l31.37">         else</span>
<a href="#l31.38"></a><span id="l31.38">             this.searchvalue.saveTo(searchTerm.value);</span>
<a href="#l31.39"></a><span id="l31.39">         searchTerm.value = this.searchvalue.value;</span>
<a href="#l31.40"></a><span id="l31.40">         searchTerm.booleanAnd = this.booleanAnd;</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineat">@@ -130,45 +130,45 @@ searchTermContainer.prototype = {</span>
<a href="#l31.42"></a><span id="l31.42">     saveTo: function(searchTerm) {</span>
<a href="#l31.43"></a><span id="l31.43">         this.internalSearchTerm = searchTerm;</span>
<a href="#l31.44"></a><span id="l31.44">         this.save();</span>
<a href="#l31.45"></a><span id="l31.45">     }</span>
<a href="#l31.46"></a><span id="l31.46"> }</span>
<a href="#l31.47"></a><span id="l31.47"> </span>
<a href="#l31.48"></a><span id="l31.48"> var nsIMsgSearchTerm = Components.interfaces.nsIMsgSearchTerm;</span>
<a href="#l31.49"></a><span id="l31.49"> </span>
<a href="#l31.50"></a><span id="l31.50" class="difflineminus">-function initializeSearchWidgets() </span>
<a href="#l31.51"></a><span id="l31.51" class="difflineminus">-{    </span>
<a href="#l31.52"></a><span id="l31.52" class="difflineplus">+function initializeSearchWidgets()</span>
<a href="#l31.53"></a><span id="l31.53" class="difflineplus">+{</span>
<a href="#l31.54"></a><span id="l31.54">     gSearchBooleanRadiogroup = document.getElementById(&quot;booleanAndGroup&quot;);</span>
<a href="#l31.55"></a><span id="l31.55">     gSearchTermList = document.getElementById(&quot;searchTermList&quot;);</span>
<a href="#l31.56"></a><span id="l31.56"> </span>
<a href="#l31.57"></a><span id="l31.57">     // initialize some strings</span>
<a href="#l31.58"></a><span id="l31.58">     var bundle = document.getElementById('bundle_search');</span>
<a href="#l31.59"></a><span id="l31.59">     gMoreButtonTooltipText = bundle.getString('moreButtonTooltipText');</span>
<a href="#l31.60"></a><span id="l31.60">     gLessButtonTooltipText = bundle.getString('lessButtonTooltipText');</span>
<a href="#l31.61"></a><span id="l31.61"> }</span>
<a href="#l31.62"></a><span id="l31.62"> </span>
<a href="#l31.63"></a><span id="l31.63" class="difflineminus">-function initializeBooleanWidgets() </span>
<a href="#l31.64"></a><span id="l31.64" class="difflineplus">+function initializeBooleanWidgets()</span>
<a href="#l31.65"></a><span id="l31.65"> {</span>
<a href="#l31.66"></a><span id="l31.66">     var booleanAnd = true;</span>
<a href="#l31.67"></a><span id="l31.67">     var matchAll = false;</span>
<a href="#l31.68"></a><span id="l31.68">     // get the boolean value from the first term</span>
<a href="#l31.69"></a><span id="l31.69">     var firstTerm = gSearchTerms[0].searchTerm;</span>
<a href="#l31.70"></a><span id="l31.70">     if (firstTerm)</span>
<a href="#l31.71"></a><span id="l31.71">     {</span>
<a href="#l31.72"></a><span id="l31.72">         // If there is a second term, it should actually define whether we're</span>
<a href="#l31.73"></a><span id="l31.73">         //  using 'and' or not.  Note that our UI is not as rich as the</span>
<a href="#l31.74"></a><span id="l31.74">         //  underlying search model, so there's the potential to lose here when</span>
<a href="#l31.75"></a><span id="l31.75">         //  grouping is involved.</span>
<a href="#l31.76"></a><span id="l31.76">         booleanAnd = (gSearchTerms.length &gt; 1) ?</span>
<a href="#l31.77"></a><span id="l31.77">             gSearchTerms[1].searchTerm.booleanAnd : firstTerm.booleanAnd;</span>
<a href="#l31.78"></a><span id="l31.78">         matchAll = firstTerm.matchAll;</span>
<a href="#l31.79"></a><span id="l31.79">     }</span>
<a href="#l31.80"></a><span id="l31.80">     // target radio items have value=&quot;and&quot; or value=&quot;or&quot; or &quot;all&quot;</span>
<a href="#l31.81"></a><span id="l31.81" class="difflineminus">-    gSearchBooleanRadiogroup.value = matchAll </span>
<a href="#l31.82"></a><span id="l31.82" class="difflineplus">+    gSearchBooleanRadiogroup.value = matchAll</span>
<a href="#l31.83"></a><span id="l31.83">       ? &quot;matchAll&quot;</span>
<a href="#l31.84"></a><span id="l31.84">       : (booleanAnd ? &quot;and&quot; : &quot;or&quot;)</span>
<a href="#l31.85"></a><span id="l31.85">     var searchTerms = document.getElementById(&quot;searchTermList&quot;);</span>
<a href="#l31.86"></a><span id="l31.86">     if (searchTerms)</span>
<a href="#l31.87"></a><span id="l31.87">       updateSearchTermsListbox(matchAll);</span>
<a href="#l31.88"></a><span id="l31.88"> }</span>
<a href="#l31.89"></a><span id="l31.89"> </span>
<a href="#l31.90"></a><span id="l31.90"> function initializeSearchRows(scope, searchTerms)</span>
<a href="#l31.91"></a><span id="l31.91" class="difflineat">@@ -211,61 +211,61 @@ function updateSearchTermsListbox(matchA</span>
<a href="#l31.92"></a><span id="l31.92"> </span>
<a href="#l31.93"></a><span id="l31.93"> // enables/disables the less button for the first row of search terms.</span>
<a href="#l31.94"></a><span id="l31.94"> function updateRemoveRowButton()</span>
<a href="#l31.95"></a><span id="l31.95"> {</span>
<a href="#l31.96"></a><span id="l31.96">   var firstListItem = gSearchTermList.getItemAtIndex(0);</span>
<a href="#l31.97"></a><span id="l31.97">   if (firstListItem)</span>
<a href="#l31.98"></a><span id="l31.98">     firstListItem.lastChild.lastChild.setAttribute(&quot;disabled&quot;, gTotalSearchTerms == 1);</span>
<a href="#l31.99"></a><span id="l31.99"> }</span>
<a href="#l31.100"></a><span id="l31.100" class="difflineminus">- </span>
<a href="#l31.101"></a><span id="l31.101" class="difflineplus">+</span>
<a href="#l31.102"></a><span id="l31.102"> // Returns the actual list item row index in the list of search rows</span>
<a href="#l31.103"></a><span id="l31.103"> // that contains the passed in element id.</span>
<a href="#l31.104"></a><span id="l31.104"> function getSearchRowIndexForElement(aElement)</span>
<a href="#l31.105"></a><span id="l31.105"> {</span>
<a href="#l31.106"></a><span id="l31.106">   var listItem = aElement;</span>
<a href="#l31.107"></a><span id="l31.107" class="difflineminus">-  </span>
<a href="#l31.108"></a><span id="l31.108" class="difflineplus">+</span>
<a href="#l31.109"></a><span id="l31.109">   while (listItem &amp;&amp; listItem.localName != &quot;listitem&quot;)</span>
<a href="#l31.110"></a><span id="l31.110">     listItem = listItem.parentNode;</span>
<a href="#l31.111"></a><span id="l31.111" class="difflineminus">-    </span>
<a href="#l31.112"></a><span id="l31.112" class="difflineplus">+</span>
<a href="#l31.113"></a><span id="l31.113">   return gSearchTermList.getIndexOfItem(listItem);</span>
<a href="#l31.114"></a><span id="l31.114"> }</span>
<a href="#l31.115"></a><span id="l31.115"> </span>
<a href="#l31.116"></a><span id="l31.116"> function onMore(event)</span>
<a href="#l31.117"></a><span id="l31.117"> {</span>
<a href="#l31.118"></a><span id="l31.118">   // if we have an event, extract the list row index and use that as the row number</span>
<a href="#l31.119"></a><span id="l31.119">   // for our insertion point. If there is no event, append to the end....</span>
<a href="#l31.120"></a><span id="l31.120" class="difflineminus">-  var rowIndex; </span>
<a href="#l31.121"></a><span id="l31.121" class="difflineplus">+  var rowIndex;</span>
<a href="#l31.122"></a><span id="l31.122"> </span>
<a href="#l31.123"></a><span id="l31.123">   if (event)</span>
<a href="#l31.124"></a><span id="l31.124">     rowIndex = getSearchRowIndexForElement(event.target) + 1;</span>
<a href="#l31.125"></a><span id="l31.125">   else</span>
<a href="#l31.126"></a><span id="l31.126">     rowIndex = gSearchTermList.getRowCount();</span>
<a href="#l31.127"></a><span id="l31.127"> </span>
<a href="#l31.128"></a><span id="l31.128">   createSearchRow(rowIndex, gSearchScope, null, event != null);</span>
<a href="#l31.129"></a><span id="l31.129">   gTotalSearchTerms++;</span>
<a href="#l31.130"></a><span id="l31.130">   updateRemoveRowButton();</span>
<a href="#l31.131"></a><span id="l31.131"> </span>
<a href="#l31.132"></a><span id="l31.132">   // the user just added a term, so scroll to it</span>
<a href="#l31.133"></a><span id="l31.133">   gSearchTermList.ensureIndexIsVisible(rowIndex);</span>
<a href="#l31.134"></a><span id="l31.134"> }</span>
<a href="#l31.135"></a><span id="l31.135"> </span>
<a href="#l31.136"></a><span id="l31.136"> function onLess(event)</span>
<a href="#l31.137"></a><span id="l31.137"> {</span>
<a href="#l31.138"></a><span id="l31.138" class="difflineminus">-  if (event &amp;&amp; gTotalSearchTerms &gt; 1) </span>
<a href="#l31.139"></a><span id="l31.139" class="difflineplus">+  if (event &amp;&amp; gTotalSearchTerms &gt; 1)</span>
<a href="#l31.140"></a><span id="l31.140">   {</span>
<a href="#l31.141"></a><span id="l31.141" class="difflineminus">-    removeSearchRow(getSearchRowIndexForElement(event.target));    </span>
<a href="#l31.142"></a><span id="l31.142" class="difflineplus">+    removeSearchRow(getSearchRowIndexForElement(event.target));</span>
<a href="#l31.143"></a><span id="l31.143">     --gTotalSearchTerms;</span>
<a href="#l31.144"></a><span id="l31.144">   }</span>
<a href="#l31.145"></a><span id="l31.145"> </span>
<a href="#l31.146"></a><span id="l31.146">   updateRemoveRowButton();</span>
<a href="#l31.147"></a><span id="l31.147"> }</span>
<a href="#l31.148"></a><span id="l31.148"> </span>
<a href="#l31.149"></a><span id="l31.149"> // set scope on all visible searchattribute tags</span>
<a href="#l31.150"></a><span id="l31.150" class="difflineminus">-function setSearchScope(scope) </span>
<a href="#l31.151"></a><span id="l31.151" class="difflineplus">+function setSearchScope(scope)</span>
<a href="#l31.152"></a><span id="l31.152"> {</span>
<a href="#l31.153"></a><span id="l31.153">   gSearchScope = scope;</span>
<a href="#l31.154"></a><span id="l31.154">   for (var i = 0; i &lt; gSearchTerms.length; i++)</span>
<a href="#l31.155"></a><span id="l31.155">   {</span>
<a href="#l31.156"></a><span id="l31.156">     // don't set element attributes if XBL hasn't loaded</span>
<a href="#l31.157"></a><span id="l31.157">     if (!(gSearchTerms[i].obj.searchattribute.searchScope === undefined))</span>
<a href="#l31.158"></a><span id="l31.158">     {</span>
<a href="#l31.159"></a><span id="l31.159">       gSearchTerms[i].obj.searchattribute.searchScope = scope;</span>
<a href="#l31.160"></a><span id="l31.160" class="difflineat">@@ -273,17 +273,17 @@ function setSearchScope(scope)</span>
<a href="#l31.161"></a><span id="l31.161">       gSearchTerms[i].obj.searchattribute.onSelect(null /* no event */);</span>
<a href="#l31.162"></a><span id="l31.162">     }</span>
<a href="#l31.163"></a><span id="l31.163">     gSearchTerms[i].scope = scope;</span>
<a href="#l31.164"></a><span id="l31.164">   }</span>
<a href="#l31.165"></a><span id="l31.165"> }</span>
<a href="#l31.166"></a><span id="l31.166"> </span>
<a href="#l31.167"></a><span id="l31.167"> function updateSearchAttributes()</span>
<a href="#l31.168"></a><span id="l31.168"> {</span>
<a href="#l31.169"></a><span id="l31.169" class="difflineminus">-    for (var i=0; i&lt;gSearchTerms.length; i++) </span>
<a href="#l31.170"></a><span id="l31.170" class="difflineplus">+    for (var i=0; i&lt;gSearchTerms.length; i++)</span>
<a href="#l31.171"></a><span id="l31.171">         gSearchTerms[i].obj.searchattribute.refreshList();</span>
<a href="#l31.172"></a><span id="l31.172">     }</span>
<a href="#l31.173"></a><span id="l31.173"> </span>
<a href="#l31.174"></a><span id="l31.174"> function booleanChanged(event) {</span>
<a href="#l31.175"></a><span id="l31.175">     // when boolean changes, we have to update all the attributes on the search terms</span>
<a href="#l31.176"></a><span id="l31.176">     var newBoolValue = (event.target.getAttribute(&quot;value&quot;) == &quot;and&quot;);</span>
<a href="#l31.177"></a><span id="l31.177">     var matchAllValue = (event.target.getAttribute(&quot;value&quot;) == &quot;matchAll&quot;);</span>
<a href="#l31.178"></a><span id="l31.178">     if (document.getElementById(&quot;abPopup&quot;)) {</span>
<a href="#l31.179"></a><span id="l31.179" class="difflineat">@@ -325,17 +325,17 @@ function createSearchRow(index, scope, s</span>
<a href="#l31.180"></a><span id="l31.180"> </span>
<a href="#l31.181"></a><span id="l31.181">     var moreButton = document.createElement(&quot;button&quot;);</span>
<a href="#l31.182"></a><span id="l31.182">     var lessButton = document.createElement(&quot;button&quot;);</span>
<a href="#l31.183"></a><span id="l31.183">     moreButton.setAttribute(&quot;class&quot;, &quot;small-button&quot;);</span>
<a href="#l31.184"></a><span id="l31.184">     moreButton.setAttribute(&quot;oncommand&quot;, &quot;onMore(event);&quot;);</span>
<a href="#l31.185"></a><span id="l31.185">     moreButton.setAttribute('label', '+');</span>
<a href="#l31.186"></a><span id="l31.186">     moreButton.setAttribute('tooltiptext', gMoreButtonTooltipText);</span>
<a href="#l31.187"></a><span id="l31.187">     lessButton.setAttribute(&quot;class&quot;, &quot;small-button&quot;);</span>
<a href="#l31.188"></a><span id="l31.188" class="difflineminus">-    lessButton.setAttribute(&quot;oncommand&quot;, &quot;onLess(event);&quot;);    </span>
<a href="#l31.189"></a><span id="l31.189" class="difflineplus">+    lessButton.setAttribute(&quot;oncommand&quot;, &quot;onLess(event);&quot;);</span>
<a href="#l31.190"></a><span id="l31.190">     lessButton.setAttribute('label', '\u2212');</span>
<a href="#l31.191"></a><span id="l31.191">     lessButton.setAttribute('tooltiptext', gLessButtonTooltipText);</span>
<a href="#l31.192"></a><span id="l31.192"> </span>
<a href="#l31.193"></a><span id="l31.193">     // now set up ids:</span>
<a href="#l31.194"></a><span id="l31.194">     searchAttr.id = &quot;searchAttr&quot; + gUniqueSearchTermCounter;</span>
<a href="#l31.195"></a><span id="l31.195">     searchOp.id  = &quot;searchOp&quot; + gUniqueSearchTermCounter;</span>
<a href="#l31.196"></a><span id="l31.196">     searchVal.id = &quot;searchVal&quot; + gUniqueSearchTermCounter;</span>
<a href="#l31.197"></a><span id="l31.197"> </span>
<a href="#l31.198"></a><span id="l31.198" class="difflineat">@@ -477,17 +477,17 @@ function removeSearchRow(index)</span>
<a href="#l31.199"></a><span id="l31.199">         gSearchRemovedTerms.push(searchTermObj.searchTerm);</span>
<a href="#l31.200"></a><span id="l31.200">     } else {</span>
<a href="#l31.201"></a><span id="l31.201">         //dump(&quot;That wasn't real. ignoring \n&quot;);</span>
<a href="#l31.202"></a><span id="l31.202">     }</span>
<a href="#l31.203"></a><span id="l31.203"> </span>
<a href="#l31.204"></a><span id="l31.204">     listitem.remove();</span>
<a href="#l31.205"></a><span id="l31.205"> </span>
<a href="#l31.206"></a><span id="l31.206">     // now remove the item from our list of terms</span>
<a href="#l31.207"></a><span id="l31.207" class="difflineminus">-    gSearchTerms.splice(index, 1); </span>
<a href="#l31.208"></a><span id="l31.208" class="difflineplus">+    gSearchTerms.splice(index, 1);</span>
<a href="#l31.209"></a><span id="l31.209"> }</span>
<a href="#l31.210"></a><span id="l31.210"> </span>
<a href="#l31.211"></a><span id="l31.211"> // save the search terms from the UI back to the actual search terms</span>
<a href="#l31.212"></a><span id="l31.212"> // searchTerms: nsIMutableArray of terms</span>
<a href="#l31.213"></a><span id="l31.213"> // termOwner:   object which can contain and create the terms</span>
<a href="#l31.214"></a><span id="l31.214"> //              (will be unnecessary if we just make terms creatable</span>
<a href="#l31.215"></a><span id="l31.215"> //               via XPCOM)</span>
<a href="#l31.216"></a><span id="l31.216"> function saveSearchTerms(searchTerms, termOwner)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mailnews/base/src/newMailNotificationService.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mailnews/base/src/newMailNotificationService.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -54,17 +54,17 @@ function NewMailNotificationService() {</span>
<a href="#l32.4"></a><span id="l32.4"> }</span>
<a href="#l32.5"></a><span id="l32.5"> </span>
<a href="#l32.6"></a><span id="l32.6"> NewMailNotificationService.prototype = {</span>
<a href="#l32.7"></a><span id="l32.7">   classDescription: &quot;Maintain counts of new and unread messages&quot;,</span>
<a href="#l32.8"></a><span id="l32.8">   classID:              Components.ID(&quot;{740880E6-E299-4165-B82F-DF1DCAB3AE22}&quot;),</span>
<a href="#l32.9"></a><span id="l32.9">   contractID:           &quot;@mozilla.org/newMailNotificationService;1&quot;,</span>
<a href="#l32.10"></a><span id="l32.10">   QueryInterface:       XPCOMUtils.generateQI([Ci.nsIObserver, Ci.nsIFolderListener, Ci.mozINewMailNotificationService]),</span>
<a href="#l32.11"></a><span id="l32.11">   _xpcom_factory: XPCOMUtils.generateSingletonFactory(NewMailNotificationService),</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-  </span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+</span>
<a href="#l32.14"></a><span id="l32.14">   _mUnreadCount: 0,</span>
<a href="#l32.15"></a><span id="l32.15">   _mNewCount: 0,</span>
<a href="#l32.16"></a><span id="l32.16">   _listeners: null,</span>
<a href="#l32.17"></a><span id="l32.17">   _log: null,</span>
<a href="#l32.18"></a><span id="l32.18"> </span>
<a href="#l32.19"></a><span id="l32.19">   get countNew() {</span>
<a href="#l32.20"></a><span id="l32.20">     return getBoolPref(countNewMessagesPref, false);</span>
<a href="#l32.21"></a><span id="l32.21">   },</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineat">@@ -310,17 +310,17 @@ NewMailNotificationService.prototype = {</span>
<a href="#l32.23"></a><span id="l32.23">     }</span>
<a href="#l32.24"></a><span id="l32.24">   },</span>
<a href="#l32.25"></a><span id="l32.25"> </span>
<a href="#l32.26"></a><span id="l32.26">   OnItemRemoved: function NMNS_OnItemRemoved(parentItem, item) {</span>
<a href="#l32.27"></a><span id="l32.27">     if (item instanceof Ci.nsIMsgDBHdr &amp;&amp; !item.isRead) {</span>
<a href="#l32.28"></a><span id="l32.28">       this._log.trace(&quot;NMNS_OnItemRemoved: unread item &quot; + item.folder.getUriForMsg(item) + &quot; removed from &quot; + item.folder.folderURL);</span>
<a href="#l32.29"></a><span id="l32.29">     }</span>
<a href="#l32.30"></a><span id="l32.30">   },</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-  </span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+</span>
<a href="#l32.33"></a><span id="l32.33"> </span>
<a href="#l32.34"></a><span id="l32.34">   // Implement mozINewMailNotificationService</span>
<a href="#l32.35"></a><span id="l32.35"> </span>
<a href="#l32.36"></a><span id="l32.36">   get messageCount() {</span>
<a href="#l32.37"></a><span id="l32.37">     if (this.countNew)</span>
<a href="#l32.38"></a><span id="l32.38">       return this._mNewCount;</span>
<a href="#l32.39"></a><span id="l32.39">     return this._mUnreadCount;</span>
<a href="#l32.40"></a><span id="l32.40">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mailnews/base/test/unit/test_autoconfigXML.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_autoconfigXML.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -233,17 +233,17 @@ function test_replaceVariables()</span>
<a href="#l33.4"></a><span id="l33.4">         '&lt;/outgoingServer&gt;' +</span>
<a href="#l33.5"></a><span id="l33.5">       '&lt;/emailProvider&gt;' +</span>
<a href="#l33.6"></a><span id="l33.6">     '&lt;/clientConfig&gt;';</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8">   var domParser = new DOMParser();</span>
<a href="#l33.9"></a><span id="l33.9">   var config = xmlReader.readFromXML(JXON.build(</span>
<a href="#l33.10"></a><span id="l33.10">     domParser.parseFromString(clientConfigXML, &quot;text/xml&quot;)));</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-  xmlReader.replaceVariables(config, </span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+  xmlReader.replaceVariables(config,</span>
<a href="#l33.14"></a><span id="l33.14">                              &quot;Yamato Nadeshiko&quot;,</span>
<a href="#l33.15"></a><span id="l33.15">                              &quot;yamato.nadeshiko@example.com&quot;,</span>
<a href="#l33.16"></a><span id="l33.16">                              &quot;abc12345&quot;);</span>
<a href="#l33.17"></a><span id="l33.17"> </span>
<a href="#l33.18"></a><span id="l33.18">   assert_equal_config(config.incoming.username,</span>
<a href="#l33.19"></a><span id="l33.19">                       &quot;yamato.nadeshiko&quot;,</span>
<a href="#l33.20"></a><span id="l33.20">                       &quot;incoming server username&quot;);</span>
<a href="#l33.21"></a><span id="l33.21">   assert_equal_config(config.outgoing.username,</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineat">@@ -253,17 +253,17 @@ function test_replaceVariables()</span>
<a href="#l33.23"></a><span id="l33.23">                       &quot;pop.example.com&quot;,</span>
<a href="#l33.24"></a><span id="l33.24">                       &quot;incoming server hostname&quot;);</span>
<a href="#l33.25"></a><span id="l33.25">   assert_equal_config(config.outgoing.hostname,</span>
<a href="#l33.26"></a><span id="l33.26">                       &quot;smtp.example.com&quot;,</span>
<a href="#l33.27"></a><span id="l33.27">                       &quot;outgoing server hostname&quot;);</span>
<a href="#l33.28"></a><span id="l33.28">   assert_equal_config(config.identity.realname,</span>
<a href="#l33.29"></a><span id="l33.29">                       &quot;Yamato Nadeshiko&quot;,</span>
<a href="#l33.30"></a><span id="l33.30">                       &quot;user real name&quot;);</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-  assert_equal_config(config.identity.emailAddress, </span>
<a href="#l33.32"></a><span id="l33.32" class="difflineplus">+  assert_equal_config(config.identity.emailAddress,</span>
<a href="#l33.33"></a><span id="l33.33">                       &quot;yamato.nadeshiko@example.com&quot;,</span>
<a href="#l33.34"></a><span id="l33.34">                       &quot;user email address&quot;);</span>
<a href="#l33.35"></a><span id="l33.35"> }</span>
<a href="#l33.36"></a><span id="l33.36"> </span>
<a href="#l33.37"></a><span id="l33.37"> function run_test()</span>
<a href="#l33.38"></a><span id="l33.38"> {</span>
<a href="#l33.39"></a><span id="l33.39">   if (!xmlReader)</span>
<a href="#l33.40"></a><span id="l33.40">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bccInDatabase.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bccInDatabase.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -9,17 +9,17 @@</span>
<a href="#l34.4"></a><span id="l34.4"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l34.5"></a><span id="l34.5"> </span>
<a href="#l34.6"></a><span id="l34.6"> var hdr;</span>
<a href="#l34.7"></a><span id="l34.7"> </span>
<a href="#l34.8"></a><span id="l34.8"> function run_test()</span>
<a href="#l34.9"></a><span id="l34.9"> {</span>
<a href="#l34.10"></a><span id="l34.10">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l34.11"></a><span id="l34.11"> </span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-  var copyListener = </span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+  var copyListener =</span>
<a href="#l34.14"></a><span id="l34.14">   {</span>
<a href="#l34.15"></a><span id="l34.15">     OnStartCopy: function() {},</span>
<a href="#l34.16"></a><span id="l34.16">     OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l34.17"></a><span id="l34.17">     SetMessageKey: function(aKey) {</span>
<a href="#l34.18"></a><span id="l34.18">       hdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l34.19"></a><span id="l34.19">     },</span>
<a href="#l34.20"></a><span id="l34.20">     SetMessageId: function(aMessageId) {},</span>
<a href="#l34.21"></a><span id="l34.21">     OnStopCopy: function(aStatus) { continueTest();}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug366491.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug366491.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -18,18 +18,18 @@ var kGood = MailServices.junk.GOOD;</span>
<a href="#l35.4"></a><span id="l35.4"> </span>
<a href="#l35.5"></a><span id="l35.5"> /*</span>
<a href="#l35.6"></a><span id="l35.6">  * This test is not intended to check the spam calculations,</span>
<a href="#l35.7"></a><span id="l35.7">  * but only that the junk percent is transmitted (particularly</span>
<a href="#l35.8"></a><span id="l35.8">  * for intermediate values). The test</span>
<a href="#l35.9"></a><span id="l35.9">  * junkPercent values below were calculated by the plugin,</span>
<a href="#l35.10"></a><span id="l35.10">  * not indepedently verified.</span>
<a href="#l35.11"></a><span id="l35.11">  */</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">- </span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-var tests = </span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineplus">+var tests =</span>
<a href="#l35.16"></a><span id="l35.16"> [</span>
<a href="#l35.17"></a><span id="l35.17">   {fileName: &quot;ham2.eml&quot;,</span>
<a href="#l35.18"></a><span id="l35.18">    junkPercent: 8},</span>
<a href="#l35.19"></a><span id="l35.19">   {fileName: &quot;spam2.eml&quot;,</span>
<a href="#l35.20"></a><span id="l35.20">    junkPercent: 81},</span>
<a href="#l35.21"></a><span id="l35.21"> ];</span>
<a href="#l35.22"></a><span id="l35.22"> </span>
<a href="#l35.23"></a><span id="l35.23"> var emails =</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineat">@@ -45,17 +45,17 @@ function run_test()</span>
<a href="#l35.25"></a><span id="l35.25"> {</span>
<a href="#l35.26"></a><span id="l35.26">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l35.27"></a><span id="l35.27">   do_test_pending();</span>
<a href="#l35.28"></a><span id="l35.28">   doTestingListener.onMessageClassified(null, null, null);</span>
<a href="#l35.29"></a><span id="l35.29">   return true;</span>
<a href="#l35.30"></a><span id="l35.30"> };</span>
<a href="#l35.31"></a><span id="l35.31"> </span>
<a href="#l35.32"></a><span id="l35.32"> var haveClassification = false;</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineminus">-var doTestingListener = </span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+var doTestingListener =</span>
<a href="#l35.35"></a><span id="l35.35"> {</span>
<a href="#l35.36"></a><span id="l35.36">   onMessageClassified: function(aMsgURI, aClassification, aJunkPercent)</span>
<a href="#l35.37"></a><span id="l35.37">   {</span>
<a href="#l35.38"></a><span id="l35.38">     // Do we have more training emails? If so, train</span>
<a href="#l35.39"></a><span id="l35.39">     var email = emails.shift();</span>
<a href="#l35.40"></a><span id="l35.40">     if (email)</span>
<a href="#l35.41"></a><span id="l35.41">     {</span>
<a href="#l35.42"></a><span id="l35.42">       MailServices.junk.setMessageClassification(getSpec(email.fileName),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug428427.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug428427.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -19,28 +19,28 @@ var hdrs = [];</span>
<a href="#l36.4"></a><span id="l36.4"> var messageCount = 5;</span>
<a href="#l36.5"></a><span id="l36.5"> </span>
<a href="#l36.6"></a><span id="l36.6"> // tag used with test messages</span>
<a href="#l36.7"></a><span id="l36.7"> var tag1 = &quot;istag&quot;;</span>
<a href="#l36.8"></a><span id="l36.8"> </span>
<a href="#l36.9"></a><span id="l36.9"> function run_test()</span>
<a href="#l36.10"></a><span id="l36.10"> {</span>
<a href="#l36.11"></a><span id="l36.11">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-    </span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+</span>
<a href="#l36.14"></a><span id="l36.14">   // Get messageCount messages into the local filestore.</span>
<a href="#l36.15"></a><span id="l36.15">   do_test_pending();</span>
<a href="#l36.16"></a><span id="l36.16"> </span>
<a href="#l36.17"></a><span id="l36.17">   // function setupVirtualFolder() continues the testing after CopyFileMessage.</span>
<a href="#l36.18"></a><span id="l36.18">   MailServices.copy.CopyFileMessage(bugmail1, localAccountUtils.inboxFolder, null, false,</span>
<a href="#l36.19"></a><span id="l36.19">                                     0, &quot;&quot;, copyListener, null);</span>
<a href="#l36.20"></a><span id="l36.20">   return true;</span>
<a href="#l36.21"></a><span id="l36.21"> }</span>
<a href="#l36.22"></a><span id="l36.22"> </span>
<a href="#l36.23"></a><span id="l36.23"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l36.24"></a><span id="l36.24" class="difflineminus">-var copyListener = </span>
<a href="#l36.25"></a><span id="l36.25" class="difflineplus">+var copyListener =</span>
<a href="#l36.26"></a><span id="l36.26"> {</span>
<a href="#l36.27"></a><span id="l36.27">   OnStartCopy: function() {},</span>
<a href="#l36.28"></a><span id="l36.28">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l36.29"></a><span id="l36.29">   SetMessageKey: function(aKey)</span>
<a href="#l36.30"></a><span id="l36.30">   {</span>
<a href="#l36.31"></a><span id="l36.31">     hdrs.push(localAccountUtils.inboxFolder.GetMessageHeader(aKey));</span>
<a href="#l36.32"></a><span id="l36.32">   },</span>
<a href="#l36.33"></a><span id="l36.33">   SetMessageId: function(aMessageId) {},</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineat">@@ -53,25 +53,25 @@ var copyListener =</span>
<a href="#l36.35"></a><span id="l36.35">       try {</span>
<a href="#l36.36"></a><span id="l36.36">       setupVirtualFolder();</span>
<a href="#l36.37"></a><span id="l36.37">       } catch (ex) {dump(ex);}</span>
<a href="#l36.38"></a><span id="l36.38">     }</span>
<a href="#l36.39"></a><span id="l36.39">   }</span>
<a href="#l36.40"></a><span id="l36.40"> };</span>
<a href="#l36.41"></a><span id="l36.41"> </span>
<a href="#l36.42"></a><span id="l36.42"> var virtualFolder;</span>
<a href="#l36.43"></a><span id="l36.43" class="difflineminus">-var numTotalMessages; </span>
<a href="#l36.44"></a><span id="l36.44" class="difflineplus">+var numTotalMessages;</span>
<a href="#l36.45"></a><span id="l36.45"> var numUnreadMessages;</span>
<a href="#l36.46"></a><span id="l36.46"> </span>
<a href="#l36.47"></a><span id="l36.47"> // virtual folder setup</span>
<a href="#l36.48"></a><span id="l36.48"> function setupVirtualFolder()</span>
<a href="#l36.49"></a><span id="l36.49"> {</span>
<a href="#l36.50"></a><span id="l36.50">   // add as valid tag tag1, though probably not really necessary</span>
<a href="#l36.51"></a><span id="l36.51">   MailServices.tags.addTagForKey(tag1, tag1, null, null);</span>
<a href="#l36.52"></a><span id="l36.52" class="difflineminus">-  </span>
<a href="#l36.53"></a><span id="l36.53" class="difflineplus">+</span>
<a href="#l36.54"></a><span id="l36.54">   // add tag1 to 4 messages</span>
<a href="#l36.55"></a><span id="l36.55">   var messages0to3 = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l36.56"></a><span id="l36.56">   for (var i = 0; i &lt;= 3; i++)</span>
<a href="#l36.57"></a><span id="l36.57">     messages0to3.appendElement(hdrs[i]);</span>
<a href="#l36.58"></a><span id="l36.58">   localAccountUtils.inboxFolder.addKeywordsToMessages(messages0to3, tag1);</span>
<a href="#l36.59"></a><span id="l36.59"> </span>
<a href="#l36.60"></a><span id="l36.60">   // set 3 messages unread, 2 messages read</span>
<a href="#l36.61"></a><span id="l36.61">   var messages0to2 = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineat">@@ -82,85 +82,85 @@ function setupVirtualFolder()</span>
<a href="#l36.63"></a><span id="l36.63">   var messages3to4 = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l36.64"></a><span id="l36.64">   for (i = 3; i &lt;= 4; i++)</span>
<a href="#l36.65"></a><span id="l36.65">     messages3to4.appendElement(hdrs[i]);</span>
<a href="#l36.66"></a><span id="l36.66">   localAccountUtils.inboxFolder.markMessagesRead(messages3to4, true);</span>
<a href="#l36.67"></a><span id="l36.67"> </span>
<a href="#l36.68"></a><span id="l36.68">   // search will look for tag tag1 in the inbox folder</span>
<a href="#l36.69"></a><span id="l36.69">   var searchTerm = makeSearchTerm(localAccountUtils.inboxFolder, tag1,</span>
<a href="#l36.70"></a><span id="l36.70">     Ci.nsMsgSearchAttrib.Keywords, Ci.nsMsgSearchOp.Contains);</span>
<a href="#l36.71"></a><span id="l36.71" class="difflineminus">-    </span>
<a href="#l36.72"></a><span id="l36.72" class="difflineplus">+</span>
<a href="#l36.73"></a><span id="l36.73">   dump(&quot;creating virtual folder\n&quot;);</span>
<a href="#l36.74"></a><span id="l36.74">   var rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l36.75"></a><span id="l36.75">   virtualFolder = CreateVirtualFolder(&quot;VfTest&quot;, rootFolder,</span>
<a href="#l36.76"></a><span id="l36.76">                                       localAccountUtils.inboxFolder.URI, searchTerm, false);</span>
<a href="#l36.77"></a><span id="l36.77">   var count= new Object;</span>
<a href="#l36.78"></a><span id="l36.78">   // Setup search session. Execution continues with testVirtualFolder()</span>
<a href="#l36.79"></a><span id="l36.79">   // after search is done.</span>
<a href="#l36.80"></a><span id="l36.80" class="difflineminus">-  </span>
<a href="#l36.81"></a><span id="l36.81" class="difflineplus">+</span>
<a href="#l36.82"></a><span id="l36.82">   var searchSession = Cc[&quot;@mozilla.org/messenger/searchSession;1&quot;]</span>
<a href="#l36.83"></a><span id="l36.83">                         .createInstance(Ci.nsIMsgSearchSession);</span>
<a href="#l36.84"></a><span id="l36.84">   searchSession.addScopeTerm(Ci.nsMsgSearchScope.offlineMail,</span>
<a href="#l36.85"></a><span id="l36.85">                              localAccountUtils.inboxFolder);</span>
<a href="#l36.86"></a><span id="l36.86">   searchSession.appendTerm(searchTerm, false);</span>
<a href="#l36.87"></a><span id="l36.87">   searchSession.registerListener(searchListener);</span>
<a href="#l36.88"></a><span id="l36.88">   dump(&quot;starting search of vf\n&quot;);</span>
<a href="#l36.89"></a><span id="l36.89">   searchSession.search(null);</span>
<a href="#l36.90"></a><span id="l36.90"> }</span>
<a href="#l36.91"></a><span id="l36.91"> </span>
<a href="#l36.92"></a><span id="l36.92"> // partially based on gSearchNotificationListener in searchBar.js</span>
<a href="#l36.93"></a><span id="l36.93"> // nsIMsgSearchNotify implementation</span>
<a href="#l36.94"></a><span id="l36.94"> var searchListener =</span>
<a href="#l36.95"></a><span id="l36.95" class="difflineminus">-{ </span>
<a href="#l36.96"></a><span id="l36.96" class="difflineminus">-  onNewSearch: function() </span>
<a href="#l36.97"></a><span id="l36.97" class="difflineplus">+{</span>
<a href="#l36.98"></a><span id="l36.98" class="difflineplus">+  onNewSearch: function()</span>
<a href="#l36.99"></a><span id="l36.99">   {</span>
<a href="#l36.100"></a><span id="l36.100">     dump(&quot;in onnewsearch\n&quot;);</span>
<a href="#l36.101"></a><span id="l36.101">     numTotalMessages = 0;</span>
<a href="#l36.102"></a><span id="l36.102">     numUnreadMessages = 0;</span>
<a href="#l36.103"></a><span id="l36.103">   },</span>
<a href="#l36.104"></a><span id="l36.104">   onSearchHit: function(dbHdr, folder)</span>
<a href="#l36.105"></a><span id="l36.105">   {</span>
<a href="#l36.106"></a><span id="l36.106">     print(&quot;Search hit, isRead is &quot; + dbHdr.isRead);</span>
<a href="#l36.107"></a><span id="l36.107">     numTotalMessages++;</span>
<a href="#l36.108"></a><span id="l36.108">     if (!dbHdr.isRead)</span>
<a href="#l36.109"></a><span id="l36.109">       numUnreadMessages++;</span>
<a href="#l36.110"></a><span id="l36.110">   },</span>
<a href="#l36.111"></a><span id="l36.111">   onSearchDone: function(status)</span>
<a href="#l36.112"></a><span id="l36.112" class="difflineminus">-  { </span>
<a href="#l36.113"></a><span id="l36.113" class="difflineplus">+  {</span>
<a href="#l36.114"></a><span id="l36.114">     print(&quot;Finished search hitCount = &quot; + numTotalMessages);</span>
<a href="#l36.115"></a><span id="l36.115">     var db = virtualFolder.msgDatabase;</span>
<a href="#l36.116"></a><span id="l36.116">     var dbFolderInfo = db.dBFolderInfo;</span>
<a href="#l36.117"></a><span id="l36.117">     dbFolderInfo.numMessages = numTotalMessages;</span>
<a href="#l36.118"></a><span id="l36.118">     dbFolderInfo.numUnreadMessages = numUnreadMessages;</span>
<a href="#l36.119"></a><span id="l36.119">     virtualFolder.updateSummaryTotals(true);</span>
<a href="#l36.120"></a><span id="l36.120">     print(&quot;virtual folder unread is &quot; + virtualFolder.getNumUnread(false));</span>
<a href="#l36.121"></a><span id="l36.121">     testVirtualFolder();</span>
<a href="#l36.122"></a><span id="l36.122">   }</span>
<a href="#l36.123"></a><span id="l36.123"> };</span>
<a href="#l36.124"></a><span id="l36.124"> </span>
<a href="#l36.125"></a><span id="l36.125"> function testVirtualFolder()</span>
<a href="#l36.126"></a><span id="l36.126"> {</span>
<a href="#l36.127"></a><span id="l36.127">   /*** basic functionality tests ***/</span>
<a href="#l36.128"></a><span id="l36.128" class="difflineminus">-  </span>
<a href="#l36.129"></a><span id="l36.129" class="difflineplus">+</span>
<a href="#l36.130"></a><span id="l36.130">   // total messages matching search</span>
<a href="#l36.131"></a><span id="l36.131">   Assert.equal(4, virtualFolder.getTotalMessages(false));</span>
<a href="#l36.132"></a><span id="l36.132" class="difflineminus">-  </span>
<a href="#l36.133"></a><span id="l36.133" class="difflineplus">+</span>
<a href="#l36.134"></a><span id="l36.134">   // total unread messages in search</span>
<a href="#l36.135"></a><span id="l36.135">   Assert.equal(3, virtualFolder.getNumUnread(false));</span>
<a href="#l36.136"></a><span id="l36.136"> </span>
<a href="#l36.137"></a><span id="l36.137">   // change unread of one item in search to decrease count</span>
<a href="#l36.138"></a><span id="l36.138">   var message0 = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l36.139"></a><span id="l36.139">   message0.appendElement(hdrs[0]);</span>
<a href="#l36.140"></a><span id="l36.140">   localAccountUtils.inboxFolder.markMessagesRead(message0, true);</span>
<a href="#l36.141"></a><span id="l36.141">   virtualFolder.updateSummaryTotals(true);</span>
<a href="#l36.142"></a><span id="l36.142"> </span>
<a href="#l36.143"></a><span id="l36.143">   Assert.equal(2, virtualFolder.getNumUnread(false));</span>
<a href="#l36.144"></a><span id="l36.144" class="difflineminus">-  </span>
<a href="#l36.145"></a><span id="l36.145" class="difflineplus">+</span>
<a href="#l36.146"></a><span id="l36.146">   /*** failures fixed in this bug ***/</span>
<a href="#l36.147"></a><span id="l36.147" class="difflineminus">-   </span>
<a href="#l36.148"></a><span id="l36.148" class="difflineplus">+</span>
<a href="#l36.149"></a><span id="l36.149">   // remove tag from one item to decrease count</span>
<a href="#l36.150"></a><span id="l36.150">   var message1 = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l36.151"></a><span id="l36.151">   message1.appendElement(hdrs[1]);</span>
<a href="#l36.152"></a><span id="l36.152"> </span>
<a href="#l36.153"></a><span id="l36.153">   localAccountUtils.inboxFolder.removeKeywordsFromMessages(message1, tag1);</span>
<a href="#l36.154"></a><span id="l36.154">   virtualFolder.updateSummaryTotals(true);</span>
<a href="#l36.155"></a><span id="l36.155">   Assert.equal(3, virtualFolder.getTotalMessages(false));</span>
<a href="#l36.156"></a><span id="l36.156">   Assert.equal(1, virtualFolder.getNumUnread(false));</span>
<a href="#l36.157"></a><span id="l36.157" class="difflineat">@@ -177,17 +177,17 @@ function testVirtualFolder()</span>
<a href="#l36.158"></a><span id="l36.158"> // adapted from commandglue.js</span>
<a href="#l36.159"></a><span id="l36.159"> function CreateVirtualFolder(newName, parentFolder, searchFolderURIs, searchTerm, searchOnline)</span>
<a href="#l36.160"></a><span id="l36.160"> {</span>
<a href="#l36.161"></a><span id="l36.161">   var newFolder = parentFolder.addSubfolder(newName);</span>
<a href="#l36.162"></a><span id="l36.162">   newFolder.setFlag(Ci.nsMsgFolderFlags.Virtual);</span>
<a href="#l36.163"></a><span id="l36.163">   var vfdb = newFolder.msgDatabase;</span>
<a href="#l36.164"></a><span id="l36.164">   var searchTerms = [];</span>
<a href="#l36.165"></a><span id="l36.165">   var searchTermString = getSearchTermString(searchTerm);</span>
<a href="#l36.166"></a><span id="l36.166" class="difflineminus">-  </span>
<a href="#l36.167"></a><span id="l36.167" class="difflineplus">+</span>
<a href="#l36.168"></a><span id="l36.168">   var dbFolderInfo = vfdb.dBFolderInfo;</span>
<a href="#l36.169"></a><span id="l36.169">   // set the view string as a property of the db folder info</span>
<a href="#l36.170"></a><span id="l36.170">   // set the original folder name as well.</span>
<a href="#l36.171"></a><span id="l36.171">   dbFolderInfo.setCharProperty(&quot;searchStr&quot;, searchTermString);</span>
<a href="#l36.172"></a><span id="l36.172">   dbFolderInfo.setCharProperty(&quot;searchFolderUri&quot;, searchFolderURIs);</span>
<a href="#l36.173"></a><span id="l36.173">   dbFolderInfo.setBooleanProperty(&quot;searchOnline&quot;, searchOnline);</span>
<a href="#l36.174"></a><span id="l36.174">   // This fails because the folder doesn't exist - why were we doing it?</span>
<a href="#l36.175"></a><span id="l36.175">   //  vfdb.summaryValid = true;</span>
<a href="#l36.176"></a><span id="l36.176" class="difflineat">@@ -197,20 +197,20 @@ function CreateVirtualFolder(newName, pa</span>
<a href="#l36.177"></a><span id="l36.177">   //print(acctMgr);</span>
<a href="#l36.178"></a><span id="l36.178">   acctMgr.OnItemAdded(null, newFolder);</span>
<a href="#l36.179"></a><span id="l36.179">   return newFolder;</span>
<a href="#l36.180"></a><span id="l36.180"> }</span>
<a href="#l36.181"></a><span id="l36.181"> </span>
<a href="#l36.182"></a><span id="l36.182"> function getSearchTermString(term)</span>
<a href="#l36.183"></a><span id="l36.183"> {</span>
<a href="#l36.184"></a><span id="l36.184">   var condition = &quot;&quot;;</span>
<a href="#l36.185"></a><span id="l36.185" class="difflineminus">-  </span>
<a href="#l36.186"></a><span id="l36.186" class="difflineplus">+</span>
<a href="#l36.187"></a><span id="l36.187">   if (condition.length &gt; 1)</span>
<a href="#l36.188"></a><span id="l36.188">     condition += ' ';</span>
<a href="#l36.189"></a><span id="l36.189" class="difflineminus">-  </span>
<a href="#l36.190"></a><span id="l36.190" class="difflineplus">+</span>
<a href="#l36.191"></a><span id="l36.191">   if (term.matchAll)</span>
<a href="#l36.192"></a><span id="l36.192">     condition = &quot;ALL&quot;;</span>
<a href="#l36.193"></a><span id="l36.193">   condition += (term.booleanAnd) ? &quot;AND (&quot; : &quot;OR (&quot;;</span>
<a href="#l36.194"></a><span id="l36.194">   condition += term.termAsString + ')';</span>
<a href="#l36.195"></a><span id="l36.195">   return condition;</span>
<a href="#l36.196"></a><span id="l36.196"> }</span>
<a href="#l36.197"></a><span id="l36.197"> </span>
<a href="#l36.198"></a><span id="l36.198"> // Create a search term for searching aFolder</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug434810.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug434810.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l37.4"></a><span id="l37.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l37.5"></a><span id="l37.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l37.6"></a><span id="l37.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l37.7"></a><span id="l37.7" class="difflineminus">- </span>
<a href="#l37.8"></a><span id="l37.8" class="difflineplus">+</span>
<a href="#l37.9"></a><span id="l37.9"> // Test of setup of localMailFolders</span>
<a href="#l37.10"></a><span id="l37.10"> </span>
<a href="#l37.11"></a><span id="l37.11"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l37.12"></a><span id="l37.12"> </span>
<a href="#l37.13"></a><span id="l37.13"> function run_test()</span>
<a href="#l37.14"></a><span id="l37.14"> {</span>
<a href="#l37.15"></a><span id="l37.15">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l37.16"></a><span id="l37.16"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug465805.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug465805.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -15,17 +15,17 @@ var nsMsgSearchOp = Ci.nsMsgSearchOp;</span>
<a href="#l38.4"></a><span id="l38.4"> </span>
<a href="#l38.5"></a><span id="l38.5"> var Contains = nsMsgSearchOp.Contains;</span>
<a href="#l38.6"></a><span id="l38.6"> </span>
<a href="#l38.7"></a><span id="l38.7"> var offlineMail = nsMsgSearchScope.offlineMail;</span>
<a href="#l38.8"></a><span id="l38.8"> var offlineMailFilter = nsMsgSearchScope.offlineMailFilter;</span>
<a href="#l38.9"></a><span id="l38.9"> </span>
<a href="#l38.10"></a><span id="l38.10"> var Body = nsMsgSearchAttrib.Body;</span>
<a href="#l38.11"></a><span id="l38.11"> </span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-var Files = </span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+var Files =</span>
<a href="#l38.14"></a><span id="l38.14"> [</span>
<a href="#l38.15"></a><span id="l38.15">   &quot;../../../data/bugmail1&quot;,</span>
<a href="#l38.16"></a><span id="l38.16">   &quot;../../../data/bodySearchCrash&quot;</span>
<a href="#l38.17"></a><span id="l38.17"> ]</span>
<a href="#l38.18"></a><span id="l38.18"> </span>
<a href="#l38.19"></a><span id="l38.19"> var Tests =</span>
<a href="#l38.20"></a><span id="l38.20"> [</span>
<a href="#l38.21"></a><span id="l38.21"> </span>
<a href="#l38.22"></a><span id="l38.22" class="difflineat">@@ -42,27 +42,27 @@ function run_test()</span>
<a href="#l38.23"></a><span id="l38.23">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l38.24"></a><span id="l38.24"> </span>
<a href="#l38.25"></a><span id="l38.25">   // Get a message into the local filestore. function testBodySearch() continues the testing after the copy.</span>
<a href="#l38.26"></a><span id="l38.26">   do_test_pending();</span>
<a href="#l38.27"></a><span id="l38.27">   copyListener.OnStopCopy(null);</span>
<a href="#l38.28"></a><span id="l38.28">   return true;</span>
<a href="#l38.29"></a><span id="l38.29"> }</span>
<a href="#l38.30"></a><span id="l38.30"> </span>
<a href="#l38.31"></a><span id="l38.31" class="difflineminus">-var copyListener = </span>
<a href="#l38.32"></a><span id="l38.32" class="difflineplus">+var copyListener =</span>
<a href="#l38.33"></a><span id="l38.33"> {</span>
<a href="#l38.34"></a><span id="l38.34">   OnStartCopy: function() {},</span>
<a href="#l38.35"></a><span id="l38.35">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l38.36"></a><span id="l38.36">   SetMessageKey: function(aKey) {},</span>
<a href="#l38.37"></a><span id="l38.37">   SetMessageId: function(aMessageId) {},</span>
<a href="#l38.38"></a><span id="l38.38" class="difflineminus">-  OnStopCopy: function(aStatus) </span>
<a href="#l38.39"></a><span id="l38.39" class="difflineplus">+  OnStopCopy: function(aStatus)</span>
<a href="#l38.40"></a><span id="l38.40">   {</span>
<a href="#l38.41"></a><span id="l38.41">     let fileName = Files.shift();</span>
<a href="#l38.42"></a><span id="l38.42">     if (fileName)</span>
<a href="#l38.43"></a><span id="l38.43" class="difflineminus">-    { </span>
<a href="#l38.44"></a><span id="l38.44" class="difflineplus">+    {</span>
<a href="#l38.45"></a><span id="l38.45">       let file = do_get_file(fileName);</span>
<a href="#l38.46"></a><span id="l38.46">       MailServices.copy.CopyFileMessage(file, localAccountUtils.inboxFolder, null,</span>
<a href="#l38.47"></a><span id="l38.47">                                         false, 0, &quot;&quot;, copyListener, null);</span>
<a href="#l38.48"></a><span id="l38.48">     }</span>
<a href="#l38.49"></a><span id="l38.49">     else</span>
<a href="#l38.50"></a><span id="l38.50">       testBodySearch();</span>
<a href="#l38.51"></a><span id="l38.51">   }</span>
<a href="#l38.52"></a><span id="l38.52"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug471682.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug471682.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -30,17 +30,17 @@ function run_test()</span>
<a href="#l39.4"></a><span id="l39.4">   MailServices.copy.CopyFileMessage(bugmail1, localAccountUtils.inboxFolder, null,</span>
<a href="#l39.5"></a><span id="l39.5">                                     false, 0, &quot;&quot;, step2, null);</span>
<a href="#l39.6"></a><span id="l39.6">   return;</span>
<a href="#l39.7"></a><span id="l39.7"> }</span>
<a href="#l39.8"></a><span id="l39.8"> </span>
<a href="#l39.9"></a><span id="l39.9"> // step 2: copy one message into a subfolder to establish an</span>
<a href="#l39.10"></a><span id="l39.10"> //         mbox file time and size</span>
<a href="#l39.11"></a><span id="l39.11"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-var step2 = </span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+var step2 =</span>
<a href="#l39.14"></a><span id="l39.14"> {</span>
<a href="#l39.15"></a><span id="l39.15">   OnStartCopy: function() {},</span>
<a href="#l39.16"></a><span id="l39.16">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l39.17"></a><span id="l39.17">   SetMessageKey: function(aKey)</span>
<a href="#l39.18"></a><span id="l39.18">   {</span>
<a href="#l39.19"></a><span id="l39.19">     dump(&quot;in set message key\n&quot;);</span>
<a href="#l39.20"></a><span id="l39.20">     gHdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l39.21"></a><span id="l39.21">   },</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineat">@@ -54,17 +54,17 @@ var step2 =</span>
<a href="#l39.23"></a><span id="l39.23">     MailServices.copy.CopyMessages(localAccountUtils.inboxFolder, messages, gSubfolder,</span>
<a href="#l39.24"></a><span id="l39.24">                                    false, step3, null, false);</span>
<a href="#l39.25"></a><span id="l39.25">   }</span>
<a href="#l39.26"></a><span id="l39.26"> };</span>
<a href="#l39.27"></a><span id="l39.27"> </span>
<a href="#l39.28"></a><span id="l39.28"> // step 3: after the copy, delay to allow copy to complete and allow possible</span>
<a href="#l39.29"></a><span id="l39.29"> //         file error time</span>
<a href="#l39.30"></a><span id="l39.30"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-var step3 = </span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+var step3 =</span>
<a href="#l39.33"></a><span id="l39.33"> {</span>
<a href="#l39.34"></a><span id="l39.34">   OnStartCopy: function() {},</span>
<a href="#l39.35"></a><span id="l39.35">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l39.36"></a><span id="l39.36">   SetMessageKey: function(aKey) {},</span>
<a href="#l39.37"></a><span id="l39.37">   SetMessageId: function(aMessageId) {},</span>
<a href="#l39.38"></a><span id="l39.38">   OnStopCopy: function(aStatus)</span>
<a href="#l39.39"></a><span id="l39.39">   {</span>
<a href="#l39.40"></a><span id="l39.40">     do_timeout(2000, step4);</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineat">@@ -77,17 +77,17 @@ function step4()</span>
<a href="#l39.42"></a><span id="l39.42">   var messages = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l39.43"></a><span id="l39.43">   messages.appendElement(gHdr);</span>
<a href="#l39.44"></a><span id="l39.44">   MailServices.copy.CopyMessages(localAccountUtils.inboxFolder, messages, gSubfolder,</span>
<a href="#l39.45"></a><span id="l39.45">                                  false, step5, null, false);</span>
<a href="#l39.46"></a><span id="l39.46"> }</span>
<a href="#l39.47"></a><span id="l39.47"> </span>
<a href="#l39.48"></a><span id="l39.48"> // step 5:  actual tests of file size and date</span>
<a href="#l39.49"></a><span id="l39.49"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l39.50"></a><span id="l39.50" class="difflineminus">-var step5 = </span>
<a href="#l39.51"></a><span id="l39.51" class="difflineplus">+var step5 =</span>
<a href="#l39.52"></a><span id="l39.52"> {</span>
<a href="#l39.53"></a><span id="l39.53">   OnStartCopy: function() {},</span>
<a href="#l39.54"></a><span id="l39.54">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l39.55"></a><span id="l39.55">   SetMessageKey: function(aKey) {},</span>
<a href="#l39.56"></a><span id="l39.56">   SetMessageId: function(aMessageId) {},</span>
<a href="#l39.57"></a><span id="l39.57">   OnStopCopy: function(aStatus)</span>
<a href="#l39.58"></a><span id="l39.58">   {</span>
<a href="#l39.59"></a><span id="l39.59">     var dbSize = gSubfolder.msgDatabase.dBFolderInfo.folderSize;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mailnews/base/test/unit/test_bug514945.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_bug514945.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -1,18 +1,18 @@</span>
<a href="#l40.4"></a><span id="l40.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l40.5"></a><span id="l40.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l40.6"></a><span id="l40.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l40.7"></a><span id="l40.7"> </span>
<a href="#l40.8"></a><span id="l40.8"> /*</span>
<a href="#l40.9"></a><span id="l40.9">  * Testing of GetAvailable crashes in bug 514945</span>
<a href="#l40.10"></a><span id="l40.10">  */</span>
<a href="#l40.11"></a><span id="l40.11" class="difflineminus">- </span>
<a href="#l40.12"></a><span id="l40.12" class="difflineplus">+</span>
<a href="#l40.13"></a><span id="l40.13"> function run_test()</span>
<a href="#l40.14"></a><span id="l40.14" class="difflineminus">-{ </span>
<a href="#l40.15"></a><span id="l40.15" class="difflineplus">+{</span>
<a href="#l40.16"></a><span id="l40.16">   const kValidityManager = Cc['@mozilla.org/mail/search/validityManager;1']</span>
<a href="#l40.17"></a><span id="l40.17">                              .getService(Ci.nsIMsgSearchValidityManager);</span>
<a href="#l40.18"></a><span id="l40.18"> </span>
<a href="#l40.19"></a><span id="l40.19">   let validityTable = kValidityManager.getTable(Ci.nsMsgSearchScope.offlineMail);</span>
<a href="#l40.20"></a><span id="l40.20"> </span>
<a href="#l40.21"></a><span id="l40.21">   // When we try to access a bad value of getAvailable, it should give an error,</span>
<a href="#l40.22"></a><span id="l40.22">   //  not crash.</span>
<a href="#l40.23"></a><span id="l40.23">   let BAD_VALUE = 1000000; // some large value that is beyond the array bounds</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mailnews/base/test/unit/test_compactColumnSave.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_compactColumnSave.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -52,17 +52,17 @@ function checkPersistentState(folder) {</span>
<a href="#l41.4"></a><span id="l41.4">   let dbFolderInfo = msgDatabase.dBFolderInfo;</span>
<a href="#l41.5"></a><span id="l41.5">   let state = dbFolderInfo.getCharProperty(this.PERSISTED_COLUMN_PROPERTY_NAME);</span>
<a href="#l41.6"></a><span id="l41.6">   Assert.equal(state, columnJSON);</span>
<a href="#l41.7"></a><span id="l41.7">   do_timeout(0, function(){doTest(++gCurTestNum);});</span>
<a href="#l41.8"></a><span id="l41.8"> }</span>
<a href="#l41.9"></a><span id="l41.9"> </span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-var copyListener = </span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+var copyListener =</span>
<a href="#l41.14"></a><span id="l41.14"> {</span>
<a href="#l41.15"></a><span id="l41.15">   OnStartCopy: function() {},</span>
<a href="#l41.16"></a><span id="l41.16">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l41.17"></a><span id="l41.17">   SetMessageKey: function(aKey)</span>
<a href="#l41.18"></a><span id="l41.18">   {</span>
<a href="#l41.19"></a><span id="l41.19">     try {</span>
<a href="#l41.20"></a><span id="l41.20">       let hdr = gLocalFolder2.GetMessageHeader(aKey);</span>
<a href="#l41.21"></a><span id="l41.21">       gMsgHdrs.push({hdr: hdr, ID: hdr.messageId});</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineat">@@ -105,17 +105,17 @@ function copyFileMessage(file, destFolde</span>
<a href="#l41.23"></a><span id="l41.23"> }</span>
<a href="#l41.24"></a><span id="l41.24"> </span>
<a href="#l41.25"></a><span id="l41.25"> function deleteMessages(srcFolder, items)</span>
<a href="#l41.26"></a><span id="l41.26"> {</span>
<a href="#l41.27"></a><span id="l41.27">   var array = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l41.28"></a><span id="l41.28">   items.forEach(function (item) {</span>
<a href="#l41.29"></a><span id="l41.29">     array.appendElement(item);</span>
<a href="#l41.30"></a><span id="l41.30">   });</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineminus">-  </span>
<a href="#l41.32"></a><span id="l41.32" class="difflineplus">+</span>
<a href="#l41.33"></a><span id="l41.33">   srcFolder.deleteMessages(array, null, false, true, copyListener, true);</span>
<a href="#l41.34"></a><span id="l41.34"> }</span>
<a href="#l41.35"></a><span id="l41.35"> </span>
<a href="#l41.36"></a><span id="l41.36"> /*</span>
<a href="#l41.37"></a><span id="l41.37">  * TESTS</span>
<a href="#l41.38"></a><span id="l41.38">  */</span>
<a href="#l41.39"></a><span id="l41.39"> </span>
<a href="#l41.40"></a><span id="l41.40"> // Beware before commenting out a test -- later tests might just depend on earlier ones</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mailnews/base/test/unit/test_copyChaining.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_copyChaining.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -91,17 +91,17 @@ function endTest()</span>
<a href="#l42.4"></a><span id="l42.4"> {</span>
<a href="#l42.5"></a><span id="l42.5">   // Cleanup, null out everything</span>
<a href="#l42.6"></a><span id="l42.6">   dump(&quot; Exiting mail tests\n&quot;);</span>
<a href="#l42.7"></a><span id="l42.7">   gMsgEnumerator = null;</span>
<a href="#l42.8"></a><span id="l42.8">   do_test_finished(); // for the one in run_test()</span>
<a href="#l42.9"></a><span id="l42.9"> }</span>
<a href="#l42.10"></a><span id="l42.10"> </span>
<a href="#l42.11"></a><span id="l42.11"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-var copyListener = </span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+var copyListener =</span>
<a href="#l42.14"></a><span id="l42.14"> {</span>
<a href="#l42.15"></a><span id="l42.15">   OnStartCopy: function() {},</span>
<a href="#l42.16"></a><span id="l42.16">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l42.17"></a><span id="l42.17">   SetMessageKey: function(aKey) {},</span>
<a href="#l42.18"></a><span id="l42.18">   SetMessageId: function(aMessageId) {},</span>
<a href="#l42.19"></a><span id="l42.19">   OnStopCopy: function(aStatus)</span>
<a href="#l42.20"></a><span id="l42.20">   {</span>
<a href="#l42.21"></a><span id="l42.21">     // Check: message successfully copied.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mailnews/base/test/unit/test_emptyTrash.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_emptyTrash.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -23,17 +23,17 @@ var gLocalTrashFolder;</span>
<a href="#l43.4"></a><span id="l43.4"> var gCurTestNum;</span>
<a href="#l43.5"></a><span id="l43.5"> var gMsgHdrs = new Array();</span>
<a href="#l43.6"></a><span id="l43.6"> var gRootFolder;</span>
<a href="#l43.7"></a><span id="l43.7"> </span>
<a href="#l43.8"></a><span id="l43.8"> var nsIMFNService = Ci.nsIMsgFolderNotificationService;</span>
<a href="#l43.9"></a><span id="l43.9"> var nsIMFListener = Ci.nsIMsgFolderListener;</span>
<a href="#l43.10"></a><span id="l43.10"> </span>
<a href="#l43.11"></a><span id="l43.11"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-var copyListener = </span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+var copyListener =</span>
<a href="#l43.14"></a><span id="l43.14"> {</span>
<a href="#l43.15"></a><span id="l43.15">   OnStartCopy: function() {},</span>
<a href="#l43.16"></a><span id="l43.16">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l43.17"></a><span id="l43.17">   SetMessageKey: function(aKey)</span>
<a href="#l43.18"></a><span id="l43.18">   {</span>
<a href="#l43.19"></a><span id="l43.19">     let hdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l43.20"></a><span id="l43.20">     gMsgHdrs.push({hdr: hdr, ID: hdr.messageId});</span>
<a href="#l43.21"></a><span id="l43.21">   },</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineat">@@ -71,17 +71,17 @@ function copyFileMessage(file, destFolde</span>
<a href="#l43.23"></a><span id="l43.23"> }</span>
<a href="#l43.24"></a><span id="l43.24"> </span>
<a href="#l43.25"></a><span id="l43.25"> function deleteMessages(srcFolder, items)</span>
<a href="#l43.26"></a><span id="l43.26"> {</span>
<a href="#l43.27"></a><span id="l43.27">   var array = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l43.28"></a><span id="l43.28">   items.forEach(function (item) {</span>
<a href="#l43.29"></a><span id="l43.29">     array.appendElement(item);</span>
<a href="#l43.30"></a><span id="l43.30">   });</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineminus">-  </span>
<a href="#l43.32"></a><span id="l43.32" class="difflineplus">+</span>
<a href="#l43.33"></a><span id="l43.33">   srcFolder.deleteMessages(array, null, false, true, copyListener, true);</span>
<a href="#l43.34"></a><span id="l43.34"> }</span>
<a href="#l43.35"></a><span id="l43.35"> </span>
<a href="#l43.36"></a><span id="l43.36"> /*</span>
<a href="#l43.37"></a><span id="l43.37">  * TESTS</span>
<a href="#l43.38"></a><span id="l43.38">  */</span>
<a href="#l43.39"></a><span id="l43.39"> </span>
<a href="#l43.40"></a><span id="l43.40"> // Beware before commenting out a test -- later tests might just depend on earlier ones</span>
<a href="#l43.41"></a><span id="l43.41" class="difflineat">@@ -148,17 +148,17 @@ function run_test()</span>
<a href="#l43.42"></a><span id="l43.42">   doTest(1);</span>
<a href="#l43.43"></a><span id="l43.43"> }</span>
<a href="#l43.44"></a><span id="l43.44"> </span>
<a href="#l43.45"></a><span id="l43.45"> function doTest(test)</span>
<a href="#l43.46"></a><span id="l43.46"> {</span>
<a href="#l43.47"></a><span id="l43.47">   if (test &lt;= gTestArray.length)</span>
<a href="#l43.48"></a><span id="l43.48">   {</span>
<a href="#l43.49"></a><span id="l43.49">     gCurTestNum = test;</span>
<a href="#l43.50"></a><span id="l43.50" class="difflineminus">-    </span>
<a href="#l43.51"></a><span id="l43.51" class="difflineplus">+</span>
<a href="#l43.52"></a><span id="l43.52">     var testFn = gTestArray[test-1];</span>
<a href="#l43.53"></a><span id="l43.53">     // Set a limit of three seconds; if the notifications haven't arrived by then there's a problem.</span>
<a href="#l43.54"></a><span id="l43.54">     do_timeout(10000, function(){</span>
<a href="#l43.55"></a><span id="l43.55">         if (gCurTestNum == test)</span>
<a href="#l43.56"></a><span id="l43.56">           do_throw(&quot;Notifications not received in 10000 ms for operation &quot; + testFn.name);</span>
<a href="#l43.57"></a><span id="l43.57">         }</span>
<a href="#l43.58"></a><span id="l43.58">       );</span>
<a href="#l43.59"></a><span id="l43.59">     try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mailnews/base/test/unit/test_folderCompact.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_folderCompact.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -25,29 +25,29 @@ Services.prefs.setCharPref(&quot;mail.serverD</span>
<a href="#l44.4"></a><span id="l44.4"> var gMsgFile1, gMsgFile2, gMsgFile3;</span>
<a href="#l44.5"></a><span id="l44.5"> var gMsg1ID = &quot;200806061706.m56H6RWT004933@mrapp54.mozilla.org&quot;;</span>
<a href="#l44.6"></a><span id="l44.6"> var gMsg2ID = &quot;200804111417.m3BEHTk4030129@mrapp51.mozilla.org&quot;;</span>
<a href="#l44.7"></a><span id="l44.7"> var gMsg3ID = &quot;4849BF7B.2030800@example.com&quot;;</span>
<a href="#l44.8"></a><span id="l44.8"> var gLocalFolder2;</span>
<a href="#l44.9"></a><span id="l44.9"> var gLocalFolder3;</span>
<a href="#l44.10"></a><span id="l44.10"> var gLocalTrashFolder;</span>
<a href="#l44.11"></a><span id="l44.11"> var gCurTestNum;</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-// After a compact (or other operation), this is what we expect the </span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+// After a compact (or other operation), this is what we expect the</span>
<a href="#l44.14"></a><span id="l44.14"> // folder size to be.</span>
<a href="#l44.15"></a><span id="l44.15"> var gExpectedFolderSize;</span>
<a href="#l44.16"></a><span id="l44.16"> var gMsgHdrs = new Array();</span>
<a href="#l44.17"></a><span id="l44.17"> var gExpectedInboxSize;</span>
<a href="#l44.18"></a><span id="l44.18"> var gExpectedFolder2Size;</span>
<a href="#l44.19"></a><span id="l44.19"> var gExpectedFolder3Size;</span>
<a href="#l44.20"></a><span id="l44.20"> </span>
<a href="#l44.21"></a><span id="l44.21"> // Transfer message keys between function calls.</span>
<a href="#l44.22"></a><span id="l44.22"> var gMsgKeys = [];</span>
<a href="#l44.23"></a><span id="l44.23"> </span>
<a href="#l44.24"></a><span id="l44.24"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineminus">-var copyListenerWrap = </span>
<a href="#l44.26"></a><span id="l44.26" class="difflineplus">+var copyListenerWrap =</span>
<a href="#l44.27"></a><span id="l44.27"> {</span>
<a href="#l44.28"></a><span id="l44.28">   SetMessageKey: function(aKey)</span>
<a href="#l44.29"></a><span id="l44.29">   {</span>
<a href="#l44.30"></a><span id="l44.30">     let hdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l44.31"></a><span id="l44.31">     gMsgHdrs.push({hdr: hdr, ID: hdr.messageId});</span>
<a href="#l44.32"></a><span id="l44.32">   },</span>
<a href="#l44.33"></a><span id="l44.33">   OnStopCopy: function(aStatus)</span>
<a href="#l44.34"></a><span id="l44.34">   {</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineat">@@ -96,17 +96,17 @@ function copyMessages(items, isMove, src</span>
<a href="#l44.36"></a><span id="l44.36"> }</span>
<a href="#l44.37"></a><span id="l44.37"> </span>
<a href="#l44.38"></a><span id="l44.38"> function deleteMessages(srcFolder, items)</span>
<a href="#l44.39"></a><span id="l44.39"> {</span>
<a href="#l44.40"></a><span id="l44.40">   var array = Cc[&quot;@mozilla.org/array;1&quot;].createInstance(Ci.nsIMutableArray);</span>
<a href="#l44.41"></a><span id="l44.41">   items.forEach(function (item) {</span>
<a href="#l44.42"></a><span id="l44.42">     array.appendElement(item);</span>
<a href="#l44.43"></a><span id="l44.43">   });</span>
<a href="#l44.44"></a><span id="l44.44" class="difflineminus">-  </span>
<a href="#l44.45"></a><span id="l44.45" class="difflineplus">+</span>
<a href="#l44.46"></a><span id="l44.46">   let listener = new PromiseTestUtils.PromiseCopyListener(copyListenerWrap);</span>
<a href="#l44.47"></a><span id="l44.47">   srcFolder.deleteMessages(array, null, false, true, listener, true);</span>
<a href="#l44.48"></a><span id="l44.48">   return listener.promise;</span>
<a href="#l44.49"></a><span id="l44.49"> }</span>
<a href="#l44.50"></a><span id="l44.50"> </span>
<a href="#l44.51"></a><span id="l44.51"> function calculateFolderSize(folder)</span>
<a href="#l44.52"></a><span id="l44.52"> {</span>
<a href="#l44.53"></a><span id="l44.53">   let msgDB = folder.msgDatabase;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mailnews/base/test/unit/test_imapPump.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_imapPump.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l45.4"></a><span id="l45.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l45.5"></a><span id="l45.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l45.6"></a><span id="l45.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l45.7"></a><span id="l45.7"> </span>
<a href="#l45.8"></a><span id="l45.8"> /**</span>
<a href="#l45.9"></a><span id="l45.9">  * Simple demonstration of the imap pump test method.</span>
<a href="#l45.10"></a><span id="l45.10">  */</span>
<a href="#l45.11"></a><span id="l45.11"> </span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-// async support </span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+// async support</span>
<a href="#l45.14"></a><span id="l45.14"> load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l45.15"></a><span id="l45.15"> load(&quot;../../../resources/alertTestUtils.js&quot;);</span>
<a href="#l45.16"></a><span id="l45.16"> ChromeUtils.import(&quot;resource://testing-common/mailnews/PromiseTestUtils.jsm&quot;);</span>
<a href="#l45.17"></a><span id="l45.17"> </span>
<a href="#l45.18"></a><span id="l45.18"> // IMAP pump</span>
<a href="#l45.19"></a><span id="l45.19"> ChromeUtils.import(&quot;resource://testing-common/mailnews/IMAPpump.js&quot;);</span>
<a href="#l45.20"></a><span id="l45.20"> ChromeUtils.import(&quot;resource://testing-common/mailnews/imapd.js&quot;);</span>
<a href="#l45.21"></a><span id="l45.21"> </span>
<a href="#l45.22"></a><span id="l45.22" class="difflineat">@@ -21,17 +21,17 @@ ChromeUtils.import(&quot;resource://gre/modul</span>
<a href="#l45.23"></a><span id="l45.23"> </span>
<a href="#l45.24"></a><span id="l45.24"> // Messages to load must have CRLF line endings, that is Windows style</span>
<a href="#l45.25"></a><span id="l45.25"> var gMessage = &quot;bugmail10&quot;; // message file used as the test message</span>
<a href="#l45.26"></a><span id="l45.26"> </span>
<a href="#l45.27"></a><span id="l45.27"> // Definition of tests</span>
<a href="#l45.28"></a><span id="l45.28"> </span>
<a href="#l45.29"></a><span id="l45.29"> // load and update a message in the imap fake server</span>
<a href="#l45.30"></a><span id="l45.30"> </span>
<a href="#l45.31"></a><span id="l45.31" class="difflineminus">-var gTestArray = </span>
<a href="#l45.32"></a><span id="l45.32" class="difflineplus">+var gTestArray =</span>
<a href="#l45.33"></a><span id="l45.33"> [</span>
<a href="#l45.34"></a><span id="l45.34">   // initial setup of IMAP environment</span>
<a href="#l45.35"></a><span id="l45.35">   setupIMAPPump,</span>
<a href="#l45.36"></a><span id="l45.36"> </span>
<a href="#l45.37"></a><span id="l45.37">   // optionally set server parameters, here enabling debug messages</span>
<a href="#l45.38"></a><span id="l45.38">   function serverParms() {</span>
<a href="#l45.39"></a><span id="l45.39">     if (typeof fsDebugAll == &quot;undefined&quot;)</span>
<a href="#l45.40"></a><span id="l45.40">       ChromeUtils.import(&quot;resource://testing-common/mailnews/maild.js&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mailnews/base/test/unit/test_inheritedFolderProperties.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_inheritedFolderProperties.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -2,17 +2,17 @@</span>
<a href="#l46.4"></a><span id="l46.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l46.5"></a><span id="l46.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l46.6"></a><span id="l46.6"> </span>
<a href="#l46.7"></a><span id="l46.7"> /*</span>
<a href="#l46.8"></a><span id="l46.8">  * Testing of inherited folder properties</span>
<a href="#l46.9"></a><span id="l46.9">  */</span>
<a href="#l46.10"></a><span id="l46.10"> </span>
<a href="#l46.11"></a><span id="l46.11"> function run_test()</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-{ </span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+{</span>
<a href="#l46.14"></a><span id="l46.14">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l46.15"></a><span id="l46.15">   var rootFolder = localAccountUtils.incomingServer.rootMsgFolder;</span>
<a href="#l46.16"></a><span id="l46.16"> </span>
<a href="#l46.17"></a><span id="l46.17">   // add subfolders to the inbox</span>
<a href="#l46.18"></a><span id="l46.18">   const subFolder11 = localAccountUtils.inboxFolder.createLocalSubfolder(&quot;subfolder11&quot;)</span>
<a href="#l46.19"></a><span id="l46.19">                          .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l46.20"></a><span id="l46.20">   const subFolder12 = localAccountUtils.inboxFolder.createLocalSubfolder(&quot;subfolder12&quot;)</span>
<a href="#l46.21"></a><span id="l46.21">                          .QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l46.22"></a><span id="l46.22" class="difflineat">@@ -90,17 +90,17 @@ function run_test()</span>
<a href="#l46.23"></a><span id="l46.23">   // check with all levels populated</span>
<a href="#l46.24"></a><span id="l46.24">   subFolder21.setStringProperty(propertyName, folderValue2);</span>
<a href="#l46.25"></a><span id="l46.25">   localAccountUtils.incomingServer.setCharValue(propertyName, rootValue);</span>
<a href="#l46.26"></a><span id="l46.26">   Assert.equal(rootFolder.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l46.27"></a><span id="l46.27">   Assert.equal(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l46.28"></a><span id="l46.28">   Assert.equal(subFolder12.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l46.29"></a><span id="l46.29">   Assert.equal(subFolder21.getInheritedStringProperty(propertyName), folderValue2);</span>
<a href="#l46.30"></a><span id="l46.30">   Assert.equal(subFolder22.getInheritedStringProperty(propertyName), rootValue);</span>
<a href="#l46.31"></a><span id="l46.31" class="difflineminus">-  </span>
<a href="#l46.32"></a><span id="l46.32" class="difflineplus">+</span>
<a href="#l46.33"></a><span id="l46.33">   // clear the global value and the root value</span>
<a href="#l46.34"></a><span id="l46.34">   Services.prefs.clearUserPref(globalPref);</span>
<a href="#l46.35"></a><span id="l46.35">   localAccountUtils.incomingServer.setCharValue(propertyName, &quot;&quot;);</span>
<a href="#l46.36"></a><span id="l46.36">   Assert.equal(rootFolder.getInheritedStringProperty(propertyName), null);</span>
<a href="#l46.37"></a><span id="l46.37">   Assert.equal(subFolder11.getInheritedStringProperty(propertyName), folderValue);</span>
<a href="#l46.38"></a><span id="l46.38">   Assert.equal(subFolder12.getInheritedStringProperty(propertyName), null);</span>
<a href="#l46.39"></a><span id="l46.39">   Assert.equal(subFolder21.getInheritedStringProperty(propertyName), folderValue2);</span>
<a href="#l46.40"></a><span id="l46.40">   Assert.equal(subFolder22.getInheritedStringProperty(propertyName), null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mailnews/base/test/unit/test_junkWhitelisting.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_junkWhitelisting.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l47.4"></a><span id="l47.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l47.5"></a><span id="l47.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l47.6"></a><span id="l47.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l47.7"></a><span id="l47.7"> </span>
<a href="#l47.8"></a><span id="l47.8"> /*</span>
<a href="#l47.9"></a><span id="l47.9">  * Testing of junk whitelisting</span>
<a href="#l47.10"></a><span id="l47.10">  */</span>
<a href="#l47.11"></a><span id="l47.11" class="difflineminus">- </span>
<a href="#l47.12"></a><span id="l47.12" class="difflineplus">+</span>
<a href="#l47.13"></a><span id="l47.13"> // add address book setup</span>
<a href="#l47.14"></a><span id="l47.14"> load(&quot;../../../resources/abSetup.js&quot;);</span>
<a href="#l47.15"></a><span id="l47.15"> </span>
<a href="#l47.16"></a><span id="l47.16"> // add fake POP3 server driver</span>
<a href="#l47.17"></a><span id="l47.17"> load(&quot;../../../resources/POP3pump.js&quot;);</span>
<a href="#l47.18"></a><span id="l47.18"> </span>
<a href="#l47.19"></a><span id="l47.19"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l47.20"></a><span id="l47.20"> </span>
<a href="#l47.21"></a><span id="l47.21" class="difflineat">@@ -20,22 +20,22 @@ ChromeUtils.import(&quot;resource:///modules/</span>
<a href="#l47.22"></a><span id="l47.22">  *</span>
<a href="#l47.23"></a><span id="l47.23">  * Map of test email contents: (P is &quot;Prim...&quot;, I is &quot;inva..&quot; address)</span>
<a href="#l47.24"></a><span id="l47.24">  *</span>
<a href="#l47.25"></a><span id="l47.25">  *  Index  Bugmail#      From</span>
<a href="#l47.26"></a><span id="l47.26">  *    0        1          P</span>
<a href="#l47.27"></a><span id="l47.27">  *    1        3          I</span>
<a href="#l47.28"></a><span id="l47.28">  *</span>
<a href="#l47.29"></a><span id="l47.29">  */</span>
<a href="#l47.30"></a><span id="l47.30" class="difflineminus">- </span>
<a href="#l47.31"></a><span id="l47.31" class="difflineplus">+</span>
<a href="#l47.32"></a><span id="l47.32"> // indices into hdrs[] of email by domain</span>
<a href="#l47.33"></a><span id="l47.33"> var kDomainTest = 0;</span>
<a href="#l47.34"></a><span id="l47.34"> var kDomainExample = 1;</span>
<a href="#l47.35"></a><span id="l47.35"> </span>
<a href="#l47.36"></a><span id="l47.36" class="difflineminus">-var Files = </span>
<a href="#l47.37"></a><span id="l47.37" class="difflineplus">+var Files =</span>
<a href="#l47.38"></a><span id="l47.38"> [</span>
<a href="#l47.39"></a><span id="l47.39">   &quot;../../../data/bugmail1&quot;,</span>
<a href="#l47.40"></a><span id="l47.40">   &quot;../../../data/bugmail3&quot;</span>
<a href="#l47.41"></a><span id="l47.41"> ]</span>
<a href="#l47.42"></a><span id="l47.42"> </span>
<a href="#l47.43"></a><span id="l47.43"> var hdrs = [];</span>
<a href="#l47.44"></a><span id="l47.44"> </span>
<a href="#l47.45"></a><span id="l47.45"> function run_test()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mailnews/base/test/unit/test_loadVirtualFolders.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_loadVirtualFolders.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l48.4"></a><span id="l48.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l48.5"></a><span id="l48.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l48.6"></a><span id="l48.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l48.7"></a><span id="l48.7"> </span>
<a href="#l48.8"></a><span id="l48.8" class="difflineminus">-// Test loading of virtualFolders.dat, including verification of the search </span>
<a href="#l48.9"></a><span id="l48.9" class="difflineplus">+// Test loading of virtualFolders.dat, including verification of the search</span>
<a href="#l48.10"></a><span id="l48.10"> // scopes, i.e., folder uri's.</span>
<a href="#l48.11"></a><span id="l48.11"> </span>
<a href="#l48.12"></a><span id="l48.12"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l48.13"></a><span id="l48.13"> </span>
<a href="#l48.14"></a><span id="l48.14"> // As currently written, this test will only work with Berkeley store.</span>
<a href="#l48.15"></a><span id="l48.15"> Services.prefs.setCharPref(&quot;mail.serverDefaultStoreContractID&quot;,</span>
<a href="#l48.16"></a><span id="l48.16">                            &quot;@mozilla.org/msgstore/berkeleystore;1&quot;);</span>
<a href="#l48.17"></a><span id="l48.17"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_nsIMsgFolderListenerLocal.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -330,17 +330,17 @@ function run_test()</span>
<a href="#l49.4"></a><span id="l49.4"> function doTest(test)</span>
<a href="#l49.5"></a><span id="l49.5"> {</span>
<a href="#l49.6"></a><span id="l49.6">   if (test &lt;= gTestArray.length)</span>
<a href="#l49.7"></a><span id="l49.7">   {</span>
<a href="#l49.8"></a><span id="l49.8">     var testFn = gTestArray[test-1];</span>
<a href="#l49.9"></a><span id="l49.9">     // Set a limit of 10 seconds; if the notifications haven't arrived by then there's a problem.</span>
<a href="#l49.10"></a><span id="l49.10">     do_timeout(10000, function(){</span>
<a href="#l49.11"></a><span id="l49.11">         if (gTest == test)</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-          do_throw(&quot;Notifications not received in 10000 ms for operation &quot; + testFn.name + </span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+          do_throw(&quot;Notifications not received in 10000 ms for operation &quot; + testFn.name +</span>
<a href="#l49.14"></a><span id="l49.14">             &quot;, current status is &quot; + gCurrStatus);</span>
<a href="#l49.15"></a><span id="l49.15">         }</span>
<a href="#l49.16"></a><span id="l49.16">       );</span>
<a href="#l49.17"></a><span id="l49.17">     dump(&quot;=== Test: &quot; + testFn.name + &quot;\n&quot;);</span>
<a href="#l49.18"></a><span id="l49.18">     testFn();</span>
<a href="#l49.19"></a><span id="l49.19">   }</span>
<a href="#l49.20"></a><span id="l49.20">   else</span>
<a href="#l49.21"></a><span id="l49.21">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mailnews/base/test/unit/test_nsIMsgTagService.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_nsIMsgTagService.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -63,17 +63,17 @@ function run_test()</span>
<a href="#l50.4"></a><span id="l50.4">     Assert.ok(MailServices.tags.isValidKey(i));</span>
<a href="#l50.5"></a><span id="l50.5">     // make sure it knows the difference betweens tags and keys</span>
<a href="#l50.6"></a><span id="l50.6">     Assert.ok(!MailServices.tags.isValidKey(&quot;lotsatags&quot; + i));</span>
<a href="#l50.7"></a><span id="l50.7">     // are we confused by key at start of tag?</span>
<a href="#l50.8"></a><span id="l50.8">     Assert.ok(!MailServices.tags.isValidKey(i + &quot;lotsatags&quot;));</span>
<a href="#l50.9"></a><span id="l50.9">   }</span>
<a href="#l50.10"></a><span id="l50.10"> }</span>
<a href="#l50.11"></a><span id="l50.11"> </span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-/*  </span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+/*</span>
<a href="#l50.14"></a><span id="l50.14">   function printTags()</span>
<a href="#l50.15"></a><span id="l50.15">   {</span>
<a href="#l50.16"></a><span id="l50.16">     let tags = MailServices.tags.getAllTags({});</span>
<a href="#l50.17"></a><span id="l50.17">     for (var i = 0; i &lt; tags.length; i++)</span>
<a href="#l50.18"></a><span id="l50.18">       print(&quot;# &quot; + i + &quot; key [&quot; + tags[i].key + &quot;] tag [&quot; + tags[i].tag + &quot;]&quot;);</span>
<a href="#l50.19"></a><span id="l50.19">   }</span>
<a href="#l50.20"></a><span id="l50.20">  */</span>
<a href="#l50.21"></a><span id="l50.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mailnews/base/test/unit/test_search.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_search.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -261,17 +261,17 @@ var Tests =</span>
<a href="#l51.4"></a><span id="l51.4">     op: IsAfter,</span>
<a href="#l51.5"></a><span id="l51.5">     count: 0}</span>
<a href="#l51.6"></a><span id="l51.6"> ];</span>
<a href="#l51.7"></a><span id="l51.7"> </span>
<a href="#l51.8"></a><span id="l51.8"> function run_test()</span>
<a href="#l51.9"></a><span id="l51.9"> {</span>
<a href="#l51.10"></a><span id="l51.10">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l51.11"></a><span id="l51.11"> </span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-  var copyListener = </span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+  var copyListener =</span>
<a href="#l51.14"></a><span id="l51.14">   {</span>
<a href="#l51.15"></a><span id="l51.15">     OnStartCopy: function() {},</span>
<a href="#l51.16"></a><span id="l51.16">     OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l51.17"></a><span id="l51.17">     SetMessageKey: function(aKey) {},</span>
<a href="#l51.18"></a><span id="l51.18">     SetMessageId: function(aMessageId) {},</span>
<a href="#l51.19"></a><span id="l51.19">     OnStopCopy: function(aStatus) { testSearch();}</span>
<a href="#l51.20"></a><span id="l51.20">   };</span>
<a href="#l51.21"></a><span id="l51.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchAddressInAb.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchAddressInAb.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -51,17 +51,17 @@ var Keywords = nsMsgSearchAttrib.Keyword</span>
<a href="#l52.4"></a><span id="l52.4">  *    3         I         P       I     N</span>
<a href="#l52.5"></a><span id="l52.5">  *    4         I         I       P     N</span>
<a href="#l52.6"></a><span id="l52.6">  *    5         P         I       P     N</span>
<a href="#l52.7"></a><span id="l52.7">  *    6         I         I,P     P,I   N</span>
<a href="#l52.8"></a><span id="l52.8">  *    7         I         I       I     P</span>
<a href="#l52.9"></a><span id="l52.9">  *    8         I         P       P     N</span>
<a href="#l52.10"></a><span id="l52.10">  *</span>
<a href="#l52.11"></a><span id="l52.11">  */</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">- </span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+</span>
<a href="#l52.14"></a><span id="l52.14"> var Tests =</span>
<a href="#l52.15"></a><span id="l52.15"> [</span>
<a href="#l52.16"></a><span id="l52.16">   { value: ABUri,</span>
<a href="#l52.17"></a><span id="l52.17">     attrib: Sender,</span>
<a href="#l52.18"></a><span id="l52.18">     op: IsInAB,</span>
<a href="#l52.19"></a><span id="l52.19">     count: 3 },</span>
<a href="#l52.20"></a><span id="l52.20">   { value: ABUri,</span>
<a href="#l52.21"></a><span id="l52.21">     attrib: To,</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineat">@@ -129,17 +129,17 @@ var Tests =</span>
<a href="#l52.23"></a><span id="l52.23">     count: 6 },</span>
<a href="#l52.24"></a><span id="l52.24">   { value: &quot;invalid@example.com&quot;,</span>
<a href="#l52.25"></a><span id="l52.25">     attrib: ToOrCC,</span>
<a href="#l52.26"></a><span id="l52.26">     op: Isnt,</span>
<a href="#l52.27"></a><span id="l52.27">     count: 2 },</span>
<a href="#l52.28"></a><span id="l52.28"> </span>
<a href="#l52.29"></a><span id="l52.29"> ];</span>
<a href="#l52.30"></a><span id="l52.30"> </span>
<a href="#l52.31"></a><span id="l52.31" class="difflineminus">-var Files = </span>
<a href="#l52.32"></a><span id="l52.32" class="difflineplus">+var Files =</span>
<a href="#l52.33"></a><span id="l52.33"> [</span>
<a href="#l52.34"></a><span id="l52.34">   &quot;../../../data/bugmail1&quot;,</span>
<a href="#l52.35"></a><span id="l52.35">   &quot;../../../data/bugmail2&quot;,</span>
<a href="#l52.36"></a><span id="l52.36">   &quot;../../../data/bugmail3&quot;,</span>
<a href="#l52.37"></a><span id="l52.37">   &quot;../../../data/bugmail4&quot;,</span>
<a href="#l52.38"></a><span id="l52.38">   &quot;../../../data/bugmail5&quot;,</span>
<a href="#l52.39"></a><span id="l52.39">   &quot;../../../data/bugmail6&quot;,</span>
<a href="#l52.40"></a><span id="l52.40">   &quot;../../../data/bugmail7&quot;,</span>
<a href="#l52.41"></a><span id="l52.41" class="difflineat">@@ -147,17 +147,17 @@ var Files =</span>
<a href="#l52.42"></a><span id="l52.42"> ]</span>
<a href="#l52.43"></a><span id="l52.43"> </span>
<a href="#l52.44"></a><span id="l52.44"> var messageKey, hdr;</span>
<a href="#l52.45"></a><span id="l52.45"> </span>
<a href="#l52.46"></a><span id="l52.46"> function run_test()</span>
<a href="#l52.47"></a><span id="l52.47"> {</span>
<a href="#l52.48"></a><span id="l52.48">   // Setup local mail accounts.</span>
<a href="#l52.49"></a><span id="l52.49">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l52.50"></a><span id="l52.50" class="difflineminus">-    </span>
<a href="#l52.51"></a><span id="l52.51" class="difflineplus">+</span>
<a href="#l52.52"></a><span id="l52.52">     // Test setup - copy the data file into place</span>
<a href="#l52.53"></a><span id="l52.53">   var testAB = do_get_file(&quot;../../../addrbook/test/unit/data/cardForEmail.mab&quot;);</span>
<a href="#l52.54"></a><span id="l52.54"> </span>
<a href="#l52.55"></a><span id="l52.55">   // Copy the file to the profile directory for a PAB</span>
<a href="#l52.56"></a><span id="l52.56">   testAB.copyTo(do_get_profile(), kPABData.fileName);</span>
<a href="#l52.57"></a><span id="l52.57"> </span>
<a href="#l52.58"></a><span id="l52.58">   // test that validity table terms are valid</span>
<a href="#l52.59"></a><span id="l52.59"> </span>
<a href="#l52.60"></a><span id="l52.60" class="difflineat">@@ -217,17 +217,17 @@ function run_test()</span>
<a href="#l52.61"></a><span id="l52.61">   testValidityTable(onlineMail, IsntInAB, CCopy, false);</span>
<a href="#l52.62"></a><span id="l52.62">   testValidityTable(onlineMail, IsntInAB, Keywords, false);</span>
<a href="#l52.63"></a><span id="l52.63">   testValidityTable(onlineMail, IsBefore, Sender, false);</span>
<a href="#l52.64"></a><span id="l52.64">   testValidityTable(onlineMail, IsBefore, To, false);</span>
<a href="#l52.65"></a><span id="l52.65">   testValidityTable(onlineMail, IsBefore, ToOrCC, false);</span>
<a href="#l52.66"></a><span id="l52.66">   testValidityTable(onlineMail, IsBefore, CCopy, false);</span>
<a href="#l52.67"></a><span id="l52.67">   testValidityTable(onlineMail, IsBefore, Keywords, false);</span>
<a href="#l52.68"></a><span id="l52.68"> </span>
<a href="#l52.69"></a><span id="l52.69" class="difflineminus">-  // online mail filter  </span>
<a href="#l52.70"></a><span id="l52.70" class="difflineplus">+  // online mail filter</span>
<a href="#l52.71"></a><span id="l52.71">   testValidityTable(onlineMailFilter, IsInAB, Sender, true);</span>
<a href="#l52.72"></a><span id="l52.72">   testValidityTable(onlineMailFilter, IsInAB, To, true);</span>
<a href="#l52.73"></a><span id="l52.73">   testValidityTable(onlineMailFilter, IsInAB, ToOrCC, true);</span>
<a href="#l52.74"></a><span id="l52.74">   testValidityTable(onlineMailFilter, IsInAB, CCopy, true);</span>
<a href="#l52.75"></a><span id="l52.75">   testValidityTable(onlineMailFilter, IsInAB, Keywords, false);</span>
<a href="#l52.76"></a><span id="l52.76">   testValidityTable(onlineMailFilter, IsntInAB, Sender, true);</span>
<a href="#l52.77"></a><span id="l52.77">   testValidityTable(onlineMailFilter, IsntInAB, To, true);</span>
<a href="#l52.78"></a><span id="l52.78">   testValidityTable(onlineMailFilter, IsntInAB, ToOrCC, true);</span>
<a href="#l52.79"></a><span id="l52.79" class="difflineat">@@ -257,27 +257,27 @@ function run_test()</span>
<a href="#l52.80"></a><span id="l52.80">   testValidityTable(news, IsBefore, Keywords, false);</span>
<a href="#l52.81"></a><span id="l52.81"> </span>
<a href="#l52.82"></a><span id="l52.82">   // Get a message into the local filestore. function testAbSearch() continues the testing after the copy.</span>
<a href="#l52.83"></a><span id="l52.83">   do_test_pending();</span>
<a href="#l52.84"></a><span id="l52.84">   copyListener.OnStopCopy(null);</span>
<a href="#l52.85"></a><span id="l52.85">   return true;</span>
<a href="#l52.86"></a><span id="l52.86"> }</span>
<a href="#l52.87"></a><span id="l52.87"> </span>
<a href="#l52.88"></a><span id="l52.88" class="difflineminus">-var copyListener = </span>
<a href="#l52.89"></a><span id="l52.89" class="difflineplus">+var copyListener =</span>
<a href="#l52.90"></a><span id="l52.90"> {</span>
<a href="#l52.91"></a><span id="l52.91">   OnStartCopy: function() {},</span>
<a href="#l52.92"></a><span id="l52.92">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l52.93"></a><span id="l52.93">   SetMessageKey: function(aKey) {},</span>
<a href="#l52.94"></a><span id="l52.94">   SetMessageId: function(aMessageId) {},</span>
<a href="#l52.95"></a><span id="l52.95" class="difflineminus">-  OnStopCopy: function(aStatus) </span>
<a href="#l52.96"></a><span id="l52.96" class="difflineplus">+  OnStopCopy: function(aStatus)</span>
<a href="#l52.97"></a><span id="l52.97">   {</span>
<a href="#l52.98"></a><span id="l52.98">     var fileName = Files.shift();</span>
<a href="#l52.99"></a><span id="l52.99">     if (fileName)</span>
<a href="#l52.100"></a><span id="l52.100" class="difflineminus">-    { </span>
<a href="#l52.101"></a><span id="l52.101" class="difflineplus">+    {</span>
<a href="#l52.102"></a><span id="l52.102">       var file = do_get_file(fileName);</span>
<a href="#l52.103"></a><span id="l52.103">       MailServices.copy.CopyFileMessage(file, localAccountUtils.inboxFolder, null,</span>
<a href="#l52.104"></a><span id="l52.104">                                         false, 0, &quot;&quot;, copyListener, null);</span>
<a href="#l52.105"></a><span id="l52.105">     }</span>
<a href="#l52.106"></a><span id="l52.106">     else</span>
<a href="#l52.107"></a><span id="l52.107">       testAbSearch();</span>
<a href="#l52.108"></a><span id="l52.108">   }</span>
<a href="#l52.109"></a><span id="l52.109"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchBody.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchBody.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -217,17 +217,17 @@ function run_test()</span>
<a href="#l53.4"></a><span id="l53.4">   testValidityTable(onlineMail, Contains, Body, true);</span>
<a href="#l53.5"></a><span id="l53.5">   testValidityTable(onlineMail, DoesntContain, Body, true);</span>
<a href="#l53.6"></a><span id="l53.6">   testValidityTable(onlineMail, Is, Body, false);</span>
<a href="#l53.7"></a><span id="l53.7">   testValidityTable(onlineMail, Isnt, Body, false);</span>
<a href="#l53.8"></a><span id="l53.8">   testValidityTable(onlineMail, IsEmpty, Body, false);</span>
<a href="#l53.9"></a><span id="l53.9">   testValidityTable(onlineMail, IsntEmpty, Body, false);</span>
<a href="#l53.10"></a><span id="l53.10">   testValidityTable(onlineMail, IsBefore, Body, false);</span>
<a href="#l53.11"></a><span id="l53.11"> </span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-  // online mail filter  </span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+  // online mail filter</span>
<a href="#l53.14"></a><span id="l53.14">   /*testValidityTable(onlineMailFilter, Contains, Body, true);</span>
<a href="#l53.15"></a><span id="l53.15">   testValidityTable(onlineMailFilter, DoesntContain, Body, true);</span>
<a href="#l53.16"></a><span id="l53.16">   testValidityTable(onlineMailFilter, Is, Body, false);</span>
<a href="#l53.17"></a><span id="l53.17">   testValidityTable(onlineMailFilter, Isnt, Body, false);</span>
<a href="#l53.18"></a><span id="l53.18">   testValidityTable(onlineMailFilter, IsEmpty, Body, false);</span>
<a href="#l53.19"></a><span id="l53.19">   testValidityTable(onlineMailFilter, IsntEmpty, Body, false);</span>
<a href="#l53.20"></a><span id="l53.20">   testValidityTable(onlineMailFilter, IsBefore, Body, false);*/</span>
<a href="#l53.21"></a><span id="l53.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchBoolean.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchBoolean.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l54.4"></a><span id="l54.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l54.5"></a><span id="l54.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l54.6"></a><span id="l54.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l54.7"></a><span id="l54.7"> </span>
<a href="#l54.8"></a><span id="l54.8"> /*</span>
<a href="#l54.9"></a><span id="l54.9">  * Demonstrates and tests the use of grouped boolean expressions in search terms</span>
<a href="#l54.10"></a><span id="l54.10">  */</span>
<a href="#l54.11"></a><span id="l54.11" class="difflineminus">- </span>
<a href="#l54.12"></a><span id="l54.12" class="difflineplus">+</span>
<a href="#l54.13"></a><span id="l54.13"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l54.14"></a><span id="l54.14"> </span>
<a href="#l54.15"></a><span id="l54.15"> var gSearchSession = Cc[&quot;@mozilla.org/messenger/searchSession;1&quot;]</span>
<a href="#l54.16"></a><span id="l54.16">                         .createInstance(Ci.nsIMsgSearchSession);</span>
<a href="#l54.17"></a><span id="l54.17"> </span>
<a href="#l54.18"></a><span id="l54.18"> var gHdr; // the message header for the one mailbox message</span>
<a href="#l54.19"></a><span id="l54.19"> </span>
<a href="#l54.20"></a><span id="l54.20"> var Tests =</span>
<a href="#l54.21"></a><span id="l54.21" class="difflineat">@@ -94,20 +94,20 @@ var Tests =</span>
<a href="#l54.22"></a><span id="l54.22">     B: true,</span>
<a href="#l54.23"></a><span id="l54.23">     C: true,</span>
<a href="#l54.24"></a><span id="l54.24">     D: true,</span>
<a href="#l54.25"></a><span id="l54.25">     matches: true},</span>
<a href="#l54.26"></a><span id="l54.26"> ];</span>
<a href="#l54.27"></a><span id="l54.27"> </span>
<a href="#l54.28"></a><span id="l54.28"> var gHitCount = 0;</span>
<a href="#l54.29"></a><span id="l54.29"> var searchListener =</span>
<a href="#l54.30"></a><span id="l54.30" class="difflineminus">-{ </span>
<a href="#l54.31"></a><span id="l54.31" class="difflineplus">+{</span>
<a href="#l54.32"></a><span id="l54.32">   onSearchHit: function(dbHdr, folder) { gHitCount++; },</span>
<a href="#l54.33"></a><span id="l54.33">   onSearchDone: function(status)</span>
<a href="#l54.34"></a><span id="l54.34" class="difflineminus">-  { </span>
<a href="#l54.35"></a><span id="l54.35" class="difflineplus">+  {</span>
<a href="#l54.36"></a><span id="l54.36">     testSearch();</span>
<a href="#l54.37"></a><span id="l54.37">   },</span>
<a href="#l54.38"></a><span id="l54.38">   onNewSearch: function() {gHitCount = 0;}</span>
<a href="#l54.39"></a><span id="l54.39"> };</span>
<a href="#l54.40"></a><span id="l54.40"> </span>
<a href="#l54.41"></a><span id="l54.41"> function run_test()</span>
<a href="#l54.42"></a><span id="l54.42"> {</span>
<a href="#l54.43"></a><span id="l54.43">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineat">@@ -144,17 +144,17 @@ function run_test()</span>
<a href="#l54.45"></a><span id="l54.45">                               localAccountUtils.inboxFolder);</span>
<a href="#l54.46"></a><span id="l54.46">   gSearchSession.registerListener(searchListener);</span>
<a href="#l54.47"></a><span id="l54.47">   // I tried using capital &quot;A&quot; but something makes it lower case internally, so it failed</span>
<a href="#l54.48"></a><span id="l54.48">   addSearchTerm(&quot;a&quot;, true, false, true);  // &quot;(A&quot;</span>
<a href="#l54.49"></a><span id="l54.49">   addSearchTerm(&quot;b&quot;, false, true, false); // &quot; || B)&quot;</span>
<a href="#l54.50"></a><span id="l54.50">   addSearchTerm(&quot;c&quot;, true, false, true);  // &quot; &amp;&amp; (C&quot;</span>
<a href="#l54.51"></a><span id="l54.51">   addSearchTerm(&quot;d&quot;, false, true, false); // &quot; || D)&quot;</span>
<a href="#l54.52"></a><span id="l54.52"> </span>
<a href="#l54.53"></a><span id="l54.53" class="difflineminus">-  var copyListener = </span>
<a href="#l54.54"></a><span id="l54.54" class="difflineplus">+  var copyListener =</span>
<a href="#l54.55"></a><span id="l54.55">   {</span>
<a href="#l54.56"></a><span id="l54.56">     OnStartCopy: function() {},</span>
<a href="#l54.57"></a><span id="l54.57">     OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l54.58"></a><span id="l54.58">     SetMessageKey: function(aKey) {</span>
<a href="#l54.59"></a><span id="l54.59">       gHdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l54.60"></a><span id="l54.60">     },</span>
<a href="#l54.61"></a><span id="l54.61">     SetMessageId: function(aMessageId) {},</span>
<a href="#l54.62"></a><span id="l54.62">     OnStopCopy: function(aStatus) { testSearch();}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchChaining.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchChaining.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -58,26 +58,26 @@ function *searchTest()</span>
<a href="#l55.4"></a><span id="l55.4">   yield PromiseTestUtils.promiseDelay(1000);</span>
<a href="#l55.5"></a><span id="l55.5"> }</span>
<a href="#l55.6"></a><span id="l55.6"> </span>
<a href="#l55.7"></a><span id="l55.7"> // nsIMsgSearchNotify implementation</span>
<a href="#l55.8"></a><span id="l55.8"> var searchListener =</span>
<a href="#l55.9"></a><span id="l55.9"> {</span>
<a href="#l55.10"></a><span id="l55.10">   numTotalMessages: 0,</span>
<a href="#l55.11"></a><span id="l55.11">   QueryInterface: XPCOMUtils.generateQI([Ci.nsIMsgSearchNotify]),</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-  onNewSearch: function() </span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+  onNewSearch: function()</span>
<a href="#l55.14"></a><span id="l55.14">   {</span>
<a href="#l55.15"></a><span id="l55.15">     this.numTotalMessages = 0;</span>
<a href="#l55.16"></a><span id="l55.16">   },</span>
<a href="#l55.17"></a><span id="l55.17">   onSearchHit: function(dbHdr, folder)</span>
<a href="#l55.18"></a><span id="l55.18">   {</span>
<a href="#l55.19"></a><span id="l55.19">     this.numTotalMessages++;</span>
<a href="#l55.20"></a><span id="l55.20">   },</span>
<a href="#l55.21"></a><span id="l55.21">   onSearchDone: function(status)</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineminus">-  { </span>
<a href="#l55.23"></a><span id="l55.23" class="difflineplus">+  {</span>
<a href="#l55.24"></a><span id="l55.24">     Assert.equal(this.numTotalMessages, 1);</span>
<a href="#l55.25"></a><span id="l55.25">     return true;</span>
<a href="#l55.26"></a><span id="l55.26">   }</span>
<a href="#l55.27"></a><span id="l55.27"> };</span>
<a href="#l55.28"></a><span id="l55.28"> </span>
<a href="#l55.29"></a><span id="l55.29"> var tests = [</span>
<a href="#l55.30"></a><span id="l55.30">   setupIMAPPump,</span>
<a href="#l55.31"></a><span id="l55.31">   setupFolder,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchCustomTerm.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchCustomTerm.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -57,17 +57,17 @@ var customTerm =</span>
<a href="#l56.4"></a><span id="l56.4">     }</span>
<a href="#l56.5"></a><span id="l56.5"> };</span>
<a href="#l56.6"></a><span id="l56.6"> </span>
<a href="#l56.7"></a><span id="l56.7"> function run_test()</span>
<a href="#l56.8"></a><span id="l56.8"> {</span>
<a href="#l56.9"></a><span id="l56.9">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l56.10"></a><span id="l56.10">   MailServices.filters.addCustomTerm(customTerm);</span>
<a href="#l56.11"></a><span id="l56.11"> </span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-  var copyListener = </span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+  var copyListener =</span>
<a href="#l56.14"></a><span id="l56.14">   {</span>
<a href="#l56.15"></a><span id="l56.15">     OnStartCopy: function() {},</span>
<a href="#l56.16"></a><span id="l56.16">     OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l56.17"></a><span id="l56.17">     SetMessageKey: function(aKey) {</span>
<a href="#l56.18"></a><span id="l56.18">       gHdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l56.19"></a><span id="l56.19">     },</span>
<a href="#l56.20"></a><span id="l56.20">     SetMessageId: function(aMessageId) {},</span>
<a href="#l56.21"></a><span id="l56.21">     OnStopCopy: function(aStatus) { doTest();}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchJunk.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchJunk.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -30,23 +30,23 @@ var fileName = &quot;../../../data/bugmail1&quot;;</span>
<a href="#l57.4"></a><span id="l57.4"> /*</span>
<a href="#l57.5"></a><span id="l57.5">  * The search for junkpercent is defined as the effective value,</span>
<a href="#l57.6"></a><span id="l57.6">  * while the &quot;junkpercent&quot; database term is always the result</span>
<a href="#l57.7"></a><span id="l57.7">  * from the bayes filter. This is optimized to make views that</span>
<a href="#l57.8"></a><span id="l57.8">  * rely on junk percent search work with the best value for junk</span>
<a href="#l57.9"></a><span id="l57.9">  * percent, while allowing junk percent from the bayes filter</span>
<a href="#l57.10"></a><span id="l57.10">  * to be saved for analysis.</span>
<a href="#l57.11"></a><span id="l57.11">  *</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">- * This means that the search for &quot;junk percent&quot; only uses the </span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+ * This means that the search for &quot;junk percent&quot; only uses the</span>
<a href="#l57.14"></a><span id="l57.14">  * database junkpercent value if junkscoreorigin is &quot;plugin&quot;.</span>
<a href="#l57.15"></a><span id="l57.15">  * Otherwise, it uses junkstatus (if set) or defaults to 0</span>
<a href="#l57.16"></a><span id="l57.16">  * (not junk) if the message is unclassified.</span>
<a href="#l57.17"></a><span id="l57.17">  */</span>
<a href="#l57.18"></a><span id="l57.18"> </span>
<a href="#l57.19"></a><span id="l57.19" class="difflineminus">-var Tests = </span>
<a href="#l57.20"></a><span id="l57.20" class="difflineplus">+var Tests =</span>
<a href="#l57.21"></a><span id="l57.21"> [</span>
<a href="#l57.22"></a><span id="l57.22">   // test empty junk status</span>
<a href="#l57.23"></a><span id="l57.23">   { junkScore: false,</span>
<a href="#l57.24"></a><span id="l57.24">     testValue: 90,</span>
<a href="#l57.25"></a><span id="l57.25">     attrib: JunkStatus,</span>
<a href="#l57.26"></a><span id="l57.26">     op: IsEmpty,</span>
<a href="#l57.27"></a><span id="l57.27">     count: 1},</span>
<a href="#l57.28"></a><span id="l57.28">   { junkScore: false,</span>
<a href="#l57.29"></a><span id="l57.29" class="difflineat">@@ -120,17 +120,17 @@ var Tests =</span>
<a href="#l57.30"></a><span id="l57.30">     count: 0},</span>
<a href="#l57.31"></a><span id="l57.31">   { junkScore: &quot;0&quot;,</span>
<a href="#l57.32"></a><span id="l57.32">     junkScoreOrigin: &quot;plugin&quot;,</span>
<a href="#l57.33"></a><span id="l57.33">     junkPercent: &quot;10&quot;,</span>
<a href="#l57.34"></a><span id="l57.34">     testValue: 10,</span>
<a href="#l57.35"></a><span id="l57.35">     attrib: JunkPercent,</span>
<a href="#l57.36"></a><span id="l57.36">     op: Is,</span>
<a href="#l57.37"></a><span id="l57.37">     count: 1},</span>
<a href="#l57.38"></a><span id="l57.38" class="difflineminus">-    </span>
<a href="#l57.39"></a><span id="l57.39" class="difflineplus">+</span>
<a href="#l57.40"></a><span id="l57.40">     // values set by user, use junkscore not junkpercent</span>
<a href="#l57.41"></a><span id="l57.41">   { junkScore: &quot;0&quot;,</span>
<a href="#l57.42"></a><span id="l57.42">     junkScoreOrigin: &quot;user&quot;,</span>
<a href="#l57.43"></a><span id="l57.43">     junkPercent: &quot;90&quot;,</span>
<a href="#l57.44"></a><span id="l57.44">     testValue: 50,</span>
<a href="#l57.45"></a><span id="l57.45">     attrib: JunkPercent,</span>
<a href="#l57.46"></a><span id="l57.46">     op: IsGreaterThan,</span>
<a href="#l57.47"></a><span id="l57.47">     count: 0},</span>
<a href="#l57.48"></a><span id="l57.48" class="difflineat">@@ -172,17 +172,17 @@ var Tests =</span>
<a href="#l57.49"></a><span id="l57.49">     // default to 0 when nothing set</span>
<a href="#l57.50"></a><span id="l57.50">   { junkScore: &quot;&quot;,</span>
<a href="#l57.51"></a><span id="l57.51">     junkScoreOrigin: &quot;&quot;,</span>
<a href="#l57.52"></a><span id="l57.52">     junkPercent: &quot;&quot;,</span>
<a href="#l57.53"></a><span id="l57.53">     testValue: 0,</span>
<a href="#l57.54"></a><span id="l57.54">     attrib: JunkPercent,</span>
<a href="#l57.55"></a><span id="l57.55">     op: Is,</span>
<a href="#l57.56"></a><span id="l57.56">     count: 1},</span>
<a href="#l57.57"></a><span id="l57.57" class="difflineminus">-    </span>
<a href="#l57.58"></a><span id="l57.58" class="difflineplus">+</span>
<a href="#l57.59"></a><span id="l57.59">     // junkscoreorigin search tests</span>
<a href="#l57.60"></a><span id="l57.60">   { junkScore: &quot;0&quot;,</span>
<a href="#l57.61"></a><span id="l57.61">     junkScoreOrigin: &quot;plugin&quot;,</span>
<a href="#l57.62"></a><span id="l57.62">     junkPercent: &quot;50&quot;,</span>
<a href="#l57.63"></a><span id="l57.63">     testValue: &quot;plugin&quot;,</span>
<a href="#l57.64"></a><span id="l57.64">     attrib: JunkScoreOrigin,</span>
<a href="#l57.65"></a><span id="l57.65">     op: Is,</span>
<a href="#l57.66"></a><span id="l57.66">     count: 1},</span>
<a href="#l57.67"></a><span id="l57.67" class="difflineat">@@ -207,17 +207,17 @@ var Tests =</span>
<a href="#l57.68"></a><span id="l57.68">     attrib: JunkScoreOrigin,</span>
<a href="#l57.69"></a><span id="l57.69">     op: Isnt,</span>
<a href="#l57.70"></a><span id="l57.70">     count: 1},</span>
<a href="#l57.71"></a><span id="l57.71"> ];</span>
<a href="#l57.72"></a><span id="l57.72"> </span>
<a href="#l57.73"></a><span id="l57.73"> function run_test()</span>
<a href="#l57.74"></a><span id="l57.74"> {</span>
<a href="#l57.75"></a><span id="l57.75">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l57.76"></a><span id="l57.76" class="difflineminus">-    </span>
<a href="#l57.77"></a><span id="l57.77" class="difflineplus">+</span>
<a href="#l57.78"></a><span id="l57.78">   // test that validity table terms are valid</span>
<a href="#l57.79"></a><span id="l57.79"> </span>
<a href="#l57.80"></a><span id="l57.80">   // offline mail table</span>
<a href="#l57.81"></a><span id="l57.81">   testValidityTable(offlineMail, Is, JunkPercent, true);</span>
<a href="#l57.82"></a><span id="l57.82">   testValidityTable(offlineMail, Isnt, JunkPercent, false);</span>
<a href="#l57.83"></a><span id="l57.83">   testValidityTable(offlineMail, IsGreaterThan, JunkPercent, true);</span>
<a href="#l57.84"></a><span id="l57.84">   testValidityTable(offlineMail, IsLessThan, JunkPercent, true);</span>
<a href="#l57.85"></a><span id="l57.85"> </span>
<a href="#l57.86"></a><span id="l57.86" class="difflineat">@@ -230,17 +230,17 @@ function run_test()</span>
<a href="#l57.87"></a><span id="l57.87">   do_test_pending();</span>
<a href="#l57.88"></a><span id="l57.88">   var file = do_get_file(fileName);</span>
<a href="#l57.89"></a><span id="l57.89">   MailServices.copy.CopyFileMessage(file, localAccountUtils.inboxFolder, null, false, 0,</span>
<a href="#l57.90"></a><span id="l57.90">                                     &quot;&quot;, copyListener, null);</span>
<a href="#l57.91"></a><span id="l57.91">   return true;</span>
<a href="#l57.92"></a><span id="l57.92"> }</span>
<a href="#l57.93"></a><span id="l57.93"> </span>
<a href="#l57.94"></a><span id="l57.94"> var hdr;</span>
<a href="#l57.95"></a><span id="l57.95" class="difflineminus">-var copyListener = </span>
<a href="#l57.96"></a><span id="l57.96" class="difflineplus">+var copyListener =</span>
<a href="#l57.97"></a><span id="l57.97"> {</span>
<a href="#l57.98"></a><span id="l57.98">   OnStartCopy: function() {},</span>
<a href="#l57.99"></a><span id="l57.99">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l57.100"></a><span id="l57.100">   SetMessageKey: function(aKey) { hdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);},</span>
<a href="#l57.101"></a><span id="l57.101">   SetMessageId: function(aMessageId) {},</span>
<a href="#l57.102"></a><span id="l57.102">   OnStopCopy: function(aStatus) { testJunkSearch();}</span>
<a href="#l57.103"></a><span id="l57.103"> };</span>
<a href="#l57.104"></a><span id="l57.104"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchLocalizationStrings.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchLocalizationStrings.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l58.4"></a><span id="l58.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l58.5"></a><span id="l58.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l58.6"></a><span id="l58.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l58.7"></a><span id="l58.7" class="difflineminus">- </span>
<a href="#l58.8"></a><span id="l58.8" class="difflineplus">+</span>
<a href="#l58.9"></a><span id="l58.9">  // tests that localization strings added in bug 484147 are defined in preferences</span>
<a href="#l58.10"></a><span id="l58.10" class="difflineminus">- </span>
<a href="#l58.11"></a><span id="l58.11" class="difflineplus">+</span>
<a href="#l58.12"></a><span id="l58.12"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l58.13"></a><span id="l58.13"> </span>
<a href="#l58.14"></a><span id="l58.14"> var gValidityManager = Cc['@mozilla.org/mail/search/validityManager;1']</span>
<a href="#l58.15"></a><span id="l58.15">                            .getService(Ci.nsIMsgSearchValidityManager);</span>
<a href="#l58.16"></a><span id="l58.16"> </span>
<a href="#l58.17"></a><span id="l58.17"> var gStringBundle = Services.strings</span>
<a href="#l58.18"></a><span id="l58.18">                               .createBundle(&quot;chrome://messenger/locale/search-attributes.properties&quot;);</span>
<a href="#l58.19"></a><span id="l58.19"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchTag.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchTag.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -48,17 +48,17 @@ var Tests =</span>
<a href="#l59.4"></a><span id="l59.4">   // test the valid tag</span>
<a href="#l59.5"></a><span id="l59.5">   { msgTag: Tag1,</span>
<a href="#l59.6"></a><span id="l59.6">     testTag: Tag1,</span>
<a href="#l59.7"></a><span id="l59.7">     op: Is,</span>
<a href="#l59.8"></a><span id="l59.8">     count: 1 },</span>
<a href="#l59.9"></a><span id="l59.9">   { msgTag: Tag1,</span>
<a href="#l59.10"></a><span id="l59.10">     testTag: Tag1,</span>
<a href="#l59.11"></a><span id="l59.11">     op: Isnt,</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-    count: 0 }, </span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+    count: 0 },</span>
<a href="#l59.14"></a><span id="l59.14">   { msgTag: Tag1,</span>
<a href="#l59.15"></a><span id="l59.15">     testTag: Tag1,</span>
<a href="#l59.16"></a><span id="l59.16">     op: Contains,</span>
<a href="#l59.17"></a><span id="l59.17">     count: 1 },</span>
<a href="#l59.18"></a><span id="l59.18">   { msgTag: Tag1,</span>
<a href="#l59.19"></a><span id="l59.19">     testTag: Tag1,</span>
<a href="#l59.20"></a><span id="l59.20">     op: DoesntContain,</span>
<a href="#l59.21"></a><span id="l59.21">     count: 0 },</span>
<a href="#l59.22"></a><span id="l59.22" class="difflineat">@@ -99,17 +99,17 @@ var Tests =</span>
<a href="#l59.23"></a><span id="l59.23">   // test first tag</span>
<a href="#l59.24"></a><span id="l59.24">   { msgTag: Tag1Tag4,</span>
<a href="#l59.25"></a><span id="l59.25">     testTag: Tag1,</span>
<a href="#l59.26"></a><span id="l59.26">     op: Is,</span>
<a href="#l59.27"></a><span id="l59.27">     count: 0 },</span>
<a href="#l59.28"></a><span id="l59.28">   { msgTag: Tag1Tag4,</span>
<a href="#l59.29"></a><span id="l59.29">     testTag: Tag1,</span>
<a href="#l59.30"></a><span id="l59.30">     op: Isnt,</span>
<a href="#l59.31"></a><span id="l59.31" class="difflineminus">-    count: 1 }, </span>
<a href="#l59.32"></a><span id="l59.32" class="difflineplus">+    count: 1 },</span>
<a href="#l59.33"></a><span id="l59.33">   { msgTag: Tag1Tag4,</span>
<a href="#l59.34"></a><span id="l59.34">     testTag: Tag1,</span>
<a href="#l59.35"></a><span id="l59.35">     op: Contains,</span>
<a href="#l59.36"></a><span id="l59.36">     count: 1 },</span>
<a href="#l59.37"></a><span id="l59.37">   { msgTag: Tag1Tag4,</span>
<a href="#l59.38"></a><span id="l59.38">     testTag: Tag1,</span>
<a href="#l59.39"></a><span id="l59.39">     op: DoesntContain,</span>
<a href="#l59.40"></a><span id="l59.40">     count: 0 },</span>
<a href="#l59.41"></a><span id="l59.41" class="difflineat">@@ -124,17 +124,17 @@ var Tests =</span>
<a href="#l59.42"></a><span id="l59.42">   // test second tag</span>
<a href="#l59.43"></a><span id="l59.43">   { msgTag: Tag1Tag4,</span>
<a href="#l59.44"></a><span id="l59.44">     testTag: Tag4,</span>
<a href="#l59.45"></a><span id="l59.45">     op: Is,</span>
<a href="#l59.46"></a><span id="l59.46">     count: 0 },</span>
<a href="#l59.47"></a><span id="l59.47">   { msgTag: Tag1Tag4,</span>
<a href="#l59.48"></a><span id="l59.48">     testTag: Tag4,</span>
<a href="#l59.49"></a><span id="l59.49">     op: Isnt,</span>
<a href="#l59.50"></a><span id="l59.50" class="difflineminus">-    count: 1 }, </span>
<a href="#l59.51"></a><span id="l59.51" class="difflineplus">+    count: 1 },</span>
<a href="#l59.52"></a><span id="l59.52">   { msgTag: Tag1Tag4,</span>
<a href="#l59.53"></a><span id="l59.53">     testTag: Tag4,</span>
<a href="#l59.54"></a><span id="l59.54">     op: Contains,</span>
<a href="#l59.55"></a><span id="l59.55">     count: 1 },</span>
<a href="#l59.56"></a><span id="l59.56">   { msgTag: Tag1Tag4,</span>
<a href="#l59.57"></a><span id="l59.57">     testTag: Tag4,</span>
<a href="#l59.58"></a><span id="l59.58">     op: DoesntContain,</span>
<a href="#l59.59"></a><span id="l59.59">     count: 0 },</span>
<a href="#l59.60"></a><span id="l59.60" class="difflineat">@@ -149,17 +149,17 @@ var Tests =</span>
<a href="#l59.61"></a><span id="l59.61">   // test tag not in message</span>
<a href="#l59.62"></a><span id="l59.62">   { msgTag: Tag1Tag4,</span>
<a href="#l59.63"></a><span id="l59.63">     testTag: Tag2,</span>
<a href="#l59.64"></a><span id="l59.64">     op: Is,</span>
<a href="#l59.65"></a><span id="l59.65">     count: 0 },</span>
<a href="#l59.66"></a><span id="l59.66">   { msgTag: Tag1Tag4,</span>
<a href="#l59.67"></a><span id="l59.67">     testTag: Tag2,</span>
<a href="#l59.68"></a><span id="l59.68">     op: Isnt,</span>
<a href="#l59.69"></a><span id="l59.69" class="difflineminus">-    count: 1 }, </span>
<a href="#l59.70"></a><span id="l59.70" class="difflineplus">+    count: 1 },</span>
<a href="#l59.71"></a><span id="l59.71">   { msgTag: Tag1Tag4,</span>
<a href="#l59.72"></a><span id="l59.72">     testTag: Tag2,</span>
<a href="#l59.73"></a><span id="l59.73">     op: Contains,</span>
<a href="#l59.74"></a><span id="l59.74">     count: 0 },</span>
<a href="#l59.75"></a><span id="l59.75">   { msgTag: Tag1Tag4,</span>
<a href="#l59.76"></a><span id="l59.76">     testTag: Tag2,</span>
<a href="#l59.77"></a><span id="l59.77">     op: DoesntContain,</span>
<a href="#l59.78"></a><span id="l59.78">     count: 1 },</span>
<a href="#l59.79"></a><span id="l59.79" class="difflineat">@@ -174,17 +174,17 @@ var Tests =</span>
<a href="#l59.80"></a><span id="l59.80">   // empty message</span>
<a href="#l59.81"></a><span id="l59.81">   { msgTag: &quot;&quot;,</span>
<a href="#l59.82"></a><span id="l59.82">     testTag: Tag2,</span>
<a href="#l59.83"></a><span id="l59.83">     op: Is,</span>
<a href="#l59.84"></a><span id="l59.84">     count: 0 },</span>
<a href="#l59.85"></a><span id="l59.85">   { msgTag: &quot;&quot;,</span>
<a href="#l59.86"></a><span id="l59.86">     testTag: Tag2,</span>
<a href="#l59.87"></a><span id="l59.87">     op: Isnt,</span>
<a href="#l59.88"></a><span id="l59.88" class="difflineminus">-    count: 1 }, </span>
<a href="#l59.89"></a><span id="l59.89" class="difflineplus">+    count: 1 },</span>
<a href="#l59.90"></a><span id="l59.90">   { msgTag: &quot;&quot;,</span>
<a href="#l59.91"></a><span id="l59.91">     testTag: Tag2,</span>
<a href="#l59.92"></a><span id="l59.92">     op: Contains,</span>
<a href="#l59.93"></a><span id="l59.93">     count: 0 },</span>
<a href="#l59.94"></a><span id="l59.94">   { msgTag: &quot;&quot;,</span>
<a href="#l59.95"></a><span id="l59.95">     testTag: Tag2,</span>
<a href="#l59.96"></a><span id="l59.96">     op: DoesntContain,</span>
<a href="#l59.97"></a><span id="l59.97">     count: 1 },</span>
<a href="#l59.98"></a><span id="l59.98" class="difflineat">@@ -192,17 +192,17 @@ var Tests =</span>
<a href="#l59.99"></a><span id="l59.99">     testTag: Tag2,</span>
<a href="#l59.100"></a><span id="l59.100">     op: IsEmpty,</span>
<a href="#l59.101"></a><span id="l59.101">     count: 1 },</span>
<a href="#l59.102"></a><span id="l59.102">   { msgTag: &quot;&quot;,</span>
<a href="#l59.103"></a><span id="l59.103">     testTag: Tag2,</span>
<a href="#l59.104"></a><span id="l59.104">     op: IsntEmpty,</span>
<a href="#l59.105"></a><span id="l59.105">     count: 0 },</span>
<a href="#l59.106"></a><span id="l59.106"> // message with two tags, only one is valid</span>
<a href="#l59.107"></a><span id="l59.107" class="difflineminus">-  // test with the single valid tag  </span>
<a href="#l59.108"></a><span id="l59.108" class="difflineplus">+  // test with the single valid tag</span>
<a href="#l59.109"></a><span id="l59.109">   { msgTag: Tag1Tag3,</span>
<a href="#l59.110"></a><span id="l59.110">     testTag: Tag1,</span>
<a href="#l59.111"></a><span id="l59.111">     op: Is,</span>
<a href="#l59.112"></a><span id="l59.112">     count: 1 },</span>
<a href="#l59.113"></a><span id="l59.113">   { msgTag: Tag1Tag3,</span>
<a href="#l59.114"></a><span id="l59.114">     testTag: Tag1,</span>
<a href="#l59.115"></a><span id="l59.115">     op: Isnt,</span>
<a href="#l59.116"></a><span id="l59.116">     count: 0 },</span>
<a href="#l59.117"></a><span id="l59.117" class="difflineat">@@ -217,17 +217,17 @@ var Tests =</span>
<a href="#l59.118"></a><span id="l59.118">   { msgTag: Tag1Tag3,</span>
<a href="#l59.119"></a><span id="l59.119">     testTag: Tag1,</span>
<a href="#l59.120"></a><span id="l59.120">     op: IsEmpty,</span>
<a href="#l59.121"></a><span id="l59.121">     count: 0 },</span>
<a href="#l59.122"></a><span id="l59.122">   { msgTag: Tag1Tag3,</span>
<a href="#l59.123"></a><span id="l59.123">     testTag: Tag1,</span>
<a href="#l59.124"></a><span id="l59.124">     op: IsntEmpty,</span>
<a href="#l59.125"></a><span id="l59.125">     count: 1 },</span>
<a href="#l59.126"></a><span id="l59.126" class="difflineminus">-  // test with a tag not in the message  </span>
<a href="#l59.127"></a><span id="l59.127" class="difflineplus">+  // test with a tag not in the message</span>
<a href="#l59.128"></a><span id="l59.128">   { msgTag: Tag1Tag3,</span>
<a href="#l59.129"></a><span id="l59.129">     testTag: Tag2,</span>
<a href="#l59.130"></a><span id="l59.130">     op: Is,</span>
<a href="#l59.131"></a><span id="l59.131">     count: 0 },</span>
<a href="#l59.132"></a><span id="l59.132">   { msgTag: Tag1Tag3,</span>
<a href="#l59.133"></a><span id="l59.133">     testTag: Tag2,</span>
<a href="#l59.134"></a><span id="l59.134">     op: Isnt,</span>
<a href="#l59.135"></a><span id="l59.135">     count: 1 },</span>
<a href="#l59.136"></a><span id="l59.136" class="difflineat">@@ -251,17 +251,17 @@ var Tests =</span>
<a href="#l59.137"></a><span id="l59.137">   // test the tag</span>
<a href="#l59.138"></a><span id="l59.138">   { msgTag: Tag1Tag1,</span>
<a href="#l59.139"></a><span id="l59.139">     testTag: Tag1,</span>
<a href="#l59.140"></a><span id="l59.140">     op: Is,</span>
<a href="#l59.141"></a><span id="l59.141">     count: 1 },</span>
<a href="#l59.142"></a><span id="l59.142">   { msgTag: Tag1Tag1,</span>
<a href="#l59.143"></a><span id="l59.143">     testTag: Tag1,</span>
<a href="#l59.144"></a><span id="l59.144">     op: Isnt,</span>
<a href="#l59.145"></a><span id="l59.145" class="difflineminus">-    count: 0 }, </span>
<a href="#l59.146"></a><span id="l59.146" class="difflineplus">+    count: 0 },</span>
<a href="#l59.147"></a><span id="l59.147">   { msgTag: Tag1Tag1,</span>
<a href="#l59.148"></a><span id="l59.148">     testTag: Tag1,</span>
<a href="#l59.149"></a><span id="l59.149">     op: Contains,</span>
<a href="#l59.150"></a><span id="l59.150">     count: 1 },</span>
<a href="#l59.151"></a><span id="l59.151">   { msgTag: Tag1Tag1,</span>
<a href="#l59.152"></a><span id="l59.152">     testTag: Tag1,</span>
<a href="#l59.153"></a><span id="l59.153">     op: DoesntContain,</span>
<a href="#l59.154"></a><span id="l59.154">     count: 0 },</span>
<a href="#l59.155"></a><span id="l59.155" class="difflineat">@@ -306,17 +306,17 @@ function run_test()</span>
<a href="#l59.156"></a><span id="l59.156">   testValidityTable(onlineMail, Contains, Keywords, true);</span>
<a href="#l59.157"></a><span id="l59.157">   testValidityTable(onlineMail, DoesntContain, Keywords, true);</span>
<a href="#l59.158"></a><span id="l59.158">   testValidityTable(onlineMail, Is, Keywords, false);</span>
<a href="#l59.159"></a><span id="l59.159">   testValidityTable(onlineMail, Isnt, Keywords, false);</span>
<a href="#l59.160"></a><span id="l59.160">   testValidityTable(onlineMail, IsEmpty, Keywords, false);</span>
<a href="#l59.161"></a><span id="l59.161">   testValidityTable(onlineMail, IsntEmpty, Keywords, false);</span>
<a href="#l59.162"></a><span id="l59.162">   testValidityTable(onlineMail, IsBefore, Keywords, false);</span>
<a href="#l59.163"></a><span id="l59.163"> </span>
<a href="#l59.164"></a><span id="l59.164" class="difflineminus">-  // online mail filter  </span>
<a href="#l59.165"></a><span id="l59.165" class="difflineplus">+  // online mail filter</span>
<a href="#l59.166"></a><span id="l59.166">   testValidityTable(onlineMailFilter, Contains, Keywords, true);</span>
<a href="#l59.167"></a><span id="l59.167">   testValidityTable(onlineMailFilter, DoesntContain, Keywords, true);</span>
<a href="#l59.168"></a><span id="l59.168">   testValidityTable(onlineMailFilter, Is, Keywords, true);</span>
<a href="#l59.169"></a><span id="l59.169">   testValidityTable(onlineMailFilter, Isnt, Keywords, true);</span>
<a href="#l59.170"></a><span id="l59.170">   testValidityTable(onlineMailFilter, IsEmpty, Keywords, true);</span>
<a href="#l59.171"></a><span id="l59.171">   testValidityTable(onlineMailFilter, IsntEmpty, Keywords, true);</span>
<a href="#l59.172"></a><span id="l59.172">   testValidityTable(onlineMailFilter, IsBefore, Keywords, false);</span>
<a href="#l59.173"></a><span id="l59.173"> </span>
<a href="#l59.174"></a><span id="l59.174" class="difflineat">@@ -333,17 +333,17 @@ function run_test()</span>
<a href="#l59.175"></a><span id="l59.175">   let tagArray = MailServices.tags.getAllTags({});</span>
<a href="#l59.176"></a><span id="l59.176">   for (var i = 0; i &lt; tagArray.length; i++)</span>
<a href="#l59.177"></a><span id="l59.177">     MailServices.tags.deleteKey(tagArray[i].key);</span>
<a href="#l59.178"></a><span id="l59.178"> </span>
<a href="#l59.179"></a><span id="l59.179">   // add as valid tags Tag1 and Tag4</span>
<a href="#l59.180"></a><span id="l59.180">   MailServices.tags.addTagForKey(Tag1, Tag1, null, null);</span>
<a href="#l59.181"></a><span id="l59.181">   MailServices.tags.addTagForKey(Tag4, Tag4, null, null);</span>
<a href="#l59.182"></a><span id="l59.182"> </span>
<a href="#l59.183"></a><span id="l59.183" class="difflineminus">-  var copyListener = </span>
<a href="#l59.184"></a><span id="l59.184" class="difflineplus">+  var copyListener =</span>
<a href="#l59.185"></a><span id="l59.185">   {</span>
<a href="#l59.186"></a><span id="l59.186">     OnStartCopy: function() {},</span>
<a href="#l59.187"></a><span id="l59.187">     OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l59.188"></a><span id="l59.188">     SetMessageKey: function(aKey) {</span>
<a href="#l59.189"></a><span id="l59.189">       hdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l59.190"></a><span id="l59.190">     },</span>
<a href="#l59.191"></a><span id="l59.191">     SetMessageId: function(aMessageId) {},</span>
<a href="#l59.192"></a><span id="l59.192">     OnStopCopy: function(aStatus) { testKeywordSearch();}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/mailnews/base/test/unit/test_searchUint32HdrProperty.js</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_searchUint32HdrProperty.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l60.4"></a><span id="l60.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l60.5"></a><span id="l60.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l60.6"></a><span id="l60.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l60.7"></a><span id="l60.7"> </span>
<a href="#l60.8"></a><span id="l60.8"> /*</span>
<a href="#l60.9"></a><span id="l60.9">  * Testing of Uint32HdrProperty search attribute. Adapted from test_search.js</span>
<a href="#l60.10"></a><span id="l60.10">  */</span>
<a href="#l60.11"></a><span id="l60.11" class="difflineminus">- </span>
<a href="#l60.12"></a><span id="l60.12" class="difflineplus">+</span>
<a href="#l60.13"></a><span id="l60.13"> load(&quot;../../../resources/searchTestUtils.js&quot;);</span>
<a href="#l60.14"></a><span id="l60.14"> </span>
<a href="#l60.15"></a><span id="l60.15"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l60.16"></a><span id="l60.16"> </span>
<a href="#l60.17"></a><span id="l60.17"> var nsMsgSearchAttrib = Ci.nsMsgSearchAttrib;</span>
<a href="#l60.18"></a><span id="l60.18"> var nsMsgSearchOp = Ci.nsMsgSearchOp;</span>
<a href="#l60.19"></a><span id="l60.19"> </span>
<a href="#l60.20"></a><span id="l60.20"> var Isnt = nsMsgSearchOp.Isnt;</span>
<a href="#l60.21"></a><span id="l60.21" class="difflineat">@@ -70,17 +70,17 @@ var Tests =</span>
<a href="#l60.22"></a><span id="l60.22">     value: 17,</span>
<a href="#l60.23"></a><span id="l60.23">     count: 0 },</span>
<a href="#l60.24"></a><span id="l60.24"> ];</span>
<a href="#l60.25"></a><span id="l60.25"> </span>
<a href="#l60.26"></a><span id="l60.26"> function run_test()</span>
<a href="#l60.27"></a><span id="l60.27"> {</span>
<a href="#l60.28"></a><span id="l60.28">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l60.29"></a><span id="l60.29"> </span>
<a href="#l60.30"></a><span id="l60.30" class="difflineminus">-  var copyListener = </span>
<a href="#l60.31"></a><span id="l60.31" class="difflineplus">+  var copyListener =</span>
<a href="#l60.32"></a><span id="l60.32">   {</span>
<a href="#l60.33"></a><span id="l60.33">     OnStartCopy: function() {},</span>
<a href="#l60.34"></a><span id="l60.34">     OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l60.35"></a><span id="l60.35">     SetMessageKey: function(aKey) {},</span>
<a href="#l60.36"></a><span id="l60.36">     SetMessageId: function(aMessageId) {},</span>
<a href="#l60.37"></a><span id="l60.37">     OnStopCopy: function(aStatus) { testSearch();}</span>
<a href="#l60.38"></a><span id="l60.38">   };</span>
<a href="#l60.39"></a><span id="l60.39"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/mailnews/base/util/JXON.js</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/mailnews/base/util/JXON.js</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -15,17 +15,17 @@ var JXON = new (function() {</span>
<a href="#l61.4"></a><span id="l61.4">   const sConflictSuffix = &quot;_&quot;; // used when there's a name conflict with special JXON properties</span>
<a href="#l61.5"></a><span id="l61.5">   const aCache = [];</span>
<a href="#l61.6"></a><span id="l61.6">   const rIsNull = /^\s*$/;</span>
<a href="#l61.7"></a><span id="l61.7">   const rIsBool = /^(?:true|false)$/i;</span>
<a href="#l61.8"></a><span id="l61.8"> </span>
<a href="#l61.9"></a><span id="l61.9">   function parseText(sValue) {</span>
<a href="#l61.10"></a><span id="l61.10">     //if (rIsNull.test(sValue))</span>
<a href="#l61.11"></a><span id="l61.11">     //  return null;</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-    if (rIsBool.test(sValue)) </span>
<a href="#l61.13"></a><span id="l61.13" class="difflineplus">+    if (rIsBool.test(sValue))</span>
<a href="#l61.14"></a><span id="l61.14">       return sValue.toLowerCase() === &quot;true&quot;;</span>
<a href="#l61.15"></a><span id="l61.15">     if (isFinite(sValue))</span>
<a href="#l61.16"></a><span id="l61.16">       return parseFloat(sValue);</span>
<a href="#l61.17"></a><span id="l61.17">     if (isFinite(Date.parse(sValue)))</span>
<a href="#l61.18"></a><span id="l61.18">       return new Date(sValue);</span>
<a href="#l61.19"></a><span id="l61.19">     return sValue;</span>
<a href="#l61.20"></a><span id="l61.20">   };</span>
<a href="#l61.21"></a><span id="l61.21"> </span>
<a href="#l61.22"></a><span id="l61.22" class="difflineat">@@ -61,17 +61,17 @@ var JXON = new (function() {</span>
<a href="#l61.23"></a><span id="l61.23">     var nLength = 0;</span>
<a href="#l61.24"></a><span id="l61.24">     var sCollectedTxt = &quot;&quot;;</span>
<a href="#l61.25"></a><span id="l61.25">     var vResult = bHighVerb ? {} : /* put here the default value for empty nodes: */ true;</span>
<a href="#l61.26"></a><span id="l61.26"> </span>
<a href="#l61.27"></a><span id="l61.27">     if (bChildren) {</span>
<a href="#l61.28"></a><span id="l61.28">       for (var oNode, nItem = 0; nItem &lt; oParentNode.childNodes.length; nItem++) {</span>
<a href="#l61.29"></a><span id="l61.29">         oNode = oParentNode.childNodes.item(nItem);</span>
<a href="#l61.30"></a><span id="l61.30">         if (oNode.nodeType === 4) // CDATASection</span>
<a href="#l61.31"></a><span id="l61.31" class="difflineminus">-          sCollectedTxt += oNode.nodeValue; </span>
<a href="#l61.32"></a><span id="l61.32" class="difflineplus">+          sCollectedTxt += oNode.nodeValue;</span>
<a href="#l61.33"></a><span id="l61.33">         else if (oNode.nodeType === 3) // Text</span>
<a href="#l61.34"></a><span id="l61.34">           sCollectedTxt += oNode.nodeValue;</span>
<a href="#l61.35"></a><span id="l61.35">         else if (oNode.nodeType === 1) // Element</span>
<a href="#l61.36"></a><span id="l61.36">           aCache.push(oNode);</span>
<a href="#l61.37"></a><span id="l61.37">       }</span>
<a href="#l61.38"></a><span id="l61.38">     }</span>
<a href="#l61.39"></a><span id="l61.39"> </span>
<a href="#l61.40"></a><span id="l61.40">     const nLevelEnd = aCache.length;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_bug155172.js</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_bug155172.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -91,17 +91,17 @@ add_task(function *() {</span>
<a href="#l62.4"></a><span id="l62.4">                                        &quot;MAIL FROM:&lt;&quot; + kSender + &quot;&gt; BODY=8BITMIME SIZE=159&quot;,</span>
<a href="#l62.5"></a><span id="l62.5">                                        &quot;RCPT TO:&lt;&quot; + kTo + &quot;&gt;&quot;,</span>
<a href="#l62.6"></a><span id="l62.6">                                        &quot;DATA&quot;]);</span>
<a href="#l62.7"></a><span id="l62.7"> </span>
<a href="#l62.8"></a><span id="l62.8">   } catch (e) {</span>
<a href="#l62.9"></a><span id="l62.9">     do_throw(e);</span>
<a href="#l62.10"></a><span id="l62.10">   } finally {</span>
<a href="#l62.11"></a><span id="l62.11">     server.stop();</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-  </span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+</span>
<a href="#l62.14"></a><span id="l62.14">     var thread = gThreadManager.currentThread;</span>
<a href="#l62.15"></a><span id="l62.15">     while (thread.hasPendingEvents())</span>
<a href="#l62.16"></a><span id="l62.16">       thread.processNextEvent(true);</span>
<a href="#l62.17"></a><span id="l62.17">   }</span>
<a href="#l62.18"></a><span id="l62.18"> });</span>
<a href="#l62.19"></a><span id="l62.19"> </span>
<a href="#l62.20"></a><span id="l62.20"> function run_test() {</span>
<a href="#l62.21"></a><span id="l62.21">   run_next_test();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_bug474774.js</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_bug474774.js</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -1,11 +1,11 @@</span>
<a href="#l63.4"></a><span id="l63.4"> /* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l63.5"></a><span id="l63.5"> /**</span>
<a href="#l63.6"></a><span id="l63.6" class="difflineminus">- * Tests bug 474774 - assertions when saving send later and when sending with </span>
<a href="#l63.7"></a><span id="l63.7" class="difflineplus">+ * Tests bug 474774 - assertions when saving send later and when sending with</span>
<a href="#l63.8"></a><span id="l63.8">  * FCC switched off.</span>
<a href="#l63.9"></a><span id="l63.9">  */</span>
<a href="#l63.10"></a><span id="l63.10"> </span>
<a href="#l63.11"></a><span id="l63.11"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l63.12"></a><span id="l63.12"> </span>
<a href="#l63.13"></a><span id="l63.13"> var type = null;</span>
<a href="#l63.14"></a><span id="l63.14"> var test = null;</span>
<a href="#l63.15"></a><span id="l63.15"> var server;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_nsMsgCompose1.js</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_nsMsgCompose1.js</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -138,13 +138,13 @@ function run_test() {</span>
<a href="#l64.4"></a><span id="l64.4">   checkPopulate(&quot;TestList1 &lt;TestList1&gt;, test3@com.invalid&quot;,</span>
<a href="#l64.5"></a><span id="l64.5">                 &quot;test1@foo.invalid,test2@foo.invalid,test3@foo.invalid,test3@com.invalid&quot;);</span>
<a href="#l64.6"></a><span id="l64.6"> </span>
<a href="#l64.7"></a><span id="l64.7">   checkPopulate(&quot;TestList2 &lt;TestList2&gt;, ListTest2 &lt;ListTest2&gt;&quot;,</span>
<a href="#l64.8"></a><span id="l64.8">                 &quot;test4@foo.invalid,test4@com.invalid&quot;);</span>
<a href="#l64.9"></a><span id="l64.9"> </span>
<a href="#l64.10"></a><span id="l64.10">   checkPopulate(&quot;TestList3 &lt;TestList3&gt;, ListTest1 &lt;ListTest1&gt;&quot;,</span>
<a href="#l64.11"></a><span id="l64.11">                 &quot;test5@foo.invalid,test1@com.invalid,test2@com.invalid,test3@com.invalid&quot;);</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-                </span>
<a href="#l64.13"></a><span id="l64.13" class="difflineplus">+</span>
<a href="#l64.14"></a><span id="l64.14">   // test bug 254519 rfc 2047 encoding</span>
<a href="#l64.15"></a><span id="l64.15">   checkPopulate(&quot;=?iso-8859-1?Q?Sure=F6name=2C_Forename_Dr=2E?= &lt;pb@bieringer.invalid&gt;&quot;,</span>
<a href="#l64.16"></a><span id="l64.16">                 &quot;\&quot;Sure\u00F6name, Forename Dr.\&quot; &lt;pb@bieringer.invalid&gt;&quot;);</span>
<a href="#l64.17"></a><span id="l64.17"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_nsMsgCompose2.js</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_nsMsgCompose2.js</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -105,11 +105,11 @@ function run_test() {</span>
<a href="#l65.4"></a><span id="l65.4">   for (i = 0; i &lt; numSendListenerFunctions + 1; ++i) {</span>
<a href="#l65.5"></a><span id="l65.5">     if (i &lt; numSendListenerFunctions)</span>
<a href="#l65.6"></a><span id="l65.6">       Assert.equal(gSLAll[i].mReceived, 0);</span>
<a href="#l65.7"></a><span id="l65.7">     else</span>
<a href="#l65.8"></a><span id="l65.8">       Assert.equal(gSLAll[i].mReceived, 0x3F);</span>
<a href="#l65.9"></a><span id="l65.9">   }</span>
<a href="#l65.10"></a><span id="l65.10"> </span>
<a href="#l65.11"></a><span id="l65.11">   // Test - Remove main listener</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-    </span>
<a href="#l65.13"></a><span id="l65.13" class="difflineplus">+</span>
<a href="#l65.14"></a><span id="l65.14">   gMsgCompose.removeMsgSendListener(gSLAll[numSendListenerFunctions]);</span>
<a href="#l65.15"></a><span id="l65.15"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_nsMsgCompose4.js</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_nsMsgCompose4.js</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -143,17 +143,17 @@ function run_test() {</span>
<a href="#l66.4"></a><span id="l66.4">   checkPopulate(&quot;TestList1 &lt;TestList1&gt;, test3@com.invalid&quot;, &quot;&quot;,</span>
<a href="#l66.5"></a><span id="l66.5">                 SendFormat.AskUser);</span>
<a href="#l66.6"></a><span id="l66.6"> </span>
<a href="#l66.7"></a><span id="l66.7">   checkPopulate(&quot;TestList2 &lt;TestList2&gt;, ListTest2 &lt;ListTest2&gt;&quot;, &quot;&quot;,</span>
<a href="#l66.8"></a><span id="l66.8">                 SendFormat.PlainText);</span>
<a href="#l66.9"></a><span id="l66.9"> </span>
<a href="#l66.10"></a><span id="l66.10">   checkPopulate(&quot;TestList3 &lt;TestList3&gt;, ListTest1 &lt;ListTest1&gt;&quot;, &quot;&quot;,</span>
<a href="#l66.11"></a><span id="l66.11">                 SendFormat.AskUser);</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-                </span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+</span>
<a href="#l66.14"></a><span id="l66.14">   // test bug 254519 rfc 2047 encoding</span>
<a href="#l66.15"></a><span id="l66.15">   checkPopulate(&quot;=?iso-8859-1?Q?Sure=F6name=2C_Forename__Dr=2E?= &lt;pb@bieringer.invalid&gt;&quot;, &quot;&quot;,</span>
<a href="#l66.16"></a><span id="l66.16">                 SendFormat.AskUser);</span>
<a href="#l66.17"></a><span id="l66.17"> </span>
<a href="#l66.18"></a><span id="l66.18">   // Try some fields with newsgroups</span>
<a href="#l66.19"></a><span id="l66.19">   checkPopulate(&quot;test4@foo.invalid&quot;, &quot;mozilla.test&quot;, SendFormat.AskUser);</span>
<a href="#l66.20"></a><span id="l66.20">   checkPopulate(&quot;test5@foo.invalid&quot;, &quot;mozilla.test&quot;, SendFormat.AskUser);</span>
<a href="#l66.21"></a><span id="l66.21">   checkPopulate(&quot;&quot;, &quot;mozilla.test&quot;, SendFormat.AskUser);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_nsSmtpService1.js</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_nsSmtpService1.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -42,17 +42,17 @@ function run_test() {</span>
<a href="#l67.4"></a><span id="l67.4">   // Test - Check default server is still ok</span>
<a href="#l67.5"></a><span id="l67.5">   Assert.equal(smtpServer, smtpService.defaultServer);</span>
<a href="#l67.6"></a><span id="l67.6"> </span>
<a href="#l67.7"></a><span id="l67.7">   // Test - Delete the only server</span>
<a href="#l67.8"></a><span id="l67.8">   smtpService.deleteServer(smtpServer);</span>
<a href="#l67.9"></a><span id="l67.9"> </span>
<a href="#l67.10"></a><span id="l67.10">   smtpServers = smtpService.servers;</span>
<a href="#l67.11"></a><span id="l67.11">   Assert.ok(!smtpServers.hasMoreElements());</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">- </span>
<a href="#l67.13"></a><span id="l67.13" class="difflineplus">+</span>
<a href="#l67.14"></a><span id="l67.14">   //    do_check_eq(null, smtpService.defaultServer);</span>
<a href="#l67.15"></a><span id="l67.15"> </span>
<a href="#l67.16"></a><span id="l67.16">   // Test - add multiple servers</span>
<a href="#l67.17"></a><span id="l67.17"> </span>
<a href="#l67.18"></a><span id="l67.18">   var smtpServerArray = new Array(3);</span>
<a href="#l67.19"></a><span id="l67.19">   var i;</span>
<a href="#l67.20"></a><span id="l67.20"> </span>
<a href="#l67.21"></a><span id="l67.21">   for (i = 0; i &lt; 3; ++i)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendBackground.js</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendBackground.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -37,17 +37,17 @@ msll.prototype = {</span>
<a href="#l68.4"></a><span id="l68.4">     Assert.equal(gMsgSendLater.sendingMessages, true);</span>
<a href="#l68.5"></a><span id="l68.5">     Assert.equal(aTotal, 1);</span>
<a href="#l68.6"></a><span id="l68.6">   },</span>
<a href="#l68.7"></a><span id="l68.7">   onMessageStartSending: function (aCurrentMessage, aTotalMessageCount,</span>
<a href="#l68.8"></a><span id="l68.8">                                    aMessageHeader, aIdentity) {</span>
<a href="#l68.9"></a><span id="l68.9">   },</span>
<a href="#l68.10"></a><span id="l68.10">   onMessageSendProgress: function (aCurrentMessage, aTotalMessageCount,</span>
<a href="#l68.11"></a><span id="l68.11">                                    aMessageSendPercent, aMessageCopyPercent) {</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-  }, </span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+  },</span>
<a href="#l68.14"></a><span id="l68.14">   onMessageSendError: function (aCurrentMessage, aMessageHeader, aStatus,</span>
<a href="#l68.15"></a><span id="l68.15">                                 aMsg) {</span>
<a href="#l68.16"></a><span id="l68.16">     do_throw(&quot;onMessageSendError should not have been called, status: &quot; + aStatus);</span>
<a href="#l68.17"></a><span id="l68.17">   },</span>
<a href="#l68.18"></a><span id="l68.18">   onStopSending: function (aStatus, aMsg, aTotalTried, aSuccessful) {</span>
<a href="#l68.19"></a><span id="l68.19">     do_test_finished();</span>
<a href="#l68.20"></a><span id="l68.20">     print(&quot;msll onStopSending\n&quot;);</span>
<a href="#l68.21"></a><span id="l68.21">     try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMailMessage.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMailMessage.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -113,17 +113,17 @@ function test_RFC2821() {</span>
<a href="#l69.4"></a><span id="l69.4">                                        &quot;MAIL FROM:&lt;&quot; + kSender + &quot;&gt; BODY=8BITMIME SIZE=159&quot;,</span>
<a href="#l69.5"></a><span id="l69.5">                                        &quot;RCPT TO:&lt;&quot; + kTo + &quot;&gt;&quot;,</span>
<a href="#l69.6"></a><span id="l69.6">                                        &quot;DATA&quot;]);</span>
<a href="#l69.7"></a><span id="l69.7"> </span>
<a href="#l69.8"></a><span id="l69.8">   } catch (e) {</span>
<a href="#l69.9"></a><span id="l69.9">     do_throw(e);</span>
<a href="#l69.10"></a><span id="l69.10">   } finally {</span>
<a href="#l69.11"></a><span id="l69.11">     server.stop();</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-  </span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+</span>
<a href="#l69.14"></a><span id="l69.14">     var thread = gThreadManager.currentThread;</span>
<a href="#l69.15"></a><span id="l69.15">     while (thread.hasPendingEvents())</span>
<a href="#l69.16"></a><span id="l69.16">       thread.processNextEvent(true);</span>
<a href="#l69.17"></a><span id="l69.17">   }</span>
<a href="#l69.18"></a><span id="l69.18"> }</span>
<a href="#l69.19"></a><span id="l69.19"> </span>
<a href="#l69.20"></a><span id="l69.20"> function run_test() {</span>
<a href="#l69.21"></a><span id="l69.21">   server = setupServerDaemon();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageFile.js</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageFile.js</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -155,14 +155,14 @@ function run_test() {</span>
<a href="#l70.4"></a><span id="l70.4">       );</span>
<a href="#l70.5"></a><span id="l70.5"> </span>
<a href="#l70.6"></a><span id="l70.6">     do_test_pending();</span>
<a href="#l70.7"></a><span id="l70.7"> </span>
<a href="#l70.8"></a><span id="l70.8">   } catch (e) {</span>
<a href="#l70.9"></a><span id="l70.9">     do_throw(e);</span>
<a href="#l70.10"></a><span id="l70.10">   } finally {</span>
<a href="#l70.11"></a><span id="l70.11">     server.stop();</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-  </span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+</span>
<a href="#l70.14"></a><span id="l70.14">     var thread = gThreadManager.currentThread;</span>
<a href="#l70.15"></a><span id="l70.15">     while (thread.hasPendingEvents())</span>
<a href="#l70.16"></a><span id="l70.16">       thread.processNextEvent(true);</span>
<a href="#l70.17"></a><span id="l70.17">   }</span>
<a href="#l70.18"></a><span id="l70.18"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageLater2.js</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageLater2.js</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l71.4"></a><span id="l71.4">  * times in the same session.</span>
<a href="#l71.5"></a><span id="l71.5">  *</span>
<a href="#l71.6"></a><span id="l71.6">  * XXX: This test is intended to additionally test sending of multiple messages</span>
<a href="#l71.7"></a><span id="l71.7">  * from one send later instance, however due to the fact we use one connection</span>
<a href="#l71.8"></a><span id="l71.8">  * per message sent, it is very difficult to consistently get the fake server</span>
<a href="#l71.9"></a><span id="l71.9">  * reconected in time for the next connection. Thus, sending of multiple</span>
<a href="#l71.10"></a><span id="l71.10">  * messages is currently disabled (but commented out for local testing if</span>
<a href="#l71.11"></a><span id="l71.11">  * required), when we fix bug 136871 we should be able to enable the multiple</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">- * messages option. </span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+ * messages option.</span>
<a href="#l71.14"></a><span id="l71.14">  */</span>
<a href="#l71.15"></a><span id="l71.15"> </span>
<a href="#l71.16"></a><span id="l71.16"> load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l71.17"></a><span id="l71.17"> load(&quot;../../../resources/asyncTestUtils.js&quot;);</span>
<a href="#l71.18"></a><span id="l71.18"> </span>
<a href="#l71.19"></a><span id="l71.19"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l71.20"></a><span id="l71.20"> </span>
<a href="#l71.21"></a><span id="l71.21"> var test = &quot;sendMessageLater&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_sendMessageLater3.js</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_sendMessageLater3.js</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -82,17 +82,17 @@ function OnStopCopy(aStatus) {</span>
<a href="#l72.4"></a><span id="l72.4">   let folder = msgSendLater.getUnsentMessagesFolder(identity);</span>
<a href="#l72.5"></a><span id="l72.5"> </span>
<a href="#l72.6"></a><span id="l72.6">   // Check that the send later service thinks we have messages to send.</span>
<a href="#l72.7"></a><span id="l72.7">   Assert.equal(msgSendLater.hasUnsentMessages(identity), true);</span>
<a href="#l72.8"></a><span id="l72.8"> </span>
<a href="#l72.9"></a><span id="l72.9">   // Check we have a message in the unsent message folder</span>
<a href="#l72.10"></a><span id="l72.10">   Assert.equal(folder.getTotalMessages(false), 1);</span>
<a href="#l72.11"></a><span id="l72.11"> </span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-  </span>
<a href="#l72.13"></a><span id="l72.13" class="difflineplus">+</span>
<a href="#l72.14"></a><span id="l72.14">   // Now do a comparison of what is in the unsent mail folder</span>
<a href="#l72.15"></a><span id="l72.15">   let msgData = mailTestUtils</span>
<a href="#l72.16"></a><span id="l72.16">     .loadMessageToString(folder, mailTestUtils.firstMsgHdr(folder));</span>
<a href="#l72.17"></a><span id="l72.17"> </span>
<a href="#l72.18"></a><span id="l72.18">   // Skip the headers etc that mailnews adds</span>
<a href="#l72.19"></a><span id="l72.19">   var pos = msgData.indexOf(&quot;From:&quot;);</span>
<a href="#l72.20"></a><span id="l72.20">   Assert.notEqual(pos, -1);</span>
<a href="#l72.21"></a><span id="l72.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_smtp8bitMime.js</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_smtp8bitMime.js</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -55,17 +55,17 @@ function test_8bitmime(aStrictMime, aSer</span>
<a href="#l73.4"></a><span id="l73.4"> </span>
<a href="#l73.5"></a><span id="l73.5">     server.resetTest();</span>
<a href="#l73.6"></a><span id="l73.6"> </span>
<a href="#l73.7"></a><span id="l73.7"> </span>
<a href="#l73.8"></a><span id="l73.8">   } catch (e) {</span>
<a href="#l73.9"></a><span id="l73.9">     do_throw(e);</span>
<a href="#l73.10"></a><span id="l73.10">   } finally {</span>
<a href="#l73.11"></a><span id="l73.11">     server.stop();</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">- </span>
<a href="#l73.13"></a><span id="l73.13" class="difflineplus">+</span>
<a href="#l73.14"></a><span id="l73.14">     var thread = gThreadManager.currentThread;</span>
<a href="#l73.15"></a><span id="l73.15">     while (thread.hasPendingEvents())</span>
<a href="#l73.16"></a><span id="l73.16">       thread.processNextEvent(true);</span>
<a href="#l73.17"></a><span id="l73.17">   }</span>
<a href="#l73.18"></a><span id="l73.18"> }</span>
<a href="#l73.19"></a><span id="l73.19"> </span>
<a href="#l73.20"></a><span id="l73.20"> function run_test() {</span>
<a href="#l73.21"></a><span id="l73.21">   // The default SMTP server advertises 8BITMIME capability.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/mailnews/compose/test/unit/test_smtpPassword.js</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/mailnews/compose/test/unit/test_smtpPassword.js</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -65,17 +65,17 @@ add_task(function *() {</span>
<a href="#l74.4"></a><span id="l74.4">                                        &quot;MAIL FROM:&lt;&quot; + kSender + &quot;&gt; BODY=8BITMIME SIZE=159&quot;,</span>
<a href="#l74.5"></a><span id="l74.5">                                        &quot;RCPT TO:&lt;&quot; + kTo + &quot;&gt;&quot;,</span>
<a href="#l74.6"></a><span id="l74.6">                                        &quot;DATA&quot;]);</span>
<a href="#l74.7"></a><span id="l74.7"> </span>
<a href="#l74.8"></a><span id="l74.8">   } catch (e) {</span>
<a href="#l74.9"></a><span id="l74.9">     do_throw(e);</span>
<a href="#l74.10"></a><span id="l74.10">   } finally {</span>
<a href="#l74.11"></a><span id="l74.11">     server.stop();</span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-  </span>
<a href="#l74.13"></a><span id="l74.13" class="difflineplus">+</span>
<a href="#l74.14"></a><span id="l74.14">     var thread = gThreadManager.currentThread;</span>
<a href="#l74.15"></a><span id="l74.15">     while (thread.hasPendingEvents())</span>
<a href="#l74.16"></a><span id="l74.16">       thread.processNextEvent(true);</span>
<a href="#l74.17"></a><span id="l74.17">   }</span>
<a href="#l74.18"></a><span id="l74.18"> });</span>
<a href="#l74.19"></a><span id="l74.19"> </span>
<a href="#l74.20"></a><span id="l74.20"> function run_test() {</span>
<a href="#l74.21"></a><span id="l74.21">   run_next_test();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1" class="difflineminus">--- a/mailnews/db/gloda/modules/collection.js</span>
<a href="#l75.2"></a><span id="l75.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/collection.js</span>
<a href="#l75.3"></a><span id="l75.3" class="difflineat">@@ -382,17 +382,17 @@ var GlodaCollectionManager = {</span>
<a href="#l75.4"></a><span id="l75.4">   /**</span>
<a href="#l75.5"></a><span id="l75.5">    * This should be called when items in the global database are permanently-ish</span>
<a href="#l75.6"></a><span id="l75.6">    *  deleted.  (This is distinct from concepts like message deletion which may</span>
<a href="#l75.7"></a><span id="l75.7">    *  involved trash folders or other modified forms of existence.  Deleted</span>
<a href="#l75.8"></a><span id="l75.8">    *  means the data is gone and if it were to come back, it would come back</span>
<a href="#l75.9"></a><span id="l75.9">    *  via an itemsAdded event.)</span>
<a href="#l75.10"></a><span id="l75.10">    * We walk all existing collections for the given noun type.  For items</span>
<a href="#l75.11"></a><span id="l75.11">    *  currently in the collection, we generate onItemsRemoved events.</span>
<a href="#l75.12"></a><span id="l75.12" class="difflineminus">-   * </span>
<a href="#l75.13"></a><span id="l75.13" class="difflineplus">+   *</span>
<a href="#l75.14"></a><span id="l75.14">    * @param aItemIds A list of item ids that are being deleted.</span>
<a href="#l75.15"></a><span id="l75.15">    */</span>
<a href="#l75.16"></a><span id="l75.16">   itemsDeleted: function gloda_colm_itemsDeleted(aNounID, aItemIds) {</span>
<a href="#l75.17"></a><span id="l75.17">     // cache</span>
<a href="#l75.18"></a><span id="l75.18">     let cache = this._cachesByNoun[aNounID];</span>
<a href="#l75.19"></a><span id="l75.19">     if (cache) {</span>
<a href="#l75.20"></a><span id="l75.20">       for (let itemId of aItemIds) {</span>
<a href="#l75.21"></a><span id="l75.21">         if (itemId in cache._idMap)</span>
<a href="#l75.22"></a><span id="l75.22" class="difflineat">@@ -408,23 +408,23 @@ var GlodaCollectionManager = {</span>
<a href="#l75.23"></a><span id="l75.23">         collection._onItemsRemoved(removeItems);</span>
<a href="#l75.24"></a><span id="l75.24">     }</span>
<a href="#l75.25"></a><span id="l75.25">   },</span>
<a href="#l75.26"></a><span id="l75.26">   /**</span>
<a href="#l75.27"></a><span id="l75.27">    * Like |itemsDeleted| but for the case where the deletion is based on an</span>
<a href="#l75.28"></a><span id="l75.28">    *  attribute that SQLite can more efficiently check than we can and where the</span>
<a href="#l75.29"></a><span id="l75.29">    *  cost of scanning the in-memory items is presumably much cheaper than</span>
<a href="#l75.30"></a><span id="l75.30">    *  trying to figure out what actually got deleted.</span>
<a href="#l75.31"></a><span id="l75.31" class="difflineminus">-   * </span>
<a href="#l75.32"></a><span id="l75.32" class="difflineplus">+   *</span>
<a href="#l75.33"></a><span id="l75.33">    * Since we are doing an in-memory walk, this is obviously O(n) where n is the</span>
<a href="#l75.34"></a><span id="l75.34">    *  number of noun instances of a given type in-memory.  We are assuming this</span>
<a href="#l75.35"></a><span id="l75.35">    *  is a reasonable number of things and that this type of deletion call is</span>
<a href="#l75.36"></a><span id="l75.36">    *  not going to happen all that frequently.  If these assumptions are wrong,</span>
<a href="#l75.37"></a><span id="l75.37">    *  callers are advised to re-think the whole situation.</span>
<a href="#l75.38"></a><span id="l75.38" class="difflineminus">-   * </span>
<a href="#l75.39"></a><span id="l75.39" class="difflineplus">+   *</span>
<a href="#l75.40"></a><span id="l75.40">    * @param aNounID Type of noun we are talking about here.</span>
<a href="#l75.41"></a><span id="l75.41">    * @param aFilter A filter function that returns true when the item should be</span>
<a href="#l75.42"></a><span id="l75.42">    *     thought of as deleted, or false if the item is still good.  Screw this</span>
<a href="#l75.43"></a><span id="l75.43">    *     up and you will get some seriously wacky bugs, yo.</span>
<a href="#l75.44"></a><span id="l75.44">    */</span>
<a href="#l75.45"></a><span id="l75.45">   itemsDeletedByAttribute: function gloda_colm_itemsDeletedByAttribute(</span>
<a href="#l75.46"></a><span id="l75.46">       aNounID, aFilter) {</span>
<a href="#l75.47"></a><span id="l75.47">     // cache</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1" class="difflineminus">--- a/mailnews/db/gloda/modules/suffixtree.js</span>
<a href="#l76.2"></a><span id="l76.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/suffixtree.js</span>
<a href="#l76.3"></a><span id="l76.3" class="difflineat">@@ -15,17 +15,17 @@ function MultiSuffixTree(aStrings, aItem</span>
<a href="#l76.4"></a><span id="l76.4">   let s = '';</span>
<a href="#l76.5"></a><span id="l76.5">   let offsetsToItems = [];</span>
<a href="#l76.6"></a><span id="l76.6">   let lastLength = 0;</span>
<a href="#l76.7"></a><span id="l76.7">   for (let i = 0; i &lt; aStrings.length; i++) {</span>
<a href="#l76.8"></a><span id="l76.8">     s += aStrings[i];</span>
<a href="#l76.9"></a><span id="l76.9">     offsetsToItems.push(lastLength, s.length, aItems[i]);</span>
<a href="#l76.10"></a><span id="l76.10">     lastLength = s.length;</span>
<a href="#l76.11"></a><span id="l76.11">   }</span>
<a href="#l76.12"></a><span id="l76.12" class="difflineminus">-  </span>
<a href="#l76.13"></a><span id="l76.13" class="difflineplus">+</span>
<a href="#l76.14"></a><span id="l76.14">   this._construct(s);</span>
<a href="#l76.15"></a><span id="l76.15">   this._offsetsToItems = offsetsToItems;</span>
<a href="#l76.16"></a><span id="l76.16">   this._numItems = aItems.length;</span>
<a href="#l76.17"></a><span id="l76.17"> }</span>
<a href="#l76.18"></a><span id="l76.18"> </span>
<a href="#l76.19"></a><span id="l76.19"> /**</span>
<a href="#l76.20"></a><span id="l76.20">  * @constructor</span>
<a href="#l76.21"></a><span id="l76.21">  */</span>
<a href="#l76.22"></a><span id="l76.22" class="difflineat">@@ -54,37 +54,37 @@ State.prototype = {</span>
<a href="#l76.23"></a><span id="l76.23">   get isExplicit() {</span>
<a href="#l76.24"></a><span id="l76.24">     // our end is not inclusive...</span>
<a href="#l76.25"></a><span id="l76.25">     return (this.end &lt;= this.start);</span>
<a href="#l76.26"></a><span id="l76.26">   },</span>
<a href="#l76.27"></a><span id="l76.27">   get isImplicit() {</span>
<a href="#l76.28"></a><span id="l76.28">     // our end is not inclusive...</span>
<a href="#l76.29"></a><span id="l76.29">     return (this.end &gt; this.start);</span>
<a href="#l76.30"></a><span id="l76.30">   },</span>
<a href="#l76.31"></a><span id="l76.31" class="difflineminus">-  </span>
<a href="#l76.32"></a><span id="l76.32" class="difflineplus">+</span>
<a href="#l76.33"></a><span id="l76.33">   get length() {</span>
<a href="#l76.34"></a><span id="l76.34">     return this.end - this.start;</span>
<a href="#l76.35"></a><span id="l76.35">   },</span>
<a href="#l76.36"></a><span id="l76.36" class="difflineminus">-  </span>
<a href="#l76.37"></a><span id="l76.37" class="difflineplus">+</span>
<a href="#l76.38"></a><span id="l76.38">   toString: function State_toString() {</span>
<a href="#l76.39"></a><span id="l76.39">     return &quot;[Start: &quot; + this.start + &quot; End: &quot; + this.end +</span>
<a href="#l76.40"></a><span id="l76.40" class="difflineminus">-           (this.suffix ? &quot; non-null suffix]&quot; : &quot; null suffix]&quot;); </span>
<a href="#l76.41"></a><span id="l76.41" class="difflineplus">+           (this.suffix ? &quot; non-null suffix]&quot; : &quot; null suffix]&quot;);</span>
<a href="#l76.42"></a><span id="l76.42">   }</span>
<a href="#l76.43"></a><span id="l76.43"> };</span>
<a href="#l76.44"></a><span id="l76.44"> </span>
<a href="#l76.45"></a><span id="l76.45"> /**</span>
<a href="#l76.46"></a><span id="l76.46">  * Suffix tree implemented using Ukkonen's algorithm.</span>
<a href="#l76.47"></a><span id="l76.47">  * @constructor</span>
<a href="#l76.48"></a><span id="l76.48">  */</span>
<a href="#l76.49"></a><span id="l76.49"> function SuffixTree(aStr) {</span>
<a href="#l76.50"></a><span id="l76.50">   this._construct(aStr);</span>
<a href="#l76.51"></a><span id="l76.51"> }</span>
<a href="#l76.52"></a><span id="l76.52"> </span>
<a href="#l76.53"></a><span id="l76.53"> /**</span>
<a href="#l76.54"></a><span id="l76.54" class="difflineminus">- * States are </span>
<a href="#l76.55"></a><span id="l76.55" class="difflineplus">+ * States are</span>
<a href="#l76.56"></a><span id="l76.56">  */</span>
<a href="#l76.57"></a><span id="l76.57"> SuffixTree.prototype = {</span>
<a href="#l76.58"></a><span id="l76.58">   /**</span>
<a href="#l76.59"></a><span id="l76.59">    * Find all items matching the provided substring.</span>
<a href="#l76.60"></a><span id="l76.60">    */</span>
<a href="#l76.61"></a><span id="l76.61">   findMatches: function findMatches(aSubstring) {</span>
<a href="#l76.62"></a><span id="l76.62">     let results = [];</span>
<a href="#l76.63"></a><span id="l76.63">     let state = this._root;</span>
<a href="#l76.64"></a><span id="l76.64" class="difflineat">@@ -100,137 +100,137 @@ SuffixTree.prototype = {</span>
<a href="#l76.65"></a><span id="l76.65">       let actualTraverseLength = Math.min(state.length,</span>
<a href="#l76.66"></a><span id="l76.66">                                           end - index);</span>
<a href="#l76.67"></a><span id="l76.67">       if (this._str.substring(state.start,</span>
<a href="#l76.68"></a><span id="l76.68">                               state.start + actualTraverseLength) !=</span>
<a href="#l76.69"></a><span id="l76.69">           aSubstring.substring(index, index + actualTraverseLength))</span>
<a href="#l76.70"></a><span id="l76.70">         return results;</span>
<a href="#l76.71"></a><span id="l76.71">       index += state.length;</span>
<a href="#l76.72"></a><span id="l76.72">     }</span>
<a href="#l76.73"></a><span id="l76.73" class="difflineminus">-    </span>
<a href="#l76.74"></a><span id="l76.74" class="difflineplus">+</span>
<a href="#l76.75"></a><span id="l76.75">     // state should now be the node which itself and all its children match...</span>
<a href="#l76.76"></a><span id="l76.76">     // The delta is to adjust us to the offset of the last letter of our match;</span>
<a href="#l76.77"></a><span id="l76.77">     //  the edge we traversed to get here may have found us traversing more</span>
<a href="#l76.78"></a><span id="l76.78">     //  than we wanted.</span>
<a href="#l76.79"></a><span id="l76.79">     // index - end captures the over-shoot of the edge traversal,</span>
<a href="#l76.80"></a><span id="l76.80">     // index - end + 1 captures the fact that we want to find the last letter</span>
<a href="#l76.81"></a><span id="l76.81">     //  that matched, not just the first letter beyond it</span>
<a href="#l76.82"></a><span id="l76.82">     // However, if this state is a leaf node (end == 'infinity'), then 'end'</span>
<a href="#l76.83"></a><span id="l76.83">     //  isn't describing an edge at all and we want to avoid accounting for it.</span>
<a href="#l76.84"></a><span id="l76.84">     let delta;</span>
<a href="#l76.85"></a><span id="l76.85">     /*</span>
<a href="#l76.86"></a><span id="l76.86">     if (state.end != this._infinity)</span>
<a href="#l76.87"></a><span id="l76.87">       //delta = index - end + 1;</span>
<a href="#l76.88"></a><span id="l76.88" class="difflineminus">-      delta = end - (index - state.length); </span>
<a href="#l76.89"></a><span id="l76.89" class="difflineplus">+      delta = end - (index - state.length);</span>
<a href="#l76.90"></a><span id="l76.90">     else */</span>
<a href="#l76.91"></a><span id="l76.91">     delta = index - state.length - end + 1;</span>
<a href="#l76.92"></a><span id="l76.92" class="difflineminus">- </span>
<a href="#l76.93"></a><span id="l76.93" class="difflineplus">+</span>
<a href="#l76.94"></a><span id="l76.94">     this._resultGather(state, results, {}, end, delta, true);</span>
<a href="#l76.95"></a><span id="l76.95">     return results;</span>
<a href="#l76.96"></a><span id="l76.96">   },</span>
<a href="#l76.97"></a><span id="l76.97" class="difflineminus">-  </span>
<a href="#l76.98"></a><span id="l76.98" class="difflineplus">+</span>
<a href="#l76.99"></a><span id="l76.99">   _resultGather: function resultGather(aState, aResults, aPresence,</span>
<a href="#l76.100"></a><span id="l76.100">                                        aPatLength, aDelta, alreadyAdjusted) {</span>
<a href="#l76.101"></a><span id="l76.101">     // find the item that this state originated from based on the state's</span>
<a href="#l76.102"></a><span id="l76.102">     //  start character.  offsetToItem holds [string start index, string end</span>
<a href="#l76.103"></a><span id="l76.103">     //  index (exclusive), item reference].  So we want to binary search to</span>
<a href="#l76.104"></a><span id="l76.104">     //  find the string whose start/end index contains the state's start index.</span>
<a href="#l76.105"></a><span id="l76.105">     let low = 0;</span>
<a href="#l76.106"></a><span id="l76.106">     let high = this._numItems-1;</span>
<a href="#l76.107"></a><span id="l76.107">     let mid, stringStart, stringEnd;</span>
<a href="#l76.108"></a><span id="l76.108" class="difflineminus">-    </span>
<a href="#l76.109"></a><span id="l76.109" class="difflineplus">+</span>
<a href="#l76.110"></a><span id="l76.110">     let patternLast = aState.start - aDelta;</span>
<a href="#l76.111"></a><span id="l76.111">     while (low &lt;= high) {</span>
<a href="#l76.112"></a><span id="l76.112">       mid = low + Math.floor((high - low) / 2); // excessive, especially with js nums</span>
<a href="#l76.113"></a><span id="l76.113">       stringStart = this._offsetsToItems[mid*3];</span>
<a href="#l76.114"></a><span id="l76.114">       let startDelta = stringStart - patternLast;</span>
<a href="#l76.115"></a><span id="l76.115">       stringEnd = this._offsetsToItems[mid*3+1];</span>
<a href="#l76.116"></a><span id="l76.116">       let endDelta = stringEnd - patternLast;</span>
<a href="#l76.117"></a><span id="l76.117">       if (startDelta &gt; 0)</span>
<a href="#l76.118"></a><span id="l76.118">         high = mid - 1;</span>
<a href="#l76.119"></a><span id="l76.119">       else if (endDelta &lt;= 0)</span>
<a href="#l76.120"></a><span id="l76.120">         low = mid + 1;</span>
<a href="#l76.121"></a><span id="l76.121">       else {</span>
<a href="#l76.122"></a><span id="l76.122">         break;</span>
<a href="#l76.123"></a><span id="l76.123">       }</span>
<a href="#l76.124"></a><span id="l76.124">     }</span>
<a href="#l76.125"></a><span id="l76.125" class="difflineminus">-    </span>
<a href="#l76.126"></a><span id="l76.126" class="difflineplus">+</span>
<a href="#l76.127"></a><span id="l76.127">     // - The match occurred completely inside a source string.  Success.</span>
<a href="#l76.128"></a><span id="l76.128">     // - The match spans more than one source strings, and is therefore not</span>
<a href="#l76.129"></a><span id="l76.129">     //   a match.</span>
<a href="#l76.130"></a><span id="l76.130" class="difflineminus">-    </span>
<a href="#l76.131"></a><span id="l76.131" class="difflineplus">+</span>
<a href="#l76.132"></a><span id="l76.132">     // at this point, we have located the origin string that corresponds to the</span>
<a href="#l76.133"></a><span id="l76.133">     //  start index of this state.</span>
<a href="#l76.134"></a><span id="l76.134">     // - The match terminated with the end of the preceding string, and does</span>
<a href="#l76.135"></a><span id="l76.135">     //   not match us at all.  We, and potentially our children, are merely</span>
<a href="#l76.136"></a><span id="l76.136">     //   serving as a unique terminal.</span>
<a href="#l76.137"></a><span id="l76.137" class="difflineminus">-    // - The </span>
<a href="#l76.138"></a><span id="l76.138" class="difflineplus">+    // - The</span>
<a href="#l76.139"></a><span id="l76.139"> </span>
<a href="#l76.140"></a><span id="l76.140">   let patternFirst = patternLast - (aPatLength - 1);</span>
<a href="#l76.141"></a><span id="l76.141"> </span>
<a href="#l76.142"></a><span id="l76.142">   if (patternFirst &gt;= stringStart) {</span>
<a href="#l76.143"></a><span id="l76.143">     if (!(stringStart in aPresence)) {</span>
<a href="#l76.144"></a><span id="l76.144">       aPresence[stringStart] = true;</span>
<a href="#l76.145"></a><span id="l76.145">       aResults.push(this._offsetsToItems[mid*3+2]);</span>
<a href="#l76.146"></a><span id="l76.146">     }</span>
<a href="#l76.147"></a><span id="l76.147">   }</span>
<a href="#l76.148"></a><span id="l76.148" class="difflineminus">-    </span>
<a href="#l76.149"></a><span id="l76.149" class="difflineplus">+</span>
<a href="#l76.150"></a><span id="l76.150">     // bail if we had it coming OR</span>
<a href="#l76.151"></a><span id="l76.151">     // if the result terminates at/part-way through this state, meaning any</span>
<a href="#l76.152"></a><span id="l76.152">     //  of its children are not going to be actual results, just hangers</span>
<a href="#l76.153"></a><span id="l76.153">     //  on.</span>
<a href="#l76.154"></a><span id="l76.154"> /*</span>
<a href="#l76.155"></a><span id="l76.155">     if (bail || (end &lt;= aState.end)) {</span>
<a href="#l76.156"></a><span id="l76.156"> dump(&quot;  bailing! (bail was: &quot; + bail + &quot;)\n&quot;);</span>
<a href="#l76.157"></a><span id="l76.157">       return;</span>
<a href="#l76.158"></a><span id="l76.158">     }</span>
<a href="#l76.159"></a><span id="l76.159" class="difflineminus">-*/    </span>
<a href="#l76.160"></a><span id="l76.160" class="difflineplus">+*/</span>
<a href="#l76.161"></a><span id="l76.161">     // process our children...</span>
<a href="#l76.162"></a><span id="l76.162">     for (let key in aState) {</span>
<a href="#l76.163"></a><span id="l76.163">       // edges have attributes of length 1...</span>
<a href="#l76.164"></a><span id="l76.164">       if (key.length == 1) {</span>
<a href="#l76.165"></a><span id="l76.165">         let statePrime = aState[key];</span>
<a href="#l76.166"></a><span id="l76.166">         this._resultGather(statePrime, aResults, aPresence, aPatLength,</span>
<a href="#l76.167"></a><span id="l76.167">                            aDelta + aState.length, //(alreadyAdjusted ? 0 : aState.length),</span>
<a href="#l76.168"></a><span id="l76.168">                            false);</span>
<a href="#l76.169"></a><span id="l76.169">       }</span>
<a href="#l76.170"></a><span id="l76.170">     }</span>
<a href="#l76.171"></a><span id="l76.171">   },</span>
<a href="#l76.172"></a><span id="l76.172"> </span>
<a href="#l76.173"></a><span id="l76.173">   /**</span>
<a href="#l76.174"></a><span id="l76.174">    * Given a reference 'pair' of a state and a string (may be 'empty'=explicit,</span>
<a href="#l76.175"></a><span id="l76.175">    *  which means no work to do and we return immediately) follow that state</span>
<a href="#l76.176"></a><span id="l76.176">    *  (and then the successive states)'s transitions until we run out of</span>
<a href="#l76.177"></a><span id="l76.177" class="difflineminus">-   *  transitions.  This happens either when we find an explicit state, or </span>
<a href="#l76.178"></a><span id="l76.178" class="difflineplus">+   *  transitions.  This happens either when we find an explicit state, or</span>
<a href="#l76.179"></a><span id="l76.179">    *  find ourselves partially along an edge (conceptually speaking).  In</span>
<a href="#l76.180"></a><span id="l76.180">    *  the partial case, we return the state prior to the edge traversal.</span>
<a href="#l76.181"></a><span id="l76.181">    * (The information about the 'edge' is contained on its target State;</span>
<a href="#l76.182"></a><span id="l76.182" class="difflineminus">-   *  we can do this because a state is only referenced by one other state.) </span>
<a href="#l76.183"></a><span id="l76.183" class="difflineplus">+   *  we can do this because a state is only referenced by one other state.)</span>
<a href="#l76.184"></a><span id="l76.184">    */</span>
<a href="#l76.185"></a><span id="l76.185">   _canonize: function canonize(aState, aStart, aEnd) {</span>
<a href="#l76.186"></a><span id="l76.186">     if (aEnd &lt;= aStart) {</span>
<a href="#l76.187"></a><span id="l76.187">       return [aState, aStart];</span>
<a href="#l76.188"></a><span id="l76.188">     }</span>
<a href="#l76.189"></a><span id="l76.189" class="difflineminus">-  </span>
<a href="#l76.190"></a><span id="l76.190" class="difflineplus">+</span>
<a href="#l76.191"></a><span id="l76.191">     let statePrime;</span>
<a href="#l76.192"></a><span id="l76.192">     // we treat an aState of null as 'bottom', which has transitions for every</span>
<a href="#l76.193"></a><span id="l76.193">     //  letter in the alphabet to 'root'.  rather than create all those</span>
<a href="#l76.194"></a><span id="l76.194">     //  transitions, we special-case here.</span>
<a href="#l76.195"></a><span id="l76.195">     if (aState === null)</span>
<a href="#l76.196"></a><span id="l76.196">       statePrime = this._root;</span>
<a href="#l76.197"></a><span id="l76.197">     else</span>
<a href="#l76.198"></a><span id="l76.198">       statePrime = aState[this._str[aStart]];</span>
<a href="#l76.199"></a><span id="l76.199">     while (statePrime.length &lt;= aEnd - aStart) { // (no 1 adjustment required)</span>
<a href="#l76.200"></a><span id="l76.200">       aStart += statePrime.length;</span>
<a href="#l76.201"></a><span id="l76.201">       aState = statePrime;</span>
<a href="#l76.202"></a><span id="l76.202">       if (aStart &lt; aEnd) {</span>
<a href="#l76.203"></a><span id="l76.203">         statePrime = aState[this._str[aStart]];</span>
<a href="#l76.204"></a><span id="l76.204">       }</span>
<a href="#l76.205"></a><span id="l76.205">     }</span>
<a href="#l76.206"></a><span id="l76.206" class="difflineminus">-    return [aState, aStart]; </span>
<a href="#l76.207"></a><span id="l76.207" class="difflineplus">+    return [aState, aStart];</span>
<a href="#l76.208"></a><span id="l76.208">   },</span>
<a href="#l76.209"></a><span id="l76.209"> </span>
<a href="#l76.210"></a><span id="l76.210">   /**</span>
<a href="#l76.211"></a><span id="l76.211">    * Given a reference 'pair' whose state may or may not be explicit (and for</span>
<a href="#l76.212"></a><span id="l76.212">    *  which we will perform the required splitting to make it explicit), test</span>
<a href="#l76.213"></a><span id="l76.213">    *  whether it already possesses a transition corresponding to the provided</span>
<a href="#l76.214"></a><span id="l76.214">    *  character.</span>
<a href="#l76.215"></a><span id="l76.215">    * @return A list of: whether we had to make it explicit, the (potentially)</span>
<a href="#l76.216"></a><span id="l76.216" class="difflineat">@@ -248,22 +248,22 @@ dump(&quot;  bailing! (bail was: &quot; + bail + &quot;</span>
<a href="#l76.217"></a><span id="l76.217">         let rState = new State(statePrime.start, statePrime.start + length);</span>
<a href="#l76.218"></a><span id="l76.218">         aState[this._str[statePrime.start]] = rState;</span>
<a href="#l76.219"></a><span id="l76.219">         statePrime.start += length;</span>
<a href="#l76.220"></a><span id="l76.220">         rState[this._str[statePrime.start]] = statePrime;</span>
<a href="#l76.221"></a><span id="l76.221">         return [false, rState];</span>
<a href="#l76.222"></a><span id="l76.222">       }</span>
<a href="#l76.223"></a><span id="l76.223">     }</span>
<a href="#l76.224"></a><span id="l76.224">     else { // it's already explicit</span>
<a href="#l76.225"></a><span id="l76.225" class="difflineminus">-      if (aState === null) { // bottom case... shouldn't happen, but hey. </span>
<a href="#l76.226"></a><span id="l76.226" class="difflineplus">+      if (aState === null) { // bottom case... shouldn't happen, but hey.</span>
<a href="#l76.227"></a><span id="l76.227">         return [true, aState];</span>
<a href="#l76.228"></a><span id="l76.228">       }</span>
<a href="#l76.229"></a><span id="l76.229">       return [(aChar in aState), aState];</span>
<a href="#l76.230"></a><span id="l76.230">     }</span>
<a href="#l76.231"></a><span id="l76.231" class="difflineminus">-      </span>
<a href="#l76.232"></a><span id="l76.232" class="difflineplus">+</span>
<a href="#l76.233"></a><span id="l76.233">   },</span>
<a href="#l76.234"></a><span id="l76.234"> </span>
<a href="#l76.235"></a><span id="l76.235">   _update: function update(aState, aStart, aIndex) {</span>
<a href="#l76.236"></a><span id="l76.236">     let oldR = this._root;</span>
<a href="#l76.237"></a><span id="l76.237">     let textAtIndex = this._str[aIndex]; // T sub i (0-based corrected...)</span>
<a href="#l76.238"></a><span id="l76.238">     // because of the way we store the 'end' value as a one-past form, we do</span>
<a href="#l76.239"></a><span id="l76.239">     //  not need to subtract 1 off of aIndex.</span>
<a href="#l76.240"></a><span id="l76.240">     let [endPoint, rState] = this._testAndSplit(aState, aStart, aIndex, //no -1</span>
<a href="#l76.241"></a><span id="l76.241" class="difflineat">@@ -275,52 +275,52 @@ dump(&quot;  bailing! (bail was: &quot; + bail + &quot;</span>
<a href="#l76.242"></a><span id="l76.242">         oldR.suffix = rState;</span>
<a href="#l76.243"></a><span id="l76.243">       oldR = rState;</span>
<a href="#l76.244"></a><span id="l76.244">       [aState, aStart] = this._canonize(aState.suffix, aStart, aIndex); // no -1</span>
<a href="#l76.245"></a><span id="l76.245">       [endPoint, rState] = this._testAndSplit(aState, aStart, aIndex, // no -1</span>
<a href="#l76.246"></a><span id="l76.246">                                               textAtIndex);</span>
<a href="#l76.247"></a><span id="l76.247">     }</span>
<a href="#l76.248"></a><span id="l76.248">     if (oldR !== this._root)</span>
<a href="#l76.249"></a><span id="l76.249">       oldR.suffix = aState;</span>
<a href="#l76.250"></a><span id="l76.250" class="difflineminus">-    </span>
<a href="#l76.251"></a><span id="l76.251" class="difflineplus">+</span>
<a href="#l76.252"></a><span id="l76.252">     return [aState, aStart];</span>
<a href="#l76.253"></a><span id="l76.253">   },</span>
<a href="#l76.254"></a><span id="l76.254" class="difflineminus">-  </span>
<a href="#l76.255"></a><span id="l76.255" class="difflineplus">+</span>
<a href="#l76.256"></a><span id="l76.256">   _construct: function construct(aStr) {</span>
<a href="#l76.257"></a><span id="l76.257">     this._str = aStr;</span>
<a href="#l76.258"></a><span id="l76.258">     // just needs to be longer than the string.</span>
<a href="#l76.259"></a><span id="l76.259">     this._infinity = aStr.length + 1;</span>
<a href="#l76.260"></a><span id="l76.260" class="difflineminus">-    </span>
<a href="#l76.261"></a><span id="l76.261" class="difflineplus">+</span>
<a href="#l76.262"></a><span id="l76.262">     //this._bottom = new State(0, -1, null);</span>
<a href="#l76.263"></a><span id="l76.263">     this._root = new State(-1, 0, null); // null === bottom</span>
<a href="#l76.264"></a><span id="l76.264">     let state = this._root;</span>
<a href="#l76.265"></a><span id="l76.265">     let start = 0;</span>
<a href="#l76.266"></a><span id="l76.266" class="difflineminus">-  </span>
<a href="#l76.267"></a><span id="l76.267" class="difflineplus">+</span>
<a href="#l76.268"></a><span id="l76.268">     for (let i = 0; i &lt; aStr.length; i++) {</span>
<a href="#l76.269"></a><span id="l76.269">       [state, start] = this._update(state, start, i); // treat as flowing -1...</span>
<a href="#l76.270"></a><span id="l76.270">       [state, start] = this._canonize(state, start, i+1); // 1-length string</span>
<a href="#l76.271"></a><span id="l76.271">     }</span>
<a href="#l76.272"></a><span id="l76.272">   },</span>
<a href="#l76.273"></a><span id="l76.273" class="difflineminus">-  </span>
<a href="#l76.274"></a><span id="l76.274" class="difflineplus">+</span>
<a href="#l76.275"></a><span id="l76.275">   dump: function SuffixTree_show(aState, aIndent, aKey) {</span>
<a href="#l76.276"></a><span id="l76.276">     if (aState === undefined)</span>
<a href="#l76.277"></a><span id="l76.277">       aState = this._root;</span>
<a href="#l76.278"></a><span id="l76.278">     if (aIndent === undefined) {</span>
<a href="#l76.279"></a><span id="l76.279">       aIndent = &quot;&quot;;</span>
<a href="#l76.280"></a><span id="l76.280">       aKey = &quot;.&quot;;</span>
<a href="#l76.281"></a><span id="l76.281">     }</span>
<a href="#l76.282"></a><span id="l76.282" class="difflineminus">-    </span>
<a href="#l76.283"></a><span id="l76.283" class="difflineplus">+</span>
<a href="#l76.284"></a><span id="l76.284">     if (aState.isImplicit) {</span>
<a href="#l76.285"></a><span id="l76.285">       let snip;</span>
<a href="#l76.286"></a><span id="l76.286">       if (aState.length &gt; 10)</span>
<a href="#l76.287"></a><span id="l76.287">         snip = this._str.slice(aState.start,</span>
<a href="#l76.288"></a><span id="l76.288">                            Math.min(aState.start+10, this._str.length)) + &quot;...&quot;;</span>
<a href="#l76.289"></a><span id="l76.289">       else</span>
<a href="#l76.290"></a><span id="l76.290">         snip =  this._str.slice(aState.start,</span>
<a href="#l76.291"></a><span id="l76.291" class="difflineminus">-                                Math.min(aState.end, this._str.length)); </span>
<a href="#l76.292"></a><span id="l76.292" class="difflineplus">+                                Math.min(aState.end, this._str.length));</span>
<a href="#l76.293"></a><span id="l76.293">       dump(aIndent + aKey + &quot;:&quot; + snip + &quot;(&quot; +</span>
<a href="#l76.294"></a><span id="l76.294">            aState.start + &quot;:&quot; + aState.end + &quot;)\n&quot;);</span>
<a href="#l76.295"></a><span id="l76.295">     }</span>
<a href="#l76.296"></a><span id="l76.296">     else</span>
<a href="#l76.297"></a><span id="l76.297">       dump(aIndent + aKey + &quot;: (explicit:&quot; + aState.start + &quot;:&quot; + aState.end +&quot;)\n&quot;);</span>
<a href="#l76.298"></a><span id="l76.298">     let nextIndent = aIndent + &quot;  &quot;;</span>
<a href="#l76.299"></a><span id="l76.299">     let keys = Object.keys(aState).filter(c =&gt; c.length == 1);</span>
<a href="#l76.300"></a><span id="l76.300">     for (let key of keys) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/base_index_messages.js</span>
<a href="#l77.2"></a><span id="l77.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/base_index_messages.js</span>
<a href="#l77.3"></a><span id="l77.3" class="difflineat">@@ -681,17 +681,17 @@ function* test_attributes_cant_query() {</span>
<a href="#l77.4"></a><span id="l77.4"> </span>
<a href="#l77.5"></a><span id="l77.5"> /**</span>
<a href="#l77.6"></a><span id="l77.6">  * Have the participants be in our addressbook prior to indexing so that we can</span>
<a href="#l77.7"></a><span id="l77.7">  *  verify that the hand-off to the addressbook indexer does not cause breakage.</span>
<a href="#l77.8"></a><span id="l77.8">  */</span>
<a href="#l77.9"></a><span id="l77.9"> function* test_people_in_addressbook() {</span>
<a href="#l77.10"></a><span id="l77.10">   var senderPair = msgGen.makeNameAndAddress(),</span>
<a href="#l77.11"></a><span id="l77.11">       recipPair = msgGen.makeNameAndAddress();</span>
<a href="#l77.12"></a><span id="l77.12" class="difflineminus">-  </span>
<a href="#l77.13"></a><span id="l77.13" class="difflineplus">+</span>
<a href="#l77.14"></a><span id="l77.14">   // - add both people to the address book</span>
<a href="#l77.15"></a><span id="l77.15">   makeABCardForAddressPair(senderPair);</span>
<a href="#l77.16"></a><span id="l77.16">   makeABCardForAddressPair(recipPair);</span>
<a href="#l77.17"></a><span id="l77.17"> </span>
<a href="#l77.18"></a><span id="l77.18">   let [folder, msgSet] = make_folder_with_sets([</span>
<a href="#l77.19"></a><span id="l77.19">     { count: 1, to: [recipPair], from: senderPair }]);</span>
<a href="#l77.20"></a><span id="l77.20">   yield wait_for_message_injection();</span>
<a href="#l77.21"></a><span id="l77.21">   yield wait_for_gloda_indexer(msgSet, {augment: true});</span>
<a href="#l77.22"></a><span id="l77.22" class="difflineat">@@ -1054,17 +1054,17 @@ function* test_folder_deletion_nested() </span>
<a href="#l77.23"></a><span id="l77.23">   let descendentFolders = get_nsIMsgFolder(trash).descendants;</span>
<a href="#l77.24"></a><span id="l77.24">   let folders = Array.from(fixIterator(descendentFolders, Ci.nsIMsgFolder));</span>
<a href="#l77.25"></a><span id="l77.25">   Assert.equal(folders.length, 2);</span>
<a href="#l77.26"></a><span id="l77.26">   let [newFolder1, newFolder2] = folders;</span>
<a href="#l77.27"></a><span id="l77.27"> </span>
<a href="#l77.28"></a><span id="l77.28">   let glodaFolder1 = Gloda.getFolderForFolder(newFolder1);</span>
<a href="#l77.29"></a><span id="l77.29">   let glodaFolder2 = Gloda.getFolderForFolder(newFolder2);</span>
<a href="#l77.30"></a><span id="l77.30"> </span>
<a href="#l77.31"></a><span id="l77.31" class="difflineminus">-  // verify that Gloda properly marked this folder as not to be indexed anymore </span>
<a href="#l77.32"></a><span id="l77.32" class="difflineplus">+  // verify that Gloda properly marked this folder as not to be indexed anymore</span>
<a href="#l77.33"></a><span id="l77.33">   Assert.equal(glodaFolder1.indexingPriority, glodaFolder1.kIndexingNeverPriority);</span>
<a href="#l77.34"></a><span id="l77.34"> </span>
<a href="#l77.35"></a><span id="l77.35">   // check that existing message is marked as deleted</span>
<a href="#l77.36"></a><span id="l77.36">   yield wait_for_gloda_indexer([], {deleted: [msgSet1, msgSet2]});</span>
<a href="#l77.37"></a><span id="l77.37"> </span>
<a href="#l77.38"></a><span id="l77.38">   // make sure the deletion hit the database</span>
<a href="#l77.39"></a><span id="l77.39">   yield sqlExpectCount(1,</span>
<a href="#l77.40"></a><span id="l77.40">     &quot;SELECT COUNT(*) from folderLocations WHERE id = ? AND indexingPriority = ?&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/test_mime_attachments_size.js</span>
<a href="#l78.2"></a><span id="l78.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/test_mime_attachments_size.js</span>
<a href="#l78.3"></a><span id="l78.3" class="difflineat">@@ -184,17 +184,17 @@ function check_attachments(aMimeMsg, eps</span>
<a href="#l78.4"></a><span id="l78.4">   if (aMimeMsg == null)</span>
<a href="#l78.5"></a><span id="l78.5">     do_throw(&quot;We really should have gotten a result!&quot;);</span>
<a href="#l78.6"></a><span id="l78.6"> </span>
<a href="#l78.7"></a><span id="l78.7">   // dump(aMimeMsg.prettyString()+&quot;\n&quot;);</span>
<a href="#l78.8"></a><span id="l78.8"> </span>
<a href="#l78.9"></a><span id="l78.9">   /* It is hard to get a byte count that's perfectly accurate. When composing</span>
<a href="#l78.10"></a><span id="l78.10">    * the message, the MIME structure goes like this (for an encoded attachment):</span>
<a href="#l78.11"></a><span id="l78.11">    *</span>
<a href="#l78.12"></a><span id="l78.12" class="difflineminus">-   * XXXXXXXXXX </span>
<a href="#l78.13"></a><span id="l78.13" class="difflineplus">+   * XXXXXXXXXX</span>
<a href="#l78.14"></a><span id="l78.14">    * XXXXXXXXXX    &lt;-- encoded block</span>
<a href="#l78.15"></a><span id="l78.15">    * XXXXXXXXXX</span>
<a href="#l78.16"></a><span id="l78.16">    *               &lt;-- newline</span>
<a href="#l78.17"></a><span id="l78.17">    * --chopchop    &lt;-- MIME separator</span>
<a href="#l78.18"></a><span id="l78.18">    *</span>
<a href="#l78.19"></a><span id="l78.19">    * libmime counts bytes all the way up to the separator, which means it counts</span>
<a href="#l78.20"></a><span id="l78.20">    * the bytes for the extra line. Since newlines in emails are \n, most of the</span>
<a href="#l78.21"></a><span id="l78.21">    * time we get att.size = 174 instead of 173.</span>
<a href="#l78.22"></a><span id="l78.22" class="difflineat">@@ -257,17 +257,17 @@ var bogusMessageInfos = [</span>
<a href="#l78.23"></a><span id="l78.23">   // (when they have it), rather than recursively computing their sizes. I'm not</span>
<a href="#l78.24"></a><span id="l78.24">   // sure changing jsmimeemitter.js is worth the trouble just for buggy</span>
<a href="#l78.25"></a><span id="l78.25">   // messages...</span>
<a href="#l78.26"></a><span id="l78.26">   {</span>
<a href="#l78.27"></a><span id="l78.27">     name: '.eml attachment with inner MimeUnknown',</span>
<a href="#l78.28"></a><span id="l78.28">     bodyPart: new SyntheticPartMultiMixed([</span>
<a href="#l78.29"></a><span id="l78.29">       partHtml,</span>
<a href="#l78.30"></a><span id="l78.30">       msgGen.makeMessage({ // &lt;--- M</span>
<a href="#l78.31"></a><span id="l78.31" class="difflineminus">-        bodyPart: </span>
<a href="#l78.32"></a><span id="l78.32" class="difflineplus">+        bodyPart:</span>
<a href="#l78.33"></a><span id="l78.33">         new SyntheticPartMultiMixed([</span>
<a href="#l78.34"></a><span id="l78.34">           new SyntheticPartMultiRelated([</span>
<a href="#l78.35"></a><span id="l78.35">             partHtml,</span>
<a href="#l78.36"></a><span id="l78.36">             new SyntheticPartLeaf(htmlText, { contentType: &quot;woooooo&quot; }),</span>
<a href="#l78.37"></a><span id="l78.37">           ]),</span>
<a href="#l78.38"></a><span id="l78.38">         ]),</span>
<a href="#l78.39"></a><span id="l78.39">       }),</span>
<a href="#l78.40"></a><span id="l78.40">     ]),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1" class="difflineminus">--- a/mailnews/db/msgdb/test/unit/test_maildb.js</span>
<a href="#l79.2"></a><span id="l79.2" class="difflineplus">+++ b/mailnews/db/msgdb/test/unit/test_maildb.js</span>
<a href="#l79.3"></a><span id="l79.3" class="difflineat">@@ -65,17 +65,17 @@ function doTest(test)</span>
<a href="#l79.4"></a><span id="l79.4">   if (test &lt;= gTestArray.length)</span>
<a href="#l79.5"></a><span id="l79.5">   {</span>
<a href="#l79.6"></a><span id="l79.6">     dump(&quot;Doing test &quot; + test + &quot;\n&quot;);</span>
<a href="#l79.7"></a><span id="l79.7">     gCurTestNum = test;</span>
<a href="#l79.8"></a><span id="l79.8"> </span>
<a href="#l79.9"></a><span id="l79.9">     var testFn = gTestArray[test-1];</span>
<a href="#l79.10"></a><span id="l79.10">     // Set a limit of 10 seconds; if the notifications haven't arrived by then there's a problem.</span>
<a href="#l79.11"></a><span id="l79.11">     do_timeout(10000, function(){</span>
<a href="#l79.12"></a><span id="l79.12" class="difflineminus">-        if (gCurTestNum == test) </span>
<a href="#l79.13"></a><span id="l79.13" class="difflineplus">+        if (gCurTestNum == test)</span>
<a href="#l79.14"></a><span id="l79.14">           do_throw(&quot;Notifications not received in 10000 ms for operation &quot; + testFn.name);</span>
<a href="#l79.15"></a><span id="l79.15">         }</span>
<a href="#l79.16"></a><span id="l79.16">       );</span>
<a href="#l79.17"></a><span id="l79.17">     try {</span>
<a href="#l79.18"></a><span id="l79.18">     testFn();</span>
<a href="#l79.19"></a><span id="l79.19">     } catch(ex) {do_throw(ex);}</span>
<a href="#l79.20"></a><span id="l79.20">   }</span>
<a href="#l79.21"></a><span id="l79.21">   else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1" class="difflineminus">--- a/mailnews/db/msgdb/test/unit/test_references_parsing.js</span>
<a href="#l80.2"></a><span id="l80.2" class="difflineplus">+++ b/mailnews/db/msgdb/test/unit/test_references_parsing.js</span>
<a href="#l80.3"></a><span id="l80.3" class="difflineat">@@ -40,47 +40,47 @@ var refsAndResults = [</span>
<a href="#l80.4"></a><span id="l80.4">   [&quot; 4 &lt; 5&quot;, [&quot;4 &lt; 5&quot;]],</span>
<a href="#l80.5"></a><span id="l80.5">   [&quot; 6 &gt; 3&quot;, [&quot;6 &gt; 3&quot;]],</span>
<a href="#l80.6"></a><span id="l80.6">   [&quot;  look ma!\n newlines!&quot;, [&quot;look ma!\n newlines!&quot;]]</span>
<a href="#l80.7"></a><span id="l80.7"> ];</span>
<a href="#l80.8"></a><span id="l80.8"> </span>
<a href="#l80.9"></a><span id="l80.9"> /**</span>
<a href="#l80.10"></a><span id="l80.10">  * Parse the references in refsAndResults and ensure their references match</span>
<a href="#l80.11"></a><span id="l80.11">  *  the corresponding results.</span>
<a href="#l80.12"></a><span id="l80.12" class="difflineminus">- * </span>
<a href="#l80.13"></a><span id="l80.13" class="difflineplus">+ *</span>
<a href="#l80.14"></a><span id="l80.14">  * @param aMsgHdr A message header that you don't mind if we mess with.</span>
<a href="#l80.15"></a><span id="l80.15">  */</span>
<a href="#l80.16"></a><span id="l80.16"> function test_references_header_parsing(aMsgHdr) {</span>
<a href="#l80.17"></a><span id="l80.17">   var iCase, iResult, refString, results;</span>
<a href="#l80.18"></a><span id="l80.18">   for (iCase = 0; iCase &lt; refsAndResults.length; iCase++) {</span>
<a href="#l80.19"></a><span id="l80.19">     refString = refsAndResults[iCase][0];</span>
<a href="#l80.20"></a><span id="l80.20">     results   = refsAndResults[iCase][1];</span>
<a href="#l80.21"></a><span id="l80.21" class="difflineminus">-    </span>
<a href="#l80.22"></a><span id="l80.22" class="difflineplus">+</span>
<a href="#l80.23"></a><span id="l80.23">     dump(&quot;Setting references to: '&quot; + refString + &quot;'\n&quot;);</span>
<a href="#l80.24"></a><span id="l80.24">     aMsgHdr.setReferences(refString);</span>
<a href="#l80.25"></a><span id="l80.25">     if (aMsgHdr.numReferences != results.length) {</span>
<a href="#l80.26"></a><span id="l80.26">       dump(&quot;Length mis-match! Was expecting:\n&quot;);</span>
<a href="#l80.27"></a><span id="l80.27">       for (iResult = 0; iResult &lt; results.length; iResult++) {</span>
<a href="#l80.28"></a><span id="l80.28">         dump(&quot;'&quot; + results[iResult] + &quot;'\n&quot;);</span>
<a href="#l80.29"></a><span id="l80.29">       }</span>
<a href="#l80.30"></a><span id="l80.30"> </span>
<a href="#l80.31"></a><span id="l80.31">       dump(&quot;Got:\n&quot;);</span>
<a href="#l80.32"></a><span id="l80.32"> </span>
<a href="#l80.33"></a><span id="l80.33">       for (iResult = 0; iResult &lt; aMsgHdr.numReferences; iResult++) {</span>
<a href="#l80.34"></a><span id="l80.34">         dump(&quot;'&quot; + aMsgHdr.getStringReference(iResult) +  &quot;'\n&quot;);</span>
<a href="#l80.35"></a><span id="l80.35">       }</span>
<a href="#l80.36"></a><span id="l80.36" class="difflineminus">-      </span>
<a href="#l80.37"></a><span id="l80.37" class="difflineplus">+</span>
<a href="#l80.38"></a><span id="l80.38">       Assert.equal(aMsgHdr.numReferences, results.length);</span>
<a href="#l80.39"></a><span id="l80.39">     }</span>
<a href="#l80.40"></a><span id="l80.40" class="difflineminus">-    </span>
<a href="#l80.41"></a><span id="l80.41" class="difflineplus">+</span>
<a href="#l80.42"></a><span id="l80.42">     for (iResult = 0; iResult &lt; results.length; iResult++) {</span>
<a href="#l80.43"></a><span id="l80.43">       Assert.equal(aMsgHdr.getStringReference(iResult), results[iResult]);</span>
<a href="#l80.44"></a><span id="l80.44">     }</span>
<a href="#l80.45"></a><span id="l80.45">   }</span>
<a href="#l80.46"></a><span id="l80.46" class="difflineminus">-  </span>
<a href="#l80.47"></a><span id="l80.47" class="difflineplus">+</span>
<a href="#l80.48"></a><span id="l80.48">   do_test_finished();</span>
<a href="#l80.49"></a><span id="l80.49"> }</span>
<a href="#l80.50"></a><span id="l80.50"> </span>
<a href="#l80.51"></a><span id="l80.51"> /*</span>
<a href="#l80.52"></a><span id="l80.52">  * This infrastructure down here exists just to get</span>
<a href="#l80.53"></a><span id="l80.53">  *  test_references_header_parsing its message header.</span>
<a href="#l80.54"></a><span id="l80.54">  */</span>
<a href="#l80.55"></a><span id="l80.55"> </span>
<a href="#l80.56"></a><span id="l80.56" class="difflineat">@@ -89,17 +89,17 @@ function run_test() {</span>
<a href="#l80.57"></a><span id="l80.57">   do_test_pending();</span>
<a href="#l80.58"></a><span id="l80.58">   MailServices.copy.CopyFileMessage(anyOldMessage, localAccountUtils.inboxFolder, null,</span>
<a href="#l80.59"></a><span id="l80.59">                                     false, 0, &quot;&quot;, messageHeaderGetterListener, null);</span>
<a href="#l80.60"></a><span id="l80.60">   return true;</span>
<a href="#l80.61"></a><span id="l80.61"> }</span>
<a href="#l80.62"></a><span id="l80.62"> </span>
<a href="#l80.63"></a><span id="l80.63"> var messageHeaderGetterListener = {</span>
<a href="#l80.64"></a><span id="l80.64">   msgKey: null,</span>
<a href="#l80.65"></a><span id="l80.65" class="difflineminus">-  </span>
<a href="#l80.66"></a><span id="l80.66" class="difflineplus">+</span>
<a href="#l80.67"></a><span id="l80.67">   OnStartCopy: function() {},</span>
<a href="#l80.68"></a><span id="l80.68">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l80.69"></a><span id="l80.69">   GetMessageId: function (aMessageId) {},</span>
<a href="#l80.70"></a><span id="l80.70">   SetMessageKey: function(aKey) {</span>
<a href="#l80.71"></a><span id="l80.71">     this.msgKey = aKey;</span>
<a href="#l80.72"></a><span id="l80.72">   },</span>
<a href="#l80.73"></a><span id="l80.73">   OnStopCopy: function(aStatus) {</span>
<a href="#l80.74"></a><span id="l80.74">     test_references_header_parsing(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1" class="difflineminus">--- a/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js</span>
<a href="#l81.2"></a><span id="l81.2" class="difflineplus">+++ b/mailnews/extensions/bayesian-spam-filter/test/unit/resources/trainingfile.js</span>
<a href="#l81.3"></a><span id="l81.3" class="difflineat">@@ -57,46 +57,46 @@ function TrainingData() {</span>
<a href="#l81.4"></a><span id="l81.4">       var oBinStream = Cc[&quot;@mozilla.org/binaryinputstream;1&quot;].</span>
<a href="#l81.5"></a><span id="l81.5">         createInstance(Ci.nsIBinaryInputStream);</span>
<a href="#l81.6"></a><span id="l81.6">       oBinStream.setInputStream(oBufStream);</span>
<a href="#l81.7"></a><span id="l81.7">       // return it</span>
<a href="#l81.8"></a><span id="l81.8">       return oBinStream;</span>
<a href="#l81.9"></a><span id="l81.9">     }</span>
<a href="#l81.10"></a><span id="l81.10">     return null;</span>
<a href="#l81.11"></a><span id="l81.11">   }</span>
<a href="#l81.12"></a><span id="l81.12" class="difflineminus">-  </span>
<a href="#l81.13"></a><span id="l81.13" class="difflineplus">+</span>
<a href="#l81.14"></a><span id="l81.14">   // method specifications</span>
<a href="#l81.15"></a><span id="l81.15" class="difflineminus">-  </span>
<a href="#l81.16"></a><span id="l81.16" class="difflineplus">+</span>
<a href="#l81.17"></a><span id="l81.17">   function read() {</span>
<a href="#l81.18"></a><span id="l81.18">     var file = getJunkStatFile();</span>
<a href="#l81.19"></a><span id="l81.19"> </span>
<a href="#l81.20"></a><span id="l81.20">     // does the file exist?</span>
<a href="#l81.21"></a><span id="l81.21">     Assert.ok(file.exists());</span>
<a href="#l81.22"></a><span id="l81.22"> </span>
<a href="#l81.23"></a><span id="l81.23">     var fileStream = getBinStream(file);</span>
<a href="#l81.24"></a><span id="l81.24" class="difflineminus">-    </span>
<a href="#l81.25"></a><span id="l81.25" class="difflineplus">+</span>
<a href="#l81.26"></a><span id="l81.26">     // check magic number</span>
<a href="#l81.27"></a><span id="l81.27">     var iMagicNumber = fileStream.read32();</span>
<a href="#l81.28"></a><span id="l81.28">     Assert.equal(iMagicNumber, 0xFEEDFACE);</span>
<a href="#l81.29"></a><span id="l81.29" class="difflineminus">-    </span>
<a href="#l81.30"></a><span id="l81.30" class="difflineplus">+</span>
<a href="#l81.31"></a><span id="l81.31">     // get ham'n'spam numbers</span>
<a href="#l81.32"></a><span id="l81.32">     this.mGoodMessages = fileStream.read32();</span>
<a href="#l81.33"></a><span id="l81.33">     this.mJunkMessages = fileStream.read32();</span>
<a href="#l81.34"></a><span id="l81.34"> </span>
<a href="#l81.35"></a><span id="l81.35">     // Read good tokens</span>
<a href="#l81.36"></a><span id="l81.36">     this.mGoodTokens = fileStream.read32();</span>
<a href="#l81.37"></a><span id="l81.37">     var iRefCount, iTokenLen, sToken;</span>
<a href="#l81.38"></a><span id="l81.38">     for (var i = 0; i &lt; this.mGoodTokens; ++i)</span>
<a href="#l81.39"></a><span id="l81.39" class="difflineminus">-    { </span>
<a href="#l81.40"></a><span id="l81.40" class="difflineplus">+    {</span>
<a href="#l81.41"></a><span id="l81.41">       iRefCount  = fileStream.read32();</span>
<a href="#l81.42"></a><span id="l81.42">       iTokenLen  = fileStream.read32();</span>
<a href="#l81.43"></a><span id="l81.43">       sToken     = fileStream.readBytes(iTokenLen);</span>
<a href="#l81.44"></a><span id="l81.44">       this.mGoodCounts[sToken] = iRefCount;</span>
<a href="#l81.45"></a><span id="l81.45">     }</span>
<a href="#l81.46"></a><span id="l81.46" class="difflineminus">-    </span>
<a href="#l81.47"></a><span id="l81.47" class="difflineplus">+</span>
<a href="#l81.48"></a><span id="l81.48">     // we have no further good tokens, so read junk tokens</span>
<a href="#l81.49"></a><span id="l81.49">     this.mJunkTokens = fileStream.read32();</span>
<a href="#l81.50"></a><span id="l81.50">     for (i = 0; i &lt; this.mJunkTokens; i++)</span>
<a href="#l81.51"></a><span id="l81.51">     { // read token data</span>
<a href="#l81.52"></a><span id="l81.52">       iRefCount  = fileStream.read32();</span>
<a href="#l81.53"></a><span id="l81.53">       iTokenLen  = fileStream.read32();</span>
<a href="#l81.54"></a><span id="l81.54">       sToken     = fileStream.readBytes(iTokenLen);</span>
<a href="#l81.55"></a><span id="l81.55">       this.mJunkCounts[sToken] = iRefCount;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1" class="difflineminus">--- a/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js</span>
<a href="#l82.2"></a><span id="l82.2" class="difflineplus">+++ b/mailnews/extensions/bayesian-spam-filter/test/unit/test_bug228675.js</span>
<a href="#l82.3"></a><span id="l82.3" class="difflineat">@@ -26,39 +26,39 @@ var trainingData;</span>
<a href="#l82.4"></a><span id="l82.4"> </span>
<a href="#l82.5"></a><span id="l82.5"> // main test</span>
<a href="#l82.6"></a><span id="l82.6"> function run_test()</span>
<a href="#l82.7"></a><span id="l82.7"> {</span>
<a href="#l82.8"></a><span id="l82.8">   localAccountUtils.loadLocalMailAccount();</span>
<a href="#l82.9"></a><span id="l82.9">   MailServices.junk.resetTrainingData();</span>
<a href="#l82.10"></a><span id="l82.10"> </span>
<a href="#l82.11"></a><span id="l82.11">   do_test_pending();</span>
<a href="#l82.12"></a><span id="l82.12" class="difflineminus">-  </span>
<a href="#l82.13"></a><span id="l82.13" class="difflineplus">+</span>
<a href="#l82.14"></a><span id="l82.14">   var email = emails.shift();</span>
<a href="#l82.15"></a><span id="l82.15">   var classification = classifications.shift();</span>
<a href="#l82.16"></a><span id="l82.16">   // additional calls to setMessageClassifiaction are done in the callback</span>
<a href="#l82.17"></a><span id="l82.17">   MailServices.junk.setMessageClassification(getSpec(email),</span>
<a href="#l82.18"></a><span id="l82.18">     kUnclassified, classification, null, doTestingListener);</span>
<a href="#l82.19"></a><span id="l82.19"> }</span>
<a href="#l82.20"></a><span id="l82.20"> </span>
<a href="#l82.21"></a><span id="l82.21" class="difflineminus">-var doTestingListener = </span>
<a href="#l82.22"></a><span id="l82.22" class="difflineplus">+var doTestingListener =</span>
<a href="#l82.23"></a><span id="l82.23"> {</span>
<a href="#l82.24"></a><span id="l82.24">   onMessageClassified: function(aMsgURI, aClassification, aJunkPercent)</span>
<a href="#l82.25"></a><span id="l82.25">   {</span>
<a href="#l82.26"></a><span id="l82.26">     if (!aMsgURI)</span>
<a href="#l82.27"></a><span id="l82.27">       return; // ignore end-of-batch signal</span>
<a href="#l82.28"></a><span id="l82.28">     var email = emails.shift();</span>
<a href="#l82.29"></a><span id="l82.29">     var classification = classifications.shift();</span>
<a href="#l82.30"></a><span id="l82.30">     if (email)</span>
<a href="#l82.31"></a><span id="l82.31">     {</span>
<a href="#l82.32"></a><span id="l82.32">       MailServices.junk.setMessageClassification(getSpec(email),</span>
<a href="#l82.33"></a><span id="l82.33">           kUnclassified, classification, null, doTestingListener);</span>
<a href="#l82.34"></a><span id="l82.34">       return;</span>
<a href="#l82.35"></a><span id="l82.35">     }</span>
<a href="#l82.36"></a><span id="l82.36" class="difflineminus">-    </span>
<a href="#l82.37"></a><span id="l82.37" class="difflineplus">+</span>
<a href="#l82.38"></a><span id="l82.38">     // all done classifying, time to test</span>
<a href="#l82.39"></a><span id="l82.39">     MailServices.junk.shutdown(); // just flushes training.dat</span>
<a href="#l82.40"></a><span id="l82.40">     trainingData = new TrainingData();</span>
<a href="#l82.41"></a><span id="l82.41">     trainingData.read();</span>
<a href="#l82.42"></a><span id="l82.42"> </span>
<a href="#l82.43"></a><span id="l82.43">     /*</span>
<a href="#l82.44"></a><span id="l82.44">     // List training.dat information for debug</span>
<a href="#l82.45"></a><span id="l82.45">     dump(&quot;training.data results: goodMessages=&quot; + trainingData.mGoodMessages</span>
<a href="#l82.46"></a><span id="l82.46" class="difflineat">@@ -68,42 +68,42 @@ var doTestingListener =</span>
<a href="#l82.47"></a><span id="l82.47">       + &quot;\n&quot;);</span>
<a href="#l82.48"></a><span id="l82.48">     print(&quot;Good counts&quot;);</span>
<a href="#l82.49"></a><span id="l82.49">     for (var token in trainingData.mGoodCounts)</span>
<a href="#l82.50"></a><span id="l82.50">       dump(&quot;count: &quot; + trainingData.mGoodCounts[token] + &quot; token: &quot; + token + &quot;\n&quot;);</span>
<a href="#l82.51"></a><span id="l82.51">     print(&quot;Junk Counts&quot;);</span>
<a href="#l82.52"></a><span id="l82.52">     for (var token in trainingData.mJunkCounts)</span>
<a href="#l82.53"></a><span id="l82.53">       dump(&quot;count: &quot; + trainingData.mJunkCounts[token] + &quot; token: &quot; + token + &quot;\n&quot;);</span>
<a href="#l82.54"></a><span id="l82.54">     */</span>
<a href="#l82.55"></a><span id="l82.55" class="difflineminus">-    </span>
<a href="#l82.56"></a><span id="l82.56" class="difflineplus">+</span>
<a href="#l82.57"></a><span id="l82.57">     /* Selected pre-shrink counts after training</span>
<a href="#l82.58"></a><span id="l82.58">     training.data results: goodMessages=2 junkMessages = 4 tokens = 78</span>
<a href="#l82.59"></a><span id="l82.59">     Good counts</span>
<a href="#l82.60"></a><span id="l82.60">     count: 1 token: subject:report</span>
<a href="#l82.61"></a><span id="l82.61">     count: 2 token: important</span>
<a href="#l82.62"></a><span id="l82.62">     count: 2 token: to:careful reader &lt;reader@example.org&gt;</span>
<a href="#l82.63"></a><span id="l82.63"> </span>
<a href="#l82.64"></a><span id="l82.64">     Junk Counts</span>
<a href="#l82.65"></a><span id="l82.65">     count: 3 token: make</span>
<a href="#l82.66"></a><span id="l82.66">     count: 4 token: money</span>
<a href="#l82.67"></a><span id="l82.67">     count: 4 token: to:careful reader &lt;reader@example.org&gt;</span>
<a href="#l82.68"></a><span id="l82.68">     count: 2 token: money!</span>
<a href="#l82.69"></a><span id="l82.69">     */</span>
<a href="#l82.70"></a><span id="l82.70" class="difflineminus">-    </span>
<a href="#l82.71"></a><span id="l82.71" class="difflineplus">+</span>
<a href="#l82.72"></a><span id="l82.72">     // Shrinking divides all counts by two. In comments, I show the</span>
<a href="#l82.73"></a><span id="l82.73">     // calculation for each test, (pre-shrink count)/2.</span>
<a href="#l82.74"></a><span id="l82.74"> </span>
<a href="#l82.75"></a><span id="l82.75">     Assert.equal(trainingData.mGoodMessages, 1); //  2/2</span>
<a href="#l82.76"></a><span id="l82.76">     Assert.equal(trainingData.mJunkMessages, 2); //  4/2</span>
<a href="#l82.77"></a><span id="l82.77">     checkToken(&quot;money&quot;, 0, 2);  // (0/2, 4/2)</span>
<a href="#l82.78"></a><span id="l82.78">     checkToken(&quot;subject:report&quot;, 0, 0);  // (1/2, 0/2)</span>
<a href="#l82.79"></a><span id="l82.79">     checkToken(&quot;to:careful reader &lt;reader@example.org&gt;&quot;, 1, 2); // (2/2, 4/2)</span>
<a href="#l82.80"></a><span id="l82.80">     checkToken(&quot;make&quot;, 0, 1); // (0/2, 3/2)</span>
<a href="#l82.81"></a><span id="l82.81">     checkToken(&quot;important&quot;, 1, 0); // (2/2, 0/2)</span>
<a href="#l82.82"></a><span id="l82.82" class="difflineminus">-    </span>
<a href="#l82.83"></a><span id="l82.83" class="difflineplus">+</span>
<a href="#l82.84"></a><span id="l82.84">     do_test_finished();</span>
<a href="#l82.85"></a><span id="l82.85">   }</span>
<a href="#l82.86"></a><span id="l82.86"> };</span>
<a href="#l82.87"></a><span id="l82.87"> </span>
<a href="#l82.88"></a><span id="l82.88"> // helper functions</span>
<a href="#l82.89"></a><span id="l82.89"> </span>
<a href="#l82.90"></a><span id="l82.90"> function checkToken(aToken, aGoodCount, aJunkCount)</span>
<a href="#l82.91"></a><span id="l82.91"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1" class="difflineminus">--- a/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js</span>
<a href="#l83.2"></a><span id="l83.2" class="difflineplus">+++ b/mailnews/extensions/bayesian-spam-filter/test/unit/test_traitAliases.js</span>
<a href="#l83.3"></a><span id="l83.3" class="difflineat">@@ -144,17 +144,17 @@ function startCommand()</span>
<a href="#l83.4"></a><span id="l83.4">   while ((antiAlias = antiAliases.pop()))</span>
<a href="#l83.5"></a><span id="l83.5">     traitService.removeAlias(kAntiTrait, antiAlias);</span>
<a href="#l83.6"></a><span id="l83.6"> </span>
<a href="#l83.7"></a><span id="l83.7">   // add new aliases</span>
<a href="#l83.8"></a><span id="l83.8">   while ((proAlias = gTest.proAliases.pop()))</span>
<a href="#l83.9"></a><span id="l83.9">     traitService.addAlias(kProTrait, proAlias);</span>
<a href="#l83.10"></a><span id="l83.10">   while ((antiAlias = gTest.antiAliases.pop()))</span>
<a href="#l83.11"></a><span id="l83.11">     traitService.addAlias(kAntiTrait, antiAlias);</span>
<a href="#l83.12"></a><span id="l83.12" class="difflineminus">-  </span>
<a href="#l83.13"></a><span id="l83.13" class="difflineplus">+</span>
<a href="#l83.14"></a><span id="l83.14">   MailServices.junk.classifyTraitsInMessage(</span>
<a href="#l83.15"></a><span id="l83.15">     getSpec(gTest.fileName), // in string aMsgURI</span>
<a href="#l83.16"></a><span id="l83.16">     proArray.length, // length of traits arrays</span>
<a href="#l83.17"></a><span id="l83.17">     proArray,    // in array aProTraits,</span>
<a href="#l83.18"></a><span id="l83.18">     antiArray,   // in array aAntiTraits</span>
<a href="#l83.19"></a><span id="l83.19">     listener);   // in nsIMsgTraitClassificationListener aTraitListener</span>
<a href="#l83.20"></a><span id="l83.20">     //null,      // [optional] in nsIMsgWindow aMsgWindow</span>
<a href="#l83.21"></a><span id="l83.21">     //null,      // [optional] in nsIJunkMailClassificationListener aJunkListener</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1" class="difflineminus">--- a/mailnews/extensions/dsn/content/am-dsn.js</span>
<a href="#l84.2"></a><span id="l84.2" class="difflineplus">+++ b/mailnews/extensions/dsn/content/am-dsn.js</span>
<a href="#l84.3"></a><span id="l84.3" class="difflineat">@@ -2,17 +2,17 @@</span>
<a href="#l84.4"></a><span id="l84.4">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l84.5"></a><span id="l84.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l84.6"></a><span id="l84.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l84.7"></a><span id="l84.7"> </span>
<a href="#l84.8"></a><span id="l84.8"> var useCustomPrefs;</span>
<a href="#l84.9"></a><span id="l84.9"> var requestAlways;</span>
<a href="#l84.10"></a><span id="l84.10"> var gIdentity;</span>
<a href="#l84.11"></a><span id="l84.11"> </span>
<a href="#l84.12"></a><span id="l84.12" class="difflineminus">-function onInit() </span>
<a href="#l84.13"></a><span id="l84.13" class="difflineplus">+function onInit()</span>
<a href="#l84.14"></a><span id="l84.14"> {</span>
<a href="#l84.15"></a><span id="l84.15">   useCustomPrefs = document.getElementById(&quot;identity.dsn_use_custom_prefs&quot;);</span>
<a href="#l84.16"></a><span id="l84.16">   requestAlways = document.getElementById(&quot;identity.dsn_always_request_on&quot;);</span>
<a href="#l84.17"></a><span id="l84.17"> </span>
<a href="#l84.18"></a><span id="l84.18">   EnableDisableCustomSettings();</span>
<a href="#l84.19"></a><span id="l84.19"> </span>
<a href="#l84.20"></a><span id="l84.20">   return true;</span>
<a href="#l84.21"></a><span id="l84.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1" class="difflineminus">--- a/mailnews/extensions/mdn/content/am-mdn.js</span>
<a href="#l85.2"></a><span id="l85.2" class="difflineplus">+++ b/mailnews/extensions/mdn/content/am-mdn.js</span>
<a href="#l85.3"></a><span id="l85.3" class="difflineat">@@ -17,36 +17,36 @@ var outsideDomainLabel;</span>
<a href="#l85.4"></a><span id="l85.4"> var otherCasesPref;</span>
<a href="#l85.5"></a><span id="l85.5"> var otherCasesLabel;</span>
<a href="#l85.6"></a><span id="l85.6"> var receiptArriveLabel;</span>
<a href="#l85.7"></a><span id="l85.7"> var receiptRequestLabel;</span>
<a href="#l85.8"></a><span id="l85.8"> var gIdentity;</span>
<a href="#l85.9"></a><span id="l85.9"> var gIncomingServer;</span>
<a href="#l85.10"></a><span id="l85.10"> var gMdnPrefBranch;</span>
<a href="#l85.11"></a><span id="l85.11"> </span>
<a href="#l85.12"></a><span id="l85.12" class="difflineminus">-function onInit() </span>
<a href="#l85.13"></a><span id="l85.13" class="difflineplus">+function onInit()</span>
<a href="#l85.14"></a><span id="l85.14"> {</span>
<a href="#l85.15"></a><span id="l85.15">   useCustomPrefs = document.getElementById(&quot;identity.use_custom_prefs&quot;);</span>
<a href="#l85.16"></a><span id="l85.16">   requestReceipt = document.getElementById(&quot;identity.request_return_receipt_on&quot;);</span>
<a href="#l85.17"></a><span id="l85.17">   leaveInInbox = document.getElementById(&quot;leave_in_inbox&quot;);</span>
<a href="#l85.18"></a><span id="l85.18">   moveToSent = document.getElementById(&quot;move_to_sent&quot;);</span>
<a href="#l85.19"></a><span id="l85.19">   receiptSend = document.getElementById(&quot;server.mdn_report_enabled&quot;);</span>
<a href="#l85.20"></a><span id="l85.20">   neverReturn = document.getElementById(&quot;never_return&quot;);</span>
<a href="#l85.21"></a><span id="l85.21">   returnSome = document.getElementById(&quot;return_some&quot;);</span>
<a href="#l85.22"></a><span id="l85.22">   notInToCcPref = document.getElementById(&quot;server.mdn_not_in_to_cc&quot;);</span>
<a href="#l85.23"></a><span id="l85.23">   notInToCcLabel = document.getElementById(&quot;notInToCcLabel&quot;);</span>
<a href="#l85.24"></a><span id="l85.24">   outsideDomainPref = document.getElementById(&quot;server.mdn_outside_domain&quot;);</span>
<a href="#l85.25"></a><span id="l85.25">   outsideDomainLabel = document.getElementById(&quot;outsideDomainLabel&quot;);</span>
<a href="#l85.26"></a><span id="l85.26">   otherCasesPref = document.getElementById(&quot;server.mdn_other&quot;);</span>
<a href="#l85.27"></a><span id="l85.27">   otherCasesLabel = document.getElementById(&quot;otherCasesLabel&quot;);</span>
<a href="#l85.28"></a><span id="l85.28">   receiptArriveLabel = document.getElementById(&quot;receiptArriveLabel&quot;);</span>
<a href="#l85.29"></a><span id="l85.29">   receiptRequestLabel = document.getElementById(&quot;receiptRequestLabel&quot;);</span>
<a href="#l85.30"></a><span id="l85.30" class="difflineminus">-  </span>
<a href="#l85.31"></a><span id="l85.31" class="difflineplus">+</span>
<a href="#l85.32"></a><span id="l85.32">   EnableDisableCustomSettings();</span>
<a href="#l85.33"></a><span id="l85.33" class="difflineminus">-        </span>
<a href="#l85.34"></a><span id="l85.34" class="difflineplus">+</span>
<a href="#l85.35"></a><span id="l85.35">   return true;</span>
<a href="#l85.36"></a><span id="l85.36"> }</span>
<a href="#l85.37"></a><span id="l85.37"> </span>
<a href="#l85.38"></a><span id="l85.38"> function onSave()</span>
<a href="#l85.39"></a><span id="l85.39"> {</span>
<a href="#l85.40"></a><span id="l85.40"> </span>
<a href="#l85.41"></a><span id="l85.41"> }</span>
<a href="#l85.42"></a><span id="l85.42"> </span>
<a href="#l85.43"></a><span id="l85.43" class="difflineat">@@ -103,17 +103,17 @@ function onPreInit(account, accountValue</span>
<a href="#l85.44"></a><span id="l85.44"> {</span>
<a href="#l85.45"></a><span id="l85.45">   gIdentity = account.defaultIdentity;</span>
<a href="#l85.46"></a><span id="l85.46">   gIncomingServer = account.incomingServer;</span>
<a href="#l85.47"></a><span id="l85.47"> }</span>
<a href="#l85.48"></a><span id="l85.48"> </span>
<a href="#l85.49"></a><span id="l85.49"> // Disables xul elements that have associated preferences locked.</span>
<a href="#l85.50"></a><span id="l85.50"> function onLockPreference(initPrefString, keyString)</span>
<a href="#l85.51"></a><span id="l85.51"> {</span>
<a href="#l85.52"></a><span id="l85.52" class="difflineminus">-    var finalPrefString; </span>
<a href="#l85.53"></a><span id="l85.53" class="difflineplus">+    var finalPrefString;</span>
<a href="#l85.54"></a><span id="l85.54"> </span>
<a href="#l85.55"></a><span id="l85.55">     var allPrefElements = [</span>
<a href="#l85.56"></a><span id="l85.56">       { prefstring:&quot;request_return_receipt_on&quot;, id:&quot;identity.request_return_receipt_on&quot;},</span>
<a href="#l85.57"></a><span id="l85.57">       { prefstring:&quot;select_custom_prefs&quot;, id:&quot;identity.select_custom_prefs&quot;},</span>
<a href="#l85.58"></a><span id="l85.58">       { prefstring:&quot;select_global_prefs&quot;, id:&quot;identity.select_global_prefs&quot;},</span>
<a href="#l85.59"></a><span id="l85.59">       { prefstring:&quot;incorporate_return_receipt&quot;, id:&quot;server.incorporate_return_receipt&quot;},</span>
<a href="#l85.60"></a><span id="l85.60">       { prefstring:&quot;never_return&quot;, id:&quot;never_return&quot;},</span>
<a href="#l85.61"></a><span id="l85.61">       { prefstring:&quot;return_some&quot;, id:&quot;return_some&quot;},</span>
<a href="#l85.62"></a><span id="l85.62" class="difflineat">@@ -121,17 +121,17 @@ function onLockPreference(initPrefString</span>
<a href="#l85.63"></a><span id="l85.63">       { prefstring:&quot;mdn_outside_domain&quot;, id:&quot;server.mdn_outside_domain&quot;},</span>
<a href="#l85.64"></a><span id="l85.64">       { prefstring:&quot;mdn_other&quot;, id:&quot;server.mdn_other&quot;},</span>
<a href="#l85.65"></a><span id="l85.65">     ];</span>
<a href="#l85.66"></a><span id="l85.66"> </span>
<a href="#l85.67"></a><span id="l85.67">     finalPrefString = initPrefString + &quot;.&quot; + keyString + &quot;.&quot;;</span>
<a href="#l85.68"></a><span id="l85.68">     gMdnPrefBranch = Services.prefs.getBranch(finalPrefString);</span>
<a href="#l85.69"></a><span id="l85.69"> </span>
<a href="#l85.70"></a><span id="l85.70">     disableIfLocked( allPrefElements );</span>
<a href="#l85.71"></a><span id="l85.71" class="difflineminus">-} </span>
<a href="#l85.72"></a><span id="l85.72" class="difflineplus">+}</span>
<a href="#l85.73"></a><span id="l85.73"> </span>
<a href="#l85.74"></a><span id="l85.74"> function disableIfLocked( prefstrArray )</span>
<a href="#l85.75"></a><span id="l85.75"> {</span>
<a href="#l85.76"></a><span id="l85.76">   for (var i=0; i&lt;prefstrArray.length; i++) {</span>
<a href="#l85.77"></a><span id="l85.77">     var id = prefstrArray[i].id;</span>
<a href="#l85.78"></a><span id="l85.78">     var element = document.getElementById(id);</span>
<a href="#l85.79"></a><span id="l85.79">     if (gMdnPrefBranch.prefIsLocked(prefstrArray[i].prefstring)) {</span>
<a href="#l85.80"></a><span id="l85.80">       if (id == &quot;server.incorporate_return_receipt&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l86.1"></a><span id="l86.1" class="difflineminus">--- a/mailnews/extensions/mdn/content/mdn.js</span>
<a href="#l86.2"></a><span id="l86.2" class="difflineplus">+++ b/mailnews/extensions/mdn/content/mdn.js</span>
<a href="#l86.3"></a><span id="l86.3" class="difflineat">@@ -10,14 +10,14 @@ pref(&quot;mail.identity.default.use_custom_p</span>
<a href="#l86.4"></a><span id="l86.4"> </span>
<a href="#l86.5"></a><span id="l86.5"> pref(&quot;mail.identity.default.request_return_receipt_on&quot;, false);</span>
<a href="#l86.6"></a><span id="l86.6"> </span>
<a href="#l86.7"></a><span id="l86.7"> pref(&quot;mail.server.default.incorporate_return_receipt&quot;, 0);       // 0: Inbox/filter 1: Sent folder</span>
<a href="#l86.8"></a><span id="l86.8"> </span>
<a href="#l86.9"></a><span id="l86.9"> pref(&quot;mail.server.default.mdn_report_enabled&quot;, true);            // false: Never return receipts true: Return some receipts</span>
<a href="#l86.10"></a><span id="l86.10"> </span>
<a href="#l86.11"></a><span id="l86.11"> pref(&quot;mail.server.default.mdn_not_in_to_cc&quot;, 2);                 // 0: Never 1: Always 2: Ask me 3: Denial</span>
<a href="#l86.12"></a><span id="l86.12" class="difflineminus">-pref(&quot;mail.server.default.mdn_outside_domain&quot;, 2); </span>
<a href="#l86.13"></a><span id="l86.13" class="difflineminus">-pref(&quot;mail.server.default.mdn_other&quot;, 2); </span>
<a href="#l86.14"></a><span id="l86.14" class="difflineplus">+pref(&quot;mail.server.default.mdn_outside_domain&quot;, 2);</span>
<a href="#l86.15"></a><span id="l86.15" class="difflineplus">+pref(&quot;mail.server.default.mdn_other&quot;, 2);</span>
<a href="#l86.16"></a><span id="l86.16"> </span>
<a href="#l86.17"></a><span id="l86.17"> pref(&quot;mail.identity.default.request_receipt_header_type&quot;, 0); // return receipt header type - 0: MDN-DNT 1: RRT 2: Both</span>
<a href="#l86.18"></a><span id="l86.18"> </span>
<a href="#l86.19"></a><span id="l86.19"> pref(&quot;mail.server.default.mdn_report_enabled&quot;, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l87.1"></a><span id="l87.1" class="difflineminus">--- a/mailnews/extensions/mdn/test/unit/test_askuser.js</span>
<a href="#l87.2"></a><span id="l87.2" class="difflineplus">+++ b/mailnews/extensions/mdn/test/unit/test_askuser.js</span>
<a href="#l87.3"></a><span id="l87.3" class="difflineat">@@ -7,40 +7,40 @@ var localAccount = MailServices.accounts</span>
<a href="#l87.4"></a><span id="l87.4">                                .FindAccountForServer(localAccountUtils.incomingServer);</span>
<a href="#l87.5"></a><span id="l87.5"> var identity = MailServices.accounts.createIdentity();</span>
<a href="#l87.6"></a><span id="l87.6"> identity.email = &quot;bob@t2.example.net&quot;;</span>
<a href="#l87.7"></a><span id="l87.7"> localAccount.addIdentity(identity);</span>
<a href="#l87.8"></a><span id="l87.8"> localAccount.defaultIdentity = identity;</span>
<a href="#l87.9"></a><span id="l87.9"> </span>
<a href="#l87.10"></a><span id="l87.10"> function run_test()</span>
<a href="#l87.11"></a><span id="l87.11"> {</span>
<a href="#l87.12"></a><span id="l87.12" class="difflineminus">-  var headers = </span>
<a href="#l87.13"></a><span id="l87.13" class="difflineminus">-    &quot;from: alice@t1.example.com\r\n&quot; + </span>
<a href="#l87.14"></a><span id="l87.14" class="difflineminus">-    &quot;to: bob@t2.example.net\r\n&quot; + </span>
<a href="#l87.15"></a><span id="l87.15" class="difflineplus">+  var headers =</span>
<a href="#l87.16"></a><span id="l87.16" class="difflineplus">+    &quot;from: alice@t1.example.com\r\n&quot; +</span>
<a href="#l87.17"></a><span id="l87.17" class="difflineplus">+    &quot;to: bob@t2.example.net\r\n&quot; +</span>
<a href="#l87.18"></a><span id="l87.18">     &quot;return-path: alice@t1.example.com\r\n&quot; +</span>
<a href="#l87.19"></a><span id="l87.19">     &quot;Disposition-Notification-To: alice@t1.example.com\r\n&quot;;</span>
<a href="#l87.20"></a><span id="l87.20"> </span>
<a href="#l87.21"></a><span id="l87.21">   let mimeHdr = Components.classes[&quot;@mozilla.org/messenger/mimeheaders;1&quot;]</span>
<a href="#l87.22"></a><span id="l87.22">                   .createInstance(Components.interfaces.nsIMimeHeaders);</span>
<a href="#l87.23"></a><span id="l87.23">   mimeHdr.initialize(headers);</span>
<a href="#l87.24"></a><span id="l87.24">   let receivedHeader = mimeHdr.extractHeader(&quot;To&quot;, false);</span>
<a href="#l87.25"></a><span id="l87.25">   dump(receivedHeader+&quot;\n&quot;);</span>
<a href="#l87.26"></a><span id="l87.26"> </span>
<a href="#l87.27"></a><span id="l87.27">   let localFolder = localAccountUtils.inboxFolder.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l87.28"></a><span id="l87.28">   localAccountUtils.inboxFolder.addMessage(&quot;From \r\n&quot;+ headers + &quot;\r\nhello\r\n&quot;);</span>
<a href="#l87.29"></a><span id="l87.29" class="difflineminus">-  // Need to setup some prefs  </span>
<a href="#l87.30"></a><span id="l87.30" class="difflineplus">+  // Need to setup some prefs</span>
<a href="#l87.31"></a><span id="l87.31">   Services.prefs.setBoolPref(&quot;mail.mdn.report.enabled&quot;, true);</span>
<a href="#l87.32"></a><span id="l87.32">   Services.prefs.setIntPref(&quot;mail.mdn.report.not_in_to_cc&quot;, 2);</span>
<a href="#l87.33"></a><span id="l87.33">   Services.prefs.setIntPref(&quot;mail.mdn.report.other&quot;, 2);</span>
<a href="#l87.34"></a><span id="l87.34">   Services.prefs.setIntPref(&quot;mail.mdn.report.outside_domain&quot;, 2);</span>
<a href="#l87.35"></a><span id="l87.35" class="difflineminus">-  </span>
<a href="#l87.36"></a><span id="l87.36" class="difflineplus">+</span>
<a href="#l87.37"></a><span id="l87.37">   var msgFolder = localAccountUtils.inboxFolder;</span>
<a href="#l87.38"></a><span id="l87.38"> </span>
<a href="#l87.39"></a><span id="l87.39">   var msgWindow = {};</span>
<a href="#l87.40"></a><span id="l87.40" class="difflineminus">- </span>
<a href="#l87.41"></a><span id="l87.41" class="difflineplus">+</span>
<a href="#l87.42"></a><span id="l87.42">   var msgHdr = mailTestUtils.firstMsgHdr(localAccountUtils.inboxFolder);</span>
<a href="#l87.43"></a><span id="l87.43"> </span>
<a href="#l87.44"></a><span id="l87.44">   // Everything looks good so far, let's generate the MDN response.</span>
<a href="#l87.45"></a><span id="l87.45">   var mdnGenerator = Components.classes[&quot;@mozilla.org/messenger-mdn/generator;1&quot;]</span>
<a href="#l87.46"></a><span id="l87.46">                                .createInstance(Components.interfaces.nsIMsgMdnGenerator);</span>
<a href="#l87.47"></a><span id="l87.47">   const MDN_DISPOSE_TYPE_DISPLAYED = 0;</span>
<a href="#l87.48"></a><span id="l87.48"> </span>
<a href="#l87.49"></a><span id="l87.49">   Services.prefs.setIntPref(&quot;mail.mdn.report.outside_domain&quot;, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l88.1"></a><span id="l88.1" class="difflineminus">--- a/mailnews/extensions/mdn/test/unit/test_mdnFlags.js</span>
<a href="#l88.2"></a><span id="l88.2" class="difflineplus">+++ b/mailnews/extensions/mdn/test/unit/test_mdnFlags.js</span>
<a href="#l88.3"></a><span id="l88.3" class="difflineat">@@ -14,39 +14,39 @@ var identity = MailServices.accounts.cre</span>
<a href="#l88.4"></a><span id="l88.4"> identity.email = &quot;bob@t2.example.net&quot;;</span>
<a href="#l88.5"></a><span id="l88.5"> localAccount.addIdentity(identity);</span>
<a href="#l88.6"></a><span id="l88.6"> localAccount.defaultIdentity = identity;</span>
<a href="#l88.7"></a><span id="l88.7"> </span>
<a href="#l88.8"></a><span id="l88.8"> </span>
<a href="#l88.9"></a><span id="l88.9"> </span>
<a href="#l88.10"></a><span id="l88.10"> function run_test()</span>
<a href="#l88.11"></a><span id="l88.11"> {</span>
<a href="#l88.12"></a><span id="l88.12" class="difflineminus">-  var headers = </span>
<a href="#l88.13"></a><span id="l88.13" class="difflineplus">+  var headers =</span>
<a href="#l88.14"></a><span id="l88.14">     &quot;from: alice@t1.example.com\r\n&quot; +</span>
<a href="#l88.15"></a><span id="l88.15">     &quot;to: bob@t2.example.net\r\n&quot; +</span>
<a href="#l88.16"></a><span id="l88.16">     &quot;return-path: alice@t1.example.com\r\n&quot; +</span>
<a href="#l88.17"></a><span id="l88.17">     &quot;Disposition-Notification-To: alice@t1.example.com\r\n&quot;;</span>
<a href="#l88.18"></a><span id="l88.18"> </span>
<a href="#l88.19"></a><span id="l88.19">   let mimeHdr = Components.classes[&quot;@mozilla.org/messenger/mimeheaders;1&quot;]</span>
<a href="#l88.20"></a><span id="l88.20">                   .createInstance(Components.interfaces.nsIMimeHeaders);</span>
<a href="#l88.21"></a><span id="l88.21">   mimeHdr.initialize(headers);</span>
<a href="#l88.22"></a><span id="l88.22">   let receivedHeader = mimeHdr.extractHeader(&quot;To&quot;, false);</span>
<a href="#l88.23"></a><span id="l88.23"> </span>
<a href="#l88.24"></a><span id="l88.24">   let localFolder = localAccountUtils.inboxFolder.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l88.25"></a><span id="l88.25">   localAccountUtils.inboxFolder.addMessage(&quot;From \r\n&quot;+ headers + &quot;\r\nhello\r\n&quot;);</span>
<a href="#l88.26"></a><span id="l88.26" class="difflineminus">-  // Need to setup some prefs  </span>
<a href="#l88.27"></a><span id="l88.27" class="difflineplus">+  // Need to setup some prefs</span>
<a href="#l88.28"></a><span id="l88.28">   Services.prefs.setBoolPref(&quot;mail.mdn.report.enabled&quot;, true);</span>
<a href="#l88.29"></a><span id="l88.29">   Services.prefs.setIntPref(&quot;mail.mdn.report.not_in_to_cc&quot;, 2);</span>
<a href="#l88.30"></a><span id="l88.30">   Services.prefs.setIntPref(&quot;mail.mdn.report.other&quot;, 2);</span>
<a href="#l88.31"></a><span id="l88.31">   Services.prefs.setIntPref(&quot;mail.mdn.report.outside_domain&quot;, 2);</span>
<a href="#l88.32"></a><span id="l88.32" class="difflineminus">-  </span>
<a href="#l88.33"></a><span id="l88.33" class="difflineplus">+</span>
<a href="#l88.34"></a><span id="l88.34">   var msgFolder = localAccountUtils.inboxFolder;</span>
<a href="#l88.35"></a><span id="l88.35"> </span>
<a href="#l88.36"></a><span id="l88.36">   var msgWindow = {};</span>
<a href="#l88.37"></a><span id="l88.37" class="difflineminus">- </span>
<a href="#l88.38"></a><span id="l88.38" class="difflineplus">+</span>
<a href="#l88.39"></a><span id="l88.39">   var msgHdr = mailTestUtils.firstMsgHdr(localAccountUtils.inboxFolder);</span>
<a href="#l88.40"></a><span id="l88.40"> </span>
<a href="#l88.41"></a><span id="l88.41">   // Everything looks good so far, let's generate the MDN response.</span>
<a href="#l88.42"></a><span id="l88.42">   var mdnGenerator = Components.classes[&quot;@mozilla.org/messenger-mdn/generator;1&quot;]</span>
<a href="#l88.43"></a><span id="l88.43">                                .createInstance(Components.interfaces.nsIMsgMdnGenerator);</span>
<a href="#l88.44"></a><span id="l88.44">   const MDN_DISPOSE_TYPE_DISPLAYED = 0;</span>
<a href="#l88.45"></a><span id="l88.45"> </span>
<a href="#l88.46"></a><span id="l88.46">   mdnGenerator.process(MDN_DISPOSE_TYPE_DISPLAYED, msgWindow, msgFolder,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l89.1"></a><span id="l89.1" class="difflineminus">--- a/mailnews/extensions/smime/content/am-smime.js</span>
<a href="#l89.2"></a><span id="l89.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/am-smime.js</span>
<a href="#l89.3"></a><span id="l89.3" class="difflineat">@@ -24,17 +24,17 @@ var gNeverEncrypt = null;</span>
<a href="#l89.4"></a><span id="l89.4"> var gBundle = null;</span>
<a href="#l89.5"></a><span id="l89.5"> var gBrandBundle;</span>
<a href="#l89.6"></a><span id="l89.6"> var gSmimePrefbranch;</span>
<a href="#l89.7"></a><span id="l89.7"> var gEncryptionChoicesLocked;</span>
<a href="#l89.8"></a><span id="l89.8"> var gSigningChoicesLocked;</span>
<a href="#l89.9"></a><span id="l89.9"> var kEncryptionCertPref = &quot;identity.encryption_cert_name&quot;;</span>
<a href="#l89.10"></a><span id="l89.10"> var kSigningCertPref = &quot;identity.signing_cert_name&quot;;</span>
<a href="#l89.11"></a><span id="l89.11"> </span>
<a href="#l89.12"></a><span id="l89.12" class="difflineminus">-function onInit() </span>
<a href="#l89.13"></a><span id="l89.13" class="difflineplus">+function onInit()</span>
<a href="#l89.14"></a><span id="l89.14"> {</span>
<a href="#l89.15"></a><span id="l89.15">   smimeInitializeFields();</span>
<a href="#l89.16"></a><span id="l89.16"> }</span>
<a href="#l89.17"></a><span id="l89.17"> </span>
<a href="#l89.18"></a><span id="l89.18"> function smimeInitializeFields()</span>
<a href="#l89.19"></a><span id="l89.19"> {</span>
<a href="#l89.20"></a><span id="l89.20">   // initialize all of our elements based on the current identity values....</span>
<a href="#l89.21"></a><span id="l89.21">   gEncryptionCertName = document.getElementById(kEncryptionCertPref);</span>
<a href="#l89.22"></a><span id="l89.22" class="difflineat">@@ -193,27 +193,27 @@ function onLockPreference()</span>
<a href="#l89.23"></a><span id="l89.23"> // stomping on the disabled state indiscriminately.</span>
<a href="#l89.24"></a><span id="l89.24"> function disableIfLocked( prefstrArray )</span>
<a href="#l89.25"></a><span id="l89.25"> {</span>
<a href="#l89.26"></a><span id="l89.26">   var i;</span>
<a href="#l89.27"></a><span id="l89.27">   for (i=0; i&lt;prefstrArray.length; i++) {</span>
<a href="#l89.28"></a><span id="l89.28">     var id = prefstrArray[i].id;</span>
<a href="#l89.29"></a><span id="l89.29">     var element = document.getElementById(id);</span>
<a href="#l89.30"></a><span id="l89.30">     if (gSmimePrefbranch.prefIsLocked(prefstrArray[i].prefstring)) {</span>
<a href="#l89.31"></a><span id="l89.31" class="difflineminus">-      // If encryption choices radio group is locked, make sure the individual </span>
<a href="#l89.32"></a><span id="l89.32" class="difflineminus">-      // choices in the group are locked. Set a global (gEncryptionChoicesLocked) </span>
<a href="#l89.33"></a><span id="l89.33" class="difflineplus">+      // If encryption choices radio group is locked, make sure the individual</span>
<a href="#l89.34"></a><span id="l89.34" class="difflineplus">+      // choices in the group are locked. Set a global (gEncryptionChoicesLocked)</span>
<a href="#l89.35"></a><span id="l89.35">       // indicating the status so that locking can be maintained further.</span>
<a href="#l89.36"></a><span id="l89.36">       if (id == &quot;encryptionChoices&quot;) {</span>
<a href="#l89.37"></a><span id="l89.37">         document.getElementById(&quot;encrypt_mail_never&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l89.38"></a><span id="l89.38">         document.getElementById(&quot;encrypt_mail_always&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l89.39"></a><span id="l89.39">         gEncryptionChoicesLocked = true;</span>
<a href="#l89.40"></a><span id="l89.40">       }</span>
<a href="#l89.41"></a><span id="l89.41">       // If option to sign mail is locked (with true/false set in config file), disable</span>
<a href="#l89.42"></a><span id="l89.42">       // the corresponding checkbox and set a global (gSigningChoicesLocked) in order to</span>
<a href="#l89.43"></a><span id="l89.43" class="difflineminus">-      // honor the locking as user changes other elements on the panel. </span>
<a href="#l89.44"></a><span id="l89.44" class="difflineplus">+      // honor the locking as user changes other elements on the panel.</span>
<a href="#l89.45"></a><span id="l89.45">       if (id == &quot;identity.sign_mail&quot;) {</span>
<a href="#l89.46"></a><span id="l89.46">         document.getElementById(&quot;identity.sign_mail&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l89.47"></a><span id="l89.47">         gSigningChoicesLocked = true;</span>
<a href="#l89.48"></a><span id="l89.48">       }</span>
<a href="#l89.49"></a><span id="l89.49">       else {</span>
<a href="#l89.50"></a><span id="l89.50">         element.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l89.51"></a><span id="l89.51">         if (id == &quot;signingCertSelectButton&quot;) {</span>
<a href="#l89.52"></a><span id="l89.52">           document.getElementById(&quot;signingCertClearButton&quot;).setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l89.53"></a><span id="l89.53" class="difflineat">@@ -350,28 +350,28 @@ function smimeSelectCert(smime_cert)</span>
<a href="#l89.54"></a><span id="l89.54">       certInfo.value = x509cert.displayName + &quot; [&quot; + x509cert.serialNumber + &quot;]&quot;;</span>
<a href="#l89.55"></a><span id="l89.55">       certInfo.displayName = x509cert.displayName;</span>
<a href="#l89.56"></a><span id="l89.56">       certInfo.dbKey = x509cert.dbKey;</span>
<a href="#l89.57"></a><span id="l89.57"> </span>
<a href="#l89.58"></a><span id="l89.58">       if (selectEncryptionCert) {</span>
<a href="#l89.59"></a><span id="l89.59">         enableEncryptionControls(true);</span>
<a href="#l89.60"></a><span id="l89.60"> </span>
<a href="#l89.61"></a><span id="l89.61">         checkOtherCert(x509cert,</span>
<a href="#l89.62"></a><span id="l89.62" class="difflineminus">-          kSigningCertPref, email_signing_cert_usage, </span>
<a href="#l89.63"></a><span id="l89.63" class="difflineminus">-          &quot;signing_needCertWantSame&quot;, </span>
<a href="#l89.64"></a><span id="l89.64" class="difflineminus">-          &quot;signing_wantSame&quot;, </span>
<a href="#l89.65"></a><span id="l89.65" class="difflineplus">+          kSigningCertPref, email_signing_cert_usage,</span>
<a href="#l89.66"></a><span id="l89.66" class="difflineplus">+          &quot;signing_needCertWantSame&quot;,</span>
<a href="#l89.67"></a><span id="l89.67" class="difflineplus">+          &quot;signing_wantSame&quot;,</span>
<a href="#l89.68"></a><span id="l89.68">           &quot;signing_needCertWantToSelect&quot;,</span>
<a href="#l89.69"></a><span id="l89.69">           enableSigningControls);</span>
<a href="#l89.70"></a><span id="l89.70">       } else {</span>
<a href="#l89.71"></a><span id="l89.71">         enableSigningControls(true);</span>
<a href="#l89.72"></a><span id="l89.72"> </span>
<a href="#l89.73"></a><span id="l89.73">         checkOtherCert(x509cert,</span>
<a href="#l89.74"></a><span id="l89.74" class="difflineminus">-          kEncryptionCertPref, email_recipient_cert_usage, </span>
<a href="#l89.75"></a><span id="l89.75" class="difflineminus">-          &quot;encryption_needCertWantSame&quot;, </span>
<a href="#l89.76"></a><span id="l89.76" class="difflineminus">-          &quot;encryption_wantSame&quot;, </span>
<a href="#l89.77"></a><span id="l89.77" class="difflineplus">+          kEncryptionCertPref, email_recipient_cert_usage,</span>
<a href="#l89.78"></a><span id="l89.78" class="difflineplus">+          &quot;encryption_needCertWantSame&quot;,</span>
<a href="#l89.79"></a><span id="l89.79" class="difflineplus">+          &quot;encryption_wantSame&quot;,</span>
<a href="#l89.80"></a><span id="l89.80">           &quot;encryption_needCertWantToSelect&quot;,</span>
<a href="#l89.81"></a><span id="l89.81">           enableEncryptionControls);</span>
<a href="#l89.82"></a><span id="l89.82">       }</span>
<a href="#l89.83"></a><span id="l89.83">     }</span>
<a href="#l89.84"></a><span id="l89.84">   }</span>
<a href="#l89.85"></a><span id="l89.85"> </span>
<a href="#l89.86"></a><span id="l89.86">   enableCertSelectButtons();</span>
<a href="#l89.87"></a><span id="l89.87"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l90.1"></a><span id="l90.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgCompSecurityInfo.js</span>
<a href="#l90.2"></a><span id="l90.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgCompSecurityInfo.js</span>
<a href="#l90.3"></a><span id="l90.3" class="difflineat">@@ -68,17 +68,17 @@ function onLoad()</span>
<a href="#l90.4"></a><span id="l90.4">   gCertIssuedInfos = new Object();</span>
<a href="#l90.5"></a><span id="l90.5">   gCertExpiresInfos = new Object();</span>
<a href="#l90.6"></a><span id="l90.6">   gCerts = new Object();</span>
<a href="#l90.7"></a><span id="l90.7">   gCount = new Object();</span>
<a href="#l90.8"></a><span id="l90.8">   var canEncrypt = new Object();</span>
<a href="#l90.9"></a><span id="l90.9"> </span>
<a href="#l90.10"></a><span id="l90.10">   var allow_ldap_cert_fetching = false;</span>
<a href="#l90.11"></a><span id="l90.11"> </span>
<a href="#l90.12"></a><span id="l90.12" class="difflineminus">-  try {  </span>
<a href="#l90.13"></a><span id="l90.13" class="difflineplus">+  try {</span>
<a href="#l90.14"></a><span id="l90.14">     if (params.compFields.securityInfo.requireEncryptMessage) {</span>
<a href="#l90.15"></a><span id="l90.15">       allow_ldap_cert_fetching = true;</span>
<a href="#l90.16"></a><span id="l90.16">     }</span>
<a href="#l90.17"></a><span id="l90.17">   }</span>
<a href="#l90.18"></a><span id="l90.18">   catch (e)</span>
<a href="#l90.19"></a><span id="l90.19">   {</span>
<a href="#l90.20"></a><span id="l90.20">   }</span>
<a href="#l90.21"></a><span id="l90.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l91.1"></a><span id="l91.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js</span>
<a href="#l91.2"></a><span id="l91.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js</span>
<a href="#l91.3"></a><span id="l91.3" class="difflineat">@@ -15,18 +15,18 @@ var gMyLastEncryptedURI = null;</span>
<a href="#l91.4"></a><span id="l91.4"> </span>
<a href="#l91.5"></a><span id="l91.5"> var gSMIMEBundle = null;</span>
<a href="#l91.6"></a><span id="l91.6"> // var gBrandBundle; -- defined in mailWindow.js</span>
<a href="#l91.7"></a><span id="l91.7"> </span>
<a href="#l91.8"></a><span id="l91.8"> // manipulates some globals from msgReadSMIMEOverlay.js</span>
<a href="#l91.9"></a><span id="l91.9"> </span>
<a href="#l91.10"></a><span id="l91.10"> var nsICMSMessageErrors = Components.interfaces.nsICMSMessageErrors;</span>
<a href="#l91.11"></a><span id="l91.11"> </span>
<a href="#l91.12"></a><span id="l91.12" class="difflineminus">-var smimeHeaderSink = </span>
<a href="#l91.13"></a><span id="l91.13" class="difflineminus">-{ </span>
<a href="#l91.14"></a><span id="l91.14" class="difflineplus">+var smimeHeaderSink =</span>
<a href="#l91.15"></a><span id="l91.15" class="difflineplus">+{</span>
<a href="#l91.16"></a><span id="l91.16">   maxWantedNesting: function()</span>
<a href="#l91.17"></a><span id="l91.17">   {</span>
<a href="#l91.18"></a><span id="l91.18">     return 1;</span>
<a href="#l91.19"></a><span id="l91.19">   },</span>
<a href="#l91.20"></a><span id="l91.20"> </span>
<a href="#l91.21"></a><span id="l91.21">   signedStatus: function(aNestingLevel, aSignatureStatus, aSignerCert)</span>
<a href="#l91.22"></a><span id="l91.22">   {</span>
<a href="#l91.23"></a><span id="l91.23">     if (aNestingLevel &gt; 1) {</span>
<a href="#l91.24"></a><span id="l91.24" class="difflineat">@@ -35,17 +35,17 @@ var smimeHeaderSink =</span>
<a href="#l91.25"></a><span id="l91.25">     }</span>
<a href="#l91.26"></a><span id="l91.26"> </span>
<a href="#l91.27"></a><span id="l91.27">     gSignatureStatus = aSignatureStatus;</span>
<a href="#l91.28"></a><span id="l91.28">     gSignerCert = aSignerCert;</span>
<a href="#l91.29"></a><span id="l91.29"> </span>
<a href="#l91.30"></a><span id="l91.30">     gSMIMEContainer.collapsed = false;</span>
<a href="#l91.31"></a><span id="l91.31">     gSignedUINode.collapsed = false;</span>
<a href="#l91.32"></a><span id="l91.32">     gSignedStatusPanel.collapsed = false;</span>
<a href="#l91.33"></a><span id="l91.33" class="difflineminus">-  </span>
<a href="#l91.34"></a><span id="l91.34" class="difflineplus">+</span>
<a href="#l91.35"></a><span id="l91.35">     switch (aSignatureStatus) {</span>
<a href="#l91.36"></a><span id="l91.36">       case nsICMSMessageErrors.SUCCESS:</span>
<a href="#l91.37"></a><span id="l91.37">         gSignedUINode.setAttribute(&quot;signed&quot;, &quot;ok&quot;);</span>
<a href="#l91.38"></a><span id="l91.38">         gStatusBar.setAttribute(&quot;signed&quot;, &quot;ok&quot;);</span>
<a href="#l91.39"></a><span id="l91.39">         break;</span>
<a href="#l91.40"></a><span id="l91.40"> </span>
<a href="#l91.41"></a><span id="l91.41">       case nsICMSMessageErrors.VERIFY_NOT_YET_ATTEMPTED:</span>
<a href="#l91.42"></a><span id="l91.42">         gSignedUINode.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l91.43"></a><span id="l91.43" class="difflineat">@@ -70,31 +70,31 @@ var smimeHeaderSink =</span>
<a href="#l91.44"></a><span id="l91.44">     if (aNestingLevel &gt; 1) {</span>
<a href="#l91.45"></a><span id="l91.45">       // we are not interested</span>
<a href="#l91.46"></a><span id="l91.46">       return;</span>
<a href="#l91.47"></a><span id="l91.47">     }</span>
<a href="#l91.48"></a><span id="l91.48"> </span>
<a href="#l91.49"></a><span id="l91.49">     gEncryptionStatus = aEncryptionStatus;</span>
<a href="#l91.50"></a><span id="l91.50">     gEncryptionCert = aRecipientCert;</span>
<a href="#l91.51"></a><span id="l91.51"> </span>
<a href="#l91.52"></a><span id="l91.52" class="difflineminus">-    gSMIMEContainer.collapsed = false; </span>
<a href="#l91.53"></a><span id="l91.53" class="difflineplus">+    gSMIMEContainer.collapsed = false;</span>
<a href="#l91.54"></a><span id="l91.54">     gEncryptedUINode.collapsed = false;</span>
<a href="#l91.55"></a><span id="l91.55" class="difflineminus">-    gEncryptedStatusPanel.collapsed = false; </span>
<a href="#l91.56"></a><span id="l91.56" class="difflineplus">+    gEncryptedStatusPanel.collapsed = false;</span>
<a href="#l91.57"></a><span id="l91.57"> </span>
<a href="#l91.58"></a><span id="l91.58">     if (nsICMSMessageErrors.SUCCESS == aEncryptionStatus)</span>
<a href="#l91.59"></a><span id="l91.59">     {</span>
<a href="#l91.60"></a><span id="l91.60">       gEncryptedUINode.setAttribute(&quot;encrypted&quot;, &quot;ok&quot;);</span>
<a href="#l91.61"></a><span id="l91.61">       gStatusBar.setAttribute(&quot;encrypted&quot;, &quot;ok&quot;);</span>
<a href="#l91.62"></a><span id="l91.62">     }</span>
<a href="#l91.63"></a><span id="l91.63">     else</span>
<a href="#l91.64"></a><span id="l91.64">     {</span>
<a href="#l91.65"></a><span id="l91.65">       gEncryptedUINode.setAttribute(&quot;encrypted&quot;, &quot;notok&quot;);</span>
<a href="#l91.66"></a><span id="l91.66">       gStatusBar.setAttribute(&quot;encrypted&quot;, &quot;notok&quot;);</span>
<a href="#l91.67"></a><span id="l91.67">     }</span>
<a href="#l91.68"></a><span id="l91.68" class="difflineminus">-    </span>
<a href="#l91.69"></a><span id="l91.69" class="difflineplus">+</span>
<a href="#l91.70"></a><span id="l91.70">     if (gEncryptedURIService)</span>
<a href="#l91.71"></a><span id="l91.71">     {</span>
<a href="#l91.72"></a><span id="l91.72">       gMyLastEncryptedURI = GetLoadedMessage();</span>
<a href="#l91.73"></a><span id="l91.73">       gEncryptedURIService.rememberEncrypted(gMyLastEncryptedURI);</span>
<a href="#l91.74"></a><span id="l91.74">     }</span>
<a href="#l91.75"></a><span id="l91.75"> </span>
<a href="#l91.76"></a><span id="l91.76">     switch (aEncryptionStatus)</span>
<a href="#l91.77"></a><span id="l91.77">     {</span>
<a href="#l91.78"></a><span id="l91.78" class="difflineat">@@ -136,30 +136,30 @@ function forgetEncryptedURI()</span>
<a href="#l91.79"></a><span id="l91.79">     gMyLastEncryptedURI = null;</span>
<a href="#l91.80"></a><span id="l91.80">   }</span>
<a href="#l91.81"></a><span id="l91.81"> }</span>
<a href="#l91.82"></a><span id="l91.82"> </span>
<a href="#l91.83"></a><span id="l91.83"> function onSMIMEStartHeaders()</span>
<a href="#l91.84"></a><span id="l91.84"> {</span>
<a href="#l91.85"></a><span id="l91.85">   gEncryptionStatus = -1;</span>
<a href="#l91.86"></a><span id="l91.86">   gSignatureStatus = -1;</span>
<a href="#l91.87"></a><span id="l91.87" class="difflineminus">-  </span>
<a href="#l91.88"></a><span id="l91.88" class="difflineplus">+</span>
<a href="#l91.89"></a><span id="l91.89">   gSignerCert = null;</span>
<a href="#l91.90"></a><span id="l91.90">   gEncryptionCert = null;</span>
<a href="#l91.91"></a><span id="l91.91" class="difflineminus">-  </span>
<a href="#l91.92"></a><span id="l91.92" class="difflineplus">+</span>
<a href="#l91.93"></a><span id="l91.93">   gSMIMEContainer.collapsed = true;</span>
<a href="#l91.94"></a><span id="l91.94"> </span>
<a href="#l91.95"></a><span id="l91.95">   gSignedUINode.collapsed = true;</span>
<a href="#l91.96"></a><span id="l91.96">   gSignedUINode.removeAttribute(&quot;signed&quot;);</span>
<a href="#l91.97"></a><span id="l91.97">   gSignedStatusPanel.collapsed = true;</span>
<a href="#l91.98"></a><span id="l91.98">   gStatusBar.removeAttribute(&quot;signed&quot;);</span>
<a href="#l91.99"></a><span id="l91.99"> </span>
<a href="#l91.100"></a><span id="l91.100">   gEncryptedUINode.collapsed = true;</span>
<a href="#l91.101"></a><span id="l91.101">   gEncryptedUINode.removeAttribute(&quot;encrypted&quot;);</span>
<a href="#l91.102"></a><span id="l91.102" class="difflineminus">-  gEncryptedStatusPanel.collapsed = true; </span>
<a href="#l91.103"></a><span id="l91.103" class="difflineplus">+  gEncryptedStatusPanel.collapsed = true;</span>
<a href="#l91.104"></a><span id="l91.104">   gStatusBar.removeAttribute(&quot;encrypted&quot;);</span>
<a href="#l91.105"></a><span id="l91.105"> </span>
<a href="#l91.106"></a><span id="l91.106">   forgetEncryptedURI();</span>
<a href="#l91.107"></a><span id="l91.107"> }</span>
<a href="#l91.108"></a><span id="l91.108"> </span>
<a href="#l91.109"></a><span id="l91.109"> function onSMIMEEndHeaders()</span>
<a href="#l91.110"></a><span id="l91.110"> {}</span>
<a href="#l91.111"></a><span id="l91.111"> </span>
<a href="#l91.112"></a><span id="l91.112" class="difflineat">@@ -191,17 +191,17 @@ function msgHdrViewSMIMEOnLoad(event)</span>
<a href="#l91.113"></a><span id="l91.113"> </span>
<a href="#l91.114"></a><span id="l91.114">   // add ourself to the list of message display listeners so we get notified when we are about to display a</span>
<a href="#l91.115"></a><span id="l91.115">   // message.</span>
<a href="#l91.116"></a><span id="l91.116">   var listener = {};</span>
<a href="#l91.117"></a><span id="l91.117">   listener.onStartHeaders = onSMIMEStartHeaders;</span>
<a href="#l91.118"></a><span id="l91.118">   listener.onEndHeaders = onSMIMEEndHeaders;</span>
<a href="#l91.119"></a><span id="l91.119">   gMessageListeners.push(listener);</span>
<a href="#l91.120"></a><span id="l91.120"> </span>
<a href="#l91.121"></a><span id="l91.121" class="difflineminus">-  gEncryptedURIService = </span>
<a href="#l91.122"></a><span id="l91.122" class="difflineplus">+  gEncryptedURIService =</span>
<a href="#l91.123"></a><span id="l91.123">     Components.classes[&quot;@mozilla.org/messenger-smime/smime-encrypted-uris-service;1&quot;]</span>
<a href="#l91.124"></a><span id="l91.124">     .getService(Components.interfaces.nsIEncryptedSMIMEURIsService);</span>
<a href="#l91.125"></a><span id="l91.125"> }</span>
<a href="#l91.126"></a><span id="l91.126"> </span>
<a href="#l91.127"></a><span id="l91.127"> function msgHdrViewSMIMEOnUnload(event)</span>
<a href="#l91.128"></a><span id="l91.128"> {</span>
<a href="#l91.129"></a><span id="l91.129">   window.crypto.enableSmartCardEvents = false;</span>
<a href="#l91.130"></a><span id="l91.130">   document.removeEventListener(&quot;smartcard-insert&quot;, onSmartCardChange);</span>
<a href="#l91.131"></a><span id="l91.131" class="difflineat">@@ -214,17 +214,17 @@ function msgHdrViewSMIMEOnUnload(event)</span>
<a href="#l91.132"></a><span id="l91.132"> }</span>
<a href="#l91.133"></a><span id="l91.133"> </span>
<a href="#l91.134"></a><span id="l91.134"> function msgHdrViewSMIMEOnMessagePaneHide()</span>
<a href="#l91.135"></a><span id="l91.135"> {</span>
<a href="#l91.136"></a><span id="l91.136">   gSMIMEContainer.collapsed = true;</span>
<a href="#l91.137"></a><span id="l91.137">   gSignedUINode.collapsed = true;</span>
<a href="#l91.138"></a><span id="l91.138">   gSignedStatusPanel.collapsed = true;</span>
<a href="#l91.139"></a><span id="l91.139">   gEncryptedUINode.collapsed = true;</span>
<a href="#l91.140"></a><span id="l91.140" class="difflineminus">-  gEncryptedStatusPanel.collapsed = true; </span>
<a href="#l91.141"></a><span id="l91.141" class="difflineplus">+  gEncryptedStatusPanel.collapsed = true;</span>
<a href="#l91.142"></a><span id="l91.142"> }</span>
<a href="#l91.143"></a><span id="l91.143"> </span>
<a href="#l91.144"></a><span id="l91.144"> function msgHdrViewSMIMEOnMessagePaneUnhide()</span>
<a href="#l91.145"></a><span id="l91.145"> {</span>
<a href="#l91.146"></a><span id="l91.146">   if (gEncryptionStatus != -1 || gSignatureStatus != -1)</span>
<a href="#l91.147"></a><span id="l91.147">   {</span>
<a href="#l91.148"></a><span id="l91.148">     gSMIMEContainer.collapsed = false;</span>
<a href="#l91.149"></a><span id="l91.149"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l92.1"></a><span id="l92.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgReadSecurityInfo.js</span>
<a href="#l92.2"></a><span id="l92.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgReadSecurityInfo.js</span>
<a href="#l92.3"></a><span id="l92.3" class="difflineat">@@ -107,17 +107,17 @@ function onLoad()</span>
<a href="#l92.4"></a><span id="l92.4">         sigInfoHeader = &quot;SIInvalidHeader&quot;;</span>
<a href="#l92.5"></a><span id="l92.5">         sigInfo_clueless = true;</span>
<a href="#l92.6"></a><span id="l92.6">         break;</span>
<a href="#l92.7"></a><span id="l92.7">       default:</span>
<a href="#l92.8"></a><span id="l92.8">         Components.utils.reportError(&quot;Unexpected gSignatureStatus: &quot; +</span>
<a href="#l92.9"></a><span id="l92.9">                                      gSignatureStatus);</span>
<a href="#l92.10"></a><span id="l92.10">     }</span>
<a href="#l92.11"></a><span id="l92.11"> </span>
<a href="#l92.12"></a><span id="l92.12" class="difflineminus">-    document.getElementById(&quot;signatureLabel&quot;).value = </span>
<a href="#l92.13"></a><span id="l92.13" class="difflineplus">+    document.getElementById(&quot;signatureLabel&quot;).value =</span>
<a href="#l92.14"></a><span id="l92.14">       bundle.getString(sigInfoLabel);</span>
<a href="#l92.15"></a><span id="l92.15"> </span>
<a href="#l92.16"></a><span id="l92.16">     var label;</span>
<a href="#l92.17"></a><span id="l92.17">     if (sigInfoHeader) {</span>
<a href="#l92.18"></a><span id="l92.18">       label = document.getElementById(&quot;signatureHeader&quot;);</span>
<a href="#l92.19"></a><span id="l92.19">       label.collapsed = false;</span>
<a href="#l92.20"></a><span id="l92.20">       label.value = bundle.getString(sigInfoHeader);</span>
<a href="#l92.21"></a><span id="l92.21">     }</span>
<a href="#l92.22"></a><span id="l92.22" class="difflineat">@@ -157,17 +157,17 @@ function onLoad()</span>
<a href="#l92.23"></a><span id="l92.23">         encInfoHeader = &quot;EIInvalidHeader&quot;;</span>
<a href="#l92.24"></a><span id="l92.24">         encInfo_clueless = 1;</span>
<a href="#l92.25"></a><span id="l92.25">         break;</span>
<a href="#l92.26"></a><span id="l92.26">       default:</span>
<a href="#l92.27"></a><span id="l92.27">         Components.utils.reportError(&quot;Unexpected gEncryptionStatus: &quot; +</span>
<a href="#l92.28"></a><span id="l92.28">                                      gEncryptionStatus);</span>
<a href="#l92.29"></a><span id="l92.29">     }</span>
<a href="#l92.30"></a><span id="l92.30"> </span>
<a href="#l92.31"></a><span id="l92.31" class="difflineminus">-    document.getElementById(&quot;encryptionLabel&quot;).value = </span>
<a href="#l92.32"></a><span id="l92.32" class="difflineplus">+    document.getElementById(&quot;encryptionLabel&quot;).value =</span>
<a href="#l92.33"></a><span id="l92.33">       bundle.getString(encInfoLabel);</span>
<a href="#l92.34"></a><span id="l92.34"> </span>
<a href="#l92.35"></a><span id="l92.35">     if (encInfoHeader) {</span>
<a href="#l92.36"></a><span id="l92.36">       label = document.getElementById(&quot;encryptionHeader&quot;);</span>
<a href="#l92.37"></a><span id="l92.37">       label.collapsed = false;</span>
<a href="#l92.38"></a><span id="l92.38">       label.value = bundle.getString(encInfoHeader);</span>
<a href="#l92.39"></a><span id="l92.39">     }</span>
<a href="#l92.40"></a><span id="l92.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l93.1"></a><span id="l93.1" class="difflineminus">--- a/mailnews/extensions/smime/content/smime.js</span>
<a href="#l93.2"></a><span id="l93.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/smime.js</span>
<a href="#l93.3"></a><span id="l93.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l93.4"></a><span id="l93.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l93.5"></a><span id="l93.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l93.6"></a><span id="l93.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l93.7"></a><span id="l93.7"> </span>
<a href="#l93.8"></a><span id="l93.8" class="difflineminus">-/* </span>
<a href="#l93.9"></a><span id="l93.9" class="difflineplus">+/*</span>
<a href="#l93.10"></a><span id="l93.10">    Add any default pref values we want for smime</span>
<a href="#l93.11"></a><span id="l93.11"> */</span>
<a href="#l93.12"></a><span id="l93.12"> </span>
<a href="#l93.13"></a><span id="l93.13"> pref(&quot;mail.identity.default.encryption_cert_name&quot;,&quot;&quot;);</span>
<a href="#l93.14"></a><span id="l93.14"> pref(&quot;mail.identity.default.encryptionpolicy&quot;,  0);</span>
<a href="#l93.15"></a><span id="l93.15"> pref(&quot;mail.identity.default.signing_cert_name&quot;, &quot;&quot;);</span>
<a href="#l93.16"></a><span id="l93.16"> pref(&quot;mail.identity.default.sign_mail&quot;, false);</span>
<a href="#l93.17"></a><span id="l93.17"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l94.1"></a><span id="l94.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_bug460636.js</span>
<a href="#l94.2"></a><span id="l94.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_bug460636.js</span>
<a href="#l94.3"></a><span id="l94.3" class="difflineat">@@ -7,17 +7,17 @@ load(&quot;../../../resources/asyncTestUtils.</span>
<a href="#l94.4"></a><span id="l94.4"> </span>
<a href="#l94.5"></a><span id="l94.5"> var gSavedMsgFile;</span>
<a href="#l94.6"></a><span id="l94.6"> </span>
<a href="#l94.7"></a><span id="l94.7"> var gIMAPService = Cc[&quot;@mozilla.org/messenger/messageservice;1?type=imap&quot;]</span>
<a href="#l94.8"></a><span id="l94.8">                        .getService(Ci.nsIMsgMessageService);</span>
<a href="#l94.9"></a><span id="l94.9"> </span>
<a href="#l94.10"></a><span id="l94.10"> var gFileName = &quot;bug460636&quot;;</span>
<a href="#l94.11"></a><span id="l94.11"> var gMsgFile = do_get_file(&quot;../../../data/&quot; + gFileName);</span>
<a href="#l94.12"></a><span id="l94.12" class="difflineminus">-                     </span>
<a href="#l94.13"></a><span id="l94.13" class="difflineplus">+</span>
<a href="#l94.14"></a><span id="l94.14"> var tests = [</span>
<a href="#l94.15"></a><span id="l94.15">   setup,</span>
<a href="#l94.16"></a><span id="l94.16">   checkSavedMessage,</span>
<a href="#l94.17"></a><span id="l94.17">   teardown</span>
<a href="#l94.18"></a><span id="l94.18"> ];</span>
<a href="#l94.19"></a><span id="l94.19"> </span>
<a href="#l94.20"></a><span id="l94.20"> function* setup() {</span>
<a href="#l94.21"></a><span id="l94.21">   setupIMAPPump();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l95.1"></a><span id="l95.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_dod.js</span>
<a href="#l95.2"></a><span id="l95.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_dod.js</span>
<a href="#l95.3"></a><span id="l95.3" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l95.4"></a><span id="l95.4"> /*</span>
<a href="#l95.5"></a><span id="l95.5">  * Test bodystructure and body fetch by parts. Messages with problem of</span>
<a href="#l95.6"></a><span id="l95.6">  * 'This part will be downloaded on demand' in message pane content (text) area.</span>
<a href="#l95.7"></a><span id="l95.7">  * To add messages to the test, place the 'markerRe' text used for testing in</span>
<a href="#l95.8"></a><span id="l95.8">  * the offending part that is displaying the problem message.</span>
<a href="#l95.9"></a><span id="l95.9">  * Prepend to the filename 'bodystructure' and save in the database</span>
<a href="#l95.10"></a><span id="l95.10">  * See current test files for examples.</span>
<a href="#l95.11"></a><span id="l95.11">  */</span>
<a href="#l95.12"></a><span id="l95.12" class="difflineminus">- </span>
<a href="#l95.13"></a><span id="l95.13" class="difflineplus">+</span>
<a href="#l95.14"></a><span id="l95.14">  // async support</span>
<a href="#l95.15"></a><span id="l95.15"> load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l95.16"></a><span id="l95.16"> load(&quot;../../../resources/asyncTestUtils.js&quot;);</span>
<a href="#l95.17"></a><span id="l95.17"> </span>
<a href="#l95.18"></a><span id="l95.18"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l95.19"></a><span id="l95.19"> </span>
<a href="#l95.20"></a><span id="l95.20"> var gServer, gIMAPIncomingServer, gIMAPDaemon;</span>
<a href="#l95.21"></a><span id="l95.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l96.1"></a><span id="l96.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_downloadOffline.js</span>
<a href="#l96.2"></a><span id="l96.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_downloadOffline.js</span>
<a href="#l96.3"></a><span id="l96.3" class="difflineat">@@ -32,17 +32,17 @@ function *setup() {</span>
<a href="#l96.4"></a><span id="l96.4">   let messages = [];</span>
<a href="#l96.5"></a><span id="l96.5">   let gMessageGenerator = new MessageGenerator();</span>
<a href="#l96.6"></a><span id="l96.6">   messages = messages.concat(gMessageGenerator.makeMessage());</span>
<a href="#l96.7"></a><span id="l96.7">   let dataUri = Services.io.newURI(&quot;data:text/plain;base64,&quot; +</span>
<a href="#l96.8"></a><span id="l96.8">                                    btoa(messages[0].toMessageString()));</span>
<a href="#l96.9"></a><span id="l96.9">   let imapMsg = new imapMessage(dataUri.spec, IMAPPump.mailbox.uidnext++, []);</span>
<a href="#l96.10"></a><span id="l96.10">   imapMsg.setSize(5000);</span>
<a href="#l96.11"></a><span id="l96.11">   IMAPPump.mailbox.addMessage(imapMsg);</span>
<a href="#l96.12"></a><span id="l96.12" class="difflineminus">-  </span>
<a href="#l96.13"></a><span id="l96.13" class="difflineplus">+</span>
<a href="#l96.14"></a><span id="l96.14">   // ...and download for offline use.</span>
<a href="#l96.15"></a><span id="l96.15">   let promiseUrlListener = new PromiseTestUtils.PromiseUrlListener();</span>
<a href="#l96.16"></a><span id="l96.16">   IMAPPump.inbox.downloadAllForOffline(promiseUrlListener, null);</span>
<a href="#l96.17"></a><span id="l96.17">   yield promiseUrlListener.promise;</span>
<a href="#l96.18"></a><span id="l96.18"> }</span>
<a href="#l96.19"></a><span id="l96.19"> </span>
<a href="#l96.20"></a><span id="l96.20"> function *downloadAllForOffline() {</span>
<a href="#l96.21"></a><span id="l96.21">   let promiseUrlListener = new PromiseTestUtils.PromiseUrlListener();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l97.1"></a><span id="l97.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapAttachmentSaves.js</span>
<a href="#l97.2"></a><span id="l97.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapAttachmentSaves.js</span>
<a href="#l97.3"></a><span id="l97.3" class="difflineat">@@ -86,17 +86,17 @@ function* startDetach()</span>
<a href="#l97.4"></a><span id="l97.4"> }</span>
<a href="#l97.5"></a><span id="l97.5"> </span>
<a href="#l97.6"></a><span id="l97.6"> // test that the detachment was successful</span>
<a href="#l97.7"></a><span id="l97.7"> function* testDetach()</span>
<a href="#l97.8"></a><span id="l97.8"> {</span>
<a href="#l97.9"></a><span id="l97.9">   // This test seems to fail on Linux without the following delay.</span>
<a href="#l97.10"></a><span id="l97.10">   mailTestUtils.do_timeout_function(200, async_driver);</span>
<a href="#l97.11"></a><span id="l97.11">   yield false;</span>
<a href="#l97.12"></a><span id="l97.12" class="difflineminus">-  // Check that the file attached to the message now exists in the profile </span>
<a href="#l97.13"></a><span id="l97.13" class="difflineplus">+  // Check that the file attached to the message now exists in the profile</span>
<a href="#l97.14"></a><span id="l97.14">   // directory.</span>
<a href="#l97.15"></a><span id="l97.15">   let checkFile = do_get_profile().clone();</span>
<a href="#l97.16"></a><span id="l97.16">   checkFile.append(kAttachFileName);</span>
<a href="#l97.17"></a><span id="l97.17">   Assert.ok(checkFile.exists());</span>
<a href="#l97.18"></a><span id="l97.18"> </span>
<a href="#l97.19"></a><span id="l97.19">   // The message should now have a detached attachment. Read the message,</span>
<a href="#l97.20"></a><span id="l97.20">   //  and search for &quot;AttachmentDetached&quot; which is added on detachment.</span>
<a href="#l97.21"></a><span id="l97.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l98.1"></a><span id="l98.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapChunks.js</span>
<a href="#l98.2"></a><span id="l98.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapChunks.js</span>
<a href="#l98.3"></a><span id="l98.3" class="difflineat">@@ -7,17 +7,17 @@ ChromeUtils.import(&quot;resource:///modules/</span>
<a href="#l98.4"></a><span id="l98.4"> </span>
<a href="#l98.5"></a><span id="l98.5"> var gIMAPDaemon, gServer, gIMAPIncomingServer, gSavedMsgFile;</span>
<a href="#l98.6"></a><span id="l98.6"> </span>
<a href="#l98.7"></a><span id="l98.7"> var gIMAPService = Cc[&quot;@mozilla.org/messenger/messageservice;1?type=imap&quot;]</span>
<a href="#l98.8"></a><span id="l98.8">                        .getService(Ci.nsIMsgMessageService);</span>
<a href="#l98.9"></a><span id="l98.9"> </span>
<a href="#l98.10"></a><span id="l98.10"> var gFileName = &quot;bug92111&quot;;</span>
<a href="#l98.11"></a><span id="l98.11"> var gMsgFile = do_get_file(&quot;../../../data/&quot; + gFileName);</span>
<a href="#l98.12"></a><span id="l98.12" class="difflineminus">-                     </span>
<a href="#l98.13"></a><span id="l98.13" class="difflineplus">+</span>
<a href="#l98.14"></a><span id="l98.14"> function run_test()</span>
<a href="#l98.15"></a><span id="l98.15"> {</span>
<a href="#l98.16"></a><span id="l98.16">   /*</span>
<a href="#l98.17"></a><span id="l98.17">    * Set up an IMAP server. The bug is only triggered when nsMsgSaveAsListener</span>
<a href="#l98.18"></a><span id="l98.18">    * is used (i.e., for IMAP and NNTP).</span>
<a href="#l98.19"></a><span id="l98.19">    */</span>
<a href="#l98.20"></a><span id="l98.20">   gIMAPDaemon = new imapDaemon();</span>
<a href="#l98.21"></a><span id="l98.21">   gServer = makeServer(gIMAPDaemon, &quot;&quot;);</span>
<a href="#l98.22"></a><span id="l98.22" class="difflineat">@@ -95,17 +95,17 @@ function endTest()</span>
<a href="#l98.23"></a><span id="l98.23">   }</span>
<a href="#l98.24"></a><span id="l98.24">   catch (ex) {</span>
<a href="#l98.25"></a><span id="l98.25">     dump(ex);</span>
<a href="#l98.26"></a><span id="l98.26">     do_throw(ex);</span>
<a href="#l98.27"></a><span id="l98.27">   }</span>
<a href="#l98.28"></a><span id="l98.28">   do_test_finished();</span>
<a href="#l98.29"></a><span id="l98.29"> }</span>
<a href="#l98.30"></a><span id="l98.30"> </span>
<a href="#l98.31"></a><span id="l98.31" class="difflineminus">-var UrlListener = </span>
<a href="#l98.32"></a><span id="l98.32" class="difflineplus">+var UrlListener =</span>
<a href="#l98.33"></a><span id="l98.33"> {</span>
<a href="#l98.34"></a><span id="l98.34">   OnStartRunningUrl: function(url) { },</span>
<a href="#l98.35"></a><span id="l98.35">   OnStopRunningUrl: function(url, rc)</span>
<a href="#l98.36"></a><span id="l98.36">   {</span>
<a href="#l98.37"></a><span id="l98.37">     // operation succeeded</span>
<a href="#l98.38"></a><span id="l98.38">     Assert.equal(rc, 0);</span>
<a href="#l98.39"></a><span id="l98.39"> </span>
<a href="#l98.40"></a><span id="l98.40">     // File contents were not modified</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l99.1"></a><span id="l99.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapContentLength.js</span>
<a href="#l99.2"></a><span id="l99.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapContentLength.js</span>
<a href="#l99.3"></a><span id="l99.3" class="difflineat">@@ -15,17 +15,17 @@ load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l99.4"></a><span id="l99.4"> load(&quot;../../../resources/asyncTestUtils.js&quot;);</span>
<a href="#l99.5"></a><span id="l99.5"> </span>
<a href="#l99.6"></a><span id="l99.6"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l99.7"></a><span id="l99.7"> </span>
<a href="#l99.8"></a><span id="l99.8"> var gMsgHdr = null;</span>
<a href="#l99.9"></a><span id="l99.9"> </span>
<a href="#l99.10"></a><span id="l99.10"> // Take a multipart message as we're testing attachment URLs as well</span>
<a href="#l99.11"></a><span id="l99.11"> var gFile = do_get_file(&quot;../../../data/multipart-complex2&quot;);</span>
<a href="#l99.12"></a><span id="l99.12" class="difflineminus">-                   </span>
<a href="#l99.13"></a><span id="l99.13" class="difflineplus">+</span>
<a href="#l99.14"></a><span id="l99.14"> var tests = [</span>
<a href="#l99.15"></a><span id="l99.15">   setup,</span>
<a href="#l99.16"></a><span id="l99.16">   addMessageToServer,</span>
<a href="#l99.17"></a><span id="l99.17">   verifyContentLength,</span>
<a href="#l99.18"></a><span id="l99.18">   teardown</span>
<a href="#l99.19"></a><span id="l99.19"> ];</span>
<a href="#l99.20"></a><span id="l99.20"> </span>
<a href="#l99.21"></a><span id="l99.21"> // Adds some messages directly to a mailbox (eg new mail)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l100.1"></a><span id="l100.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapFilterActions.js</span>
<a href="#l100.2"></a><span id="l100.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapFilterActions.js</span>
<a href="#l100.3"></a><span id="l100.3" class="difflineat">@@ -46,17 +46,17 @@ var gMessageInBody = &quot;an HTML message&quot;;</span>
<a href="#l100.4"></a><span id="l100.4"> var gCopyService = MailServices.copy;</span>
<a href="#l100.5"></a><span id="l100.5"> var gDbService = Components.classes[&quot;@mozilla.org/msgDatabase/msgDBService;1&quot;]</span>
<a href="#l100.6"></a><span id="l100.6">                              .getService(Components.interfaces.nsIMsgDBService);</span>
<a href="#l100.7"></a><span id="l100.7"> </span>
<a href="#l100.8"></a><span id="l100.8"> // Definition of tests. The test function name is the filter action</span>
<a href="#l100.9"></a><span id="l100.9"> // being tested, with &quot;Body&quot; appended to tests that use delayed</span>
<a href="#l100.10"></a><span id="l100.10"> // application of filters due to a body search</span>
<a href="#l100.11"></a><span id="l100.11"> var gTestArray =</span>
<a href="#l100.12"></a><span id="l100.12" class="difflineminus">-[ </span>
<a href="#l100.13"></a><span id="l100.13" class="difflineplus">+[</span>
<a href="#l100.14"></a><span id="l100.14">   setupIMAPPump,</span>
<a href="#l100.15"></a><span id="l100.15">     // optionally set server parameters, here enabling debug messages</span>
<a href="#l100.16"></a><span id="l100.16">   //function serverParms() {</span>
<a href="#l100.17"></a><span id="l100.17">   //  IMAPPump.server.setDebugLevel(fsDebugAll);</span>
<a href="#l100.18"></a><span id="l100.18">   //},</span>
<a href="#l100.19"></a><span id="l100.19">   setupFilters,</span>
<a href="#l100.20"></a><span id="l100.20">   // The initial tests do not result in new messages added.</span>
<a href="#l100.21"></a><span id="l100.21">   function *MoveToFolder() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l101.1"></a><span id="l101.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapFlagChange.js</span>
<a href="#l101.2"></a><span id="l101.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapFlagChange.js</span>
<a href="#l101.3"></a><span id="l101.3" class="difflineat">@@ -18,17 +18,17 @@ var tests = [</span>
<a href="#l101.4"></a><span id="l101.4">     let rootFolder = IMAPPump.incomingServer.rootFolder;</span>
<a href="#l101.5"></a><span id="l101.5">     gSecondFolder =  rootFolder.getChildNamed(&quot;secondFolder&quot;)</span>
<a href="#l101.6"></a><span id="l101.6">                            .QueryInterface(Ci.nsIMsgImapMailFolder);</span>
<a href="#l101.7"></a><span id="l101.7"> </span>
<a href="#l101.8"></a><span id="l101.8">     // Selecting the second folder will close the cached connection</span>
<a href="#l101.9"></a><span id="l101.9">     // on the inbox because fake server only supports one connection at a time.</span>
<a href="#l101.10"></a><span id="l101.10">     //  Then, we can poke at the message on the imap server directly, which</span>
<a href="#l101.11"></a><span id="l101.11">     // simulates the user changing the message from a different machine,</span>
<a href="#l101.12"></a><span id="l101.12" class="difflineminus">-    // and Thunderbird discovering the change when it does a flag sync </span>
<a href="#l101.13"></a><span id="l101.13" class="difflineplus">+    // and Thunderbird discovering the change when it does a flag sync</span>
<a href="#l101.14"></a><span id="l101.14">     // upon reselecting the Inbox.</span>
<a href="#l101.15"></a><span id="l101.15">     gSecondFolder.updateFolderWithListener(null, asyncUrlListener);</span>
<a href="#l101.16"></a><span id="l101.16">     yield false;</span>
<a href="#l101.17"></a><span id="l101.17">   },</span>
<a href="#l101.18"></a><span id="l101.18">   function* simulateForwardFlagSet() {</span>
<a href="#l101.19"></a><span id="l101.19">     gMessage.setFlag(&quot;$Forwarded&quot;);</span>
<a href="#l101.20"></a><span id="l101.20">     IMAPPump.inbox.updateFolderWithListener(null, asyncUrlListener);</span>
<a href="#l101.21"></a><span id="l101.21">     yield false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l102.1"></a><span id="l102.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapHighWater.js</span>
<a href="#l102.2"></a><span id="l102.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapHighWater.js</span>
<a href="#l102.3"></a><span id="l102.3" class="difflineat">@@ -156,17 +156,17 @@ var UrlListener =</span>
<a href="#l102.4"></a><span id="l102.4">   {</span>
<a href="#l102.5"></a><span id="l102.5">     // Check for ok status.</span>
<a href="#l102.6"></a><span id="l102.6">     Assert.equal(rc, 0);</span>
<a href="#l102.7"></a><span id="l102.7">     async_driver();</span>
<a href="#l102.8"></a><span id="l102.8">   }</span>
<a href="#l102.9"></a><span id="l102.9"> };</span>
<a href="#l102.10"></a><span id="l102.10"> </span>
<a href="#l102.11"></a><span id="l102.11"> // nsIMsgCopyServiceListener implementation</span>
<a href="#l102.12"></a><span id="l102.12" class="difflineminus">-var CopyListener = </span>
<a href="#l102.13"></a><span id="l102.13" class="difflineplus">+var CopyListener =</span>
<a href="#l102.14"></a><span id="l102.14"> {</span>
<a href="#l102.15"></a><span id="l102.15">   OnStartCopy: function() {},</span>
<a href="#l102.16"></a><span id="l102.16">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l102.17"></a><span id="l102.17">   SetMessageKey: function(aKey){},</span>
<a href="#l102.18"></a><span id="l102.18">   SetMessageId: function(aMessageId) {},</span>
<a href="#l102.19"></a><span id="l102.19">   OnStopCopy: function(aStatus){</span>
<a href="#l102.20"></a><span id="l102.20">     Assert.equal(aStatus, 0);</span>
<a href="#l102.21"></a><span id="l102.21">     async_driver();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l103.1"></a><span id="l103.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_imapStoreMsgOffline.js</span>
<a href="#l103.2"></a><span id="l103.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_imapStoreMsgOffline.js</span>
<a href="#l103.3"></a><span id="l103.3" class="difflineat">@@ -180,30 +180,30 @@ var tests = [</span>
<a href="#l103.4"></a><span id="l103.4">       mbox.addMessage(new imapMessage(dataUri.spec, mbox.uidnext++, []));</span>
<a href="#l103.5"></a><span id="l103.5">     });</span>
<a href="#l103.6"></a><span id="l103.6">     IMAPPump.inbox.updateFolderWithListener(null, asyncUrlListener);</span>
<a href="#l103.7"></a><span id="l103.7">     yield false;</span>
<a href="#l103.8"></a><span id="l103.8">   },</span>
<a href="#l103.9"></a><span id="l103.9">   function* testQueuedOfflineDownload()</span>
<a href="#l103.10"></a><span id="l103.10">   {</span>
<a href="#l103.11"></a><span id="l103.11">     // Make sure that streaming the same message and then trying to download</span>
<a href="#l103.12"></a><span id="l103.12" class="difflineminus">-    // it for offline use doesn't end up in it getting added to the offline </span>
<a href="#l103.13"></a><span id="l103.13" class="difflineplus">+    // it for offline use doesn't end up in it getting added to the offline</span>
<a href="#l103.14"></a><span id="l103.14">     // store twice.</span>
<a href="#l103.15"></a><span id="l103.15">     gImapInboxOfflineStoreSize = IMAPPump.inbox.filePath.fileSize + gFirstMsgSize;</span>
<a href="#l103.16"></a><span id="l103.16">     let newMsgHdr = IMAPPump.inbox.GetMessageHeader(gFirstNewMsg);</span>
<a href="#l103.17"></a><span id="l103.17">     let msgURI = newMsgHdr.folder.getUriForMsg(newMsgHdr);</span>
<a href="#l103.18"></a><span id="l103.18">     let messenger = Cc[&quot;@mozilla.org/messenger;1&quot;].createInstance(Ci.nsIMessenger);</span>
<a href="#l103.19"></a><span id="l103.19">     let msgServ = messenger.messageServiceFromURI(msgURI);</span>
<a href="#l103.20"></a><span id="l103.20">     msgServ.streamMessage(msgURI, gStreamListener, null, null, false, &quot;&quot;, false);</span>
<a href="#l103.21"></a><span id="l103.21">     yield false;</span>
<a href="#l103.22"></a><span id="l103.22">   },</span>
<a href="#l103.23"></a><span id="l103.23">   function* firstStreamFinished()</span>
<a href="#l103.24"></a><span id="l103.24">   {</span>
<a href="#l103.25"></a><span id="l103.25">     // nsIMsgFolder.DownloadMessagesForOffline does not take a listener, so</span>
<a href="#l103.26"></a><span id="l103.26" class="difflineminus">-    // we invoke nsIImapService.downloadMessagesForOffline directly with a </span>
<a href="#l103.27"></a><span id="l103.27" class="difflineplus">+    // we invoke nsIImapService.downloadMessagesForOffline directly with a</span>
<a href="#l103.28"></a><span id="l103.28">     // listener.</span>
<a href="#l103.29"></a><span id="l103.29">     MailServices.imap.downloadMessagesForOffline(gFirstNewMsg,</span>
<a href="#l103.30"></a><span id="l103.30">                                                  IMAPPump.inbox,</span>
<a href="#l103.31"></a><span id="l103.31">                                                  asyncUrlListener,</span>
<a href="#l103.32"></a><span id="l103.32">                                                  null);</span>
<a href="#l103.33"></a><span id="l103.33">     yield false;</span>
<a href="#l103.34"></a><span id="l103.34">   },</span>
<a href="#l103.35"></a><span id="l103.35">   function checkOfflineStoreSize()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l104.1"></a><span id="l104.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_localToImapFilter.js</span>
<a href="#l104.2"></a><span id="l104.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_localToImapFilter.js</span>
<a href="#l104.3"></a><span id="l104.3" class="difflineat">@@ -98,17 +98,17 @@ function folderCount(folder)</span>
<a href="#l104.4"></a><span id="l104.4">   {</span>
<a href="#l104.5"></a><span id="l104.5">     count++;</span>
<a href="#l104.6"></a><span id="l104.6">     let hdr = enumerator.getNext();</span>
<a href="#l104.7"></a><span id="l104.7">   }</span>
<a href="#l104.8"></a><span id="l104.8">   return count;</span>
<a href="#l104.9"></a><span id="l104.9"> }</span>
<a href="#l104.10"></a><span id="l104.10"> </span>
<a href="#l104.11"></a><span id="l104.11"> function setup() {</span>
<a href="#l104.12"></a><span id="l104.12" class="difflineminus">-  setupIMAPPump(); </span>
<a href="#l104.13"></a><span id="l104.13" class="difflineplus">+  setupIMAPPump();</span>
<a href="#l104.14"></a><span id="l104.14">   gEmptyLocal1 = localAccountUtils.incomingServer</span>
<a href="#l104.15"></a><span id="l104.15">                                   .rootFolder.createLocalSubfolder(&quot;empty 1&quot;);</span>
<a href="#l104.16"></a><span id="l104.16">   gEmptyLocal2 = localAccountUtils.incomingServer</span>
<a href="#l104.17"></a><span id="l104.17">                                   .rootFolder.createLocalSubfolder(&quot;empty 2&quot;);</span>
<a href="#l104.18"></a><span id="l104.18"> </span>
<a href="#l104.19"></a><span id="l104.19">   // these hacks are required because we've created the inbox before</span>
<a href="#l104.20"></a><span id="l104.20">   // running initial folder discovery, and adding the folder bails</span>
<a href="#l104.21"></a><span id="l104.21">   // out before we set it as verified online, so we bail out, and</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l105.1"></a><span id="l105.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js</span>
<a href="#l105.2"></a><span id="l105.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_nsIMsgFolderListenerIMAP.js</span>
<a href="#l105.3"></a><span id="l105.3" class="difflineat">@@ -248,17 +248,17 @@ function doTest(test)</span>
<a href="#l105.4"></a><span id="l105.4">   dump(&quot;Doing test &quot; + test + &quot;\n&quot;);</span>
<a href="#l105.5"></a><span id="l105.5">   if (test &lt;= gTestArray.length)</span>
<a href="#l105.6"></a><span id="l105.6">   {</span>
<a href="#l105.7"></a><span id="l105.7">     let testFn = gTestArray[test-1];</span>
<a href="#l105.8"></a><span id="l105.8"> </span>
<a href="#l105.9"></a><span id="l105.9">     // Set a limit of ten seconds; if the notifications haven't arrived by then there's a problem.</span>
<a href="#l105.10"></a><span id="l105.10">     do_timeout(10000, function(){</span>
<a href="#l105.11"></a><span id="l105.11">         if (gTest == test)</span>
<a href="#l105.12"></a><span id="l105.12" class="difflineminus">-          do_throw(&quot;Notifications not received in 10000 ms for operation &quot; + testFn.name + </span>
<a href="#l105.13"></a><span id="l105.13" class="difflineplus">+          do_throw(&quot;Notifications not received in 10000 ms for operation &quot; + testFn.name +</span>
<a href="#l105.14"></a><span id="l105.14">             &quot;, current status is &quot; + gCurrStatus);</span>
<a href="#l105.15"></a><span id="l105.15">         }</span>
<a href="#l105.16"></a><span id="l105.16">       );</span>
<a href="#l105.17"></a><span id="l105.17">     testFn();</span>
<a href="#l105.18"></a><span id="l105.18">   }</span>
<a href="#l105.19"></a><span id="l105.19">   else</span>
<a href="#l105.20"></a><span id="l105.20">   {</span>
<a href="#l105.21"></a><span id="l105.21">     gMFNService.removeListener(gMFListener);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l106.1"></a><span id="l106.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_offlineStoreLocking.js</span>
<a href="#l106.2"></a><span id="l106.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_offlineStoreLocking.js</span>
<a href="#l106.3"></a><span id="l106.3" class="difflineat">@@ -177,17 +177,17 @@ function setup() {</span>
<a href="#l106.4"></a><span id="l106.4">   for (let i = 0; i &lt; 50; i++)</span>
<a href="#l106.5"></a><span id="l106.5">     messages = messages.concat(messageGenerator.makeMessage({body: {body: bodyString, contentType: &quot;text/plain&quot;}}));</span>
<a href="#l106.6"></a><span id="l106.6"> </span>
<a href="#l106.7"></a><span id="l106.7">   addGeneratedMessagesToServer(messages, IMAPPump.daemon.getMailbox(&quot;INBOX&quot;));</span>
<a href="#l106.8"></a><span id="l106.8"> }</span>
<a href="#l106.9"></a><span id="l106.9"> </span>
<a href="#l106.10"></a><span id="l106.10"> // nsIMsgCopyServiceListener implementation - runs next test when copy</span>
<a href="#l106.11"></a><span id="l106.11"> // is completed.</span>
<a href="#l106.12"></a><span id="l106.12" class="difflineminus">-var CopyListener = </span>
<a href="#l106.13"></a><span id="l106.13" class="difflineplus">+var CopyListener =</span>
<a href="#l106.14"></a><span id="l106.14"> {</span>
<a href="#l106.15"></a><span id="l106.15">   OnStartCopy: function() {},</span>
<a href="#l106.16"></a><span id="l106.16">   OnProgress: function(aProgress, aProgressMax) {},</span>
<a href="#l106.17"></a><span id="l106.17">   SetMessageKey: function(aKey)</span>
<a href="#l106.18"></a><span id="l106.18">   {</span>
<a href="#l106.19"></a><span id="l106.19">     let hdr = localAccountUtils.inboxFolder.GetMessageHeader(aKey);</span>
<a href="#l106.20"></a><span id="l106.20">     gMsgHdrs.push({hdr: hdr, ID: hdr.messageId});</span>
<a href="#l106.21"></a><span id="l106.21">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l107.1"></a><span id="l107.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_partsOnDemand.js</span>
<a href="#l107.2"></a><span id="l107.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_partsOnDemand.js</span>
<a href="#l107.3"></a><span id="l107.3" class="difflineat">@@ -102,17 +102,17 @@ function* testAllInlineMessage()</span>
<a href="#l107.4"></a><span id="l107.4">       async_driver();</span>
<a href="#l107.5"></a><span id="l107.5">     }, true /* allowDownload */, { partsOnDemand: true });</span>
<a href="#l107.6"></a><span id="l107.6">     yield false;</span>
<a href="#l107.7"></a><span id="l107.7">   }</span>
<a href="#l107.8"></a><span id="l107.8"> }</span>
<a href="#l107.9"></a><span id="l107.9"> </span>
<a href="#l107.10"></a><span id="l107.10"> function* updateCounts()</span>
<a href="#l107.11"></a><span id="l107.11"> {</span>
<a href="#l107.12"></a><span id="l107.12" class="difflineminus">-  // select the trash, then the inbox again, to force an update of the </span>
<a href="#l107.13"></a><span id="l107.13" class="difflineplus">+  // select the trash, then the inbox again, to force an update of the</span>
<a href="#l107.14"></a><span id="l107.14">   // read state of messages.</span>
<a href="#l107.15"></a><span id="l107.15">   let trash = IMAPPump.incomingServer.rootFolder.getChildNamed(&quot;Trash&quot;);</span>
<a href="#l107.16"></a><span id="l107.16">   Assert.ok(trash instanceof Ci.nsIMsgImapMailFolder);</span>
<a href="#l107.17"></a><span id="l107.17">   trash.updateFolderWithListener(null, asyncUrlListener);</span>
<a href="#l107.18"></a><span id="l107.18">   yield false;</span>
<a href="#l107.19"></a><span id="l107.19">   IMAPPump.inbox.updateFolderWithListener(null, asyncUrlListener);</span>
<a href="#l107.20"></a><span id="l107.20">   yield false;</span>
<a href="#l107.21"></a><span id="l107.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l108.1"></a><span id="l108.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_preserveDataOnMove.js</span>
<a href="#l108.2"></a><span id="l108.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_preserveDataOnMove.js</span>
<a href="#l108.3"></a><span id="l108.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l108.4"></a><span id="l108.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l108.5"></a><span id="l108.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l108.6"></a><span id="l108.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l108.7"></a><span id="l108.7"> </span>
<a href="#l108.8"></a><span id="l108.8"> // This tests that arbitrary message header properties are preserved</span>
<a href="#l108.9"></a><span id="l108.9"> //  during online move of an imap message.</span>
<a href="#l108.10"></a><span id="l108.10"> </span>
<a href="#l108.11"></a><span id="l108.11" class="difflineminus">-// async support </span>
<a href="#l108.12"></a><span id="l108.12" class="difflineplus">+// async support</span>
<a href="#l108.13"></a><span id="l108.13"> load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l108.14"></a><span id="l108.14"> load(&quot;../../../resources/asyncTestUtils.js&quot;);</span>
<a href="#l108.15"></a><span id="l108.15"> </span>
<a href="#l108.16"></a><span id="l108.16"> // IMAP pump</span>
<a href="#l108.17"></a><span id="l108.17"> </span>
<a href="#l108.18"></a><span id="l108.18"> // Globals</span>
<a href="#l108.19"></a><span id="l108.19"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l108.20"></a><span id="l108.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l109.1"></a><span id="l109.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_syncChanges.js</span>
<a href="#l109.2"></a><span id="l109.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_syncChanges.js</span>
<a href="#l109.3"></a><span id="l109.3" class="difflineat">@@ -19,17 +19,17 @@ var tests = [</span>
<a href="#l109.4"></a><span id="l109.4">     let rootFolder = IMAPPump.incomingServer.rootFolder;</span>
<a href="#l109.5"></a><span id="l109.5">     gSecondFolder =  rootFolder.getChildNamed(&quot;secondFolder&quot;)</span>
<a href="#l109.6"></a><span id="l109.6">                            .QueryInterface(Ci.nsIMsgImapMailFolder);</span>
<a href="#l109.7"></a><span id="l109.7"> </span>
<a href="#l109.8"></a><span id="l109.8">     // Selecting the second folder will close the cached connection</span>
<a href="#l109.9"></a><span id="l109.9">     // on the inbox because fake server only supports one connection at a time.</span>
<a href="#l109.10"></a><span id="l109.10">     //  Then, we can poke at the message on the imap server directly, which</span>
<a href="#l109.11"></a><span id="l109.11">     // simulates the user changing the message from a different machine,</span>
<a href="#l109.12"></a><span id="l109.12" class="difflineminus">-    // and Thunderbird discovering the change when it does a flag sync </span>
<a href="#l109.13"></a><span id="l109.13" class="difflineplus">+    // and Thunderbird discovering the change when it does a flag sync</span>
<a href="#l109.14"></a><span id="l109.14">     // upon reselecting the Inbox.</span>
<a href="#l109.15"></a><span id="l109.15">     gSecondFolder.updateFolderWithListener(null, asyncUrlListener);</span>
<a href="#l109.16"></a><span id="l109.16">     yield false;</span>
<a href="#l109.17"></a><span id="l109.17">   },</span>
<a href="#l109.18"></a><span id="l109.18">   function* simulateMailboxEmptied() {</span>
<a href="#l109.19"></a><span id="l109.19">     gMessage.setFlag(&quot;\\Deleted&quot;);</span>
<a href="#l109.20"></a><span id="l109.20">     IMAPPump.inbox.expunge(asyncUrlListener, null);</span>
<a href="#l109.21"></a><span id="l109.21">     yield false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l110.1"></a><span id="l110.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_trustSpamAssassin.js</span>
<a href="#l110.2"></a><span id="l110.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_trustSpamAssassin.js</span>
<a href="#l110.3"></a><span id="l110.3" class="difflineat">@@ -1,22 +1,22 @@</span>
<a href="#l110.4"></a><span id="l110.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l110.5"></a><span id="l110.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l110.6"></a><span id="l110.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l110.7"></a><span id="l110.7" class="difflineminus">- </span>
<a href="#l110.8"></a><span id="l110.8" class="difflineplus">+</span>
<a href="#l110.9"></a><span id="l110.9"> /*</span>
<a href="#l110.10"></a><span id="l110.10">  * This file tests recognizing a message as junk due to</span>
<a href="#l110.11"></a><span id="l110.11">  *  SpamAssassin headers, and marking that as good</span>
<a href="#l110.12"></a><span id="l110.12">  *  without having the message return to the junk folder,</span>
<a href="#l110.13"></a><span id="l110.13">  *  as discussed in bug 540385.</span>
<a href="#l110.14"></a><span id="l110.14">  *</span>
<a href="#l110.15"></a><span id="l110.15">  * adapted from test_filterNeedsBody.js</span>
<a href="#l110.16"></a><span id="l110.16">  */</span>
<a href="#l110.17"></a><span id="l110.17"> </span>
<a href="#l110.18"></a><span id="l110.18" class="difflineminus">-// async support </span>
<a href="#l110.19"></a><span id="l110.19" class="difflineplus">+// async support</span>
<a href="#l110.20"></a><span id="l110.20"> load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l110.21"></a><span id="l110.21"> load(&quot;../../../resources/asyncTestUtils.js&quot;);</span>
<a href="#l110.22"></a><span id="l110.22"> </span>
<a href="#l110.23"></a><span id="l110.23"> // IMAP pump</span>
<a href="#l110.24"></a><span id="l110.24"> </span>
<a href="#l110.25"></a><span id="l110.25"> // Globals</span>
<a href="#l110.26"></a><span id="l110.26"> ChromeUtils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l110.27"></a><span id="l110.27"> </span>
<a href="#l110.28"></a><span id="l110.28" class="difflineat">@@ -145,17 +145,17 @@ function run_test()</span>
<a href="#l110.29"></a><span id="l110.29"> </span>
<a href="#l110.30"></a><span id="l110.30">   spamSettings.initialize(server);</span>
<a href="#l110.31"></a><span id="l110.31"> </span>
<a href="#l110.32"></a><span id="l110.32">   // Add folder listeners that will capture async events</span>
<a href="#l110.33"></a><span id="l110.33">   const nsIMFNService = Ci.nsIMsgFolderNotificationService;</span>
<a href="#l110.34"></a><span id="l110.34"> </span>
<a href="#l110.35"></a><span id="l110.35">   let flags =</span>
<a href="#l110.36"></a><span id="l110.36">         nsIMFNService.msgsMoveCopyCompleted |</span>
<a href="#l110.37"></a><span id="l110.37" class="difflineminus">-        nsIMFNService.folderAdded | </span>
<a href="#l110.38"></a><span id="l110.38" class="difflineplus">+        nsIMFNService.folderAdded |</span>
<a href="#l110.39"></a><span id="l110.39">         nsIMFNService.msgAdded;</span>
<a href="#l110.40"></a><span id="l110.40">   MailServices.mfn.addListener(mfnListener, flags);</span>
<a href="#l110.41"></a><span id="l110.41"> </span>
<a href="#l110.42"></a><span id="l110.42">   //start first test</span>
<a href="#l110.43"></a><span id="l110.43">   async_run_tests(tests);</span>
<a href="#l110.44"></a><span id="l110.44"> }</span>
<a href="#l110.45"></a><span id="l110.45"> </span>
<a href="#l110.46"></a><span id="l110.46"> var mfnListener =</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l111.1"></a><span id="l111.1" class="difflineminus">--- a/mailnews/import/content/fieldMapImport.js</span>
<a href="#l111.2"></a><span id="l111.2" class="difflineplus">+++ b/mailnews/import/content/fieldMapImport.js</span>
<a href="#l111.3"></a><span id="l111.3" class="difflineat">@@ -78,17 +78,17 @@ function ListFields() {</span>
<a href="#l111.4"></a><span id="l111.4"> }</span>
<a href="#l111.5"></a><span id="l111.5"> </span>
<a href="#l111.6"></a><span id="l111.6"> function CreateField( name, index, on)</span>
<a href="#l111.7"></a><span id="l111.7"> {</span>
<a href="#l111.8"></a><span id="l111.8">   var item = document.createElement('listitem');</span>
<a href="#l111.9"></a><span id="l111.9">   item.setAttribute('field-index', index);</span>
<a href="#l111.10"></a><span id="l111.10">   item.setAttribute('type', &quot;checkbox&quot;);</span>
<a href="#l111.11"></a><span id="l111.11">   var cell = document.createElement('listcell');</span>
<a href="#l111.12"></a><span id="l111.12" class="difflineminus">-  var cCell = document.createElement( 'listcell');  </span>
<a href="#l111.13"></a><span id="l111.13" class="difflineplus">+  var cCell = document.createElement( 'listcell');</span>
<a href="#l111.14"></a><span id="l111.14">   cCell.setAttribute('type', &quot;checkbox&quot;);</span>
<a href="#l111.15"></a><span id="l111.15">   cCell.setAttribute( 'label', name);</span>
<a href="#l111.16"></a><span id="l111.16">   if (on == true)</span>
<a href="#l111.17"></a><span id="l111.17">     cCell.setAttribute( 'checked', &quot;true&quot;);</span>
<a href="#l111.18"></a><span id="l111.18">   item.appendChild( cCell);</span>
<a href="#l111.19"></a><span id="l111.19">   cell.setAttribute( &quot;class&quot;, &quot;importsampledata&quot;);</span>
<a href="#l111.20"></a><span id="l111.20">   cell.setAttribute( 'label', &quot;&quot;);</span>
<a href="#l111.21"></a><span id="l111.21">   item.appendChild( cell);</span>
<a href="#l111.22"></a><span id="l111.22" class="difflineat">@@ -145,17 +145,17 @@ function FetchSampleData(num)</span>
<a href="#l111.23"></a><span id="l111.23"> {</span>
<a href="#l111.24"></a><span id="l111.24">   if (!top.addInterface)</span>
<a href="#l111.25"></a><span id="l111.25">     return false;</span>
<a href="#l111.26"></a><span id="l111.26"> </span>
<a href="#l111.27"></a><span id="l111.27">   var data = top.addInterface.GetData( &quot;sampleData-&quot; + num);</span>
<a href="#l111.28"></a><span id="l111.28">   if (!(data instanceof Components.interfaces.nsISupportsString))</span>
<a href="#l111.29"></a><span id="l111.29">     return false;</span>
<a href="#l111.30"></a><span id="l111.30">   ShowSampleData( data.data);</span>
<a href="#l111.31"></a><span id="l111.31" class="difflineminus">-  return true;  </span>
<a href="#l111.32"></a><span id="l111.32" class="difflineplus">+  return true;</span>
<a href="#l111.33"></a><span id="l111.33"> }</span>
<a href="#l111.34"></a><span id="l111.34"> </span>
<a href="#l111.35"></a><span id="l111.35"> function Browse(step)</span>
<a href="#l111.36"></a><span id="l111.36"> {</span>
<a href="#l111.37"></a><span id="l111.37">   recordNum += step;</span>
<a href="#l111.38"></a><span id="l111.38">   if (FetchSampleData(recordNum - 1))</span>
<a href="#l111.39"></a><span id="l111.39">     document.getElementById('recordNumber').setAttribute('value', (&quot;&quot; + recordNum));</span>
<a href="#l111.40"></a><span id="l111.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l112.1"></a><span id="l112.1" class="difflineminus">--- a/mailnews/import/test/unit/resources/addressbook.json</span>
<a href="#l112.2"></a><span id="l112.2" class="difflineplus">+++ b/mailnews/import/test/unit/resources/addressbook.json</span>
<a href="#l112.3"></a><span id="l112.3" class="difflineat">@@ -68,17 +68,17 @@</span>
<a href="#l112.4"></a><span id="l112.4">     }</span>
<a href="#l112.5"></a><span id="l112.5">   ],</span>
<a href="#l112.6"></a><span id="l112.6">   &quot;quote_csv&quot; :</span>
<a href="#l112.7"></a><span id="l112.7">   [</span>
<a href="#l112.8"></a><span id="l112.8">     {</span>
<a href="#l112.9"></a><span id="l112.9">       &quot;DisplayName&quot;      : &quot;Acer America&quot;,</span>
<a href="#l112.10"></a><span id="l112.10">       &quot;Work Phone&quot;       : &quot;(800) 000-0000&quot;,</span>
<a href="#l112.11"></a><span id="l112.11">       &quot;Organization&quot;     : &quot;Acer America&quot;</span>
<a href="#l112.12"></a><span id="l112.12" class="difflineminus">-    } </span>
<a href="#l112.13"></a><span id="l112.13" class="difflineplus">+    }</span>
<a href="#l112.14"></a><span id="l112.14">   ],</span>
<a href="#l112.15"></a><span id="l112.15">   &quot;vcard_import&quot; :</span>
<a href="#l112.16"></a><span id="l112.16">   [</span>
<a href="#l112.17"></a><span id="l112.17">     {</span>
<a href="#l112.18"></a><span id="l112.18">       &quot;DisplayName&quot;      : &quot;John Doe&quot;,</span>
<a href="#l112.19"></a><span id="l112.19">       &quot;FirstName&quot;        : &quot;John&quot;,</span>
<a href="#l112.20"></a><span id="l112.20">       &quot;LastName&quot;         : &quot;Doe&quot;,</span>
<a href="#l112.21"></a><span id="l112.21">       &quot;PrimaryEmail&quot;     : &quot;john.doe@genericemail.invalid&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l113.1"></a><span id="l113.1" class="difflineminus">--- a/mailnews/import/test/unit/resources/import_helper.js</span>
<a href="#l113.2"></a><span id="l113.2" class="difflineplus">+++ b/mailnews/import/test/unit/resources/import_helper.js</span>
<a href="#l113.3"></a><span id="l113.3" class="difflineat">@@ -31,17 +31,17 @@ function GenericImportHelper(aModuleType</span>
<a href="#l113.4"></a><span id="l113.4">   this.mFile = aFile; // checked in the beginImport method</span>
<a href="#l113.5"></a><span id="l113.5"> }</span>
<a href="#l113.6"></a><span id="l113.6"> </span>
<a href="#l113.7"></a><span id="l113.7"> GenericImportHelper.prototype =</span>
<a href="#l113.8"></a><span id="l113.8"> {</span>
<a href="#l113.9"></a><span id="l113.9">   interfaceType: Ci.nsIImportGeneric,</span>
<a href="#l113.10"></a><span id="l113.10">   /**</span>
<a href="#l113.11"></a><span id="l113.11">    * GenericImportHelper.beginImport</span>
<a href="#l113.12"></a><span id="l113.12" class="difflineminus">-   * Imports the given address book export or mail data and invoke </span>
<a href="#l113.13"></a><span id="l113.13" class="difflineplus">+   * Imports the given address book export or mail data and invoke</span>
<a href="#l113.14"></a><span id="l113.14">    * checkProgress of child class to check the data,</span>
<a href="#l113.15"></a><span id="l113.15">    */</span>
<a href="#l113.16"></a><span id="l113.16">   beginImport: function() {</span>
<a href="#l113.17"></a><span id="l113.17">     Assert.ok(this.mFile instanceof Ci.nsIFile &amp;&amp; this.mFile.exists());</span>
<a href="#l113.18"></a><span id="l113.18"> </span>
<a href="#l113.19"></a><span id="l113.19">     if (this.mModuleType == &quot;addressbook&quot;)</span>
<a href="#l113.20"></a><span id="l113.20">       this.mInterface.SetData(&quot;addressLocation&quot;, this.mFile);</span>
<a href="#l113.21"></a><span id="l113.21">     else if (this.mModuleType == &quot;mail&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l114.1"></a><span id="l114.1" class="difflineminus">--- a/mailnews/intl/test/unit/CharsetConversionTests.js</span>
<a href="#l114.2"></a><span id="l114.2" class="difflineplus">+++ b/mailnews/intl/test/unit/CharsetConversionTests.js</span>
<a href="#l114.3"></a><span id="l114.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l114.4"></a><span id="l114.4"> var CC = Components.Constructor;</span>
<a href="#l114.5"></a><span id="l114.5"> </span>
<a href="#l114.6"></a><span id="l114.6"> function CreateScriptableConverter()</span>
<a href="#l114.7"></a><span id="l114.7"> {</span>
<a href="#l114.8"></a><span id="l114.8" class="difflineminus">-  var ScriptableUnicodeConverter = </span>
<a href="#l114.9"></a><span id="l114.9" class="difflineplus">+  var ScriptableUnicodeConverter =</span>
<a href="#l114.10"></a><span id="l114.10">     CC(&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;,</span>
<a href="#l114.11"></a><span id="l114.11">        &quot;nsIScriptableUnicodeConverter&quot;);</span>
<a href="#l114.12"></a><span id="l114.12"> </span>
<a href="#l114.13"></a><span id="l114.13">   return new ScriptableUnicodeConverter();</span>
<a href="#l114.14"></a><span id="l114.14"> }</span>
<a href="#l114.15"></a><span id="l114.15"> </span>
<a href="#l114.16"></a><span id="l114.16"> function checkDecode(converter, charset, inText, expectedText)</span>
<a href="#l114.17"></a><span id="l114.17"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l115.1"></a><span id="l115.1" class="difflineminus">--- a/mailnews/local/test/unit/test_folderLoaded.js</span>
<a href="#l115.2"></a><span id="l115.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_folderLoaded.js</span>
<a href="#l115.3"></a><span id="l115.3" class="difflineat">@@ -23,17 +23,17 @@ var gTargetFolder = null;</span>
<a href="#l115.4"></a><span id="l115.4"> </span>
<a href="#l115.5"></a><span id="l115.5"> var tests = [</span>
<a href="#l115.6"></a><span id="l115.6">   function* setup()</span>
<a href="#l115.7"></a><span id="l115.7">   {</span>
<a href="#l115.8"></a><span id="l115.8">     do_timeout(5000, function() {</span>
<a href="#l115.9"></a><span id="l115.9">       // should be done by now</span>
<a href="#l115.10"></a><span id="l115.10">       Assert.ok(false);</span>
<a href="#l115.11"></a><span id="l115.11">     });</span>
<a href="#l115.12"></a><span id="l115.12" class="difflineminus">- </span>
<a href="#l115.13"></a><span id="l115.13" class="difflineplus">+</span>
<a href="#l115.14"></a><span id="l115.14">     if (typeof localAccountUtils.inboxFolder == 'undefined')</span>
<a href="#l115.15"></a><span id="l115.15">       localAccountUtils.loadLocalMailAccount();</span>
<a href="#l115.16"></a><span id="l115.16">     localAccountUtils.rootFolder.createSubfolder(&quot;target&quot;, null);</span>
<a href="#l115.17"></a><span id="l115.17">     gTargetFolder = localAccountUtils.rootFolder.getChildNamed(&quot;target&quot;);</span>
<a href="#l115.18"></a><span id="l115.18"> </span>
<a href="#l115.19"></a><span id="l115.19">     MailServices.copy.CopyFileMessage(gMsgFile1, gTargetFolder, null, false, 0,</span>
<a href="#l115.20"></a><span id="l115.20">                                       &quot;&quot;, asyncCopyListener, null);</span>
<a href="#l115.21"></a><span id="l115.21">     yield false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l116.1"></a><span id="l116.1" class="difflineminus">--- a/mailnews/local/test/unit/test_msgCopy.js</span>
<a href="#l116.2"></a><span id="l116.2" class="difflineplus">+++ b/mailnews/local/test/unit/test_msgCopy.js</span>
<a href="#l116.3"></a><span id="l116.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l116.4"></a><span id="l116.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l116.5"></a><span id="l116.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l116.6"></a><span id="l116.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l116.7"></a><span id="l116.7"> </span>
<a href="#l116.8"></a><span id="l116.8"> // Test of setting keywords with CopyFileMessage</span>
<a href="#l116.9"></a><span id="l116.9"> </span>
<a href="#l116.10"></a><span id="l116.10"> var bugmail11 = do_get_file(&quot;../../../data/bugmail11&quot;);</span>
<a href="#l116.11"></a><span id="l116.11" class="difflineminus">-                     </span>
<a href="#l116.12"></a><span id="l116.12" class="difflineplus">+</span>
<a href="#l116.13"></a><span id="l116.13"> // main test</span>
<a href="#l116.14"></a><span id="l116.14"> </span>
<a href="#l116.15"></a><span id="l116.15"> // tag used with test messages</span>
<a href="#l116.16"></a><span id="l116.16"> var tag1 = &quot;istag&quot;;</span>
<a href="#l116.17"></a><span id="l116.17"> </span>
<a href="#l116.18"></a><span id="l116.18"> function run_test()</span>
<a href="#l116.19"></a><span id="l116.19"> {</span>
<a href="#l116.20"></a><span id="l116.20">   do_test_pending();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l117.1"></a><span id="l117.1" class="difflineminus">--- a/mailnews/mailnews.js</span>
<a href="#l117.2"></a><span id="l117.2" class="difflineplus">+++ b/mailnews/mailnews.js</span>
<a href="#l117.3"></a><span id="l117.3" class="difflineat">@@ -406,17 +406,17 @@ pref(&quot;mail.identity.default.overrideGlob</span>
<a href="#l117.4"></a><span id="l117.4"> pref(&quot;mail.identity.default.auto_quote&quot;, true);</span>
<a href="#l117.5"></a><span id="l117.5"> pref(&quot;mail.identity.default.reply_on_top&quot;, 0); // 0=bottom 1=top 2=select</span>
<a href="#l117.6"></a><span id="l117.6"> pref(&quot;mail.identity.default.sig_bottom&quot;, true); // true=below quoted false=above quoted</span>
<a href="#l117.7"></a><span id="l117.7"> pref(&quot;mail.identity.default.sig_on_fwd&quot;, false); // Include signature on fwd?</span>
<a href="#l117.8"></a><span id="l117.8"> pref(&quot;mail.identity.default.sig_on_reply&quot;, true); // Include signature on re?</span>
<a href="#l117.9"></a><span id="l117.9"> </span>
<a href="#l117.10"></a><span id="l117.10"> // Suppress double-dash signature separator</span>
<a href="#l117.11"></a><span id="l117.11"> pref(&quot;mail.identity.default.suppress_signature_separator&quot;, false);</span>
<a href="#l117.12"></a><span id="l117.12" class="difflineminus">- </span>
<a href="#l117.13"></a><span id="l117.13" class="difflineplus">+</span>
<a href="#l117.14"></a><span id="l117.14"> // default to archives folder on same server.</span>
<a href="#l117.15"></a><span id="l117.15"> pref(&quot;mail.identity.default.archives_folder_picker_mode&quot;, &quot;0&quot;);</span>
<a href="#l117.16"></a><span id="l117.16"> </span>
<a href="#l117.17"></a><span id="l117.17"> // Headers to always add to outgoing mail</span>
<a href="#l117.18"></a><span id="l117.18"> // examples: &quot;header1,header2&quot;</span>
<a href="#l117.19"></a><span id="l117.19"> // pref(&quot;mail.identity.id1.headers&quot;, &quot;header1&quot;);</span>
<a href="#l117.20"></a><span id="l117.20"> // user_pref(&quot;mail.identity.id1.header.header1&quot;, &quot;X-Mozilla-Rocks: True&quot;)</span>
<a href="#l117.21"></a><span id="l117.21"> pref(&quot;mail.identity.default.headers&quot;, &quot;&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l118.1"></a><span id="l118.1" class="difflineminus">--- a/mailnews/mime/jsmime/test/test_header_emitter.js</span>
<a href="#l118.2"></a><span id="l118.2" class="difflineplus">+++ b/mailnews/mime/jsmime/test/test_header_emitter.js</span>
<a href="#l118.3"></a><span id="l118.3" class="difflineat">@@ -137,17 +137,17 @@ suite('headeremitter', function () {</span>
<a href="#l118.4"></a><span id="l118.4">         for (let line of this.output.split('\r\n'))</span>
<a href="#l118.5"></a><span id="l118.5">           assert.ok(line.length &lt;= 30, &quot;Line is too long&quot;);</span>
<a href="#l118.6"></a><span id="l118.6">       }</span>
<a href="#l118.7"></a><span id="l118.7">     }</span>
<a href="#l118.8"></a><span id="l118.8">     let header_tests = [</span>
<a href="#l118.9"></a><span id="l118.9">       [&quot;My house   burned down!&quot;, &quot;My house burned down!&quot;],</span>
<a href="#l118.10"></a><span id="l118.10"> </span>
<a href="#l118.11"></a><span id="l118.11">       // Which variables need to be encoded in QP encoding?</span>
<a href="#l118.12"></a><span id="l118.12" class="difflineminus">-      [&quot;! \&quot; # $ % &amp; ' ( ) * + - .&quot;, </span>
<a href="#l118.13"></a><span id="l118.13" class="difflineplus">+      [&quot;! \&quot; # $ % &amp; ' ( ) * + - .&quot;,</span>
<a href="#l118.14"></a><span id="l118.14">        &quot;! \&quot; # $ % &amp; ' ( ) * + - .&quot;],</span>
<a href="#l118.15"></a><span id="l118.15">       [&quot; / : ; &lt; = &gt; ? , @ [ \\ ] ^ _ ` { | } ~ \x7f&quot;,</span>
<a href="#l118.16"></a><span id="l118.16">         &quot;=?UTF-8?Q?_/_:_;_&lt;_=3d_&gt;_=3f?=\r\n&quot; +</span>
<a href="#l118.17"></a><span id="l118.17">         &quot; =?UTF-8?Q?_=2c_@_[_\\_]_^_?=\r\n&quot; +</span>
<a href="#l118.18"></a><span id="l118.18">         &quot; =?UTF-8?Q?=5f_`_{_|_}_~_=7f?=&quot;],</span>
<a href="#l118.19"></a><span id="l118.19">       // But non-printable characters don't need it in the first place!</span>
<a href="#l118.20"></a><span id="l118.20">       [&quot;! \&quot; # $ % &amp; ' ( ) * + , - . / : ; &lt; = &gt; ? @ [ \\ ] ^ _ ` { | } ~&quot;,</span>
<a href="#l118.21"></a><span id="l118.21">         &quot;! \&quot; # $ % &amp; ' ( ) * + , - . /\r\n&quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l119.1"></a><span id="l119.1" class="difflineminus">--- a/mailnews/mime/test/unit/test_alternate_p7m_handling.js</span>
<a href="#l119.2"></a><span id="l119.2" class="difflineplus">+++ b/mailnews/mime/test/unit/test_alternate_p7m_handling.js</span>
<a href="#l119.3"></a><span id="l119.3" class="difflineat">@@ -12,17 +12,17 @@ var gMessenger = Cc[&quot;@mozilla.org/messen</span>
<a href="#l119.4"></a><span id="l119.4"> </span>
<a href="#l119.5"></a><span id="l119.5"> // Create a message generator</span>
<a href="#l119.6"></a><span id="l119.6"> var msgGen = gMessageGenerator = new MessageGenerator();</span>
<a href="#l119.7"></a><span id="l119.7"> </span>
<a href="#l119.8"></a><span id="l119.8"> var p7mAttachment = &quot;dGhpcyBpcyBub3QgYSByZWFsIHMvbWltZSBwN20gZW50aXR5&quot;;</span>
<a href="#l119.9"></a><span id="l119.9"> </span>
<a href="#l119.10"></a><span id="l119.10"> // create a message with a p7m attachment</span>
<a href="#l119.11"></a><span id="l119.11"> var messages = [{</span>
<a href="#l119.12"></a><span id="l119.12" class="difflineminus">-  attachments: [{ </span>
<a href="#l119.13"></a><span id="l119.13" class="difflineplus">+  attachments: [{</span>
<a href="#l119.14"></a><span id="l119.14">     body: p7mAttachment,</span>
<a href="#l119.15"></a><span id="l119.15">     filename: 'test.txt.p7m',</span>
<a href="#l119.16"></a><span id="l119.16">     contentType: 'application/pkcs7-mime',</span>
<a href="#l119.17"></a><span id="l119.17">     format:'',</span>
<a href="#l119.18"></a><span id="l119.18">     encoding: &quot;base64&quot;</span>
<a href="#l119.19"></a><span id="l119.19">   }]</span>
<a href="#l119.20"></a><span id="l119.20"> }];</span>
<a href="#l119.21"></a><span id="l119.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l120.1"></a><span id="l120.1" class="difflineminus">--- a/mailnews/mime/test/unit/test_mimeStreaming.js</span>
<a href="#l120.2"></a><span id="l120.2" class="difflineplus">+++ b/mailnews/mime/test/unit/test_mimeStreaming.js</span>
<a href="#l120.3"></a><span id="l120.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l120.4"></a><span id="l120.4"> </span>
<a href="#l120.5"></a><span id="l120.5"> /**</span>
<a href="#l120.6"></a><span id="l120.6">  * This test iterates over the test files in gTestFiles, and streams</span>
<a href="#l120.7"></a><span id="l120.7">  * each as a message and makes sure the streaming doesn't assert or crash.</span>
<a href="#l120.8"></a><span id="l120.8">  */</span>
<a href="#l120.9"></a><span id="l120.9"> ChromeUtils.import(&quot;resource://testing-common/mailnews/localAccountUtils.js&quot;);</span>
<a href="#l120.10"></a><span id="l120.10"> ChromeUtils.import(&quot;resource:///modules/IOUtils.js&quot;);</span>
<a href="#l120.11"></a><span id="l120.11"> </span>
<a href="#l120.12"></a><span id="l120.12" class="difflineminus">-var gTestFiles =[ </span>
<a href="#l120.13"></a><span id="l120.13" class="difflineplus">+var gTestFiles =[</span>
<a href="#l120.14"></a><span id="l120.14">   &quot;../../../data/bug505221&quot;,</span>
<a href="#l120.15"></a><span id="l120.15">   &quot;../../../data/bug513543&quot;,</span>
<a href="#l120.16"></a><span id="l120.16"> ];</span>
<a href="#l120.17"></a><span id="l120.17"> </span>
<a href="#l120.18"></a><span id="l120.18"> var gMsgEnumerator;</span>
<a href="#l120.19"></a><span id="l120.19"> </span>
<a href="#l120.20"></a><span id="l120.20"> var gMessenger = Cc[&quot;@mozilla.org/messenger;1&quot;].</span>
<a href="#l120.21"></a><span id="l120.21">                    createInstance(Ci.nsIMessenger);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l121.1"></a><span id="l121.1" class="difflineminus">--- a/mailnews/news/test/unit/test_getNewsMessage.js</span>
<a href="#l121.2"></a><span id="l121.2" class="difflineplus">+++ b/mailnews/news/test/unit/test_getNewsMessage.js</span>
<a href="#l121.3"></a><span id="l121.3" class="difflineat">@@ -70,17 +70,17 @@ function run_test() {</span>
<a href="#l121.4"></a><span id="l121.4">     var folder = localserver.rootFolder.getChildNamed(&quot;test.subscribe.simple&quot;);</span>
<a href="#l121.5"></a><span id="l121.5">     folder.clearFlag(Ci.nsMsgFolderFlags.Offline);</span>
<a href="#l121.6"></a><span id="l121.6">     folder.getNewMessages(null, {</span>
<a href="#l121.7"></a><span id="l121.7">       OnStopRunningUrl: function () { localserver.closeCachedConnections(); }});</span>
<a href="#l121.8"></a><span id="l121.8">     server.performTest();</span>
<a href="#l121.9"></a><span id="l121.9"> </span>
<a href="#l121.10"></a><span id="l121.10">     Assert.equal(folder.getTotalMessages(false), 1);</span>
<a href="#l121.11"></a><span id="l121.11">     Assert.ok(folder.hasNewMessages);</span>
<a href="#l121.12"></a><span id="l121.12" class="difflineminus">- </span>
<a href="#l121.13"></a><span id="l121.13" class="difflineplus">+</span>
<a href="#l121.14"></a><span id="l121.14">     server.resetTest();</span>
<a href="#l121.15"></a><span id="l121.15"> </span>
<a href="#l121.16"></a><span id="l121.16">     var message = folder.firstNewMessage;</span>
<a href="#l121.17"></a><span id="l121.17"> </span>
<a href="#l121.18"></a><span id="l121.18">     var messageUri = folder.getUriForMsg(message);</span>
<a href="#l121.19"></a><span id="l121.19"> </span>
<a href="#l121.20"></a><span id="l121.20">     var nntpService = Cc[&quot;@mozilla.org/messenger/nntpservice;1&quot;]</span>
<a href="#l121.21"></a><span id="l121.21">       .getService(Ci.nsIMsgMessageService);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l122.1"></a><span id="l122.1" class="difflineminus">--- a/mailnews/news/test/unit/test_nntpPassword2.js</span>
<a href="#l122.2"></a><span id="l122.2" class="difflineplus">+++ b/mailnews/news/test/unit/test_nntpPassword2.js</span>
<a href="#l122.3"></a><span id="l122.3" class="difflineat">@@ -54,17 +54,17 @@ add_task(function *() {</span>
<a href="#l122.4"></a><span id="l122.4">   Services.prefs.setCharPref(&quot;mail.server.server2.realhostname&quot;,</span>
<a href="#l122.5"></a><span id="l122.5">                              &quot;localhost&quot;);</span>
<a href="#l122.6"></a><span id="l122.6">   Services.prefs.setCharPref(&quot;mail.server.server2.type&quot;, &quot;nntp&quot;);</span>
<a href="#l122.7"></a><span id="l122.7"> </span>
<a href="#l122.8"></a><span id="l122.8">   // Prepare files for passwords (generated by a script in bug 1018624).</span>
<a href="#l122.9"></a><span id="l122.9">   yield setupForPassword(&quot;signons-mailnews1.8-alt.json&quot;);</span>
<a href="#l122.10"></a><span id="l122.10"> </span>
<a href="#l122.11"></a><span id="l122.11">   try {</span>
<a href="#l122.12"></a><span id="l122.12" class="difflineminus">-    // Note, the uri is for hostname &quot;invalid&quot; which is the original uri. See </span>
<a href="#l122.13"></a><span id="l122.13" class="difflineplus">+    // Note, the uri is for hostname &quot;invalid&quot; which is the original uri. See</span>
<a href="#l122.14"></a><span id="l122.14">     // setupProtocolTest parameters.</span>
<a href="#l122.15"></a><span id="l122.15">     var prefix = &quot;news://invalid:&quot; + server.port + &quot;/&quot;;</span>
<a href="#l122.16"></a><span id="l122.16"> </span>
<a href="#l122.17"></a><span id="l122.17">     // Test - group subscribe listing</span>
<a href="#l122.18"></a><span id="l122.18">     test = &quot;news:*&quot;;</span>
<a href="#l122.19"></a><span id="l122.19"> </span>
<a href="#l122.20"></a><span id="l122.20">     // Get the existing incoming server</span>
<a href="#l122.21"></a><span id="l122.21">     MailServices.accounts.LoadAccounts();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l123.1"></a><span id="l123.1" class="difflineminus">--- a/mailnews/news/test/unit/test_nntpUrl.js</span>
<a href="#l123.2"></a><span id="l123.2" class="difflineplus">+++ b/mailnews/news/test/unit/test_nntpUrl.js</span>
<a href="#l123.3"></a><span id="l123.3" class="difflineat">@@ -18,13 +18,13 @@ function getMessageHeaderFromUrl(aUrl) {</span>
<a href="#l123.4"></a><span id="l123.4"> </span>
<a href="#l123.5"></a><span id="l123.5"> function run_test() {</span>
<a href="#l123.6"></a><span id="l123.6"> </span>
<a href="#l123.7"></a><span id="l123.7">   // This is crash test for Bug 392729</span>
<a href="#l123.8"></a><span id="l123.8">   try {</span>
<a href="#l123.9"></a><span id="l123.9">     // msgkey is invalid for news:// protocol</span>
<a href="#l123.10"></a><span id="l123.10">     let hdr = getMessageHeaderFromUrl(&quot;news://localhost:119&quot; +</span>
<a href="#l123.11"></a><span id="l123.11">                                       &quot;/123@example.invalid?group=test.subscribe.simple&amp;key=abcdefghijk&quot;);</span>
<a href="#l123.12"></a><span id="l123.12" class="difflineminus">-    Assert.ok(false); </span>
<a href="#l123.13"></a><span id="l123.13" class="difflineplus">+    Assert.ok(false);</span>
<a href="#l123.14"></a><span id="l123.14">   } catch (e) {</span>
<a href="#l123.15"></a><span id="l123.15">     Assert.equal(e.result, Components.results.NS_ERROR_MALFORMED_URI);</span>
<a href="#l123.16"></a><span id="l123.16">   }</span>
<a href="#l123.17"></a><span id="l123.17"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l124.1"></a><span id="l124.1" class="difflineminus">--- a/mailnews/test/fakeserver/maild.js</span>
<a href="#l124.2"></a><span id="l124.2" class="difflineplus">+++ b/mailnews/test/fakeserver/maild.js</span>
<a href="#l124.3"></a><span id="l124.3" class="difflineat">@@ -49,17 +49,17 @@ var TIMEOUT = 3*60*1000;</span>
<a href="#l124.4"></a><span id="l124.4">  * the state for the logical server). To make a new server, one needs to pass</span>
<a href="#l124.5"></a><span id="l124.5">  * in a function to create handlers--not the handlers themselves--and the</span>
<a href="#l124.6"></a><span id="l124.6">  * backend daemon. Since each handler presumably needs access to the logical</span>
<a href="#l124.7"></a><span id="l124.7">  * server daemon, that is passed into the handler creation function. A new</span>
<a href="#l124.8"></a><span id="l124.8">  * handler will be constructed for every connection made.</span>
<a href="#l124.9"></a><span id="l124.9">  *</span>
<a href="#l124.10"></a><span id="l124.10">  * As the core code is inherently single-threaded, it is guaranteed that all of</span>
<a href="#l124.11"></a><span id="l124.11">  * the calls to the daemon will be made on the same thread, so you do not have</span>
<a href="#l124.12"></a><span id="l124.12" class="difflineminus">- * to worry about reentrancy in daemon calls.  </span>
<a href="#l124.13"></a><span id="l124.13" class="difflineplus">+ * to worry about reentrancy in daemon calls.</span>
<a href="#l124.14"></a><span id="l124.14">  *</span>
<a href="#l124.15"></a><span id="l124.15">  ******************************************************************************</span>
<a href="#l124.16"></a><span id="l124.16">  * Typical usage:</span>
<a href="#l124.17"></a><span id="l124.17">  * function createHandler(daemon) {</span>
<a href="#l124.18"></a><span id="l124.18">  *   return new handler(daemon);</span>
<a href="#l124.19"></a><span id="l124.19">  * }</span>
<a href="#l124.20"></a><span id="l124.20">  * do_test_pending();</span>
<a href="#l124.21"></a><span id="l124.21">  * var server = new nsMailServer(createHandler, serverDaemon);</span>
<a href="#l124.22"></a><span id="l124.22" class="difflineat">@@ -333,17 +333,17 @@ function nsMailReader(server, handler, t</span>
<a href="#l124.23"></a><span id="l124.23">   if (this.transaction)</span>
<a href="#l124.24"></a><span id="l124.24">     this.transaction.us.push(response);</span>
<a href="#l124.25"></a><span id="l124.25">   this._output.write(response, response.length);</span>
<a href="#l124.26"></a><span id="l124.26">   this._output.flush();</span>
<a href="#l124.27"></a><span id="l124.27"> </span>
<a href="#l124.28"></a><span id="l124.28">   this._multiline = false;</span>
<a href="#l124.29"></a><span id="l124.29"> </span>
<a href="#l124.30"></a><span id="l124.30">   this._isRunning = true;</span>
<a href="#l124.31"></a><span id="l124.31" class="difflineminus">-  </span>
<a href="#l124.32"></a><span id="l124.32" class="difflineplus">+</span>
<a href="#l124.33"></a><span id="l124.33">   this.observer = {</span>
<a href="#l124.34"></a><span id="l124.34">     server : server,</span>
<a href="#l124.35"></a><span id="l124.35">     forced : false,</span>
<a href="#l124.36"></a><span id="l124.36">     notify : function (timer) {</span>
<a href="#l124.37"></a><span id="l124.37">       this.forced = true;</span>
<a href="#l124.38"></a><span id="l124.38">       this.server.stopTest();</span>
<a href="#l124.39"></a><span id="l124.39">       this.server.stop();</span>
<a href="#l124.40"></a><span id="l124.40">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l125.1"></a><span id="l125.1" class="difflineminus">--- a/mailnews/test/fakeserver/nntpd.js</span>
<a href="#l125.2"></a><span id="l125.2" class="difflineplus">+++ b/mailnews/test/fakeserver/nntpd.js</span>
<a href="#l125.3"></a><span id="l125.3" class="difflineat">@@ -547,17 +547,17 @@ subclass(NNTP_RFC4643_extension, NNTP_RF</span>
<a href="#l125.4"></a><span id="l125.4">         return &quot;381 Password required&quot;;</span>
<a href="#l125.5"></a><span id="l125.5"> </span>
<a href="#l125.6"></a><span id="l125.6">       this.authenticated = this.lastGroupTried ? this.lastGroupTried : true;</span>
<a href="#l125.7"></a><span id="l125.7">       return &quot;281 Authentication Accepted&quot;;</span>
<a href="#l125.8"></a><span id="l125.8">     }</span>
<a href="#l125.9"></a><span id="l125.9">     else if (action == &quot;pass&quot;) {</span>
<a href="#l125.10"></a><span id="l125.10">       if (!this.requireBoth || !this.usernameReceived)</span>
<a href="#l125.11"></a><span id="l125.11">         return &quot;482 Authetication commands issued out of sequence&quot;;</span>
<a href="#l125.12"></a><span id="l125.12" class="difflineminus">-      </span>
<a href="#l125.13"></a><span id="l125.13" class="difflineplus">+</span>
<a href="#l125.14"></a><span id="l125.14">       this.usernameReceived = false;</span>
<a href="#l125.15"></a><span id="l125.15"> </span>
<a href="#l125.16"></a><span id="l125.16">       var expectPassword = this.lastGroupTried</span>
<a href="#l125.17"></a><span id="l125.17">         ? this._daemon.groupCredentials[this.lastGroupTried][1]</span>
<a href="#l125.18"></a><span id="l125.18">         : this.expectedPassword;</span>
<a href="#l125.19"></a><span id="l125.19">       if (param != expectPassword)</span>
<a href="#l125.20"></a><span id="l125.20">         return &quot;481 Authentication failed&quot;;</span>
<a href="#l125.21"></a><span id="l125.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l126.1"></a><span id="l126.1" class="difflineminus">--- a/mailnews/test/fakeserver/pop3d.js</span>
<a href="#l126.2"></a><span id="l126.2" class="difflineplus">+++ b/mailnews/test/fakeserver/pop3d.js</span>
<a href="#l126.3"></a><span id="l126.3" class="difflineat">@@ -68,17 +68,17 @@ function pop3Daemon(flags) {</span>
<a href="#l126.4"></a><span id="l126.4">   this._messages = [];</span>
<a href="#l126.5"></a><span id="l126.5"> }</span>
<a href="#l126.6"></a><span id="l126.6"> pop3Daemon.prototype = {</span>
<a href="#l126.7"></a><span id="l126.7">   _messages: null,</span>
<a href="#l126.8"></a><span id="l126.8">   _totalMessageSize: 0,</span>
<a href="#l126.9"></a><span id="l126.9"> </span>
<a href="#l126.10"></a><span id="l126.10">   /**</span>
<a href="#l126.11"></a><span id="l126.11">    * Set the messages that the POP3 daemon will provide to its clients.</span>
<a href="#l126.12"></a><span id="l126.12" class="difflineminus">-   * </span>
<a href="#l126.13"></a><span id="l126.13" class="difflineplus">+   *</span>
<a href="#l126.14"></a><span id="l126.14">    * @param messages An array of either 1) strings that are filenames whose</span>
<a href="#l126.15"></a><span id="l126.15">    *     contents will be loaded from the files or 2) objects with a &quot;fileData&quot;</span>
<a href="#l126.16"></a><span id="l126.16">    *     attribute whose value is the content of the file.</span>
<a href="#l126.17"></a><span id="l126.17">    */</span>
<a href="#l126.18"></a><span id="l126.18">   setMessages: function(messages) {</span>
<a href="#l126.19"></a><span id="l126.19">     this._messages = [];</span>
<a href="#l126.20"></a><span id="l126.20">     this._totalMessageSize = 0;</span>
<a href="#l126.21"></a><span id="l126.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l127.1"></a><span id="l127.1" class="difflineminus">--- a/mailnews/test/resources/alertTestUtils.js</span>
<a href="#l127.2"></a><span id="l127.2" class="difflineplus">+++ b/mailnews/test/resources/alertTestUtils.js</span>
<a href="#l127.3"></a><span id="l127.3" class="difflineat">@@ -41,65 +41,65 @@ var alertUtilsPrompts = {</span>
<a href="#l127.4"></a><span id="l127.4">     if (typeof alert == &quot;function&quot;) {</span>
<a href="#l127.5"></a><span id="l127.5">       alert(aDialogTitle, aText);</span>
<a href="#l127.6"></a><span id="l127.6">       return;</span>
<a href="#l127.7"></a><span id="l127.7">     }</span>
<a href="#l127.8"></a><span id="l127.8"> </span>
<a href="#l127.9"></a><span id="l127.9">     do_throw(&quot;alert unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.10"></a><span id="l127.10">     return;</span>
<a href="#l127.11"></a><span id="l127.11">   },</span>
<a href="#l127.12"></a><span id="l127.12" class="difflineminus">-  </span>
<a href="#l127.13"></a><span id="l127.13" class="difflineplus">+</span>
<a href="#l127.14"></a><span id="l127.14">   alertCheck: function(aDialogTitle, aText, aCheckMsg, aCheckState) {</span>
<a href="#l127.15"></a><span id="l127.15">     if (typeof alertCheck == &quot;function&quot;) {</span>
<a href="#l127.16"></a><span id="l127.16">       alertCheck(aDialogTitle, aText, aCheckMsg, aCheckState);</span>
<a href="#l127.17"></a><span id="l127.17">       return;</span>
<a href="#l127.18"></a><span id="l127.18">     }</span>
<a href="#l127.19"></a><span id="l127.19"> </span>
<a href="#l127.20"></a><span id="l127.20">     do_throw(&quot;alertCheck unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.21"></a><span id="l127.21">     return;</span>
<a href="#l127.22"></a><span id="l127.22">   },</span>
<a href="#l127.23"></a><span id="l127.23" class="difflineminus">-  </span>
<a href="#l127.24"></a><span id="l127.24" class="difflineplus">+</span>
<a href="#l127.25"></a><span id="l127.25">   confirm: function(aDialogTitle, aText) {</span>
<a href="#l127.26"></a><span id="l127.26">     if (typeof confirm == &quot;function&quot;) {</span>
<a href="#l127.27"></a><span id="l127.27">       return confirm(aDialogTitle, aText);</span>
<a href="#l127.28"></a><span id="l127.28">     }</span>
<a href="#l127.29"></a><span id="l127.29"> </span>
<a href="#l127.30"></a><span id="l127.30">     do_throw(&quot;confirm unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.31"></a><span id="l127.31">     return false;</span>
<a href="#l127.32"></a><span id="l127.32">   },</span>
<a href="#l127.33"></a><span id="l127.33" class="difflineminus">-  </span>
<a href="#l127.34"></a><span id="l127.34" class="difflineplus">+</span>
<a href="#l127.35"></a><span id="l127.35">   confirmCheck: function(aDialogTitle, aText, aCheckMsg, aCheckState) {</span>
<a href="#l127.36"></a><span id="l127.36">     if (typeof confirmCheck == &quot;function&quot;) {</span>
<a href="#l127.37"></a><span id="l127.37">       return confirmCheck(aDialogTitle, aText, aCheckMsg, aCheckState);</span>
<a href="#l127.38"></a><span id="l127.38">     }</span>
<a href="#l127.39"></a><span id="l127.39"> </span>
<a href="#l127.40"></a><span id="l127.40">     do_throw(&quot;confirmCheck unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.41"></a><span id="l127.41">     return false;</span>
<a href="#l127.42"></a><span id="l127.42">   },</span>
<a href="#l127.43"></a><span id="l127.43" class="difflineminus">-  </span>
<a href="#l127.44"></a><span id="l127.44" class="difflineplus">+</span>
<a href="#l127.45"></a><span id="l127.45">   confirmEx: function(aDialogTitle, aText, aButtonFlags, aButton0Title,</span>
<a href="#l127.46"></a><span id="l127.46">                       aButton1Title, aButton2Title, aCheckMsg, aCheckState) {</span>
<a href="#l127.47"></a><span id="l127.47">     if (typeof confirmEx == &quot;function&quot;) {</span>
<a href="#l127.48"></a><span id="l127.48">       return confirmEx(aDialogTitle, aText, aButtonFlags, aButton0Title,</span>
<a href="#l127.49"></a><span id="l127.49">                        aButton1Title, aButton2Title, aCheckMsg, aCheckState);</span>
<a href="#l127.50"></a><span id="l127.50">     }</span>
<a href="#l127.51"></a><span id="l127.51"> </span>
<a href="#l127.52"></a><span id="l127.52">     do_throw(&quot;confirmEx unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.53"></a><span id="l127.53">     return 0;</span>
<a href="#l127.54"></a><span id="l127.54">   },</span>
<a href="#l127.55"></a><span id="l127.55" class="difflineminus">-  </span>
<a href="#l127.56"></a><span id="l127.56" class="difflineplus">+</span>
<a href="#l127.57"></a><span id="l127.57">   prompt: function(aDialogTitle, aText, aValue, aCheckMsg, aCheckState) {</span>
<a href="#l127.58"></a><span id="l127.58">     if (typeof prompt == &quot;function&quot;) {</span>
<a href="#l127.59"></a><span id="l127.59">       return prompt(aDialogTitle, aText, aValue, aCheckMsg, aCheckState);</span>
<a href="#l127.60"></a><span id="l127.60">     }</span>
<a href="#l127.61"></a><span id="l127.61"> </span>
<a href="#l127.62"></a><span id="l127.62">     do_throw(&quot;prompt unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.63"></a><span id="l127.63">     return false;</span>
<a href="#l127.64"></a><span id="l127.64">   },</span>
<a href="#l127.65"></a><span id="l127.65" class="difflineminus">-  </span>
<a href="#l127.66"></a><span id="l127.66" class="difflineplus">+</span>
<a href="#l127.67"></a><span id="l127.67">   promptUsernameAndPassword: function(aDialogTitle, aText, aUsername,</span>
<a href="#l127.68"></a><span id="l127.68">                                       aPassword, aCheckMsg, aCheckState) {</span>
<a href="#l127.69"></a><span id="l127.69">     if (typeof promptUsernameAndPassword == &quot;function&quot;) {</span>
<a href="#l127.70"></a><span id="l127.70">       return promptUsernameAndPassword(aDialogTitle, aText, aUsername,</span>
<a href="#l127.71"></a><span id="l127.71">                                        aPassword, aCheckMsg, aCheckState);</span>
<a href="#l127.72"></a><span id="l127.72">     }</span>
<a href="#l127.73"></a><span id="l127.73"> </span>
<a href="#l127.74"></a><span id="l127.74">     do_throw(&quot;promptUsernameAndPassword unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.75"></a><span id="l127.75" class="difflineat">@@ -111,94 +111,94 @@ var alertUtilsPrompts = {</span>
<a href="#l127.76"></a><span id="l127.76">     if (typeof promptPassword == &quot;function&quot;) {</span>
<a href="#l127.77"></a><span id="l127.77">       return promptPassword(aDialogTitle, aText, aPassword, aCheckMsg,</span>
<a href="#l127.78"></a><span id="l127.78">                             aCheckState);</span>
<a href="#l127.79"></a><span id="l127.79">     }</span>
<a href="#l127.80"></a><span id="l127.80"> </span>
<a href="#l127.81"></a><span id="l127.81">     do_throw(&quot;promptPassword unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.82"></a><span id="l127.82">     return false;</span>
<a href="#l127.83"></a><span id="l127.83">   },</span>
<a href="#l127.84"></a><span id="l127.84" class="difflineminus">-  </span>
<a href="#l127.85"></a><span id="l127.85" class="difflineplus">+</span>
<a href="#l127.86"></a><span id="l127.86">   select: function(aDialogTitle, aText, aCount, aSelectList,</span>
<a href="#l127.87"></a><span id="l127.87">                    aOutSelection) {</span>
<a href="#l127.88"></a><span id="l127.88">     if (typeof select == &quot;function&quot;) {</span>
<a href="#l127.89"></a><span id="l127.89">       return select(aDialogTitle, aText, aCount, aSelectList,</span>
<a href="#l127.90"></a><span id="l127.90">                     aOutSelection);</span>
<a href="#l127.91"></a><span id="l127.91">     }</span>
<a href="#l127.92"></a><span id="l127.92"> </span>
<a href="#l127.93"></a><span id="l127.93">     do_throw(&quot;select unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.94"></a><span id="l127.94">     return false;</span>
<a href="#l127.95"></a><span id="l127.95">   },</span>
<a href="#l127.96"></a><span id="l127.96" class="difflineminus">-  </span>
<a href="#l127.97"></a><span id="l127.97" class="difflineplus">+</span>
<a href="#l127.98"></a><span id="l127.98">   QueryInterface: XPCOMUtils.generateQI([Ci.nsIPrompt])</span>
<a href="#l127.99"></a><span id="l127.99"> };</span>
<a href="#l127.100"></a><span id="l127.100"> </span>
<a href="#l127.101"></a><span id="l127.101"> var alertUtilsPromptService = {</span>
<a href="#l127.102"></a><span id="l127.102">    alert: function(aParent, aDialogTitle, aText) {</span>
<a href="#l127.103"></a><span id="l127.103">     if (typeof alertPS == &quot;function&quot;) {</span>
<a href="#l127.104"></a><span id="l127.104">       alertPS(aParent, aDialogTitle, aText);</span>
<a href="#l127.105"></a><span id="l127.105">       return;</span>
<a href="#l127.106"></a><span id="l127.106">     }</span>
<a href="#l127.107"></a><span id="l127.107"> </span>
<a href="#l127.108"></a><span id="l127.108">     do_throw(&quot;alertPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.109"></a><span id="l127.109">     return;</span>
<a href="#l127.110"></a><span id="l127.110">   },</span>
<a href="#l127.111"></a><span id="l127.111" class="difflineminus">-  </span>
<a href="#l127.112"></a><span id="l127.112" class="difflineplus">+</span>
<a href="#l127.113"></a><span id="l127.113">   alertCheck: function(aParent, aDialogTitle, aText, aCheckMsg, aCheckState) {</span>
<a href="#l127.114"></a><span id="l127.114">     if (typeof alertCheckPS == &quot;function&quot;) {</span>
<a href="#l127.115"></a><span id="l127.115">       alertCheckPS(aParent, aDialogTitle, aText, aCheckMsg, aCheckState);</span>
<a href="#l127.116"></a><span id="l127.116">       return;</span>
<a href="#l127.117"></a><span id="l127.117">     }</span>
<a href="#l127.118"></a><span id="l127.118"> </span>
<a href="#l127.119"></a><span id="l127.119">     do_throw(&quot;alertCheckPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.120"></a><span id="l127.120">     return;</span>
<a href="#l127.121"></a><span id="l127.121">   },</span>
<a href="#l127.122"></a><span id="l127.122" class="difflineminus">-  </span>
<a href="#l127.123"></a><span id="l127.123" class="difflineplus">+</span>
<a href="#l127.124"></a><span id="l127.124">   confirm: function(aParent, aDialogTitle, aText) {</span>
<a href="#l127.125"></a><span id="l127.125">     if (typeof confirmPS == &quot;function&quot;) {</span>
<a href="#l127.126"></a><span id="l127.126">       return confirmPS(aParent, aDialogTitle, aText);</span>
<a href="#l127.127"></a><span id="l127.127">     }</span>
<a href="#l127.128"></a><span id="l127.128"> </span>
<a href="#l127.129"></a><span id="l127.129">     do_throw(&quot;confirmPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.130"></a><span id="l127.130">     return false;</span>
<a href="#l127.131"></a><span id="l127.131">   },</span>
<a href="#l127.132"></a><span id="l127.132" class="difflineminus">-  </span>
<a href="#l127.133"></a><span id="l127.133" class="difflineplus">+</span>
<a href="#l127.134"></a><span id="l127.134">   confirmCheck: function(aParent, aDialogTitle, aText, aCheckMsg, aCheckState) {</span>
<a href="#l127.135"></a><span id="l127.135">     if (typeof confirmCheckPS == &quot;function&quot;) {</span>
<a href="#l127.136"></a><span id="l127.136">       return confirmCheckPS(aParent, aDialogTitle, aText, aCheckMsg,</span>
<a href="#l127.137"></a><span id="l127.137">                             aCheckState);</span>
<a href="#l127.138"></a><span id="l127.138">     }</span>
<a href="#l127.139"></a><span id="l127.139"> </span>
<a href="#l127.140"></a><span id="l127.140">     do_throw(&quot;confirmCheckPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.141"></a><span id="l127.141">     return false;</span>
<a href="#l127.142"></a><span id="l127.142">   },</span>
<a href="#l127.143"></a><span id="l127.143" class="difflineminus">-  </span>
<a href="#l127.144"></a><span id="l127.144" class="difflineplus">+</span>
<a href="#l127.145"></a><span id="l127.145">   confirmEx: function(aParent, aDialogTitle, aText, aButtonFlags, aButton0Title,</span>
<a href="#l127.146"></a><span id="l127.146">                       aButton1Title, aButton2Title, aCheckMsg, aCheckState) {</span>
<a href="#l127.147"></a><span id="l127.147">     if (typeof confirmExPS == &quot;function&quot;) {</span>
<a href="#l127.148"></a><span id="l127.148">       return confirmExPS(aParent, aDialogTitle, aText, aButtonFlags,</span>
<a href="#l127.149"></a><span id="l127.149">                          aButton0Title, aButton1Title, aButton2Title, aCheckMsg,</span>
<a href="#l127.150"></a><span id="l127.150">                          aCheckState);</span>
<a href="#l127.151"></a><span id="l127.151">     }</span>
<a href="#l127.152"></a><span id="l127.152"> </span>
<a href="#l127.153"></a><span id="l127.153">     do_throw(&quot;confirmExPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.154"></a><span id="l127.154">     return 0;</span>
<a href="#l127.155"></a><span id="l127.155">   },</span>
<a href="#l127.156"></a><span id="l127.156" class="difflineminus">-  </span>
<a href="#l127.157"></a><span id="l127.157" class="difflineplus">+</span>
<a href="#l127.158"></a><span id="l127.158">   prompt: function(aParent, aDialogTitle, aText, aValue, aCheckMsg,</span>
<a href="#l127.159"></a><span id="l127.159">                    aCheckState) {</span>
<a href="#l127.160"></a><span id="l127.160">     if (typeof promptPS == &quot;function&quot;) {</span>
<a href="#l127.161"></a><span id="l127.161">       return promptPS(aParent, aDialogTitle, aText, aValue, aCheckMsg,</span>
<a href="#l127.162"></a><span id="l127.162">                       aCheckState);</span>
<a href="#l127.163"></a><span id="l127.163">     }</span>
<a href="#l127.164"></a><span id="l127.164"> </span>
<a href="#l127.165"></a><span id="l127.165">     do_throw(&quot;promptPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.166"></a><span id="l127.166">     return false;</span>
<a href="#l127.167"></a><span id="l127.167">   },</span>
<a href="#l127.168"></a><span id="l127.168" class="difflineminus">-  </span>
<a href="#l127.169"></a><span id="l127.169" class="difflineplus">+</span>
<a href="#l127.170"></a><span id="l127.170">   promptUsernameAndPassword: function(aParent, aDialogTitle, aText, aUsername,</span>
<a href="#l127.171"></a><span id="l127.171">                                       aPassword, aCheckMsg, aCheckState) {</span>
<a href="#l127.172"></a><span id="l127.172">     if (typeof promptUsernameAndPasswordPS == &quot;function&quot;) {</span>
<a href="#l127.173"></a><span id="l127.173">       return promptUsernameAndPasswordPS(aParent, aDialogTitle, aText,</span>
<a href="#l127.174"></a><span id="l127.174">                                          aUsername, aPassword, aCheckMsg,</span>
<a href="#l127.175"></a><span id="l127.175">                                          aCheckState);</span>
<a href="#l127.176"></a><span id="l127.176">     }</span>
<a href="#l127.177"></a><span id="l127.177"> </span>
<a href="#l127.178"></a><span id="l127.178" class="difflineat">@@ -211,28 +211,28 @@ var alertUtilsPromptService = {</span>
<a href="#l127.179"></a><span id="l127.179">     if (typeof promptPasswordPS == &quot;function&quot;) {</span>
<a href="#l127.180"></a><span id="l127.180">       return promptPasswordPS(aParent, aDialogTitle, aText, aPassword,</span>
<a href="#l127.181"></a><span id="l127.181">                               aCheckMsg, aCheckState);</span>
<a href="#l127.182"></a><span id="l127.182">     }</span>
<a href="#l127.183"></a><span id="l127.183"> </span>
<a href="#l127.184"></a><span id="l127.184">     do_throw(&quot;promptPasswordPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.185"></a><span id="l127.185">     return false;</span>
<a href="#l127.186"></a><span id="l127.186">   },</span>
<a href="#l127.187"></a><span id="l127.187" class="difflineminus">-  </span>
<a href="#l127.188"></a><span id="l127.188" class="difflineplus">+</span>
<a href="#l127.189"></a><span id="l127.189">   select: function(aParent, aDialogTitle, aText, aCount, aSelectList,</span>
<a href="#l127.190"></a><span id="l127.190">                    aOutSelection) {</span>
<a href="#l127.191"></a><span id="l127.191">     if (typeof selectPS == &quot;function&quot;) {</span>
<a href="#l127.192"></a><span id="l127.192">       return selectPS(aParent, aDialogTitle, aText, aCount, aSelectList,</span>
<a href="#l127.193"></a><span id="l127.193">                       aOutSelection);</span>
<a href="#l127.194"></a><span id="l127.194">     }</span>
<a href="#l127.195"></a><span id="l127.195"> </span>
<a href="#l127.196"></a><span id="l127.196">     do_throw(&quot;selectPS unexpectedly called: &quot; + aText + &quot;\n&quot;);</span>
<a href="#l127.197"></a><span id="l127.197">     return false;</span>
<a href="#l127.198"></a><span id="l127.198">   },</span>
<a href="#l127.199"></a><span id="l127.199" class="difflineminus">-  </span>
<a href="#l127.200"></a><span id="l127.200" class="difflineplus">+</span>
<a href="#l127.201"></a><span id="l127.201">   createInstance: function createInstance(outer, iid) {</span>
<a href="#l127.202"></a><span id="l127.202">     if (outer != null)</span>
<a href="#l127.203"></a><span id="l127.203">       throw Components.results.NS_ERROR_NO_AGGREGATION;</span>
<a href="#l127.204"></a><span id="l127.204">     return this.QueryInterface(iid);</span>
<a href="#l127.205"></a><span id="l127.205">   },</span>
<a href="#l127.206"></a><span id="l127.206"> </span>
<a href="#l127.207"></a><span id="l127.207">   QueryInterface: XPCOMUtils.generateQI([Ci.nsIPromptService,</span>
<a href="#l127.208"></a><span id="l127.208">                                          Ci.nsIPromptService2])</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l128.1"></a><span id="l128.1" class="difflineminus">--- a/mailnews/test/resources/mailShutdown.js</span>
<a href="#l128.2"></a><span id="l128.2" class="difflineplus">+++ b/mailnews/test/resources/mailShutdown.js</span>
<a href="#l128.3"></a><span id="l128.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l128.4"></a><span id="l128.4" class="difflineminus">- </span>
<a href="#l128.5"></a><span id="l128.5" class="difflineplus">+</span>
<a href="#l128.6"></a><span id="l128.6"> /* Provides methods to make sure our test shuts down mailnews properly. */</span>
<a href="#l128.7"></a><span id="l128.7"> </span>
<a href="#l128.8"></a><span id="l128.8"> // Notifies everyone that the we're shutting down. This is needed to make sure</span>
<a href="#l128.9"></a><span id="l128.9"> // that e.g. the account manager closes and cleans up correctly. It is semi-fake</span>
<a href="#l128.10"></a><span id="l128.10"> // because we don't actually do any work to make sure the profile goes away, but</span>
<a href="#l128.11"></a><span id="l128.11"> // it will mimic the behaviour in the app sufficiently.</span>
<a href="#l128.12"></a><span id="l128.12"> //</span>
<a href="#l128.13"></a><span id="l128.13"> // See also http://developer.mozilla.org/en/Observer_Notifications</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l129.1"></a><span id="l129.1" class="difflineminus">--- a/mailnews/test/resources/msgFolderListenerSetup.js</span>
<a href="#l129.2"></a><span id="l129.2" class="difflineplus">+++ b/mailnews/test/resources/msgFolderListenerSetup.js</span>
<a href="#l129.3"></a><span id="l129.3" class="difflineat">@@ -110,17 +110,17 @@ var gMFListener =</span>
<a href="#l129.4"></a><span id="l129.4">     verify([gMFNService.msgKeyChanged, aOldKey, aNewMsgHdr]);</span>
<a href="#l129.5"></a><span id="l129.5">     if (gExpectedEvents.length == 0)</span>
<a href="#l129.6"></a><span id="l129.6">     {</span>
<a href="#l129.7"></a><span id="l129.7">       gCurrStatus |= kStatus.notificationsDone;</span>
<a href="#l129.8"></a><span id="l129.8">       if (gCurrStatus == kStatus.everythingDone)</span>
<a href="#l129.9"></a><span id="l129.9">         resetStatusAndProceed();</span>
<a href="#l129.10"></a><span id="l129.10">     }</span>
<a href="#l129.11"></a><span id="l129.11">   },</span>
<a href="#l129.12"></a><span id="l129.12" class="difflineminus">-  </span>
<a href="#l129.13"></a><span id="l129.13" class="difflineplus">+</span>
<a href="#l129.14"></a><span id="l129.14">   folderAdded: function(aFolder)</span>
<a href="#l129.15"></a><span id="l129.15">   {</span>
<a href="#l129.16"></a><span id="l129.16">     verify([gMFNService.folderAdded, aFolder]);</span>
<a href="#l129.17"></a><span id="l129.17">     if (gExpectedEvents.length == 0)</span>
<a href="#l129.18"></a><span id="l129.18">     {</span>
<a href="#l129.19"></a><span id="l129.19">       gCurrStatus |= kStatus.notificationsDone;</span>
<a href="#l129.20"></a><span id="l129.20">       if (gCurrStatus == kStatus.everythingDone)</span>
<a href="#l129.21"></a><span id="l129.21">         resetStatusAndProceed();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l130.1"></a><span id="l130.1" class="difflineminus">--- a/mailnews/test/resources/searchTestUtils.js</span>
<a href="#l130.2"></a><span id="l130.2" class="difflineplus">+++ b/mailnews/test/resources/searchTestUtils.js</span>
<a href="#l130.3"></a><span id="l130.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l130.4"></a><span id="l130.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l130.5"></a><span id="l130.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l130.6"></a><span id="l130.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l130.7"></a><span id="l130.7" class="difflineminus">- </span>
<a href="#l130.8"></a><span id="l130.8" class="difflineplus">+</span>
<a href="#l130.9"></a><span id="l130.9">  // Contains various functions commonly used in testing mailnews search</span>
<a href="#l130.10"></a><span id="l130.10"> </span>
<a href="#l130.11"></a><span id="l130.11"> /**</span>
<a href="#l130.12"></a><span id="l130.12">  * TestSearch: Class to test number of search hits</span>
<a href="#l130.13"></a><span id="l130.13">  *</span>
<a href="#l130.14"></a><span id="l130.14">  * @param aFolder:   the folder to search</span>
<a href="#l130.15"></a><span id="l130.15">  * @param aValue:    value used for the search</span>
<a href="#l130.16"></a><span id="l130.16">  *                   The interpretation of aValue depends on aAttrib. It</span>
<a href="#l130.17"></a><span id="l130.17" class="difflineat">@@ -23,38 +23,38 @@</span>
<a href="#l130.18"></a><span id="l130.18">  * @param aHdrProperty      for HdrProperty and Uint32HdrProperty case</span>
<a href="#l130.19"></a><span id="l130.19">  *</span>
<a href="#l130.20"></a><span id="l130.20">  */</span>
<a href="#l130.21"></a><span id="l130.21"> </span>
<a href="#l130.22"></a><span id="l130.22"> function TestSearch(aFolder, aValue, aAttrib, aOp, aHitCount, onDone, aCustomId,</span>
<a href="#l130.23"></a><span id="l130.23">                     aArbitraryHeader, aHdrProperty)</span>
<a href="#l130.24"></a><span id="l130.24"> {</span>
<a href="#l130.25"></a><span id="l130.25">   var searchListener =</span>
<a href="#l130.26"></a><span id="l130.26" class="difflineminus">-  { </span>
<a href="#l130.27"></a><span id="l130.27" class="difflineplus">+  {</span>
<a href="#l130.28"></a><span id="l130.28">     onSearchHit: function(dbHdr, folder) { hitCount++; },</span>
<a href="#l130.29"></a><span id="l130.29">     onSearchDone: function(status)</span>
<a href="#l130.30"></a><span id="l130.30" class="difflineminus">-    { </span>
<a href="#l130.31"></a><span id="l130.31" class="difflineplus">+    {</span>
<a href="#l130.32"></a><span id="l130.32">       print(&quot;Finished search does &quot; + aHitCount + &quot; equal &quot; + hitCount + &quot;?&quot;);</span>
<a href="#l130.33"></a><span id="l130.33">       searchSession = null;</span>
<a href="#l130.34"></a><span id="l130.34">       Assert.equal(aHitCount, hitCount);</span>
<a href="#l130.35"></a><span id="l130.35">       if (onDone)</span>
<a href="#l130.36"></a><span id="l130.36">         onDone();</span>
<a href="#l130.37"></a><span id="l130.37">     },</span>
<a href="#l130.38"></a><span id="l130.38">     onNewSearch: function() {hitCount = 0;}</span>
<a href="#l130.39"></a><span id="l130.39">   };</span>
<a href="#l130.40"></a><span id="l130.40"> </span>
<a href="#l130.41"></a><span id="l130.41">   // define and initiate the search session</span>
<a href="#l130.42"></a><span id="l130.42" class="difflineminus">-  </span>
<a href="#l130.43"></a><span id="l130.43" class="difflineplus">+</span>
<a href="#l130.44"></a><span id="l130.44">   var hitCount;</span>
<a href="#l130.45"></a><span id="l130.45">   var searchSession = Cc[&quot;@mozilla.org/messenger/searchSession;1&quot;]</span>
<a href="#l130.46"></a><span id="l130.46">                         .createInstance(Ci.nsIMsgSearchSession);</span>
<a href="#l130.47"></a><span id="l130.47">   searchSession.addScopeTerm(Ci.nsMsgSearchScope.offlineMail, aFolder);</span>
<a href="#l130.48"></a><span id="l130.48">   var searchTerm = searchSession.createTerm();</span>
<a href="#l130.49"></a><span id="l130.49">   searchTerm.attrib = aAttrib;</span>
<a href="#l130.50"></a><span id="l130.50" class="difflineminus">-  </span>
<a href="#l130.51"></a><span id="l130.51" class="difflineplus">+</span>
<a href="#l130.52"></a><span id="l130.52">   var value = searchTerm.value;</span>
<a href="#l130.53"></a><span id="l130.53">   // This is tricky - value.attrib must be set before actual values</span>
<a href="#l130.54"></a><span id="l130.54">   value.attrib = aAttrib;</span>
<a href="#l130.55"></a><span id="l130.55">   if (aAttrib == Ci.nsMsgSearchAttrib.JunkPercent)</span>
<a href="#l130.56"></a><span id="l130.56">     value.junkPercent = aValue;</span>
<a href="#l130.57"></a><span id="l130.57">   else if (aAttrib == Ci.nsMsgSearchAttrib.Priority)</span>
<a href="#l130.58"></a><span id="l130.58">     value.priority = aValue;</span>
<a href="#l130.59"></a><span id="l130.59">   else if (aAttrib == Ci.nsMsgSearchAttrib.Date)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

