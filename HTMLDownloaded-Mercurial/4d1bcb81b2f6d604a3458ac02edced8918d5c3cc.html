<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 23534:4d1bcb81b2f6d604a3458ac02edced8918d5c3cc</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 4d1bcb81b2f6d604a3458ac02edced8918d5c3cc" />
<meta property="og:url" content="/comm-central/rev/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc" />
<meta property="og:description" content="Bug 1399756 - remove trailing spaces in mailnews/ (.xul, .xml, .css, .mm, .cpp). rs=white-space-only" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 4d1bcb81b2f6d604a3458ac02edced8918d5c3cc 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">shortlog</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">files</a> |
changeset |
<a href="/comm-central/raw-rev/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">raw</a>  | <a href="/comm-central/archive/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1399756">Bug 1399756</a> - remove trailing spaces in mailnews/ (.xul, .xml, .css, .mm, .cpp). rs=white-space-only
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 17 Mar 2018 16:37:49 +0100</td></tr>

<tr>
 <td>changeset 23534</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">4d1bcb81b2f6d604a3458ac02edced8918d5c3cc</a></td>
</tr>



<tr>
<td>parent 23533</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/27098caf003f0acefffaa7d74aed850481ca6b9a">27098caf003f0acefffaa7d74aed850481ca6b9a</a>
</td>
</tr>

<tr>
<td>child 23535</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/cb4a952a64c3622866c490eb2c6c04f96951d624">cb4a952a64c3622866c490eb2c6c04f96951d624</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=4d1bcb81b2f6d604a3458ac02edced8918d5c3cc">14210</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Sat, 17 Mar 2018 15:43:32 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@cb4a952a64c3 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=cb4a952a64c3622866c490eb2c6c04f96951d624">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=cb4a952a64c3622866c490eb2c6c04f96951d624&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb4a952a64c3622866c490eb2c6c04f96951d624&newProject=comm-central&newRevision=4d1bcb81b2f6d604a3458ac02edced8918d5c3cc&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb4a952a64c3622866c490eb2c6c04f96951d624&newProject=comm-central&newRevision=4d1bcb81b2f6d604a3458ac02edced8918d5c3cc&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb4a952a64c3622866c490eb2c6c04f96951d624&newProject=comm-central&newRevision=4d1bcb81b2f6d604a3458ac02edced8918d5c3cc&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28white-space-only%29&revcount=50">white-space-only</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1399756">1399756</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1399756">Bug 1399756</a> - remove trailing spaces in mailnews/ (.xul, .xml, .css, .mm, .cpp). rs=white-space-only
[skip-blame]</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abAddressBookNameDialog.xul">mailnews/addrbook/content/abAddressBookNameDialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abAddressBookNameDialog.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abAddressBookNameDialog.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abAddressBookNameDialog.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abAddressBookNameDialog.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abAddressBookNameDialog.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abEditCardDialog.xul">mailnews/addrbook/content/abEditCardDialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abEditCardDialog.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abEditCardDialog.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abEditCardDialog.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abEditCardDialog.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abEditCardDialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abNewCardDialog.xul">mailnews/addrbook/content/abNewCardDialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abNewCardDialog.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abNewCardDialog.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abNewCardDialog.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abNewCardDialog.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/abNewCardDialog.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/print.css">mailnews/addrbook/content/print.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/print.css">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/print.css">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/print.css">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/print.css">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/content/print.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-directory-add.xul">mailnews/addrbook/prefs/content/pref-directory-add.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-directory-add.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-directory-add.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-directory-add.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-directory-add.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-directory-add.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-editdirectories.xul">mailnews/addrbook/prefs/content/pref-editdirectories.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-editdirectories.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-editdirectories.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-editdirectories.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-editdirectories.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/prefs/content/pref-editdirectories.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXCard.mm">mailnews/addrbook/src/nsAbOSXCard.mm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXCard.mm">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXCard.mm">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXCard.mm">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXCard.mm">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXCard.mm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXDirectory.mm">mailnews/addrbook/src/nsAbOSXDirectory.mm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXDirectory.mm">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXDirectory.mm">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXDirectory.mm">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXDirectory.mm">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/addrbook/src/nsAbOSXDirectory.mm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/folderWidgets.xml">mailnews/base/content/folderWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/folderWidgets.xml">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/folderWidgets.xml">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/folderWidgets.xml">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/folderWidgets.xml">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/folderWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/junkMailInfo.xul">mailnews/base/content/junkMailInfo.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/junkMailInfo.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/junkMailInfo.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/junkMailInfo.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/junkMailInfo.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/junkMailInfo.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/msgAccountCentral.xul">mailnews/base/content/msgAccountCentral.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/msgAccountCentral.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/msgAccountCentral.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/msgAccountCentral.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/msgAccountCentral.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/msgAccountCentral.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/shutdownWindow.xul">mailnews/base/content/shutdownWindow.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/shutdownWindow.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/shutdownWindow.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/shutdownWindow.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/shutdownWindow.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/content/shutdownWindow.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/AccountWizard.xul">mailnews/base/prefs/content/AccountWizard.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/AccountWizard.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/AccountWizard.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/AccountWizard.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/AccountWizard.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/AccountWizard.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/am-offline.xul">mailnews/base/prefs/content/am-offline.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/am-offline.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/am-offline.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/am-offline.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/am-offline.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/prefs/content/am-offline.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/src/nsMessengerOSXIntegration.mm">mailnews/base/src/nsMessengerOSXIntegration.mm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/src/nsMessengerOSXIntegration.mm">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/src/nsMessengerOSXIntegration.mm">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/src/nsMessengerOSXIntegration.mm">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/src/nsMessengerOSXIntegration.mm">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/base/src/nsMessengerOSXIntegration.mm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/build/nsMailModule.cpp">mailnews/build/nsMailModule.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/build/nsMailModule.cpp">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/build/nsMailModule.cpp">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/build/nsMailModule.cpp">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/build/nsMailModule.cpp">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/build/nsMailModule.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/compose/content/sendProgress.xul">mailnews/compose/content/sendProgress.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/compose/content/sendProgress.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/compose/content/sendProgress.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/compose/content/sendProgress.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/compose/content/sendProgress.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/compose/content/sendProgress.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/db/gloda/content/glodacomplete.xml">mailnews/db/gloda/content/glodacomplete.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/db/gloda/content/glodacomplete.xml">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/db/gloda/content/glodacomplete.xml">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/db/gloda/content/glodacomplete.xml">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/db/gloda/content/glodacomplete.xml">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/db/gloda/content/glodacomplete.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/dsn/content/am-dsn.xul">mailnews/extensions/dsn/content/am-dsn.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/dsn/content/am-dsn.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/dsn/content/am-dsn.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/dsn/content/am-dsn.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/dsn/content/am-dsn.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/dsn/content/am-dsn.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/certFetchingStatus.xul">mailnews/extensions/smime/content/certFetchingStatus.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/certFetchingStatus.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/certFetchingStatus.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/certFetchingStatus.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/certFetchingStatus.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/certFetchingStatus.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">mailnews/extensions/smime/content/msgCompSecurityInfo.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul">mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul">mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSecurityInfo.xul">mailnews/extensions/smime/content/msgReadSecurityInfo.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSecurityInfo.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSecurityInfo.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSecurityInfo.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSecurityInfo.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/extensions/smime/content/msgReadSecurityInfo.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/applemail/src/nsEmlxHelperUtils.mm">mailnews/import/applemail/src/nsEmlxHelperUtils.mm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/applemail/src/nsEmlxHelperUtils.mm">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/applemail/src/nsEmlxHelperUtils.mm">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/applemail/src/nsEmlxHelperUtils.mm">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/applemail/src/nsEmlxHelperUtils.mm">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/applemail/src/nsEmlxHelperUtils.mm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/content/fieldMapImport.xul">mailnews/import/content/fieldMapImport.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/content/fieldMapImport.xul">file</a> |
<a href="/comm-central/annotate/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/content/fieldMapImport.xul">annotate</a> |
<a href="/comm-central/diff/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/content/fieldMapImport.xul">diff</a> |
<a href="/comm-central/comparison/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/content/fieldMapImport.xul">comparison</a> |
<a href="/comm-central/log/4d1bcb81b2f6d604a3458ac02edced8918d5c3cc/mailnews/import/content/fieldMapImport.xul">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/addrbook/content/abAddressBookNameDialog.xul</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/addrbook/content/abAddressBookNameDialog.xul</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l1.4"></a><span id="l1.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l1.5"></a><span id="l1.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l1.6"></a><span id="l1.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.7"></a><span id="l1.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.8"></a><span id="l1.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/dialogs.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/addressbook/abAddressBookNameDialog.dtd&quot;&gt;</span>
<a href="#l1.13"></a><span id="l1.13"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/addrbook/content/abEditCardDialog.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/addrbook/content/abEditCardDialog.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l2.5"></a><span id="l2.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l2.6"></a><span id="l2.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.7"></a><span id="l2.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.8"></a><span id="l2.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/global.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12"> &lt;?xul-overlay href=&quot;chrome://messenger/content/addressbook/abCardOverlay.xul&quot;?&gt;</span>
<a href="#l2.13"></a><span id="l2.13"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/content/abNewCardDialog.xul</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/content/abNewCardDialog.xul</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l3.5"></a><span id="l3.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l3.6"></a><span id="l3.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.7"></a><span id="l3.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.8"></a><span id="l3.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/global.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12"> &lt;?xul-overlay href=&quot;chrome://messenger/content/addressbook/abCardOverlay.xul&quot;?&gt;</span>
<a href="#l3.13"></a><span id="l3.13"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/addrbook/content/print.css</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/addrbook/content/print.css</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -2,63 +2,63 @@</span>
<a href="#l4.4"></a><span id="l4.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.5"></a><span id="l4.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.6"></a><span id="l4.6"> </span>
<a href="#l4.7"></a><span id="l4.7"> directory {</span>
<a href="#l4.8"></a><span id="l4.8">   display: block;</span>
<a href="#l4.9"></a><span id="l4.9"> }</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11"> section {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  display:block; </span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  display:block;</span>
<a href="#l4.14"></a><span id="l4.14">   margin: 15px 20px;</span>
<a href="#l4.15"></a><span id="l4.15"> }</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17"> sectiontitle {</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-  display:block; </span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-  font-weight:bold; </span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-  font-family:verdana; </span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+  display:block;</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+  font-weight:bold;</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+  font-family:verdana;</span>
<a href="#l4.24"></a><span id="l4.24">   font-size:small;</span>
<a href="#l4.25"></a><span id="l4.25"> }</span>
<a href="#l4.26"></a><span id="l4.26"> </span>
<a href="#l4.27"></a><span id="l4.27"> labelrow {</span>
<a href="#l4.28"></a><span id="l4.28">   display:block;</span>
<a href="#l4.29"></a><span id="l4.29"> }</span>
<a href="#l4.30"></a><span id="l4.30"> </span>
<a href="#l4.31"></a><span id="l4.31"> label {</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineminus">-  display:inline; </span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-  font-family:verdana; </span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+  display:inline;</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+  font-family:verdana;</span>
<a href="#l4.36"></a><span id="l4.36">   font-size:small;</span>
<a href="#l4.37"></a><span id="l4.37"> }</span>
<a href="#l4.38"></a><span id="l4.38"> </span>
<a href="#l4.39"></a><span id="l4.39"> GeneratedName {</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-  display:block; </span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-  font-weight:bold; </span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-  font-family:verdana; </span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+  display:block;</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+  font-weight:bold;</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+  font-family:verdana;</span>
<a href="#l4.46"></a><span id="l4.46">   margin-top: 20px;</span>
<a href="#l4.47"></a><span id="l4.47">   margin-bottom: 3px;</span>
<a href="#l4.48"></a><span id="l4.48">   margin-inline-end: 10px;</span>
<a href="#l4.49"></a><span id="l4.49">   margin-inline-start: 10px;</span>
<a href="#l4.50"></a><span id="l4.50"> }</span>
<a href="#l4.51"></a><span id="l4.51"> </span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-FirstName, LastName, </span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+FirstName, LastName,</span>
<a href="#l4.54"></a><span id="l4.54"> HomeAddress, HomeAddress2, HomeCountry,</span>
<a href="#l4.55"></a><span id="l4.55"> WorkAddress, WorkAddress2, WorkCountry,</span>
<a href="#l4.56"></a><span id="l4.56"> JobTitle, Department, Company, Notes {</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineminus">-  display: block; </span>
<a href="#l4.58"></a><span id="l4.58" class="difflineminus">-  font-family: verdana; </span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+  display: block;</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+  font-family: verdana;</span>
<a href="#l4.61"></a><span id="l4.61">   font-size: small;</span>
<a href="#l4.62"></a><span id="l4.62"> }</span>
<a href="#l4.63"></a><span id="l4.63"> </span>
<a href="#l4.64"></a><span id="l4.64"> DisplayName, NickName,</span>
<a href="#l4.65"></a><span id="l4.65"> WorkPhone, HomePhone, FaxNumber, PagerNumber, CellularNumber,</span>
<a href="#l4.66"></a><span id="l4.66"> HomeCity, HomeState, HomeZipCode,</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineminus">-WorkCity, WorkState, WorkZipCode, </span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+WorkCity, WorkState, WorkZipCode,</span>
<a href="#l4.69"></a><span id="l4.69"> Custom1, Custom2, Custom3, Custom4 {</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-  display: inline; </span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-  font-family: verdana; </span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+  display: inline;</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+  font-family: verdana;</span>
<a href="#l4.74"></a><span id="l4.74">   font-size: small;</span>
<a href="#l4.75"></a><span id="l4.75"> }</span>
<a href="#l4.76"></a><span id="l4.76"> </span>
<a href="#l4.77"></a><span id="l4.77"> PrimaryEmail, SecondEmail,</span>
<a href="#l4.78"></a><span id="l4.78"> WebPage1, WebPage2 {</span>
<a href="#l4.79"></a><span id="l4.79">   display: block;</span>
<a href="#l4.80"></a><span id="l4.80">   font-family: verdana;</span>
<a href="#l4.81"></a><span id="l4.81">   font-size: small;</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineat">@@ -79,16 +79,16 @@ table {</span>
<a href="#l4.83"></a><span id="l4.83">   display: table;</span>
<a href="#l4.84"></a><span id="l4.84"> }</span>
<a href="#l4.85"></a><span id="l4.85"> </span>
<a href="#l4.86"></a><span id="l4.86"> tr {</span>
<a href="#l4.87"></a><span id="l4.87">   display: table-row;</span>
<a href="#l4.88"></a><span id="l4.88"> }</span>
<a href="#l4.89"></a><span id="l4.89"> </span>
<a href="#l4.90"></a><span id="l4.90"> td {</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineminus">-  display: table-cell; </span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+  display: table-cell;</span>
<a href="#l4.93"></a><span id="l4.93">   vertical-align: top;</span>
<a href="#l4.94"></a><span id="l4.94"> }</span>
<a href="#l4.95"></a><span id="l4.95"> </span>
<a href="#l4.96"></a><span id="l4.96"> PreferMailFormat {</span>
<a href="#l4.97"></a><span id="l4.97">   display: none;</span>
<a href="#l4.98"></a><span id="l4.98"> }</span>
<a href="#l4.99"></a><span id="l4.99"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/prefs/content/pref-directory-add.xul</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/prefs/content/pref-directory-add.xul</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -24,47 +24,47 @@</span>
<a href="#l5.4"></a><span id="l5.4">   &lt;vbox id=&quot;editDirectory&quot;&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6">     &lt;tabbox style=&quot;margin:5px&quot;&gt;</span>
<a href="#l5.7"></a><span id="l5.7">       &lt;tabs id=&quot;directoryTabBox&quot;&gt;</span>
<a href="#l5.8"></a><span id="l5.8">         &lt;tab label=&quot;&amp;General.tab;&quot;/&gt;</span>
<a href="#l5.9"></a><span id="l5.9">         &lt;tab label=&quot;&amp;Offline.tab;&quot;/&gt;</span>
<a href="#l5.10"></a><span id="l5.10">         &lt;tab label=&quot;&amp;Advanced.tab;&quot;/&gt;</span>
<a href="#l5.11"></a><span id="l5.11">       &lt;/tabs&gt;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-   </span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+</span>
<a href="#l5.14"></a><span id="l5.14">       &lt;tabpanels id=&quot;directoryTabPanels&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l5.15"></a><span id="l5.15">           &lt;vbox&gt;</span>
<a href="#l5.16"></a><span id="l5.16">              &lt;grid flex=&quot;1&quot;&gt;</span>
<a href="#l5.17"></a><span id="l5.17">                  &lt;columns&gt;</span>
<a href="#l5.18"></a><span id="l5.18">                      &lt;column/&gt;</span>
<a href="#l5.19"></a><span id="l5.19">                      &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l5.20"></a><span id="l5.20">                      &lt;column/&gt;</span>
<a href="#l5.21"></a><span id="l5.21">                  &lt;/columns&gt;</span>
<a href="#l5.22"></a><span id="l5.22"> </span>
<a href="#l5.23"></a><span id="l5.23">                  &lt;rows&gt;</span>
<a href="#l5.24"></a><span id="l5.24">                      &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-                         &lt;label value=&quot;&amp;directoryName.label;&quot; accesskey=&quot;&amp;directoryName.accesskey;&quot; </span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+                         &lt;label value=&quot;&amp;directoryName.label;&quot; accesskey=&quot;&amp;directoryName.accesskey;&quot;</span>
<a href="#l5.27"></a><span id="l5.27">                                 control=&quot;description&quot;/&gt;</span>
<a href="#l5.28"></a><span id="l5.28">                          &lt;textbox id=&quot;description&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l5.29"></a><span id="l5.29">                          &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l5.30"></a><span id="l5.30">                      &lt;/row&gt;</span>
<a href="#l5.31"></a><span id="l5.31">                      &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.32"></a><span id="l5.32">                          &lt;label value=&quot;&amp;directoryHostname.label;&quot; accesskey=&quot;&amp;directoryHostname.accesskey;&quot;</span>
<a href="#l5.33"></a><span id="l5.33">                                 control=&quot;hostname&quot;/&gt;</span>
<a href="#l5.34"></a><span id="l5.34">                          &lt;textbox id=&quot;hostname&quot; flex=&quot;1&quot; disableiflocked=&quot;true&quot; class=&quot;uri-element&quot;/&gt;</span>
<a href="#l5.35"></a><span id="l5.35">                          &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l5.36"></a><span id="l5.36">                      &lt;/row&gt;</span>
<a href="#l5.37"></a><span id="l5.37">                      &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-                         &lt;label value=&quot;&amp;directoryBaseDN.label;&quot; </span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+                         &lt;label value=&quot;&amp;directoryBaseDN.label;&quot;</span>
<a href="#l5.40"></a><span id="l5.40">                                 accesskey=&quot;&amp;directoryBaseDN.accesskey;&quot;</span>
<a href="#l5.41"></a><span id="l5.41">                                 control=&quot;basedn&quot;/&gt;</span>
<a href="#l5.42"></a><span id="l5.42">                          &lt;vbox&gt;</span>
<a href="#l5.43"></a><span id="l5.43">                            &lt;textbox id=&quot;basedn&quot; disableiflocked=&quot;true&quot; class=&quot;uri-element&quot;/&gt;</span>
<a href="#l5.44"></a><span id="l5.44">                          &lt;/vbox&gt;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineminus">-                         &lt;button label=&quot;&amp;findButton.label;&quot; </span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+                         &lt;button label=&quot;&amp;findButton.label;&quot;</span>
<a href="#l5.47"></a><span id="l5.47">                                  accesskey=&quot;&amp;findButton.accesskey;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.48"></a><span id="l5.48">                      &lt;/row&gt;</span>
<a href="#l5.49"></a><span id="l5.49">                      &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.50"></a><span id="l5.50">                          &lt;label value=&quot;&amp;portNumber.label;&quot;</span>
<a href="#l5.51"></a><span id="l5.51">                                 accesskey=&quot;&amp;portNumber.accesskey;&quot;</span>
<a href="#l5.52"></a><span id="l5.52">                                 control=&quot;port&quot;/&gt;</span>
<a href="#l5.53"></a><span id="l5.53">                          &lt;hbox&gt;</span>
<a href="#l5.54"></a><span id="l5.54">                              &lt;textbox id=&quot;port&quot; type=&quot;number&quot; size=&quot;5&quot; min=&quot;1&quot;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineat">@@ -89,17 +89,17 @@</span>
<a href="#l5.56"></a><span id="l5.56">               &lt;description&gt;&amp;offlineText.label;&lt;/description&gt;</span>
<a href="#l5.57"></a><span id="l5.57">               &lt;separator/&gt;</span>
<a href="#l5.58"></a><span id="l5.58">               &lt;hbox&gt;</span>
<a href="#l5.59"></a><span id="l5.59">                   &lt;button id=&quot;download&quot; oncommand=&quot;DownloadNow();&quot;/&gt;</span>
<a href="#l5.60"></a><span id="l5.60">                   &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l5.61"></a><span id="l5.61">               &lt;/hbox&gt;</span>
<a href="#l5.62"></a><span id="l5.62">               &lt;description id=&quot;downloadWarningMsg&quot; hidden=&quot;true&quot; class=&quot;error&quot;/&gt;</span>
<a href="#l5.63"></a><span id="l5.63">               &lt;description id=&quot;replicationProgressText&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineminus">-              </span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+</span>
<a href="#l5.66"></a><span id="l5.66">               &lt;progressmeter id=&quot;replicationProgressMeter&quot; mode=&quot;normal&quot; value=&quot;0&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l5.67"></a><span id="l5.67">           &lt;/vbox&gt;</span>
<a href="#l5.68"></a><span id="l5.68">           &lt;grid&gt;</span>
<a href="#l5.69"></a><span id="l5.69">              &lt;columns&gt;</span>
<a href="#l5.70"></a><span id="l5.70">                &lt;column/&gt;</span>
<a href="#l5.71"></a><span id="l5.71">                &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l5.72"></a><span id="l5.72">              &lt;/columns&gt;</span>
<a href="#l5.73"></a><span id="l5.73"> </span>
<a href="#l5.74"></a><span id="l5.74" class="difflineat">@@ -128,25 +128,25 @@</span>
<a href="#l5.75"></a><span id="l5.75">                         accesskey=&quot;&amp;searchFilter.accesskey;&quot;</span>
<a href="#l5.76"></a><span id="l5.76">                         control=&quot;search&quot;/&gt;</span>
<a href="#l5.77"></a><span id="l5.77">                  &lt;textbox id=&quot;search&quot; multiline=&quot;true&quot; flex=&quot;1&quot; disableiflocked=&quot;true&quot;/&gt;</span>
<a href="#l5.78"></a><span id="l5.78">               &lt;/row&gt;</span>
<a href="#l5.79"></a><span id="l5.79">               &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l5.80"></a><span id="l5.80">                 &lt;label value=&quot;&amp;saslMechanism.label;&quot; control=&quot;saslMechanism&quot; accesskey=&quot;&amp;saslMechanism.accesskey;&quot;/&gt;</span>
<a href="#l5.81"></a><span id="l5.81">                 &lt;menulist id=&quot;saslMechanism&quot;&gt;</span>
<a href="#l5.82"></a><span id="l5.82">                   &lt;menupopup&gt;</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineminus">-                    &lt;menuitem id=&quot;Simple&quot; value=&quot;&quot; </span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+                    &lt;menuitem id=&quot;Simple&quot; value=&quot;&quot;</span>
<a href="#l5.85"></a><span id="l5.85">                               label=&quot;&amp;saslOff.label;&quot;</span>
<a href="#l5.86"></a><span id="l5.86">                               accesskey=&quot;&amp;saslOff.accesskey;&quot;/&gt;</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineminus">-                    &lt;menuitem id=&quot;GSSAPI&quot; value=&quot;GSSAPI&quot; </span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+                    &lt;menuitem id=&quot;GSSAPI&quot; value=&quot;GSSAPI&quot;</span>
<a href="#l5.89"></a><span id="l5.89">                               label=&quot;&amp;saslGSSAPI.label;&quot;</span>
<a href="#l5.90"></a><span id="l5.90">                               accesskey=&quot;&amp;saslGSSAPI.accesskey;&quot;/&gt;</span>
<a href="#l5.91"></a><span id="l5.91">                   &lt;/menupopup&gt;</span>
<a href="#l5.92"></a><span id="l5.92">                 &lt;/menulist&gt;</span>
<a href="#l5.93"></a><span id="l5.93">               &lt;/row&gt;</span>
<a href="#l5.94"></a><span id="l5.94">             &lt;/rows&gt;</span>
<a href="#l5.95"></a><span id="l5.95">           &lt;/grid&gt;</span>
<a href="#l5.96"></a><span id="l5.96">       &lt;/tabpanels&gt;</span>
<a href="#l5.97"></a><span id="l5.97">     &lt;/tabbox&gt;</span>
<a href="#l5.98"></a><span id="l5.98">   &lt;/vbox&gt;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineminus">-  </span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+</span>
<a href="#l5.101"></a><span id="l5.101"> &lt;/dialog&gt;</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineminus">-        </span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/prefs/content/pref-editdirectories.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/prefs/content/pref-editdirectories.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l6.6"></a><span id="l6.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.7"></a><span id="l6.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.8"></a><span id="l6.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/addressbook/pref-directory.dtd&quot;&gt;</span>
<a href="#l6.13"></a><span id="l6.13"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbOSXCard.mm</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbOSXCard.mm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -67,39 +67,39 @@ SetStringProperty(nsAbOSXCard *aCard, NS</span>
<a href="#l7.4"></a><span id="l7.4"> static void</span>
<a href="#l7.5"></a><span id="l7.5"> MapStringProperty(nsAbOSXCard *aCard, ABRecord *aOSXCard, NSString *aProperty,</span>
<a href="#l7.6"></a><span id="l7.6">                   const char *aMemberName, bool aNotify,</span>
<a href="#l7.7"></a><span id="l7.7">                   nsIAbManager *aAbManager)</span>
<a href="#l7.8"></a><span id="l7.8"> {</span>
<a href="#l7.9"></a><span id="l7.9">   NS_ASSERTION(aProperty, &quot;This is bad! You asked for an unresolved symbol.&quot;);</span>
<a href="#l7.10"></a><span id="l7.10">   NS_ASSERTION(GetPropertType(aOSXCard, aProperty) == kABStringProperty,</span>
<a href="#l7.11"></a><span id="l7.11">                &quot;Wrong type!&quot;);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  </span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+</span>
<a href="#l7.14"></a><span id="l7.14">   SetStringProperty(aCard, [aOSXCard valueForProperty:aProperty], aMemberName,</span>
<a href="#l7.15"></a><span id="l7.15">                     aNotify, aAbManager);</span>
<a href="#l7.16"></a><span id="l7.16"> }</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> static ABMutableMultiValue*</span>
<a href="#l7.19"></a><span id="l7.19"> GetMultiValue(ABRecord *aCard, NSString *aProperty)</span>
<a href="#l7.20"></a><span id="l7.20"> {</span>
<a href="#l7.21"></a><span id="l7.21">   NS_ASSERTION(aProperty, &quot;This is bad! You asked for an unresolved symbol.&quot;);</span>
<a href="#l7.22"></a><span id="l7.22">   NS_ASSERTION(GetPropertType(aCard, aProperty) &amp; kABMultiValueMask,</span>
<a href="#l7.23"></a><span id="l7.23">                &quot;Wrong type!&quot;);</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-  </span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+</span>
<a href="#l7.26"></a><span id="l7.26">   return [aCard valueForProperty:aProperty];</span>
<a href="#l7.27"></a><span id="l7.27"> }</span>
<a href="#l7.28"></a><span id="l7.28"> </span>
<a href="#l7.29"></a><span id="l7.29"> static void</span>
<a href="#l7.30"></a><span id="l7.30"> MapDate(nsAbOSXCard *aCard, NSDate *aDate, const char *aYearPropName,</span>
<a href="#l7.31"></a><span id="l7.31">         const char *aMonthPropName, const char *aDayPropName, bool aNotify,</span>
<a href="#l7.32"></a><span id="l7.32">         nsIAbManager *aAbManager)</span>
<a href="#l7.33"></a><span id="l7.33"> {</span>
<a href="#l7.34"></a><span id="l7.34">   // XXX Should we pass a format and timezone?</span>
<a href="#l7.35"></a><span id="l7.35">   NSCalendarDate *date = [aDate dateWithCalendarFormat:nil timeZone:nil];</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineminus">-  </span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+</span>
<a href="#l7.38"></a><span id="l7.38">   nsAutoString value;</span>
<a href="#l7.39"></a><span id="l7.39">   value.AppendInt(static_cast&lt;int32_t&gt;([date yearOfCommonEra]));</span>
<a href="#l7.40"></a><span id="l7.40">   SetStringProperty(aCard, value, aYearPropName, aNotify, aAbManager);</span>
<a href="#l7.41"></a><span id="l7.41">   value.Truncate();</span>
<a href="#l7.42"></a><span id="l7.42">   value.AppendInt(static_cast&lt;int32_t&gt;([date monthOfYear]));</span>
<a href="#l7.43"></a><span id="l7.43">   SetStringProperty(aCard, value, aMonthPropName, aNotify, aAbManager);</span>
<a href="#l7.44"></a><span id="l7.44">   value.Truncate();</span>
<a href="#l7.45"></a><span id="l7.45">   value.AppendInt(static_cast&lt;int32_t&gt;([date dayOfMonth]));</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineat">@@ -115,28 +115,28 @@ MapMultiValue(nsAbOSXCard *aCard, ABReco</span>
<a href="#l7.47"></a><span id="l7.47">   if (value) {</span>
<a href="#l7.48"></a><span id="l7.48">     unsigned int j;</span>
<a href="#l7.49"></a><span id="l7.49">     unsigned int count = [value count];</span>
<a href="#l7.50"></a><span id="l7.50">     for (j = 0; j &lt; count; ++j) {</span>
<a href="#l7.51"></a><span id="l7.51">       if ([[value labelAtIndex:j] isEqualToString:aMap.mOSXLabel]) {</span>
<a href="#l7.52"></a><span id="l7.52">         NSString *stringValue = (aMap.mOSXKey)</span>
<a href="#l7.53"></a><span id="l7.53">           ? [[value valueAtIndex:j] objectForKey:aMap.mOSXKey]</span>
<a href="#l7.54"></a><span id="l7.54">           : [value valueAtIndex:j];</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineminus">-        </span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+</span>
<a href="#l7.57"></a><span id="l7.57">         SetStringProperty(aCard, stringValue, aMap.mPropertyName, aNotify,</span>
<a href="#l7.58"></a><span id="l7.58">                           aAbManager);</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-        </span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+</span>
<a href="#l7.61"></a><span id="l7.61">         return true;</span>
<a href="#l7.62"></a><span id="l7.62">       }</span>
<a href="#l7.63"></a><span id="l7.63">     }</span>
<a href="#l7.64"></a><span id="l7.64">   }</span>
<a href="#l7.65"></a><span id="l7.65">   // String wasn't found, set value of card to empty if it was set previously</span>
<a href="#l7.66"></a><span id="l7.66">   SetStringProperty(aCard, EmptyString(), aMap.mPropertyName, aNotify,</span>
<a href="#l7.67"></a><span id="l7.67">                     aAbManager);</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineminus">-  </span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+</span>
<a href="#l7.70"></a><span id="l7.70">   return false;</span>
<a href="#l7.71"></a><span id="l7.71"> }</span>
<a href="#l7.72"></a><span id="l7.72"> </span>
<a href="#l7.73"></a><span id="l7.73"> // Maps Address Book's instant messenger name to the corresponding nsIAbCard field name.</span>
<a href="#l7.74"></a><span id="l7.74"> static const char*</span>
<a href="#l7.75"></a><span id="l7.75"> InstantMessengerFieldName(NSString* aInstantMessengerName)</span>
<a href="#l7.76"></a><span id="l7.76"> {</span>
<a href="#l7.77"></a><span id="l7.77">   if ([aInstantMessengerName isEqualToString:@&quot;AIMInstant&quot;]) {</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineat">@@ -217,62 +217,62 @@ nsAbOSXCard::Update(bool aNotify)</span>
<a href="#l7.79"></a><span id="l7.79">     m_MailListURI.Append(uid);</span>
<a href="#l7.80"></a><span id="l7.80">     MapStringProperty(this, card, kABGroupNameProperty, &quot;DisplayName&quot;, aNotify,</span>
<a href="#l7.81"></a><span id="l7.81">                       abManager);</span>
<a href="#l7.82"></a><span id="l7.82">     MapStringProperty(this, card, kABGroupNameProperty, &quot;LastName&quot;, aNotify,</span>
<a href="#l7.83"></a><span id="l7.83">                       abManager);</span>
<a href="#l7.84"></a><span id="l7.84"> </span>
<a href="#l7.85"></a><span id="l7.85">     return NS_OK;</span>
<a href="#l7.86"></a><span id="l7.86">   }</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineminus">-  </span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+</span>
<a href="#l7.89"></a><span id="l7.89">   bool foundHome = false, foundWork = false;</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineminus">-  </span>
<a href="#l7.91"></a><span id="l7.91" class="difflineplus">+</span>
<a href="#l7.92"></a><span id="l7.92">   uint32_t i;</span>
<a href="#l7.93"></a><span id="l7.93">   for (i = 0; i &lt; nsAbOSXUtils::kPropertyMapSize; ++i) {</span>
<a href="#l7.94"></a><span id="l7.94">     const nsAbOSXPropertyMap &amp;propertyMap = nsAbOSXUtils::kPropertyMap[i];</span>
<a href="#l7.95"></a><span id="l7.95">     if (!propertyMap.mOSXProperty)</span>
<a href="#l7.96"></a><span id="l7.96">       continue;</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineminus">-    </span>
<a href="#l7.98"></a><span id="l7.98" class="difflineplus">+</span>
<a href="#l7.99"></a><span id="l7.99">     if (propertyMap.mOSXLabel) {</span>
<a href="#l7.100"></a><span id="l7.100">       if (MapMultiValue(this, card, propertyMap, aNotify,</span>
<a href="#l7.101"></a><span id="l7.101">                         abManager) &amp;&amp; propertyMap.mOSXProperty == kABAddressProperty) {</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineminus">-        if (propertyMap.mOSXLabel == kABAddressHomeLabel) </span>
<a href="#l7.103"></a><span id="l7.103" class="difflineplus">+        if (propertyMap.mOSXLabel == kABAddressHomeLabel)</span>
<a href="#l7.104"></a><span id="l7.104">           foundHome = true;</span>
<a href="#l7.105"></a><span id="l7.105">         else</span>
<a href="#l7.106"></a><span id="l7.106">           foundWork = true;</span>
<a href="#l7.107"></a><span id="l7.107">       }</span>
<a href="#l7.108"></a><span id="l7.108">     }</span>
<a href="#l7.109"></a><span id="l7.109">     else {</span>
<a href="#l7.110"></a><span id="l7.110">       MapStringProperty(this, card, propertyMap.mOSXProperty,</span>
<a href="#l7.111"></a><span id="l7.111">                         propertyMap.mPropertyName, aNotify, abManager);</span>
<a href="#l7.112"></a><span id="l7.112">     }</span>
<a href="#l7.113"></a><span id="l7.113">   }</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineminus">-  </span>
<a href="#l7.115"></a><span id="l7.115" class="difflineplus">+</span>
<a href="#l7.116"></a><span id="l7.116">   int flags = 0;</span>
<a href="#l7.117"></a><span id="l7.117">   if (kABPersonFlags)</span>
<a href="#l7.118"></a><span id="l7.118">     flags = [[card valueForProperty:kABPersonFlags] intValue];</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineminus">-  </span>
<a href="#l7.120"></a><span id="l7.120" class="difflineplus">+</span>
<a href="#l7.121"></a><span id="l7.121"> #define SET_STRING(_value, _name, _notify, _session) \</span>
<a href="#l7.122"></a><span id="l7.122">   SetStringProperty(this, _value, #_name, _notify, _session)</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineminus">-    </span>
<a href="#l7.124"></a><span id="l7.124" class="difflineplus">+</span>
<a href="#l7.125"></a><span id="l7.125">     // If kABShowAsCompany is set we use the company name as display name.</span>
<a href="#l7.126"></a><span id="l7.126">     if (kABPersonFlags &amp;&amp; (flags &amp; kABShowAsCompany)) {</span>
<a href="#l7.127"></a><span id="l7.127">       nsString company;</span>
<a href="#l7.128"></a><span id="l7.128">       nsresult rv = GetPropertyAsAString(kCompanyProperty, company);</span>
<a href="#l7.129"></a><span id="l7.129">       if (NS_FAILED(rv))</span>
<a href="#l7.130"></a><span id="l7.130">         company.Truncate();</span>
<a href="#l7.131"></a><span id="l7.131">       SET_STRING(company, DisplayName, aNotify, abManager);</span>
<a href="#l7.132"></a><span id="l7.132">     }</span>
<a href="#l7.133"></a><span id="l7.133">   else {</span>
<a href="#l7.134"></a><span id="l7.134">     // Use the order used in the OS X address book to set DisplayName.</span>
<a href="#l7.135"></a><span id="l7.135">     int order = kABPersonFlags &amp;&amp; (flags &amp; kABNameOrderingMask);</span>
<a href="#l7.136"></a><span id="l7.136">     if (kABPersonFlags &amp;&amp; (order == kABDefaultNameOrdering)) {</span>
<a href="#l7.137"></a><span id="l7.137">       order = [addressBook defaultNameOrdering];</span>
<a href="#l7.138"></a><span id="l7.138">     }</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineminus">-    </span>
<a href="#l7.140"></a><span id="l7.140" class="difflineplus">+</span>
<a href="#l7.141"></a><span id="l7.141">     nsAutoString displayName, tempName;</span>
<a href="#l7.142"></a><span id="l7.142">     if (kABPersonFlags &amp;&amp; (order == kABFirstNameFirst)) {</span>
<a href="#l7.143"></a><span id="l7.143">       GetFirstName(tempName);</span>
<a href="#l7.144"></a><span id="l7.144">       displayName.Append(tempName);</span>
<a href="#l7.145"></a><span id="l7.145"> </span>
<a href="#l7.146"></a><span id="l7.146">       GetLastName(tempName);</span>
<a href="#l7.147"></a><span id="l7.147"> </span>
<a href="#l7.148"></a><span id="l7.148">       // Only append a space if the last name and the first name are not empty</span>
<a href="#l7.149"></a><span id="l7.149" class="difflineat">@@ -290,46 +290,46 @@ nsAbOSXCard::Update(bool aNotify)</span>
<a href="#l7.150"></a><span id="l7.150">       // Only append a space if the last name and the first name are not empty</span>
<a href="#l7.151"></a><span id="l7.151">       if (!tempName.IsEmpty() &amp;&amp; !displayName.IsEmpty())</span>
<a href="#l7.152"></a><span id="l7.152">         displayName.Append(' ');</span>
<a href="#l7.153"></a><span id="l7.153"> </span>
<a href="#l7.154"></a><span id="l7.154">       displayName.Append(tempName);</span>
<a href="#l7.155"></a><span id="l7.155">     }</span>
<a href="#l7.156"></a><span id="l7.156">     SET_STRING(displayName, DisplayName, aNotify, abManager);</span>
<a href="#l7.157"></a><span id="l7.157">   }</span>
<a href="#l7.158"></a><span id="l7.158" class="difflineminus">-  </span>
<a href="#l7.159"></a><span id="l7.159" class="difflineplus">+</span>
<a href="#l7.160"></a><span id="l7.160">   ABMultiValue *value = GetMultiValue(card, kABEmailProperty);</span>
<a href="#l7.161"></a><span id="l7.161">   if (value) {</span>
<a href="#l7.162"></a><span id="l7.162">     unsigned int count = [value count];</span>
<a href="#l7.163"></a><span id="l7.163">     if (count &gt; 0) {</span>
<a href="#l7.164"></a><span id="l7.164">       unsigned int j = [value indexForIdentifier:[value primaryIdentifier]];</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineminus">-      </span>
<a href="#l7.166"></a><span id="l7.166" class="difflineplus">+</span>
<a href="#l7.167"></a><span id="l7.167">       if (j &lt; count)</span>
<a href="#l7.168"></a><span id="l7.168">         SET_STRING([value valueAtIndex:j], PrimaryEmail, aNotify,</span>
<a href="#l7.169"></a><span id="l7.169">                    abManager);</span>
<a href="#l7.170"></a><span id="l7.170" class="difflineminus">-      </span>
<a href="#l7.171"></a><span id="l7.171" class="difflineplus">+</span>
<a href="#l7.172"></a><span id="l7.172">       // If j is 0 (first in the list) we want the second in the list</span>
<a href="#l7.173"></a><span id="l7.173">       // (index 1), if j is anything else we want the first in the list</span>
<a href="#l7.174"></a><span id="l7.174">       // (index 0).</span>
<a href="#l7.175"></a><span id="l7.175">       j = (j == 0);</span>
<a href="#l7.176"></a><span id="l7.176">       if (j &lt; count)</span>
<a href="#l7.177"></a><span id="l7.177">         SET_STRING([value valueAtIndex:j], SecondEmail, aNotify,</span>
<a href="#l7.178"></a><span id="l7.178">                    abManager);</span>
<a href="#l7.179"></a><span id="l7.179">     }</span>
<a href="#l7.180"></a><span id="l7.180">   }</span>
<a href="#l7.181"></a><span id="l7.181" class="difflineminus">-  </span>
<a href="#l7.182"></a><span id="l7.182" class="difflineplus">+</span>
<a href="#l7.183"></a><span id="l7.183">   // We map the first home address we can find and the first work address</span>
<a href="#l7.184"></a><span id="l7.184">   // we can find. If we find none, we map the primary address to the home</span>
<a href="#l7.185"></a><span id="l7.185">   // address.</span>
<a href="#l7.186"></a><span id="l7.186">   if (!foundHome &amp;&amp; !foundWork) {</span>
<a href="#l7.187"></a><span id="l7.187">     value = GetMultiValue(card, kABAddressProperty);</span>
<a href="#l7.188"></a><span id="l7.188">     if (value) {</span>
<a href="#l7.189"></a><span id="l7.189">       unsigned int count = [value count];</span>
<a href="#l7.190"></a><span id="l7.190">       unsigned int j = [value indexForIdentifier:[value primaryIdentifier]];</span>
<a href="#l7.191"></a><span id="l7.191" class="difflineminus">-      </span>
<a href="#l7.192"></a><span id="l7.192" class="difflineplus">+</span>
<a href="#l7.193"></a><span id="l7.193">       if (j &lt; count) {</span>
<a href="#l7.194"></a><span id="l7.194">         NSDictionary *address = [value valueAtIndex:j];</span>
<a href="#l7.195"></a><span id="l7.195">         if (address) {</span>
<a href="#l7.196"></a><span id="l7.196">           SET_STRING([address objectForKey:kABAddressStreetKey],</span>
<a href="#l7.197"></a><span id="l7.197">                      HomeAddress, aNotify, abManager);</span>
<a href="#l7.198"></a><span id="l7.198">           SET_STRING([address objectForKey:kABAddressCityKey],</span>
<a href="#l7.199"></a><span id="l7.199">                      HomeCity, aNotify, abManager);</span>
<a href="#l7.200"></a><span id="l7.200">           SET_STRING([address objectForKey:kABAddressStateKey],</span>
<a href="#l7.201"></a><span id="l7.201" class="difflineat">@@ -356,46 +356,46 @@ nsAbOSXCard::Update(bool aNotify)</span>
<a href="#l7.202"></a><span id="l7.202">       } else if ([imValue isKindOfClass:[NSDictionary class]]) {</span>
<a href="#l7.203"></a><span id="l7.203">         NSString* instantMessageService = [imValue objectForKey:@&quot;InstantMessageService&quot;];</span>
<a href="#l7.204"></a><span id="l7.204">         const char* fieldName = InstantMessengerFieldName(instantMessageService);</span>
<a href="#l7.205"></a><span id="l7.205">         NSString* userName = [imValue objectForKey:@&quot;InstantMessageUsername&quot;];</span>
<a href="#l7.206"></a><span id="l7.206">         SetStringProperty(this, userName, fieldName, aNotify, abManager);</span>
<a href="#l7.207"></a><span id="l7.207">       }</span>
<a href="#l7.208"></a><span id="l7.208">     }</span>
<a href="#l7.209"></a><span id="l7.209">   }</span>
<a href="#l7.210"></a><span id="l7.210" class="difflineminus">-  </span>
<a href="#l7.211"></a><span id="l7.211" class="difflineplus">+</span>
<a href="#l7.212"></a><span id="l7.212"> #define MAP_DATE(_date, _name, _notify, _session) \</span>
<a href="#l7.213"></a><span id="l7.213">   MapDate(this, _date, #_name&quot;Year&quot;, #_name&quot;Month&quot;, #_name&quot;Day&quot;, _notify, \</span>
<a href="#l7.214"></a><span id="l7.214">   _session)</span>
<a href="#l7.215"></a><span id="l7.215" class="difflineminus">-    </span>
<a href="#l7.216"></a><span id="l7.216" class="difflineplus">+</span>
<a href="#l7.217"></a><span id="l7.217">     NSDate *date = [card valueForProperty:kABBirthdayProperty];</span>
<a href="#l7.218"></a><span id="l7.218">   if (date)</span>
<a href="#l7.219"></a><span id="l7.219">     MAP_DATE(date, Birth, aNotify, abManager);</span>
<a href="#l7.220"></a><span id="l7.220" class="difflineminus">-  </span>
<a href="#l7.221"></a><span id="l7.221" class="difflineplus">+</span>
<a href="#l7.222"></a><span id="l7.222">   if (kABOtherDatesProperty) {</span>
<a href="#l7.223"></a><span id="l7.223">     value = GetMultiValue(card, kABOtherDatesProperty);</span>
<a href="#l7.224"></a><span id="l7.224">     if (value) {</span>
<a href="#l7.225"></a><span id="l7.225">       unsigned int j, count = [value count];</span>
<a href="#l7.226"></a><span id="l7.226">       for (j = 0; j &lt; count; ++j) {</span>
<a href="#l7.227"></a><span id="l7.227">         if ([[value labelAtIndex:j] isEqualToString:kABAnniversaryLabel]) {</span>
<a href="#l7.228"></a><span id="l7.228">           date = [value valueAtIndex:j];</span>
<a href="#l7.229"></a><span id="l7.229">           if (date) {</span>
<a href="#l7.230"></a><span id="l7.230">             MAP_DATE(date, Anniversary, aNotify, abManager);</span>
<a href="#l7.231"></a><span id="l7.231" class="difflineminus">-            </span>
<a href="#l7.232"></a><span id="l7.232" class="difflineplus">+</span>
<a href="#l7.233"></a><span id="l7.233">             break;</span>
<a href="#l7.234"></a><span id="l7.234">           }</span>
<a href="#l7.235"></a><span id="l7.235">         }</span>
<a href="#l7.236"></a><span id="l7.236">       }</span>
<a href="#l7.237"></a><span id="l7.237">     }</span>
<a href="#l7.238"></a><span id="l7.238">   }</span>
<a href="#l7.239"></a><span id="l7.239"> #undef MAP_DATE</span>
<a href="#l7.240"></a><span id="l7.240"> #undef SET_STRING</span>
<a href="#l7.241"></a><span id="l7.241" class="difflineminus">-  </span>
<a href="#l7.242"></a><span id="l7.242" class="difflineplus">+</span>
<a href="#l7.243"></a><span id="l7.243">   date = [card valueForProperty:kABModificationDateProperty];</span>
<a href="#l7.244"></a><span id="l7.244" class="difflineminus">-  if (date) </span>
<a href="#l7.245"></a><span id="l7.245" class="difflineplus">+  if (date)</span>
<a href="#l7.246"></a><span id="l7.246">     SetPropertyAsUint32(&quot;LastModifiedDate&quot;,</span>
<a href="#l7.247"></a><span id="l7.247">                         uint32_t([date timeIntervalSince1970]));</span>
<a href="#l7.248"></a><span id="l7.248">     // XXX No way to notify about this?</span>
<a href="#l7.249"></a><span id="l7.249"> </span>
<a href="#l7.250"></a><span id="l7.250">   return NS_OK;</span>
<a href="#l7.251"></a><span id="l7.251"> </span>
<a href="#l7.252"></a><span id="l7.252">   NS_OBJC_END_TRY_ABORT_BLOCK_NSRESULT;</span>
<a href="#l7.253"></a><span id="l7.253"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbOSXDirectory.mm</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbOSXDirectory.mm</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -109,17 +109,17 @@ Sync(NSString *aUid)</span>
<a href="#l8.4"></a><span id="l8.4">   ABAddressBook *addressBook = [ABAddressBook sharedAddressBook];</span>
<a href="#l8.5"></a><span id="l8.5">   ABRecord *card = [addressBook recordForUniqueId:aUid];</span>
<a href="#l8.6"></a><span id="l8.6">   if ([card isKindOfClass:[ABGroup class]])</span>
<a href="#l8.7"></a><span id="l8.7">   {</span>
<a href="#l8.8"></a><span id="l8.8">     nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.9"></a><span id="l8.9">     GetOrCreateGroup(aUid, getter_AddRefs(directory));</span>
<a href="#l8.10"></a><span id="l8.10">     nsCOMPtr&lt;nsIAbOSXDirectory&gt; osxDirectory =</span>
<a href="#l8.11"></a><span id="l8.11">       do_QueryInterface(directory);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    </span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+</span>
<a href="#l8.14"></a><span id="l8.14">     if (osxDirectory) {</span>
<a href="#l8.15"></a><span id="l8.15">       osxDirectory-&gt;Update();</span>
<a href="#l8.16"></a><span id="l8.16">     }</span>
<a href="#l8.17"></a><span id="l8.17">   }</span>
<a href="#l8.18"></a><span id="l8.18">   else {</span>
<a href="#l8.19"></a><span id="l8.19">     nsCOMPtr&lt;nsIAbCard&gt; abCard;</span>
<a href="#l8.20"></a><span id="l8.20">     nsresult rv;</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -149,17 +149,17 @@ Sync(NSString *aUid)</span>
<a href="#l8.23"></a><span id="l8.23"> @interface ABChangedMonitor : NSObject</span>
<a href="#l8.24"></a><span id="l8.24"> -(void)ABChanged:(NSNotification *)aNotification;</span>
<a href="#l8.25"></a><span id="l8.25"> @end</span>
<a href="#l8.26"></a><span id="l8.26"> </span>
<a href="#l8.27"></a><span id="l8.27"> @implementation ABChangedMonitor</span>
<a href="#l8.28"></a><span id="l8.28"> -(void)ABChanged:(NSNotification *)aNotification</span>
<a href="#l8.29"></a><span id="l8.29"> {</span>
<a href="#l8.30"></a><span id="l8.30">   NSDictionary *changes = [aNotification userInfo];</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-  </span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+</span>
<a href="#l8.33"></a><span id="l8.33">   nsresult rv;</span>
<a href="#l8.34"></a><span id="l8.34">   NSArray *inserted = [changes objectForKey:kABInsertedRecords];</span>
<a href="#l8.35"></a><span id="l8.35"> </span>
<a href="#l8.36"></a><span id="l8.36">   if (inserted) {</span>
<a href="#l8.37"></a><span id="l8.37">     nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l8.38"></a><span id="l8.38">     NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l8.39"></a><span id="l8.39"> </span>
<a href="#l8.40"></a><span id="l8.40">     nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineat">@@ -190,26 +190,26 @@ Sync(NSString *aUid)</span>
<a href="#l8.42"></a><span id="l8.42">         // Construct a card</span>
<a href="#l8.43"></a><span id="l8.43">         nsresult rv = CreateCard(card, getter_AddRefs(abCard));</span>
<a href="#l8.44"></a><span id="l8.44">         NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l8.45"></a><span id="l8.45">         rv = osxDirectory-&gt;AssertCard(abManager, abCard);</span>
<a href="#l8.46"></a><span id="l8.46">         NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l8.47"></a><span id="l8.47">       }</span>
<a href="#l8.48"></a><span id="l8.48">     }</span>
<a href="#l8.49"></a><span id="l8.49">   }</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-  </span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+</span>
<a href="#l8.52"></a><span id="l8.52">   NSArray *updated = [changes objectForKey:kABUpdatedRecords];</span>
<a href="#l8.53"></a><span id="l8.53">   if (updated) {</span>
<a href="#l8.54"></a><span id="l8.54">     unsigned int i, count = [updated count];</span>
<a href="#l8.55"></a><span id="l8.55">     for (i = 0; i &lt; count; ++i) {</span>
<a href="#l8.56"></a><span id="l8.56">       NSString *uid = [updated objectAtIndex:i];</span>
<a href="#l8.57"></a><span id="l8.57">       Sync(uid);</span>
<a href="#l8.58"></a><span id="l8.58">     }</span>
<a href="#l8.59"></a><span id="l8.59">   }</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-  </span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+</span>
<a href="#l8.62"></a><span id="l8.62">   NSArray *deleted = [changes objectForKey:kABDeletedRecords];</span>
<a href="#l8.63"></a><span id="l8.63">   if (deleted) {</span>
<a href="#l8.64"></a><span id="l8.64"> </span>
<a href="#l8.65"></a><span id="l8.65">     nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l8.66"></a><span id="l8.66">     NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l8.67"></a><span id="l8.67"> </span>
<a href="#l8.68"></a><span id="l8.68">     nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.69"></a><span id="l8.69">     rv = abManager-&gt;GetDirectory(NS_LITERAL_CSTRING(NS_ABOSXDIRECTORY_URI_PREFIX&quot;/&quot;),</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineat">@@ -226,34 +226,34 @@ Sync(NSString *aUid)</span>
<a href="#l8.71"></a><span id="l8.71"> </span>
<a href="#l8.72"></a><span id="l8.72">       nsAutoCString uid;</span>
<a href="#l8.73"></a><span id="l8.73">       AppendToCString(deletedUid, uid);</span>
<a href="#l8.74"></a><span id="l8.74"> </span>
<a href="#l8.75"></a><span id="l8.75">       rv = osxDirectory-&gt;DeleteUid(uid);</span>
<a href="#l8.76"></a><span id="l8.76">       NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l8.77"></a><span id="l8.77">     }</span>
<a href="#l8.78"></a><span id="l8.78">   }</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineminus">-  </span>
<a href="#l8.80"></a><span id="l8.80" class="difflineplus">+</span>
<a href="#l8.81"></a><span id="l8.81">   if (!inserted &amp;&amp; !updated &amp;&amp; !deleted) {</span>
<a href="#l8.82"></a><span id="l8.82">     // XXX This is supposed to mean &quot;everything was updated&quot;, but we get</span>
<a href="#l8.83"></a><span id="l8.83">     //     this whenever something has changed, so not sure what to do.</span>
<a href="#l8.84"></a><span id="l8.84">   }</span>
<a href="#l8.85"></a><span id="l8.85"> }</span>
<a href="#l8.86"></a><span id="l8.86"> @end</span>
<a href="#l8.87"></a><span id="l8.87"> </span>
<a href="#l8.88"></a><span id="l8.88"> static nsresult</span>
<a href="#l8.89"></a><span id="l8.89"> MapConditionString(nsIAbBooleanConditionString *aCondition, bool aNegate,</span>
<a href="#l8.90"></a><span id="l8.90">                    bool &amp;aCanHandle, ABSearchElement **aResult)</span>
<a href="#l8.91"></a><span id="l8.91"> {</span>
<a href="#l8.92"></a><span id="l8.92">   aCanHandle = false;</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineminus">-  </span>
<a href="#l8.94"></a><span id="l8.94" class="difflineplus">+</span>
<a href="#l8.95"></a><span id="l8.95">   nsAbBooleanConditionType conditionType = 0;</span>
<a href="#l8.96"></a><span id="l8.96">   nsresult rv = aCondition-&gt;GetCondition(&amp;conditionType);</span>
<a href="#l8.97"></a><span id="l8.97">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.98"></a><span id="l8.98" class="difflineminus">-  </span>
<a href="#l8.99"></a><span id="l8.99" class="difflineplus">+</span>
<a href="#l8.100"></a><span id="l8.100">   ABSearchComparison comparison;</span>
<a href="#l8.101"></a><span id="l8.101">   switch (conditionType) {</span>
<a href="#l8.102"></a><span id="l8.102">     case nsIAbBooleanConditionTypes::Contains:</span>
<a href="#l8.103"></a><span id="l8.103">     {</span>
<a href="#l8.104"></a><span id="l8.104">       if (!aNegate) {</span>
<a href="#l8.105"></a><span id="l8.105">         comparison = kABContainsSubString;</span>
<a href="#l8.106"></a><span id="l8.106">         aCanHandle = true;</span>
<a href="#l8.107"></a><span id="l8.107">       }</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineat">@@ -300,44 +300,44 @@ MapConditionString(nsIAbBooleanCondition</span>
<a href="#l8.109"></a><span id="l8.109">     }</span>
<a href="#l8.110"></a><span id="l8.110">     case nsIAbBooleanConditionTypes::GreaterThan:</span>
<a href="#l8.111"></a><span id="l8.111">     {</span>
<a href="#l8.112"></a><span id="l8.112">       comparison = aNegate ? kABLessThanOrEqual : kABGreaterThan;</span>
<a href="#l8.113"></a><span id="l8.113">       aCanHandle = true;</span>
<a href="#l8.114"></a><span id="l8.114">       break;</span>
<a href="#l8.115"></a><span id="l8.115">     }</span>
<a href="#l8.116"></a><span id="l8.116">   }</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineminus">-  </span>
<a href="#l8.118"></a><span id="l8.118" class="difflineplus">+</span>
<a href="#l8.119"></a><span id="l8.119">   if (!aCanHandle)</span>
<a href="#l8.120"></a><span id="l8.120">     return NS_OK;</span>
<a href="#l8.121"></a><span id="l8.121" class="difflineminus">-  </span>
<a href="#l8.122"></a><span id="l8.122" class="difflineplus">+</span>
<a href="#l8.123"></a><span id="l8.123">   nsCString name;</span>
<a href="#l8.124"></a><span id="l8.124">   rv = aCondition-&gt;GetName(getter_Copies(name));</span>
<a href="#l8.125"></a><span id="l8.125">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.126"></a><span id="l8.126" class="difflineminus">-  </span>
<a href="#l8.127"></a><span id="l8.127" class="difflineplus">+</span>
<a href="#l8.128"></a><span id="l8.128">   nsString value;</span>
<a href="#l8.129"></a><span id="l8.129">   rv = aCondition-&gt;GetValue(getter_Copies(value));</span>
<a href="#l8.130"></a><span id="l8.130">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.131"></a><span id="l8.131" class="difflineminus">-  </span>
<a href="#l8.132"></a><span id="l8.132" class="difflineplus">+</span>
<a href="#l8.133"></a><span id="l8.133">   uint32_t length = value.Length();</span>
<a href="#l8.134"></a><span id="l8.134" class="difflineminus">-  </span>
<a href="#l8.135"></a><span id="l8.135" class="difflineplus">+</span>
<a href="#l8.136"></a><span id="l8.136">   uint32_t i;</span>
<a href="#l8.137"></a><span id="l8.137">   for (i = 0; i &lt; nsAbOSXUtils::kPropertyMapSize; ++i) {</span>
<a href="#l8.138"></a><span id="l8.138">     if (name.Equals(nsAbOSXUtils::kPropertyMap[i].mPropertyName)) {</span>
<a href="#l8.139"></a><span id="l8.139">       *aResult =</span>
<a href="#l8.140"></a><span id="l8.140">       [ABPerson searchElementForProperty:nsAbOSXUtils::kPropertyMap[i].mOSXProperty</span>
<a href="#l8.141"></a><span id="l8.141">                                    label:nsAbOSXUtils::kPropertyMap[i].mOSXLabel</span>
<a href="#l8.142"></a><span id="l8.142">                                      key:nsAbOSXUtils::kPropertyMap[i].mOSXKey</span>
<a href="#l8.143"></a><span id="l8.143">                                    value:[NSString stringWithCharacters:reinterpret_cast&lt;const unichar*&gt;(value.get()) length:length]</span>
<a href="#l8.144"></a><span id="l8.144">                               comparison:comparison];</span>
<a href="#l8.145"></a><span id="l8.145" class="difflineminus">-      </span>
<a href="#l8.146"></a><span id="l8.146" class="difflineplus">+</span>
<a href="#l8.147"></a><span id="l8.147">       return NS_OK;</span>
<a href="#l8.148"></a><span id="l8.148">     }</span>
<a href="#l8.149"></a><span id="l8.149">   }</span>
<a href="#l8.150"></a><span id="l8.150" class="difflineminus">-  </span>
<a href="#l8.151"></a><span id="l8.151" class="difflineplus">+</span>
<a href="#l8.152"></a><span id="l8.152">   if (name.EqualsLiteral(&quot;DisplayName&quot;) &amp;&amp; comparison == kABContainsSubString) {</span>
<a href="#l8.153"></a><span id="l8.153">     ABSearchElement *first =</span>
<a href="#l8.154"></a><span id="l8.154">     [ABPerson searchElementForProperty:kABFirstNameProperty</span>
<a href="#l8.155"></a><span id="l8.155">                                  label:nil</span>
<a href="#l8.156"></a><span id="l8.156">                                    key:nil</span>
<a href="#l8.157"></a><span id="l8.157">                                  value:[NSString stringWithCharacters:reinterpret_cast&lt;const unichar*&gt;(value.get()) length:length]</span>
<a href="#l8.158"></a><span id="l8.158">                             comparison:comparison];</span>
<a href="#l8.159"></a><span id="l8.159">     ABSearchElement *second =</span>
<a href="#l8.160"></a><span id="l8.160" class="difflineat">@@ -347,107 +347,107 @@ MapConditionString(nsIAbBooleanCondition</span>
<a href="#l8.161"></a><span id="l8.161">                                    value:[NSString stringWithCharacters:reinterpret_cast&lt;const unichar*&gt;(value.get()) length:length]</span>
<a href="#l8.162"></a><span id="l8.162">                               comparison:comparison];</span>
<a href="#l8.163"></a><span id="l8.163">     ABSearchElement *third =</span>
<a href="#l8.164"></a><span id="l8.164">       [ABGroup searchElementForProperty:kABGroupNameProperty</span>
<a href="#l8.165"></a><span id="l8.165">                                   label:nil</span>
<a href="#l8.166"></a><span id="l8.166">                                     key:nil</span>
<a href="#l8.167"></a><span id="l8.167">                                   value:[NSString stringWithCharacters:reinterpret_cast&lt;const unichar*&gt;(value.get()) length:length]</span>
<a href="#l8.168"></a><span id="l8.168">                              comparison:comparison];</span>
<a href="#l8.169"></a><span id="l8.169" class="difflineminus">-    </span>
<a href="#l8.170"></a><span id="l8.170" class="difflineplus">+</span>
<a href="#l8.171"></a><span id="l8.171">     *aResult = [ABSearchElement searchElementForConjunction:kABSearchOr children:[NSArray arrayWithObjects:first, second, third, nil]];</span>
<a href="#l8.172"></a><span id="l8.172" class="difflineminus">-    </span>
<a href="#l8.173"></a><span id="l8.173" class="difflineplus">+</span>
<a href="#l8.174"></a><span id="l8.174">     return NS_OK;</span>
<a href="#l8.175"></a><span id="l8.175">   }</span>
<a href="#l8.176"></a><span id="l8.176" class="difflineminus">-  </span>
<a href="#l8.177"></a><span id="l8.177" class="difflineplus">+</span>
<a href="#l8.178"></a><span id="l8.178">   aCanHandle = false;</span>
<a href="#l8.179"></a><span id="l8.179" class="difflineminus">-  </span>
<a href="#l8.180"></a><span id="l8.180" class="difflineplus">+</span>
<a href="#l8.181"></a><span id="l8.181">   return NS_OK;</span>
<a href="#l8.182"></a><span id="l8.182"> }</span>
<a href="#l8.183"></a><span id="l8.183"> </span>
<a href="#l8.184"></a><span id="l8.184"> static nsresult</span>
<a href="#l8.185"></a><span id="l8.185"> BuildSearchElements(nsIAbBooleanExpression *aExpression,</span>
<a href="#l8.186"></a><span id="l8.186">                     bool &amp;aCanHandle,</span>
<a href="#l8.187"></a><span id="l8.187">                     ABSearchElement **aResult)</span>
<a href="#l8.188"></a><span id="l8.188"> {</span>
<a href="#l8.189"></a><span id="l8.189">   aCanHandle = true;</span>
<a href="#l8.190"></a><span id="l8.190" class="difflineminus">-  </span>
<a href="#l8.191"></a><span id="l8.191" class="difflineplus">+</span>
<a href="#l8.192"></a><span id="l8.192">   nsCOMPtr&lt;nsIArray&gt; expressions;</span>
<a href="#l8.193"></a><span id="l8.193">   nsresult rv = aExpression-&gt;GetExpressions(getter_AddRefs(expressions));</span>
<a href="#l8.194"></a><span id="l8.194">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.195"></a><span id="l8.195" class="difflineminus">-  </span>
<a href="#l8.196"></a><span id="l8.196" class="difflineplus">+</span>
<a href="#l8.197"></a><span id="l8.197">   nsAbBooleanOperationType operation;</span>
<a href="#l8.198"></a><span id="l8.198">   rv = aExpression-&gt;GetOperation(&amp;operation);</span>
<a href="#l8.199"></a><span id="l8.199">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.200"></a><span id="l8.200" class="difflineminus">-  </span>
<a href="#l8.201"></a><span id="l8.201" class="difflineplus">+</span>
<a href="#l8.202"></a><span id="l8.202">   uint32_t count;</span>
<a href="#l8.203"></a><span id="l8.203">   rv = expressions-&gt;GetLength(&amp;count);</span>
<a href="#l8.204"></a><span id="l8.204">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.205"></a><span id="l8.205" class="difflineminus">-  </span>
<a href="#l8.206"></a><span id="l8.206" class="difflineplus">+</span>
<a href="#l8.207"></a><span id="l8.207">   NS_ASSERTION(count &gt; 1 &amp;&amp; operation != nsIAbBooleanOperationTypes::NOT,</span>
<a href="#l8.208"></a><span id="l8.208">                &quot;This doesn't make sense!&quot;);</span>
<a href="#l8.209"></a><span id="l8.209" class="difflineminus">-  </span>
<a href="#l8.210"></a><span id="l8.210" class="difflineplus">+</span>
<a href="#l8.211"></a><span id="l8.211">   NSMutableArray *array = nullptr;</span>
<a href="#l8.212"></a><span id="l8.212">   if (count &gt; 1)</span>
<a href="#l8.213"></a><span id="l8.213">     array = [[NSMutableArray alloc] init];</span>
<a href="#l8.214"></a><span id="l8.214" class="difflineminus">-  </span>
<a href="#l8.215"></a><span id="l8.215" class="difflineplus">+</span>
<a href="#l8.216"></a><span id="l8.216">   uint32_t i;</span>
<a href="#l8.217"></a><span id="l8.217">   nsCOMPtr&lt;nsIAbBooleanConditionString&gt; condition;</span>
<a href="#l8.218"></a><span id="l8.218">   nsCOMPtr&lt;nsIAbBooleanExpression&gt; subExpression;</span>
<a href="#l8.219"></a><span id="l8.219">   for (i = 0; i &lt; count; ++i) {</span>
<a href="#l8.220"></a><span id="l8.220">     ABSearchElement *element = nullptr;</span>
<a href="#l8.221"></a><span id="l8.221" class="difflineminus">-    </span>
<a href="#l8.222"></a><span id="l8.222" class="difflineplus">+</span>
<a href="#l8.223"></a><span id="l8.223">     condition = do_QueryElementAt(expressions, i);</span>
<a href="#l8.224"></a><span id="l8.224">     if (condition) {</span>
<a href="#l8.225"></a><span id="l8.225">       rv = MapConditionString(condition, operation == nsIAbBooleanOperationTypes::NOT, aCanHandle, &amp;element);</span>
<a href="#l8.226"></a><span id="l8.226">       if (NS_FAILED(rv))</span>
<a href="#l8.227"></a><span id="l8.227">         break;</span>
<a href="#l8.228"></a><span id="l8.228">     }</span>
<a href="#l8.229"></a><span id="l8.229">     else {</span>
<a href="#l8.230"></a><span id="l8.230">       subExpression = do_QueryElementAt(expressions, i);</span>
<a href="#l8.231"></a><span id="l8.231">       if (subExpression) {</span>
<a href="#l8.232"></a><span id="l8.232">         rv = BuildSearchElements(subExpression, aCanHandle, &amp;element);</span>
<a href="#l8.233"></a><span id="l8.233">         if (NS_FAILED(rv))</span>
<a href="#l8.234"></a><span id="l8.234">           break;</span>
<a href="#l8.235"></a><span id="l8.235">       }</span>
<a href="#l8.236"></a><span id="l8.236">     }</span>
<a href="#l8.237"></a><span id="l8.237" class="difflineminus">-    </span>
<a href="#l8.238"></a><span id="l8.238" class="difflineplus">+</span>
<a href="#l8.239"></a><span id="l8.239">     if (!aCanHandle) {</span>
<a href="#l8.240"></a><span id="l8.240">       // remember to free the array when returning early</span>
<a href="#l8.241"></a><span id="l8.241">       [array release];</span>
<a href="#l8.242"></a><span id="l8.242">       return NS_OK;</span>
<a href="#l8.243"></a><span id="l8.243">     }</span>
<a href="#l8.244"></a><span id="l8.244" class="difflineminus">-    </span>
<a href="#l8.245"></a><span id="l8.245" class="difflineplus">+</span>
<a href="#l8.246"></a><span id="l8.246">     if (element) {</span>
<a href="#l8.247"></a><span id="l8.247">       if (array)</span>
<a href="#l8.248"></a><span id="l8.248">         [array addObject:element];</span>
<a href="#l8.249"></a><span id="l8.249" class="difflineminus">-      else </span>
<a href="#l8.250"></a><span id="l8.250" class="difflineplus">+      else</span>
<a href="#l8.251"></a><span id="l8.251">         *aResult = element;</span>
<a href="#l8.252"></a><span id="l8.252">     }</span>
<a href="#l8.253"></a><span id="l8.253">   }</span>
<a href="#l8.254"></a><span id="l8.254" class="difflineminus">-  </span>
<a href="#l8.255"></a><span id="l8.255" class="difflineplus">+</span>
<a href="#l8.256"></a><span id="l8.256">   if (array) {</span>
<a href="#l8.257"></a><span id="l8.257">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l8.258"></a><span id="l8.258">       ABSearchConjunction conjunction = operation == nsIAbBooleanOperationTypes::AND ? kABSearchAnd : kABSearchOr;</span>
<a href="#l8.259"></a><span id="l8.259">       *aResult = [ABSearchElement searchElementForConjunction:conjunction children:array];</span>
<a href="#l8.260"></a><span id="l8.260">     }</span>
<a href="#l8.261"></a><span id="l8.261">     [array release];</span>
<a href="#l8.262"></a><span id="l8.262">   }</span>
<a href="#l8.263"></a><span id="l8.263" class="difflineminus">-  </span>
<a href="#l8.264"></a><span id="l8.264" class="difflineplus">+</span>
<a href="#l8.265"></a><span id="l8.265">   return rv;</span>
<a href="#l8.266"></a><span id="l8.266"> }</span>
<a href="#l8.267"></a><span id="l8.267"> </span>
<a href="#l8.268"></a><span id="l8.268"> static bool</span>
<a href="#l8.269"></a><span id="l8.269"> Search(nsIAbBooleanExpression *aExpression, NSArray **aResult)</span>
<a href="#l8.270"></a><span id="l8.270"> {</span>
<a href="#l8.271"></a><span id="l8.271">   bool canHandle = false;</span>
<a href="#l8.272"></a><span id="l8.272">   ABSearchElement *searchElement;</span>
<a href="#l8.273"></a><span id="l8.273">   nsresult rv = BuildSearchElements(aExpression, canHandle, &amp;searchElement);</span>
<a href="#l8.274"></a><span id="l8.274">   NS_ENSURE_SUCCESS(rv, false);</span>
<a href="#l8.275"></a><span id="l8.275" class="difflineminus">-  </span>
<a href="#l8.276"></a><span id="l8.276" class="difflineplus">+</span>
<a href="#l8.277"></a><span id="l8.277">   if (canHandle)</span>
<a href="#l8.278"></a><span id="l8.278">     *aResult = [[ABAddressBook sharedAddressBook] recordsMatchingSearchElement:searchElement];</span>
<a href="#l8.279"></a><span id="l8.279"> </span>
<a href="#l8.280"></a><span id="l8.280">   return canHandle;</span>
<a href="#l8.281"></a><span id="l8.281"> }</span>
<a href="#l8.282"></a><span id="l8.282"> </span>
<a href="#l8.283"></a><span id="l8.283"> static uint32_t sObserverCount = 0;</span>
<a href="#l8.284"></a><span id="l8.284"> static ABChangedMonitor *sObserver = nullptr;</span>
<a href="#l8.285"></a><span id="l8.285" class="difflineat">@@ -600,30 +600,30 @@ CheckRedundantCards(nsIAbManager *aManag</span>
<a href="#l8.286"></a><span id="l8.286">   nsresult rv;</span>
<a href="#l8.287"></a><span id="l8.287">   nsCOMPtr&lt;nsIAbOSXCard&gt; osxCard = do_QueryInterface(aCard, &amp;rv);</span>
<a href="#l8.288"></a><span id="l8.288">   NS_ENSURE_SUCCESS(rv, false);</span>
<a href="#l8.289"></a><span id="l8.289"> </span>
<a href="#l8.290"></a><span id="l8.290">   nsAutoCString uri;</span>
<a href="#l8.291"></a><span id="l8.291">   rv = osxCard-&gt;GetURI(uri);</span>
<a href="#l8.292"></a><span id="l8.292">   NS_ENSURE_SUCCESS(rv, false);</span>
<a href="#l8.293"></a><span id="l8.293">   NSString *uid = [NSString stringWithUTF8String:(uri.get() + 21)];</span>
<a href="#l8.294"></a><span id="l8.294" class="difflineminus">-  </span>
<a href="#l8.295"></a><span id="l8.295" class="difflineplus">+</span>
<a href="#l8.296"></a><span id="l8.296">   unsigned int i, count = [aCardList count];</span>
<a href="#l8.297"></a><span id="l8.297">   for (i = 0; i &lt; count; ++i) {</span>
<a href="#l8.298"></a><span id="l8.298">     if ([[[aCardList objectAtIndex:i] uniqueId] isEqualToString:uid]) {</span>
<a href="#l8.299"></a><span id="l8.299">       [aCardList removeObjectAtIndex:i];</span>
<a href="#l8.300"></a><span id="l8.300">       break;</span>
<a href="#l8.301"></a><span id="l8.301">     }</span>
<a href="#l8.302"></a><span id="l8.302">   }</span>
<a href="#l8.303"></a><span id="l8.303"> </span>
<a href="#l8.304"></a><span id="l8.304">   if (i == count) {</span>
<a href="#l8.305"></a><span id="l8.305">     aManager-&gt;NotifyDirectoryItemDeleted(aDirectory, aCard);</span>
<a href="#l8.306"></a><span id="l8.306">     return true;</span>
<a href="#l8.307"></a><span id="l8.307">   }</span>
<a href="#l8.308"></a><span id="l8.308" class="difflineminus">-  </span>
<a href="#l8.309"></a><span id="l8.309" class="difflineplus">+</span>
<a href="#l8.310"></a><span id="l8.310">   return false;</span>
<a href="#l8.311"></a><span id="l8.311"> }</span>
<a href="#l8.312"></a><span id="l8.312"> </span>
<a href="#l8.313"></a><span id="l8.313"> nsresult</span>
<a href="#l8.314"></a><span id="l8.314"> nsAbOSXDirectory::GetRootOSXDirectory(nsIAbOSXDirectory **aResult)</span>
<a href="#l8.315"></a><span id="l8.315"> {</span>
<a href="#l8.316"></a><span id="l8.316">   if (!mCacheTopLevelOSXAb)</span>
<a href="#l8.317"></a><span id="l8.317">   {</span>
<a href="#l8.318"></a><span id="l8.318" class="difflineat">@@ -650,21 +650,21 @@ nsAbOSXDirectory::GetRootOSXDirectory(ns</span>
<a href="#l8.319"></a><span id="l8.319"> nsresult</span>
<a href="#l8.320"></a><span id="l8.320"> nsAbOSXDirectory::Update()</span>
<a href="#l8.321"></a><span id="l8.321"> {</span>
<a href="#l8.322"></a><span id="l8.322">   NS_OBJC_BEGIN_TRY_ABORT_BLOCK_NSRESULT;</span>
<a href="#l8.323"></a><span id="l8.323"> </span>
<a href="#l8.324"></a><span id="l8.324">   nsresult rv;</span>
<a href="#l8.325"></a><span id="l8.325">   nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l8.326"></a><span id="l8.326">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.327"></a><span id="l8.327" class="difflineminus">-  </span>
<a href="#l8.328"></a><span id="l8.328" class="difflineplus">+</span>
<a href="#l8.329"></a><span id="l8.329">   if (mIsQueryURI) {</span>
<a href="#l8.330"></a><span id="l8.330">     return NS_OK;</span>
<a href="#l8.331"></a><span id="l8.331">   }</span>
<a href="#l8.332"></a><span id="l8.332" class="difflineminus">-  </span>
<a href="#l8.333"></a><span id="l8.333" class="difflineplus">+</span>
<a href="#l8.334"></a><span id="l8.334">   ABAddressBook *addressBook = [ABAddressBook sharedAddressBook];</span>
<a href="#l8.335"></a><span id="l8.335">   // Due to the horrible way the address book code works wrt mailing lists</span>
<a href="#l8.336"></a><span id="l8.336">   // we have to use a different list depending on what we are. This pointer</span>
<a href="#l8.337"></a><span id="l8.337">   // holds a reference to that list.</span>
<a href="#l8.338"></a><span id="l8.338">   nsIMutableArray* cardList;</span>
<a href="#l8.339"></a><span id="l8.339">   NSArray *groups, *cards;</span>
<a href="#l8.340"></a><span id="l8.340">   if (m_IsMailList) {</span>
<a href="#l8.341"></a><span id="l8.341">     ABGroup *group = (ABGroup*)[addressBook recordForUniqueId:[NSString stringWithUTF8String:nsAutoCString(Substring(mURINoQuery, 21)).get()]];</span>
<a href="#l8.342"></a><span id="l8.342" class="difflineat">@@ -686,60 +686,60 @@ nsAbOSXDirectory::Update()</span>
<a href="#l8.343"></a><span id="l8.343">     if (!mCardList)</span>
<a href="#l8.344"></a><span id="l8.344">     {</span>
<a href="#l8.345"></a><span id="l8.345">       mCardList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.346"></a><span id="l8.346">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.347"></a><span id="l8.347">     }</span>
<a href="#l8.348"></a><span id="l8.348">     // For directories, store the cards in mCardList</span>
<a href="#l8.349"></a><span id="l8.349">     cardList = mCardList;</span>
<a href="#l8.350"></a><span id="l8.350">   }</span>
<a href="#l8.351"></a><span id="l8.351" class="difflineminus">-  </span>
<a href="#l8.352"></a><span id="l8.352" class="difflineplus">+</span>
<a href="#l8.353"></a><span id="l8.353">   NSMutableArray *mutableArray = [NSMutableArray arrayWithArray:cards];</span>
<a href="#l8.354"></a><span id="l8.354">   uint32_t addressCount;</span>
<a href="#l8.355"></a><span id="l8.355">   rv = cardList-&gt;GetLength(&amp;addressCount);</span>
<a href="#l8.356"></a><span id="l8.356">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.357"></a><span id="l8.357"> </span>
<a href="#l8.358"></a><span id="l8.358">   while (addressCount--)</span>
<a href="#l8.359"></a><span id="l8.359">   {</span>
<a href="#l8.360"></a><span id="l8.360">     nsCOMPtr&lt;nsIAbCard&gt; card(do_QueryElementAt(cardList, addressCount, &amp;rv));</span>
<a href="#l8.361"></a><span id="l8.361">     if (NS_FAILED(rv))</span>
<a href="#l8.362"></a><span id="l8.362">       break;</span>
<a href="#l8.363"></a><span id="l8.363"> </span>
<a href="#l8.364"></a><span id="l8.364">     if (CheckRedundantCards(abManager, this, card, mutableArray))</span>
<a href="#l8.365"></a><span id="l8.365">       cardList-&gt;RemoveElementAt(addressCount);</span>
<a href="#l8.366"></a><span id="l8.366">   }</span>
<a href="#l8.367"></a><span id="l8.367" class="difflineminus">-  </span>
<a href="#l8.368"></a><span id="l8.368" class="difflineplus">+</span>
<a href="#l8.369"></a><span id="l8.369">   NSEnumerator *enumerator = [mutableArray objectEnumerator];</span>
<a href="#l8.370"></a><span id="l8.370">   ABRecord *card;</span>
<a href="#l8.371"></a><span id="l8.371">   nsCOMPtr&lt;nsIAbCard&gt; abCard;</span>
<a href="#l8.372"></a><span id="l8.372">   nsCOMPtr&lt;nsIAbOSXDirectory&gt; rootOSXDirectory;</span>
<a href="#l8.373"></a><span id="l8.373">   rv = GetRootOSXDirectory(getter_AddRefs(rootOSXDirectory));</span>
<a href="#l8.374"></a><span id="l8.374">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.375"></a><span id="l8.375"> </span>
<a href="#l8.376"></a><span id="l8.376">   while ((card = [enumerator nextObject]))</span>
<a href="#l8.377"></a><span id="l8.377">   {</span>
<a href="#l8.378"></a><span id="l8.378">     rv = GetCard(card, getter_AddRefs(abCard), rootOSXDirectory);</span>
<a href="#l8.379"></a><span id="l8.379">     if (NS_FAILED(rv))</span>
<a href="#l8.380"></a><span id="l8.380">       rv = CreateCard(card, getter_AddRefs(abCard));</span>
<a href="#l8.381"></a><span id="l8.381">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.382"></a><span id="l8.382">     AssertCard(abManager, abCard);</span>
<a href="#l8.383"></a><span id="l8.383">   }</span>
<a href="#l8.384"></a><span id="l8.384" class="difflineminus">-  </span>
<a href="#l8.385"></a><span id="l8.385" class="difflineplus">+</span>
<a href="#l8.386"></a><span id="l8.386">   card = (ABRecord*)[addressBook recordForUniqueId:[NSString stringWithUTF8String:nsAutoCString(Substring(mURINoQuery, 21)).get()]];</span>
<a href="#l8.387"></a><span id="l8.387">   NSString * stringValue = [card valueForProperty:kABGroupNameProperty];</span>
<a href="#l8.388"></a><span id="l8.388">   if (![stringValue isEqualToString:WrapString(m_ListDirName)])</span>
<a href="#l8.389"></a><span id="l8.389">   {</span>
<a href="#l8.390"></a><span id="l8.390">     nsAutoString oldValue(m_ListDirName);</span>
<a href="#l8.391"></a><span id="l8.391">     AssignToString(stringValue, m_ListDirName);</span>
<a href="#l8.392"></a><span id="l8.392">     nsCOMPtr&lt;nsISupports&gt; supports = do_QueryInterface(static_cast&lt;nsIAbDirectory *&gt;(this), &amp;rv);</span>
<a href="#l8.393"></a><span id="l8.393">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.394"></a><span id="l8.394">     abManager-&gt;NotifyItemPropertyChanged(supports, &quot;DirName&quot;,</span>
<a href="#l8.395"></a><span id="l8.395">                                          oldValue.get(), m_ListDirName.get());</span>
<a href="#l8.396"></a><span id="l8.396">   }</span>
<a href="#l8.397"></a><span id="l8.397" class="difflineminus">-  </span>
<a href="#l8.398"></a><span id="l8.398" class="difflineplus">+</span>
<a href="#l8.399"></a><span id="l8.399">   if (groups)</span>
<a href="#l8.400"></a><span id="l8.400">   {</span>
<a href="#l8.401"></a><span id="l8.401">     mutableArray = [NSMutableArray arrayWithArray:groups];</span>
<a href="#l8.402"></a><span id="l8.402">     nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.403"></a><span id="l8.403">     // It is ok to use m_AddressList here as only top-level directories have</span>
<a href="#l8.404"></a><span id="l8.404">     // groups, and they will be in m_AddressList</span>
<a href="#l8.405"></a><span id="l8.405">     if (m_AddressList)</span>
<a href="#l8.406"></a><span id="l8.406">     {</span>
<a href="#l8.407"></a><span id="l8.407" class="difflineat">@@ -751,79 +751,79 @@ nsAbOSXDirectory::Update()</span>
<a href="#l8.408"></a><span id="l8.408">         directory = do_QueryElementAt(m_AddressList, addressCount, &amp;rv);</span>
<a href="#l8.409"></a><span id="l8.409">         if (NS_FAILED(rv))</span>
<a href="#l8.410"></a><span id="l8.410">           continue;</span>
<a href="#l8.411"></a><span id="l8.411"> </span>
<a href="#l8.412"></a><span id="l8.412">         nsAutoCString uri;</span>
<a href="#l8.413"></a><span id="l8.413">         directory-&gt;GetURI(uri);</span>
<a href="#l8.414"></a><span id="l8.414">         uri.Cut(0, 21);</span>
<a href="#l8.415"></a><span id="l8.415">         NSString *uid = [NSString stringWithUTF8String:uri.get()];</span>
<a href="#l8.416"></a><span id="l8.416" class="difflineminus">-        </span>
<a href="#l8.417"></a><span id="l8.417" class="difflineplus">+</span>
<a href="#l8.418"></a><span id="l8.418">         unsigned int j, arrayCount = [mutableArray count];</span>
<a href="#l8.419"></a><span id="l8.419">         for (j = 0; j &lt; arrayCount; ++j) {</span>
<a href="#l8.420"></a><span id="l8.420">           if ([[[mutableArray objectAtIndex:j] uniqueId] isEqualToString:uid]) {</span>
<a href="#l8.421"></a><span id="l8.421">             [mutableArray removeObjectAtIndex:j];</span>
<a href="#l8.422"></a><span id="l8.422">             break;</span>
<a href="#l8.423"></a><span id="l8.423">           }</span>
<a href="#l8.424"></a><span id="l8.424">         }</span>
<a href="#l8.425"></a><span id="l8.425" class="difflineminus">-        </span>
<a href="#l8.426"></a><span id="l8.426" class="difflineplus">+</span>
<a href="#l8.427"></a><span id="l8.427">         if (j == arrayCount) {</span>
<a href="#l8.428"></a><span id="l8.428">           UnassertDirectory(abManager, directory);</span>
<a href="#l8.429"></a><span id="l8.429">         }</span>
<a href="#l8.430"></a><span id="l8.430">       }</span>
<a href="#l8.431"></a><span id="l8.431">     }</span>
<a href="#l8.432"></a><span id="l8.432" class="difflineminus">-    </span>
<a href="#l8.433"></a><span id="l8.433" class="difflineplus">+</span>
<a href="#l8.434"></a><span id="l8.434">     enumerator = [mutableArray objectEnumerator];</span>
<a href="#l8.435"></a><span id="l8.435">     while ((card = [enumerator nextObject])) {</span>
<a href="#l8.436"></a><span id="l8.436">       rv = GetOrCreateGroup([card uniqueId], getter_AddRefs(directory));</span>
<a href="#l8.437"></a><span id="l8.437">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.438"></a><span id="l8.438" class="difflineminus">-      </span>
<a href="#l8.439"></a><span id="l8.439" class="difflineplus">+</span>
<a href="#l8.440"></a><span id="l8.440">       AssertDirectory(abManager, directory);</span>
<a href="#l8.441"></a><span id="l8.441">     }</span>
<a href="#l8.442"></a><span id="l8.442">   }</span>
<a href="#l8.443"></a><span id="l8.443" class="difflineminus">-  </span>
<a href="#l8.444"></a><span id="l8.444" class="difflineplus">+</span>
<a href="#l8.445"></a><span id="l8.445">   return NS_OK;</span>
<a href="#l8.446"></a><span id="l8.446"> </span>
<a href="#l8.447"></a><span id="l8.447">   NS_OBJC_END_TRY_ABORT_BLOCK_NSRESULT;</span>
<a href="#l8.448"></a><span id="l8.448"> }</span>
<a href="#l8.449"></a><span id="l8.449"> </span>
<a href="#l8.450"></a><span id="l8.450"> nsresult</span>
<a href="#l8.451"></a><span id="l8.451"> nsAbOSXDirectory::AssertChildNodes()</span>
<a href="#l8.452"></a><span id="l8.452"> {</span>
<a href="#l8.453"></a><span id="l8.453">   NS_OBJC_BEGIN_TRY_ABORT_BLOCK_NSRESULT;</span>
<a href="#l8.454"></a><span id="l8.454"> </span>
<a href="#l8.455"></a><span id="l8.455">   // Queries and mailing lists can't have childnodes.</span>
<a href="#l8.456"></a><span id="l8.456">   if (mIsQueryURI || m_IsMailList) {</span>
<a href="#l8.457"></a><span id="l8.457">     return NS_OK;</span>
<a href="#l8.458"></a><span id="l8.458">   }</span>
<a href="#l8.459"></a><span id="l8.459" class="difflineminus">-  </span>
<a href="#l8.460"></a><span id="l8.460" class="difflineplus">+</span>
<a href="#l8.461"></a><span id="l8.461">   nsresult rv;</span>
<a href="#l8.462"></a><span id="l8.462">   nsCOMPtr&lt;nsIAbManager&gt; abManager =</span>
<a href="#l8.463"></a><span id="l8.463">     do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l8.464"></a><span id="l8.464">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.465"></a><span id="l8.465" class="difflineminus">-  </span>
<a href="#l8.466"></a><span id="l8.466" class="difflineplus">+</span>
<a href="#l8.467"></a><span id="l8.467">   NSArray *groups = [[ABAddressBook sharedAddressBook] groups];</span>
<a href="#l8.468"></a><span id="l8.468" class="difflineminus">-  </span>
<a href="#l8.469"></a><span id="l8.469" class="difflineplus">+</span>
<a href="#l8.470"></a><span id="l8.470">   unsigned int i, count = [groups count];</span>
<a href="#l8.471"></a><span id="l8.471" class="difflineminus">-  </span>
<a href="#l8.472"></a><span id="l8.472" class="difflineplus">+</span>
<a href="#l8.473"></a><span id="l8.473">   if (count &gt; 0 &amp;&amp; !m_AddressList) {</span>
<a href="#l8.474"></a><span id="l8.474">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.475"></a><span id="l8.475">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.476"></a><span id="l8.476">   }</span>
<a href="#l8.477"></a><span id="l8.477" class="difflineminus">-  </span>
<a href="#l8.478"></a><span id="l8.478" class="difflineplus">+</span>
<a href="#l8.479"></a><span id="l8.479">   nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.480"></a><span id="l8.480">   for (i = 0; i &lt; count; ++i) {</span>
<a href="#l8.481"></a><span id="l8.481">     rv = GetOrCreateGroup([[groups objectAtIndex:i] uniqueId],</span>
<a href="#l8.482"></a><span id="l8.482">                           getter_AddRefs(directory));</span>
<a href="#l8.483"></a><span id="l8.483">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.484"></a><span id="l8.484" class="difflineminus">-    </span>
<a href="#l8.485"></a><span id="l8.485" class="difflineplus">+</span>
<a href="#l8.486"></a><span id="l8.486">     rv = AssertDirectory(abManager, directory);</span>
<a href="#l8.487"></a><span id="l8.487">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.488"></a><span id="l8.488">   }</span>
<a href="#l8.489"></a><span id="l8.489" class="difflineminus">-  </span>
<a href="#l8.490"></a><span id="l8.490" class="difflineplus">+</span>
<a href="#l8.491"></a><span id="l8.491">   return NS_OK;</span>
<a href="#l8.492"></a><span id="l8.492"> </span>
<a href="#l8.493"></a><span id="l8.493">   NS_OBJC_END_TRY_ABORT_BLOCK_NSRESULT;</span>
<a href="#l8.494"></a><span id="l8.494"> }</span>
<a href="#l8.495"></a><span id="l8.495"> </span>
<a href="#l8.496"></a><span id="l8.496"> nsresult</span>
<a href="#l8.497"></a><span id="l8.497"> nsAbOSXDirectory::AssertDirectory(nsIAbManager *aManager,</span>
<a href="#l8.498"></a><span id="l8.498">                                   nsIAbDirectory *aDirectory)</span>
<a href="#l8.499"></a><span id="l8.499" class="difflineat">@@ -834,17 +834,17 @@ nsAbOSXDirectory::AssertDirectory(nsIAbM</span>
<a href="#l8.500"></a><span id="l8.500">     // We already have this directory, so no point in adding it again.</span>
<a href="#l8.501"></a><span id="l8.501">     return NS_OK;</span>
<a href="#l8.502"></a><span id="l8.502"> </span>
<a href="#l8.503"></a><span id="l8.503">   nsresult rv;</span>
<a href="#l8.504"></a><span id="l8.504">   if (!m_AddressList) {</span>
<a href="#l8.505"></a><span id="l8.505">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.506"></a><span id="l8.506">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.507"></a><span id="l8.507">   }</span>
<a href="#l8.508"></a><span id="l8.508" class="difflineminus">-  </span>
<a href="#l8.509"></a><span id="l8.509" class="difflineplus">+</span>
<a href="#l8.510"></a><span id="l8.510">   rv = m_AddressList-&gt;AppendElement(aDirectory);</span>
<a href="#l8.511"></a><span id="l8.511">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.512"></a><span id="l8.512"> </span>
<a href="#l8.513"></a><span id="l8.513">   return aManager-&gt;NotifyDirectoryItemAdded(this, aDirectory);</span>
<a href="#l8.514"></a><span id="l8.514"> }</span>
<a href="#l8.515"></a><span id="l8.515"> </span>
<a href="#l8.516"></a><span id="l8.516"> nsresult</span>
<a href="#l8.517"></a><span id="l8.517"> nsAbOSXDirectory::AssertCard(nsIAbManager *aManager,</span>
<a href="#l8.518"></a><span id="l8.518" class="difflineat">@@ -874,17 +874,17 @@ nsAbOSXDirectory::AssertCard(nsIAbManage</span>
<a href="#l8.519"></a><span id="l8.519"> </span>
<a href="#l8.520"></a><span id="l8.520"> nsresult</span>
<a href="#l8.521"></a><span id="l8.521"> nsAbOSXDirectory::UnassertCard(nsIAbManager *aManager,</span>
<a href="#l8.522"></a><span id="l8.522">                                nsIAbCard *aCard,</span>
<a href="#l8.523"></a><span id="l8.523">                                nsIMutableArray *aCardList)</span>
<a href="#l8.524"></a><span id="l8.524"> {</span>
<a href="#l8.525"></a><span id="l8.525">   nsresult rv;</span>
<a href="#l8.526"></a><span id="l8.526">   uint32_t pos;</span>
<a href="#l8.527"></a><span id="l8.527" class="difflineminus">-  </span>
<a href="#l8.528"></a><span id="l8.528" class="difflineplus">+</span>
<a href="#l8.529"></a><span id="l8.529">   if (NS_SUCCEEDED(aCardList-&gt;IndexOf(0, aCard, &amp;pos)))</span>
<a href="#l8.530"></a><span id="l8.530">     rv = aCardList-&gt;RemoveElementAt(pos);</span>
<a href="#l8.531"></a><span id="l8.531"> </span>
<a href="#l8.532"></a><span id="l8.532">   return aManager-&gt;NotifyDirectoryItemDeleted(this, aCard);</span>
<a href="#l8.533"></a><span id="l8.533"> }</span>
<a href="#l8.534"></a><span id="l8.534"> </span>
<a href="#l8.535"></a><span id="l8.535"> nsresult</span>
<a href="#l8.536"></a><span id="l8.536"> nsAbOSXDirectory::UnassertDirectory(nsIAbManager *aManager,</span>
<a href="#l8.537"></a><span id="l8.537" class="difflineat">@@ -901,57 +901,57 @@ nsAbOSXDirectory::UnassertDirectory(nsIA</span>
<a href="#l8.538"></a><span id="l8.538"> </span>
<a href="#l8.539"></a><span id="l8.539">   return aManager-&gt;NotifyDirectoryItemDeleted(this, aDirectory);</span>
<a href="#l8.540"></a><span id="l8.540"> }</span>
<a href="#l8.541"></a><span id="l8.541"> </span>
<a href="#l8.542"></a><span id="l8.542"> NS_IMETHODIMP</span>
<a href="#l8.543"></a><span id="l8.543"> nsAbOSXDirectory::GetChildNodes(nsISimpleEnumerator **aNodes)</span>
<a href="#l8.544"></a><span id="l8.544"> {</span>
<a href="#l8.545"></a><span id="l8.545">   NS_ENSURE_ARG_POINTER(aNodes);</span>
<a href="#l8.546"></a><span id="l8.546" class="difflineminus">-  </span>
<a href="#l8.547"></a><span id="l8.547" class="difflineplus">+</span>
<a href="#l8.548"></a><span id="l8.548">   // Queries don't have childnodes.</span>
<a href="#l8.549"></a><span id="l8.549">   if (mIsQueryURI || m_IsMailList || !m_AddressList)</span>
<a href="#l8.550"></a><span id="l8.550">     return NS_NewEmptyEnumerator(aNodes);</span>
<a href="#l8.551"></a><span id="l8.551" class="difflineminus">-  </span>
<a href="#l8.552"></a><span id="l8.552" class="difflineplus">+</span>
<a href="#l8.553"></a><span id="l8.553">   return NS_NewArrayEnumerator(aNodes, m_AddressList);</span>
<a href="#l8.554"></a><span id="l8.554"> }</span>
<a href="#l8.555"></a><span id="l8.555"> </span>
<a href="#l8.556"></a><span id="l8.556"> NS_IMETHODIMP</span>
<a href="#l8.557"></a><span id="l8.557"> nsAbOSXDirectory::GetChildCards(nsISimpleEnumerator **aCards)</span>
<a href="#l8.558"></a><span id="l8.558"> {</span>
<a href="#l8.559"></a><span id="l8.559">   NS_OBJC_BEGIN_TRY_ABORT_BLOCK_NSRESULT;</span>
<a href="#l8.560"></a><span id="l8.560"> </span>
<a href="#l8.561"></a><span id="l8.561">   NS_ENSURE_ARG_POINTER(aCards);</span>
<a href="#l8.562"></a><span id="l8.562" class="difflineminus">-  </span>
<a href="#l8.563"></a><span id="l8.563" class="difflineplus">+</span>
<a href="#l8.564"></a><span id="l8.564">   nsresult rv;</span>
<a href="#l8.565"></a><span id="l8.565">   NSArray *cards;</span>
<a href="#l8.566"></a><span id="l8.566">   if (mIsQueryURI)</span>
<a href="#l8.567"></a><span id="l8.567">   {</span>
<a href="#l8.568"></a><span id="l8.568">     nsCOMPtr&lt;nsIAbBooleanExpression&gt; expression;</span>
<a href="#l8.569"></a><span id="l8.569">     rv = nsAbQueryStringToExpression::Convert(mQueryString,</span>
<a href="#l8.570"></a><span id="l8.570">                                               getter_AddRefs(expression));</span>
<a href="#l8.571"></a><span id="l8.571">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.572"></a><span id="l8.572" class="difflineminus">-    </span>
<a href="#l8.573"></a><span id="l8.573" class="difflineplus">+</span>
<a href="#l8.574"></a><span id="l8.574">     bool canHandle = !m_IsMailList &amp;&amp; Search(expression, &amp;cards);</span>
<a href="#l8.575"></a><span id="l8.575">     if (!canHandle)</span>
<a href="#l8.576"></a><span id="l8.576">       return FallbackSearch(expression, aCards);</span>
<a href="#l8.577"></a><span id="l8.577"> </span>
<a href="#l8.578"></a><span id="l8.578">     if (!mCardList)</span>
<a href="#l8.579"></a><span id="l8.579">       mCardList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.580"></a><span id="l8.580">     else</span>
<a href="#l8.581"></a><span id="l8.581">       mCardList-&gt;Clear();</span>
<a href="#l8.582"></a><span id="l8.582">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.583"></a><span id="l8.583" class="difflineminus">-  </span>
<a href="#l8.584"></a><span id="l8.584" class="difflineplus">+</span>
<a href="#l8.585"></a><span id="l8.585">     // The uuid for initializing cards</span>
<a href="#l8.586"></a><span id="l8.586">     nsAutoCString ourUuid;</span>
<a href="#l8.587"></a><span id="l8.587">     GetUuid(ourUuid);</span>
<a href="#l8.588"></a><span id="l8.588"> </span>
<a href="#l8.589"></a><span id="l8.589">     // Fill the results array and update the card list</span>
<a href="#l8.590"></a><span id="l8.590">     unsigned int nbCards = [cards count];</span>
<a href="#l8.591"></a><span id="l8.591" class="difflineminus">-  </span>
<a href="#l8.592"></a><span id="l8.592" class="difflineplus">+</span>
<a href="#l8.593"></a><span id="l8.593">     unsigned int i;</span>
<a href="#l8.594"></a><span id="l8.594">     nsCOMPtr&lt;nsIAbCard&gt; card;</span>
<a href="#l8.595"></a><span id="l8.595">     nsCOMPtr&lt;nsIAbOSXDirectory&gt; rootOSXDirectory;</span>
<a href="#l8.596"></a><span id="l8.596">     rv = GetRootOSXDirectory(getter_AddRefs(rootOSXDirectory));</span>
<a href="#l8.597"></a><span id="l8.597">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.598"></a><span id="l8.598"> </span>
<a href="#l8.599"></a><span id="l8.599">     for (i = 0; i &lt; nbCards; ++i)</span>
<a href="#l8.600"></a><span id="l8.600">     {</span>
<a href="#l8.601"></a><span id="l8.601" class="difflineat">@@ -1174,17 +1174,17 @@ nsAbOSXDirectory::HasCard(nsIAbCard *aCa</span>
<a href="#l8.602"></a><span id="l8.602"> }</span>
<a href="#l8.603"></a><span id="l8.603"> </span>
<a href="#l8.604"></a><span id="l8.604"> NS_IMETHODIMP</span>
<a href="#l8.605"></a><span id="l8.605"> nsAbOSXDirectory::HasDirectory(nsIAbDirectory *aDirectory,</span>
<a href="#l8.606"></a><span id="l8.606">                                bool *aHasDirectory)</span>
<a href="#l8.607"></a><span id="l8.607"> {</span>
<a href="#l8.608"></a><span id="l8.608">   NS_ENSURE_ARG_POINTER(aDirectory);</span>
<a href="#l8.609"></a><span id="l8.609">   NS_ENSURE_ARG_POINTER(aHasDirectory);</span>
<a href="#l8.610"></a><span id="l8.610" class="difflineminus">-  </span>
<a href="#l8.611"></a><span id="l8.611" class="difflineplus">+</span>
<a href="#l8.612"></a><span id="l8.612">   *aHasDirectory = false;</span>
<a href="#l8.613"></a><span id="l8.613"> </span>
<a href="#l8.614"></a><span id="l8.614">   uint32_t pos;</span>
<a href="#l8.615"></a><span id="l8.615">   if (m_AddressList &amp;&amp; NS_SUCCEEDED(m_AddressList-&gt;IndexOf(0, aDirectory, &amp;pos)))</span>
<a href="#l8.616"></a><span id="l8.616">     *aHasDirectory = true;</span>
<a href="#l8.617"></a><span id="l8.617"> </span>
<a href="#l8.618"></a><span id="l8.618">   return NS_OK;</span>
<a href="#l8.619"></a><span id="l8.619"> }</span>
<a href="#l8.620"></a><span id="l8.620" class="difflineat">@@ -1198,90 +1198,90 @@ nsAbOSXDirectory::OnSearchFinished(int32</span>
<a href="#l8.621"></a><span id="l8.621"> NS_IMETHODIMP</span>
<a href="#l8.622"></a><span id="l8.622"> nsAbOSXDirectory::OnSearchFoundCard(nsIAbCard *aCard)</span>
<a href="#l8.623"></a><span id="l8.623"> {</span>
<a href="#l8.624"></a><span id="l8.624">   nsresult rv;</span>
<a href="#l8.625"></a><span id="l8.625">   if (!m_AddressList) {</span>
<a href="#l8.626"></a><span id="l8.626">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.627"></a><span id="l8.627">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.628"></a><span id="l8.628">   }</span>
<a href="#l8.629"></a><span id="l8.629" class="difflineminus">-  </span>
<a href="#l8.630"></a><span id="l8.630" class="difflineplus">+</span>
<a href="#l8.631"></a><span id="l8.631">   if (!mCardList) {</span>
<a href="#l8.632"></a><span id="l8.632">     mCardList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.633"></a><span id="l8.633">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.634"></a><span id="l8.634">   }</span>
<a href="#l8.635"></a><span id="l8.635"> </span>
<a href="#l8.636"></a><span id="l8.636">   rv = m_AddressList-&gt;AppendElement(aCard);</span>
<a href="#l8.637"></a><span id="l8.637">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.638"></a><span id="l8.638" class="difflineminus">-  </span>
<a href="#l8.639"></a><span id="l8.639" class="difflineplus">+</span>
<a href="#l8.640"></a><span id="l8.640">   rv = mCardList-&gt;AppendElement(aCard);</span>
<a href="#l8.641"></a><span id="l8.641">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.642"></a><span id="l8.642"> </span>
<a href="#l8.643"></a><span id="l8.643">   nsAutoCString ourUuid;</span>
<a href="#l8.644"></a><span id="l8.644">   GetUuid(ourUuid);</span>
<a href="#l8.645"></a><span id="l8.645">   aCard-&gt;SetDirectoryId(ourUuid);</span>
<a href="#l8.646"></a><span id="l8.646" class="difflineminus">-  </span>
<a href="#l8.647"></a><span id="l8.647" class="difflineplus">+</span>
<a href="#l8.648"></a><span id="l8.648">   return NS_OK;</span>
<a href="#l8.649"></a><span id="l8.649"> }</span>
<a href="#l8.650"></a><span id="l8.650"> </span>
<a href="#l8.651"></a><span id="l8.651"> nsresult</span>
<a href="#l8.652"></a><span id="l8.652"> nsAbOSXDirectory::FallbackSearch(nsIAbBooleanExpression *aExpression,</span>
<a href="#l8.653"></a><span id="l8.653">                                  nsISimpleEnumerator **aCards)</span>
<a href="#l8.654"></a><span id="l8.654"> {</span>
<a href="#l8.655"></a><span id="l8.655">   nsresult rv;</span>
<a href="#l8.656"></a><span id="l8.656" class="difflineminus">-  </span>
<a href="#l8.657"></a><span id="l8.657" class="difflineplus">+</span>
<a href="#l8.658"></a><span id="l8.658">   if (mCardList)</span>
<a href="#l8.659"></a><span id="l8.659">     rv = mCardList-&gt;Clear();</span>
<a href="#l8.660"></a><span id="l8.660">   else</span>
<a href="#l8.661"></a><span id="l8.661">     mCardList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.662"></a><span id="l8.662">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.663"></a><span id="l8.663" class="difflineminus">-  </span>
<a href="#l8.664"></a><span id="l8.664" class="difflineplus">+</span>
<a href="#l8.665"></a><span id="l8.665">   if (m_AddressList) {</span>
<a href="#l8.666"></a><span id="l8.666">     m_AddressList-&gt;Clear();</span>
<a href="#l8.667"></a><span id="l8.667">   }</span>
<a href="#l8.668"></a><span id="l8.668">   else {</span>
<a href="#l8.669"></a><span id="l8.669">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.670"></a><span id="l8.670">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.671"></a><span id="l8.671">   }</span>
<a href="#l8.672"></a><span id="l8.672" class="difflineminus">-  </span>
<a href="#l8.673"></a><span id="l8.673" class="difflineplus">+</span>
<a href="#l8.674"></a><span id="l8.674">   nsCOMPtr&lt;nsIAbDirectoryQueryArguments&gt; arguments =</span>
<a href="#l8.675"></a><span id="l8.675">     do_CreateInstance(NS_ABDIRECTORYQUERYARGUMENTS_CONTRACTID, &amp;rv);</span>
<a href="#l8.676"></a><span id="l8.676">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.677"></a><span id="l8.677" class="difflineminus">-  </span>
<a href="#l8.678"></a><span id="l8.678" class="difflineplus">+</span>
<a href="#l8.679"></a><span id="l8.679">   rv = arguments-&gt;SetExpression(aExpression);</span>
<a href="#l8.680"></a><span id="l8.680">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.681"></a><span id="l8.681" class="difflineminus">-  </span>
<a href="#l8.682"></a><span id="l8.682" class="difflineplus">+</span>
<a href="#l8.683"></a><span id="l8.683">   // Don't search the subdirectories. If the current directory is a mailing</span>
<a href="#l8.684"></a><span id="l8.684">   // list, it won't have any subdirectories. If the current directory is an</span>
<a href="#l8.685"></a><span id="l8.685">   // addressbook, searching both it and the subdirectories (the mailing</span>
<a href="#l8.686"></a><span id="l8.686">   // lists), will yield duplicate results because every entry in a mailing</span>
<a href="#l8.687"></a><span id="l8.687">   // list will be an entry in the parent addressbook.</span>
<a href="#l8.688"></a><span id="l8.688">   rv = arguments-&gt;SetQuerySubDirectories(false);</span>
<a href="#l8.689"></a><span id="l8.689">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.690"></a><span id="l8.690" class="difflineminus">-  </span>
<a href="#l8.691"></a><span id="l8.691" class="difflineplus">+</span>
<a href="#l8.692"></a><span id="l8.692">   // Get the directory without the query</span>
<a href="#l8.693"></a><span id="l8.693">   nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l8.694"></a><span id="l8.694">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.695"></a><span id="l8.695"> </span>
<a href="#l8.696"></a><span id="l8.696">   nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.697"></a><span id="l8.697">   rv = abManager-&gt;GetDirectory(mURINoQuery, getter_AddRefs(directory));</span>
<a href="#l8.698"></a><span id="l8.698">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.699"></a><span id="l8.699"> </span>
<a href="#l8.700"></a><span id="l8.700">   // Initiate the proxy query with the no query directory</span>
<a href="#l8.701"></a><span id="l8.701" class="difflineminus">-  nsCOMPtr&lt;nsIAbDirectoryQueryProxy&gt; queryProxy = </span>
<a href="#l8.702"></a><span id="l8.702" class="difflineplus">+  nsCOMPtr&lt;nsIAbDirectoryQueryProxy&gt; queryProxy =</span>
<a href="#l8.703"></a><span id="l8.703">     do_CreateInstance(NS_ABDIRECTORYQUERYPROXY_CONTRACTID, &amp;rv);</span>
<a href="#l8.704"></a><span id="l8.704">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.705"></a><span id="l8.705" class="difflineminus">-  </span>
<a href="#l8.706"></a><span id="l8.706" class="difflineplus">+</span>
<a href="#l8.707"></a><span id="l8.707">   rv = queryProxy-&gt;Initiate();</span>
<a href="#l8.708"></a><span id="l8.708">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.709"></a><span id="l8.709" class="difflineminus">-  </span>
<a href="#l8.710"></a><span id="l8.710" class="difflineplus">+</span>
<a href="#l8.711"></a><span id="l8.711">   int32_t context = 0;</span>
<a href="#l8.712"></a><span id="l8.712">   rv = queryProxy-&gt;DoQuery(directory, arguments, this, -1, 0, &amp;context);</span>
<a href="#l8.713"></a><span id="l8.713">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.714"></a><span id="l8.714" class="difflineminus">-  </span>
<a href="#l8.715"></a><span id="l8.715" class="difflineplus">+</span>
<a href="#l8.716"></a><span id="l8.716">   return NS_NewArrayEnumerator(aCards, m_AddressList);</span>
<a href="#l8.717"></a><span id="l8.717"> }</span>
<a href="#l8.718"></a><span id="l8.718"> </span>
<a href="#l8.719"></a><span id="l8.719"> nsresult nsAbOSXDirectory::DeleteUid(const nsACString &amp;aUid)</span>
<a href="#l8.720"></a><span id="l8.720"> {</span>
<a href="#l8.721"></a><span id="l8.721">   if (!m_AddressList)</span>
<a href="#l8.722"></a><span id="l8.722">     return NS_ERROR_NULL_POINTER;</span>
<a href="#l8.723"></a><span id="l8.723"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/content/folderWidgets.xml</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/content/folderWidgets.xml</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -209,17 +209,17 @@</span>
<a href="#l9.4"></a><span id="l9.4">           if (this._filterFunction &amp;&amp; !this._filterFunction(aItem)) {</span>
<a href="#l9.5"></a><span id="l9.5">             return;</span>
<a href="#l9.6"></a><span id="l9.6">           }</span>
<a href="#l9.7"></a><span id="l9.7">           //xxx we can optimize this later</span>
<a href="#l9.8"></a><span id="l9.8">           //xxx I'm not quite sure why this isn't always a function</span>
<a href="#l9.9"></a><span id="l9.9">           if (this._menu._teardown)</span>
<a href="#l9.10"></a><span id="l9.10">             this._menu._teardown();</span>
<a href="#l9.11"></a><span id="l9.11">         },</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  </span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+</span>
<a href="#l9.14"></a><span id="l9.14">         OnItemRemoved: function act_remove(aRDFParentItem, aItem) {</span>
<a href="#l9.15"></a><span id="l9.15">           if (!(aItem instanceof Ci.nsIMsgFolder))</span>
<a href="#l9.16"></a><span id="l9.16">             return;</span>
<a href="#l9.17"></a><span id="l9.17">           if (this._filterFunction &amp;&amp; !this._filterFunction(aItem)) {</span>
<a href="#l9.18"></a><span id="l9.18">             return;</span>
<a href="#l9.19"></a><span id="l9.19">           }</span>
<a href="#l9.20"></a><span id="l9.20">           //xxx we can optimize this later</span>
<a href="#l9.21"></a><span id="l9.21">           if (this._menu._teardown)</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -288,17 +288,17 @@</span>
<a href="#l9.23"></a><span id="l9.23">              let folder = aMenu.childNodes[i]._folder;</span>
<a href="#l9.24"></a><span id="l9.24">              if (folder &amp;&amp; folder.URI == aItem.URI)</span>
<a href="#l9.25"></a><span id="l9.25">                return aMenu.childNodes[i];</span>
<a href="#l9.26"></a><span id="l9.26">            }</span>
<a href="#l9.27"></a><span id="l9.27">            return null;</span>
<a href="#l9.28"></a><span id="l9.28">         }</span>
<a href="#l9.29"></a><span id="l9.29">       })]]&gt;&lt;/field&gt;</span>
<a href="#l9.30"></a><span id="l9.30"> </span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-      &lt;!-- </span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+      &lt;!--</span>
<a href="#l9.33"></a><span id="l9.33">          - True if we have already built our menu-items and are now just</span>
<a href="#l9.34"></a><span id="l9.34">          - listening for changes</span>
<a href="#l9.35"></a><span id="l9.35">         --&gt;</span>
<a href="#l9.36"></a><span id="l9.36">       &lt;field name=&quot;_initialized&quot;&gt;false&lt;/field&gt;</span>
<a href="#l9.37"></a><span id="l9.37"> </span>
<a href="#l9.38"></a><span id="l9.38">       &lt;!--</span>
<a href="#l9.39"></a><span id="l9.39">          - Call this if you are unsure whether the menu-items have been built,</span>
<a href="#l9.40"></a><span id="l9.40">          - but know that they need to be built now if they haven't.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/content/junkMailInfo.xul</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/content/junkMailInfo.xul</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -7,17 +7,17 @@</span>
<a href="#l10.4"></a><span id="l10.4"> &lt;!DOCTYPE dialog [</span>
<a href="#l10.5"></a><span id="l10.5"> &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot; &gt;</span>
<a href="#l10.6"></a><span id="l10.6"> %brandDTD;</span>
<a href="#l10.7"></a><span id="l10.7"> &lt;!ENTITY % junkMailInfoDTD SYSTEM &quot;chrome://messenger/locale/junkMailInfo.dtd&quot; &gt;</span>
<a href="#l10.8"></a><span id="l10.8"> %junkMailInfoDTD;</span>
<a href="#l10.9"></a><span id="l10.9"> ]&gt;</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/messenger.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/primaryToolbar.css&quot; type=&quot;text/css&quot;?&gt; </span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/primaryToolbar.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.14"></a><span id="l10.14"> </span>
<a href="#l10.15"></a><span id="l10.15"> &lt;dialog id=&quot;junkMailInfo&quot;</span>
<a href="#l10.16"></a><span id="l10.16">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l10.17"></a><span id="l10.17">         title=&quot;&amp;window.title;&quot;</span>
<a href="#l10.18"></a><span id="l10.18">         windowtype=&quot;mailnews:junkmailinfo&quot;</span>
<a href="#l10.19"></a><span id="l10.19">         buttons=&quot;accept&quot;&gt;</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21">   &lt;vbox flex=&quot;1&quot; width=&quot;&amp;window.width;&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/content/msgAccountCentral.xul</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/content/msgAccountCentral.xul</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l11.6"></a><span id="l11.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.7"></a><span id="l11.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.8"></a><span id="l11.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/accountCentral.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12"> &lt;!DOCTYPE page [</span>
<a href="#l11.13"></a><span id="l11.13">   &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/content/shutdownWindow.xul</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/content/shutdownWindow.xul</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -10,22 +10,22 @@</span>
<a href="#l12.4"></a><span id="l12.4"> &lt;dialog xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l12.5"></a><span id="l12.5">         style=&quot;padding: 20px; width: 350px&quot;</span>
<a href="#l12.6"></a><span id="l12.6">         onload=&quot;onLoad()&quot;</span>
<a href="#l12.7"></a><span id="l12.7">         buttons=&quot;cancel&quot;</span>
<a href="#l12.8"></a><span id="l12.8">         ondialogcancel=&quot;return onCancel();&quot;&gt;</span>
<a href="#l12.9"></a><span id="l12.9"> </span>
<a href="#l12.10"></a><span id="l12.10">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/shutdownWindow.js&quot;/&gt;</span>
<a href="#l12.11"></a><span id="l12.11">   &lt;stringbundle id=&quot;bundle_shutdown&quot; src=&quot;chrome://messenger/locale/shutdownWindow.properties&quot;/&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  </span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+</span>
<a href="#l12.14"></a><span id="l12.14">   &lt;vbox align=&quot;center&quot;&gt;</span>
<a href="#l12.15"></a><span id="l12.15">     &lt;label id=&quot;shutdownStatus_label&quot; value=&quot;&quot; /&gt;</span>
<a href="#l12.16"></a><span id="l12.16">     &lt;separator class=&quot;thin&quot; /&gt;</span>
<a href="#l12.17"></a><span id="l12.17">   &lt;/vbox&gt;</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  </span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+</span>
<a href="#l12.20"></a><span id="l12.20">   &lt;progressmeter id=&quot;shutdown_progressmeter&quot; mode=&quot;determined&quot; /&gt;</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-  </span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+</span>
<a href="#l12.23"></a><span id="l12.23">   &lt;vbox align=&quot;center&quot;&gt;</span>
<a href="#l12.24"></a><span id="l12.24">     &lt;label id=&quot;shutdownTask_label&quot; value=&quot;&quot; /&gt;</span>
<a href="#l12.25"></a><span id="l12.25">     &lt;separator class=&quot;thick&quot; /&gt;</span>
<a href="#l12.26"></a><span id="l12.26">   &lt;/vbox&gt;</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-  </span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+</span>
<a href="#l12.29"></a><span id="l12.29"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/prefs/content/AccountWizard.xul</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/prefs/content/AccountWizard.xul</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -43,17 +43,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">       &lt;label control=&quot;acctyperadio&quot;&gt;&amp;accountTypeDirections.label;&lt;/label&gt;</span>
<a href="#l13.5"></a><span id="l13.5">       &lt;separator/&gt;</span>
<a href="#l13.6"></a><span id="l13.6">       &lt;radiogroup id=&quot;acctyperadio&quot; &gt;</span>
<a href="#l13.7"></a><span id="l13.7"> #ifndef MOZ_THUNDERBIRD</span>
<a href="#l13.8"></a><span id="l13.8">         &lt;radio id=&quot;mailaccount&quot; value=&quot;mailaccount&quot;</span>
<a href="#l13.9"></a><span id="l13.9">                label=&quot;&amp;accountTypeMail.label;&quot; accesskey=&quot;&amp;accountTypeMail.accesskey;&quot;</span>
<a href="#l13.10"></a><span id="l13.10">                selected=&quot;true&quot;/&gt;</span>
<a href="#l13.11"></a><span id="l13.11"> #endif</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-        &lt;vbox datasources=&quot;rdf:ispdefaults&quot; </span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+        &lt;vbox datasources=&quot;rdf:ispdefaults&quot;</span>
<a href="#l13.14"></a><span id="l13.14">               containment=&quot;http://home.netscape.com/NC-rdf#providers&quot;</span>
<a href="#l13.15"></a><span id="l13.15">               id=&quot;ispBox&quot;</span>
<a href="#l13.16"></a><span id="l13.16">               ref=&quot;NC:ispinfo&quot;&gt;</span>
<a href="#l13.17"></a><span id="l13.17">           &lt;template&gt;</span>
<a href="#l13.18"></a><span id="l13.18">             &lt;rule nc:wizardShow=&quot;true&quot;&gt;</span>
<a href="#l13.19"></a><span id="l13.19">               &lt;radio uri=&quot;...&quot;</span>
<a href="#l13.20"></a><span id="l13.20">                      value=&quot;rdf:http://home.netscape.com/NC-rdf#wizardShortName&quot;</span>
<a href="#l13.21"></a><span id="l13.21">                      label=&quot;rdf:http://home.netscape.com/NC-rdf#wizardLongName&quot;</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -77,24 +77,24 @@</span>
<a href="#l13.23"></a><span id="l13.23">       &lt;separator/&gt;</span>
<a href="#l13.24"></a><span id="l13.24">       &lt;description&gt;&amp;fullnameDesc.label; &amp;fullnameExample.label;&lt;/description&gt;</span>
<a href="#l13.25"></a><span id="l13.25">       &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l13.26"></a><span id="l13.26">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l13.27"></a><span id="l13.27">         &lt;label class=&quot;awIdentityLabel&quot; value=&quot;&amp;fullnameLabel.label;&quot;</span>
<a href="#l13.28"></a><span id="l13.28">                accesskey=&quot;&amp;fullnameLabel.accesskey;&quot; control=&quot;fullName&quot;/&gt;</span>
<a href="#l13.29"></a><span id="l13.29">         &lt;textbox mailtype=&quot;identity&quot; wsm_persist=&quot;true&quot; name=&quot;fullName&quot; id=&quot;fullName&quot; flex=&quot;1&quot; oninput=&quot;identityPageValidate();&quot;/&gt;</span>
<a href="#l13.30"></a><span id="l13.30">       &lt;/hbox&gt;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-      &lt;separator/&gt;  </span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+      &lt;separator/&gt;</span>
<a href="#l13.33"></a><span id="l13.33">       &lt;grid&gt;</span>
<a href="#l13.34"></a><span id="l13.34">         &lt;columns&gt;</span>
<a href="#l13.35"></a><span id="l13.35">           &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l13.36"></a><span id="l13.36">         &lt;/columns&gt;</span>
<a href="#l13.37"></a><span id="l13.37">         &lt;rows&gt;</span>
<a href="#l13.38"></a><span id="l13.38">           &lt;row&gt;</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineminus">-            &lt;description id=&quot;emailDescText&quot;/&gt; </span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+            &lt;description id=&quot;emailDescText&quot;/&gt;</span>
<a href="#l13.41"></a><span id="l13.41">           &lt;/row&gt;</span>
<a href="#l13.42"></a><span id="l13.42">           &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l13.43"></a><span id="l13.43">           &lt;row&gt;</span>
<a href="#l13.44"></a><span id="l13.44">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l13.45"></a><span id="l13.45">               &lt;label class=&quot;awIdentityLabel&quot; id=&quot;emailFieldLabel&quot; value=&quot;&amp;emailLabel.label;&quot;</span>
<a href="#l13.46"></a><span id="l13.46">                      accesskey=&quot;&amp;emailLabel.accesskey;&quot; control=&quot;email&quot;/&gt;</span>
<a href="#l13.47"></a><span id="l13.47">               &lt;hbox class=&quot;uri-element&quot; align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l13.48"></a><span id="l13.48">                 &lt;textbox wsm_persist=&quot;true&quot; mailtype=&quot;identity&quot; name=&quot;email&quot;</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineat">@@ -119,22 +119,22 @@</span>
<a href="#l13.50"></a><span id="l13.50">               onpageadvanced=&quot;return incomingPageUnload();&quot;&gt;</span>
<a href="#l13.51"></a><span id="l13.51">     &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l13.52"></a><span id="l13.52">         &lt;vbox id=&quot;serverTypeBox&quot;&gt;</span>
<a href="#l13.53"></a><span id="l13.53">         &lt;label control=&quot;servertype&quot;&gt;&amp;incomingServerTypeDesc.label;&lt;/label&gt;</span>
<a href="#l13.54"></a><span id="l13.54">           &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l13.55"></a><span id="l13.55">           &lt;hbox align=&quot;center&quot; class=&quot;serverDataBox&quot;&gt;</span>
<a href="#l13.56"></a><span id="l13.56">             &lt;!-- The initial value for the servertype radiogroup is set in onInit() --&gt;</span>
<a href="#l13.57"></a><span id="l13.57">             &lt;radiogroup id=&quot;servertype&quot; wsm_persist=&quot;true&quot; orient=&quot;horizontal&quot;&gt;</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineminus">-                &lt;radio group=&quot;servertype&quot; value=&quot;pop3&quot; id=&quot;pop3&quot; label=&quot;&amp;popType.label;&quot; </span>
<a href="#l13.59"></a><span id="l13.59" class="difflineplus">+                &lt;radio group=&quot;servertype&quot; value=&quot;pop3&quot; id=&quot;pop3&quot; label=&quot;&amp;popType.label;&quot;</span>
<a href="#l13.60"></a><span id="l13.60">                        wsm_persist=&quot;true&quot; oncommand=&quot;setServerType();&quot; accesskey=&quot;&amp;popType.accesskey;&quot;/&gt;</span>
<a href="#l13.61"></a><span id="l13.61">                 &lt;radio group=&quot;servertype&quot; value=&quot;imap&quot; id=&quot;imap&quot; label=&quot;&amp;imapType.label;&quot;</span>
<a href="#l13.62"></a><span id="l13.62">                        wsm_persist=&quot;true&quot; oncommand=&quot;setServerType();&quot; accesskey=&quot;&amp;imapType.accesskey;&quot;/&gt;</span>
<a href="#l13.63"></a><span id="l13.63">             &lt;/radiogroup&gt;</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineminus">-            &lt;label id=&quot;serverPortLabel&quot; control=&quot;serverPort&quot; </span>
<a href="#l13.65"></a><span id="l13.65" class="difflineplus">+            &lt;label id=&quot;serverPortLabel&quot; control=&quot;serverPort&quot;</span>
<a href="#l13.66"></a><span id="l13.66">                    accesskey=&quot;&amp;portNum.accesskey;&quot;</span>
<a href="#l13.67"></a><span id="l13.67">                    value=&quot;&amp;portNum.label;&quot;/&gt;</span>
<a href="#l13.68"></a><span id="l13.68">             &lt;textbox id=&quot;serverPort&quot; type=&quot;number&quot; size=&quot;3&quot; max=&quot;65535&quot;/&gt;</span>
<a href="#l13.69"></a><span id="l13.69">             &lt;label id=&quot;defaultPortLabel&quot; value=&quot;&amp;defaultPortLabel.label;&quot;/&gt;</span>
<a href="#l13.70"></a><span id="l13.70">             &lt;label id=&quot;defaultPortValue&quot; value=&quot;&amp;defaultPortValue.label;&quot;/&gt;</span>
<a href="#l13.71"></a><span id="l13.71">           &lt;/hbox&gt;</span>
<a href="#l13.72"></a><span id="l13.72">           &lt;separator/&gt;</span>
<a href="#l13.73"></a><span id="l13.73">         &lt;/vbox&gt;</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineat">@@ -263,33 +263,33 @@</span>
<a href="#l13.75"></a><span id="l13.75">                  class=&quot;uri-element&quot;</span>
<a href="#l13.76"></a><span id="l13.76">                  oninput=&quot;incomingPageValidate();&quot;/&gt;</span>
<a href="#l13.77"></a><span id="l13.77">       &lt;/hbox&gt;</span>
<a href="#l13.78"></a><span id="l13.78">     &lt;/vbox&gt;</span>
<a href="#l13.79"></a><span id="l13.79">   &lt;/wizardpage&gt;</span>
<a href="#l13.80"></a><span id="l13.80"> </span>
<a href="#l13.81"></a><span id="l13.81">   &lt;!-- Account name page : User gets a choice to enter a pretty name for the account --&gt;</span>
<a href="#l13.82"></a><span id="l13.82">   &lt;!-- Defaults : Mail account -&gt; Email address, Newsgroup account -&gt; Newsgroup server name --&gt;</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineminus">-  &lt;wizardpage id=&quot;accnamepage&quot; pageid=&quot;accnamepage&quot; </span>
<a href="#l13.84"></a><span id="l13.84" class="difflineplus">+  &lt;wizardpage id=&quot;accnamepage&quot; pageid=&quot;accnamepage&quot;</span>
<a href="#l13.85"></a><span id="l13.85">               label=&quot;&amp;accnameTitle.label;&quot;</span>
<a href="#l13.86"></a><span id="l13.86">               onpageshow=&quot;return acctNamePageInit();&quot;</span>
<a href="#l13.87"></a><span id="l13.87">               onpageadvanced=&quot;return acctNamePageUnload();&quot;&gt;</span>
<a href="#l13.88"></a><span id="l13.88">     &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l13.89"></a><span id="l13.89">       &lt;description&gt;&amp;accnameDesc.label;&lt;/description&gt;</span>
<a href="#l13.90"></a><span id="l13.90">       &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l13.91"></a><span id="l13.91">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l13.92"></a><span id="l13.92">         &lt;label class=&quot;label&quot; value=&quot;&amp;accnameLabel.label;&quot; style=&quot;width: 8em;&quot;</span>
<a href="#l13.93"></a><span id="l13.93">                accesskey=&quot;&amp;accnameLabel.accesskey;&quot; control=&quot;prettyName&quot;/&gt;</span>
<a href="#l13.94"></a><span id="l13.94">         &lt;textbox id=&quot;prettyName&quot; size=&quot;40&quot; wsm_persist=&quot;true&quot; flex=&quot;1&quot; oninput=&quot;acctNamePageValidate();&quot;/&gt;</span>
<a href="#l13.95"></a><span id="l13.95">       &lt;/hbox&gt;</span>
<a href="#l13.96"></a><span id="l13.96">     &lt;/vbox&gt;</span>
<a href="#l13.97"></a><span id="l13.97">   &lt;/wizardpage&gt;</span>
<a href="#l13.98"></a><span id="l13.98"> </span>
<a href="#l13.99"></a><span id="l13.99">   &lt;!-- Done page : this page summarizes information collected to create a mail/news account --&gt;</span>
<a href="#l13.100"></a><span id="l13.100" class="difflineminus">-  &lt;wizardpage id=&quot;done&quot; pageid=&quot;done&quot; </span>
<a href="#l13.101"></a><span id="l13.101" class="difflineplus">+  &lt;wizardpage id=&quot;done&quot; pageid=&quot;done&quot;</span>
<a href="#l13.102"></a><span id="l13.102">               label=&quot;&amp;completionTitle.label;&quot;</span>
<a href="#l13.103"></a><span id="l13.103">               onpageshow=&quot;return donePageInit();&quot;&gt;</span>
<a href="#l13.104"></a><span id="l13.104">     &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l13.105"></a><span id="l13.105">       &lt;description&gt;&amp;completionText.label;&lt;/description&gt;</span>
<a href="#l13.106"></a><span id="l13.106">       &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l13.107"></a><span id="l13.107">       &lt;grid&gt;</span>
<a href="#l13.108"></a><span id="l13.108">         &lt;columns&gt;</span>
<a href="#l13.109"></a><span id="l13.109">           &lt;column/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-offline.xul</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-offline.xul</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -6,23 +6,23 @@</span>
<a href="#l14.4"></a><span id="l14.4"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/accountManage.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6"> &lt;!DOCTYPE page SYSTEM &quot;chrome://messenger/locale/am-offline.dtd&quot;&gt;</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> &lt;page xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l14.9"></a><span id="l14.9">       onload=&quot;parent.onPanelLoaded('am-offline.xul');&quot;&gt;</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">   &lt;vbox flex=&quot;1&quot; style=&quot;overflow: auto;&quot;&gt;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    &lt;stringbundle id=&quot;bundle_prefs&quot; src=&quot;chrome://messenger/locale/prefs.properties&quot;/&gt; </span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+    &lt;stringbundle id=&quot;bundle_prefs&quot; src=&quot;chrome://messenger/locale/prefs.properties&quot;/&gt;</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/AccountManager.js&quot;/&gt;</span>
<a href="#l14.16"></a><span id="l14.16">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/retention.js&quot;/&gt;</span>
<a href="#l14.17"></a><span id="l14.17">     &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/am-offline.js&quot;/&gt;</span>
<a href="#l14.18"></a><span id="l14.18"> </span>
<a href="#l14.19"></a><span id="l14.19" class="difflineminus">-    &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;server.type&quot;/&gt;  </span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+    &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;server.type&quot;/&gt;</span>
<a href="#l14.21"></a><span id="l14.21">     &lt;label id=&quot;imap.autoSyncMaxAgeDays&quot; hidden=&quot;true&quot;</span>
<a href="#l14.22"></a><span id="l14.22">            wsm_persist=&quot;true&quot; preftype=&quot;int&quot;</span>
<a href="#l14.23"></a><span id="l14.23">            prefstring=&quot;mail.server.%serverkey%.autosync_max_age_days&quot;/&gt;</span>
<a href="#l14.24"></a><span id="l14.24"> </span>
<a href="#l14.25"></a><span id="l14.25">     &lt;dialogheader id=&quot;headertitle&quot;/&gt;</span>
<a href="#l14.26"></a><span id="l14.26"> </span>
<a href="#l14.27"></a><span id="l14.27">     &lt;groupbox id=&quot;offline.titlebox&quot; hidefor=&quot;movemail,pop3,none,rss&quot;&gt;</span>
<a href="#l14.28"></a><span id="l14.28">       &lt;caption label=&quot;&amp;syncGroupTitle.label;&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerOSXIntegration.mm</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerOSXIntegration.mm</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -113,17 +113,17 @@ static void openMailWindow(const nsCStri</span>
<a href="#l15.4"></a><span id="l15.4">         wwatch-&gt;OpenWindow(0, &quot;chrome://messenger/content/messageWindow.xul&quot;,</span>
<a href="#l15.5"></a><span id="l15.5">                            &quot;_blank&quot;, &quot;all,chrome,dialog=no,status,toolbar&quot;, msgUri,</span>
<a href="#l15.6"></a><span id="l15.6">                            getter_AddRefs(newWindow));</span>
<a href="#l15.7"></a><span id="l15.7"> #else</span>
<a href="#l15.8"></a><span id="l15.8">         nsCOMPtr&lt;nsIMessenger&gt; messenger(do_CreateInstance(NS_MESSENGER_CONTRACTID, &amp;rv));</span>
<a href="#l15.9"></a><span id="l15.9">         if (NS_FAILED(rv))</span>
<a href="#l15.10"></a><span id="l15.10">           return;</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-        nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr; </span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+        nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l15.14"></a><span id="l15.14">         messenger-&gt;MsgHdrFromURI(aUri, getter_AddRefs(msgHdr));</span>
<a href="#l15.15"></a><span id="l15.15">         if (msgHdr)</span>
<a href="#l15.16"></a><span id="l15.16">         {</span>
<a href="#l15.17"></a><span id="l15.17">           nsCOMPtr&lt;mozIDOMWindowProxy&gt; newWindow;</span>
<a href="#l15.18"></a><span id="l15.18">           wwatch-&gt;OpenWindow(0, &quot;chrome://messenger/content/messageWindow.xul&quot;,</span>
<a href="#l15.19"></a><span id="l15.19">                              &quot;_blank&quot;, &quot;all,chrome,dialog=no,status,toolbar&quot;, msgHdr,</span>
<a href="#l15.20"></a><span id="l15.20">                              getter_AddRefs(newWindow));</span>
<a href="#l15.21"></a><span id="l15.21">         }</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -216,17 +216,17 @@ nsMessengerOSXIntegration::Observe(nsISu</span>
<a href="#l15.23"></a><span id="l15.23">   if (!strcmp(aTopic, &quot;alertfinished&quot;))</span>
<a href="#l15.24"></a><span id="l15.24">     return OnAlertFinished();</span>
<a href="#l15.25"></a><span id="l15.25"> </span>
<a href="#l15.26"></a><span id="l15.26">   if (!strcmp(aTopic, &quot;alertclickcallback&quot;))</span>
<a href="#l15.27"></a><span id="l15.27">     return OnAlertClicked(aData);</span>
<a href="#l15.28"></a><span id="l15.28"> </span>
<a href="#l15.29"></a><span id="l15.29"> #ifdef MOZ_SUITE</span>
<a href="#l15.30"></a><span id="l15.30">   // SeaMonkey does most of the GUI work in JS code when clicking on a mail</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-  // notification, so it needs an extra function here </span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+  // notification, so it needs an extra function here</span>
<a href="#l15.33"></a><span id="l15.33">   if (!strcmp(aTopic, &quot;alertclicksimplecallback&quot;))</span>
<a href="#l15.34"></a><span id="l15.34">     return OnAlertClickedSimple();</span>
<a href="#l15.35"></a><span id="l15.35"> #endif</span>
<a href="#l15.36"></a><span id="l15.36"> </span>
<a href="#l15.37"></a><span id="l15.37">   if (!strcmp(aTopic, &quot;mail-startup-done&quot;)) {</span>
<a href="#l15.38"></a><span id="l15.38">     nsresult rv;</span>
<a href="#l15.39"></a><span id="l15.39">     nsCOMPtr&lt;nsIObserverService&gt; observerService = do_GetService(&quot;@mozilla.org/observer-service;1&quot;, &amp;rv);</span>
<a href="#l15.40"></a><span id="l15.40">     if (NS_SUCCEEDED(rv)) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/build/nsMailModule.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/build/nsMailModule.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,36 +1,36 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l16.5"></a><span id="l16.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.6"></a><span id="l16.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.7"></a><span id="l16.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9"> /* ****************************************************************************</span>
<a href="#l16.10"></a><span id="l16.10">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.11"></a><span id="l16.11">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">- * </span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+ *</span>
<a href="#l16.14"></a><span id="l16.14">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.15"></a><span id="l16.15">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineminus">- * </span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+ *</span>
<a href="#l16.18"></a><span id="l16.18">  * Dear Mortals,</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">- * </span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+ *</span>
<a href="#l16.21"></a><span id="l16.21">  * Please be advised that if you are adding something here, you should also</span>
<a href="#l16.22"></a><span id="l16.22">  * strongly consider adding it to the other place it goes too!  These can be</span>
<a href="#l16.23"></a><span id="l16.23">  * found in paths like so: mailnews/.../build/WhateverFactory.cpp</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineminus">- * </span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+ *</span>
<a href="#l16.26"></a><span id="l16.26">  * If you do not, your (static) release builds will be quite pleasant, but</span>
<a href="#l16.27"></a><span id="l16.27">  * (dynamic) debug builds will disappoint you by not having your component in</span>
<a href="#l16.28"></a><span id="l16.28">  * them.</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineminus">- * </span>
<a href="#l16.30"></a><span id="l16.30" class="difflineplus">+ *</span>
<a href="#l16.31"></a><span id="l16.31">  * Yours truly,</span>
<a href="#l16.32"></a><span id="l16.32">  * The ghost that haunts the MailNews codebase.</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">- * </span>
<a href="#l16.34"></a><span id="l16.34" class="difflineplus">+ *</span>
<a href="#l16.35"></a><span id="l16.35">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.36"></a><span id="l16.36">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.37"></a><span id="l16.37" class="difflineminus">- * </span>
<a href="#l16.38"></a><span id="l16.38" class="difflineplus">+ *</span>
<a href="#l16.39"></a><span id="l16.39">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.40"></a><span id="l16.40">  * ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l16.41"></a><span id="l16.41">  * ****************************************************************************/</span>
<a href="#l16.42"></a><span id="l16.42"> </span>
<a href="#l16.43"></a><span id="l16.43"> </span>
<a href="#l16.44"></a><span id="l16.44"> ////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l16.45"></a><span id="l16.45"> // Core Module Include Files</span>
<a href="#l16.46"></a><span id="l16.46"> ////////////////////////////////////////////////////////////////////////////////</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/compose/content/sendProgress.xul</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/compose/content/sendProgress.xul</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l17.5"></a><span id="l17.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.8"></a><span id="l17.8">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.9"></a><span id="l17.9">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l17.10"></a><span id="l17.10"> </span>
<a href="#l17.11"></a><span id="l17.11"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/dialogs.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l17.12"></a><span id="l17.12"> </span>
<a href="#l17.13"></a><span id="l17.13"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/messengercompose/sendProgress.dtd&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/db/gloda/content/glodacomplete.xml</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/db/gloda/content/glodacomplete.xml</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -300,25 +300,25 @@</span>
<a href="#l18.4"></a><span id="l18.4">     &lt;implementation implements=&quot;nsIDOMXULSelectControlItemElement&quot;&gt;</span>
<a href="#l18.5"></a><span id="l18.5">       &lt;constructor&gt;</span>
<a href="#l18.6"></a><span id="l18.6">         &lt;![CDATA[</span>
<a href="#l18.7"></a><span id="l18.7">             this._explanation = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;explanation&quot;);</span>
<a href="#l18.8"></a><span id="l18.8"> </span>
<a href="#l18.9"></a><span id="l18.9">             this._adjustAcItem();</span>
<a href="#l18.10"></a><span id="l18.10">           ]]&gt;</span>
<a href="#l18.11"></a><span id="l18.11">       &lt;/constructor&gt;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-      </span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+</span>
<a href="#l18.14"></a><span id="l18.14">       &lt;property name=&quot;label&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.15"></a><span id="l18.15">         &lt;getter&gt;</span>
<a href="#l18.16"></a><span id="l18.16">           &lt;![CDATA[</span>
<a href="#l18.17"></a><span id="l18.17">             return &quot;tag &quot; + this.row.item.tag;</span>
<a href="#l18.18"></a><span id="l18.18">           ]]&gt;</span>
<a href="#l18.19"></a><span id="l18.19">         &lt;/getter&gt;</span>
<a href="#l18.20"></a><span id="l18.20">       &lt;/property&gt;</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineminus">-      </span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+</span>
<a href="#l18.23"></a><span id="l18.23">       &lt;method name=&quot;_adjustAcItem&quot;&gt;</span>
<a href="#l18.24"></a><span id="l18.24">         &lt;body&gt;</span>
<a href="#l18.25"></a><span id="l18.25">           &lt;![CDATA[</span>
<a href="#l18.26"></a><span id="l18.26">             let label = gGlodaCompleteStrings.get(&quot;glodaComplete.messagesTagged.label&quot;);</span>
<a href="#l18.27"></a><span id="l18.27">             this._explanation.value = label.replace(&quot;#1&quot;, this.row.item.tag);</span>
<a href="#l18.28"></a><span id="l18.28">           ]]&gt;</span>
<a href="#l18.29"></a><span id="l18.29">         &lt;/body&gt;</span>
<a href="#l18.30"></a><span id="l18.30">       &lt;/method&gt;</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineat">@@ -334,25 +334,25 @@</span>
<a href="#l18.32"></a><span id="l18.32">     &lt;implementation implements=&quot;nsIDOMXULSelectControlItemElement&quot;&gt;</span>
<a href="#l18.33"></a><span id="l18.33">       &lt;constructor&gt;</span>
<a href="#l18.34"></a><span id="l18.34">         &lt;![CDATA[</span>
<a href="#l18.35"></a><span id="l18.35">             this._explanation = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;explanation&quot;);</span>
<a href="#l18.36"></a><span id="l18.36"> </span>
<a href="#l18.37"></a><span id="l18.37">             this._adjustAcItem();</span>
<a href="#l18.38"></a><span id="l18.38">           ]]&gt;</span>
<a href="#l18.39"></a><span id="l18.39">       &lt;/constructor&gt;</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineminus">-      </span>
<a href="#l18.41"></a><span id="l18.41" class="difflineplus">+</span>
<a href="#l18.42"></a><span id="l18.42">       &lt;property name=&quot;label&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.43"></a><span id="l18.43">         &lt;getter&gt;</span>
<a href="#l18.44"></a><span id="l18.44">           &lt;![CDATA[</span>
<a href="#l18.45"></a><span id="l18.45">             return &quot;full text search: &quot; + this.row.item;</span>
<a href="#l18.46"></a><span id="l18.46">           ]]&gt;</span>
<a href="#l18.47"></a><span id="l18.47">         &lt;/getter&gt;</span>
<a href="#l18.48"></a><span id="l18.48">       &lt;/property&gt;</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineminus">-      </span>
<a href="#l18.50"></a><span id="l18.50" class="difflineplus">+</span>
<a href="#l18.51"></a><span id="l18.51">       &lt;method name=&quot;_adjustAcItem&quot;&gt;</span>
<a href="#l18.52"></a><span id="l18.52">         &lt;body&gt;</span>
<a href="#l18.53"></a><span id="l18.53">           &lt;![CDATA[</span>
<a href="#l18.54"></a><span id="l18.54">             let label = gGlodaCompleteStrings.get(&quot;glodaComplete.messagesMentioning.label&quot;);</span>
<a href="#l18.55"></a><span id="l18.55">             this._explanation.value = label.replace(&quot;#1&quot;, this.row.item);</span>
<a href="#l18.56"></a><span id="l18.56">           ]]&gt;</span>
<a href="#l18.57"></a><span id="l18.57">         &lt;/body&gt;</span>
<a href="#l18.58"></a><span id="l18.58">       &lt;/method&gt;</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineat">@@ -365,25 +365,25 @@</span>
<a href="#l18.60"></a><span id="l18.60">     &lt;/content&gt;</span>
<a href="#l18.61"></a><span id="l18.61">     &lt;implementation implements=&quot;nsIDOMXULSelectControlItemElement&quot;&gt;</span>
<a href="#l18.62"></a><span id="l18.62">       &lt;constructor&gt;</span>
<a href="#l18.63"></a><span id="l18.63">         &lt;![CDATA[</span>
<a href="#l18.64"></a><span id="l18.64">             this._explanation = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;explanation&quot;);</span>
<a href="#l18.65"></a><span id="l18.65">             this._adjustAcItem();</span>
<a href="#l18.66"></a><span id="l18.66">           ]]&gt;</span>
<a href="#l18.67"></a><span id="l18.67">       &lt;/constructor&gt;</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineminus">-      </span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+</span>
<a href="#l18.70"></a><span id="l18.70">       &lt;property name=&quot;label&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.71"></a><span id="l18.71">         &lt;getter&gt;</span>
<a href="#l18.72"></a><span id="l18.72">           &lt;![CDATA[</span>
<a href="#l18.73"></a><span id="l18.73">             return &quot;full text search: &quot; + this.row.item; // what is this for? l10n?</span>
<a href="#l18.74"></a><span id="l18.74">           ]]&gt;</span>
<a href="#l18.75"></a><span id="l18.75">         &lt;/getter&gt;</span>
<a href="#l18.76"></a><span id="l18.76">       &lt;/property&gt;</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineminus">-      </span>
<a href="#l18.78"></a><span id="l18.78" class="difflineplus">+</span>
<a href="#l18.79"></a><span id="l18.79">       &lt;method name=&quot;_adjustAcItem&quot;&gt;</span>
<a href="#l18.80"></a><span id="l18.80">         &lt;body&gt;</span>
<a href="#l18.81"></a><span id="l18.81">           &lt;![CDATA[</span>
<a href="#l18.82"></a><span id="l18.82">           let label = gGlodaCompleteStrings.get(&quot;glodaComplete.messagesMentioningMany.label&quot;);</span>
<a href="#l18.83"></a><span id="l18.83">           this._explanation.value = label.replace(&quot;#1&quot;, this.row.words.join(&quot;, &quot;));</span>
<a href="#l18.84"></a><span id="l18.84">           ]]&gt;</span>
<a href="#l18.85"></a><span id="l18.85">         &lt;/body&gt;</span>
<a href="#l18.86"></a><span id="l18.86">       &lt;/method&gt;</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineat">@@ -436,43 +436,43 @@</span>
<a href="#l18.88"></a><span id="l18.88"> </span>
<a href="#l18.89"></a><span id="l18.89">             this._typeImage = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;type-image&quot;);</span>
<a href="#l18.90"></a><span id="l18.90"> </span>
<a href="#l18.91"></a><span id="l18.91">             this._identityBox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;identity-box&quot;);</span>
<a href="#l18.92"></a><span id="l18.92">             this._identity = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;identity&quot;);</span>
<a href="#l18.93"></a><span id="l18.93"> </span>
<a href="#l18.94"></a><span id="l18.94">             this._nameBox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;name-box&quot;);</span>
<a href="#l18.95"></a><span id="l18.95">             this._name = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;name&quot;);</span>
<a href="#l18.96"></a><span id="l18.96" class="difflineminus">-            </span>
<a href="#l18.97"></a><span id="l18.97" class="difflineplus">+</span>
<a href="#l18.98"></a><span id="l18.98">             this._picture = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;picture&quot;);</span>
<a href="#l18.99"></a><span id="l18.99"> </span>
<a href="#l18.100"></a><span id="l18.100">             this._adjustAcItem();</span>
<a href="#l18.101"></a><span id="l18.101">           ]]&gt;</span>
<a href="#l18.102"></a><span id="l18.102">       &lt;/constructor&gt;</span>
<a href="#l18.103"></a><span id="l18.103" class="difflineminus">-      </span>
<a href="#l18.104"></a><span id="l18.104" class="difflineplus">+</span>
<a href="#l18.105"></a><span id="l18.105">       &lt;property name=&quot;label&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.106"></a><span id="l18.106">         &lt;getter&gt;</span>
<a href="#l18.107"></a><span id="l18.107">           &lt;![CDATA[</span>
<a href="#l18.108"></a><span id="l18.108">             var identity = this.row.item;</span>
<a href="#l18.109"></a><span id="l18.109">             return identity.accessibleLabel;</span>
<a href="#l18.110"></a><span id="l18.110">           ]]&gt;</span>
<a href="#l18.111"></a><span id="l18.111">         &lt;/getter&gt;</span>
<a href="#l18.112"></a><span id="l18.112">       &lt;/property&gt;</span>
<a href="#l18.113"></a><span id="l18.113" class="difflineminus">-      </span>
<a href="#l18.114"></a><span id="l18.114" class="difflineplus">+</span>
<a href="#l18.115"></a><span id="l18.115">       &lt;method name=&quot;_adjustAcItem&quot;&gt;</span>
<a href="#l18.116"></a><span id="l18.116">         &lt;body&gt;</span>
<a href="#l18.117"></a><span id="l18.117">           &lt;![CDATA[</span>
<a href="#l18.118"></a><span id="l18.118">           var identity = this.row.item;</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineminus">-          </span>
<a href="#l18.120"></a><span id="l18.120" class="difflineplus">+</span>
<a href="#l18.121"></a><span id="l18.121">           if (identity == null)</span>
<a href="#l18.122"></a><span id="l18.122">             return;</span>
<a href="#l18.123"></a><span id="l18.123" class="difflineminus">-          </span>
<a href="#l18.124"></a><span id="l18.124" class="difflineplus">+</span>
<a href="#l18.125"></a><span id="l18.125">           // I guess we should get the picture size from CSS or something?</span>
<a href="#l18.126"></a><span id="l18.126">           this._picture.src = identity.pictureURL(32);</span>
<a href="#l18.127"></a><span id="l18.127" class="difflineminus">-          </span>
<a href="#l18.128"></a><span id="l18.128" class="difflineplus">+</span>
<a href="#l18.129"></a><span id="l18.129">           // Emphasize the matching search terms for the description</span>
<a href="#l18.130"></a><span id="l18.130">           this._setUpDescription(this._name, identity.contact.name);</span>
<a href="#l18.131"></a><span id="l18.131">           this._setUpDescription(this._identity, identity.value);</span>
<a href="#l18.132"></a><span id="l18.132"> </span>
<a href="#l18.133"></a><span id="l18.133">           // Set up overflow on a timeout because the contents of the box</span>
<a href="#l18.134"></a><span id="l18.134">           // might not have a width yet even though we just changed them</span>
<a href="#l18.135"></a><span id="l18.135">           setTimeout(this._setUpOverflow, 0, this._nameBox, this._nameOverflowEllipsis);</span>
<a href="#l18.136"></a><span id="l18.136">           setTimeout(this._setUpOverflow, 0, this._identityBox, this._identityOverflowEllipsis);</span>
<a href="#l18.137"></a><span id="l18.137" class="difflineat">@@ -526,45 +526,45 @@</span>
<a href="#l18.138"></a><span id="l18.138"> </span>
<a href="#l18.139"></a><span id="l18.139">             this._typeImage = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;type-image&quot;);</span>
<a href="#l18.140"></a><span id="l18.140"> </span>
<a href="#l18.141"></a><span id="l18.141">             this._identityBox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;identity-box&quot;);</span>
<a href="#l18.142"></a><span id="l18.142">             this._identity = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;identity&quot;);</span>
<a href="#l18.143"></a><span id="l18.143"> </span>
<a href="#l18.144"></a><span id="l18.144">             this._nameBox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;name-box&quot;);</span>
<a href="#l18.145"></a><span id="l18.145">             this._name = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;name&quot;);</span>
<a href="#l18.146"></a><span id="l18.146" class="difflineminus">-            </span>
<a href="#l18.147"></a><span id="l18.147" class="difflineplus">+</span>
<a href="#l18.148"></a><span id="l18.148">             this._picture = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;picture&quot;);</span>
<a href="#l18.149"></a><span id="l18.149"> </span>
<a href="#l18.150"></a><span id="l18.150">             this._adjustAcItem();</span>
<a href="#l18.151"></a><span id="l18.151">           ]]&gt;</span>
<a href="#l18.152"></a><span id="l18.152">       &lt;/constructor&gt;</span>
<a href="#l18.153"></a><span id="l18.153" class="difflineminus">-      </span>
<a href="#l18.154"></a><span id="l18.154" class="difflineplus">+</span>
<a href="#l18.155"></a><span id="l18.155">       &lt;property name=&quot;label&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.156"></a><span id="l18.156">         &lt;getter&gt;</span>
<a href="#l18.157"></a><span id="l18.157">           &lt;![CDATA[</span>
<a href="#l18.158"></a><span id="l18.158">             var identity = this.obj;</span>
<a href="#l18.159"></a><span id="l18.159">             return identity.accessibleLabel;</span>
<a href="#l18.160"></a><span id="l18.160">           ]]&gt;</span>
<a href="#l18.161"></a><span id="l18.161">         &lt;/getter&gt;</span>
<a href="#l18.162"></a><span id="l18.162">       &lt;/property&gt;</span>
<a href="#l18.163"></a><span id="l18.163" class="difflineminus">-      </span>
<a href="#l18.164"></a><span id="l18.164" class="difflineplus">+</span>
<a href="#l18.165"></a><span id="l18.165">       &lt;method name=&quot;_adjustAcItem&quot;&gt;</span>
<a href="#l18.166"></a><span id="l18.166">         &lt;body&gt;</span>
<a href="#l18.167"></a><span id="l18.167">           &lt;![CDATA[</span>
<a href="#l18.168"></a><span id="l18.168">           var contact = this.obj;</span>
<a href="#l18.169"></a><span id="l18.169" class="difflineminus">-          </span>
<a href="#l18.170"></a><span id="l18.170" class="difflineplus">+</span>
<a href="#l18.171"></a><span id="l18.171">           if (contact == null)</span>
<a href="#l18.172"></a><span id="l18.172">             return;</span>
<a href="#l18.173"></a><span id="l18.173" class="difflineminus">-          </span>
<a href="#l18.174"></a><span id="l18.174" class="difflineplus">+</span>
<a href="#l18.175"></a><span id="l18.175">           var identity = contact.identities[0];</span>
<a href="#l18.176"></a><span id="l18.176" class="difflineminus">-          </span>
<a href="#l18.177"></a><span id="l18.177" class="difflineplus">+</span>
<a href="#l18.178"></a><span id="l18.178">           // I guess we should get the picture size from CSS or something?</span>
<a href="#l18.179"></a><span id="l18.179">           this._picture.src = identity.pictureURL(32);</span>
<a href="#l18.180"></a><span id="l18.180" class="difflineminus">-          </span>
<a href="#l18.181"></a><span id="l18.181" class="difflineplus">+</span>
<a href="#l18.182"></a><span id="l18.182">           // Emphasize the matching search terms for the description</span>
<a href="#l18.183"></a><span id="l18.183">           this._setUpDescription(this._name, contact.name);</span>
<a href="#l18.184"></a><span id="l18.184">           this._setUpDescription(this._identity, identity.value);</span>
<a href="#l18.185"></a><span id="l18.185"> </span>
<a href="#l18.186"></a><span id="l18.186">           // Set up overflow on a timeout because the contents of the box</span>
<a href="#l18.187"></a><span id="l18.187">           // might not have a width yet even though we just changed them</span>
<a href="#l18.188"></a><span id="l18.188">           setTimeout(this._setUpOverflow, 0, this._nameBox, this._nameOverflowEllipsis);</span>
<a href="#l18.189"></a><span id="l18.189">           setTimeout(this._setUpOverflow, 0, this._identityBox, this._identityOverflowEllipsis);</span>
<a href="#l18.190"></a><span id="l18.190" class="difflineat">@@ -584,54 +584,54 @@</span>
<a href="#l18.191"></a><span id="l18.191">       &lt;constructor&gt;</span>
<a href="#l18.192"></a><span id="l18.192">         &lt;![CDATA[</span>
<a href="#l18.193"></a><span id="l18.193">             this._explanation = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;explanation&quot;);</span>
<a href="#l18.194"></a><span id="l18.194">             this._identityHolder = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;identity-holder&quot;);</span>
<a href="#l18.195"></a><span id="l18.195"> </span>
<a href="#l18.196"></a><span id="l18.196">             this._adjustAcItem();</span>
<a href="#l18.197"></a><span id="l18.197">           ]]&gt;</span>
<a href="#l18.198"></a><span id="l18.198">       &lt;/constructor&gt;</span>
<a href="#l18.199"></a><span id="l18.199" class="difflineminus">-      </span>
<a href="#l18.200"></a><span id="l18.200" class="difflineplus">+</span>
<a href="#l18.201"></a><span id="l18.201">       &lt;property name=&quot;label&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.202"></a><span id="l18.202">         &lt;getter&gt;</span>
<a href="#l18.203"></a><span id="l18.203">           &lt;![CDATA[</span>
<a href="#l18.204"></a><span id="l18.204">             return this._explanation.value;</span>
<a href="#l18.205"></a><span id="l18.205">           ]]&gt;</span>
<a href="#l18.206"></a><span id="l18.206">         &lt;/getter&gt;</span>
<a href="#l18.207"></a><span id="l18.207">       &lt;/property&gt;</span>
<a href="#l18.208"></a><span id="l18.208" class="difflineminus">-      </span>
<a href="#l18.209"></a><span id="l18.209" class="difflineplus">+</span>
<a href="#l18.210"></a><span id="l18.210">       &lt;method name=&quot;renderItem&quot;&gt;</span>
<a href="#l18.211"></a><span id="l18.211">         &lt;parameter name=&quot;aObj&quot;/&gt;</span>
<a href="#l18.212"></a><span id="l18.212">         &lt;body&gt;</span>
<a href="#l18.213"></a><span id="l18.213">           var node = document.createElementNS(</span>
<a href="#l18.214"></a><span id="l18.214">             &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;,</span>
<a href="#l18.215"></a><span id="l18.215">             &quot;richlistitem&quot;);</span>
<a href="#l18.216"></a><span id="l18.216" class="difflineminus">-          </span>
<a href="#l18.217"></a><span id="l18.217" class="difflineplus">+</span>
<a href="#l18.218"></a><span id="l18.218">           node.obj = aObj;</span>
<a href="#l18.219"></a><span id="l18.219">           node.setAttribute(&quot;type&quot;,</span>
<a href="#l18.220"></a><span id="l18.220">                             &quot;gloda-&quot; + this.row.nounDef.name + &quot;-chunk&quot;);</span>
<a href="#l18.221"></a><span id="l18.221" class="difflineminus">-          </span>
<a href="#l18.222"></a><span id="l18.222" class="difflineplus">+</span>
<a href="#l18.223"></a><span id="l18.223">           this._identityHolder.appendChild(node);</span>
<a href="#l18.224"></a><span id="l18.224">         &lt;/body&gt;</span>
<a href="#l18.225"></a><span id="l18.225">       &lt;/method&gt;</span>
<a href="#l18.226"></a><span id="l18.226" class="difflineminus">-      </span>
<a href="#l18.227"></a><span id="l18.227" class="difflineplus">+</span>
<a href="#l18.228"></a><span id="l18.228">       &lt;method name=&quot;_adjustAcItem&quot;&gt;</span>
<a href="#l18.229"></a><span id="l18.229">         &lt;body&gt;</span>
<a href="#l18.230"></a><span id="l18.230">           &lt;![CDATA[</span>
<a href="#l18.231"></a><span id="l18.231">           // clear out any lingering children</span>
<a href="#l18.232"></a><span id="l18.232">           while (this._identityHolder.hasChildNodes())</span>
<a href="#l18.233"></a><span id="l18.233">             this._identityHolder.lastChild.remove();</span>
<a href="#l18.234"></a><span id="l18.234" class="difflineminus">-          </span>
<a href="#l18.235"></a><span id="l18.235" class="difflineplus">+</span>
<a href="#l18.236"></a><span id="l18.236">           var row = this.row;</span>
<a href="#l18.237"></a><span id="l18.237">           if (row == null)</span>
<a href="#l18.238"></a><span id="l18.238">             return;</span>
<a href="#l18.239"></a><span id="l18.239" class="difflineminus">-          </span>
<a href="#l18.240"></a><span id="l18.240" class="difflineplus">+</span>
<a href="#l18.241"></a><span id="l18.241">           this._explanation.value = row.nounDef.name + &quot;s &quot; +</span>
<a href="#l18.242"></a><span id="l18.242">             row.criteriaType + &quot;ed &quot; + row.criteria;</span>
<a href="#l18.243"></a><span id="l18.243" class="difflineminus">-          </span>
<a href="#l18.244"></a><span id="l18.244" class="difflineplus">+</span>
<a href="#l18.245"></a><span id="l18.245">           // render anyone already in there</span>
<a href="#l18.246"></a><span id="l18.246">           for (let item of row.collection.items) {</span>
<a href="#l18.247"></a><span id="l18.247">             this.renderItem(item);</span>
<a href="#l18.248"></a><span id="l18.248">           }</span>
<a href="#l18.249"></a><span id="l18.249">           // listen up, yo.</span>
<a href="#l18.250"></a><span id="l18.250">           row.renderer = this;</span>
<a href="#l18.251"></a><span id="l18.251">           ]]&gt;</span>
<a href="#l18.252"></a><span id="l18.252">         &lt;/body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/extensions/dsn/content/am-dsn.xul</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/extensions/dsn/content/am-dsn.xul</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -5,42 +5,42 @@</span>
<a href="#l19.4"></a><span id="l19.4">  This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.5"></a><span id="l19.5">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.6"></a><span id="l19.6">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/accountManage.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l19.9"></a><span id="l19.9"> </span>
<a href="#l19.10"></a><span id="l19.10"> &lt;!DOCTYPE page SYSTEM &quot;chrome://messenger/locale/am-dsn.dtd&quot;&gt;</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-&lt;page xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; </span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+&lt;page xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l19.14"></a><span id="l19.14">       onload=&quot;parent.onPanelLoaded('am-dsn.xul');&quot;&gt;</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-  &lt;stringbundle id=&quot;bundle_smime&quot; src=&quot;chrome://messenger/locale/am-dsn.properties&quot;/&gt; </span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+  &lt;stringbundle id=&quot;bundle_smime&quot; src=&quot;chrome://messenger/locale/am-dsn.properties&quot;/&gt;</span>
<a href="#l19.18"></a><span id="l19.18">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/AccountManager.js&quot;/&gt;</span>
<a href="#l19.19"></a><span id="l19.19">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/am-dsn.js&quot;/&gt;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineminus">-  </span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+</span>
<a href="#l19.22"></a><span id="l19.22">   &lt;dialogheader title=&quot;&amp;pane.title;&quot;/&gt;</span>
<a href="#l19.23"></a><span id="l19.23"> </span>
<a href="#l19.24"></a><span id="l19.24">   &lt;groupbox&gt;</span>
<a href="#l19.25"></a><span id="l19.25"> </span>
<a href="#l19.26"></a><span id="l19.26">     &lt;caption label=&quot;&amp;pane.title;&quot;/&gt;</span>
<a href="#l19.27"></a><span id="l19.27"> </span>
<a href="#l19.28"></a><span id="l19.28">     &lt;hbox id=&quot;prefChoices&quot; align=&quot;center&quot;&gt;</span>
<a href="#l19.29"></a><span id="l19.29">       &lt;radiogroup id=&quot;identity.dsn_use_custom_prefs&quot;</span>
<a href="#l19.30"></a><span id="l19.30">                   wsm_persist=&quot;true&quot;</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-                  genericattr=&quot;true&quot; </span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+                  genericattr=&quot;true&quot;</span>
<a href="#l19.33"></a><span id="l19.33">                   preftype=&quot;bool&quot;</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-                  prefstring=&quot;mail.identity.%identitykey%.dsn_use_custom_prefs&quot; </span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+                  prefstring=&quot;mail.identity.%identitykey%.dsn_use_custom_prefs&quot;</span>
<a href="#l19.36"></a><span id="l19.36">                   oncommand=&quot;EnableDisableCustomSettings();&quot;&gt;</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineminus">-    </span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+</span>
<a href="#l19.39"></a><span id="l19.39">         &lt;radio id=&quot;identity.select_global_prefs&quot;</span>
<a href="#l19.40"></a><span id="l19.40">                value=&quot;false&quot;</span>
<a href="#l19.41"></a><span id="l19.41">                label=&quot;&amp;useGlobalPrefs.label;&quot;</span>
<a href="#l19.42"></a><span id="l19.42">                accesskey=&quot;&amp;useGlobalPrefs.accesskey;&quot;/&gt;</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineminus">-    </span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+</span>
<a href="#l19.45"></a><span id="l19.45">         &lt;radio id=&quot;identity.select_custom_prefs&quot;</span>
<a href="#l19.46"></a><span id="l19.46">                value=&quot;true&quot;</span>
<a href="#l19.47"></a><span id="l19.47">                label=&quot;&amp;useCustomPrefs.label;&quot;</span>
<a href="#l19.48"></a><span id="l19.48">                accesskey=&quot;&amp;useCustomPrefs.accesskey;&quot;/&gt;</span>
<a href="#l19.49"></a><span id="l19.49">       &lt;/radiogroup&gt;</span>
<a href="#l19.50"></a><span id="l19.50">     &lt;/hbox&gt;</span>
<a href="#l19.51"></a><span id="l19.51"> </span>
<a href="#l19.52"></a><span id="l19.52">     &lt;vbox id=&quot;dsnSettings&quot; class=&quot;indent&quot; align=&quot;start&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/extensions/smime/content/certFetchingStatus.xul</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/certFetchingStatus.xul</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l20.4"></a><span id="l20.4">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l20.5"></a><span id="l20.5"> </span>
<a href="#l20.6"></a><span id="l20.6"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l20.7"></a><span id="l20.7"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/certFetchingStatus.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l20.8"></a><span id="l20.8"> </span>
<a href="#l20.9"></a><span id="l20.9"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger-smime/locale/certFetchingStatus.dtd&quot;&gt;</span>
<a href="#l20.10"></a><span id="l20.10"> </span>
<a href="#l20.11"></a><span id="l20.11"> &lt;dialog id=&quot;certFetchingStatus&quot; title=&quot;&amp;title.label;&quot;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;      </span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l20.14"></a><span id="l20.14">   style=&quot;width: 50em;&quot;</span>
<a href="#l20.15"></a><span id="l20.15">   buttons=&quot;cancel&quot;</span>
<a href="#l20.16"></a><span id="l20.16">   buttonlabelcancel=&quot;&amp;stop.label;&quot;</span>
<a href="#l20.17"></a><span id="l20.17">   ondialogcancel=&quot;return stopFetching();&quot;</span>
<a href="#l20.18"></a><span id="l20.18">   onload=&quot;onLoad();&quot;&gt;</span>
<a href="#l20.19"></a><span id="l20.19"> </span>
<a href="#l20.20"></a><span id="l20.20">   &lt;stringbundle id=&quot;bundle_ldap&quot; src=&quot;chrome://mozldap/locale/ldap.properties&quot;/&gt;</span>
<a href="#l20.21"></a><span id="l20.21"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger-smime/content/certFetchingStatus.js&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgCompSecurityInfo.xul</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgCompSecurityInfo.xul</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -4,25 +4,25 @@</span>
<a href="#l21.4"></a><span id="l21.4">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l21.5"></a><span id="l21.5"> </span>
<a href="#l21.6"></a><span id="l21.6"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l21.7"></a><span id="l21.7"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/msgCompSecurityInfo.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger-smime/locale/msgCompSecurityInfo.dtd&quot;&gt;</span>
<a href="#l21.10"></a><span id="l21.10"> </span>
<a href="#l21.11"></a><span id="l21.11"> &lt;dialog id=&quot;msgCompSecurityInfo&quot; title=&quot;&amp;title.label;&quot;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;      </span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l21.14"></a><span id="l21.14">   style=&quot;width: 50em;&quot;</span>
<a href="#l21.15"></a><span id="l21.15">   persist=&quot;width height&quot;</span>
<a href="#l21.16"></a><span id="l21.16">   buttons=&quot;accept&quot;</span>
<a href="#l21.17"></a><span id="l21.17">   onload=&quot;onLoad();&quot;&gt;</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger-smime/content/msgCompSecurityInfo.js&quot;/&gt;</span>
<a href="#l21.20"></a><span id="l21.20"> </span>
<a href="#l21.21"></a><span id="l21.21" class="difflineminus">-  &lt;stringbundle id=&quot;bundle_smime_comp_info&quot; src=&quot;chrome://messenger-smime/locale/msgCompSecurityInfo.properties&quot;/&gt; </span>
<a href="#l21.22"></a><span id="l21.22" class="difflineplus">+  &lt;stringbundle id=&quot;bundle_smime_comp_info&quot; src=&quot;chrome://messenger-smime/locale/msgCompSecurityInfo.properties&quot;/&gt;</span>
<a href="#l21.23"></a><span id="l21.23"> </span>
<a href="#l21.24"></a><span id="l21.24">   &lt;description&gt;&amp;subject.plaintextWarning;&lt;/description&gt;</span>
<a href="#l21.25"></a><span id="l21.25">   &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l21.26"></a><span id="l21.26">   &lt;description&gt;&amp;status.heading;&lt;/description&gt;</span>
<a href="#l21.27"></a><span id="l21.27">   &lt;grid&gt;</span>
<a href="#l21.28"></a><span id="l21.28">     &lt;columns&gt;</span>
<a href="#l21.29"></a><span id="l21.29">       &lt;column/&gt;</span>
<a href="#l21.30"></a><span id="l21.30">       &lt;column/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.xul</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l22.4"></a><span id="l22.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l22.5"></a><span id="l22.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l22.6"></a><span id="l22.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.7"></a><span id="l22.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.8"></a><span id="l22.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l22.9"></a><span id="l22.9"> </span>
<a href="#l22.10"></a><span id="l22.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/msgHdrViewSMIMEOverlay.css&quot; type=&quot;text/css&quot;?&gt; </span>
<a href="#l22.11"></a><span id="l22.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/msgHdrViewSMIMEOverlay.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l22.12"></a><span id="l22.12"> </span>
<a href="#l22.13"></a><span id="l22.13"> &lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l22.14"></a><span id="l22.14"> </span>
<a href="#l22.15"></a><span id="l22.15">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger-smime/content/msgHdrViewSMIMEOverlay.js&quot;/&gt;</span>
<a href="#l22.16"></a><span id="l22.16"> &lt;!-- These stringbundles are already defined in msgReadSMIMEOverlay.xul!</span>
<a href="#l22.17"></a><span id="l22.17">   &lt;stringbundleset id=&quot;stringbundleset&quot;&gt;</span>
<a href="#l22.18"></a><span id="l22.18">     &lt;stringbundle id=&quot;bundle_read_smime&quot; src=&quot;chrome://messenger-smime/locale/msgReadSMIMEOverlay.properties&quot;/&gt;</span>
<a href="#l22.19"></a><span id="l22.19">     &lt;stringbundle id=&quot;bundle_brand&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgReadSMIMEOverlay.xul</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l23.4"></a><span id="l23.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l23.5"></a><span id="l23.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l23.6"></a><span id="l23.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.7"></a><span id="l23.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.8"></a><span id="l23.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l23.9"></a><span id="l23.9"> </span>
<a href="#l23.10"></a><span id="l23.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/msgReadSMIMEOverlay.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12"> &lt;!DOCTYPE overlay SYSTEM &quot;chrome://messenger-smime/locale/msgReadSMIMEOverlay.dtd&quot;&gt;</span>
<a href="#l23.13"></a><span id="l23.13"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgReadSecurityInfo.xul</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgReadSecurityInfo.xul</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -1,27 +1,27 @@</span>
<a href="#l24.4"></a><span id="l24.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l24.5"></a><span id="l24.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.6"></a><span id="l24.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.7"></a><span id="l24.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l24.8"></a><span id="l24.8"> </span>
<a href="#l24.9"></a><span id="l24.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/msgReadSecurityInfo.css&quot; type=&quot;text/css&quot;?&gt; </span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/smime/msgReadSecurityInfo.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l24.12"></a><span id="l24.12"> </span>
<a href="#l24.13"></a><span id="l24.13"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger-smime/locale/msgReadSecurityInfo.dtd&quot;&gt;</span>
<a href="#l24.14"></a><span id="l24.14"> </span>
<a href="#l24.15"></a><span id="l24.15"> &lt;dialog id=&quot;msgReadSecurityInfo&quot; title=&quot;&amp;status.label;&quot;</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineminus">-  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;      </span>
<a href="#l24.17"></a><span id="l24.17" class="difflineplus">+  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l24.18"></a><span id="l24.18">   style=&quot;width: 40em;&quot;</span>
<a href="#l24.19"></a><span id="l24.19">   buttons=&quot;accept&quot;</span>
<a href="#l24.20"></a><span id="l24.20">   onload=&quot;onLoad();&quot;&gt;</span>
<a href="#l24.21"></a><span id="l24.21"> </span>
<a href="#l24.22"></a><span id="l24.22">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger-smime/content/msgReadSecurityInfo.js&quot;/&gt;</span>
<a href="#l24.23"></a><span id="l24.23"> </span>
<a href="#l24.24"></a><span id="l24.24" class="difflineminus">-  &lt;stringbundle id=&quot;bundle_smime_read_info&quot; src=&quot;chrome://messenger-smime/locale/msgSecurityInfo.properties&quot;/&gt; </span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+  &lt;stringbundle id=&quot;bundle_smime_read_info&quot; src=&quot;chrome://messenger-smime/locale/msgSecurityInfo.properties&quot;/&gt;</span>
<a href="#l24.26"></a><span id="l24.26"> </span>
<a href="#l24.27"></a><span id="l24.27">   &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l24.28"></a><span id="l24.28">     &lt;label id=&quot;signatureLabel&quot;/&gt;</span>
<a href="#l24.29"></a><span id="l24.29">     &lt;label id=&quot;signatureHeader&quot; collapsed=&quot;true&quot;/&gt;</span>
<a href="#l24.30"></a><span id="l24.30">     &lt;description id=&quot;signatureExplanation&quot;/&gt;</span>
<a href="#l24.31"></a><span id="l24.31">     &lt;vbox id=&quot;signatureCert&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l24.32"></a><span id="l24.32">       &lt;hbox&gt;</span>
<a href="#l24.33"></a><span id="l24.33">         &lt;label id=&quot;signedByLabel&quot;&gt;&amp;signer.name;&lt;/label&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/import/applemail/src/nsEmlxHelperUtils.mm</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/import/applemail/src/nsEmlxHelperUtils.mm</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -16,22 +16,22 @@</span>
<a href="#l25.4"></a><span id="l25.4"> #include &quot;nsTArray.h&quot;</span>
<a href="#l25.5"></a><span id="l25.5"> #include &quot;nsAppleMailImport.h&quot;</span>
<a href="#l25.6"></a><span id="l25.6"> #include &quot;prprf.h&quot;</span>
<a href="#l25.7"></a><span id="l25.7"> #include &quot;nsIFile.h&quot;</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9"> #import &lt;Cocoa/Cocoa.h&gt;</span>
<a href="#l25.10"></a><span id="l25.10"> </span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-nsresult nsEmlxHelperUtils::ConvertToMozillaStatusFlags(const char *aXMLBufferStart, </span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-                                                        const char *aXMLBufferEnd, </span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+nsresult nsEmlxHelperUtils::ConvertToMozillaStatusFlags(const char *aXMLBufferStart,</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+                                                        const char *aXMLBufferEnd,</span>
<a href="#l25.16"></a><span id="l25.16">                                                         uint32_t *aMozillaStatusFlags)</span>
<a href="#l25.17"></a><span id="l25.17"> {</span>
<a href="#l25.18"></a><span id="l25.18">   // create a NSData wrapper around the buffer, so we can use the Cocoa call below</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">-  NSData *metadata = </span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+  NSData *metadata =</span>
<a href="#l25.21"></a><span id="l25.21">     [[[NSData alloc] initWithBytesNoCopy:(void *)aXMLBufferStart length:(aXMLBufferEnd-aXMLBufferStart) freeWhenDone:NO] autorelease];</span>
<a href="#l25.22"></a><span id="l25.22"> </span>
<a href="#l25.23"></a><span id="l25.23">   // get the XML data as a dictionary</span>
<a href="#l25.24"></a><span id="l25.24">   NSPropertyListFormat format;</span>
<a href="#l25.25"></a><span id="l25.25">   id plist = [NSPropertyListSerialization propertyListWithData:metadata</span>
<a href="#l25.26"></a><span id="l25.26">                                               options:NSPropertyListImmutable</span>
<a href="#l25.27"></a><span id="l25.27">                                                         format:&amp;format</span>
<a href="#l25.28"></a><span id="l25.28">                                               error:NULL];</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineat">@@ -40,17 +40,17 @@ nsresult nsEmlxHelperUtils::ConvertToMoz</span>
<a href="#l25.30"></a><span id="l25.30">     return NS_ERROR_FAILURE;</span>
<a href="#l25.31"></a><span id="l25.31"> </span>
<a href="#l25.32"></a><span id="l25.32">   // find the &lt;flags&gt;...&lt;/flags&gt; value and convert to int</span>
<a href="#l25.33"></a><span id="l25.33">   const uint32_t emlxMessageFlags = [[(NSDictionary *)plist objectForKey:@&quot;flags&quot;] intValue];</span>
<a href="#l25.34"></a><span id="l25.34"> </span>
<a href="#l25.35"></a><span id="l25.35">   if (emlxMessageFlags == 0)</span>
<a href="#l25.36"></a><span id="l25.36">     return NS_ERROR_FAILURE;</span>
<a href="#l25.37"></a><span id="l25.37"> </span>
<a href="#l25.38"></a><span id="l25.38" class="difflineminus">-  if (emlxMessageFlags &amp; nsEmlxHelperUtils::kRead) </span>
<a href="#l25.39"></a><span id="l25.39" class="difflineplus">+  if (emlxMessageFlags &amp; nsEmlxHelperUtils::kRead)</span>
<a href="#l25.40"></a><span id="l25.40">     *aMozillaStatusFlags |= nsMsgMessageFlags::Read;</span>
<a href="#l25.41"></a><span id="l25.41">   if (emlxMessageFlags &amp; nsEmlxHelperUtils::kForwarded)</span>
<a href="#l25.42"></a><span id="l25.42">     *aMozillaStatusFlags |= nsMsgMessageFlags::Forwarded;</span>
<a href="#l25.43"></a><span id="l25.43">   if (emlxMessageFlags &amp; nsEmlxHelperUtils::kAnswered)</span>
<a href="#l25.44"></a><span id="l25.44">     *aMozillaStatusFlags |= nsMsgMessageFlags::Replied;</span>
<a href="#l25.45"></a><span id="l25.45">   if (emlxMessageFlags &amp; nsEmlxHelperUtils::kFlagged)</span>
<a href="#l25.46"></a><span id="l25.46">     *aMozillaStatusFlags |= nsMsgMessageFlags::Marked;</span>
<a href="#l25.47"></a><span id="l25.47"> </span>
<a href="#l25.48"></a><span id="l25.48" class="difflineat">@@ -62,17 +62,17 @@ nsresult nsEmlxHelperUtils::ConvertToMbo</span>
<a href="#l25.49"></a><span id="l25.49">   nsTArray&lt;const char *&gt; foundFromLines;</span>
<a href="#l25.50"></a><span id="l25.50"> </span>
<a href="#l25.51"></a><span id="l25.51">   const char *cur = aMessageBufferStart;</span>
<a href="#l25.52"></a><span id="l25.52">   while (cur &lt; aMessageBufferEnd) {</span>
<a href="#l25.53"></a><span id="l25.53"> </span>
<a href="#l25.54"></a><span id="l25.54">     const char *foundFromStr = strnstr(cur, &quot;From &quot;, aMessageBufferEnd-cur);</span>
<a href="#l25.55"></a><span id="l25.55"> </span>
<a href="#l25.56"></a><span id="l25.56">     if (foundFromStr) {</span>
<a href="#l25.57"></a><span id="l25.57" class="difflineminus">-      // skip all prepending '&gt;' chars </span>
<a href="#l25.58"></a><span id="l25.58" class="difflineplus">+      // skip all prepending '&gt;' chars</span>
<a href="#l25.59"></a><span id="l25.59">       const char *fromLineStart = foundFromStr;</span>
<a href="#l25.60"></a><span id="l25.60">       while (fromLineStart-- &gt;= aMessageBufferStart) {</span>
<a href="#l25.61"></a><span id="l25.61">         if (*fromLineStart == '\n' || fromLineStart == aMessageBufferStart) {</span>
<a href="#l25.62"></a><span id="l25.62">           if (fromLineStart &gt; aMessageBufferStart)</span>
<a href="#l25.63"></a><span id="l25.63">             fromLineStart++;</span>
<a href="#l25.64"></a><span id="l25.64">           foundFromLines.AppendElement(fromLineStart);</span>
<a href="#l25.65"></a><span id="l25.65">           break;</span>
<a href="#l25.66"></a><span id="l25.66">         }</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineat">@@ -80,17 +80,17 @@ nsresult nsEmlxHelperUtils::ConvertToMbo</span>
<a href="#l25.68"></a><span id="l25.68">           break;</span>
<a href="#l25.69"></a><span id="l25.69">       }</span>
<a href="#l25.70"></a><span id="l25.70"> </span>
<a href="#l25.71"></a><span id="l25.71">       // advance past the last found From string.</span>
<a href="#l25.72"></a><span id="l25.72">       cur = foundFromStr + 5;</span>
<a href="#l25.73"></a><span id="l25.73"> </span>
<a href="#l25.74"></a><span id="l25.74">       // look for more From lines.</span>
<a href="#l25.75"></a><span id="l25.75">       continue;</span>
<a href="#l25.76"></a><span id="l25.76" class="difflineminus">-    } </span>
<a href="#l25.77"></a><span id="l25.77" class="difflineplus">+    }</span>
<a href="#l25.78"></a><span id="l25.78"> </span>
<a href="#l25.79"></a><span id="l25.79">     break;</span>
<a href="#l25.80"></a><span id="l25.80">   }</span>
<a href="#l25.81"></a><span id="l25.81"> </span>
<a href="#l25.82"></a><span id="l25.82">   // go through foundFromLines</span>
<a href="#l25.83"></a><span id="l25.83">   if (foundFromLines.Length()) {</span>
<a href="#l25.84"></a><span id="l25.84"> </span>
<a href="#l25.85"></a><span id="l25.85">     const char *chunkStart = aMessageBufferStart;</span>
<a href="#l25.86"></a><span id="l25.86" class="difflineat">@@ -114,17 +114,17 @@ nsresult nsEmlxHelperUtils::AddEmlxMessa</span>
<a href="#l25.87"></a><span id="l25.87">   // in a C++ environment where the main event loop has no autorelease pool (e.g on a XPCOM thread)</span>
<a href="#l25.88"></a><span id="l25.88">   NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];</span>
<a href="#l25.89"></a><span id="l25.89"> </span>
<a href="#l25.90"></a><span id="l25.90">   nsresult rv = NS_ERROR_FAILURE;</span>
<a href="#l25.91"></a><span id="l25.91"> </span>
<a href="#l25.92"></a><span id="l25.92">   nsAutoCString path;</span>
<a href="#l25.93"></a><span id="l25.93">   aMessage-&gt;GetNativePath(path);</span>
<a href="#l25.94"></a><span id="l25.94"> </span>
<a href="#l25.95"></a><span id="l25.95" class="difflineminus">-  NSData *data = [NSData dataWithContentsOfFile:[NSString stringWithUTF8String:path.get()]]; </span>
<a href="#l25.96"></a><span id="l25.96" class="difflineplus">+  NSData *data = [NSData dataWithContentsOfFile:[NSString stringWithUTF8String:path.get()]];</span>
<a href="#l25.97"></a><span id="l25.97">   if (!data) {</span>
<a href="#l25.98"></a><span id="l25.98">     [pool release];</span>
<a href="#l25.99"></a><span id="l25.99">     return NS_ERROR_FAILURE;</span>
<a href="#l25.100"></a><span id="l25.100">   }</span>
<a href="#l25.101"></a><span id="l25.101"> </span>
<a href="#l25.102"></a><span id="l25.102">   char *startOfMessageData = NULL;</span>
<a href="#l25.103"></a><span id="l25.103">   uint32_t actualBytesWritten = 0;</span>
<a href="#l25.104"></a><span id="l25.104"> </span>
<a href="#l25.105"></a><span id="l25.105" class="difflineat">@@ -132,27 +132,27 @@ nsresult nsEmlxHelperUtils::AddEmlxMessa</span>
<a href="#l25.106"></a><span id="l25.106">   //</span>
<a href="#l25.107"></a><span id="l25.107">   // -------------------------------</span>
<a href="#l25.108"></a><span id="l25.108">   // &lt; A number describing how many bytes ahead there is message data &gt;</span>
<a href="#l25.109"></a><span id="l25.109">   // &lt; Message data &gt;</span>
<a href="#l25.110"></a><span id="l25.110">   // &lt; XML metadata for this message &gt;</span>
<a href="#l25.111"></a><span id="l25.111">   // -------------------------------</span>
<a href="#l25.112"></a><span id="l25.112"> </span>
<a href="#l25.113"></a><span id="l25.113">   // read the first line of the emlx file, which is a number of how many bytes ahead the actual</span>
<a href="#l25.114"></a><span id="l25.114" class="difflineminus">-  // message data is. </span>
<a href="#l25.115"></a><span id="l25.115" class="difflineplus">+  // message data is.</span>
<a href="#l25.116"></a><span id="l25.116">   uint64_t numberOfBytesToRead = strtol((char *)[data bytes], &amp;startOfMessageData, 10);</span>
<a href="#l25.117"></a><span id="l25.117">   if (numberOfBytesToRead &lt;= 0 || !startOfMessageData) {</span>
<a href="#l25.118"></a><span id="l25.118">     [pool release];</span>
<a href="#l25.119"></a><span id="l25.119">     return NS_ERROR_FAILURE;</span>
<a href="#l25.120"></a><span id="l25.120">   }</span>
<a href="#l25.121"></a><span id="l25.121"> </span>
<a href="#l25.122"></a><span id="l25.122">   // skip whitespace</span>
<a href="#l25.123"></a><span id="l25.123" class="difflineminus">-  while (*startOfMessageData == ' '  || </span>
<a href="#l25.124"></a><span id="l25.124" class="difflineminus">-         *startOfMessageData == '\n' || </span>
<a href="#l25.125"></a><span id="l25.125" class="difflineminus">-         *startOfMessageData == '\r' || </span>
<a href="#l25.126"></a><span id="l25.126" class="difflineplus">+  while (*startOfMessageData == ' '  ||</span>
<a href="#l25.127"></a><span id="l25.127" class="difflineplus">+         *startOfMessageData == '\n' ||</span>
<a href="#l25.128"></a><span id="l25.128" class="difflineplus">+         *startOfMessageData == '\r' ||</span>
<a href="#l25.129"></a><span id="l25.129">          *startOfMessageData == '\t')</span>
<a href="#l25.130"></a><span id="l25.130">     ++startOfMessageData;</span>
<a href="#l25.131"></a><span id="l25.131"> </span>
<a href="#l25.132"></a><span id="l25.132">   NS_NAMED_LITERAL_CSTRING(kBogusFromLine, &quot;From \n&quot;);</span>
<a href="#l25.133"></a><span id="l25.133">   NS_NAMED_LITERAL_CSTRING(kEndOfMessage, &quot;\n\n&quot;);</span>
<a href="#l25.134"></a><span id="l25.134"> </span>
<a href="#l25.135"></a><span id="l25.135">   // write the bogus &quot;From &quot; line which is a magic separator in the mbox format</span>
<a href="#l25.136"></a><span id="l25.136">   rv = aOut-&gt;Write(kBogusFromLine.get(), kBogusFromLine.Length(), &amp;actualBytesWritten);</span>
<a href="#l25.137"></a><span id="l25.137" class="difflineat">@@ -177,39 +177,39 @@ nsresult nsEmlxHelperUtils::AddEmlxMessa</span>
<a href="#l25.138"></a><span id="l25.138">     return rv;</span>
<a href="#l25.139"></a><span id="l25.139">   }</span>
<a href="#l25.140"></a><span id="l25.140"> </span>
<a href="#l25.141"></a><span id="l25.141">   rv = aOut-&gt;Write(buf.get(), buf.Length(), &amp;dummyRv);</span>
<a href="#l25.142"></a><span id="l25.142">   if (NS_FAILED(rv)) {</span>
<a href="#l25.143"></a><span id="l25.143">     [pool release];</span>
<a href="#l25.144"></a><span id="l25.144">     return rv;</span>
<a href="#l25.145"></a><span id="l25.145">   }</span>
<a href="#l25.146"></a><span id="l25.146" class="difflineminus">-  </span>
<a href="#l25.147"></a><span id="l25.147" class="difflineminus">-  // write out X-Mozilla-Keywords header as well to reserve some space for it </span>
<a href="#l25.148"></a><span id="l25.148" class="difflineplus">+</span>
<a href="#l25.149"></a><span id="l25.149" class="difflineplus">+  // write out X-Mozilla-Keywords header as well to reserve some space for it</span>
<a href="#l25.150"></a><span id="l25.150">   // in the mbox file.</span>
<a href="#l25.151"></a><span id="l25.151">   rv = aOut-&gt;Write(X_MOZILLA_KEYWORDS, X_MOZILLA_KEYWORDS_LEN, &amp;dummyRv);</span>
<a href="#l25.152"></a><span id="l25.152">   if (NS_FAILED(rv)) {</span>
<a href="#l25.153"></a><span id="l25.153">     [pool release];</span>
<a href="#l25.154"></a><span id="l25.154">     return rv;</span>
<a href="#l25.155"></a><span id="l25.155">   }</span>
<a href="#l25.156"></a><span id="l25.156" class="difflineminus">-  </span>
<a href="#l25.157"></a><span id="l25.157" class="difflineplus">+</span>
<a href="#l25.158"></a><span id="l25.158">   // write out empty X-Mozilla_status2 header</span>
<a href="#l25.159"></a><span id="l25.159">   buf.Adopt(PR_smprintf(X_MOZILLA_STATUS2_FORMAT MSG_LINEBREAK, 0));</span>
<a href="#l25.160"></a><span id="l25.160">   NS_ASSERTION(!buf.IsEmpty(), &quot;printf error with X-Mozilla-Status2 header&quot;);</span>
<a href="#l25.161"></a><span id="l25.161">   if (buf.IsEmpty()) {</span>
<a href="#l25.162"></a><span id="l25.162">     [pool release];</span>
<a href="#l25.163"></a><span id="l25.163">     return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l25.164"></a><span id="l25.164">   }</span>
<a href="#l25.165"></a><span id="l25.165"> </span>
<a href="#l25.166"></a><span id="l25.166">   rv = aOut-&gt;Write(buf.get(), buf.Length(), &amp;dummyRv);</span>
<a href="#l25.167"></a><span id="l25.167">   if (NS_FAILED(rv)) {</span>
<a href="#l25.168"></a><span id="l25.168">     [pool release];</span>
<a href="#l25.169"></a><span id="l25.169">     return rv;</span>
<a href="#l25.170"></a><span id="l25.170">   }</span>
<a href="#l25.171"></a><span id="l25.171" class="difflineminus">-  </span>
<a href="#l25.172"></a><span id="l25.172" class="difflineplus">+</span>
<a href="#l25.173"></a><span id="l25.173">   // do any conversion needed for the mbox data to be valid mboxrd.</span>
<a href="#l25.174"></a><span id="l25.174">   nsCString convertedData;</span>
<a href="#l25.175"></a><span id="l25.175">   rv = ConvertToMboxRD(startOfMessageData, (startOfMessageData + numberOfBytesToRead), convertedData);</span>
<a href="#l25.176"></a><span id="l25.176">   if (NS_FAILED(rv)) {</span>
<a href="#l25.177"></a><span id="l25.177">     [pool release];</span>
<a href="#l25.178"></a><span id="l25.178">     return rv;</span>
<a href="#l25.179"></a><span id="l25.179">   }</span>
<a href="#l25.180"></a><span id="l25.180"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/import/content/fieldMapImport.xul</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/import/content/fieldMapImport.xul</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt; </span>
<a href="#l26.5"></a><span id="l26.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l26.6"></a><span id="l26.6"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.7"></a><span id="l26.7">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.8"></a><span id="l26.8">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l26.9"></a><span id="l26.9"> </span>
<a href="#l26.10"></a><span id="l26.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://communicator/skin/&quot; type=&quot;text/css&quot;?&gt; </span>
<a href="#l26.11"></a><span id="l26.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://communicator/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l26.12"></a><span id="l26.12"> </span>
<a href="#l26.13"></a><span id="l26.13"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://messenger/locale/fieldMapImport.dtd&quot;&gt;</span>
<a href="#l26.14"></a><span id="l26.14"> </span>
<a href="#l26.15"></a><span id="l26.15"> &lt;dialog xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l26.16"></a><span id="l26.16">         buttons=&quot;accept,cancel&quot;</span>
<a href="#l26.17"></a><span id="l26.17">         title=&quot;&amp;fieldMapImport.title;&quot;</span>
<a href="#l26.18"></a><span id="l26.18">         style=&quot;&amp;fieldMapImport.size;&quot;</span>
<a href="#l26.19"></a><span id="l26.19">         ondialogaccept=&quot;FieldImportOKButton();&quot;</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineat">@@ -18,19 +18,19 @@</span>
<a href="#l26.21"></a><span id="l26.21"> </span>
<a href="#l26.22"></a><span id="l26.22">   &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l26.23"></a><span id="l26.23">     &lt;label value=&quot;&amp;fieldMapImport.recordNumber;&quot;/&gt;</span>
<a href="#l26.24"></a><span id="l26.24">     &lt;label id=&quot;recordNumber&quot;/&gt;</span>
<a href="#l26.25"></a><span id="l26.25">     &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l26.26"></a><span id="l26.26">     &lt;button id=&quot;previous&quot; oncommand=&quot;Browse(-1);&quot;</span>
<a href="#l26.27"></a><span id="l26.27">             label=&quot;&amp;fieldMapImport.previous.label;&quot;</span>
<a href="#l26.28"></a><span id="l26.28">             accesskey=&quot;&amp;fieldMapImport.previous.accesskey;&quot;/&gt;</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineminus">-    &lt;button id=&quot;next&quot; oncommand=&quot;Browse(1);&quot; </span>
<a href="#l26.30"></a><span id="l26.30" class="difflineplus">+    &lt;button id=&quot;next&quot; oncommand=&quot;Browse(1);&quot;</span>
<a href="#l26.31"></a><span id="l26.31">             label=&quot;&amp;fieldMapImport.next.label;&quot;</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineminus">-            accesskey=&quot;&amp;fieldMapImport.next.accesskey;&quot;/&gt;      </span>
<a href="#l26.33"></a><span id="l26.33" class="difflineplus">+            accesskey=&quot;&amp;fieldMapImport.next.accesskey;&quot;/&gt;</span>
<a href="#l26.34"></a><span id="l26.34">   &lt;/hbox&gt;</span>
<a href="#l26.35"></a><span id="l26.35"> </span>
<a href="#l26.36"></a><span id="l26.36">   &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l26.37"></a><span id="l26.37">     &lt;checkbox id=&quot;skipFirstRecord&quot;</span>
<a href="#l26.38"></a><span id="l26.38">               label=&quot;&amp;fieldMapImport.skipFirstRecord.label;&quot;</span>
<a href="#l26.39"></a><span id="l26.39">               accesskey=&quot;&amp;fieldMapImport.skipFirstRecord.accessKey;&quot;/&gt;</span>
<a href="#l26.40"></a><span id="l26.40">   &lt;/hbox&gt;</span>
<a href="#l26.41"></a><span id="l26.41"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

