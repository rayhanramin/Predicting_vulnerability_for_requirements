<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 13248:752e81dfb822ef5f2707d1ccc834bd9476a19db9</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 752e81dfb822ef5f2707d1ccc834bd9476a19db9" />
<meta property="og:url" content="/comm-central/rev/752e81dfb822ef5f2707d1ccc834bd9476a19db9" />
<meta property="og:description" content="Bug 562048 - Notification bar needs to look slicker. ui-r=bwinton r=bwinton" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 752e81dfb822ef5f2707d1ccc834bd9476a19db9 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/752e81dfb822ef5f2707d1ccc834bd9476a19db9">shortlog</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/752e81dfb822ef5f2707d1ccc834bd9476a19db9">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9">files</a> |
changeset |
<a href="/comm-central/raw-rev/752e81dfb822ef5f2707d1ccc834bd9476a19db9">raw</a>  | <a href="/comm-central/archive/752e81dfb822ef5f2707d1ccc834bd9476a19db9.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=562048">Bug 562048</a> - Notification bar needs to look slicker. ui-r=bwinton r=bwinton
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#103;&#110;&#117;&#115;&#32;&#77;&#101;&#108;&#105;&#110;&#32;&#60;&#109;&#107;&#109;&#101;&#108;&#105;&#110;&#43;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#105;&#107;&#105;&#46;&#102;&#105;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 26 Dec 2012 01:53:52 +0100</td></tr>

<tr>
 <td>changeset 13248</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/752e81dfb822ef5f2707d1ccc834bd9476a19db9">752e81dfb822ef5f2707d1ccc834bd9476a19db9</a></td>
</tr>



<tr>
<td>parent 13247</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/76f711a54fd39f802bbac0d68b86fac3d8741067">76f711a54fd39f802bbac0d68b86fac3d8741067</a>
</td>
</tr>

<tr>
<td>child 13249</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/ab678895a5a5d4c8e0f30408815e648e99cf4baa">ab678895a5a5d4c8e0f30408815e648e99cf4baa</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=752e81dfb822ef5f2707d1ccc834bd9476a19db9">9630</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Tue, 05 Nov 2013 19:56:58 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@752e81dfb822 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=752e81dfb822ef5f2707d1ccc834bd9476a19db9">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&newProject=comm-central&newRevision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&newProject=comm-central&newRevision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&newProject=comm-central&newRevision=752e81dfb822ef5f2707d1ccc834bd9476a19db9&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bwinton%29&revcount=50">bwinton</a>, <a href="/comm-central/log?rev=reviewer%28bwinton%29&revcount=50">bwinton</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=562048">562048</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=562048">Bug 562048</a> - Notification bar needs to look slicker. ui-r=bwinton r=bwinton</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.xul">mail/base/content/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messageWindow.xul">mail/base/content/messageWindow.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messageWindow.xul">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messageWindow.xul">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messageWindow.xul">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messageWindow.xul">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messageWindow.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messenger.xul">mail/base/content/messenger.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messenger.xul">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messenger.xul">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messenger.xul">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messenger.xul">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/messenger.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/msgHdrViewOverlay.js">mail/base/content/msgHdrViewOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/msgHdrViewOverlay.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/msgHdrViewOverlay.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/msgHdrViewOverlay.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/msgHdrViewOverlay.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/msgHdrViewOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/phishingDetector.js">mail/base/content/phishingDetector.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/phishingDetector.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/phishingDetector.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/phishingDetector.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/phishingDetector.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/base/content/phishingDetector.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.properties">mail/locales/en-US/chrome/messenger/messenger.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.properties">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.properties">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.properties">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.properties">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/locales/en-US/chrome/messenger/messenger.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelApplication.js">mail/steel/steelApplication.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelApplication.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelApplication.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelApplication.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelApplication.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelApplication.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelIApplication.idl">mail/steel/steelIApplication.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelIApplication.idl">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelIApplication.idl">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelIApplication.idl">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelIApplication.idl">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/steelIApplication.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformChecks.js">mail/steel/test/test_linux_platformChecks.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformChecks.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformChecks.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformChecks.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformChecks.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformChecks.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformIsLinux.js">mail/steel/test/test_linux_platformIsLinux.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformIsLinux.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformIsLinux.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_linux_platformIsLinux.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformChecks.js">mail/steel/test/test_mac_platformChecks.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformChecks.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformChecks.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformChecks.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformChecks.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformChecks.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformIsLinux.js">mail/steel/test/test_mac_platformIsLinux.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformIsLinux.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformIsLinux.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_mac_platformIsLinux.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_other_platformIsLinux.js">mail/steel/test/test_other_platformIsLinux.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_other_platformIsLinux.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_other_platformIsLinux.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_other_platformIsLinux.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_windows_platformChecks.js">mail/steel/test/test_windows_platformChecks.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_windows_platformChecks.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_windows_platformChecks.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_windows_platformChecks.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_windows_platformChecks.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/test_windows_platformChecks.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/xpcshell.ini">mail/steel/test/xpcshell.ini</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/xpcshell.ini">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/xpcshell.ini">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/xpcshell.ini">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/xpcshell.ini">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/steel/test/xpcshell.ini">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-attachment-reminder.js">mail/test/mozmill/composition/test-attachment-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-attachment-reminder.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-attachment-reminder.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-attachment-reminder.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-attachment-reminder.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-attachment-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-drafts.js">mail/test/mozmill/composition/test-drafts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-drafts.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-drafts.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-drafts.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-drafts.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/composition/test-drafts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/content-policy/test-general-content-policy.js">mail/test/mozmill/content-policy/test-general-content-policy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/content-policy/test-general-content-policy.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/content-policy/test-general-content-policy.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/content-policy/test-general-content-policy.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/content-policy/test-general-content-policy.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/content-policy/test-general-content-policy.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-phishing-bar.js">mail/test/mozmill/message-header/test-phishing-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-phishing-bar.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-phishing-bar.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-phishing-bar.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-phishing-bar.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-phishing-bar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-return-receipt.js">mail/test/mozmill/message-header/test-return-receipt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-return-receipt.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-return-receipt.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-return-receipt.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-return-receipt.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/message-header/test-return-receipt.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-compose-helpers.js">mail/test/mozmill/shared-modules/test-compose-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-compose-helpers.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-compose-helpers.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-compose-helpers.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-compose-helpers.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-compose-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">mail/test/mozmill/shared-modules/test-notificationbox-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/junk.png">mail/themes/linux/mail/icons/junk.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/junk.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/junk.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/junk.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/junk.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/junk.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/phishing.png">mail/themes/linux/mail/icons/phishing.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/phishing.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/phishing.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/phishing.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/phishing.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/phishing.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/remote-blocked.png">mail/themes/linux/mail/icons/remote-blocked.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/remote-blocked.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/remote-blocked.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/remote-blocked.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/remote-blocked.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/icons/remote-blocked.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/primaryToolbar.css">mail/themes/linux/mail/primaryToolbar.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/primaryToolbar.css">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/primaryToolbar.css">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/primaryToolbar.css">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/primaryToolbar.css">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/linux/mail/primaryToolbar.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/jar.mn">mail/themes/osx/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/jar.mn">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/jar.mn">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/jar.mn">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/jar.mn">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/junk.png">mail/themes/osx/mail/icons/junk.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/junk.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/junk.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/junk.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/junk.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/junk.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/phishing.png">mail/themes/osx/mail/icons/phishing.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/phishing.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/phishing.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/phishing.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/phishing.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/phishing.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/remote-blocked.png">mail/themes/osx/mail/icons/remote-blocked.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/remote-blocked.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/remote-blocked.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/remote-blocked.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/remote-blocked.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/remote-blocked.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/warning.png">mail/themes/osx/mail/icons/warning.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/warning.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/warning.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/icons/warning.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/primaryToolbar.css">mail/themes/osx/mail/primaryToolbar.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/primaryToolbar.css">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/primaryToolbar.css">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/primaryToolbar.css">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/primaryToolbar.css">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/osx/mail/primaryToolbar.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/jar.mn">mail/themes/windows/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/jar.mn">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/jar.mn">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/jar.mn">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/jar.mn">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk-aero.png">mail/themes/windows/mail/icons/junk-aero.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk-aero.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk-aero.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk-aero.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk-aero.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk-aero.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk.png">mail/themes/windows/mail/icons/junk.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/junk.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing-aero.png">mail/themes/windows/mail/icons/phishing-aero.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing-aero.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing-aero.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing-aero.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing-aero.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing-aero.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing.png">mail/themes/windows/mail/icons/phishing.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/phishing.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked-aero.png">mail/themes/windows/mail/icons/remote-blocked-aero.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked-aero.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked-aero.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked-aero.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked-aero.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked-aero.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked.png">mail/themes/windows/mail/icons/remote-blocked.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked.png">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked.png">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked.png">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked.png">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/icons/remote-blocked.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar-aero.css">mail/themes/windows/mail/primaryToolbar-aero.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar-aero.css">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar-aero.css">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar-aero.css">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar-aero.css">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar-aero.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar.css">mail/themes/windows/mail/primaryToolbar.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar.css">file</a> |
<a href="/comm-central/annotate/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar.css">annotate</a> |
<a href="/comm-central/diff/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar.css">diff</a> |
<a href="/comm-central/comparison/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar.css">comparison</a> |
<a href="/comm-central/log/752e81dfb822ef5f2707d1ccc834bd9476a19db9/mail/themes/windows/mail/primaryToolbar.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -24,21 +24,16 @@ const kMailLayoutCommandMap =</span>
<a href="#l1.4"></a><span id="l1.4"> // Per message header flags to keep track of whether the user is allowing remote</span>
<a href="#l1.5"></a><span id="l1.5"> // content for a particular message.</span>
<a href="#l1.6"></a><span id="l1.6"> // if you change or add more values to these constants, be sure to modify</span>
<a href="#l1.7"></a><span id="l1.7"> // the corresponding definitions in nsMsgContentPolicy.cpp</span>
<a href="#l1.8"></a><span id="l1.8"> const kNoRemoteContentPolicy = 0;</span>
<a href="#l1.9"></a><span id="l1.9"> const kBlockRemoteContent = 1;</span>
<a href="#l1.10"></a><span id="l1.10"> const kAllowRemoteContent = 2;</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-const kMsgNotificationPhishingBar = 1;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-const kMsgNotificationJunkBar = 2;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-const kMsgNotificationRemoteImages = 3;</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-const kMsgNotificationMDN = 4;</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-</span>
<a href="#l1.17"></a><span id="l1.17"> Components.utils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l1.18"></a><span id="l1.18"> Components.utils.import(&quot;resource:///modules/MailConsts.js&quot;);</span>
<a href="#l1.19"></a><span id="l1.19"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21"> // Timer to mark read, if the user has configured the app to mark a message as</span>
<a href="#l1.22"></a><span id="l1.22"> // read if it is viewed for more than n seconds.</span>
<a href="#l1.23"></a><span id="l1.23"> var gMarkViewedMessageAsReadTimer = null;</span>
<a href="#l1.24"></a><span id="l1.24"> </span>
<a href="#l1.25"></a><span id="l1.25" class="difflineat">@@ -2765,158 +2760,264 @@ function HandleJunkStatusChanged(folder)</span>
<a href="#l1.26"></a><span id="l1.26">   // and attachment (or on disk), in which case, we want to ignore it.</span>
<a href="#l1.27"></a><span id="l1.27">   if (!gMessageDisplay.displayedMessage ||</span>
<a href="#l1.28"></a><span id="l1.28">       gMessageDisplay.isDummy ||</span>
<a href="#l1.29"></a><span id="l1.29">       gFolderDisplay.displayedFolder != folder)</span>
<a href="#l1.30"></a><span id="l1.30">     return;</span>
<a href="#l1.31"></a><span id="l1.31"> </span>
<a href="#l1.32"></a><span id="l1.32">   // If multiple message are selected and we change the junk status</span>
<a href="#l1.33"></a><span id="l1.33">   // we don't want to show the junk bar (since the message pane is blank).</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-  var msgHdr = null;</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-  if (GetNumSelectedMessages() == 1)</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-    msgHdr = gMessageDisplay.displayedMessage;</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineminus">-  var junkBarWasDisplayed = gMessageNotificationBar.isFlagSet(kMsgNotificationJunkBar);</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+  let msgHdr = (GetNumSelectedMessages() == 1) ?</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+    gMessageDisplay.displayedMessage : null;</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+  let junkBarWasDisplayed = gMessageNotificationBar.isShowingJunkNotification();</span>
<a href="#l1.41"></a><span id="l1.41">   gMessageNotificationBar.setJunkMsg(msgHdr);</span>
<a href="#l1.42"></a><span id="l1.42"> </span>
<a href="#l1.43"></a><span id="l1.43">   // Only reload message if junk bar display state has changed.</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-  if (msgHdr &amp;&amp; junkBarWasDisplayed != gMessageNotificationBar.isFlagSet(kMsgNotificationJunkBar))</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+  if (msgHdr &amp;&amp; junkBarWasDisplayed != gMessageNotificationBar.isShowingJunkNotification())</span>
<a href="#l1.46"></a><span id="l1.46">   {</span>
<a href="#l1.47"></a><span id="l1.47">     // We may be forcing junk mail to be rendered with sanitized html.</span>
<a href="#l1.48"></a><span id="l1.48">     // In that scenario, we want to reload the message if the status has just</span>
<a href="#l1.49"></a><span id="l1.49">     // changed to not junk.</span>
<a href="#l1.50"></a><span id="l1.50">     var sanitizeJunkMail = Services.prefs.getBoolPref(&quot;mail.spam.display.sanitize&quot;);</span>
<a href="#l1.51"></a><span id="l1.51"> </span>
<a href="#l1.52"></a><span id="l1.52">     // Only bother doing this if we are modifying the html for junk mail....</span>
<a href="#l1.53"></a><span id="l1.53">     if (sanitizeJunkMail)</span>
<a href="#l1.54"></a><span id="l1.54">     {</span>
<a href="#l1.55"></a><span id="l1.55">       let junkScore = msgHdr.getStringProperty(&quot;junkscore&quot;);</span>
<a href="#l1.56"></a><span id="l1.56">       let isJunk = (junkScore == Components.interfaces.nsIJunkMailPlugin.IS_SPAM_SCORE);</span>
<a href="#l1.57"></a><span id="l1.57"> </span>
<a href="#l1.58"></a><span id="l1.58" class="difflineminus">-      // If the current row  isn't going to change, reload to show sanitized or</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineplus">+      // If the current row isn't going to change, reload to show sanitized or</span>
<a href="#l1.60"></a><span id="l1.60">       // unsanitized. Otherwise we wouldn't see the reloaded version anyway.</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineminus">-      // 1) When marking as non-junk, the msg would move back to the inbox.</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineplus">+      // 1) When marking as non-junk from the Junk folder, the msg would move</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineplus">+      //    back to the Inbox -&gt; no reload needed</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineplus">+      //    When marking as non-junk from a folder other than the Junk folder,</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineplus">+      //    the message isn't moved back to Inbox -&gt; reload needed</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineplus">+      //    (see nsMsgDBView::DetermineActionsForJunkChange)</span>
<a href="#l1.68"></a><span id="l1.68">       // 2) When marking as junk, the msg will move or delete, if manualMark is set.</span>
<a href="#l1.69"></a><span id="l1.69">       // 3) Marking as junk in the junk folder just changes the junk status.</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineminus">-      if ((!isJunk &amp;&amp; folder.isSpecialFolder(Components.interfaces.nsMsgFolderFlags.Inbox)) ||</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineplus">+      const nsMsgFolderFlags = Components.interfaces.nsMsgFolderFlags;</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineplus">+      if ((!isJunk &amp;&amp; !folder.isSpecialFolder(nsMsgFolderFlags.Junk)) ||</span>
<a href="#l1.73"></a><span id="l1.73">           (isJunk &amp;&amp; !folder.server.spamSettings.manualMark) ||</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineminus">-          (isJunk &amp;&amp; folder.isSpecialFolder(Components.interfaces.nsMsgFolderFlags.Junk)))</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineplus">+          (isJunk &amp;&amp; folder.isSpecialFolder(nsMsgFolderFlags.Junk)))</span>
<a href="#l1.76"></a><span id="l1.76">         ReloadMessage();</span>
<a href="#l1.77"></a><span id="l1.77">     }</span>
<a href="#l1.78"></a><span id="l1.78">   }</span>
<a href="#l1.79"></a><span id="l1.79"> }</span>
<a href="#l1.80"></a><span id="l1.80"> </span>
<a href="#l1.81"></a><span id="l1.81" class="difflineplus">+/**</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+ * Object to handle message related notifications that are showing in a</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineplus">+ * notificationbox above the message content.</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineplus">+ */</span>
<a href="#l1.85"></a><span id="l1.85"> var gMessageNotificationBar =</span>
<a href="#l1.86"></a><span id="l1.86"> {</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineminus">-  mBarStatus: 0,</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineminus">-  // flag bit values for mBarStatus, indexed by kMsgNotificationXXX</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineminus">-  mBarFlagValues: [</span>
<a href="#l1.90"></a><span id="l1.90" class="difflineminus">-                    0, // for no msgNotificationBar</span>
<a href="#l1.91"></a><span id="l1.91" class="difflineminus">-                    1, // 1 &lt;&lt; (kMsgNotificationPhishingBar - 1)</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineminus">-                    2, // 1 &lt;&lt; (kMsgNotificationJunkBar - 1)</span>
<a href="#l1.93"></a><span id="l1.93" class="difflineminus">-                    4, // 1 &lt;&lt; (kMsgNotificationRemoteImages - 1)</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineminus">-                    8  // 1 &lt;&lt; (kMsgNotificationMDN - 1)</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineminus">-                  ],</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineminus">-</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineminus">-  get mMsgNotificationBar() {</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineminus">-    delete this.mMsgNotificationBar;</span>
<a href="#l1.99"></a><span id="l1.99" class="difflineminus">-    return this.mMsgNotificationBar = document.getElementById('msgNotificationBar');</span>
<a href="#l1.100"></a><span id="l1.100" class="difflineplus">+  get stringBundle() {</span>
<a href="#l1.101"></a><span id="l1.101" class="difflineplus">+    delete this.stringBundle;</span>
<a href="#l1.102"></a><span id="l1.102" class="difflineplus">+    return this.stringBundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineplus">+  },</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineplus">+</span>
<a href="#l1.105"></a><span id="l1.105" class="difflineplus">+  get brandBundle() {</span>
<a href="#l1.106"></a><span id="l1.106" class="difflineplus">+    delete this.brandBundle;</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineplus">+    return this.brandBundle = document.getElementById(&quot;brand_bundle&quot;);</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineplus">+  },</span>
<a href="#l1.109"></a><span id="l1.109" class="difflineplus">+</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineplus">+  get msgNotificationBar() {</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineplus">+    delete this.msgNotificationBar;</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineplus">+    return this.msgNotificationBar = document.getElementById(&quot;msgNotificationBar&quot;);</span>
<a href="#l1.113"></a><span id="l1.113">   },</span>
<a href="#l1.114"></a><span id="l1.114"> </span>
<a href="#l1.115"></a><span id="l1.115">   setJunkMsg: function(aMsgHdr)</span>
<a href="#l1.116"></a><span id="l1.116">   {</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-    var isJunk = false;</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineminus">-</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineminus">-    if (aMsgHdr)</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineplus">+    goUpdateCommand(&quot;button_junk&quot;);</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineplus">+</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineplus">+    let brandName = this.brandBundle.getString(&quot;brandShortName&quot;);</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineplus">+    let junkBarMsg = this.stringBundle.getFormattedString(&quot;junkBarMessage&quot;,</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineplus">+                                                          [brandName]);</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineplus">+</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineplus">+    let junkScore = aMsgHdr.getStringProperty(&quot;junkscore&quot;);</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineplus">+    if (!((junkScore != &quot;&quot;) &amp;&amp;</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+          (junkScore != Components.interfaces.nsIJunkMailPlugin.IS_HAM_SCORE))) {</span>
<a href="#l1.129"></a><span id="l1.129" class="difflineplus">+      // not junk -&gt; just close the notificaion then, if one was showing</span>
<a href="#l1.130"></a><span id="l1.130" class="difflineplus">+      let item = this.msgNotificationBar.getNotificationWithValue(&quot;junkContent&quot;);</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineplus">+      if (item)</span>
<a href="#l1.132"></a><span id="l1.132" class="difflineplus">+        this.msgNotificationBar.removeNotification(item, true);</span>
<a href="#l1.133"></a><span id="l1.133" class="difflineplus">+      return;</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineplus">+    }</span>
<a href="#l1.135"></a><span id="l1.135" class="difflineplus">+</span>
<a href="#l1.136"></a><span id="l1.136" class="difflineplus">+    let buttons = [{</span>
<a href="#l1.137"></a><span id="l1.137" class="difflineplus">+      label: this.stringBundle.getString(&quot;junkBarInfoButton&quot;),</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineplus">+      accessKey: this.stringBundle.getString(&quot;junkBarInfoButtonKey&quot;),</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineplus">+      popup: null,</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineplus">+      callback: function(aNotification, aButton) {</span>
<a href="#l1.141"></a><span id="l1.141" class="difflineplus">+        MsgJunkMailInfo(false);</span>
<a href="#l1.142"></a><span id="l1.142" class="difflineplus">+        return true; // keep notification open</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineplus">+      }</span>
<a href="#l1.144"></a><span id="l1.144" class="difflineplus">+    },</span>
<a href="#l1.145"></a><span id="l1.145">     {</span>
<a href="#l1.146"></a><span id="l1.146" class="difflineminus">-      var junkScore = aMsgHdr.getStringProperty(&quot;junkscore&quot;);</span>
<a href="#l1.147"></a><span id="l1.147" class="difflineminus">-      isJunk = ((junkScore != &quot;&quot;) &amp;&amp; (junkScore != &quot;0&quot;));</span>
<a href="#l1.148"></a><span id="l1.148" class="difflineplus">+      label: this.stringBundle.getString(&quot;junkBarButton&quot;),</span>
<a href="#l1.149"></a><span id="l1.149" class="difflineplus">+      accessKey: this.stringBundle.getString(&quot;junkBarButtonKey&quot;),</span>
<a href="#l1.150"></a><span id="l1.150" class="difflineplus">+      popup: null,</span>
<a href="#l1.151"></a><span id="l1.151" class="difflineplus">+      callback: function(aNotification, aButton) {</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineplus">+        JunkSelectedMessages(false);</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineplus">+        // Return true (=don't close) since changing junk status will fire a</span>
<a href="#l1.154"></a><span id="l1.154" class="difflineplus">+        // JunkStatusChanged notification which will make the junk bar go away</span>
<a href="#l1.155"></a><span id="l1.155" class="difflineplus">+        // for this message -&gt; no notifcation to close anymore -&gt; trying to</span>
<a href="#l1.156"></a><span id="l1.156" class="difflineplus">+        // close would just fail.</span>
<a href="#l1.157"></a><span id="l1.157" class="difflineplus">+        return true;</span>
<a href="#l1.158"></a><span id="l1.158" class="difflineplus">+      }</span>
<a href="#l1.159"></a><span id="l1.159" class="difflineplus">+    }];</span>
<a href="#l1.160"></a><span id="l1.160" class="difflineplus">+</span>
<a href="#l1.161"></a><span id="l1.161" class="difflineplus">+    if (!this.isShowingJunkNotification()) {</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineplus">+      this.msgNotificationBar.appendNotification(junkBarMsg, &quot;junkContent&quot;,</span>
<a href="#l1.163"></a><span id="l1.163" class="difflineplus">+        &quot;chrome://messenger/skin/icons/junk.png&quot;,</span>
<a href="#l1.164"></a><span id="l1.164" class="difflineplus">+        this.msgNotificationBar.PRIORITY_WARNING_HIGH,</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineplus">+        buttons);</span>
<a href="#l1.166"></a><span id="l1.166">     }</span>
<a href="#l1.167"></a><span id="l1.167" class="difflineminus">-</span>
<a href="#l1.168"></a><span id="l1.168" class="difflineminus">-    this.updateMsgNotificationBar(kMsgNotificationJunkBar, isJunk);</span>
<a href="#l1.169"></a><span id="l1.169" class="difflineminus">-</span>
<a href="#l1.170"></a><span id="l1.170" class="difflineminus">-    goUpdateCommand('button_junk');</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineplus">+  },</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineplus">+</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineplus">+  isShowingJunkNotification: function() {</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineplus">+    return !!this.msgNotificationBar.getNotificationWithValue(&quot;junkContent&quot;);</span>
<a href="#l1.175"></a><span id="l1.175">   },</span>
<a href="#l1.176"></a><span id="l1.176"> </span>
<a href="#l1.177"></a><span id="l1.177">   setRemoteContentMsg: function(aMsgHdr)</span>
<a href="#l1.178"></a><span id="l1.178">   {</span>
<a href="#l1.179"></a><span id="l1.179">     // update the allow remote content for sender string</span>
<a href="#l1.180"></a><span id="l1.180">     let emailAddress = MailServices.headerParser.extractHeaderAddressMailboxes(aMsgHdr.author);</span>
<a href="#l1.181"></a><span id="l1.181">     var desc = document.getElementById(&quot;bundle_messenger&quot;)</span>
<a href="#l1.182"></a><span id="l1.182">                        .getFormattedString(&quot;alwaysLoadRemoteContentForSender2&quot;,</span>
<a href="#l1.183"></a><span id="l1.183">                                            [emailAddress ? emailAddress : aMsgHdr.author]);</span>
<a href="#l1.184"></a><span id="l1.184" class="difflineminus">-    var authorDesc = document.getElementById(&quot;allowRemoteContentForAuthorDesc&quot;);</span>
<a href="#l1.185"></a><span id="l1.185" class="difflineminus">-    authorDesc.value = desc;</span>
<a href="#l1.186"></a><span id="l1.186" class="difflineminus">-    authorDesc.setAttribute(&quot;tooltiptext&quot;, desc);</span>
<a href="#l1.187"></a><span id="l1.187" class="difflineminus">-    this.updateMsgNotificationBar(kMsgNotificationRemoteImages, true);</span>
<a href="#l1.188"></a><span id="l1.188" class="difflineplus">+    let displayName = MailServices.headerParser.extractHeaderAddressName(aMsgHdr.author);</span>
<a href="#l1.189"></a><span id="l1.189" class="difflineplus">+    let brandName = this.brandBundle.getString(&quot;brandShortName&quot;);</span>
<a href="#l1.190"></a><span id="l1.190" class="difflineplus">+    let remoteContentMsg = this.stringBundle.getFormattedString(&quot;remoteContentBarMessage&quot;,</span>
<a href="#l1.191"></a><span id="l1.191" class="difflineplus">+                                                                [brandName]);</span>
<a href="#l1.192"></a><span id="l1.192" class="difflineplus">+</span>
<a href="#l1.193"></a><span id="l1.193" class="difflineplus">+    let buttonLabel = this.stringBundle.getString(Application.platformIsWindows ?</span>
<a href="#l1.194"></a><span id="l1.194" class="difflineplus">+      &quot;remoteContentPrefLabel&quot; : &quot;remoteContentPrefLabelUnix&quot;);</span>
<a href="#l1.195"></a><span id="l1.195" class="difflineplus">+    let buttonAccesskey = this.stringBundle.getString(Application.platformIsWindows ?</span>
<a href="#l1.196"></a><span id="l1.196" class="difflineplus">+      &quot;remoteContentPrefAccesskey&quot; : &quot;remoteContentPrefAccesskeyUnix&quot;);</span>
<a href="#l1.197"></a><span id="l1.197" class="difflineplus">+</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineplus">+    let buttons = [{</span>
<a href="#l1.199"></a><span id="l1.199" class="difflineplus">+      label: buttonLabel,</span>
<a href="#l1.200"></a><span id="l1.200" class="difflineplus">+      accessKey: buttonAccesskey,</span>
<a href="#l1.201"></a><span id="l1.201" class="difflineplus">+      popup: &quot;remoteContentOptions&quot;,</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineplus">+      callback: function() { }</span>
<a href="#l1.203"></a><span id="l1.203" class="difflineplus">+    }];</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineplus">+</span>
<a href="#l1.205"></a><span id="l1.205" class="difflineplus">+    if (!this.isShowingRemoteContentNotification()) {</span>
<a href="#l1.206"></a><span id="l1.206" class="difflineplus">+      this.msgNotificationBar.appendNotification(remoteContentMsg, &quot;remoteContent&quot;,</span>
<a href="#l1.207"></a><span id="l1.207" class="difflineplus">+        &quot;chrome://messenger/skin/icons/remote-blocked.png&quot;,</span>
<a href="#l1.208"></a><span id="l1.208" class="difflineplus">+        this.msgNotificationBar.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+        buttons);</span>
<a href="#l1.210"></a><span id="l1.210" class="difflineplus">+    }</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineplus">+  },</span>
<a href="#l1.212"></a><span id="l1.212" class="difflineplus">+</span>
<a href="#l1.213"></a><span id="l1.213" class="difflineplus">+  isShowingRemoteContentNotification: function() {</span>
<a href="#l1.214"></a><span id="l1.214" class="difflineplus">+    return !!this.msgNotificationBar.getNotificationWithValue(&quot;remoteContent&quot;);</span>
<a href="#l1.215"></a><span id="l1.215">   },</span>
<a href="#l1.216"></a><span id="l1.216"> </span>
<a href="#l1.217"></a><span id="l1.217">   setPhishingMsg: function()</span>
<a href="#l1.218"></a><span id="l1.218">   {</span>
<a href="#l1.219"></a><span id="l1.219" class="difflineminus">-    this.updateMsgNotificationBar(kMsgNotificationPhishingBar, true);</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineplus">+    let phishingMsgNote = this.stringBundle.getString(&quot;phishingBarMessage&quot;);</span>
<a href="#l1.221"></a><span id="l1.221" class="difflineplus">+</span>
<a href="#l1.222"></a><span id="l1.222" class="difflineplus">+    let buttonLabel = this.stringBundle.getString(Application.platformIsWindows ?</span>
<a href="#l1.223"></a><span id="l1.223" class="difflineplus">+      &quot;phishingBarPrefLabel&quot; : &quot;phishingBarPrefLabelUnix&quot;);</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineplus">+    let buttonAccesskey = this.stringBundle.getString(Application.platformIsWindows ?</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineplus">+      &quot;phishingBarPrefAccesskey&quot; : &quot;phishingBarPrefAccesskeyUnix&quot;);</span>
<a href="#l1.226"></a><span id="l1.226" class="difflineplus">+</span>
<a href="#l1.227"></a><span id="l1.227" class="difflineplus">+    let buttons = [</span>
<a href="#l1.228"></a><span id="l1.228" class="difflineplus">+    {</span>
<a href="#l1.229"></a><span id="l1.229" class="difflineplus">+      label: buttonLabel,</span>
<a href="#l1.230"></a><span id="l1.230" class="difflineplus">+      accessKey: buttonAccesskey,</span>
<a href="#l1.231"></a><span id="l1.231" class="difflineplus">+      popup: &quot;phishingOptions&quot;,</span>
<a href="#l1.232"></a><span id="l1.232" class="difflineplus">+      callback: function(aNotification, aButton) { }</span>
<a href="#l1.233"></a><span id="l1.233" class="difflineplus">+    }];</span>
<a href="#l1.234"></a><span id="l1.234" class="difflineplus">+</span>
<a href="#l1.235"></a><span id="l1.235" class="difflineplus">+    if (!this.isShowingPhishingNotification()) {</span>
<a href="#l1.236"></a><span id="l1.236" class="difflineplus">+       this.msgNotificationBar.appendNotification(phishingMsgNote, &quot;maybeScam&quot;,</span>
<a href="#l1.237"></a><span id="l1.237" class="difflineplus">+         &quot;chrome://messenger/skin/icons/phishing.png&quot;,</span>
<a href="#l1.238"></a><span id="l1.238" class="difflineplus">+         this.msgNotificationBar.PRIORITY_CRITICAL_MEDIUM,</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineplus">+         buttons);</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineplus">+    }</span>
<a href="#l1.241"></a><span id="l1.241" class="difflineplus">+  },</span>
<a href="#l1.242"></a><span id="l1.242" class="difflineplus">+</span>
<a href="#l1.243"></a><span id="l1.243" class="difflineplus">+  isShowingPhishingNotification: function() {</span>
<a href="#l1.244"></a><span id="l1.244" class="difflineplus">+    return !!this.msgNotificationBar.getNotificationWithValue(&quot;maybeScam&quot;);</span>
<a href="#l1.245"></a><span id="l1.245">   },</span>
<a href="#l1.246"></a><span id="l1.246"> </span>
<a href="#l1.247"></a><span id="l1.247">   setMDNMsg: function(aMdnGenerator, aMsgHeader, aMimeHdr)</span>
<a href="#l1.248"></a><span id="l1.248">   {</span>
<a href="#l1.249"></a><span id="l1.249">     this.mdnGenerator = aMdnGenerator;</span>
<a href="#l1.250"></a><span id="l1.250">     // Return receipts can be RFC 3798 or not.</span>
<a href="#l1.251"></a><span id="l1.251">     let mdnHdr = aMimeHdr.extractHeader(&quot;Disposition-Notification-To&quot;, false) ||</span>
<a href="#l1.252"></a><span id="l1.252">                  aMimeHdr.extractHeader(&quot;Return-Receipt-To&quot;, false); // not</span>
<a href="#l1.253"></a><span id="l1.253">     let fromHdr = aMimeHdr.extractHeader(&quot;From&quot;, false);</span>
<a href="#l1.254"></a><span id="l1.254"> </span>
<a href="#l1.255"></a><span id="l1.255">     let mdnAddr = MailServices.headerParser.extractHeaderAddressMailboxes(mdnHdr);</span>
<a href="#l1.256"></a><span id="l1.256">     let fromAddr = MailServices.headerParser.extractHeaderAddressMailboxes(fromHdr);</span>
<a href="#l1.257"></a><span id="l1.257"> </span>
<a href="#l1.258"></a><span id="l1.258">     let authorName = MailServices.headerParser.extractHeaderAddressName(</span>
<a href="#l1.259"></a><span id="l1.259">                        aMsgHeader.mime2DecodedAuthor) || aMsgHeader.author;</span>
<a href="#l1.260"></a><span id="l1.260"> </span>
<a href="#l1.261"></a><span id="l1.261" class="difflineminus">-    let mdnBarMsg = document.getElementById(&quot;mdnBarMessage&quot;);</span>
<a href="#l1.262"></a><span id="l1.262" class="difflineminus">-    if (mdnBarMsg.firstChild) // might have to remove old text first</span>
<a href="#l1.263"></a><span id="l1.263" class="difflineminus">-     mdnBarMsg.removeChild(mdnBarMsg.firstChild);</span>
<a href="#l1.264"></a><span id="l1.264" class="difflineminus">-</span>
<a href="#l1.265"></a><span id="l1.265" class="difflineminus">-    var bundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l1.266"></a><span id="l1.266" class="difflineminus">-    var barMsg;</span>
<a href="#l1.267"></a><span id="l1.267">     // If the return receipt doesn't go to the sender address, note that in the</span>
<a href="#l1.268"></a><span id="l1.268">     // notification.</span>
<a href="#l1.269"></a><span id="l1.269" class="difflineminus">-    if (mdnAddr != fromAddr)</span>
<a href="#l1.270"></a><span id="l1.270" class="difflineminus">-      barMsg = bundle.getFormattedString(&quot;mdnBarMessageAddressDiffers&quot;,</span>
<a href="#l1.271"></a><span id="l1.271" class="difflineminus">-                                         [authorName, mdnAddr]);</span>
<a href="#l1.272"></a><span id="l1.272" class="difflineminus">-    else</span>
<a href="#l1.273"></a><span id="l1.273" class="difflineminus">-      barMsg = bundle.getFormattedString(&quot;mdnBarMessageNormal&quot;, [authorName]);</span>
<a href="#l1.274"></a><span id="l1.274" class="difflineminus">-    mdnBarMsg.appendChild(document.createTextNode(barMsg));</span>
<a href="#l1.275"></a><span id="l1.275" class="difflineminus">-    this.updateMsgNotificationBar(kMsgNotificationMDN, true);</span>
<a href="#l1.276"></a><span id="l1.276" class="difflineplus">+    let mdnBarMsg = (mdnAddr != fromAddr) ?</span>
<a href="#l1.277"></a><span id="l1.277" class="difflineplus">+      this.stringBundle.getFormattedString(&quot;mdnBarMessageAddressDiffers&quot;,</span>
<a href="#l1.278"></a><span id="l1.278" class="difflineplus">+                                            [authorName, mdnAddr]) :</span>
<a href="#l1.279"></a><span id="l1.279" class="difflineplus">+      this.stringBundle.getFormattedString(&quot;mdnBarMessageNormal&quot;, [authorName]);</span>
<a href="#l1.280"></a><span id="l1.280" class="difflineplus">+</span>
<a href="#l1.281"></a><span id="l1.281" class="difflineplus">+    let buttons = [{</span>
<a href="#l1.282"></a><span id="l1.282" class="difflineplus">+      label: this.stringBundle.getString(&quot;mdnBarSendReqButton&quot;),</span>
<a href="#l1.283"></a><span id="l1.283" class="difflineplus">+      accessKey: this.stringBundle.getString(&quot;mdnBarSendReqButtonKey&quot;),</span>
<a href="#l1.284"></a><span id="l1.284" class="difflineplus">+      popup: null,</span>
<a href="#l1.285"></a><span id="l1.285" class="difflineplus">+      callback: function(aNotification, aButton) {</span>
<a href="#l1.286"></a><span id="l1.286" class="difflineplus">+        SendMDNResponse();</span>
<a href="#l1.287"></a><span id="l1.287" class="difflineplus">+        return false; // close notification</span>
<a href="#l1.288"></a><span id="l1.288" class="difflineplus">+      }</span>
<a href="#l1.289"></a><span id="l1.289" class="difflineplus">+    },</span>
<a href="#l1.290"></a><span id="l1.290" class="difflineplus">+    {</span>
<a href="#l1.291"></a><span id="l1.291" class="difflineplus">+      label: this.stringBundle.getString(&quot;mdnBarIgnoreButton&quot;),</span>
<a href="#l1.292"></a><span id="l1.292" class="difflineplus">+      accessKey: this.stringBundle.getString(&quot;mdnBarIgnoreButtonKey&quot;),</span>
<a href="#l1.293"></a><span id="l1.293" class="difflineplus">+      popup: null,</span>
<a href="#l1.294"></a><span id="l1.294" class="difflineplus">+      callback: function(aNotification, aButton) {</span>
<a href="#l1.295"></a><span id="l1.295" class="difflineplus">+        IgnoreMDNResponse();</span>
<a href="#l1.296"></a><span id="l1.296" class="difflineplus">+        return false; // close notification</span>
<a href="#l1.297"></a><span id="l1.297" class="difflineplus">+      }</span>
<a href="#l1.298"></a><span id="l1.298" class="difflineplus">+    }];</span>
<a href="#l1.299"></a><span id="l1.299" class="difflineplus">+</span>
<a href="#l1.300"></a><span id="l1.300" class="difflineplus">+    this.msgNotificationBar.appendNotification(mdnBarMsg, &quot;mdnRequested&quot;,</span>
<a href="#l1.301"></a><span id="l1.301" class="difflineplus">+      null, this.msgNotificationBar.PRIORITY_INFO_MEDIUM, buttons);</span>
<a href="#l1.302"></a><span id="l1.302" class="difflineplus">+  },</span>
<a href="#l1.303"></a><span id="l1.303" class="difflineplus">+</span>
<a href="#l1.304"></a><span id="l1.304" class="difflineplus">+  setDraftEditMessage: function() {</span>
<a href="#l1.305"></a><span id="l1.305" class="difflineplus">+   let msgHdr = gFolderDisplay.selectedMessage;</span>
<a href="#l1.306"></a><span id="l1.306" class="difflineplus">+   if (!msgHdr || !msgHdr.folder)</span>
<a href="#l1.307"></a><span id="l1.307" class="difflineplus">+     return;</span>
<a href="#l1.308"></a><span id="l1.308" class="difflineplus">+</span>
<a href="#l1.309"></a><span id="l1.309" class="difflineplus">+   const nsMsgFolderFlags = Components.interfaces.nsMsgFolderFlags;</span>
<a href="#l1.310"></a><span id="l1.310" class="difflineplus">+   if (msgHdr.folder.isSpecialFolder(nsMsgFolderFlags.Drafts, true))</span>
<a href="#l1.311"></a><span id="l1.311" class="difflineplus">+   {</span>
<a href="#l1.312"></a><span id="l1.312" class="difflineplus">+    let draftMsgNote = this.stringBundle.getString(&quot;draftMessageMsg&quot;);</span>
<a href="#l1.313"></a><span id="l1.313" class="difflineplus">+</span>
<a href="#l1.314"></a><span id="l1.314" class="difflineplus">+    let buttons = [{</span>
<a href="#l1.315"></a><span id="l1.315" class="difflineplus">+      label: this.stringBundle.getString(&quot;draftMessageButton&quot;),</span>
<a href="#l1.316"></a><span id="l1.316" class="difflineplus">+      accessKey: this.stringBundle.getString(&quot;draftMessageButtonKey&quot;),</span>
<a href="#l1.317"></a><span id="l1.317" class="difflineplus">+      popup: null,</span>
<a href="#l1.318"></a><span id="l1.318" class="difflineplus">+      callback: function(aNotification, aButton) {</span>
<a href="#l1.319"></a><span id="l1.319" class="difflineplus">+        MsgComposeDraftMessage();</span>
<a href="#l1.320"></a><span id="l1.320" class="difflineplus">+        return true; // keep notification open</span>
<a href="#l1.321"></a><span id="l1.321" class="difflineplus">+      }</span>
<a href="#l1.322"></a><span id="l1.322" class="difflineplus">+    }];</span>
<a href="#l1.323"></a><span id="l1.323" class="difflineplus">+</span>
<a href="#l1.324"></a><span id="l1.324" class="difflineplus">+    this.msgNotificationBar.appendNotification(draftMsgNote, &quot;draftMsgContent&quot;,</span>
<a href="#l1.325"></a><span id="l1.325" class="difflineplus">+      null, this.msgNotificationBar.PRIORITY_INFO_HIGH, buttons);</span>
<a href="#l1.326"></a><span id="l1.326" class="difflineplus">+   }</span>
<a href="#l1.327"></a><span id="l1.327">   },</span>
<a href="#l1.328"></a><span id="l1.328"> </span>
<a href="#l1.329"></a><span id="l1.329">   clearMsgNotifications: function()</span>
<a href="#l1.330"></a><span id="l1.330">   {</span>
<a href="#l1.331"></a><span id="l1.331" class="difflineminus">-    this.mBarStatus = 0;</span>
<a href="#l1.332"></a><span id="l1.332" class="difflineminus">-    this.mMsgNotificationBar.selectedIndex = 0;</span>
<a href="#l1.333"></a><span id="l1.333" class="difflineminus">-    this.mMsgNotificationBar.collapsed = true;</span>
<a href="#l1.334"></a><span id="l1.334" class="difflineminus">-  },</span>
<a href="#l1.335"></a><span id="l1.335" class="difflineminus">-</span>
<a href="#l1.336"></a><span id="l1.336" class="difflineminus">-  updateMsgNotificationBar: function(aIndex, aSet)</span>
<a href="#l1.337"></a><span id="l1.337" class="difflineminus">-  {</span>
<a href="#l1.338"></a><span id="l1.338" class="difflineminus">-    var chunk = this.mBarFlagValues[aIndex];</span>
<a href="#l1.339"></a><span id="l1.339" class="difflineminus">-    var status = aSet ? this.mBarStatus | chunk : this.mBarStatus &amp; ~chunk;</span>
<a href="#l1.340"></a><span id="l1.340" class="difflineminus">-    this.mBarStatus = status;</span>
<a href="#l1.341"></a><span id="l1.341" class="difflineminus">-</span>
<a href="#l1.342"></a><span id="l1.342" class="difflineminus">-    // the phishing message takes precedence over the junk message</span>
<a href="#l1.343"></a><span id="l1.343" class="difflineminus">-    // which takes precedence over the remote content message</span>
<a href="#l1.344"></a><span id="l1.344" class="difflineminus">-    this.mMsgNotificationBar.selectedIndex = this.mBarFlagValues.indexOf(status &amp; -status);</span>
<a href="#l1.345"></a><span id="l1.345" class="difflineminus">-    this.mMsgNotificationBar.collapsed = !status;</span>
<a href="#l1.346"></a><span id="l1.346" class="difflineminus">-  },</span>
<a href="#l1.347"></a><span id="l1.347" class="difflineminus">-</span>
<a href="#l1.348"></a><span id="l1.348" class="difflineminus">-  /**</span>
<a href="#l1.349"></a><span id="l1.349" class="difflineminus">-   * @param aFlag one of the |mBarFlagValues| values</span>
<a href="#l1.350"></a><span id="l1.350" class="difflineminus">-   * @return true if aFlag is currently set for the loaded message</span>
<a href="#l1.351"></a><span id="l1.351" class="difflineminus">-   */</span>
<a href="#l1.352"></a><span id="l1.352" class="difflineminus">-  isFlagSet: function(aFlag)</span>
<a href="#l1.353"></a><span id="l1.353" class="difflineminus">-  {</span>
<a href="#l1.354"></a><span id="l1.354" class="difflineminus">-    var chunk = this.mBarFlagValues[aFlag];</span>
<a href="#l1.355"></a><span id="l1.355" class="difflineminus">-    return this.mBarStatus &amp; chunk;</span>
<a href="#l1.356"></a><span id="l1.356" class="difflineplus">+    this.msgNotificationBar.removeAllNotifications(true);</span>
<a href="#l1.357"></a><span id="l1.357">   }</span>
<a href="#l1.358"></a><span id="l1.358"> };</span>
<a href="#l1.359"></a><span id="l1.359"> </span>
<a href="#l1.360"></a><span id="l1.360"> /**</span>
<a href="#l1.361"></a><span id="l1.361">  * LoadMsgWithRemoteContent</span>
<a href="#l1.362"></a><span id="l1.362">  *   Reload the current message, allowing remote content</span>
<a href="#l1.363"></a><span id="l1.363">  */</span>
<a href="#l1.364"></a><span id="l1.364"> function LoadMsgWithRemoteContent()</span>
<a href="#l1.365"></a><span id="l1.365" class="difflineat">@@ -2933,29 +3034,26 @@ function LoadMsgWithRemoteContent()</span>
<a href="#l1.366"></a><span id="l1.366">  *  Reloads the message after adjusting the remote content policy for the sender.</span>
<a href="#l1.367"></a><span id="l1.367">  *  Iterate through the local address books looking for a card with the same e-mail address as the</span>
<a href="#l1.368"></a><span id="l1.368">  *  sender of the current loaded message. If we find a card, update the allow remote content field.</span>
<a href="#l1.369"></a><span id="l1.369">  *  If we can't find a card, prompt the user with a new AB card dialog, pre-selecting the remote content field.</span>
<a href="#l1.370"></a><span id="l1.370">  */</span>
<a href="#l1.371"></a><span id="l1.371"> function allowRemoteContentForSender()</span>
<a href="#l1.372"></a><span id="l1.372"> {</span>
<a href="#l1.373"></a><span id="l1.373">   // get the sender of the msg hdr</span>
<a href="#l1.374"></a><span id="l1.374" class="difflineminus">-  var msgHdr = gMessageDisplay.displayedMessage;</span>
<a href="#l1.375"></a><span id="l1.375" class="difflineplus">+  let msgHdr = gMessageDisplay.displayedMessage;</span>
<a href="#l1.376"></a><span id="l1.376">   if (!msgHdr)</span>
<a href="#l1.377"></a><span id="l1.377">     return;</span>
<a href="#l1.378"></a><span id="l1.378"> </span>
<a href="#l1.379"></a><span id="l1.379" class="difflineminus">-  var names = {};</span>
<a href="#l1.380"></a><span id="l1.380" class="difflineminus">-  var addresses = {};</span>
<a href="#l1.381"></a><span id="l1.381" class="difflineminus">-  var fullNames = {};</span>
<a href="#l1.382"></a><span id="l1.382" class="difflineminus">-  var numAddresses;</span>
<a href="#l1.383"></a><span id="l1.383" class="difflineminus">-</span>
<a href="#l1.384"></a><span id="l1.384" class="difflineminus">-  numAddresses = MailServices.headerParser.parseHeadersWithArray(msgHdr.author, addresses, names, fullNames);</span>
<a href="#l1.385"></a><span id="l1.385" class="difflineminus">-  var authorEmailAddress = addresses.value[0];</span>
<a href="#l1.386"></a><span id="l1.386" class="difflineminus">-  if (!authorEmailAddress)</span>
<a href="#l1.387"></a><span id="l1.387" class="difflineminus">-    return;</span>
<a href="#l1.388"></a><span id="l1.388" class="difflineplus">+  let names = {};</span>
<a href="#l1.389"></a><span id="l1.389" class="difflineplus">+  let addresses = {};</span>
<a href="#l1.390"></a><span id="l1.390" class="difflineplus">+</span>
<a href="#l1.391"></a><span id="l1.391" class="difflineplus">+  MailServices.headerParser.parseHeadersWithArray(msgHdr.author, addresses, names, {});</span>
<a href="#l1.392"></a><span id="l1.392" class="difflineplus">+  let authorEmailAddress = addresses.value[0];</span>
<a href="#l1.393"></a><span id="l1.393" class="difflineplus">+  let authorDisplayName = names.value[0];</span>
<a href="#l1.394"></a><span id="l1.394"> </span>
<a href="#l1.395"></a><span id="l1.395">   // search through all of our local address books looking for a match.</span>
<a href="#l1.396"></a><span id="l1.396">   let enumerator = MailServices.ab.directories;</span>
<a href="#l1.397"></a><span id="l1.397">   var cardForEmailAddress;</span>
<a href="#l1.398"></a><span id="l1.398">   var addrbook;</span>
<a href="#l1.399"></a><span id="l1.399">   while (!cardForEmailAddress &amp;&amp; enumerator.hasMoreElements())</span>
<a href="#l1.400"></a><span id="l1.400">   {</span>
<a href="#l1.401"></a><span id="l1.401">     addrbook = enumerator.getNext()</span>
<a href="#l1.402"></a><span id="l1.402" class="difflineat">@@ -2975,17 +3073,17 @@ function allowRemoteContentForSender()</span>
<a href="#l1.403"></a><span id="l1.403">   {</span>
<a href="#l1.404"></a><span id="l1.404">     // set the property for remote content</span>
<a href="#l1.405"></a><span id="l1.405">     cardForEmailAddress.setProperty(&quot;AllowRemoteContent&quot;, true);</span>
<a href="#l1.406"></a><span id="l1.406">     addrbook.modifyCard(cardForEmailAddress);</span>
<a href="#l1.407"></a><span id="l1.407">     allowRemoteContent = true;</span>
<a href="#l1.408"></a><span id="l1.408">   }</span>
<a href="#l1.409"></a><span id="l1.409">   else</span>
<a href="#l1.410"></a><span id="l1.410">   {</span>
<a href="#l1.411"></a><span id="l1.411" class="difflineminus">-    var args = {primaryEmail:authorEmailAddress, displayName:names.value[0],</span>
<a href="#l1.412"></a><span id="l1.412" class="difflineplus">+    let args = {primaryEmail:authorEmailAddress, displayName:authorDisplayName,</span>
<a href="#l1.413"></a><span id="l1.413">                 allowRemoteContent:true};</span>
<a href="#l1.414"></a><span id="l1.414">     // create a new card and set the property</span>
<a href="#l1.415"></a><span id="l1.415">     window.openDialog(&quot;chrome://messenger/content/addressbook/abNewCardDialog.xul&quot;,</span>
<a href="#l1.416"></a><span id="l1.416">                       &quot;&quot;, &quot;chrome,resizable=no,titlebar,modal,centerscreen&quot;, args);</span>
<a href="#l1.417"></a><span id="l1.417">     allowRemoteContent = args.allowRemoteContent;</span>
<a href="#l1.418"></a><span id="l1.418">   }</span>
<a href="#l1.419"></a><span id="l1.419"> </span>
<a href="#l1.420"></a><span id="l1.420">   // Reload the message if we've updated the remote content policy for the sender.</span>
<a href="#l1.421"></a><span id="l1.421" class="difflineat">@@ -3189,23 +3287,21 @@ function HandleMDNResponse(aUrl)</span>
<a href="#l1.422"></a><span id="l1.422">                                      msgHdr.messageKey, mimeHdr, false);</span>
<a href="#l1.423"></a><span id="l1.423">   if (askUser)</span>
<a href="#l1.424"></a><span id="l1.424">     gMessageNotificationBar.setMDNMsg(mdnGenerator, msgHdr, mimeHdr);</span>
<a href="#l1.425"></a><span id="l1.425"> }</span>
<a href="#l1.426"></a><span id="l1.426"> </span>
<a href="#l1.427"></a><span id="l1.427"> function SendMDNResponse()</span>
<a href="#l1.428"></a><span id="l1.428"> {</span>
<a href="#l1.429"></a><span id="l1.429">   gMessageNotificationBar.mdnGenerator.userAgreed();</span>
<a href="#l1.430"></a><span id="l1.430" class="difflineminus">-  gMessageNotificationBar.updateMsgNotificationBar(kMsgNotificationMDN, false);</span>
<a href="#l1.431"></a><span id="l1.431"> }</span>
<a href="#l1.432"></a><span id="l1.432"> </span>
<a href="#l1.433"></a><span id="l1.433"> function IgnoreMDNResponse()</span>
<a href="#l1.434"></a><span id="l1.434"> {</span>
<a href="#l1.435"></a><span id="l1.435">   gMessageNotificationBar.mdnGenerator.userDeclined();</span>
<a href="#l1.436"></a><span id="l1.436" class="difflineminus">-  gMessageNotificationBar.updateMsgNotificationBar(kMsgNotificationMDN, false);</span>
<a href="#l1.437"></a><span id="l1.437"> }</span>
<a href="#l1.438"></a><span id="l1.438"> </span>
<a href="#l1.439"></a><span id="l1.439"> function QuickSearchFocus()</span>
<a href="#l1.440"></a><span id="l1.440"> {</span>
<a href="#l1.441"></a><span id="l1.441">   let tabmail = document.getElementById('tabmail');</span>
<a href="#l1.442"></a><span id="l1.442"> </span>
<a href="#l1.443"></a><span id="l1.443">   // If we're currently viewing a Gloda tab, drill down to find the</span>
<a href="#l1.444"></a><span id="l1.444">   // built-in search input, and select that.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -57,16 +57,17 @@</span>
<a href="#l2.4"></a><span id="l2.4"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/printUtils.js&quot;/&gt;</span>
<a href="#l2.5"></a><span id="l2.5"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/msgViewPickerOverlay.js&quot;/&gt;</span>
<a href="#l2.6"></a><span id="l2.6"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/plugins.js&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/viewZoomOverlay.js&quot;/&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/newmailaccount/uriListener.js&quot;/&gt;</span>
<a href="#l2.9"></a><span id="l2.9"> &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger-newsblog/content/utils.js&quot;/&gt;</span>
<a href="#l2.10"></a><span id="l2.10"> </span>
<a href="#l2.11"></a><span id="l2.11"> &lt;stringbundleset id=&quot;stringbundleset&quot;&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+  &lt;stringbundle id=&quot;brand_bundle&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l2.13"></a><span id="l2.13">   &lt;stringbundle id=&quot;bundle_messenger&quot; src=&quot;chrome://messenger/locale/messenger.properties&quot;/&gt;</span>
<a href="#l2.14"></a><span id="l2.14">   &lt;stringbundle id=&quot;bundle_offlinePrompts&quot; src=&quot;chrome://messenger/locale/offline.properties&quot;/&gt;</span>
<a href="#l2.15"></a><span id="l2.15"> &lt;/stringbundleset&gt;</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17"> &lt;!-- Performance optimization...we include utilityOverlay.xul which defines some command sets</span>
<a href="#l2.18"></a><span id="l2.18">      which are updated based on events like focus and select. We have our own custom events</span>
<a href="#l2.19"></a><span id="l2.19">      which we use to optmize when we do command updating. To avoid unnecessary command updating,</span>
<a href="#l2.20"></a><span id="l2.20">      we are going to override the events the global edit menu items and select edit menu items</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineat">@@ -966,16 +967,38 @@</span>
<a href="#l2.22"></a><span id="l2.22">              onpopupshowing=&quot;onViewToolbarsPopupShowing(event, 'mail-toolbox');&quot;&gt;</span>
<a href="#l2.23"></a><span id="l2.23">     &lt;menuseparator id=&quot;customizeMailToolbarMenuSeparator&quot;/&gt;</span>
<a href="#l2.24"></a><span id="l2.24">     &lt;menuitem id=&quot;CustomizeMailToolbar&quot;</span>
<a href="#l2.25"></a><span id="l2.25">               command=&quot;cmd_CustomizeMailToolbar&quot;</span>
<a href="#l2.26"></a><span id="l2.26">               label=&quot;&amp;customizeToolbar.label;&quot;</span>
<a href="#l2.27"></a><span id="l2.27">               accesskey=&quot;&amp;customizeToolbar.accesskey;&quot;/&gt;</span>
<a href="#l2.28"></a><span id="l2.28">   &lt;/menupopup&gt;</span>
<a href="#l2.29"></a><span id="l2.29"> </span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+  &lt;menupopup id=&quot;remoteContentOptions&quot;&gt;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+    &lt;menuitem id=&quot;remoteContentOptionAllowForMsg&quot;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+              label=&quot;&amp;remoteContentOptionsAllowForMsg.label;&quot;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+              accesskey=&quot;&amp;remoteContentOptionsAllowForMsg.accesskey;&quot;</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+              oncommand=&quot;LoadMsgWithRemoteContent();&quot;/&gt;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+    &lt;menuitem id=&quot;remoteContentOptionAllowForAddress&quot;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+              label=&quot;&amp;remoteContentOptionAllowForAddress.label;&quot;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+              accesskey=&quot;&amp;remoteContentOptionAllowForAddress.accesskey;&quot;</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+              oncommand=&quot;allowRemoteContentForSender();&quot;/&gt;</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineplus">+  &lt;/menupopup&gt;</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineplus">+</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+  &lt;menupopup id=&quot;phishingOptions&quot;&gt;</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+    &lt;menuitem id=&quot;phishingOptionIgnore&quot;</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineplus">+              label=&quot;&amp;phishingOptionIgnore.label;&quot;</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineplus">+              accesskey=&quot;&amp;phishingOptionIgnore.accesskey;&quot;</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineplus">+              oncommand=&quot;IgnorePhishingWarning();&quot;/&gt;</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineplus">+    &lt;menuitem id=&quot;phishingOptionDisableDetection&quot;</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+              label=&quot;&amp;phishingOptionDisableDetection.label;&quot;</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineplus">+              accesskey=&quot;&amp;phishingOptionDisableDetection.accesskey;&quot;</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+              oncommand=&quot;DisablePhishingWarning();&quot;/&gt;</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineplus">+  &lt;/menupopup&gt;</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+</span>
<a href="#l2.52"></a><span id="l2.52"> &lt;popupset id=&quot;mainPopupSet&quot;&gt;</span>
<a href="#l2.53"></a><span id="l2.53">   &lt;menupopup id=&quot;appmenu-popup&quot;</span>
<a href="#l2.54"></a><span id="l2.54">              onpopupshowing=&quot;initAppMenuPopup(this, event);&quot;&gt;</span>
<a href="#l2.55"></a><span id="l2.55">     &lt;hbox&gt;</span>
<a href="#l2.56"></a><span id="l2.56">       &lt;vbox id=&quot;appmenuPrimaryPane&quot;&gt;</span>
<a href="#l2.57"></a><span id="l2.57">         &lt;splitmenu id=&quot;appmenu_newMessage&quot;</span>
<a href="#l2.58"></a><span id="l2.58">                    label=&quot;&amp;appmenuNewMsgCmd.label;&quot;</span>
<a href="#l2.59"></a><span id="l2.59">                    oncommand=&quot;MsgNewMessage(null);&quot;&gt;</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineat">@@ -3294,65 +3317,16 @@</span>
<a href="#l2.61"></a><span id="l2.61"> #else</span>
<a href="#l2.62"></a><span id="l2.62">            defaultset=&quot;button-getmsg,button-newmsg,button-chat,button-address,separator,button-tag,qfb-show-filter-bar,spring,gloda-search,button-appmenu&quot;&gt;</span>
<a href="#l2.63"></a><span id="l2.63"> #endif</span>
<a href="#l2.64"></a><span id="l2.64">   &lt;/toolbar&gt;</span>
<a href="#l2.65"></a><span id="l2.65"> </span>
<a href="#l2.66"></a><span id="l2.66">   &lt;toolbarset id=&quot;customToolbars&quot; context=&quot;toolbar-context-menu&quot;/&gt;</span>
<a href="#l2.67"></a><span id="l2.67"> &lt;/toolbox&gt;</span>
<a href="#l2.68"></a><span id="l2.68"> </span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-&lt;!-- The msgNotificationBar appears on top of the message and displays</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineminus">-     information like: junk, contains remote images, or is a suspected phishing</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineminus">-     URL.</span>
<a href="#l2.72"></a><span id="l2.72" class="difflineminus">---&gt;</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineminus">-&lt;deck id=&quot;msgNotificationBar&quot; selectedIndex=&quot;0&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineminus">-  &lt;hbox id=&quot;msgNotificationNoStatus&quot;/&gt;</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineminus">-</span>
<a href="#l2.76"></a><span id="l2.76" class="difflineminus">-  &lt;hbox id=&quot;phishingBar&quot; class=&quot;msgNotificationBar&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.77"></a><span id="l2.77" class="difflineminus">-    &lt;image id=&quot;phishingBarImage&quot;/&gt;</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineminus">-    &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineminus">-      &lt;description flex=&quot;1&quot; class=&quot;msgNotificationBarText&quot;&gt;&amp;phishingBarMessage2.label;&lt;/description&gt;</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineminus">-      &lt;label id=&quot;disablePhishingWarning&quot; class=&quot;msgNotificaton-smallText text-link&quot;</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineminus">-             value=&quot;&amp;disablePhishingWarning1.label;&quot; onclick=&quot;DisablePhishingWarning();&quot;/&gt;</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineminus">-      &lt;label id=&quot;reportPhishingError&quot; value=&quot;&amp;reportPhishingError1.label;&quot; class=&quot;msgNotificaton-smallText text-link&quot; collapsed=&quot;true&quot;/&gt;</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineminus">-    &lt;/vbox&gt;</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineminus">-    &lt;button label=&quot;&amp;removePhishingBarButton1.label;&quot; oncommand=&quot;IgnorePhishingWarning();&quot;/&gt;</span>
<a href="#l2.85"></a><span id="l2.85" class="difflineminus">-  &lt;/hbox&gt;</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-  &lt;hbox id=&quot;junkBar&quot; class=&quot;msgNotificationBar&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-    &lt;image id=&quot;junkBarImage&quot;/&gt;</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineminus">-    &lt;description flex=&quot;1&quot; class=&quot;msgNotificationBarText&quot;&gt;&amp;junkBarMessage2.label;&lt;/description&gt;</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineminus">-    &lt;button label=&quot;&amp;junkBarButton1.label;&quot; oncommand=&quot;JunkSelectedMessages(false);&quot;/&gt;</span>
<a href="#l2.91"></a><span id="l2.91" class="difflineminus">-  &lt;/hbox&gt;</span>
<a href="#l2.92"></a><span id="l2.92" class="difflineminus">-</span>
<a href="#l2.93"></a><span id="l2.93" class="difflineminus">-  &lt;hbox id=&quot;remoteContentBar&quot; class=&quot;msgNotificationBar&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-    &lt;image id=&quot;remoteContentImage&quot;/&gt;</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineminus">-    &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineminus">-      &lt;description class=&quot;msgNotificationBarText&quot;&gt;&amp;remoteContentMessage2.label;&lt;/description&gt;</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineminus">-      &lt;label id=&quot;allowRemoteContentForAuthorDesc&quot; class=&quot;msgNotificaton-smallText text-link&quot;</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineminus">-             crop=&quot;end&quot;</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineminus">-             onclick=&quot;allowRemoteContentForSender();&quot;/&gt;</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineminus">-    &lt;/vbox&gt;</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineminus">-    &lt;button id=&quot;remoteContentBarButton&quot; label=&quot;&amp;loadRemoteContentButton3.label;&quot;</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineminus">-            oncommand=&quot;LoadMsgWithRemoteContent();&quot;/&gt;</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineminus">-  &lt;/hbox&gt;</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineminus">-</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineminus">-  &lt;hbox id=&quot;mdnBar&quot; class=&quot;msgNotificationBar&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineminus">-    &lt;image id=&quot;mdnBarImage&quot;/&gt;</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineminus">-    &lt;description id=&quot;mdnBarMessage&quot; class=&quot;msgNotificationBarText&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineminus">-    &lt;button label=&quot;&amp;mdnBarIgnoreButton2.label;&quot;</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineminus">-            accesskey=&quot;&amp;mdnBarIgnoreButton2.accesskey;&quot;</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineminus">-            oncommand=&quot;IgnoreMDNResponse();&quot;/&gt;</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineminus">-    &lt;button label=&quot;&amp;mdnBarSendButton2.label;&quot;</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineminus">-            accesskey=&quot;&amp;mdnBarSendButton2.accesskey;&quot;</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineminus">-            oncommand=&quot;SendMDNResponse();&quot;/&gt;</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineminus">-  &lt;/hbox&gt;</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineminus">-</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineminus">-&lt;/deck&gt;</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineminus">-</span>
<a href="#l2.118"></a><span id="l2.118"> &lt;statusbar class=&quot;chromeclass-status&quot; id=&quot;status-bar&quot;&gt;</span>
<a href="#l2.119"></a><span id="l2.119">   &lt;hbox insertbefore=&quot;unreadMessageCount&quot;  id=&quot;statusTextBox&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.120"></a><span id="l2.120">     &lt;statusbarpanel id=&quot;offline-status&quot; class=&quot;statusbarpanel-iconic&quot; oncommand=&quot;MailOfflineMgr.toggleOfflineStatus();&quot;/&gt;</span>
<a href="#l2.121"></a><span id="l2.121">     &lt;statusbarpanel id=&quot;statusText&quot; label=&quot;&amp;statusText.label;&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l2.122"></a><span id="l2.122">     &lt;statusbarpanel class=&quot;statusbarpanel-progress&quot; collapsed=&quot;true&quot; id=&quot;statusbar-progresspanel&quot;&gt;</span>
<a href="#l2.123"></a><span id="l2.123">       &lt;progressmeter class=&quot;progressmeter-statusbar&quot; id=&quot;statusbar-icon&quot; mode=&quot;normal&quot; value=&quot;0&quot;/&gt;</span>
<a href="#l2.124"></a><span id="l2.124">     &lt;/statusbarpanel&gt;</span>
<a href="#l2.125"></a><span id="l2.125">     &lt;statusbarpanel class=&quot;statusbarpanel-progress&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/messageWindow.xul</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/messageWindow.xul</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -125,16 +125,18 @@</span>
<a href="#l3.4"></a><span id="l3.4">   &lt;/popupset&gt;</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6">   &lt;menupopup id=&quot;attachmentListContext&quot;/&gt;</span>
<a href="#l3.7"></a><span id="l3.7">   &lt;menupopup id=&quot;attachmentItemContext&quot;/&gt;</span>
<a href="#l3.8"></a><span id="l3.8">   &lt;menupopup id=&quot;header-toolbar-context-menu&quot;/&gt;</span>
<a href="#l3.9"></a><span id="l3.9">   &lt;menupopup id=&quot;attachment-toolbar-context-menu&quot;/&gt;</span>
<a href="#l3.10"></a><span id="l3.10">   &lt;menupopup id=&quot;copyUrlPopup&quot;/&gt;</span>
<a href="#l3.11"></a><span id="l3.11">   &lt;menupopup id=&quot;toolbar-context-menu&quot;/&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+  &lt;menupopup id=&quot;remoteContentOptions&quot;/&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  &lt;menupopup id=&quot;phishingOptions&quot;/&gt;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">   &lt;!-- navigation-toolbox is provided by mailWindowOverlay.xul --&gt;</span>
<a href="#l3.16"></a><span id="l3.16">   &lt;toolbox id=&quot;navigation-toolbox&quot; class=&quot;toolbox-top&quot; /&gt;</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18">   &lt;!-- mail-toolbox is provided by mailWindowOverlay.xul --&gt;</span>
<a href="#l3.19"></a><span id="l3.19">   &lt;toolbox id=&quot;mail-toolbox&quot; /&gt;</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21">   &lt;tooltip id=&quot;aHTMLTooltip&quot; onpopupshowing=&quot;return FillInHTMLTooltip(document.tooltipNode);&quot;/&gt;</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -143,18 +145,19 @@</span>
<a href="#l3.23"></a><span id="l3.23">   &lt;!-- a convenience box for ease of extension overlaying --&gt;</span>
<a href="#l3.24"></a><span id="l3.24">   &lt;hbox id=&quot;messagepaneboxwrapper&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.25"></a><span id="l3.25">     &lt;vbox id=&quot;messagepanebox&quot; flex=&quot;3&quot;</span>
<a href="#l3.26"></a><span id="l3.26">           ondragover=&quot;nsDragAndDrop.dragOver(event, messagepaneObserver);&quot;</span>
<a href="#l3.27"></a><span id="l3.27">           ondragdrop=&quot;nsDragAndDrop.drop(event, messagepaneObserver);&quot;</span>
<a href="#l3.28"></a><span id="l3.28">           ondragexit=&quot;nsDragAndDrop.dragExit(event, messagepaneObserver);&quot;&gt;</span>
<a href="#l3.29"></a><span id="l3.29"> </span>
<a href="#l3.30"></a><span id="l3.30">       &lt;hbox id=&quot;msgHeaderView&quot;/&gt;</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-      &lt;hbox id=&quot;editMessageBox&quot;/&gt;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-      &lt;deck id=&quot;msgNotificationBar&quot;/&gt;</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+      &lt;!-- The msgNotificationBar appears on top of the message and displays</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+           information like: junk, mdn, remote content and phishing warnings --&gt;</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+      &lt;notificationbox id=&quot;msgNotificationBar&quot;/&gt;</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37">       &lt;!-- message view --&gt;</span>
<a href="#l3.38"></a><span id="l3.38">       &lt;browser id=&quot;messagepane&quot; context=&quot;mailContext&quot; tooltip=&quot;aHTMLTooltip&quot;</span>
<a href="#l3.39"></a><span id="l3.39">                style=&quot;height: 0px; min-height: 1px&quot; flex=&quot;1&quot; name=&quot;messagepane&quot;</span>
<a href="#l3.40"></a><span id="l3.40">                disablesecurity=&quot;true&quot; disablehistory=&quot;true&quot; type=&quot;content-primary&quot;</span>
<a href="#l3.41"></a><span id="l3.41">                onresize=&quot;return messagePaneOnResize(event);&quot; autofind=&quot;false&quot;</span>
<a href="#l3.42"></a><span id="l3.42">                src=&quot;about:blank&quot; onclick=&quot;return contentAreaClick(event);&quot; /&gt;</span>
<a href="#l3.43"></a><span id="l3.43">       &lt;splitter id=&quot;attachment-splitter&quot; collapse=&quot;after&quot; resizebefore=&quot;closest&quot; resizeafter=&quot;closest&quot; collapsed=&quot;true&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/content/messenger.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/content/messenger.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -126,16 +126,18 @@</span>
<a href="#l4.4"></a><span id="l4.4"> &lt;menupopup id=&quot;mailContext&quot;/&gt;</span>
<a href="#l4.5"></a><span id="l4.5"> &lt;menupopup id=&quot;folderPaneContext&quot;/&gt;</span>
<a href="#l4.6"></a><span id="l4.6"> &lt;menupopup id=&quot;attachmentListContext&quot;/&gt;</span>
<a href="#l4.7"></a><span id="l4.7"> &lt;menupopup id=&quot;attachmentItemContext&quot;/&gt;</span>
<a href="#l4.8"></a><span id="l4.8"> &lt;menupopup id=&quot;header-toolbar-context-menu&quot;/&gt;</span>
<a href="#l4.9"></a><span id="l4.9"> &lt;menupopup id=&quot;attachment-toolbar-context-menu&quot;/&gt;</span>
<a href="#l4.10"></a><span id="l4.10"> &lt;menupopup id=&quot;copyUrlPopup&quot;/&gt;</span>
<a href="#l4.11"></a><span id="l4.11"> &lt;menupopup id=&quot;toolbar-context-menu&quot;/&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+&lt;menupopup id=&quot;remoteContentOptions&quot;/&gt;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+&lt;menupopup id=&quot;phishingOptions&quot;/&gt;</span>
<a href="#l4.14"></a><span id="l4.14"> </span>
<a href="#l4.15"></a><span id="l4.15"> &lt;tooltip id=&quot;attachmentListTooltip&quot;/&gt;</span>
<a href="#l4.16"></a><span id="l4.16"> </span>
<a href="#l4.17"></a><span id="l4.17"> &lt;menupopup id=&quot;emailAddressPopup&quot; position=&quot;after_start&quot; class=&quot;emailAddressPopup&quot;</span>
<a href="#l4.18"></a><span id="l4.18">            onpopupshowing=&quot;setupEmailAddressPopup(findEmailNodeFromPopupNode(document.popupNode, 'emailAddressPopup')); goUpdateCommand('cmd_createFilterFromPopup')&quot;</span>
<a href="#l4.19"></a><span id="l4.19">            onpopuphiding=&quot;hideEmailNewsPopup(findEmailNodeFromPopupNode(document.popupNode, 'emailAddressPopup'));&quot;&gt;</span>
<a href="#l4.20"></a><span id="l4.20">     &lt;menuitem id=&quot;emailAddressPlaceHolder&quot;</span>
<a href="#l4.21"></a><span id="l4.21">               disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -507,18 +509,20 @@</span>
<a href="#l4.23"></a><span id="l4.23">                              flex=&quot;1&quot; name=&quot;multimessage&quot;</span>
<a href="#l4.24"></a><span id="l4.24">                              hidden=&quot;true&quot;</span>
<a href="#l4.25"></a><span id="l4.25">                              disablesecurity=&quot;true&quot; disablehistory=&quot;true&quot;</span>
<a href="#l4.26"></a><span id="l4.26">                              tooltip=&quot;aHTMLTooltip&quot;</span>
<a href="#l4.27"></a><span id="l4.27">                              src=&quot;chrome://messenger/content/multimessageview.xhtml&quot;</span>
<a href="#l4.28"></a><span id="l4.28">                              autofind=&quot;false&quot;/&gt;</span>
<a href="#l4.29"></a><span id="l4.29">                     &lt;vbox id=&quot;singlemessage&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l4.30"></a><span id="l4.30">                       &lt;hbox id=&quot;msgHeaderView&quot;/&gt;</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-                      &lt;hbox id=&quot;editMessageBox&quot;/&gt;</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineminus">-                      &lt;deck id=&quot;msgNotificationBar&quot;/&gt;</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+                      &lt;!-- The msgNotificationBar appears on top of the message</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+                           and displays information like: junk, contains remote</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+                           images, or is a suspected phishing URL. --&gt;</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+                      &lt;notificationbox id=&quot;msgNotificationBar&quot;/&gt;</span>
<a href="#l4.37"></a><span id="l4.37">                       &lt;!-- The messagepanewrapper hbox exists to allow</span>
<a href="#l4.38"></a><span id="l4.38">                            extensions to add sidebars to the message. --&gt;</span>
<a href="#l4.39"></a><span id="l4.39">                       &lt;hbox id=&quot;messagepanewrapper&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l4.40"></a><span id="l4.40">                         &lt;browser id=&quot;messagepane&quot; context=&quot;mailContext&quot;</span>
<a href="#l4.41"></a><span id="l4.41">                                  autofind=&quot;false&quot; minheight=&quot;1&quot; flex=&quot;1&quot;</span>
<a href="#l4.42"></a><span id="l4.42">                                  name=&quot;messagepane&quot; tooltip=&quot;aHTMLTooltip&quot;</span>
<a href="#l4.43"></a><span id="l4.43">                                  disablehistory=&quot;true&quot; type=&quot;content-primary&quot;</span>
<a href="#l4.44"></a><span id="l4.44">                                  src=&quot;about:blank&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/base/content/msgHdrViewOverlay.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/base/content/msgHdrViewOverlay.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -428,17 +428,16 @@ var messageHeaderSink = {</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5">         gViewAllHeaders = false;</span>
<a href="#l5.6"></a><span id="l5.6">       }</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8">       ClearCurrentHeaders();</span>
<a href="#l5.9"></a><span id="l5.9">       gBuiltExpandedView = false;</span>
<a href="#l5.10"></a><span id="l5.10">       gBuildAttachmentsForCurrentMsg = false;</span>
<a href="#l5.11"></a><span id="l5.11">       ClearAttachmentList();</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-      ClearEditMessageBox();</span>
<a href="#l5.13"></a><span id="l5.13">       gMessageNotificationBar.clearMsgNotifications();</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15">       for (let index in gMessageListeners)</span>
<a href="#l5.16"></a><span id="l5.16">         gMessageListeners[index].onStartHeaders();</span>
<a href="#l5.17"></a><span id="l5.17">     },</span>
<a href="#l5.18"></a><span id="l5.18"> </span>
<a href="#l5.19"></a><span id="l5.19">     onEndHeaders: function()</span>
<a href="#l5.20"></a><span id="l5.20">     {</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineat">@@ -459,17 +458,17 @@ var messageHeaderSink = {</span>
<a href="#l5.22"></a><span id="l5.22"> </span>
<a href="#l5.23"></a><span id="l5.23">       // Only update the expanded view if it's actually selected (an</span>
<a href="#l5.24"></a><span id="l5.24">       // extension-provided panel could be visible instead) and needs updating.</span>
<a href="#l5.25"></a><span id="l5.25">       if (document.getElementById(&quot;msgHeaderViewDeck&quot;).selectedIndex == 0 &amp;&amp;</span>
<a href="#l5.26"></a><span id="l5.26">           !gBuiltExpandedView) {</span>
<a href="#l5.27"></a><span id="l5.27">         UpdateExpandedMessageHeaders();</span>
<a href="#l5.28"></a><span id="l5.28">       }</span>
<a href="#l5.29"></a><span id="l5.29"> </span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-      ShowEditMessageBox();</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+      gMessageNotificationBar.setDraftEditMessage();</span>
<a href="#l5.32"></a><span id="l5.32">       UpdateJunkButton();</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34">       for (let index in gMessageListeners)</span>
<a href="#l5.35"></a><span id="l5.35">         gMessageListeners[index].onEndHeaders();</span>
<a href="#l5.36"></a><span id="l5.36">     },</span>
<a href="#l5.37"></a><span id="l5.37"> </span>
<a href="#l5.38"></a><span id="l5.38">     processHeaders: function(headerNameEnumerator, headerValueEnumerator,</span>
<a href="#l5.39"></a><span id="l5.39">                              dontCollectAddress)</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineat">@@ -1149,17 +1148,17 @@ function HideMessageHeaderPane()</span>
<a href="#l5.41"></a><span id="l5.41">   let appMenuNode = document.getElementById(&quot;appmenu_msgAttachmentMenu&quot;);</span>
<a href="#l5.42"></a><span id="l5.42">   if (appMenuNode)</span>
<a href="#l5.43"></a><span id="l5.43">     appMenuNode.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l5.44"></a><span id="l5.44"> </span>
<a href="#l5.45"></a><span id="l5.45">   // disable the attachment box</span>
<a href="#l5.46"></a><span id="l5.46">   document.getElementById(&quot;attachmentView&quot;).collapsed = true;</span>
<a href="#l5.47"></a><span id="l5.47">   document.getElementById(&quot;attachment-splitter&quot;).collapsed = true;</span>
<a href="#l5.48"></a><span id="l5.48"> </span>
<a href="#l5.49"></a><span id="l5.49" class="difflineminus">-  ClearEditMessageBox();</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+  gMessageNotificationBar.clearMsgNotifications();</span>
<a href="#l5.51"></a><span id="l5.51"> }</span>
<a href="#l5.52"></a><span id="l5.52"> </span>
<a href="#l5.53"></a><span id="l5.53"> /**</span>
<a href="#l5.54"></a><span id="l5.54">  * Take string of newsgroups separated by commas, split it</span>
<a href="#l5.55"></a><span id="l5.55">  * into newsgroups and send them to the corresponding</span>
<a href="#l5.56"></a><span id="l5.56">  * mail-newsgroups-headerfield element.</span>
<a href="#l5.57"></a><span id="l5.57">  *</span>
<a href="#l5.58"></a><span id="l5.58">  * @param headerEntry  the entry data structure for this header</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/base/content/phishingDetector.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/base/content/phishingDetector.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -174,18 +174,19 @@ var gPhishingDetector = {</span>
<a href="#l6.4"></a><span id="l6.4">   localListCallback: function (aMsgHdr, aFailsStaticTests, aUrl, aLocalListStatus)</span>
<a href="#l6.5"></a><span id="l6.5">   {  </span>
<a href="#l6.6"></a><span id="l6.6">     // for urls in the blacklist, notify the phishing bar.</span>
<a href="#l6.7"></a><span id="l6.7">     // for urls in the whitelist, do nothing</span>
<a href="#l6.8"></a><span id="l6.8">     // for all other urls, fall back to the static tests</span>
<a href="#l6.9"></a><span id="l6.9">     if (aMsgHdr == gFolderDisplay.selectedMessage)</span>
<a href="#l6.10"></a><span id="l6.10">     {</span>
<a href="#l6.11"></a><span id="l6.11">       if (aLocalListStatus == 0 /* PROT_ListWarden.IN_BLACKLIST */ ||</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-          (aLocalListStatus == 2 /* PROT_ListWarden.PROT_ListWarden.NOT_FOUND */ &amp;&amp; aFailsStaticTests))</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+          (aLocalListStatus == 2 /* PROT_ListWarden.PROT_ListWarden.NOT_FOUND */ &amp;&amp; aFailsStaticTests)) {</span>
<a href="#l6.14"></a><span id="l6.14">         gMessageNotificationBar.setPhishingMsg();</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+      }</span>
<a href="#l6.16"></a><span id="l6.16">     }</span>
<a href="#l6.17"></a><span id="l6.17">   },</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">   /**</span>
<a href="#l6.20"></a><span id="l6.20">    * Looks up the report phishing url for the current phishing provider, appends aPhishingURL to the url,</span>
<a href="#l6.21"></a><span id="l6.21">    * and loads it in the default browser where the user can submit the url as a phish.</span>
<a href="#l6.22"></a><span id="l6.22">    * @param aPhishingURL the url we want to report back as a phishing attack</span>
<a href="#l6.23"></a><span id="l6.23">    */</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineat">@@ -241,17 +242,17 @@ var gPhishingDetector = {</span>
<a href="#l6.25"></a><span id="l6.25">    * of the http(s) url the user clicked on.</span>
<a href="#l6.26"></a><span id="l6.26">    *</span>
<a href="#l6.27"></a><span id="l6.27">    * @param aUrl the url </span>
<a href="#l6.28"></a><span id="l6.28">    * @return true if the link should be allowed to load</span>
<a href="#l6.29"></a><span id="l6.29">    */</span>
<a href="#l6.30"></a><span id="l6.30">   warnOnSuspiciousLinkClick: function(aUrl)</span>
<a href="#l6.31"></a><span id="l6.31">   {</span>
<a href="#l6.32"></a><span id="l6.32">     // if the loaded message has been flagged as a phishing scam, </span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-    if (!gMessageNotificationBar.isFlagSet(kMsgNotificationPhishingBar))</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+    if (!gMessageNotificationBar.isShowingJunkNotification())</span>
<a href="#l6.35"></a><span id="l6.35">       return true;</span>
<a href="#l6.36"></a><span id="l6.36"> </span>
<a href="#l6.37"></a><span id="l6.37">     var hrefURL;</span>
<a href="#l6.38"></a><span id="l6.38">     // make sure relative link urls don't make us bail out</span>
<a href="#l6.39"></a><span id="l6.39">     try {</span>
<a href="#l6.40"></a><span id="l6.40">       hrefURL = Services.io.newURI(aUrl, null, null);</span>
<a href="#l6.41"></a><span id="l6.41">     } catch(ex) { return false; }</span>
<a href="#l6.42"></a><span id="l6.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1778,17 +1778,17 @@ attachmentWorker.onerror = function(erro</span>
<a href="#l7.4"></a><span id="l7.4"> };</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7"> attachmentWorker.onmessage = function(event)</span>
<a href="#l7.8"></a><span id="l7.8"> {</span>
<a href="#l7.9"></a><span id="l7.9">   let keywordsFound = event.data;</span>
<a href="#l7.10"></a><span id="l7.10">   let msg = null;</span>
<a href="#l7.11"></a><span id="l7.11">   let nBox = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  let notification = nBox.getNotificationWithValue(&quot;1&quot;);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  let notification = nBox.getNotificationWithValue(&quot;attachmentReminder&quot;);</span>
<a href="#l7.14"></a><span id="l7.14">   let removeNotification = false;</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16">   if (keywordsFound.length &gt; 0) {</span>
<a href="#l7.17"></a><span id="l7.17">     msg = document.createElement(&quot;hbox&quot;);</span>
<a href="#l7.18"></a><span id="l7.18">     msg.setAttribute(&quot;flex&quot;, &quot;100&quot;);</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20">     msg.onclick = function(event)</span>
<a href="#l7.21"></a><span id="l7.21">     {</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -1847,17 +1847,17 @@ attachmentWorker.onmessage = function(ev</span>
<a href="#l7.23"></a><span id="l7.23">       accessKey : getComposeBundle().getString(&quot;remindLaterButton.accessskey&quot;),</span>
<a href="#l7.24"></a><span id="l7.24">       label: getComposeBundle().getString(&quot;remindLaterButton&quot;),</span>
<a href="#l7.25"></a><span id="l7.25">       callback: function (aNotificationBar, aButton)</span>
<a href="#l7.26"></a><span id="l7.26">       {</span>
<a href="#l7.27"></a><span id="l7.27">         gRemindLater = true;</span>
<a href="#l7.28"></a><span id="l7.28">       }</span>
<a href="#l7.29"></a><span id="l7.29">     };</span>
<a href="#l7.30"></a><span id="l7.30"> </span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-    notification = nBox.appendNotification(&quot;&quot;, &quot;1&quot;,</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+    notification = nBox.appendNotification(&quot;&quot;, &quot;attachmentReminder&quot;,</span>
<a href="#l7.33"></a><span id="l7.33">                                  /* fake out the image so we can do it in CSS */</span>
<a href="#l7.34"></a><span id="l7.34">                                  &quot;null&quot;,</span>
<a href="#l7.35"></a><span id="l7.35">                                  nBox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l7.36"></a><span id="l7.36">                                  [addButton, remindButton]);</span>
<a href="#l7.37"></a><span id="l7.37">     let buttons = notification.childNodes[0];</span>
<a href="#l7.38"></a><span id="l7.38">     notification.insertBefore(msg, buttons);</span>
<a href="#l7.39"></a><span id="l7.39">   }</span>
<a href="#l7.40"></a><span id="l7.40">   CheckForAttachmentNotification.shouldFire = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -561,16 +561,28 @@</span>
<a href="#l8.4"></a><span id="l8.4"> &lt;!ENTITY tagButton.tooltip &quot;Tag messages&quot;&gt;</span>
<a href="#l8.5"></a><span id="l8.5"> &lt;!ENTITY compactButton.tooltip &quot;Remove deleted messages from selected folder&quot;&gt;</span>
<a href="#l8.6"></a><span id="l8.6"> &lt;!ENTITY appmenuButton1.tooltip &quot;Display the &amp;brandShortName; Menu&quot;&gt;</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> &lt;!-- Toolbar Button Popup --&gt;</span>
<a href="#l8.9"></a><span id="l8.9"> &lt;!ENTITY buttonMenuForwardAsInline.label &quot;Forward Inline&quot;&gt;</span>
<a href="#l8.10"></a><span id="l8.10"> &lt;!ENTITY buttonMenuForwardAsAttachment.label &quot;Forward As Attachment&quot;&gt;</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+&lt;!-- Remote Content Button Popup --&gt;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+&lt;!ENTITY remoteContentOptionsAllowForMsg.label &quot;Show remote content in this message&quot;&gt;</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+&lt;!ENTITY remoteContentOptionsAllowForMsg.accesskey &quot;S&quot;&gt;</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+&lt;!ENTITY remoteContentOptionAllowForAddress.label &quot;Show remote content from this sender&quot;&gt;</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+&lt;!ENTITY remoteContentOptionAllowForAddress.accesskey &quot;f&quot;&gt;</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+&lt;!-- Phishing Button Popup --&gt;</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+&lt;!ENTITY phishingOptionIgnore.label &quot;Ignore warning for this message&quot;&gt;</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+&lt;!ENTITY phishingOptionIgnore.accesskey &quot;n&quot;&gt;</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+&lt;!ENTITY phishingOptionDisableDetection.label &quot;Disable scam detection for all messages&quot;&gt;</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+&lt;!ENTITY phishingOptionDisableDetection.accesskey &quot;D&quot;&gt;</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+</span>
<a href="#l8.24"></a><span id="l8.24"> &lt;!-- AppMenu Popup --&gt;</span>
<a href="#l8.25"></a><span id="l8.25"> &lt;!ENTITY appmenuNewMsgCmd.label &quot;New Message&quot;&gt;</span>
<a href="#l8.26"></a><span id="l8.26"> &lt;!ENTITY appmenuNewContactCmd.label &quot;Address Book Contact&quot;&gt;</span>
<a href="#l8.27"></a><span id="l8.27"> &lt;!ENTITY appmenuEditMenu.label &quot;Edit&quot;&gt;</span>
<a href="#l8.28"></a><span id="l8.28"> &lt;!ENTITY appmenuToolbarLayout.label &quot;Toolbar Layout&quot;&gt;</span>
<a href="#l8.29"></a><span id="l8.29"> &lt;!ENTITY appmenuSelectThread.label &quot;Select Thread&quot;&gt;</span>
<a href="#l8.30"></a><span id="l8.30"> &lt;!ENTITY appmenuSelectFlagged.label &quot;Select Starred Messages&quot;&gt;</span>
<a href="#l8.31"></a><span id="l8.31"> </span>
<a href="#l8.32"></a><span id="l8.32" class="difflineat">@@ -783,37 +795,16 @@</span>
<a href="#l8.33"></a><span id="l8.33"> &lt;!ENTITY contextPlay.accesskey &quot;P&quot;&gt;</span>
<a href="#l8.34"></a><span id="l8.34"> &lt;!ENTITY contextPause.label &quot;Pause&quot;&gt;</span>
<a href="#l8.35"></a><span id="l8.35"> &lt;!ENTITY contextPause.accesskey &quot;P&quot;&gt;</span>
<a href="#l8.36"></a><span id="l8.36"> &lt;!ENTITY contextMute.label &quot;Mute&quot;&gt;</span>
<a href="#l8.37"></a><span id="l8.37"> &lt;!ENTITY contextMute.accesskey &quot;M&quot;&gt;</span>
<a href="#l8.38"></a><span id="l8.38"> &lt;!ENTITY contextUnmute.label &quot;Unmute&quot;&gt;</span>
<a href="#l8.39"></a><span id="l8.39"> &lt;!ENTITY contextUnmute.accesskey &quot;m&quot;&gt;</span>
<a href="#l8.40"></a><span id="l8.40"> </span>
<a href="#l8.41"></a><span id="l8.41" class="difflineminus">-&lt;!-- Junk Bar --&gt;</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-&lt;!ENTITY junkBarMessage2.label &quot;&amp;brandShortName; thinks this message is junk mail.&quot;&gt;</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineminus">-&lt;!ENTITY junkBarButton1.label &quot;Not Junk&quot;&gt;</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineminus">-&lt;!ENTITY junkInfoButton.label &quot;?&quot;&gt;</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineminus">-</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineminus">-&lt;!-- Remote Content Bar --&gt;</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-&lt;!ENTITY remoteContentMessage2.label &quot;To protect your privacy, &amp;brandShortName; has blocked remote content in this message.&quot;&gt;</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-&lt;!ENTITY loadRemoteContentButton3.label &quot;Show Remote Content&quot;&gt;</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-&lt;!-- Phishing Bar --&gt;</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-&lt;!ENTITY phishingBarMessage2.label &quot;This message may be a scam.&quot;&gt;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-&lt;!ENTITY removePhishingBarButton1.label &quot;Ignore Warning&quot;&gt;</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-&lt;!ENTITY disablePhishingWarning1.label &quot;Disable scam detection for all messages&quot;&gt;</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-&lt;!ENTITY reportPhishingError1.label &quot;This message doesn't appear to be a scam.&quot;&gt;</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-&lt;!-- MDN Bar --&gt;</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineminus">-&lt;!ENTITY mdnBarIgnoreButton2.label &quot;Ignore&quot;&gt;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineminus">-&lt;!ENTITY mdnBarIgnoreButton2.accesskey &quot;I&quot;&gt;</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-&lt;!ENTITY mdnBarSendButton2.label &quot;Send Return Receipt&quot;&gt;</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-&lt;!ENTITY mdnBarSendButton2.accesskey &quot;S&quot;&gt;</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineminus">-</span>
<a href="#l8.62"></a><span id="l8.62"> &lt;!-- Quick Search Bar --&gt;</span>
<a href="#l8.63"></a><span id="l8.63"> &lt;!-- LOCALIZATION NOTE (quickSearchCmd.key):</span>
<a href="#l8.64"></a><span id="l8.64">      This is actually the key used for the global message search box; we have</span>
<a href="#l8.65"></a><span id="l8.65">      not changed </span>
<a href="#l8.66"></a><span id="l8.66">      --&gt;</span>
<a href="#l8.67"></a><span id="l8.67"> &lt;!ENTITY quickSearchCmd.key &quot;k&quot;&gt;</span>
<a href="#l8.68"></a><span id="l8.68"> &lt;!-- LOCALIZATION NOTE (search.label.base):</span>
<a href="#l8.69"></a><span id="l8.69">      This is the base of the empty text for the global search box.  We replace</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.properties</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.properties</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -297,16 +297,44 @@ feedsAcctType=Feeds</span>
<a href="#l9.4"></a><span id="l9.4"> # LOCALIZATION NOTE(nocachedbodytitle): Do not translate &quot;&lt;TITLE&gt;&quot; or &quot;&lt;/TITLE&gt;&quot; in the line below</span>
<a href="#l9.5"></a><span id="l9.5"> nocachedbodytitle=&lt;TITLE&gt;Go Online to View This Message&lt;/TITLE&gt;\n</span>
<a href="#l9.6"></a><span id="l9.6"> </span>
<a href="#l9.7"></a><span id="l9.7"> # mailWindowOverlay.js</span>
<a href="#l9.8"></a><span id="l9.8"> confirmUnsubscribeTitle=Confirm Unsubscribe</span>
<a href="#l9.9"></a><span id="l9.9"> confirmUnsubscribeText=Are you sure you want to unsubscribe from %S?</span>
<a href="#l9.10"></a><span id="l9.10"> confirmUnsubscribeManyText=Are you sure you want to unsubscribe from these newsgroups?</span>
<a href="#l9.11"></a><span id="l9.11"> restoreAllTabs=Restore All Tabs</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+# LOCALIZATION NOTE(junkBarMessage): %S is brand</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+junkBarMessage=%S thinks this message is Junk mail.</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+junkBarButton=Not Junk</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+junkBarButtonKey=N</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+junkBarInfoButton=Learn More</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+junkBarInfoButtonKey=L</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+# LOCALIZATION NOTE(remoteContentBarMessage): %S is brand</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+remoteContentBarMessage=To protect your privacy, %S has blocked remote content in this message.</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+remoteContentPrefLabel=Options</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineplus">+remoteContentPrefAccesskey=O</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineplus">+remoteContentPrefLabelUnix=Preferences</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineplus">+remoteContentPrefAccesskeyUnix=P</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineplus">+</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineplus">+phishingBarMessage=This message may be a scam.</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineplus">+phishingBarPrefLabel=Options</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+phishingBarPrefAccesskey=O</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+phishingBarPrefLabelUnix=Preferences</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+phishingBarPrefAccesskeyUnix=P</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+mdnBarIgnoreButton=Ignore Request</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+mdnBarIgnoreButtonKey=n</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+mdnBarSendReqButton=Send Receipt</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+mdnBarSendReqButtonKey=S</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+draftMessageMsg=This is a draft message.</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+draftMessageButton=Edit</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+draftMessageButtonKey=E</span>
<a href="#l9.40"></a><span id="l9.40"> </span>
<a href="#l9.41"></a><span id="l9.41"> # msgHdrViewOverlay.js</span>
<a href="#l9.42"></a><span id="l9.42"> openLabel=Open</span>
<a href="#l9.43"></a><span id="l9.43"> openLabelAccesskey=O</span>
<a href="#l9.44"></a><span id="l9.44"> saveLabel=Save As</span>
<a href="#l9.45"></a><span id="l9.45"> saveLabelAccesskey=A</span>
<a href="#l9.46"></a><span id="l9.46"> detachLabel=Detach</span>
<a href="#l9.47"></a><span id="l9.47"> detachLabelAccesskey=D</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/steel/steelApplication.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/steel/steelApplication.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -50,17 +50,18 @@ Application.prototype = {</span>
<a href="#l10.4"></a><span id="l10.4"> 				    contractID: APPLICATION_CONTRACTID,</span>
<a href="#l10.5"></a><span id="l10.5"> 				    interfaces: [Ci.steelIApplication,</span>
<a href="#l10.6"></a><span id="l10.6"> 						 Ci.extIApplication,</span>
<a href="#l10.7"></a><span id="l10.7"> 						 Ci.nsIObserver],</span>
<a href="#l10.8"></a><span id="l10.8"> 				    flags: Ci.nsIClassInfo.SINGLETON}),</span>
<a href="#l10.9"></a><span id="l10.9"> </span>
<a href="#l10.10"></a><span id="l10.10">   // for steelIApplication</span>
<a href="#l10.11"></a><span id="l10.11">   platformIsMac: &quot;nsILocalFileMac&quot; in Components.interfaces,</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  platformIsLinux: &quot;@mozilla.org/gnome-gconf-service;1&quot; in Components.classes</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+  platformIsLinux: &quot;@mozilla.org/gnome-gconf-service;1&quot; in Components.classes,</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+  platformIsWindows: &quot;@mozilla.org/windows-registry-key;1&quot; in Components.classes</span>
<a href="#l10.15"></a><span id="l10.15"> };</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17"> #include ../../mozilla/toolkit/components/exthelper/extApplication.js</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> Application.prototype.__proto__ = extApplication.prototype;</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21"> const NSGetFactory = XPCOMUtils.generateNSGetFactory([Application]);</span>
<a href="#l10.22"></a><span id="l10.22"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/steel/steelIApplication.idl</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/steel/steelIApplication.idl</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -2,23 +2,28 @@</span>
<a href="#l11.4"></a><span id="l11.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.5"></a><span id="l11.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l11.6"></a><span id="l11.6"> </span>
<a href="#l11.7"></a><span id="l11.7"> #include &quot;extIApplication.idl&quot;</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9"> /**</span>
<a href="#l11.10"></a><span id="l11.10">  * The core STEEL object, available in the global scope</span>
<a href="#l11.11"></a><span id="l11.11">  */</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-[scriptable, uuid(d8e187c3-6303-474e-a690-c2eef3331f20)]</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+[scriptable, uuid(e33b45c3-9b44-45f2-8aa3-c89805695f2b)]</span>
<a href="#l11.14"></a><span id="l11.14"> interface steelIApplication : extIApplication {</span>
<a href="#l11.15"></a><span id="l11.15">   /**</span>
<a href="#l11.16"></a><span id="l11.16">    * Returns true if the application is running on a Mac OS X. This is intended</span>
<a href="#l11.17"></a><span id="l11.17">    * for situations where Mac does things differently, e.g. The application</span>
<a href="#l11.18"></a><span id="l11.18">    * doesn't support print preview on Mac because Mac provides a preview option</span>
<a href="#l11.19"></a><span id="l11.19">    * in the print dialog.</span>
<a href="#l11.20"></a><span id="l11.20">    */</span>
<a href="#l11.21"></a><span id="l11.21">   readonly attribute boolean platformIsMac;</span>
<a href="#l11.22"></a><span id="l11.22"> </span>
<a href="#l11.23"></a><span id="l11.23">   /**</span>
<a href="#l11.24"></a><span id="l11.24">    * Returns true if the application is running on GNU/Linux or on UNIX.</span>
<a href="#l11.25"></a><span id="l11.25">    */</span>
<a href="#l11.26"></a><span id="l11.26">   readonly attribute boolean platformIsLinux;</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+  /**</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+   * Returns true if the application is running on Windows.</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+   */</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+  readonly attribute boolean platformIsWindows;</span>
<a href="#l11.32"></a><span id="l11.32"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">rename from mail/steel/test/test_linux_platformIsLinux.js</span>
<a href="#l12.2"></a><span id="l12.2">rename to mail/steel/test/test_linux_platformChecks.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineminus">--- a/mail/steel/test/test_linux_platformIsLinux.js</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineplus">+++ b/mail/steel/test/test_linux_platformChecks.js</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l12.6"></a><span id="l12.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.7"></a><span id="l12.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.8"></a><span id="l12.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.9"></a><span id="l12.9"> </span>
<a href="#l12.10"></a><span id="l12.10"> /**</span>
<a href="#l12.11"></a><span id="l12.11">  * Linux specific version of testing the platformIsLinux part of</span>
<a href="#l12.12"></a><span id="l12.12">  * steelIApplication.</span>
<a href="#l12.13"></a><span id="l12.13">  */</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-</span>
<a href="#l12.15"></a><span id="l12.15"> function run_test() {</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-  do_check_true(Cc[&quot;@mozilla.org/steel/application;1&quot;]</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-                   .getService(Ci.steelIApplication).platformIsLinux);</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+  let steel = Cc[&quot;@mozilla.org/steel/application;1&quot;].getService(Ci.steelIApplication);</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  do_check_true(steel.platformIsLinux);</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+  do_check_false(steel.platformIsMac);</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+  do_check_false(steel.platformIsWindows);</span>
<a href="#l12.22"></a><span id="l12.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">rename from mail/steel/test/test_mac_platformIsLinux.js</span>
<a href="#l13.2"></a><span id="l13.2">rename to mail/steel/test/test_mac_platformChecks.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineminus">--- a/mail/steel/test/test_mac_platformIsLinux.js</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineplus">+++ b/mail/steel/test/test_mac_platformChecks.js</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l13.6"></a><span id="l13.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.7"></a><span id="l13.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.8"></a><span id="l13.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.9"></a><span id="l13.9"> </span>
<a href="#l13.10"></a><span id="l13.10"> /**</span>
<a href="#l13.11"></a><span id="l13.11">  * Mac specific version of testing the platformIsLinux part of</span>
<a href="#l13.12"></a><span id="l13.12">  * steelIApplication.</span>
<a href="#l13.13"></a><span id="l13.13">  */</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-</span>
<a href="#l13.15"></a><span id="l13.15"> function run_test() {</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-  do_check_false(Cc[&quot;@mozilla.org/steel/application;1&quot;]</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-                   .getService(Ci.steelIApplication).platformIsLinux);</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+  let steel = Cc[&quot;@mozilla.org/steel/application;1&quot;].getService(Ci.steelIApplication);</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+  do_check_false(steel.platformIsLinux);</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+  do_check_true(steel.platformIsMac);</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+  do_check_false(steel.platformIsWindows);</span>
<a href="#l13.22"></a><span id="l13.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">rename from mail/steel/test/test_other_platformIsLinux.js</span>
<a href="#l14.2"></a><span id="l14.2">rename to mail/steel/test/test_windows_platformChecks.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineminus">--- a/mail/steel/test/test_other_platformIsLinux.js</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineplus">+++ b/mail/steel/test/test_windows_platformChecks.js</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l14.6"></a><span id="l14.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.7"></a><span id="l14.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.8"></a><span id="l14.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l14.9"></a><span id="l14.9"> </span>
<a href="#l14.10"></a><span id="l14.10"> /**</span>
<a href="#l14.11"></a><span id="l14.11">  * Non-Mac and non-Linux specific version of testing the platformIsLinux</span>
<a href="#l14.12"></a><span id="l14.12">  * part of steelIApplication.</span>
<a href="#l14.13"></a><span id="l14.13">  */</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-</span>
<a href="#l14.15"></a><span id="l14.15"> function run_test() {</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-  do_check_false(Cc[&quot;@mozilla.org/steel/application;1&quot;]</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-                   .getService(Ci.steelIApplication).platformIsLinux);</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+  let steel = Cc[&quot;@mozilla.org/steel/application;1&quot;].getService(Ci.steelIApplication);</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineplus">+  do_check_false(steel.platformIsLinux);</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineplus">+  do_check_false(steel.platformIsMac);</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+  do_check_true(steel.platformIsWindows);</span>
<a href="#l14.22"></a><span id="l14.22"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/steel/test/xpcshell.ini</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/steel/test/xpcshell.ini</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,22 +1,17 @@</span>
<a href="#l15.4"></a><span id="l15.4"> ; This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.5"></a><span id="l15.5"> ; License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.6"></a><span id="l15.6"> ; file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8"> [DEFAULT]</span>
<a href="#l15.9"></a><span id="l15.9"> head = head_steel.js</span>
<a href="#l15.10"></a><span id="l15.10"> tail =</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-[test_mac_platformIsMac.js]</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-run-if = os == 'mac'</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-[test_mac_platformIsLinux.js]</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+[test_mac_platformChecks.js]</span>
<a href="#l15.16"></a><span id="l15.16"> run-if = os == 'mac'</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-[test_linux_platformIsMac.js]</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">-run-if = os == 'linux'</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">-[test_linux_platformIsLinux.js]</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+[test_linux_platformChecks.js]</span>
<a href="#l15.22"></a><span id="l15.22"> run-if = os == 'linux'</span>
<a href="#l15.23"></a><span id="l15.23"> </span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-[test_other_platformIsMac.js]</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-skip-if = os == 'linux' || os == 'mac'</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineminus">-[test_other_platformIsLinux.js]</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineminus">-skip-if = os == 'linux' || os == 'mac'</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineplus">+[test_windows_platformChecks.js]</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineplus">+run-if = os == 'win'</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,54 +1,55 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.5"></a><span id="l16.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineminus">-  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineplus">+ * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9"> /**</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineminus">- * Tests the get an account workflow.</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineplus">+ * Tests that the cloudfile notifications work as they should.</span>
<a href="#l16.12"></a><span id="l16.12">  */</span>
<a href="#l16.13"></a><span id="l16.13"> </span>
<a href="#l16.14"></a><span id="l16.14"> let MODULE_NAME = 'test-cloudfile-notifications';</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> let RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l16.17"></a><span id="l16.17"> let MODULE_REQUIRES = ['folder-display-helpers',</span>
<a href="#l16.18"></a><span id="l16.18">                        'compose-helpers',</span>
<a href="#l16.19"></a><span id="l16.19">                        'cloudfile-helpers',</span>
<a href="#l16.20"></a><span id="l16.20">                        'attachment-helpers',</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineminus">-                       'prompt-helpers'];</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+                       'prompt-helpers', </span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+                       'notificationbox-helpers'];</span>
<a href="#l16.24"></a><span id="l16.24"> </span>
<a href="#l16.25"></a><span id="l16.25"> let controller = {};</span>
<a href="#l16.26"></a><span id="l16.26"> let mozmill = {};</span>
<a href="#l16.27"></a><span id="l16.27"> let elib = {};</span>
<a href="#l16.28"></a><span id="l16.28"> Cu.import('resource://mozmill/modules/controller.js', controller);</span>
<a href="#l16.29"></a><span id="l16.29"> Cu.import('resource://mozmill/modules/mozmill.js', mozmill);</span>
<a href="#l16.30"></a><span id="l16.30"> Cu.import('resource://mozmill/modules/elementslib.js', elib);</span>
<a href="#l16.31"></a><span id="l16.31"> Cu.import('resource://gre/modules/Services.jsm');</span>
<a href="#l16.32"></a><span id="l16.32"> </span>
<a href="#l16.33"></a><span id="l16.33"> let maxSize, cfh, ah, oldInsertNotificationPref;</span>
<a href="#l16.34"></a><span id="l16.34"> </span>
<a href="#l16.35"></a><span id="l16.35"> const kOfferThreshold = &quot;mail.compose.big_attachments.threshold_kb&quot;;</span>
<a href="#l16.36"></a><span id="l16.36"> const kInsertNotificationPref = &quot;mail.compose.big_attachments.insert_notification&quot;;</span>
<a href="#l16.37"></a><span id="l16.37"> </span>
<a href="#l16.38"></a><span id="l16.38" class="difflineplus">+const kBoxId = &quot;attachmentNotificationBox&quot;;</span>
<a href="#l16.39"></a><span id="l16.39" class="difflineplus">+</span>
<a href="#l16.40"></a><span id="l16.40"> function setupModule(module) {</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineminus">-  let fdh = collector.getModule('folder-display-helpers');</span>
<a href="#l16.42"></a><span id="l16.42" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineminus">-</span>
<a href="#l16.44"></a><span id="l16.44" class="difflineminus">-  let ch = collector.getModule('compose-helpers');</span>
<a href="#l16.45"></a><span id="l16.45" class="difflineminus">-  ch.installInto(module);</span>
<a href="#l16.46"></a><span id="l16.46" class="difflineplus">+  collector.getModule('folder-display-helpers').installInto(module);</span>
<a href="#l16.47"></a><span id="l16.47" class="difflineplus">+  collector.getModule('compose-helpers').installInto(module);</span>
<a href="#l16.48"></a><span id="l16.48"> </span>
<a href="#l16.49"></a><span id="l16.49">   cfh = collector.getModule('cloudfile-helpers');</span>
<a href="#l16.50"></a><span id="l16.50">   cfh.installInto(module);</span>
<a href="#l16.51"></a><span id="l16.51">   cfh.gMockCloudfileManager.register();</span>
<a href="#l16.52"></a><span id="l16.52"> </span>
<a href="#l16.53"></a><span id="l16.53">   ah = collector.getModule('attachment-helpers');</span>
<a href="#l16.54"></a><span id="l16.54">   ah.installInto(module);</span>
<a href="#l16.55"></a><span id="l16.55">   ah.gMockFilePickReg.register();</span>
<a href="#l16.56"></a><span id="l16.56"> </span>
<a href="#l16.57"></a><span id="l16.57">   collector.getModule('prompt-helpers').installInto(module);</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineplus">+  collector.getModule('notificationbox-helpers').installInto(module);</span>
<a href="#l16.59"></a><span id="l16.59"> </span>
<a href="#l16.60"></a><span id="l16.60">   maxSize = Services.prefs.getIntPref(kOfferThreshold, 0) * 1024;</span>
<a href="#l16.61"></a><span id="l16.61">   oldInsertNotificationPref = Services.prefs</span>
<a href="#l16.62"></a><span id="l16.62">                                       .getBoolPref(kInsertNotificationPref);</span>
<a href="#l16.63"></a><span id="l16.63">   Services.prefs.setBoolPref(kInsertNotificationPref, true);</span>
<a href="#l16.64"></a><span id="l16.64"> };</span>
<a href="#l16.65"></a><span id="l16.65"> </span>
<a href="#l16.66"></a><span id="l16.66"> function teardownModule(module) {</span>
<a href="#l16.67"></a><span id="l16.67" class="difflineat">@@ -62,57 +63,57 @@ function teardownModule(module) {</span>
<a href="#l16.68"></a><span id="l16.68">  * A helper function to assert that the Filelink offer notification is</span>
<a href="#l16.69"></a><span id="l16.69">  * either displayed or not displayed.</span>
<a href="#l16.70"></a><span id="l16.70">  *</span>
<a href="#l16.71"></a><span id="l16.71">  * @param aController the controller of the compose window to check.</span>
<a href="#l16.72"></a><span id="l16.72">  * @param aDisplayed true if the notification should be displayed, false</span>
<a href="#l16.73"></a><span id="l16.73">  *                   otherwise.</span>
<a href="#l16.74"></a><span id="l16.74">  */</span>
<a href="#l16.75"></a><span id="l16.75"> function assert_cloudfile_notification_displayed(aController, aDisplayed) {</span>
<a href="#l16.76"></a><span id="l16.76" class="difflineminus">-  assert_notification_displayed(aController, &quot;bigAttachment&quot;, aDisplayed);</span>
<a href="#l16.77"></a><span id="l16.77" class="difflineplus">+  assert_notification_displayed(aController, kBoxId, &quot;bigAttachment&quot;, aDisplayed);</span>
<a href="#l16.78"></a><span id="l16.78"> }</span>
<a href="#l16.79"></a><span id="l16.79"> </span>
<a href="#l16.80"></a><span id="l16.80"> /**</span>
<a href="#l16.81"></a><span id="l16.81">  * A helper function to assert that the Filelink upload notification is</span>
<a href="#l16.82"></a><span id="l16.82">  * either displayed or not displayed.</span>
<a href="#l16.83"></a><span id="l16.83">  *</span>
<a href="#l16.84"></a><span id="l16.84">  * @param aController the controller of the compose window to check.</span>
<a href="#l16.85"></a><span id="l16.85">  * @param aDisplayed true if the notification should be displayed, false</span>
<a href="#l16.86"></a><span id="l16.86">  *                   otherwise.</span>
<a href="#l16.87"></a><span id="l16.87">  */</span>
<a href="#l16.88"></a><span id="l16.88"> function assert_upload_notification_displayed(aController, aDisplayed) {</span>
<a href="#l16.89"></a><span id="l16.89" class="difflineminus">-  assert_notification_displayed(aController, &quot;bigAttachmentUploading&quot;,</span>
<a href="#l16.90"></a><span id="l16.90" class="difflineplus">+  assert_notification_displayed(aController, kBoxId, &quot;bigAttachmentUploading&quot;,</span>
<a href="#l16.91"></a><span id="l16.91">                                 aDisplayed);</span>
<a href="#l16.92"></a><span id="l16.92"> }</span>
<a href="#l16.93"></a><span id="l16.93"> </span>
<a href="#l16.94"></a><span id="l16.94"> /**</span>
<a href="#l16.95"></a><span id="l16.95">  * A helper function to assert that the Filelink privacy warning notification</span>
<a href="#l16.96"></a><span id="l16.96">  * is either displayed or not displayed.</span>
<a href="#l16.97"></a><span id="l16.97">  *</span>
<a href="#l16.98"></a><span id="l16.98">  * @param aController the controller of the compose window to check.</span>
<a href="#l16.99"></a><span id="l16.99">  * @param aDisplayed true if the notification should be displayed, false</span>
<a href="#l16.100"></a><span id="l16.100">  *                   otherwise.</span>
<a href="#l16.101"></a><span id="l16.101">  */</span>
<a href="#l16.102"></a><span id="l16.102"> function assert_privacy_warning_notification_displayed(aController, aDisplayed) {</span>
<a href="#l16.103"></a><span id="l16.103" class="difflineminus">-  assert_notification_displayed(aController, &quot;bigAttachmentPrivacyWarning&quot;,</span>
<a href="#l16.104"></a><span id="l16.104" class="difflineplus">+  assert_notification_displayed(aController, kBoxId, &quot;bigAttachmentPrivacyWarning&quot;,</span>
<a href="#l16.105"></a><span id="l16.105">                                 aDisplayed);</span>
<a href="#l16.106"></a><span id="l16.106"> }</span>
<a href="#l16.107"></a><span id="l16.107"> </span>
<a href="#l16.108"></a><span id="l16.108"> /**</span>
<a href="#l16.109"></a><span id="l16.109">  * A helper function to close the Filelink upload notification.</span>
<a href="#l16.110"></a><span id="l16.110">  */</span>
<a href="#l16.111"></a><span id="l16.111"> function close_upload_notification(aController) {</span>
<a href="#l16.112"></a><span id="l16.112" class="difflineminus">-  close_notification(aController, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.113"></a><span id="l16.113" class="difflineplus">+  close_notification(aController, kBoxId, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.114"></a><span id="l16.114"> }</span>
<a href="#l16.115"></a><span id="l16.115"> </span>
<a href="#l16.116"></a><span id="l16.116"> /**</span>
<a href="#l16.117"></a><span id="l16.117">  * A helper function to close the Filelink privacy warning notification.</span>
<a href="#l16.118"></a><span id="l16.118">  */</span>
<a href="#l16.119"></a><span id="l16.119"> function close_privacy_warning_notification(aController) {</span>
<a href="#l16.120"></a><span id="l16.120" class="difflineminus">-  close_notification(aController, &quot;bigAttachmentPrivacyWarning&quot;);</span>
<a href="#l16.121"></a><span id="l16.121" class="difflineplus">+  close_notification(aController, kBoxId, &quot;bigAttachmentPrivacyWarning&quot;);</span>
<a href="#l16.122"></a><span id="l16.122"> }</span>
<a href="#l16.123"></a><span id="l16.123"> </span>
<a href="#l16.124"></a><span id="l16.124"> function test_no_notification_for_small_file() {</span>
<a href="#l16.125"></a><span id="l16.125">   let cwc = open_compose_new_mail(mc);</span>
<a href="#l16.126"></a><span id="l16.126">   add_attachments(cwc, &quot;http://www.example.com/1&quot;, 0);</span>
<a href="#l16.127"></a><span id="l16.127">   assert_cloudfile_notification_displayed(cwc, false);</span>
<a href="#l16.128"></a><span id="l16.128"> </span>
<a href="#l16.129"></a><span id="l16.129">   add_attachments(cwc, &quot;http://www.example.com/2&quot;, 1);</span>
<a href="#l16.130"></a><span id="l16.130" class="difflineat">@@ -235,17 +236,17 @@ function test_link_insertion_goes_away_o</span>
<a href="#l16.131"></a><span id="l16.131">       aListener.onStopRequest(null, null,</span>
<a href="#l16.132"></a><span id="l16.132">                               Ci.nsIMsgCloudFileProvider.uploadErr);</span>
<a href="#l16.133"></a><span id="l16.133">     }, 500);</span>
<a href="#l16.134"></a><span id="l16.134">   }</span>
<a href="#l16.135"></a><span id="l16.135">   let cwc = open_compose_new_mail(mc);</span>
<a href="#l16.136"></a><span id="l16.136">   cwc.window.attachToCloud(provider);</span>
<a href="#l16.137"></a><span id="l16.137"> </span>
<a href="#l16.138"></a><span id="l16.138">   assert_upload_notification_displayed(cwc, true);</span>
<a href="#l16.139"></a><span id="l16.139" class="difflineminus">-  wait_for_notification_to_stop(cwc, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.140"></a><span id="l16.140" class="difflineplus">+  wait_for_notification_to_stop(cwc, kBoxId, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.141"></a><span id="l16.141">   gMockPromptService.unregister();</span>
<a href="#l16.142"></a><span id="l16.142"> }</span>
<a href="#l16.143"></a><span id="l16.143"> </span>
<a href="#l16.144"></a><span id="l16.144"> /**</span>
<a href="#l16.145"></a><span id="l16.145">  * Test that we do not show the Filelink offer notification if we convert</span>
<a href="#l16.146"></a><span id="l16.146">  * a Filelink back into a normal attachment.</span>
<a href="#l16.147"></a><span id="l16.147">  */</span>
<a href="#l16.148"></a><span id="l16.148"> function test_no_offer_on_conversion() {</span>
<a href="#l16.149"></a><span id="l16.149" class="difflineat">@@ -346,17 +347,17 @@ function test_privacy_warning_notificati</span>
<a href="#l16.150"></a><span id="l16.150">       aListener.onStopRequest(null, null,</span>
<a href="#l16.151"></a><span id="l16.151">                               Components.results.NS_OK);</span>
<a href="#l16.152"></a><span id="l16.152">     }, 500);</span>
<a href="#l16.153"></a><span id="l16.153">   }</span>
<a href="#l16.154"></a><span id="l16.154">   let cwc = open_compose_new_mail(mc);</span>
<a href="#l16.155"></a><span id="l16.155">   cwc.window.attachToCloud(provider);</span>
<a href="#l16.156"></a><span id="l16.156"> </span>
<a href="#l16.157"></a><span id="l16.157">   assert_upload_notification_displayed(cwc, true);</span>
<a href="#l16.158"></a><span id="l16.158" class="difflineminus">-  wait_for_notification_to_stop(cwc, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.159"></a><span id="l16.159" class="difflineplus">+  wait_for_notification_to_stop(cwc, kBoxId, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.160"></a><span id="l16.160"> </span>
<a href="#l16.161"></a><span id="l16.161">   // Assert that the warning is displayed.</span>
<a href="#l16.162"></a><span id="l16.162">   assert_privacy_warning_notification_displayed(cwc, true);</span>
<a href="#l16.163"></a><span id="l16.163"> </span>
<a href="#l16.164"></a><span id="l16.164">   // Close the privacy warning notification...</span>
<a href="#l16.165"></a><span id="l16.165">   close_privacy_warning_notification(cwc);</span>
<a href="#l16.166"></a><span id="l16.166"> </span>
<a href="#l16.167"></a><span id="l16.167">   // And now upload some more files. We shouldn't get the warning again.</span>
<a href="#l16.168"></a><span id="l16.168" class="difflineat">@@ -385,17 +386,17 @@ function test_privacy_warning_notificati</span>
<a href="#l16.169"></a><span id="l16.169">       aListener.onStopRequest(null, null,</span>
<a href="#l16.170"></a><span id="l16.170">                               Components.results.NS_OK);</span>
<a href="#l16.171"></a><span id="l16.171">     }, 500);</span>
<a href="#l16.172"></a><span id="l16.172">   }</span>
<a href="#l16.173"></a><span id="l16.173">   let cwc = open_compose_new_mail(mc);</span>
<a href="#l16.174"></a><span id="l16.174">   cwc.window.attachToCloud(provider);</span>
<a href="#l16.175"></a><span id="l16.175"> </span>
<a href="#l16.176"></a><span id="l16.176">   assert_upload_notification_displayed(cwc, true);</span>
<a href="#l16.177"></a><span id="l16.177" class="difflineminus">-  wait_for_notification_to_stop(cwc, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.178"></a><span id="l16.178" class="difflineplus">+  wait_for_notification_to_stop(cwc, kBoxId, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.179"></a><span id="l16.179"> </span>
<a href="#l16.180"></a><span id="l16.180">   // Assert that the warning is displayed.</span>
<a href="#l16.181"></a><span id="l16.181">   assert_privacy_warning_notification_displayed(cwc, true);</span>
<a href="#l16.182"></a><span id="l16.182"> </span>
<a href="#l16.183"></a><span id="l16.183">   // Close the compose window</span>
<a href="#l16.184"></a><span id="l16.184">   close_compose_window(cwc);</span>
<a href="#l16.185"></a><span id="l16.185"> </span>
<a href="#l16.186"></a><span id="l16.186">   // Open a new compose window</span>
<a href="#l16.187"></a><span id="l16.187" class="difflineat">@@ -424,31 +425,31 @@ function test_privacy_warning_notificati</span>
<a href="#l16.188"></a><span id="l16.188">       aListener.onStopRequest(null, null,</span>
<a href="#l16.189"></a><span id="l16.189">                               Components.results.NS_OK);</span>
<a href="#l16.190"></a><span id="l16.190">     }, 500);</span>
<a href="#l16.191"></a><span id="l16.191">   }</span>
<a href="#l16.192"></a><span id="l16.192">   let cwc = open_compose_new_mail(mc);</span>
<a href="#l16.193"></a><span id="l16.193">   cwc.window.attachToCloud(provider);</span>
<a href="#l16.194"></a><span id="l16.194"> </span>
<a href="#l16.195"></a><span id="l16.195">   assert_upload_notification_displayed(cwc, true);</span>
<a href="#l16.196"></a><span id="l16.196" class="difflineminus">-  wait_for_notification_to_stop(cwc, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.197"></a><span id="l16.197" class="difflineplus">+  wait_for_notification_to_stop(cwc, kBoxId, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.198"></a><span id="l16.198"> </span>
<a href="#l16.199"></a><span id="l16.199">   // Assert that the warning is displayed.</span>
<a href="#l16.200"></a><span id="l16.200">   assert_privacy_warning_notification_displayed(cwc, true);</span>
<a href="#l16.201"></a><span id="l16.201"> </span>
<a href="#l16.202"></a><span id="l16.202">   // Close the privacy warning notification...</span>
<a href="#l16.203"></a><span id="l16.203">   close_privacy_warning_notification(cwc);</span>
<a href="#l16.204"></a><span id="l16.204"> </span>
<a href="#l16.205"></a><span id="l16.205">   // Open a new compose window</span>
<a href="#l16.206"></a><span id="l16.206">   cwc = open_compose_new_mail(mc);</span>
<a href="#l16.207"></a><span id="l16.207"> </span>
<a href="#l16.208"></a><span id="l16.208">   gMockFilePicker.returnFiles = collectFiles(['./data/testFile3',</span>
<a href="#l16.209"></a><span id="l16.209">                                               './data/testFile4'], __file__);</span>
<a href="#l16.210"></a><span id="l16.210">   cwc.window.attachToCloud(provider);</span>
<a href="#l16.211"></a><span id="l16.211"> </span>
<a href="#l16.212"></a><span id="l16.212">   assert_upload_notification_displayed(cwc, true);</span>
<a href="#l16.213"></a><span id="l16.213" class="difflineminus">-  wait_for_notification_to_stop(cwc, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.214"></a><span id="l16.214" class="difflineplus">+  wait_for_notification_to_stop(cwc, kBoxId, &quot;bigAttachmentUploading&quot;);</span>
<a href="#l16.215"></a><span id="l16.215"> </span>
<a href="#l16.216"></a><span id="l16.216">   // Assert that the privacy warning notification is displayed again.</span>
<a href="#l16.217"></a><span id="l16.217">   assert_privacy_warning_notification_displayed(cwc, true);</span>
<a href="#l16.218"></a><span id="l16.218"> </span>
<a href="#l16.219"></a><span id="l16.219">   gMockPromptService.unregister();</span>
<a href="#l16.220"></a><span id="l16.220"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-attachment-reminder.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-attachment-reminder.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -6,61 +6,62 @@</span>
<a href="#l17.4"></a><span id="l17.4">  * Tests that the attachment reminder works properly.</span>
<a href="#l17.5"></a><span id="l17.5">  */</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7"> const MODULE_NAME = &quot;test-attachment-reminder&quot;;</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9"> const RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l17.10"></a><span id="l17.10"> const MODULE_REQUIRES = [&quot;folder-display-helpers&quot;,</span>
<a href="#l17.11"></a><span id="l17.11">                          &quot;compose-helpers&quot;,</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-                         &quot;window-helpers&quot;];</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+                         &quot;window-helpers&quot;,</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+                         &quot;notificationbox-helpers&quot;];</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16"> Cu.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-// I'm not sure why this is the ID. But it is. :/</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineminus">-const kNotificationID = &quot;1&quot;;</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+const kBoxId = &quot;attachmentNotificationBox&quot;;</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+const kNotificationId = &quot;attachmentReminder&quot;;</span>
<a href="#l17.22"></a><span id="l17.22"> </span>
<a href="#l17.23"></a><span id="l17.23"> function setupModule(module) {</span>
<a href="#l17.24"></a><span id="l17.24">   collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l17.25"></a><span id="l17.25">   collector.getModule(&quot;compose-helpers&quot;).installInto(module);</span>
<a href="#l17.26"></a><span id="l17.26">   collector.getModule(&quot;window-helpers&quot;).installInto(module);</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+  collector.getModule(&quot;notificationbox-helpers&quot;).installInto(module);</span>
<a href="#l17.28"></a><span id="l17.28"> };</span>
<a href="#l17.29"></a><span id="l17.29"> </span>
<a href="#l17.30"></a><span id="l17.30"> function setupComposeWin(aCwc, toAddr, subj, body) {</span>
<a href="#l17.31"></a><span id="l17.31">   aCwc.type(null, toAddr);</span>
<a href="#l17.32"></a><span id="l17.32">   aCwc.type(aCwc.eid(&quot;msgSubject&quot;), subj)</span>
<a href="#l17.33"></a><span id="l17.33">   aCwc.type(aCwc.eid(&quot;content-frame&quot;), body);</span>
<a href="#l17.34"></a><span id="l17.34"> }</span>
<a href="#l17.35"></a><span id="l17.35"> </span>
<a href="#l17.36"></a><span id="l17.36"> /**</span>
<a href="#l17.37"></a><span id="l17.37">  * Test that the attachment works, in general.</span>
<a href="#l17.38"></a><span id="l17.38">  */</span>
<a href="#l17.39"></a><span id="l17.39"> function test_attachment_reminder_appears_properly() {</span>
<a href="#l17.40"></a><span id="l17.40">   let cwc = open_compose_new_mail();</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineminus">-  let notificationBox = cwc.e(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineplus">+  let notificationBox = cwc.e(kBoxId);</span>
<a href="#l17.43"></a><span id="l17.43"> </span>
<a href="#l17.44"></a><span id="l17.44">   // There should be no notification yet.</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineminus">-  assert_notification_displayed(cwc, kNotificationID, false);</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineplus">+  assert_notification_displayed(cwc, kBoxId, kNotificationId, false);</span>
<a href="#l17.47"></a><span id="l17.47"> </span>
<a href="#l17.48"></a><span id="l17.48">   setupComposeWin(cwc, &quot;test@example.org&quot;, &quot;testing attachment reminder!&quot;,</span>
<a href="#l17.49"></a><span id="l17.49">                   &quot;Hjello! &quot;);</span>
<a href="#l17.50"></a><span id="l17.50"> </span>
<a href="#l17.51"></a><span id="l17.51">   // Give the notification time to appear. It shouldn't.</span>
<a href="#l17.52"></a><span id="l17.52">   cwc.sleep(1100);</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineminus">-  if (notificationBox.getNotificationWithValue(kNotificationID))</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineplus">+  if (notificationBox.getNotificationWithValue(kNotificationId))</span>
<a href="#l17.55"></a><span id="l17.55">     throw new Error(&quot;Attachment notification shown when it shouldn't.&quot;);</span>
<a href="#l17.56"></a><span id="l17.56"> </span>
<a href="#l17.57"></a><span id="l17.57">   cwc.type(cwc.eid(&quot;content-frame&quot;), &quot;Seen this cool attachment?&quot;);</span>
<a href="#l17.58"></a><span id="l17.58"> </span>
<a href="#l17.59"></a><span id="l17.59">     // Give the notification time to appear. It should now.</span>
<a href="#l17.60"></a><span id="l17.60" class="difflineminus">-  wait_for_notification_to_show(cwc, kNotificationID);</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineplus">+  wait_for_notification_to_show(cwc, kBoxId, kNotificationId);</span>
<a href="#l17.62"></a><span id="l17.62"> </span>
<a href="#l17.63"></a><span id="l17.63">   // Click ok to be notified on send if no attachments are attached.</span>
<a href="#l17.64"></a><span id="l17.64" class="difflineminus">-  cwc.click(cwc.eid(&quot;attachmentNotificationBox&quot;,</span>
<a href="#l17.65"></a><span id="l17.65" class="difflineminus">-            {tagName: &quot;button&quot;, label: &quot;Remind Me Later&quot;}));</span>
<a href="#l17.66"></a><span id="l17.66" class="difflineplus">+  cwc.click(cwc.eid(kBoxId, {tagName: &quot;button&quot;, label: &quot;Remind Me Later&quot;}));</span>
<a href="#l17.67"></a><span id="l17.67"> </span>
<a href="#l17.68"></a><span id="l17.68">   // Now try to send, make sure we get the alert.</span>
<a href="#l17.69"></a><span id="l17.69">   plan_for_modal_dialog(&quot;commonDialog&quot;, click_oh_i_did);</span>
<a href="#l17.70"></a><span id="l17.70">   cwc.click(cwc.eid(&quot;button-send&quot;));</span>
<a href="#l17.71"></a><span id="l17.71">   wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l17.72"></a><span id="l17.72"> </span>
<a href="#l17.73"></a><span id="l17.73">   close_compose_window(cwc);</span>
<a href="#l17.74"></a><span id="l17.74"> }</span>
<a href="#l17.75"></a><span id="l17.75" class="difflineat">@@ -68,31 +69,31 @@ function test_attachment_reminder_appear</span>
<a href="#l17.76"></a><span id="l17.76"> /**</span>
<a href="#l17.77"></a><span id="l17.77">  * Test that the alert appears normally, but not after closing the</span>
<a href="#l17.78"></a><span id="l17.78">  * notification.</span>
<a href="#l17.79"></a><span id="l17.79">  */</span>
<a href="#l17.80"></a><span id="l17.80"> function test_attachment_reminder_dismissal() {</span>
<a href="#l17.81"></a><span id="l17.81">   let cwc = open_compose_new_mail();</span>
<a href="#l17.82"></a><span id="l17.82"> </span>
<a href="#l17.83"></a><span id="l17.83">   // There should be no notification yet.</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineminus">-  assert_notification_displayed(cwc, kNotificationID, false);</span>
<a href="#l17.85"></a><span id="l17.85" class="difflineplus">+  assert_notification_displayed(cwc, kBoxId, kNotificationId, false);</span>
<a href="#l17.86"></a><span id="l17.86"> </span>
<a href="#l17.87"></a><span id="l17.87">   setupComposeWin(cwc, &quot;test@example.org&quot;, &quot;popping up, eh?&quot;,</span>
<a href="#l17.88"></a><span id="l17.88">                   &quot;Hi there, remember the attachment!&quot;);</span>
<a href="#l17.89"></a><span id="l17.89"> </span>
<a href="#l17.90"></a><span id="l17.90">   // Give the notification time to appear.</span>
<a href="#l17.91"></a><span id="l17.91" class="difflineminus">-  wait_for_notification_to_show(cwc, kNotificationID);</span>
<a href="#l17.92"></a><span id="l17.92" class="difflineplus">+  wait_for_notification_to_show(cwc, kBoxId, kNotificationId);</span>
<a href="#l17.93"></a><span id="l17.93"> </span>
<a href="#l17.94"></a><span id="l17.94">   // We didn't click the &quot;Remind Me Later&quot; - the alert should pop up</span>
<a href="#l17.95"></a><span id="l17.95">   // on send anyway.</span>
<a href="#l17.96"></a><span id="l17.96">   plan_for_modal_dialog(&quot;commonDialog&quot;, click_oh_i_did);</span>
<a href="#l17.97"></a><span id="l17.97">   cwc.click(cwc.eid(&quot;button-send&quot;));</span>
<a href="#l17.98"></a><span id="l17.98">   wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l17.99"></a><span id="l17.99"> </span>
<a href="#l17.100"></a><span id="l17.100" class="difflineminus">-  let notification = assert_notification_displayed(cwc, kNotificationID,</span>
<a href="#l17.101"></a><span id="l17.101" class="difflineplus">+  let notification = assert_notification_displayed(cwc, kBoxId, kNotificationId,</span>
<a href="#l17.102"></a><span id="l17.102">                                                    true);</span>
<a href="#l17.103"></a><span id="l17.103">   notification.close();</span>
<a href="#l17.104"></a><span id="l17.104">   click_send_and_handle_send_error(cwc);</span>
<a href="#l17.105"></a><span id="l17.105"> }</span>
<a href="#l17.106"></a><span id="l17.106"> // Disabling this test on Windows due to random timeouts on our Mozmill</span>
<a href="#l17.107"></a><span id="l17.107"> // testers.</span>
<a href="#l17.108"></a><span id="l17.108"> test_attachment_reminder_dismissal.EXCLUDED_PLATFORMS = ['winnt'];</span>
<a href="#l17.109"></a><span id="l17.109"> </span>
<a href="#l17.110"></a><span id="l17.110" class="difflineat">@@ -101,22 +102,22 @@ test_attachment_reminder_dismissal.EXCLU</span>
<a href="#l17.111"></a><span id="l17.111">  */</span>
<a href="#l17.112"></a><span id="l17.112"> function test_attachment_reminder_aggressive_pref() {</span>
<a href="#l17.113"></a><span id="l17.113">   const kPref = &quot;mail.compose.attachment_reminder_aggressive&quot;;</span>
<a href="#l17.114"></a><span id="l17.114">   Services.prefs.setBoolPref(kPref, false);</span>
<a href="#l17.115"></a><span id="l17.115"> </span>
<a href="#l17.116"></a><span id="l17.116">   let cwc = open_compose_new_mail();</span>
<a href="#l17.117"></a><span id="l17.117"> </span>
<a href="#l17.118"></a><span id="l17.118">   // There should be no notification yet.</span>
<a href="#l17.119"></a><span id="l17.119" class="difflineminus">-  assert_notification_displayed(cwc, kNotificationID, false);</span>
<a href="#l17.120"></a><span id="l17.120" class="difflineplus">+  assert_notification_displayed(cwc, kBoxId, kNotificationId, false);</span>
<a href="#l17.121"></a><span id="l17.121"> </span>
<a href="#l17.122"></a><span id="l17.122">   setupComposeWin(cwc, &quot;test@example.org&quot;, &quot;aggressive?&quot;,</span>
<a href="#l17.123"></a><span id="l17.123">                   &quot;Check this attachment!&quot;);</span>
<a href="#l17.124"></a><span id="l17.124"> </span>
<a href="#l17.125"></a><span id="l17.125" class="difflineminus">-  wait_for_notification_to_show(cwc, kNotificationID);</span>
<a href="#l17.126"></a><span id="l17.126" class="difflineplus">+  wait_for_notification_to_show(cwc, kBoxId, kNotificationId);</span>
<a href="#l17.127"></a><span id="l17.127">   click_send_and_handle_send_error(cwc);</span>
<a href="#l17.128"></a><span id="l17.128"> </span>
<a href="#l17.129"></a><span id="l17.129">   // Now reset the pref back to original value.</span>
<a href="#l17.130"></a><span id="l17.130">   if (Services.prefs.prefHasUserValue(kPref))</span>
<a href="#l17.131"></a><span id="l17.131">     Services.prefs.clearUserPref(kPref);</span>
<a href="#l17.132"></a><span id="l17.132"> }</span>
<a href="#l17.133"></a><span id="l17.133"> // Disabling this test on Windows due to random timeouts on our Mozmill</span>
<a href="#l17.134"></a><span id="l17.134"> // testers.</span>
<a href="#l17.135"></a><span id="l17.135" class="difflineat">@@ -128,17 +129,17 @@ test_attachment_reminder_aggressive_pref</span>
<a href="#l17.136"></a><span id="l17.136">  */</span>
<a href="#l17.137"></a><span id="l17.137"> function test_no_send_now_sends() {</span>
<a href="#l17.138"></a><span id="l17.138">   let cwc = open_compose_new_mail();</span>
<a href="#l17.139"></a><span id="l17.139"> </span>
<a href="#l17.140"></a><span id="l17.140">   setupComposeWin(cwc, &quot;test@example.org&quot;,</span>
<a href="#l17.141"></a><span id="l17.141">                   &quot;will the 'No, Send Now' button work?&quot;,</span>
<a href="#l17.142"></a><span id="l17.142">                   &quot;Hello, i got your attachment!&quot;);</span>
<a href="#l17.143"></a><span id="l17.143"> </span>
<a href="#l17.144"></a><span id="l17.144" class="difflineminus">-  wait_for_notification_to_show(cwc, kNotificationID);</span>
<a href="#l17.145"></a><span id="l17.145" class="difflineplus">+  wait_for_notification_to_show(cwc, kBoxId, kNotificationId);</span>
<a href="#l17.146"></a><span id="l17.146"> </span>
<a href="#l17.147"></a><span id="l17.147">   // Click the send button again, this time choose &quot;No, Send Now&quot;.</span>
<a href="#l17.148"></a><span id="l17.148">   plan_for_modal_dialog(&quot;commonDialog&quot;, click_no_send_now);</span>
<a href="#l17.149"></a><span id="l17.149">   cwc.click(cwc.eid(&quot;button-send&quot;));</span>
<a href="#l17.150"></a><span id="l17.150">   wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l17.151"></a><span id="l17.151"> </span>
<a href="#l17.152"></a><span id="l17.152">   click_send_and_handle_send_error(cwc);</span>
<a href="#l17.153"></a><span id="l17.153"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-drafts.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-drafts.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -12,16 +12,17 @@</span>
<a href="#l18.4"></a><span id="l18.4"> const MODULE_NAME = &quot;test-drafts&quot;;</span>
<a href="#l18.5"></a><span id="l18.5"> </span>
<a href="#l18.6"></a><span id="l18.6"> const RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l18.7"></a><span id="l18.7"> const MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;, &quot;window-helpers&quot;];</span>
<a href="#l18.8"></a><span id="l18.8"> </span>
<a href="#l18.9"></a><span id="l18.9"> Cu.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l18.10"></a><span id="l18.10"> Cu.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l18.11"></a><span id="l18.11"> </span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+const kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l18.13"></a><span id="l18.13"> var draftsFolder;</span>
<a href="#l18.14"></a><span id="l18.14"> </span>
<a href="#l18.15"></a><span id="l18.15"> function setupModule(module) {</span>
<a href="#l18.16"></a><span id="l18.16">   collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l18.17"></a><span id="l18.17">   collector.getModule(&quot;compose-helpers&quot;).installInto(module);</span>
<a href="#l18.18"></a><span id="l18.18">   collector.getModule(&quot;window-helpers&quot;).installInto(module);</span>
<a href="#l18.19"></a><span id="l18.19"> </span>
<a href="#l18.20"></a><span id="l18.20">   if (!MailServices.accounts</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineat">@@ -40,27 +41,28 @@ function setupModule(module) {</span>
<a href="#l18.22"></a><span id="l18.22">  * Tests that we only open one compose window for one instance of a draft.</span>
<a href="#l18.23"></a><span id="l18.23">  */</span>
<a href="#l18.24"></a><span id="l18.24"> function test_open_draft_again() {</span>
<a href="#l18.25"></a><span id="l18.25">   make_new_sets_in_folder(draftsFolder, [{count: 1}]);</span>
<a href="#l18.26"></a><span id="l18.26">   be_in_folder(draftsFolder);</span>
<a href="#l18.27"></a><span id="l18.27">   let draftMsg = select_click_row(0);</span>
<a href="#l18.28"></a><span id="l18.28"> </span>
<a href="#l18.29"></a><span id="l18.29">   plan_for_new_window(&quot;msgcompose&quot;);</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-  mc.click(mc.eid(&quot;editMessageButton&quot;));</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  mc.click(mc.eid(kBoxId, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l18.32"></a><span id="l18.32">   let cwc = wait_for_compose_window();</span>
<a href="#l18.33"></a><span id="l18.33"> </span>
<a href="#l18.34"></a><span id="l18.34">   let cwins = 0;</span>
<a href="#l18.35"></a><span id="l18.35">   let e = Services.wm.getEnumerator(&quot;msgcompose&quot;);</span>
<a href="#l18.36"></a><span id="l18.36">   while (e.hasMoreElements()) {</span>
<a href="#l18.37"></a><span id="l18.37">     e.getNext();</span>
<a href="#l18.38"></a><span id="l18.38">     cwins++;</span>
<a href="#l18.39"></a><span id="l18.39">   }</span>
<a href="#l18.40"></a><span id="l18.40"> </span>
<a href="#l18.41"></a><span id="l18.41" class="difflineminus">-  mc.click(mc.eid(&quot;editMessageButton&quot;)); // click edit in main win again</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+  // click edit in main win again</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineplus">+  mc.click(mc.eid(kBoxId, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l18.44"></a><span id="l18.44"> </span>
<a href="#l18.45"></a><span id="l18.45">   mc.sleep(1000); // wait a sec to see if it caused a new window</span>
<a href="#l18.46"></a><span id="l18.46"> </span>
<a href="#l18.47"></a><span id="l18.47">   assert_true(Services.ww.activeWindow == cwc.window,</span>
<a href="#l18.48"></a><span id="l18.48">     &quot;the original draft composition window should have got focus (again)&quot;);</span>
<a href="#l18.49"></a><span id="l18.49"> </span>
<a href="#l18.50"></a><span id="l18.50">   let cwins2 = 0;</span>
<a href="#l18.51"></a><span id="l18.51">   let e2 = Services.wm.getEnumerator(&quot;msgcompose&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-general-content-policy.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-general-content-policy.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1,39 +1,40 @@</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+</span>
<a href="#l19.8"></a><span id="l19.8"> /**</span>
<a href="#l19.9"></a><span id="l19.9">  * Checks various remote content policy workings, including:</span>
<a href="#l19.10"></a><span id="l19.10">  *</span>
<a href="#l19.11"></a><span id="l19.11">  * - Images</span>
<a href="#l19.12"></a><span id="l19.12">  * - Video</span>
<a href="#l19.13"></a><span id="l19.13">  *</span>
<a href="#l19.14"></a><span id="l19.14">  * In:</span>
<a href="#l19.15"></a><span id="l19.15">  *</span>
<a href="#l19.16"></a><span id="l19.16">  * - Messages</span>
<a href="#l19.17"></a><span id="l19.17">  * - Reply email compose window</span>
<a href="#l19.18"></a><span id="l19.18">  * - Forward email compose window</span>
<a href="#l19.19"></a><span id="l19.19">  * - Content tab</span>
<a href="#l19.20"></a><span id="l19.20">  */</span>
<a href="#l19.21"></a><span id="l19.21"> </span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-//</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineplus">+// make SOLO_TEST=content-policy/test-general-content-policy.js mozmill-one</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineplus">+</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineplus">+const MODULE_NAME = 'test-general-content-policy';</span>
<a href="#l19.29"></a><span id="l19.29"> </span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-var MODULE_NAME = 'test-general-content-policy';</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-var RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineminus">-var MODULE_REQUIRES = ['folder-display-helpers', 'window-helpers',</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-                       'compose-helpers', 'content-tab-helpers'];</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineplus">+const RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+const MODULE_REQUIRES = ['folder-display-helpers', 'window-helpers',</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineplus">+                         'compose-helpers', 'content-tab-helpers',</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineplus">+                         'notificationbox-helpers'];</span>
<a href="#l19.39"></a><span id="l19.39"> var jumlib = {};</span>
<a href="#l19.40"></a><span id="l19.40"> Components.utils.import(&quot;resource://mozmill/modules/jum.js&quot;, jumlib);</span>
<a href="#l19.41"></a><span id="l19.41"> var elib = {};</span>
<a href="#l19.42"></a><span id="l19.42"> Components.utils.import('resource://mozmill/modules/elementslib.js', elib);</span>
<a href="#l19.43"></a><span id="l19.43"> </span>
<a href="#l19.44"></a><span id="l19.44"> var folder = null;</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineminus">-var composeHelper = null;</span>
<a href="#l19.46"></a><span id="l19.46"> var gMsgNo = 0;</span>
<a href="#l19.47"></a><span id="l19.47"> </span>
<a href="#l19.48"></a><span id="l19.48"> // RELATIVE_ROOT messes with the collector, so we have to bring the path back</span>
<a href="#l19.49"></a><span id="l19.49"> // so we get the right path for the resources.</span>
<a href="#l19.50"></a><span id="l19.50"> var url = collector.addHttpResource('../content-policy/html', 'content');</span>
<a href="#l19.51"></a><span id="l19.51"> </span>
<a href="#l19.52"></a><span id="l19.52"> /**</span>
<a href="#l19.53"></a><span id="l19.53">  * The TESTS array is constructed from objects containing the following:</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineat">@@ -88,24 +89,19 @@ const msgBodyStart = '&lt;!DOCTYPE HTML PUB</span>
<a href="#l19.55"></a><span id="l19.55"> '\n' +</span>
<a href="#l19.56"></a><span id="l19.56"> '&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;\n' +</span>
<a href="#l19.57"></a><span id="l19.57"> '&lt;/head&gt;\n' +</span>
<a href="#l19.58"></a><span id="l19.58"> '&lt;body bgcolor=&quot;#ffffff&quot; text=&quot;#000000&quot;&gt;\n';</span>
<a href="#l19.59"></a><span id="l19.59"> </span>
<a href="#l19.60"></a><span id="l19.60"> const msgBodyEnd = '&lt;/body&gt;\n&lt;/html&gt;\n';</span>
<a href="#l19.61"></a><span id="l19.61"> </span>
<a href="#l19.62"></a><span id="l19.62"> var setupModule = function (module) {</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineminus">-  let fdh = collector.getModule('folder-display-helpers');</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l19.65"></a><span id="l19.65" class="difflineminus">-  let wh = collector.getModule('window-helpers');</span>
<a href="#l19.66"></a><span id="l19.66" class="difflineminus">-  wh.installInto(module);</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineminus">-  composeHelper = collector.getModule('compose-helpers');</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineminus">-  composeHelper.installInto(module);</span>
<a href="#l19.69"></a><span id="l19.69" class="difflineminus">-  let cth = collector.getModule('content-tab-helpers');</span>
<a href="#l19.70"></a><span id="l19.70" class="difflineminus">-  cth.installInto(module);</span>
<a href="#l19.71"></a><span id="l19.71" class="difflineplus">+  for (let dep of MODULE_REQUIRES) {</span>
<a href="#l19.72"></a><span id="l19.72" class="difflineplus">+    collector.getModule(dep).installInto(module);</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineplus">+  }</span>
<a href="#l19.74"></a><span id="l19.74"> </span>
<a href="#l19.75"></a><span id="l19.75">   folder = create_folder(&quot;generalContentPolicy&quot;);</span>
<a href="#l19.76"></a><span id="l19.76"> };</span>
<a href="#l19.77"></a><span id="l19.77"> </span>
<a href="#l19.78"></a><span id="l19.78"> function addToFolder(aSubject, aBody, aFolder) {</span>
<a href="#l19.79"></a><span id="l19.79"> </span>
<a href="#l19.80"></a><span id="l19.80">   let msgId = Components.classes[&quot;@mozilla.org/uuid-generator;1&quot;]</span>
<a href="#l19.81"></a><span id="l19.81">                           .getService(Components.interfaces.nsIUUIDGenerator)</span>
<a href="#l19.82"></a><span id="l19.82" class="difflineat">@@ -165,27 +161,27 @@ function addMsgToFolderAndCheckContent(f</span>
<a href="#l19.83"></a><span id="l19.83">  * Check remote content in a compose window.</span>
<a href="#l19.84"></a><span id="l19.84">  *</span>
<a href="#l19.85"></a><span id="l19.85">  * @param test        The test from TESTS that is being performed.</span>
<a href="#l19.86"></a><span id="l19.86">  * @param replyType   The type of the compose window, set to true for &quot;reply&quot;,</span>
<a href="#l19.87"></a><span id="l19.87">  *                    false for &quot;forward&quot;.</span>
<a href="#l19.88"></a><span id="l19.88">  * @param loadAllowed Whether or not the load is expected to be allowed.</span>
<a href="#l19.89"></a><span id="l19.89">  */</span>
<a href="#l19.90"></a><span id="l19.90"> function checkComposeWindow(test, replyType, loadAllowed) {</span>
<a href="#l19.91"></a><span id="l19.91" class="difflineminus">-  let replyWindow = replyType ? composeHelper.open_compose_with_reply() :</span>
<a href="#l19.92"></a><span id="l19.92" class="difflineminus">-                                composeHelper.open_compose_with_forward();</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineplus">+  let replyWindow = replyType ? open_compose_with_reply() :</span>
<a href="#l19.94"></a><span id="l19.94" class="difflineplus">+                                open_compose_with_forward();</span>
<a href="#l19.95"></a><span id="l19.95"> </span>
<a href="#l19.96"></a><span id="l19.96">   if (test.checkForAllowed(</span>
<a href="#l19.97"></a><span id="l19.97">         replyWindow.window.document.getElementById(&quot;content-frame&quot;)</span>
<a href="#l19.98"></a><span id="l19.98">           .contentDocument.getElementById(&quot;testelement&quot;)) != loadAllowed)</span>
<a href="#l19.99"></a><span id="l19.99">     throw new Error(test.type + &quot; has not been &quot; +</span>
<a href="#l19.100"></a><span id="l19.100">                     (loadAllowed ? &quot;allowed&quot; : &quot;blocked&quot;) +</span>
<a href="#l19.101"></a><span id="l19.101">                     &quot; in reply window as expected.&quot;);</span>
<a href="#l19.102"></a><span id="l19.102"> </span>
<a href="#l19.103"></a><span id="l19.103" class="difflineminus">-  composeHelper.close_compose_window(replyWindow);</span>
<a href="#l19.104"></a><span id="l19.104" class="difflineplus">+  close_compose_window(replyWindow);</span>
<a href="#l19.105"></a><span id="l19.105"> }</span>
<a href="#l19.106"></a><span id="l19.106"> </span>
<a href="#l19.107"></a><span id="l19.107"> /**</span>
<a href="#l19.108"></a><span id="l19.108">  * Check remote content in stand-alone message window, and reload</span>
<a href="#l19.109"></a><span id="l19.109">  */</span>
<a href="#l19.110"></a><span id="l19.110">  function checkStandaloneMessageWindow(test, loadAllowed) {</span>
<a href="#l19.111"></a><span id="l19.111">   plan_for_new_window(&quot;mail:messageWindow&quot;);</span>
<a href="#l19.112"></a><span id="l19.112">   // Open it</span>
<a href="#l19.113"></a><span id="l19.113" class="difflineat">@@ -196,24 +192,28 @@ function checkComposeWindow(test, replyT</span>
<a href="#l19.114"></a><span id="l19.114">   if (test.checkForAllowed(</span>
<a href="#l19.115"></a><span id="l19.115">           msgc.window.content.document.getElementById(&quot;testelement&quot;)) != loadAllowed)</span>
<a href="#l19.116"></a><span id="l19.116">     throw new Error(test.type + &quot; has not been blocked in message content as expected.&quot;);</span>
<a href="#l19.117"></a><span id="l19.117"> </span>
<a href="#l19.118"></a><span id="l19.118">   // Clean up, close the window</span>
<a href="#l19.119"></a><span id="l19.119">   close_message_window(msgc);</span>
<a href="#l19.120"></a><span id="l19.120"> }</span>
<a href="#l19.121"></a><span id="l19.121"> </span>
<a href="#l19.122"></a><span id="l19.122" class="difflineminus">-</span>
<a href="#l19.123"></a><span id="l19.123"> function allowRemoteContentAndCheck(test) {</span>
<a href="#l19.124"></a><span id="l19.124">   addMsgToFolderAndCheckContent(folder, test);</span>
<a href="#l19.125"></a><span id="l19.125"> </span>
<a href="#l19.126"></a><span id="l19.126">   plan_for_message_display(mc);</span>
<a href="#l19.127"></a><span id="l19.127"> </span>
<a href="#l19.128"></a><span id="l19.128">   // Click on the allow remote content button</span>
<a href="#l19.129"></a><span id="l19.129" class="difflineminus">-  mc.click(new elib.ID(mc.window.document, &quot;remoteContentBarButton&quot;));</span>
<a href="#l19.130"></a><span id="l19.130" class="difflineplus">+  const kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l19.131"></a><span id="l19.131" class="difflineplus">+  const kNotificationValue = &quot;remoteContent&quot;;</span>
<a href="#l19.132"></a><span id="l19.132" class="difflineplus">+  wait_for_notification_to_show(mc, kBoxId, kNotificationValue);</span>
<a href="#l19.133"></a><span id="l19.133" class="difflineplus">+  mc.click_menus_in_sequence(mc.e(&quot;remoteContentOptions&quot;),</span>
<a href="#l19.134"></a><span id="l19.134" class="difflineplus">+                             [{id: &quot;remoteContentOptionAllowForMsg&quot;}]);</span>
<a href="#l19.135"></a><span id="l19.135" class="difflineplus">+  wait_for_notification_to_stop(mc, kBoxId, kNotificationValue);</span>
<a href="#l19.136"></a><span id="l19.136"> </span>
<a href="#l19.137"></a><span id="l19.137">   wait_for_message_display_completion(mc, true);</span>
<a href="#l19.138"></a><span id="l19.138"> </span>
<a href="#l19.139"></a><span id="l19.139">   if (!test.checkForAllowed(mc.window.content.document</span>
<a href="#l19.140"></a><span id="l19.140">                               .getElementById(&quot;testelement&quot;)))</span>
<a href="#l19.141"></a><span id="l19.141">     throw new Error(test.type + &quot; has been unexpectedly blocked in message content&quot;);</span>
<a href="#l19.142"></a><span id="l19.142"> }</span>
<a href="#l19.143"></a><span id="l19.143"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-phishing-bar.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-phishing-bar.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,102 +1,105 @@</span>
<a href="#l20.4"></a><span id="l20.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.5"></a><span id="l20.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.6"></a><span id="l20.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8" class="difflineminus">-/*</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineminus">- *  Test that the phishing bar behaves properly</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+/**</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+ * Test that the phishing notification behaves properly.</span>
<a href="#l20.12"></a><span id="l20.12">  */</span>
<a href="#l20.13"></a><span id="l20.13"> </span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-var MODULE_NAME = &quot;test-phishing-bar&quot;;</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+// make SOLO_TEST=message-header/test-phishing-bar.js mozmill-one</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+const MODULE_NAME = &quot;test-phishing-bar&quot;;</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19" class="difflineminus">-var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineminus">-var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;,</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineminus">-                       &quot;window-helpers&quot;];</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+const RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+const MODULE_REQUIRES = [&quot;folder-display-helpers&quot;,</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+                         &quot;window-helpers&quot;, &quot;notificationbox-helpers&quot;];</span>
<a href="#l20.25"></a><span id="l20.25"> </span>
<a href="#l20.26"></a><span id="l20.26" class="difflineminus">-var elib = {};</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineminus">-Components.utils.import(&quot;resource://mozmill/modules/elementslib.js&quot;, elib);</span>
<a href="#l20.28"></a><span id="l20.28"> var os = {};</span>
<a href="#l20.29"></a><span id="l20.29"> Components.utils.import('resource://mozmill/stdlib/os.js', os);</span>
<a href="#l20.30"></a><span id="l20.30"> </span>
<a href="#l20.31"></a><span id="l20.31"> var folder;</span>
<a href="#l20.32"></a><span id="l20.32"> </span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+const kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+const kNotificationValue = &quot;maybeScam&quot;;</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+</span>
<a href="#l20.36"></a><span id="l20.36"> function setupModule(module) {</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l20.39"></a><span id="l20.39" class="difflineminus">-  let wh = collector.getModule(&quot;window-helpers&quot;);</span>
<a href="#l20.40"></a><span id="l20.40" class="difflineminus">-  wh.installInto(module);</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineplus">+  for (let dep of MODULE_REQUIRES) {</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineplus">+    collector.getModule(dep).installInto(module);</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineplus">+  }</span>
<a href="#l20.44"></a><span id="l20.44"> </span>
<a href="#l20.45"></a><span id="l20.45">   folder = create_folder(&quot;PhishingBarA&quot;);</span>
<a href="#l20.46"></a><span id="l20.46">   add_message_to_folder(folder, create_message({body: {</span>
<a href="#l20.47"></a><span id="l20.47">     body: '&lt;a href=&quot;http://www.evil.com/google/&quot;&gt;http://www.google.com&lt;/a&gt;',</span>
<a href="#l20.48"></a><span id="l20.48">     contentType: &quot;text/html&quot;</span>
<a href="#l20.49"></a><span id="l20.49">   }}));</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineplus">+  add_message_to_folder(folder, create_message());</span>
<a href="#l20.51"></a><span id="l20.51"> }</span>
<a href="#l20.52"></a><span id="l20.52"> </span>
<a href="#l20.53"></a><span id="l20.53"> /**</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineminus">- * Make sure that the phishing bar is currently visible.</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineminus">- *</span>
<a href="#l20.56"></a><span id="l20.56" class="difflineminus">- * @param msgc the Mozmill controller for the message window</span>
<a href="#l20.57"></a><span id="l20.57" class="difflineplus">+ * Make sure the notification shows, and goes away once the Ignore menuitem</span>
<a href="#l20.58"></a><span id="l20.58" class="difflineplus">+ * is clicked.</span>
<a href="#l20.59"></a><span id="l20.59">  */</span>
<a href="#l20.60"></a><span id="l20.60" class="difflineminus">-function assert_phishing_bar_visible(msgc) {</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineminus">-  assert_true(!msgc.e(&quot;msgNotificationBar&quot;).collapsed,</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineminus">-              &quot;Notification bar is collapsed!&quot;);</span>
<a href="#l20.63"></a><span id="l20.63" class="difflineminus">-  assert_equals(msgc.e(&quot;msgNotificationBar&quot;).selectedPanel,</span>
<a href="#l20.64"></a><span id="l20.64" class="difflineminus">-                msgc.e(&quot;phishingBar&quot;),</span>
<a href="#l20.65"></a><span id="l20.65" class="difflineminus">-                &quot;Notification bar not showing phishing bar!&quot;);</span>
<a href="#l20.66"></a><span id="l20.66" class="difflineplus">+function assert_ignore_works(aController) {</span>
<a href="#l20.67"></a><span id="l20.67" class="difflineplus">+  wait_for_notification_to_show(aController, kBoxId, kNotificationValue);</span>
<a href="#l20.68"></a><span id="l20.68" class="difflineplus">+  aController.click_menus_in_sequence(aController.e(&quot;phishingOptions&quot;),</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineplus">+                                      [{id: &quot;phishingOptionIgnore&quot;}]);</span>
<a href="#l20.70"></a><span id="l20.70" class="difflineplus">+  wait_for_notification_to_stop(aController, kBoxId, kNotificationValue);</span>
<a href="#l20.71"></a><span id="l20.71"> }</span>
<a href="#l20.72"></a><span id="l20.72"> </span>
<a href="#l20.73"></a><span id="l20.73"> /**</span>
<a href="#l20.74"></a><span id="l20.74" class="difflineminus">- * Make sure that the phishing bar gets hidden when the ignore button is</span>
<a href="#l20.75"></a><span id="l20.75" class="difflineminus">- * clicked.</span>
<a href="#l20.76"></a><span id="l20.76" class="difflineminus">- *</span>
<a href="#l20.77"></a><span id="l20.77" class="difflineminus">- * @param msgc the Mozmill controller for the message window</span>
<a href="#l20.78"></a><span id="l20.78" class="difflineplus">+ * Test that when viewing a message, choosing ignore hides the the phishing</span>
<a href="#l20.79"></a><span id="l20.79" class="difflineplus">+ * notification.</span>
<a href="#l20.80"></a><span id="l20.80">  */</span>
<a href="#l20.81"></a><span id="l20.81" class="difflineminus">-function help_test_hide_phishing_bar(msgc) {</span>
<a href="#l20.82"></a><span id="l20.82" class="difflineminus">-  let phishingButton = msgc.e(&quot;phishingBar&quot;).querySelector(&quot;button&quot;);</span>
<a href="#l20.83"></a><span id="l20.83" class="difflineminus">-  assert_phishing_bar_visible(msgc);</span>
<a href="#l20.84"></a><span id="l20.84" class="difflineplus">+function test_ignore_phishing_warning_from_message() {</span>
<a href="#l20.85"></a><span id="l20.85" class="difflineplus">+  be_in_folder(folder);</span>
<a href="#l20.86"></a><span id="l20.86" class="difflineplus">+  select_click_row(0);</span>
<a href="#l20.87"></a><span id="l20.87" class="difflineplus">+  assert_ignore_works(mc);</span>
<a href="#l20.88"></a><span id="l20.88"> </span>
<a href="#l20.89"></a><span id="l20.89" class="difflineminus">-  msgc.click(new elib.Elem(phishingButton));</span>
<a href="#l20.90"></a><span id="l20.90" class="difflineminus">-  wait_for_message_display_completion(msgc, true);</span>
<a href="#l20.91"></a><span id="l20.91" class="difflineminus">-  assert_true(msgc.e(&quot;msgNotificationBar&quot;).collapsed);</span>
<a href="#l20.92"></a><span id="l20.92" class="difflineplus">+  select_click_row(1);</span>
<a href="#l20.93"></a><span id="l20.93" class="difflineplus">+  // msg 1 is normal -&gt; no phishing warning</span>
<a href="#l20.94"></a><span id="l20.94" class="difflineplus">+  assert_notification_displayed(mc, kBoxId, kNotificationValue, false);</span>
<a href="#l20.95"></a><span id="l20.95" class="difflineplus">+  select_click_row(0);</span>
<a href="#l20.96"></a><span id="l20.96" class="difflineplus">+  // msg 0 is a potential phishing attempt, but we ignored it so that should</span>
<a href="#l20.97"></a><span id="l20.97" class="difflineplus">+  // be remembered</span>
<a href="#l20.98"></a><span id="l20.98" class="difflineplus">+  assert_notification_displayed(mc, kBoxId, kNotificationValue, false);</span>
<a href="#l20.99"></a><span id="l20.99"> }</span>
<a href="#l20.100"></a><span id="l20.100"> </span>
<a href="#l20.101"></a><span id="l20.101" class="difflineminus">-function test_hide_phishing_bar_from_message() {</span>
<a href="#l20.102"></a><span id="l20.102" class="difflineminus">-  be_in_folder(folder);</span>
<a href="#l20.103"></a><span id="l20.103" class="difflineminus">-  select_click_row(0);</span>
<a href="#l20.104"></a><span id="l20.104" class="difflineminus">-</span>
<a href="#l20.105"></a><span id="l20.105" class="difflineminus">-  // XXX Disabled due very frequent random failures.</span>
<a href="#l20.106"></a><span id="l20.106" class="difflineminus">-  // help_test_hide_phishing_bar(mc);</span>
<a href="#l20.107"></a><span id="l20.107" class="difflineminus">-}</span>
<a href="#l20.108"></a><span id="l20.108" class="difflineminus">-</span>
<a href="#l20.109"></a><span id="l20.109" class="difflineminus">-function test_hide_phishing_bar_from_eml() {</span>
<a href="#l20.110"></a><span id="l20.110" class="difflineminus">-  // XXX Disabled due very frequent random failures.</span>
<a href="#l20.111"></a><span id="l20.111" class="difflineminus">-  /*</span>
<a href="#l20.112"></a><span id="l20.112" class="difflineplus">+/**</span>
<a href="#l20.113"></a><span id="l20.113" class="difflineplus">+ * Test that when viewing en eml file, choosing ignore hides the phishing</span>
<a href="#l20.114"></a><span id="l20.114" class="difflineplus">+ * notification.</span>
<a href="#l20.115"></a><span id="l20.115" class="difflineplus">+ */</span>
<a href="#l20.116"></a><span id="l20.116" class="difflineplus">+function test_ignore_phishing_warning_from_eml() {</span>
<a href="#l20.117"></a><span id="l20.117">   let thisFilePath = os.getFileForPath(__file__);</span>
<a href="#l20.118"></a><span id="l20.118">   let file = os.getFileForPath(os.abspath(&quot;./evil.eml&quot;, thisFilePath));</span>
<a href="#l20.119"></a><span id="l20.119"> </span>
<a href="#l20.120"></a><span id="l20.120">   let msgc = open_message_from_file(file);</span>
<a href="#l20.121"></a><span id="l20.121" class="difflineminus">-  help_test_hide_phishing_bar(msgc);</span>
<a href="#l20.122"></a><span id="l20.122" class="difflineminus">-  */</span>
<a href="#l20.123"></a><span id="l20.123" class="difflineplus">+  assert_ignore_works(msgc);</span>
<a href="#l20.124"></a><span id="l20.124" class="difflineplus">+  close_window(msgc);</span>
<a href="#l20.125"></a><span id="l20.125"> }</span>
<a href="#l20.126"></a><span id="l20.126"> </span>
<a href="#l20.127"></a><span id="l20.127" class="difflineminus">-function test_phishing_bar_for_eml_attachment() {</span>
<a href="#l20.128"></a><span id="l20.128" class="difflineplus">+/**</span>
<a href="#l20.129"></a><span id="l20.129" class="difflineplus">+ * Test that when viewing an attached eml file, the phishing notification works.</span>
<a href="#l20.130"></a><span id="l20.130" class="difflineplus">+ */</span>
<a href="#l20.131"></a><span id="l20.131" class="difflineplus">+function test_ignore_phishing_warning_from_eml_attachment() {</span>
<a href="#l20.132"></a><span id="l20.132">   let thisFilePath = os.getFileForPath(__file__);</span>
<a href="#l20.133"></a><span id="l20.133">   let file = os.getFileForPath(os.abspath(&quot;./evil-attached.eml&quot;, thisFilePath));</span>
<a href="#l20.134"></a><span id="l20.134"> </span>
<a href="#l20.135"></a><span id="l20.135">   let msgc = open_message_from_file(file);</span>
<a href="#l20.136"></a><span id="l20.136"> </span>
<a href="#l20.137"></a><span id="l20.137">   // Make sure the root message shows the phishing bar.</span>
<a href="#l20.138"></a><span id="l20.138" class="difflineminus">-  assert_phishing_bar_visible(msgc);</span>
<a href="#l20.139"></a><span id="l20.139" class="difflineplus">+  wait_for_notification_to_show(msgc, kBoxId, kNotificationValue);</span>
<a href="#l20.140"></a><span id="l20.140" class="difflineplus">+  //function assert_notification_displayed(aController, aValue, aDisplayed) </span>
<a href="#l20.141"></a><span id="l20.141"> </span>
<a href="#l20.142"></a><span id="l20.142">   // Open the attached message.</span>
<a href="#l20.143"></a><span id="l20.143">   plan_for_new_window(&quot;mail:messageWindow&quot;);</span>
<a href="#l20.144"></a><span id="l20.144">   msgc.e(&quot;attachmentList&quot;).getItemAtIndex(0).attachment.open();</span>
<a href="#l20.145"></a><span id="l20.145" class="difflineminus">-  let msg2c = wait_for_new_window(&quot;mail:messageWindow&quot;);</span>
<a href="#l20.146"></a><span id="l20.146" class="difflineminus">-  wait_for_message_display_completion(msg2c, true);</span>
<a href="#l20.147"></a><span id="l20.147" class="difflineplus">+  let msgc2 = wait_for_new_window(&quot;mail:messageWindow&quot;);</span>
<a href="#l20.148"></a><span id="l20.148" class="difflineplus">+  wait_for_message_display_completion(msgc2, true);</span>
<a href="#l20.149"></a><span id="l20.149"> </span>
<a href="#l20.150"></a><span id="l20.150">   // Now make sure the attached message shows the phishing bar.</span>
<a href="#l20.151"></a><span id="l20.151" class="difflineminus">-  assert_phishing_bar_visible(msg2c);</span>
<a href="#l20.152"></a><span id="l20.152" class="difflineplus">+  wait_for_notification_to_show(msgc2, kBoxId, kNotificationValue);</span>
<a href="#l20.153"></a><span id="l20.153"> </span>
<a href="#l20.154"></a><span id="l20.154" class="difflineminus">-  close_window(msg2c);</span>
<a href="#l20.155"></a><span id="l20.155" class="difflineplus">+  close_window(msgc2);</span>
<a href="#l20.156"></a><span id="l20.156">   close_window(msgc);</span>
<a href="#l20.157"></a><span id="l20.157"> }</span>
<a href="#l20.158"></a><span id="l20.158" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-return-receipt.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-return-receipt.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -6,25 +6,28 @@</span>
<a href="#l21.4"></a><span id="l21.4">  * Test return receipt (MDN) stuff.</span>
<a href="#l21.5"></a><span id="l21.5">  */</span>
<a href="#l21.6"></a><span id="l21.6"> </span>
<a href="#l21.7"></a><span id="l21.7"> // make SOLO_TEST=message-header/test-return-receipt.js mozmill-one</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9"> const MODULE_NAME = &quot;test-return-receipt&quot;;</span>
<a href="#l21.10"></a><span id="l21.10"> </span>
<a href="#l21.11"></a><span id="l21.11"> const RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-const MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;window-helpers&quot;];</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+const MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;window-helpers&quot;,</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+                        &quot;notificationbox-helpers&quot;];</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16"> var folder;</span>
<a href="#l21.17"></a><span id="l21.17"> </span>
<a href="#l21.18"></a><span id="l21.18" class="difflineplus">+const kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+const kNotificationValue = &quot;mdnRequested&quot;;</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineplus">+</span>
<a href="#l21.21"></a><span id="l21.21"> function setupModule(module) {</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineminus">-  let fdh = collector.getModule(&quot;folder-display-helpers&quot;);</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineminus">-  fdh.installInto(module);</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineminus">-  let wh = collector.getModule(&quot;window-helpers&quot;);</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineminus">-  wh.installInto(module);</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineplus">+  collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineplus">+  collector.getModule(&quot;window-helpers&quot;).installInto(module);</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineplus">+  collector.getModule(&quot;notificationbox-helpers&quot;).installInto(module);</span>
<a href="#l21.29"></a><span id="l21.29"> </span>
<a href="#l21.30"></a><span id="l21.30">   folder = create_folder(&quot;ReturnReceiptTest&quot;);</span>
<a href="#l21.31"></a><span id="l21.31"> </span>
<a href="#l21.32"></a><span id="l21.32">   // Create a message that requests a return receipt.</span>
<a href="#l21.33"></a><span id="l21.33">   let msg0 = create_message(</span>
<a href="#l21.34"></a><span id="l21.34">     {from: [&quot;Ake&quot;, &quot;ake@example.com&quot;],</span>
<a href="#l21.35"></a><span id="l21.35">       clobberHeaders: { &quot;Disposition-Notification-To&quot;: &quot;ake@example.com&quot; }</span>
<a href="#l21.36"></a><span id="l21.36">     });</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineat">@@ -79,35 +82,25 @@ function gotoMsg(row) {</span>
<a href="#l21.38"></a><span id="l21.38">   assert_selected_and_displayed(mc, curMessage);</span>
<a href="#l21.39"></a><span id="l21.39"> }</span>
<a href="#l21.40"></a><span id="l21.40"> </span>
<a href="#l21.41"></a><span id="l21.41"> /**</span>
<a href="#l21.42"></a><span id="l21.42">  * Utility to make sure the MDN bar is shown / not shown.</span>
<a href="#l21.43"></a><span id="l21.43">  */</span>
<a href="#l21.44"></a><span id="l21.44"> function assert_mdn_shown(shouldShow) {</span>
<a href="#l21.45"></a><span id="l21.45">   let msgNotBar = mc.e(&quot;msgNotificationBar&quot;);</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineminus">-  if (shouldShow) {</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineminus">-    if (msgNotBar.collapsed)</span>
<a href="#l21.48"></a><span id="l21.48" class="difflineminus">-      throw new Error(&quot;msgNotificationBar should show&quot;);</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineminus">-    if (msgNotBar.selectedIndex != 4) // it's not the mdnBar showing</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineminus">-      throw new Error(&quot;msgNotificationBar should show the mdnBar; &quot; +</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineminus">-                      &quot;msgNotBar.selectedIndex=&quot; + msgNotBar.selectedIndex);</span>
<a href="#l21.52"></a><span id="l21.52" class="difflineminus">-  }</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineminus">-  else {</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineminus">-    if (!msgNotBar.collapsed)</span>
<a href="#l21.55"></a><span id="l21.55" class="difflineminus">-      throw new Error(&quot;mdnBar shouldn't show&quot;);</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineminus">-  }</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineplus">+  assert_notification_displayed(mc, kBoxId, kNotificationValue, shouldShow);</span>
<a href="#l21.58"></a><span id="l21.58"> }</span>
<a href="#l21.59"></a><span id="l21.59"> </span>
<a href="#l21.60"></a><span id="l21.60"> /**</span>
<a href="#l21.61"></a><span id="l21.61">  * Utility function to make sure the notification contains a certain text.</span>
<a href="#l21.62"></a><span id="l21.62">  */</span>
<a href="#l21.63"></a><span id="l21.63"> function assert_mdn_text_contains(text, shouldContain) {</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineminus">-  let mdnBar = mc.e(&quot;mdnBar&quot;);</span>
<a href="#l21.65"></a><span id="l21.65" class="difflineminus">-  let notificationText = mdnBar.textContent;</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineplus">+  let nb = mc.window.document.getElementById(kBoxId);</span>
<a href="#l21.67"></a><span id="l21.67" class="difflineplus">+  let notificationText = nb.currentNotification.label;</span>
<a href="#l21.68"></a><span id="l21.68">   if (shouldContain &amp;&amp; !notificationText.contains(text))</span>
<a href="#l21.69"></a><span id="l21.69">     throw new Error(&quot;mdnBar should contain text=&quot; + text +</span>
<a href="#l21.70"></a><span id="l21.70">                     &quot;; notificationText=&quot; + notificationText);</span>
<a href="#l21.71"></a><span id="l21.71">   if (!shouldContain &amp;&amp; notificationText.contains(text))</span>
<a href="#l21.72"></a><span id="l21.72">     throw new Error(&quot;mdnBar shouldn't contain text=&quot; + text +</span>
<a href="#l21.73"></a><span id="l21.73">                     &quot;; notificationText=&quot; + notificationText);</span>
<a href="#l21.74"></a><span id="l21.74"> }</span>
<a href="#l21.75"></a><span id="l21.75"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-compose-helpers.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-compose-helpers.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -45,20 +45,16 @@ function installInto(module) {</span>
<a href="#l22.4"></a><span id="l22.4">   module.wait_for_compose_window = wait_for_compose_window;</span>
<a href="#l22.5"></a><span id="l22.5">   module.create_msg_attachment = create_msg_attachment;</span>
<a href="#l22.6"></a><span id="l22.6">   module.add_attachments = add_attachments;</span>
<a href="#l22.7"></a><span id="l22.7">   module.add_attachment = add_attachments;</span>
<a href="#l22.8"></a><span id="l22.8">   module.delete_attachment = delete_attachment;</span>
<a href="#l22.9"></a><span id="l22.9">   module.get_compose_body = get_compose_body;</span>
<a href="#l22.10"></a><span id="l22.10">   module.type_in_composer = type_in_composer;</span>
<a href="#l22.11"></a><span id="l22.11">   module.assert_previous_text = assert_previous_text;</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-  module.assert_notification_displayed = assert_notification_displayed;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-  module.close_notification = close_notification;</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-  module.wait_for_notification_to_stop = wait_for_notification_to_stop;</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-  module.wait_for_notification_to_show = wait_for_notification_to_show;</span>
<a href="#l22.16"></a><span id="l22.16"> }</span>
<a href="#l22.17"></a><span id="l22.17"> </span>
<a href="#l22.18"></a><span id="l22.18"> /**</span>
<a href="#l22.19"></a><span id="l22.19">  * Opens the compose window by starting a new message</span>
<a href="#l22.20"></a><span id="l22.20">  *</span>
<a href="#l22.21"></a><span id="l22.21">  * @param aController the controller for the mail:3pane from which to spawn</span>
<a href="#l22.22"></a><span id="l22.22">  *                    the compose window.  If left blank, defaults to mc.</span>
<a href="#l22.23"></a><span id="l22.23">  *</span>
<a href="#l22.24"></a><span id="l22.24" class="difflineat">@@ -307,96 +303,16 @@ function delete_attachment(aComposeWindo</span>
<a href="#l22.25"></a><span id="l22.25">   let bucket = aComposeWindow.e('attachmentBucket');</span>
<a href="#l22.26"></a><span id="l22.26">   let node = bucket.getElementsByTagName('attachmentitem')[aIndex];</span>
<a href="#l22.27"></a><span id="l22.27"> </span>
<a href="#l22.28"></a><span id="l22.28">   aComposeWindow.click(new elib.Elem(node));</span>
<a href="#l22.29"></a><span id="l22.29">   aComposeWindow.window.RemoveSelectedAttachment();</span>
<a href="#l22.30"></a><span id="l22.30"> }</span>
<a href="#l22.31"></a><span id="l22.31"> </span>
<a href="#l22.32"></a><span id="l22.32"> /**</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">- * A helper function for determining whether or not a notification with</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">- * a particular value is being displayed in the composer window.</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">- *</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineminus">- * @param aController the controller of the compose window to check</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineminus">- * @param aValue the value of the notification to look for.</span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">- * @param aDisplayed true if the notification should be displayed, false</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">- *                   otherwise.</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineminus">- * @returns the notification if we're asserting that the notification is</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineminus">- *          displayed, and it actually shows up. Returns null otherwise.</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineminus">- */</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineminus">-function assert_notification_displayed(aController, aValue, aDisplayed) {</span>
<a href="#l22.44"></a><span id="l22.44" class="difflineminus">-  let nb = aController.window</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineminus">-                      .document</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineminus">-                      .getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l22.47"></a><span id="l22.47" class="difflineminus">-  let hasNotification = false;</span>
<a href="#l22.48"></a><span id="l22.48" class="difflineminus">-  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l22.49"></a><span id="l22.49" class="difflineminus">-  let hasNotification = (notification != null)</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-  if (hasNotification != aDisplayed)</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineminus">-    throw new Error(&quot;Expected the notification with value &quot; + aValue +</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineminus">-                    &quot; to be &quot; + (aDisplayed ? &quot;shown&quot; : &quot;not shown&quot;));</span>
<a href="#l22.54"></a><span id="l22.54" class="difflineminus">-</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineminus">-  return notification;</span>
<a href="#l22.56"></a><span id="l22.56" class="difflineminus">-}</span>
<a href="#l22.57"></a><span id="l22.57" class="difflineminus">-</span>
<a href="#l22.58"></a><span id="l22.58" class="difflineminus">-/**</span>
<a href="#l22.59"></a><span id="l22.59" class="difflineminus">- * A helper function for closing a notification in the compose window if</span>
<a href="#l22.60"></a><span id="l22.60" class="difflineminus">- * one is currently displayed.</span>
<a href="#l22.61"></a><span id="l22.61" class="difflineminus">- *</span>
<a href="#l22.62"></a><span id="l22.62" class="difflineminus">- * @param aController the controller for the compose window with</span>
<a href="#l22.63"></a><span id="l22.63" class="difflineminus">- *                    the notification.</span>
<a href="#l22.64"></a><span id="l22.64" class="difflineminus">- * @param aValue the value of the notification to close.</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineminus">- */</span>
<a href="#l22.66"></a><span id="l22.66" class="difflineminus">-function close_notification(aController, aValue) {</span>
<a href="#l22.67"></a><span id="l22.67" class="difflineminus">-  let nb = aController.window</span>
<a href="#l22.68"></a><span id="l22.68" class="difflineminus">-                      .document</span>
<a href="#l22.69"></a><span id="l22.69" class="difflineminus">-                      .getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l22.70"></a><span id="l22.70" class="difflineminus">-  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l22.71"></a><span id="l22.71" class="difflineminus">-</span>
<a href="#l22.72"></a><span id="l22.72" class="difflineminus">-  if (notification)</span>
<a href="#l22.73"></a><span id="l22.73" class="difflineminus">-    notification.close();</span>
<a href="#l22.74"></a><span id="l22.74" class="difflineminus">-}</span>
<a href="#l22.75"></a><span id="l22.75" class="difflineminus">-</span>
<a href="#l22.76"></a><span id="l22.76" class="difflineminus">-/**</span>
<a href="#l22.77"></a><span id="l22.77" class="difflineminus">- * A helper function that waits for a notification with value aValue</span>
<a href="#l22.78"></a><span id="l22.78" class="difflineminus">- * to stop displaying in the compose window.</span>
<a href="#l22.79"></a><span id="l22.79" class="difflineminus">- *</span>
<a href="#l22.80"></a><span id="l22.80" class="difflineminus">- * @param aController the controller for the compose window with the</span>
<a href="#l22.81"></a><span id="l22.81" class="difflineminus">- *                    notification.</span>
<a href="#l22.82"></a><span id="l22.82" class="difflineminus">- * @param aValue the value of the notification to wait to stop.</span>
<a href="#l22.83"></a><span id="l22.83" class="difflineminus">- */</span>
<a href="#l22.84"></a><span id="l22.84" class="difflineminus">-function wait_for_notification_to_stop(aController, aValue) {</span>
<a href="#l22.85"></a><span id="l22.85" class="difflineminus">-  let nb = aController.window</span>
<a href="#l22.86"></a><span id="l22.86" class="difflineminus">-                      .document</span>
<a href="#l22.87"></a><span id="l22.87" class="difflineminus">-                      .getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l22.88"></a><span id="l22.88" class="difflineminus">-</span>
<a href="#l22.89"></a><span id="l22.89" class="difflineminus">-  aController.waitFor(function() !nb.getNotificationWithValue(aValue),</span>
<a href="#l22.90"></a><span id="l22.90" class="difflineminus">-                      &quot;Timed out waiting for notification with value &quot; +</span>
<a href="#l22.91"></a><span id="l22.91" class="difflineminus">-                      aValue + &quot; to stop.&quot;);</span>
<a href="#l22.92"></a><span id="l22.92" class="difflineminus">-}</span>
<a href="#l22.93"></a><span id="l22.93" class="difflineminus">-</span>
<a href="#l22.94"></a><span id="l22.94" class="difflineminus">-/**</span>
<a href="#l22.95"></a><span id="l22.95" class="difflineminus">- * A helper function that waits for a notification with value aValue</span>
<a href="#l22.96"></a><span id="l22.96" class="difflineminus">- * to show in the compose window.</span>
<a href="#l22.97"></a><span id="l22.97" class="difflineminus">- *</span>
<a href="#l22.98"></a><span id="l22.98" class="difflineminus">- * @param aController the controller for the compose window that we want</span>
<a href="#l22.99"></a><span id="l22.99" class="difflineminus">- *                    the notification to appear in.</span>
<a href="#l22.100"></a><span id="l22.100" class="difflineminus">- * @param aValue the value of the notification to wait for.</span>
<a href="#l22.101"></a><span id="l22.101" class="difflineminus">- */</span>
<a href="#l22.102"></a><span id="l22.102" class="difflineminus">-function wait_for_notification_to_show(aController, aValue) {</span>
<a href="#l22.103"></a><span id="l22.103" class="difflineminus">-  let nb = aController.window</span>
<a href="#l22.104"></a><span id="l22.104" class="difflineminus">-                      .document</span>
<a href="#l22.105"></a><span id="l22.105" class="difflineminus">-                      .getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l22.106"></a><span id="l22.106" class="difflineminus">-</span>
<a href="#l22.107"></a><span id="l22.107" class="difflineminus">-  aController.waitFor(function() nb.getNotificationWithValue(aValue) != null,</span>
<a href="#l22.108"></a><span id="l22.108" class="difflineminus">-                      &quot;Timed out waiting for notification with value &quot; +</span>
<a href="#l22.109"></a><span id="l22.109" class="difflineminus">-                      aValue + &quot; to show.&quot;);</span>
<a href="#l22.110"></a><span id="l22.110" class="difflineminus">-}</span>
<a href="#l22.111"></a><span id="l22.111" class="difflineminus">-</span>
<a href="#l22.112"></a><span id="l22.112" class="difflineminus">-/**</span>
<a href="#l22.113"></a><span id="l22.113">  * Helper function returns the message body element of a composer window.</span>
<a href="#l22.114"></a><span id="l22.114">  *</span>
<a href="#l22.115"></a><span id="l22.115">  * @param aController the controller for a compose window.</span>
<a href="#l22.116"></a><span id="l22.116">  */</span>
<a href="#l22.117"></a><span id="l22.117"> function get_compose_body(aController) {</span>
<a href="#l22.118"></a><span id="l22.118">   let mailDoc = aController.e(&quot;content-frame&quot;).contentDocument;</span>
<a href="#l22.119"></a><span id="l22.119">   return mailDoc.querySelector(&quot;body&quot;);</span>
<a href="#l22.120"></a><span id="l22.120"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1">new file mode 100644</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineminus">--- /dev/null</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js</span>
<a href="#l23.4"></a><span id="l23.4" class="difflineat">@@ -0,0 +1,114 @@</span>
<a href="#l23.5"></a><span id="l23.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.6"></a><span id="l23.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.7"></a><span id="l23.7" class="difflineplus">+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.8"></a><span id="l23.8" class="difflineplus">+</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineplus">+var Ci = Components.interfaces;</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineplus">+var Cc = Components.classes;</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineplus">+var Cu = Components.utils;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineplus">+</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+var elib = {};</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+Cu.import(&quot;resource://mozmill/modules/elementslib.js&quot;, elib);</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+var mozmill = {};</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineplus">+Cu.import(&quot;resource://mozmill/modules/mozmill.js&quot;, mozmill);</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+var utils = {};</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineplus">+Cu.import(&quot;resource://mozmill/modules/utils.js&quot;, utils);</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineplus">+Cu.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineplus">+Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineplus">+</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineplus">+const MODULE_NAME = &quot;notificationbox-helpers&quot;;</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineplus">+const RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineplus">+</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineplus">+// we need this for the main controller</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineplus">+const MODULE_REQUIRES = [&quot;folder-display-helpers&quot;,</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineplus">+                         &quot;window-helpers&quot;,</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineplus">+                         &quot;mock-object-helpers&quot;];</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineplus">+</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineplus">+function installInto(module) {</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+  module.assert_notification_displayed = assert_notification_displayed;</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineplus">+  module.close_notification = close_notification;</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineplus">+  module.wait_for_notification_to_stop = wait_for_notification_to_stop;</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineplus">+  module.wait_for_notification_to_show = wait_for_notification_to_show;</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineplus">+}</span>
<a href="#l23.37"></a><span id="l23.37" class="difflineplus">+</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineplus">+/**</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineplus">+ * A helper function for determining whether or not a notification with</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineplus">+ * a particular value is being displayed.</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineplus">+ *</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineplus">+ * @param aController the controller of the window to check</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineplus">+ * @param aBoxId the id of the notificaiton box</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineplus">+ * @param aValue the value of the notification to look for</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineplus">+ * @param aDisplayed true if the notification should be displayed, false</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineplus">+ *                   otherwise</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineplus">+ * @returns the notification if we're asserting that the notification is</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineplus">+ *          displayed, and it actually shows up. Returns null otherwise</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineplus">+ */</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineplus">+function assert_notification_displayed(aController, aBoxId, aValue, aDisplayed) {</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineplus">+  let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineplus">+  if (!nb)</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineplus">+     throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineplus">+</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineplus">+  let hasNotification = false;</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineplus">+  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineplus">+  let hasNotification = (notification != null)</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineplus">+</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineplus">+  if (hasNotification != aDisplayed)</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineplus">+    throw new Error(&quot;Expected the notification with value &quot; + aValue +</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineplus">+                    &quot; to be &quot; + (aDisplayed ? &quot;shown&quot; : &quot;not shown&quot;));</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineplus">+</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineplus">+  return notification;</span>
<a href="#l23.64"></a><span id="l23.64" class="difflineplus">+}</span>
<a href="#l23.65"></a><span id="l23.65" class="difflineplus">+</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineplus">+/**</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineplus">+ * A helper function for closing a notification if one is currently displayed</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineplus">+ * in the window.</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineplus">+ *</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineplus">+ * @param aController the controller for the window with the notification</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineplus">+ * @param aBoxId the id of the notificaiton box</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineplus">+ * @param aValue the value of the notification to close</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineplus">+ */</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineplus">+function close_notification(aController, aBoxId, aValue) {</span>
<a href="#l23.75"></a><span id="l23.75" class="difflineplus">+  let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineplus">+  if (!nb)</span>
<a href="#l23.77"></a><span id="l23.77" class="difflineplus">+    throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineplus">+</span>
<a href="#l23.79"></a><span id="l23.79" class="difflineplus">+  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l23.80"></a><span id="l23.80" class="difflineplus">+  if (notification)</span>
<a href="#l23.81"></a><span id="l23.81" class="difflineplus">+    notification.close();</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineplus">+}</span>
<a href="#l23.83"></a><span id="l23.83" class="difflineplus">+</span>
<a href="#l23.84"></a><span id="l23.84" class="difflineplus">+/**</span>
<a href="#l23.85"></a><span id="l23.85" class="difflineplus">+ * A helper function that waits for a notification with value aValue</span>
<a href="#l23.86"></a><span id="l23.86" class="difflineplus">+ * to stop displaying in the window.</span>
<a href="#l23.87"></a><span id="l23.87" class="difflineplus">+ *</span>
<a href="#l23.88"></a><span id="l23.88" class="difflineplus">+ * @param aController the controller for the window with the notification</span>
<a href="#l23.89"></a><span id="l23.89" class="difflineplus">+ * @param aBoxId the id of the notificaiton box </span>
<a href="#l23.90"></a><span id="l23.90" class="difflineplus">+ * @param aValue the value of the notification to wait to stop</span>
<a href="#l23.91"></a><span id="l23.91" class="difflineplus">+ */</span>
<a href="#l23.92"></a><span id="l23.92" class="difflineplus">+function wait_for_notification_to_stop(aController, aBoxId, aValue) {</span>
<a href="#l23.93"></a><span id="l23.93" class="difflineplus">+  let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l23.94"></a><span id="l23.94" class="difflineplus">+  if (!nb)</span>
<a href="#l23.95"></a><span id="l23.95" class="difflineplus">+    throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l23.96"></a><span id="l23.96" class="difflineplus">+  aController.waitFor(function() !nb.getNotificationWithValue(aValue),</span>
<a href="#l23.97"></a><span id="l23.97" class="difflineplus">+                      &quot;Timed out waiting for notification with value &quot; +</span>
<a href="#l23.98"></a><span id="l23.98" class="difflineplus">+                      aValue + &quot; to stop.&quot;);</span>
<a href="#l23.99"></a><span id="l23.99" class="difflineplus">+}</span>
<a href="#l23.100"></a><span id="l23.100" class="difflineplus">+</span>
<a href="#l23.101"></a><span id="l23.101" class="difflineplus">+/**</span>
<a href="#l23.102"></a><span id="l23.102" class="difflineplus">+ * A helper function that waits for a notification with value aValue</span>
<a href="#l23.103"></a><span id="l23.103" class="difflineplus">+ * to show in the window.</span>
<a href="#l23.104"></a><span id="l23.104" class="difflineplus">+ *</span>
<a href="#l23.105"></a><span id="l23.105" class="difflineplus">+ * @param aController the controller for the compose window that we want</span>
<a href="#l23.106"></a><span id="l23.106" class="difflineplus">+ *                    the notification to appear in</span>
<a href="#l23.107"></a><span id="l23.107" class="difflineplus">+ * @param aBoxId the id of the notificaiton box</span>
<a href="#l23.108"></a><span id="l23.108" class="difflineplus">+ * @param aValue the value of the notification to wait for</span>
<a href="#l23.109"></a><span id="l23.109" class="difflineplus">+ */</span>
<a href="#l23.110"></a><span id="l23.110" class="difflineplus">+function wait_for_notification_to_show(aController, aBoxId, aValue) {</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineplus">+  let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l23.112"></a><span id="l23.112" class="difflineplus">+  if (!nb)</span>
<a href="#l23.113"></a><span id="l23.113" class="difflineplus">+    throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l23.114"></a><span id="l23.114" class="difflineplus">+  aController.waitFor(function() nb.getNotificationWithValue(aValue) != null,</span>
<a href="#l23.115"></a><span id="l23.115" class="difflineplus">+                      &quot;Timed out waiting for notification with value &quot; +</span>
<a href="#l23.116"></a><span id="l23.116" class="difflineplus">+                      aValue + &quot; to show.&quot;);</span>
<a href="#l23.117"></a><span id="l23.117" class="difflineplus">+}</span>
<a href="#l23.118"></a><span id="l23.118" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">index 0ae15cd390a97b27e53f94d3f6bde9818966d115..6ae803d3513383b85139e70457d238d391b11b87</span>
<a href="#l24.2"></a><span id="l24.2">GIT binary patch
literal 718
zc$@*w0x|uGP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10!v9mK~y-6h0{xHOmP&amp;)@$WhJ*_oQ^Od~BB)GL~ZnrMifq$_J-
z!(G^0iWLi6K_anY#l*(Ot~(MTc5+2RJkk~w!qB3o*L3FokBvu@8T_~B{60DPpBynW
zdc8D}K!wxJI1X&amp;6)orm?pZ}NexEDq@&amp;AE-5x37#}&gt;m3HrUSU&lt;ayXDx0QN=Q6oKF)e
zr-@Ab7f2J?qQafc2T$~eBV)L{^SxHL=fG!RDote9KLJ%PSN9((^^Hx+^1G*q@DQL@
zH&gt;XN2!o4(+ojrjxkv&amp;nRx~DXLK-#y?K=uhlf?suk*8@e0D%?pE8R`O5I9}Pbt&gt;9*E
zV~ej)UohDC6ZZ|NmR3iU`XyH3R2Lw^?zpm6Z2lS8GM+Vw21m+iB9p+;F!om!$^(?w
zS7U_3U4TPIgH?mL=368Ru@4Uznb=oUm8&lt;IMx#7{Fekl}*sylFwHEAOLZy-&amp;?#|vX^
zFCgNOFox_cg-U_awq3)hmL-Z16(nB*Q3c$}33BpwE6=_lVT6Ps78{+`eTMf2UUhO@
zI-Vg&gt;OuqC95&amp;KrF+aI7-H&amp;d}E-y3rf7Qqj2aYkNTq#eE&gt;9DYZ!&gt;VfZ*%{NeyN8Nwm
z?0RE*x``iv2Nra2af^K5D=uncK?l@my!rgiId`KAFymtOb#eCN^qj*4oItKfD}-FZ
z2_I(~uC=s0YsRJD+go{!X(FTQ=~Q2-Z+&amp;I^U?EtSV}6_E_ptCdYi9G=oa?v)wYt6R
z3H;iKs+&lt;&amp;0kGPK83ZTBeu-vXY=g!vZ)&gt;+yA0}yQUE(zZFasU7T07*qoM6N&lt;$f(`6M
AivR!s</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">index 53cd7a5d41db59e0732b9e45280c50980c108c14..d99a9ea6d4600a872b724a33d61665e8a8310168</span>
<a href="#l25.2"></a><span id="l25.2">GIT binary patch
literal 766
zc$@+L0s;MrP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10((hBK~y-6ZIexF97hm_pPCtIwKBUh*fIJ*z62vMCI&gt;?&gt;A&gt;^E#
zO&gt;zs4bID0Y&lt;S&amp;HWgD$=rg8zUI0Us;^fe@2JAOTAX0tH*xjCNOEX=i(&lt;dwQlS2MJ+G
zevd`&lt;({H_9EoR1fJr&lt;c4_#U_itQ-9FwOP2(2#A^Sv&amp;a&lt;i5%6&amp;eUl@G8xU!ObaP#K$
z&gt;lZJ|{?5+W%pL=O0)GKJ_fBq&gt;N6-R_*&gt;-z!WqG-Eb$NN_+O1op?KVEoX&lt;98tqY=IB
zZ7cfyiR&lt;-fsw%l}HVcp$h(Pk$&gt;grr(Mj9hF9#ik_f%io3Nkq6ZKQEV-mM$ezQ*1wZ
zaymkyfC3UDy0wMu?vmy?nRCqj_ydUuIvnC(zQk&gt;AqA{ZHWRNK!fO(IM$D|@;s`#cs
z78Vfip)4T;)O)n5&amp;I0VjfR!ay6eyr(Skqvt=wyOUCe$I&amp;gn)*C!RgZ_-&lt;efFf7I(y
zR~4ZsD2sxsDA1}R&lt;T;_&amp;qZ$l|&amp;JmnLRo|RC;5dWd2CrUyHQhASMS*xvbdD^~@p(&gt;V
zMh!@}OF0~3@ch&amp;PKn+iO{eBrjzzqht!$Zm#+56;EDl_7756Sd2t|&amp;qS8)pCtzwQr*
zHf|b9U;&gt;oD^?$dhyWL|zl90699F0be!tZAQ56u3nV_e@nIB;=pjuP;|?l&lt;33I!6G~
zPKSe{2+{jr9+&gt;@eW|aZfMY06`UhH&amp;ME~}=sbJRctXtmIGo7YE2Z`JI&gt;HM7GDfD_0K
zfj_R!%yc_2RaX^~WyCaPKLppPez|7$^ulL)SL-5+0voeQa=j}u8_aB|IyShwX7-G8
wO3oM7%-$H&gt;o~S;|o5mfgZW!Eo-(i6N0o{6pxJ(|H+yDRo07*qoM6N&lt;$f&gt;&lt;_B%m4rY</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">index ce1f83c1bb56fc98a3ef050cd6ae1be3fc08a1c2..8636a5c363ff9299041e571e645e63c7b8000c45</span>
<a href="#l26.2"></a><span id="l26.2">GIT binary patch
literal 865
zc$@)Y1D^beP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10^UhPK~y-6jgn1hTxAr7pYOZ(CexWIlXjGhNi#`?LVqNJG5+AH
z#VYk@ql==3(jeWq5vA0C2pX!G#6TOwg-D4YnWCf?$-&lt;hJSkX?R7}BP-jdmh7&amp;6r7t
zwB{z6ICJm)j*D7@v`8N~%k!T1eL3o2Z_hiP=d~MSZ0-Q9weL7i*Q&gt;AWdlP`}p3ai%
zx?+sEqj6nVx_dfHo!#%+B7zNKMIsUQcYMhAqvQX3{fX_5(DC|SKrFxpd&gt;g&gt;?d@?_t
zWkb_8l+w3dHi6IZcc=dmSmoc`N-5&amp;8D0K;&amp;m!7TR{l00|jEzt;{tat$S+ws_h{TvY
zbO?;ORRADf6=v^q3F1xzPo8`YFPo?7nWu=&gt;zlaWnDCTlZ4-S&amp;J@Us;_iv4d~Sakrz
zV-Zed7O3fap4g(Hq4fo(PJPSVXP@IOFR`vM#nv5&lt;vA(vJv2=Q{U#TstffdAKVa(V$
z7Dp!7(0o60{ry}W9bxgo?JRuo1!*hJ$l=4-T9a&amp;UuGLDt{h!7{6*iTb6C{&amp;${Fcd(
zo1Nv}mKGXwlSIBAAX~GMM~@s~VrYo!`ua+x)GiI+2LXl(z8X5k@=v2wSQhhh1*Yz&lt;
z&lt;7#n*rnWZfvg15(=`8o`+{yB_Ysk_PD3#PV+^ZWFL{K7l*RK&lt;l%S^TG;D^5~&amp;VBST
z4O=#|ZRR}Z4;%myy!m-V1Pu@hRnVABa4GvMm!s=(3kBAifU41x98EpM@Si0njvXTv
zjqrO{7mnjl%;!-eGd2*o?t=A6Z#$mnlRti(Gi`fltgNKT{e#D=S4e%C=3++&amp;SB8hF
z4Ttf9fPA5_A~2v1_V&amp;Ex`+mEKI5*3@tM5~*`tr0&amp;ghI@gO1R}R5(GGwMKT&lt;wY&gt;dpf
z?iC}lNr}iUZ`-d_m8H~xt@Xpz(P(syZKIW9#rK&amp;n7K_WCmp39$w~9&gt;OR^TRSrFLtr
rUp6B5A&gt;wGQe-V+RM&amp;!L#kut#Fba7^be`q@t00000NkvXXu0mjfrDU7a</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/themes/linux/mail/primaryToolbar.css</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/themes/linux/mail/primaryToolbar.css</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -540,32 +540,16 @@ toolbar[iconsize=&quot;small&quot;] .button-appmen</span>
<a href="#l27.4"></a><span id="l27.4">   font-weight: bold;</span>
<a href="#l27.5"></a><span id="l27.5"> }</span>
<a href="#l27.6"></a><span id="l27.6"> </span>
<a href="#l27.7"></a><span id="l27.7"> .msgNotificaton-smallText {</span>
<a href="#l27.8"></a><span id="l27.8">   -moz-padding-start: 10px;</span>
<a href="#l27.9"></a><span id="l27.9">   font-size: 90%;</span>
<a href="#l27.10"></a><span id="l27.10"> }</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-#junkBarImage {</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/junk.png&quot;);</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-}</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineminus">-</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineminus">-#junkIcon {</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-junk.png&quot;);</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-}</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineminus">-</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineminus">-#remoteContentImage {</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/remote-blocked.png&quot;); </span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-}</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineminus">-</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineminus">-#phishingBarImage {</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/phishing.png&quot;);</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineminus">-}</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineminus">-</span>
<a href="#l27.28"></a><span id="l27.28"> #mdnBarImage {</span>
<a href="#l27.29"></a><span id="l27.29">   list-style-image: url(&quot;moz-icon://stock/gtk-dialog-question?size=toolbar&quot;);</span>
<a href="#l27.30"></a><span id="l27.30"> }</span>
<a href="#l27.31"></a><span id="l27.31"> </span>
<a href="#l27.32"></a><span id="l27.32"> /* AppMenu styling */</span>
<a href="#l27.33"></a><span id="l27.33"> </span>
<a href="#l27.34"></a><span id="l27.34"> .splitmenu-menuitem {</span>
<a href="#l27.35"></a><span id="l27.35">   -moz-margin-end: 1px;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mail/themes/osx/jar.mn</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mail/themes/osx/jar.mn</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -217,17 +217,16 @@ classic.jar:</span>
<a href="#l28.4"></a><span id="l28.4">   skin/classic/messenger/icons/vertical-threadpane-splitter-bg-rtl.gif (mail/icons/vertical-threadpane-splitter-bg-rtl.gif)</span>
<a href="#l28.5"></a><span id="l28.5">   skin/classic/messenger/icons/unreadmail-selected.png           (mail/icons/unreadmail-selected.png)</span>
<a href="#l28.6"></a><span id="l28.6">   skin/classic/messenger/icons/unreadmail.png                    (mail/icons/unreadmail.png)</span>
<a href="#l28.7"></a><span id="l28.7">   skin/classic/messenger/icons/unthreadcol.png                   (mail/icons/unthreadcol.png)</span>
<a href="#l28.8"></a><span id="l28.8">   skin/classic/messenger/icons/online.png                        (mail/icons/online.png)</span>
<a href="#l28.9"></a><span id="l28.9">   skin/classic/messenger/icons/online@2x.png                     (mail/icons/online@2x.png)</span>
<a href="#l28.10"></a><span id="l28.10">   skin/classic/messenger/icons/offline.png                       (mail/icons/offline.png)</span>
<a href="#l28.11"></a><span id="l28.11">   skin/classic/messenger/icons/offline@2x.png                    (mail/icons/offline@2x.png)</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-  skin/classic/messenger/icons/warning.png                       (mail/icons/warning.png)</span>
<a href="#l28.13"></a><span id="l28.13">   skin/classic/messenger/icons/arrow-dn-7.png                    (mail/icons/arrow-dn-7.png)</span>
<a href="#l28.14"></a><span id="l28.14">   skin/classic/messenger/icons/zoomout.png                       (mail/icons/zoomout.png)</span>
<a href="#l28.15"></a><span id="l28.15">   skin/classic/messenger/icons/zoomout-hover.png                 (mail/icons/zoomout-hover.png)</span>
<a href="#l28.16"></a><span id="l28.16">   skin/classic/messenger/icons/timeline.png                      (mail/icons/timeline.png)</span>
<a href="#l28.17"></a><span id="l28.17">   skin/classic/messenger/icons/timeline-inverted.png             (mail/icons/timeline-inverted.png)</span>
<a href="#l28.18"></a><span id="l28.18">   skin/classic/messenger/icons/empty-search-results.png          (mail/icons/empty-search-results.png)</span>
<a href="#l28.19"></a><span id="l28.19">   skin/classic/messenger/icons/QFB-toolbar.png                   (mail/icons/QFB-toolbar.png)</span>
<a href="#l28.20"></a><span id="l28.20">   skin/classic/messenger/icons/QFB-toolbar@2x.png                (mail/icons/QFB-toolbar@2x.png)</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineat">@@ -237,16 +236,19 @@ classic.jar:</span>
<a href="#l28.22"></a><span id="l28.22">   skin/classic/messenger/icons/chat-toolbar@2x.png               (mail/icons/chat-toolbar@2x.png)</span>
<a href="#l28.23"></a><span id="l28.23">   skin/classic/messenger/icons/status.png                        (mail/icons/status.png)</span>
<a href="#l28.24"></a><span id="l28.24">   skin/classic/messenger/icons/status@2x.png                     (mail/icons/status@2x.png)</span>
<a href="#l28.25"></a><span id="l28.25">   skin/classic/messenger/icons/status-small.png                  (mail/icons/status-small.png)</span>
<a href="#l28.26"></a><span id="l28.26">   skin/classic/messenger/icons/status-small@2x.png               (mail/icons/status-small@2x.png)</span>
<a href="#l28.27"></a><span id="l28.27">   skin/classic/messenger/icons/connecting.png                    (mail/icons/connecting.png)</span>
<a href="#l28.28"></a><span id="l28.28">   skin/classic/messenger/icons/loading.png                       (mail/icons/loading.png)</span>
<a href="#l28.29"></a><span id="l28.29">   skin/classic/messenger/icons/loading@2x.png                    (mail/icons/loading@2x.png)</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineplus">+  skin/classic/messenger/icons/junk.png                          (mail/icons/junk.png)</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+  skin/classic/messenger/icons/phishing.png                      (mail/icons/phishing.png)</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+  skin/classic/messenger/icons/remote-blocked.png                (mail/icons/remote-blocked.png)</span>
<a href="#l28.33"></a><span id="l28.33">   skin/classic/messenger/tabs/alltabs-box-bkgnd-icon.png              (mail/tabs/alltabs-box-bkgnd-icon.png)</span>
<a href="#l28.34"></a><span id="l28.34">   skin/classic/messenger/tabs/alltabs-box-bkgnd-icon@2x.png           (mail/tabs/alltabs-box-bkgnd-icon@2x.png)</span>
<a href="#l28.35"></a><span id="l28.35">   skin/classic/messenger/tabs/alltabs-box-overflow-bkgnd-animate.png  (mail/tabs/alltabs-box-overflow-bkgnd-animate.png)</span>
<a href="#l28.36"></a><span id="l28.36">   skin/classic/messenger/tabs/newtab.png                              (mail/tabs/newtab.png)</span>
<a href="#l28.37"></a><span id="l28.37">   skin/classic/messenger/tabs/dragIndicator.png                  (mail/tabs/dragIndicator.png)</span>
<a href="#l28.38"></a><span id="l28.38">   skin/classic/messenger/tabs/arrow.png                          (mail/tabs/arrow.png)</span>
<a href="#l28.39"></a><span id="l28.39">   skin/classic/messenger/tabs/arrow@2x.png                       (mail/tabs/arrow@2x.png)</span>
<a href="#l28.40"></a><span id="l28.40">   skin/classic/messenger/tabs/activeEnd.png                      (mail/tabs/activeEnd.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">new file mode 100644</span>
<a href="#l29.2"></a><span id="l29.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..d76f96cd9530150204feb8b0a60310cc77e57eff</span>
<a href="#l29.3"></a><span id="l29.3">GIT binary patch
literal 450
zc%17D@N?(olHy`uVBq!ia0vp^0wB!61|;P_|4#%`EX7WqAsj$Z!;#Vf&lt;Z~8yL&gt;2?p
zUk71ECym(^Ktah8*NBqf{Irtt#G+J&amp;^73-M%)IR4&lt;ivthz5Jr|+3#$m7#JAsJzX3_
zEP9ttvh`+m6mdNtTP84BwUtp-VTMAJK#Pgkw(Rtm(&gt;4lh74n|lkSdV#iMyrY9}D+Z
zA9Y6$&lt;xJ%pGn`shMD+P`OfC#}l=m?#zHeLn-1%D6zhK8{3Yngl{&gt;^8YRMt@Z;H$aA
zj3hfIp#w~^&gt;9J-{_XKmQTs@xFz@GiKTlu|Lkeb6KnSk;w=Igif%=sZ;e$dR|^_l0k
z2b2YvXGb=Op5LI8Svtq&gt;z_E&amp;2ZSH_?3`~5gXBm#4V-wwevbL4!em3t8rZX+C?mkv&amp;
zG)$YpbikDPNzu;dAr31;s!lQZgl&gt;$GS;7&gt;xHcXwP&gt;HPdN$7TfXzPrzxRmJmCu8EX+
z&lt;OBnr`?JqJ%au9)J-BJ&gt;HQA|g&gt;&amp;pYyhMoWP^G~V(%k@B!*eh9EFW2qgpT0Ks%dfyw
p-}M+?A7Bz-R8HV1Y2@GklY3=blxNH16`)9A@O1TaS?83{1OTn+u4n)N</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">new file mode 100644</span>
<a href="#l30.2"></a><span id="l30.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..16e93fcd046cf3454a28eeb84a060dfcc1231df2</span>
<a href="#l30.3"></a><span id="l30.3">GIT binary patch
literal 455
zc%17D@N?(olHy`uVBq!ia0vp^0wB!61|;P_|4#%`EX7WqAsj$Z!;#Vf&lt;Z~8yL&gt;2?p
zUk71ECym(^Ktah8*NBqf{Irtt#G+J&amp;^73-M%)IR4&lt;ivthz5Jr|+3#$m7#J8`JY5_^
zEPB@l8G0Xfkf=?M&amp;J&lt;ed(Way;+nQ5a$UCK@+2W`2C+&lt;7V7FHbR9z9r4DjXx?G|lPF
zluMIzPd|J%!Lfr+*G619a~9i{x(^5M?*4wS_Is_mN7B?4%eWO=zI(qlJXw*u^fluY
zsg}eW(}V7DDyG#NN${|3pX&gt;L$O|@6cbVKfM;REiH&amp;*Q5&lt;gcZaIJFO9az}fKKk~#Le
zJL?g527iXE$bjo#1yA0b&lt;GB7h_ouA;-`}fG_O!QWJ-sQe&amp;P?U&lt;9TT3%JPp&amp;AJ+_cm
z(Po$ze8!+BcvAFAzZ7*5*Nb`EZ`*oKO0oVN#&amp;CgQ!NrU{ZHX24^0ps$6&gt;U(7xo#U2
z`qe6$lfnP;memgnDkePFmzc1|OY?j5+H0;_d1kYx2YGd;sGb);ZFjT8&gt;aMZxXM?`S
vRRS#hU5kD&amp;h@J4}-IvVnAbX%f@*(%t;_Vxa{(CF}20DYMtDnm{r-UW|eRZ&gt;Z</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1">new file mode 100644</span>
<a href="#l31.2"></a><span id="l31.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..918fefb29c2d00232c68609140bc87d8b2efbdeb</span>
<a href="#l31.3"></a><span id="l31.3">GIT binary patch
literal 709
zc$@*n0y_PPP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10zyedK~y-6jgmn~Q*j)}Kfm{e@mOH4z_rFGCr+V42s+rQpj(jc
z*v9Y_&gt;&gt;&gt;o}Ar?I6L1FCN$%C0eFeQm%MJ5I@FrMO85mu*gI~bH&lt;=&lt;@CTJNO1AI{d=#
z^5y&amp;c{=UB-KT%2{A{{^y=;mm!fcr|RubN9Ffo?e&gt;fJ?w_0FP_X4d6J=)aK@&lt;XaBf5
zbX`}rZSS_Uv?S_1|A|Fp3V6{V`Yvz-NB{z$H4p=+NF?$$l}hD`#o~iXrSi};O{cZB
z^?hA%Xk3rS^J9E`{8ca*tff+^P$rY&lt;P)cptw(Xyto&amp;B`Dyu8-PKxMPpg{7q&gt;1_uYD
zK$FX#0?zjJ_0&lt;xI#QdQvbai#T3x~tMrl+TG0!&lt;=fo2EHun&amp;w;}5cr^!(k3S-uZc+e
zfd=t-yqruX!}VsRlqa1|U-bEWPuJJi9|wcMlAAtupg}Ym-6@yLX8=Y&lt;M&amp;`U;Z`pC2
za{~hdcSWSs+uQrbl}7d(D4^Qe+4)=7bqyew%dHj)g=dCgRDd=hYgyJe08P_0lu`f-
zZXI(ECZSNsbh)%r%Db|%a?3D`M=tjqSn&amp;CL84aMhx%s1;AkW?--5VMjDu{&gt;;ToI8w
z@p$~p*x1;ji2MNzpw{2tzo?t0iD4LqWm(6!x3^D-h$AAQYPCAw)6-Kel}c?u`^Lt`
z^?W{m9?*eWG#Y(5F){H(+!am&amp;mw~`P_gDqCW@cut4i68vS1Og$fcX9X^62R3=U6QE
r8d$3vG=dMfz}^!n;5$$ReggajK5p3#^wT1x00000NkvXXu0mjf@q&lt;GO</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1">deleted file mode 100644</span>
<a href="#l32.2"></a><span id="l32.2">index 0815759685e0cd54b363626b34ff8ff08403cd10..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l32.3"></a><span id="l32.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mail/themes/osx/mail/primaryToolbar.css</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mail/themes/osx/mail/primaryToolbar.css</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -749,93 +749,16 @@ toolbar[mode=&quot;text&quot;] .button-appmenu .to</span>
<a href="#l33.4"></a><span id="l33.4">   padding: 0;</span>
<a href="#l33.5"></a><span id="l33.5"> }</span>
<a href="#l33.6"></a><span id="l33.6"> </span>
<a href="#l33.7"></a><span id="l33.7"> .msgNotification-smallText {</span>
<a href="#l33.8"></a><span id="l33.8">   -moz-padding-start: 10px;</span>
<a href="#l33.9"></a><span id="l33.9">   font-size: 90%;</span>
<a href="#l33.10"></a><span id="l33.10"> }</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-#junkBarImage {</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/mail-toolbar.png&quot;);</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-  -moz-image-region: rect(0px 162px 18px 144px);</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-}</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineminus">-</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineminus">-@media (min-resolution: 2dppx) {</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineminus">-  #junkBarImage {</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineminus">-    list-style-image: url(&quot;chrome://messenger/skin/icons/mail-toolbar@2x.png&quot;);</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineminus">-    -moz-image-region: rect(0px 324px 36px 288px);</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineminus">-  }</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineminus">-}</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineminus">-</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineminus">-#junkBar {</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineminus">-  background-color: #CAE2C5;</span>
<a href="#l33.26"></a><span id="l33.26" class="difflineminus">-  padding: 6px 8px;</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineminus">-  color: black;</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-}</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineminus">-#junkIcon {</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-pane.png&quot;);</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineminus">-  -moz-image-region: rect(0 128px 16px 112px);</span>
<a href="#l33.33"></a><span id="l33.33" class="difflineminus">-}</span>
<a href="#l33.34"></a><span id="l33.34" class="difflineminus">-</span>
<a href="#l33.35"></a><span id="l33.35" class="difflineminus">-/* ::::: remote content bar status rules ::::: */</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineminus">-</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineminus">-#remoteContentImage {</span>
<a href="#l33.38"></a><span id="l33.38" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/warning.png&quot;);</span>
<a href="#l33.39"></a><span id="l33.39" class="difflineminus">-}</span>
<a href="#l33.40"></a><span id="l33.40" class="difflineminus">-</span>
<a href="#l33.41"></a><span id="l33.41" class="difflineminus">-#remoteContentBar {</span>
<a href="#l33.42"></a><span id="l33.42" class="difflineminus">-  background-color: #FBFBC8;</span>
<a href="#l33.43"></a><span id="l33.43" class="difflineminus">-  border: 1px solid #DDDDE1;</span>
<a href="#l33.44"></a><span id="l33.44" class="difflineminus">-  color: black;</span>
<a href="#l33.45"></a><span id="l33.45" class="difflineminus">-  padding: 0.3em 0.2em;</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineminus">-  border-bottom-left-radius: 0.2em;</span>
<a href="#l33.47"></a><span id="l33.47" class="difflineminus">-  border-bottom-right-radius: 0.2em;</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineminus">-  border-top-left-radius: 0.2em;</span>
<a href="#l33.49"></a><span id="l33.49" class="difflineminus">-  border-top-right-radius: 0.2em;</span>
<a href="#l33.50"></a><span id="l33.50" class="difflineminus">-}</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineminus">-</span>
<a href="#l33.52"></a><span id="l33.52" class="difflineminus">-#remoteContentDescription {</span>
<a href="#l33.53"></a><span id="l33.53" class="difflineminus">-  -moz-margin-start: 1.1em;</span>
<a href="#l33.54"></a><span id="l33.54" class="difflineminus">-}</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineminus">-</span>
<a href="#l33.56"></a><span id="l33.56" class="difflineminus">-#remoteContentButton {</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineminus">-  margin-top: 0;</span>
<a href="#l33.58"></a><span id="l33.58" class="difflineminus">-  margin-bottom: 0;</span>
<a href="#l33.59"></a><span id="l33.59" class="difflineminus">-}</span>
<a href="#l33.60"></a><span id="l33.60" class="difflineminus">-</span>
<a href="#l33.61"></a><span id="l33.61" class="difflineminus">-#phishingBarImage {</span>
<a href="#l33.62"></a><span id="l33.62" class="difflineminus">-/* for now, temporarily copy the remote image icon until we can get a new one */</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/warning.png&quot;);</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineminus">-}</span>
<a href="#l33.65"></a><span id="l33.65" class="difflineminus">-</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineminus">-#phishingBar {</span>
<a href="#l33.67"></a><span id="l33.67" class="difflineminus">-  background-color: #EFF3D4;</span>
<a href="#l33.68"></a><span id="l33.68" class="difflineminus">-  padding: 6px 8px;</span>
<a href="#l33.69"></a><span id="l33.69" class="difflineminus">-  color: black;</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineminus">-}</span>
<a href="#l33.71"></a><span id="l33.71" class="difflineminus">-</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineminus">-</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineminus">-#mdnBarImage {</span>
<a href="#l33.74"></a><span id="l33.74" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/icons/question-24.png&quot;);</span>
<a href="#l33.75"></a><span id="l33.75" class="difflineminus">-}</span>
<a href="#l33.76"></a><span id="l33.76" class="difflineminus">-</span>
<a href="#l33.77"></a><span id="l33.77" class="difflineminus">-#mdnBar {</span>
<a href="#l33.78"></a><span id="l33.78" class="difflineminus">-  background-color: #FBFBC8;</span>
<a href="#l33.79"></a><span id="l33.79" class="difflineminus">-  border: 1px solid #DDDDE1;</span>
<a href="#l33.80"></a><span id="l33.80" class="difflineminus">-  color: black;</span>
<a href="#l33.81"></a><span id="l33.81" class="difflineminus">-  padding: 0.3em 0.2em;</span>
<a href="#l33.82"></a><span id="l33.82" class="difflineminus">-  border-bottom-left-radius: 0.2em;</span>
<a href="#l33.83"></a><span id="l33.83" class="difflineminus">-  border-bottom-right-radius: 0.2em;</span>
<a href="#l33.84"></a><span id="l33.84" class="difflineminus">-  border-top-left-radius: 0.2em;</span>
<a href="#l33.85"></a><span id="l33.85" class="difflineminus">-  border-top-right-radius: 0.2em;</span>
<a href="#l33.86"></a><span id="l33.86" class="difflineminus">-}</span>
<a href="#l33.87"></a><span id="l33.87" class="difflineminus">-</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineminus">-</span>
<a href="#l33.89"></a><span id="l33.89"> #CustomizeToolbarSheet &gt; #main-box {</span>
<a href="#l33.90"></a><span id="l33.90">   border-top: none !important;</span>
<a href="#l33.91"></a><span id="l33.91">   border-left: 2px solid;</span>
<a href="#l33.92"></a><span id="l33.92">   border-right: 2px solid;</span>
<a href="#l33.93"></a><span id="l33.93">   border-bottom: 3px solid;</span>
<a href="#l33.94"></a><span id="l33.94">   -moz-border-right-colors: -moz-mac-menushadow ThreeDLightShadow !important;</span>
<a href="#l33.95"></a><span id="l33.95">   -moz-border-bottom-colors: -moz-mac-menushadow -moz-mac-menushadow ThreeDShadow !important;</span>
<a href="#l33.96"></a><span id="l33.96">   -moz-border-left-colors: ThreeDLightShadow ThreeDHighlight !important;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mail/themes/windows/jar.mn</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mail/themes/windows/jar.mn</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,17 +1,15 @@</span>
<a href="#l34.4"></a><span id="l34.4"> classic.jar:</span>
<a href="#l34.5"></a><span id="l34.5"> % skin editor classic/1.0 %skin/classic/editor/</span>
<a href="#l34.6"></a><span id="l34.6">   skin/classic/editor/editor.css                              (editor/editor.css)</span>
<a href="#l34.7"></a><span id="l34.7">   skin/classic/editor/EditorDialog.css                        (editor/EditorDialog.css)</span>
<a href="#l34.8"></a><span id="l34.8">   skin/classic/editor/icons/img-align-bottom.gif              (editor/img-align-bottom.gif)</span>
<a href="#l34.9"></a><span id="l34.9">   skin/classic/editor/icons/img-align-left.gif                (editor/img-align-left.gif)</span>
<a href="#l34.10"></a><span id="l34.10">   skin/classic/editor/icons/img-align-middle.gif              (editor/img-align-middle.gif)</span>
<a href="#l34.11"></a><span id="l34.11" class="difflineminus">-  skin/classic/editor/icons/img-align-right.gif               (editor/img-align-right.gif)</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-  skin/classic/editor/icons/img-align-top.gif                 (editor/img-align-top.gif)</span>
<a href="#l34.13"></a><span id="l34.13"> </span>
<a href="#l34.14"></a><span id="l34.14"> # ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l34.15"></a><span id="l34.15"> # ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION! ATTENTION!</span>
<a href="#l34.16"></a><span id="l34.16"> #</span>
<a href="#l34.17"></a><span id="l34.17"> # If you add a new file here, you'll need to add it to the aero section at the</span>
<a href="#l34.18"></a><span id="l34.18"> # bottom of this file, too. If you do not, people using Windows prior to Vista</span>
<a href="#l34.19"></a><span id="l34.19"> # will be able to enjoy your additions, but people using Vista and above will</span>
<a href="#l34.20"></a><span id="l34.20"> # not.</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineat">@@ -455,18 +453,18 @@ classic.jar:</span>
<a href="#l34.22"></a><span id="l34.22">   skin/classic/aero/messenger/icons/server.png                     (mail/icons/server-aero.png)</span>
<a href="#l34.23"></a><span id="l34.23">   skin/classic/aero/messenger/icons/readcol.svg                    (mail/icons/readcol.svg)</span>
<a href="#l34.24"></a><span id="l34.24">   skin/classic/aero/messenger/icons/unreadmail.png                 (mail/icons/unreadmail.png)</span>
<a href="#l34.25"></a><span id="l34.25">   skin/classic/aero/messenger/icons/search-arrow.gif               (mail/icons/search-arrow.gif)</span>
<a href="#l34.26"></a><span id="l34.26">   skin/classic/aero/messenger/icons/quick-search-icons.png         (mail/icons/quick-search-icons-aero.png)</span>
<a href="#l34.27"></a><span id="l34.27">   skin/classic/aero/messenger/icons/quick-search-clear.png         (mail/icons/quick-search-clear.png)</span>
<a href="#l34.28"></a><span id="l34.28">   skin/classic/aero/messenger/icons/close-button.png               (mail/icons/close-button.png)</span>
<a href="#l34.29"></a><span id="l34.29">   skin/classic/aero/messenger/icons/closeTab.png                   (mail/icons/closeTab.png)</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineminus">-  skin/classic/aero/messenger/icons/remote-blocked.png             (mail/icons/remote-blocked.png)</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineminus">-  skin/classic/aero/messenger/icons/phishing.png                   (mail/icons/phishing.png)</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+  skin/classic/aero/messenger/icons/remote-blocked.png             (mail/icons/remote-blocked-aero.png)</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineplus">+  skin/classic/aero/messenger/icons/phishing.png                   (mail/icons/phishing-aero.png)</span>
<a href="#l34.34"></a><span id="l34.34">   skin/classic/aero/messenger/icons/junk.png                       (mail/icons/junk-aero.png)</span>
<a href="#l34.35"></a><span id="l34.35">   skin/classic/aero/messenger/icons/check.gif                      (mail/icons/check.gif)</span>
<a href="#l34.36"></a><span id="l34.36">   skin/classic/aero/messenger/icons/notchecked.gif                 (mail/icons/notchecked.gif)</span>
<a href="#l34.37"></a><span id="l34.37">   skin/classic/aero/messenger/icons/online.png                     (mail/icons/online-aero.png)</span>
<a href="#l34.38"></a><span id="l34.38">   skin/classic/aero/messenger/icons/offline.png                    (mail/icons/offline-aero.png)</span>
<a href="#l34.39"></a><span id="l34.39">   skin/classic/aero/messenger/icons/row.png                        (mail/icons/row.png)</span>
<a href="#l34.40"></a><span id="l34.40">   skin/classic/aero/messenger/icons/update.png                     (mail/icons/update.png)</span>
<a href="#l34.41"></a><span id="l34.41">   skin/classic/aero/messenger/icons/secure.png                     (mail/icons/secure.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1">index 45278b6c41ebe1c55bb5f5274693ac46062c932c..4fbd66128ca5889ce9e5940a85e26ee8b5505c76</span>
<a href="#l35.2"></a><span id="l35.2">GIT binary patch
literal 384
zc%17D@N?(olHy`uVBq!ia0vp^0wB!61|;P_|4#%`EX7WqAsj$Z!;#Vf&lt;Z~8yL&gt;2?p
zUk71ECym(^Ktah8*NBqf{Irtt#G+J&amp;^73-M%)IR4&lt;ivthz5Jr|+3#$mfQtTlx;Tbd
z^e&amp;xb?{(NwpmqOqc@Ha2#ZV59AQzv^*~}433{$&amp;0N;&amp;QwICLzSgDdWUa0Qzodw`%L
z_r#93H*z+f%RlZgC-2_upJ~%%XG;F&gt;&gt;^(8z%CwSAVh)#BcChRVW8B7d);NJjqG0;V
zO^2%Mb0?_v2k$c2y#0*bv@McMDy9vd&amp;uVww;ww&lt;|yvXM6V0${6?*j)&lt;&lt;6({q&lt;-E3@
zf49tSXkOB&lt;bYLAb#|-aPjLQ$yUD{n4_&gt;bE&lt;B$&lt;B)&gt;o)GV)aL06j+xuLHn^G`J?hM|
zgKb~9iGJg3r2}W;8oTWkydT^-bFVn?pOva&lt;qox7Ftpmmd{4q0cwl5E3;0xRH-=&gt;b?
YxTAHd$F4_$z&lt;^-zboFyt=akR{0DLcxqyPW_</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1">index 0ae15cd390a97b27e53f94d3f6bde9818966d115..6ae803d3513383b85139e70457d238d391b11b87</span>
<a href="#l36.2"></a><span id="l36.2">GIT binary patch
literal 718
zc$@*w0x|uGP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10!v9mK~y-6h0{xHOmP&amp;)@$WhJ*_oQ^Od~BB)GL~ZnrMifq$_J-
z!(G^0iWLi6K_anY#l*(Ot~(MTc5+2RJkk~w!qB3o*L3FokBvu@8T_~B{60DPpBynW
zdc8D}K!wxJI1X&amp;6)orm?pZ}NexEDq@&amp;AE-5x37#}&gt;m3HrUSU&lt;ayXDx0QN=Q6oKF)e
zr-@Ab7f2J?qQafc2T$~eBV)L{^SxHL=fG!RDote9KLJ%PSN9((^^Hx+^1G*q@DQL@
zH&gt;XN2!o4(+ojrjxkv&amp;nRx~DXLK-#y?K=uhlf?suk*8@e0D%?pE8R`O5I9}Pbt&gt;9*E
zV~ej)UohDC6ZZ|NmR3iU`XyH3R2Lw^?zpm6Z2lS8GM+Vw21m+iB9p+;F!om!$^(?w
zS7U_3U4TPIgH?mL=368Ru@4Uznb=oUm8&lt;IMx#7{Fekl}*sylFwHEAOLZy-&amp;?#|vX^
zFCgNOFox_cg-U_awq3)hmL-Z16(nB*Q3c$}33BpwE6=_lVT6Ps78{+`eTMf2UUhO@
zI-Vg&gt;OuqC95&amp;KrF+aI7-H&amp;d}E-y3rf7Qqj2aYkNTq#eE&gt;9DYZ!&gt;VfZ*%{NeyN8Nwm
z?0RE*x``iv2Nra2af^K5D=uncK?l@my!rgiId`KAFymtOb#eCN^qj*4oItKfD}-FZ
z2_I(~uC=s0YsRJD+go{!X(FTQ=~Q2-Z+&amp;I^U?EtSV}6_E_ptCdYi9G=oa?v)wYt6R
z3H;iKs+&lt;&amp;0kGPK83ZTBeu-vXY=g!vZ)&gt;+yA0}yQUE(zZFasU7T07*qoM6N&lt;$f(`6M
AivR!s</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1">new file mode 100644</span>
<a href="#l37.2"></a><span id="l37.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..19c72d8ad7bb32cf06e6df181edad8b81b255c34</span>
<a href="#l37.3"></a><span id="l37.3">GIT binary patch
literal 343
zc%17D@N?(olHy`uVBq!ia0vp^0wB!61|;P_|4#%`EX7WqAsj$Z!;#Vf&lt;Z~8yL&gt;2?p
zUk71ECym(^Ktah8*NBqf{Irtt#G+J&amp;^73-M%)IR4&lt;ivthz5Jr|+3#$mfQqhox;Tbd
z^sb$3%jXy&lt;(7ONO!VRpmH!|?{&gt;S}}t1xB_8B?(IfX0)_9&gt;1LhO&amp;gjUHIa_&lt;OIJUlW
z+05$mXDp3Ro|&amp;PtDPoGvnVfIjfkC1Q(^vixXEI&amp;zPfxK*d`gMY=A&gt;zScDLeLlk8vI
z(r2moJ&gt;h`S1PjJvj5TsX9B&amp;&lt;&amp;GpcUz&amp;amV3xb@?zifqGTb%RM;eC?*ir5bB9Ixl#%
zVDsnH=iv_FnwJiXsKhq%ZSWQp{v`F{wDr8@hF)EbW*a;X8ZS_P`RMuW)!8P-%ux&lt;&lt;
g5&lt;jNebJb**Kiue@EFsyk0O&amp;skPgg&amp;ebxsLQ03knnCIA2c</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1">index 9911af9d515e737a2716fe2568ae22adf6a3f34e..d99a9ea6d4600a872b724a33d61665e8a8310168</span>
<a href="#l38.2"></a><span id="l38.2">GIT binary patch
literal 766
zc$@+L0s;MrP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10((hBK~y-6ZIexF97hm_pPCtIwKBUh*fIJ*z62vMCI&gt;?&gt;A&gt;^E#
zO&gt;zs4bID0Y&lt;S&amp;HWgD$=rg8zUI0Us;^fe@2JAOTAX0tH*xjCNOEX=i(&lt;dwQlS2MJ+G
zevd`&lt;({H_9EoR1fJr&lt;c4_#U_itQ-9FwOP2(2#A^Sv&amp;a&lt;i5%6&amp;eUl@G8xU!ObaP#K$
z&gt;lZJ|{?5+W%pL=O0)GKJ_fBq&gt;N6-R_*&gt;-z!WqG-Eb$NN_+O1op?KVEoX&lt;98tqY=IB
zZ7cfyiR&lt;-fsw%l}HVcp$h(Pk$&gt;grr(Mj9hF9#ik_f%io3Nkq6ZKQEV-mM$ezQ*1wZ
zaymkyfC3UDy0wMu?vmy?nRCqj_ydUuIvnC(zQk&gt;AqA{ZHWRNK!fO(IM$D|@;s`#cs
z78Vfip)4T;)O)n5&amp;I0VjfR!ay6eyr(Skqvt=wyOUCe$I&amp;gn)*C!RgZ_-&lt;efFf7I(y
zR~4ZsD2sxsDA1}R&lt;T;_&amp;qZ$l|&amp;JmnLRo|RC;5dWd2CrUyHQhASMS*xvbdD^~@p(&gt;V
zMh!@}OF0~3@ch&amp;PKn+iO{eBrjzzqht!$Zm#+56;EDl_7756Sd2t|&amp;qS8)pCtzwQr*
zHf|b9U;&gt;oD^?$dhyWL|zl90699F0be!tZAQ56u3nV_e@nIB;=pjuP;|?l&lt;33I!6G~
zPKSe{2+{jr9+&gt;@eW|aZfMY06`UhH&amp;ME~}=sbJRctXtmIGo7YE2Z`JI&gt;HM7GDfD_0K
zfj_R!%yc_2RaX^~WyCaPKLppPez|7$^ulL)SL-5+0voeQa=j}u8_aB|IyShwX7-G8
wO3oM7%-$H&gt;o~S;|o5mfgZW!Eo-(i6N0o{6pxJ(|H+yDRo07*qoM6N&lt;$f&gt;&lt;_B%m4rY</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1">new file mode 100644</span>
<a href="#l39.2"></a><span id="l39.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..3d442ae5160277476e7f089c3a41d7063db7c3e3</span>
<a href="#l39.3"></a><span id="l39.3">GIT binary patch
literal 461
zc$@*v0W$uHP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10ZK_kK~y-6mD9gV)=?D4@z?$8V{3zRgOaX6G`PA6DLECi3l5P*
zn&gt;gv&gt;kA{Yjz@gPi4T72k1)ZABM8rQp&amp;~Wh=r{R0Q@a4(pdGsvz+;i^deSe&amp;LQbb58
z4PX*a+|7PrIU){=9Jr4do?-&amp;JbD$CrqtQkfDDb1wbT=(%;Ab1a6`p55-3GXA$8Xrh
zJ}z*L9X#s&lt;IKdqL;sxH~9DDeZ!7TxSS@dEaJ+&lt;6pjNnr{!1sKDg)F|pjPl;27{XLa
zX}@Rz*v8A6xS=fD?}(VjR^I$|E5IKNW`7z-=)=d9(nGB0++Z^xlrMc&amp;i(TVAjw=W*
zbFOFx6d23?ULMCI;uP;{kfrLRDfhyX@_SaciLY2eSDtU=+#(*}25%}rzw(jl{qO;g
zFy;Sh-QaUXtfh$1&amp;QeN!c!dFF84s`;5eLu_(8&gt;M*FRoq$A%{2B00000NkvXXu0mjf
D#dyX5</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1">index ddefdf15742195458840aec97048ab4470b50467..8636a5c363ff9299041e571e645e63c7b8000c45</span>
<a href="#l40.2"></a><span id="l40.2">GIT binary patch
literal 865
zc$@)Y1D^beP)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004b3#c}2nYxW
zd&lt;bNS00009a7bBm000fw000fw0YWI7cmMzZ8FWQhbW?9;ba!ELWdL_~cP?peYja~^
zaAhuUa%Y?FJQ@H10^UhPK~y-6jgn1hTxAr7pYOZ(CexWIlXjGhNi#`?LVqNJG5+AH
z#VYk@ql==3(jeWq5vA0C2pX!G#6TOwg-D4YnWCf?$-&lt;hJSkX?R7}BP-jdmh7&amp;6r7t
zwB{z6ICJm)j*D7@v`8N~%k!T1eL3o2Z_hiP=d~MSZ0-Q9weL7i*Q&gt;AWdlP`}p3ai%
zx?+sEqj6nVx_dfHo!#%+B7zNKMIsUQcYMhAqvQX3{fX_5(DC|SKrFxpd&gt;g&gt;?d@?_t
zWkb_8l+w3dHi6IZcc=dmSmoc`N-5&amp;8D0K;&amp;m!7TR{l00|jEzt;{tat$S+ws_h{TvY
zbO?;ORRADf6=v^q3F1xzPo8`YFPo?7nWu=&gt;zlaWnDCTlZ4-S&amp;J@Us;_iv4d~Sakrz
zV-Zed7O3fap4g(Hq4fo(PJPSVXP@IOFR`vM#nv5&lt;vA(vJv2=Q{U#TstffdAKVa(V$
z7Dp!7(0o60{ry}W9bxgo?JRuo1!*hJ$l=4-T9a&amp;UuGLDt{h!7{6*iTb6C{&amp;${Fcd(
zo1Nv}mKGXwlSIBAAX~GMM~@s~VrYo!`ua+x)GiI+2LXl(z8X5k@=v2wSQhhh1*Yz&lt;
z&lt;7#n*rnWZfvg15(=`8o`+{yB_Ysk_PD3#PV+^ZWFL{K7l*RK&lt;l%S^TG;D^5~&amp;VBST
z4O=#|ZRR}Z4;%myy!m-V1Pu@hRnVABa4GvMm!s=(3kBAifU41x98EpM@Si0njvXTv
zjqrO{7mnjl%;!-eGd2*o?t=A6Z#$mnlRti(Gi`fltgNKT{e#D=S4e%C=3++&amp;SB8hF
z4Ttf9fPA5_A~2v1_V&amp;Ex`+mEKI5*3@tM5~*`tr0&amp;ghI@gO1R}R5(GGwMKT&lt;wY&gt;dpf
z?iC}lNr}iUZ`-d_m8H~xt@Xpz(P(syZKIW9#rK&amp;n7K_WCmp39$w~9&gt;OR^TRSrFLtr
rUp6B5A&gt;wGQe-V+RM&amp;!L#kut#Fba7^be`q@t00000NkvXXu0mjfrDU7a</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/themes/windows/mail/primaryToolbar-aero.css</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/themes/windows/mail/primaryToolbar-aero.css</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -597,36 +597,16 @@ toolbar[mode=&quot;text&quot;] .button-appmenu .to</span>
<a href="#l41.4"></a><span id="l41.4">   font-weight: bold;</span>
<a href="#l41.5"></a><span id="l41.5"> }</span>
<a href="#l41.6"></a><span id="l41.6"> </span>
<a href="#l41.7"></a><span id="l41.7"> .msgNotificaton-smallText {</span>
<a href="#l41.8"></a><span id="l41.8">   -moz-padding-start: 10px;</span>
<a href="#l41.9"></a><span id="l41.9">   font-size: 90%;</span>
<a href="#l41.10"></a><span id="l41.10"> }</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-#junkBarImage {</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/junk.png&quot;);</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineminus">-}</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineminus">-</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-#junkIcon {</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-junk.png&quot;);</span>
<a href="#l41.18"></a><span id="l41.18" class="difflineminus">-}</span>
<a href="#l41.19"></a><span id="l41.19" class="difflineminus">-</span>
<a href="#l41.20"></a><span id="l41.20" class="difflineminus">-#remoteContentImage {</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/remote-blocked.png&quot;); </span>
<a href="#l41.22"></a><span id="l41.22" class="difflineminus">-}</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineminus">-</span>
<a href="#l41.24"></a><span id="l41.24" class="difflineminus">-#phishingBarImage {</span>
<a href="#l41.25"></a><span id="l41.25" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/phishing.png&quot;);</span>
<a href="#l41.26"></a><span id="l41.26" class="difflineminus">-}</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineminus">-</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineminus">-#mdnBarImage {</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/icons/question-24-aero.png&quot;);</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineminus">-}</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineminus">-</span>
<a href="#l41.32"></a><span id="l41.32"> /* AppMenu styling */</span>
<a href="#l41.33"></a><span id="l41.33"> </span>
<a href="#l41.34"></a><span id="l41.34"> .splitmenu-menuitem {</span>
<a href="#l41.35"></a><span id="l41.35">   -moz-margin-end: 1px;</span>
<a href="#l41.36"></a><span id="l41.36">   -moz-padding-end: 0.5em;</span>
<a href="#l41.37"></a><span id="l41.37"> }</span>
<a href="#l41.38"></a><span id="l41.38"> </span>
<a href="#l41.39"></a><span id="l41.39"> .splitmenu-menu {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/themes/windows/mail/primaryToolbar.css</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/themes/windows/mail/primaryToolbar.css</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -779,36 +779,16 @@ toolbar[iconsize=&quot;small&quot;] .button-appmen</span>
<a href="#l42.4"></a><span id="l42.4">   font-weight: bold;</span>
<a href="#l42.5"></a><span id="l42.5"> }</span>
<a href="#l42.6"></a><span id="l42.6"> </span>
<a href="#l42.7"></a><span id="l42.7"> .msgNotificaton-smallText {</span>
<a href="#l42.8"></a><span id="l42.8">   -moz-padding-start: 10px;</span>
<a href="#l42.9"></a><span id="l42.9">   font-size: 90%;</span>
<a href="#l42.10"></a><span id="l42.10"> }</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-#junkBarImage {</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/junk.png&quot;);</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineminus">-}</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineminus">-</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineminus">-#junkIcon {</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/folder-junk.png&quot;);</span>
<a href="#l42.18"></a><span id="l42.18" class="difflineminus">-}</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineminus">-</span>
<a href="#l42.20"></a><span id="l42.20" class="difflineminus">-#remoteContentImage {</span>
<a href="#l42.21"></a><span id="l42.21" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/remote-blocked.png&quot;); </span>
<a href="#l42.22"></a><span id="l42.22" class="difflineminus">-}</span>
<a href="#l42.23"></a><span id="l42.23" class="difflineminus">-</span>
<a href="#l42.24"></a><span id="l42.24" class="difflineminus">-#phishingBarImage {</span>
<a href="#l42.25"></a><span id="l42.25" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/phishing.png&quot;);</span>
<a href="#l42.26"></a><span id="l42.26" class="difflineminus">-}</span>
<a href="#l42.27"></a><span id="l42.27" class="difflineminus">-</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineminus">-#mdnBarImage {</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/icons/question-24.png&quot;);</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineminus">-}</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineminus">-</span>
<a href="#l42.32"></a><span id="l42.32"> /* AppMenu styling */</span>
<a href="#l42.33"></a><span id="l42.33"> </span>
<a href="#l42.34"></a><span id="l42.34"> .splitmenu-menuitem {</span>
<a href="#l42.35"></a><span id="l42.35">   -moz-margin-end: 1px;</span>
<a href="#l42.36"></a><span id="l42.36"> }</span>
<a href="#l42.37"></a><span id="l42.37"> </span>
<a href="#l42.38"></a><span id="l42.38"> .splitmenu-menu {</span>
<a href="#l42.39"></a><span id="l42.39">   -moz-box-pack: end;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

