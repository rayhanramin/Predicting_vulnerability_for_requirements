<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 18550:7a674f9ee35503b88660df41e4616967b72ad765</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 7a674f9ee35503b88660df41e4616967b72ad765" />
<meta property="og:url" content="/comm-central/rev/7a674f9ee35503b88660df41e4616967b72ad765" />
<meta property="og:description" content="Port Bug 1211765 Kill --with-libxul-sdk for good to c-c r=jcranmer,callek,aleth a=aleth CLOSED TREE" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 7a674f9ee35503b88660df41e4616967b72ad765 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/7a674f9ee35503b88660df41e4616967b72ad765">shortlog</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/7a674f9ee35503b88660df41e4616967b72ad765">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765">files</a> |
changeset |
<a href="/comm-central/raw-rev/7a674f9ee35503b88660df41e4616967b72ad765">raw</a>  | <a href="/comm-central/archive/7a674f9ee35503b88660df41e4616967b72ad765.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1211765">Bug 1211765</a> Kill --with-libxul-sdk for good to c-c r=jcranmer,callek,aleth a=aleth CLOSED TREE
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#73;&#97;&#110;&#32;&#78;&#101;&#97;&#108;&#32;&#60;&#105;&#97;&#110;&#110;&#95;&#99;&#118;&#115;&#64;&#98;&#108;&#117;&#101;&#121;&#111;&#110;&#100;&#101;&#114;&#46;&#99;&#111;&#46;&#117;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 27 Oct 2015 17:31:00 +0100</td></tr>

<tr>
 <td>changeset 18550</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/7a674f9ee35503b88660df41e4616967b72ad765">7a674f9ee35503b88660df41e4616967b72ad765</a></td>
</tr>



<tr>
<td>parent 18549</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/073468887b0faecb810a6e4463a2806924fead81">073468887b0faecb810a6e4463a2806924fead81</a>
</td>
</tr>

<tr>
<td>child 18551</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/c97151456e748cd47ecfa1ad20ca10bc527d2058">c97151456e748cd47ecfa1ad20ca10bc527d2058</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=7a674f9ee35503b88660df41e4616967b72ad765">11360</a></td></tr>
<tr><td>push user</td><td>aleth@instantbird.org</td></tr>
<tr><td>push date</td><td class="date age">Fri, 06 Nov 2015 09:15:08 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@7a674f9ee355 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7a674f9ee35503b88660df41e4616967b72ad765">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7a674f9ee35503b88660df41e4616967b72ad765&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7a674f9ee35503b88660df41e4616967b72ad765&newProject=comm-central&newRevision=7a674f9ee35503b88660df41e4616967b72ad765&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7a674f9ee35503b88660df41e4616967b72ad765&newProject=comm-central&newRevision=7a674f9ee35503b88660df41e4616967b72ad765&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7a674f9ee35503b88660df41e4616967b72ad765&newProject=comm-central&newRevision=7a674f9ee35503b88660df41e4616967b72ad765&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28jcranmer%29&revcount=50">jcranmer</a>, <a href="/comm-central/log?rev=reviewer%28callek%29&revcount=50">callek</a>, <a href="/comm-central/log?rev=reviewer%28aleth%29&revcount=50">aleth</a>, <a href="/comm-central/log?rev=reviewer%28aleth%29&revcount=50">aleth</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1211765">1211765</a></td></tr>




</table></div>

<div class="page_body description">Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1211765">Bug 1211765</a> Kill --with-libxul-sdk for good to c-c r=jcranmer,callek,aleth a=aleth CLOSED TREE</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app.mozbuild">im/app.mozbuild</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/im/app.mozbuild">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/im/app.mozbuild">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app.mozbuild">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/im/app.mozbuild">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/im/app.mozbuild">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app/Makefile.in">im/app/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/im/app/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/im/app/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/im/app/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/im/app/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app/moz.build">im/app/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/im/app/moz.build">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/im/app/moz.build">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app/moz.build">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/im/app/moz.build">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/im/app/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app/nsMain.cpp">im/app/nsMain.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/im/app/nsMain.cpp">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/im/app/nsMain.cpp">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/app/nsMain.cpp">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/im/app/nsMain.cpp">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/im/app/nsMain.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/installer/Makefile.in">im/installer/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/im/installer/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/im/installer/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/im/installer/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/im/installer/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/im/installer/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app.mozbuild">mail/app.mozbuild</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/mail/app.mozbuild">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/mail/app.mozbuild">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app.mozbuild">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/mail/app.mozbuild">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/mail/app.mozbuild">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/Makefile.in">mail/app/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/moz.build">mail/app/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/moz.build">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/moz.build">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/moz.build">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/moz.build">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/nsMailApp.cpp">mail/app/nsMailApp.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/nsMailApp.cpp">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/nsMailApp.cpp">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/nsMailApp.cpp">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/nsMailApp.cpp">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/mail/app/nsMailApp.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/installer/Makefile.in">mail/installer/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/mail/installer/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/mail/installer/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/mail/installer/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/mail/installer/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/mail/installer/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app.mozbuild">suite/app.mozbuild</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/app.mozbuild">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/app.mozbuild">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app.mozbuild">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/app.mozbuild">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/app.mozbuild">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/Makefile.in">suite/app/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/moz.build">suite/app/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/moz.build">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/moz.build">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/moz.build">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/moz.build">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/nsSuiteApp.cpp">suite/app/nsSuiteApp.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/nsSuiteApp.cpp">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/nsSuiteApp.cpp">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/nsSuiteApp.cpp">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/nsSuiteApp.cpp">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/app/nsSuiteApp.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/Makefile.in">suite/browser/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/moz.build">suite/browser/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/moz.build">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/moz.build">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/moz.build">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/moz.build">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/browser/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/Makefile.in">suite/installer/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/Makefile.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/Makefile.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/Makefile.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/Makefile.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/package-manifest.in">suite/installer/package-manifest.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/package-manifest.in">file</a> |
<a href="/comm-central/annotate/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/package-manifest.in">annotate</a> |
<a href="/comm-central/diff/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/package-manifest.in">diff</a> |
<a href="/comm-central/comparison/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/package-manifest.in">comparison</a> |
<a href="/comm-central/log/7a674f9ee35503b88660df41e4616967b72ad765/suite/installer/package-manifest.in">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/im/app.mozbuild</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/im/app.mozbuild</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l1.4"></a><span id="l1.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.5"></a><span id="l1.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.6"></a><span id="l1.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8" class="difflineminus">-if not CONFIG['LIBXUL_SDK']:</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineminus">-    include('/toolkit/toolkit.mozbuild')</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineplus">+include('/toolkit/toolkit.mozbuild')</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12"> DIRS += [</span>
<a href="#l1.13"></a><span id="l1.13">     '/%s' % CONFIG['MOZ_BRANDING_DIRECTORY'],</span>
<a href="#l1.14"></a><span id="l1.14">     '/chat',</span>
<a href="#l1.15"></a><span id="l1.15"> ]</span>
<a href="#l1.16"></a><span id="l1.16"> </span>
<a href="#l1.17"></a><span id="l1.17"> # Ensure extensions are built after chat/ so purplexpcom can build.</span>
<a href="#l1.18"></a><span id="l1.18"> if CONFIG['MOZ_EXTENSIONS']:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/im/app/Makefile.in</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/im/app/Makefile.in</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -20,19 +20,16 @@ DEFINES += -DMOZ_SOURCE_REPO=&quot;$(SOURCE_R</span>
<a href="#l2.4"></a><span id="l2.4"> endif</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6"> DEFINES += \</span>
<a href="#l2.7"></a><span id="l2.7">   -DINSTANTBIRD_ICO=\&quot;$(DIST)/branding/instantbird.ico\&quot; \</span>
<a href="#l2.8"></a><span id="l2.8">   -DGRE_MILESTONE=$(GRE_MILESTONE) \</span>
<a href="#l2.9"></a><span id="l2.9">   -DGRE_BUILDID=$(GRE_BUILDID) \</span>
<a href="#l2.10"></a><span id="l2.10">    $(NULL)</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-include $(topsrcdir)/config/rules.mk</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-else</span>
<a href="#l2.15"></a><span id="l2.15"> # Build a binary bootstrapping with XRE_main</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17"> ifndef MOZ_WINCONSOLE</span>
<a href="#l2.18"></a><span id="l2.18"> ifdef MOZ_DEBUG</span>
<a href="#l2.19"></a><span id="l2.19"> MOZ_WINCONSOLE = 1</span>
<a href="#l2.20"></a><span id="l2.20"> else</span>
<a href="#l2.21"></a><span id="l2.21"> MOZ_WINCONSOLE = 0</span>
<a href="#l2.22"></a><span id="l2.22"> endif</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineat">@@ -79,18 +76,16 @@ endif</span>
<a href="#l2.24"></a><span id="l2.24"> </span>
<a href="#l2.25"></a><span id="l2.25"> ifneq ($(OS_ARCH),WINNT)</span>
<a href="#l2.26"></a><span id="l2.26"> libs::</span>
<a href="#l2.27"></a><span id="l2.27"> 	cp -p $(MOZ_APP_NAME)$(BIN_SUFFIX) $(DIST)/bin/$(MOZ_APP_NAME)-bin$(BIN_SUFFIX)</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29"> GARBAGE += $(addprefix $(DIST)/bin/defaults/pref/, all.js all-instantbird.js channel-prefs.js chat-prefs.js)</span>
<a href="#l2.30"></a><span id="l2.30"> endif # ! WinNT</span>
<a href="#l2.31"></a><span id="l2.31"> </span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-endif # LIBXUL_SDK</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">-</span>
<a href="#l2.34"></a><span id="l2.34"> ifneq (,$(filter windows gtk gtk2 gtk3,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l2.35"></a><span id="l2.35"> ifneq (,$(filter windows,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l2.36"></a><span id="l2.36"> ICON_SUFFIX=.ico</span>
<a href="#l2.37"></a><span id="l2.37"> else</span>
<a href="#l2.38"></a><span id="l2.38"> ICON_SUFFIX=.png</span>
<a href="#l2.39"></a><span id="l2.39"> endif</span>
<a href="#l2.40"></a><span id="l2.40"> </span>
<a href="#l2.41"></a><span id="l2.41"> ifdef MOZ_WIDGET_GTK</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineat">@@ -126,21 +121,16 @@ libs:: $(addprefix $(DIST)/branding/,$(B</span>
<a href="#l2.43"></a><span id="l2.43"> endif</span>
<a href="#l2.44"></a><span id="l2.44"> </span>
<a href="#l2.45"></a><span id="l2.45"> ifdef MOZ_WIDGET_GTK</span>
<a href="#l2.46"></a><span id="l2.46"> libs::</span>
<a href="#l2.47"></a><span id="l2.47"> 	$(INSTALL) $(DIST)/branding/default16.png $(DIST)/bin/chrome/icons/default</span>
<a href="#l2.48"></a><span id="l2.48"> endif</span>
<a href="#l2.49"></a><span id="l2.49"> </span>
<a href="#l2.50"></a><span id="l2.50"> ifneq (,$(filter-out WINNT Darwin,$(OS_ARCH)))</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineminus">-libs::</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/xulrunner-stub$(BIN_SUFFIX) $(DIST)/bin/$(STUBNAME)</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-endif</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-</span>
<a href="#l2.56"></a><span id="l2.56"> GARBAGE +=  $(MOZ_APP_NAME)</span>
<a href="#l2.57"></a><span id="l2.57"> GARBAGE += $(addprefix $(DIST)/bin/defaults/pref/, all.js all-instantbird.js channel-prefs.js)</span>
<a href="#l2.58"></a><span id="l2.58"> endif</span>
<a href="#l2.59"></a><span id="l2.59"> </span>
<a href="#l2.60"></a><span id="l2.60"> ifdef MOZ_WIDGET_GTK</span>
<a href="#l2.61"></a><span id="l2.61"> ICON_FILES	= \</span>
<a href="#l2.62"></a><span id="l2.62"> 		$(DIST)/branding/default16.png \</span>
<a href="#l2.63"></a><span id="l2.63"> 		$(DIST)/branding/mozicon128.png \</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineat">@@ -215,37 +205,16 @@ tools repackage:: $(PROGRAM)</span>
<a href="#l2.65"></a><span id="l2.65"> 	$(MKDIR) -p $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l2.66"></a><span id="l2.66"> 	rsync -a --exclude &quot;*.in&quot; $(srcdir)/macbuild/Contents $(DIST)/$(MOZ_MACBUNDLE_NAME) --exclude English.lproj</span>
<a href="#l2.67"></a><span id="l2.67"> 	$(MKDIR) -p $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)</span>
<a href="#l2.68"></a><span id="l2.68"> 	rsync -a --exclude &quot;*.in&quot; $(srcdir)/macbuild/Contents/Resources/English.lproj/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)</span>
<a href="#l2.69"></a><span id="l2.69"> 	sed -e &quot;s/%APP_VERSION%/$(MOZ_APP_VERSION)/&quot; -e &quot;s/%MAC_APP_NAME%/$(MAC_APP_NAME)/&quot; $(srcdir)/macbuild/Contents/Info.plist.in &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Info.plist</span>
<a href="#l2.70"></a><span id="l2.70"> 	sed -e &quot;s/%MAC_APP_NAME%/$(MAC_APP_NAME)/&quot; $(srcdir)/macbuild/Contents/Resources/English.lproj/InfoPlist.strings.in | iconv -f UTF-8 -t UTF-16 &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)/InfoPlist.strings</span>
<a href="#l2.71"></a><span id="l2.71"> 	rsync -a --exclude-from='$(srcdir)/macbuild/Contents/MacOS-files.in' $(DIST)/bin/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Resources</span>
<a href="#l2.72"></a><span id="l2.72"> 	rsync -a --include-from='$(srcdir)/macbuild/Contents/MacOS-files.in' --exclude '*' $(DIST)/bin/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/$(XR_STUB_NAME) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/instantbird</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineminus">-else</span>
<a href="#l2.76"></a><span id="l2.76"> 	$(RM) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/$(PROGRAM)</span>
<a href="#l2.77"></a><span id="l2.77"> 	rsync -aL $(PROGRAM) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineminus">-endif</span>
<a href="#l2.79"></a><span id="l2.79"> 	cp -RL $(DIST)/branding/instantbird.icns $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Resources/instantbird.icns</span>
<a href="#l2.80"></a><span id="l2.80"> 	printf APPLMOZM &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/PkgInfo</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineminus">-else</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineminus">-libs::</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/$(XULRUNNER_STUB_NAME)$(BIN_SUFFIX) $(DIST)/bin/instantbird$(BIN_SUFFIX)</span>
<a href="#l2.85"></a><span id="l2.85"> endif</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-endif</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineminus">-ifndef SKIP_COPY_XULRUNNER</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineminus">-libs::</span>
<a href="#l2.91"></a><span id="l2.91" class="difflineminus">-ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l2.92"></a><span id="l2.92" class="difflineminus">-	rsync -a --copy-unsafe-links $(LIBXUL_DIST)/XUL.framework $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Frameworks</span>
<a href="#l2.93"></a><span id="l2.93" class="difflineminus">-else</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-	$(NSINSTALL) -D $(DIST)/bin/xulrunner</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineminus">-	(cd $(LIBXUL_SDK)/bin &amp;&amp; tar $(TAR_CREATE_FLAGS) - .) | (cd $(DIST)/bin/xulrunner &amp;&amp; tar -xf -)</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineminus">-endif # cocoa</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineminus">-endif # SKIP_COPY_XULRUNNER</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineminus">-endif # LIBXUL_SDK</span>
<a href="#l2.99"></a><span id="l2.99"> </span>
<a href="#l2.100"></a><span id="l2.100"> # Note that anything you do to dist/ down here isn't going to make it into the</span>
<a href="#l2.101"></a><span id="l2.101"> # Mac build, since it's already been copied over to the .app, above.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/im/app/moz.build</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/im/app/moz.build</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -4,53 +4,52 @@</span>
<a href="#l3.4"></a><span id="l3.4"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6"> DIRS += ['profile']</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> GENERATED_INCLUDES += [</span>
<a href="#l3.9"></a><span id="l3.9">     '/build',</span>
<a href="#l3.10"></a><span id="l3.10"> ]</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-if not CONFIG['LIBXUL_SDK']:</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-    DIST_FILES += ['application.ini']</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-    GeckoProgram(CONFIG['MOZ_APP_NAME'], msvcrt='static')</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-    USE_LIBS += ['mozglue']</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-    SOURCES += ['nsMain.cpp']</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-    LOCAL_INCLUDES += [</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-        '/mozilla/toolkit/xre',</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-        '/mozilla/xpcom/base',</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-        '/mozilla/xpcom/build',</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">-    ]</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+DIST_FILES += ['application.ini']</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+GeckoProgram(CONFIG['MOZ_APP_NAME'], msvcrt='static')</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+USE_LIBS += ['mozglue']</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+SOURCES += ['nsMain.cpp']</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+LOCAL_INCLUDES += [</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+    '/mozilla/toolkit/xre',</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+    '/mozilla/xpcom/base',</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+    '/mozilla/xpcom/build',</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+]</span>
<a href="#l3.31"></a><span id="l3.31"> </span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-    DELAYLOAD_DLLS += [</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-        'mozglue.dll',</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-    ]</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+DELAYLOAD_DLLS += [</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+    'mozglue.dll',</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+]</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">-    if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineminus">-        RCINCLUDE = 'splash.rc'</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineminus">-        DEFINES['MOZ_INSTANTBIRD'] = True</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineplus">+    RCINCLUDE = 'splash.rc'</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineplus">+    DEFINES['MOZ_INSTANTBIRD'] = True</span>
<a href="#l3.45"></a><span id="l3.45"> </span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-    if CONFIG['_MSC_VER']:</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-        # Always enter a Windows program through wmain, whether or not we're</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-        # a console application.</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-        WIN32_EXE_LDFLAGS += ['-ENTRY:wmainCRTStartup']</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+if CONFIG['_MSC_VER']:</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+    # Always enter a Windows program through wmain, whether or not we're</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+    # a console application.</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+    WIN32_EXE_LDFLAGS += ['-ENTRY:wmainCRTStartup']</span>
<a href="#l3.54"></a><span id="l3.54"> </span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-    # Control the default heap size.</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-    # This is the heap returned by GetProcessHeap().</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineminus">-    # As we use the CRT heap, the default size is too large and wastes VM.</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-    #</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-    # The default heap size is 1MB on Win32.</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-    # The heap will grow if need be.</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-    #</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-    # Set it to 256k.  See bug 127069.</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineminus">-    if CONFIG['OS_ARCH'] == 'WINNT' and not CONFIG['GNU_CC']:</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-        LDFLAGS += ['/HEAP:0x40000']</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineplus">+# Control the default heap size.</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineplus">+# This is the heap returned by GetProcessHeap().</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineplus">+# As we use the CRT heap, the default size is too large and wastes VM.</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineplus">+#</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineplus">+# The default heap size is 1MB on Win32.</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineplus">+# The heap will grow if need be.</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+#</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineplus">+# Set it to 256k.  See bug 127069.</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+if CONFIG['OS_ARCH'] == 'WINNT' and not CONFIG['GNU_CC']:</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineplus">+    LDFLAGS += ['/HEAP:0x40000']</span>
<a href="#l3.75"></a><span id="l3.75"> </span>
<a href="#l3.76"></a><span id="l3.76" class="difflineminus">-    if CONFIG['MOZ_LINKER']:</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineminus">-        OS_LIBS += CONFIG['MOZ_ZLIB_LIBS']</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineplus">+if CONFIG['MOZ_LINKER']:</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineplus">+    OS_LIBS += CONFIG['MOZ_ZLIB_LIBS']</span>
<a href="#l3.80"></a><span id="l3.80"> </span>
<a href="#l3.81"></a><span id="l3.81"> DEFINES['APP_VERSION'] = CONFIG['MOZ_APP_VERSION']</span>
<a href="#l3.82"></a><span id="l3.82"> </span>
<a href="#l3.83"></a><span id="l3.83"> if CONFIG['MOZILLA_OFFICIAL']:</span>
<a href="#l3.84"></a><span id="l3.84">     DEFINES['MOZILLA_OFFICIAL'] = True</span>
<a href="#l3.85"></a><span id="l3.85"> </span>
<a href="#l3.86"></a><span id="l3.86"> DISABLE_STL_WRAPPING = True</span>
<a href="#l3.87"></a><span id="l3.87"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/im/app/nsMain.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/im/app/nsMain.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -144,82 +144,34 @@ FileExists(const char *path)</span>
<a href="#l4.4"></a><span id="l4.4">   MultiByteToWideChar(CP_UTF8, 0, path, -1, wideDir, MAX_PATH);</span>
<a href="#l4.5"></a><span id="l4.5">   DWORD fileAttrs = GetFileAttributesW(wideDir);</span>
<a href="#l4.6"></a><span id="l4.6">   return fileAttrs != INVALID_FILE_ATTRIBUTES;</span>
<a href="#l4.7"></a><span id="l4.7"> #else</span>
<a href="#l4.8"></a><span id="l4.8">   return access(path, R_OK) == 0;</span>
<a href="#l4.9"></a><span id="l4.9"> #endif</span>
<a href="#l4.10"></a><span id="l4.10"> }</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-#ifdef LIBXUL_SDK</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-#  define XPCOM_PATH &quot;xulrunner&quot; XPCOM_FILE_PATH_SEPARATOR XPCOM_DLL</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-#else</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-#  define XPCOM_PATH XPCOM_DLL</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-#endif</span>
<a href="#l4.17"></a><span id="l4.17"> static nsresult</span>
<a href="#l4.18"></a><span id="l4.18"> InitXPCOMGlue(const char *argv0, nsIFile **xreDirectory)</span>
<a href="#l4.19"></a><span id="l4.19"> {</span>
<a href="#l4.20"></a><span id="l4.20">   char exePath[MAXPATHLEN];</span>
<a href="#l4.21"></a><span id="l4.21"> </span>
<a href="#l4.22"></a><span id="l4.22">   nsresult rv = mozilla::BinaryPath::Get(argv0, exePath);</span>
<a href="#l4.23"></a><span id="l4.23">   if (NS_FAILED(rv)) {</span>
<a href="#l4.24"></a><span id="l4.24">     Output(&quot;Couldn't find the application directory.\n&quot;);</span>
<a href="#l4.25"></a><span id="l4.25">     return rv;</span>
<a href="#l4.26"></a><span id="l4.26">   }</span>
<a href="#l4.27"></a><span id="l4.27"> </span>
<a href="#l4.28"></a><span id="l4.28">   char *lastSlash = strrchr(exePath, XPCOM_FILE_PATH_SEPARATOR[0]);</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-  if (!lastSlash || (size_t(lastSlash - exePath) &gt; MAXPATHLEN - sizeof(XPCOM_PATH) - 1))</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+  if (!lastSlash || (size_t(lastSlash - exePath) &gt; MAXPATHLEN - sizeof(XPCOM_DLL) - 1))</span>
<a href="#l4.31"></a><span id="l4.31">     return NS_ERROR_FAILURE;</span>
<a href="#l4.32"></a><span id="l4.32"> </span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-  strcpy(lastSlash + 1, XPCOM_PATH);</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-  lastSlash += sizeof(XPCOM_PATH) - sizeof(XPCOM_DLL);</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+  strcpy(lastSlash + 1, XPCOM_DLL);</span>
<a href="#l4.36"></a><span id="l4.36"> </span>
<a href="#l4.37"></a><span id="l4.37">   if (!FileExists(exePath)) {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-#if defined(LIBXUL_SDK) &amp;&amp; defined(XP_MACOSX)</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-    // Check for &lt;bundle&gt;/Contents/Frameworks/XUL.framework/libxpcom.dylib</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-    bool greFound = false;</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-    CFBundleRef appBundle = CFBundleGetMainBundle();</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-    if (!appBundle)</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineminus">-      return NS_ERROR_FAILURE;</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineminus">-    CFURLRef fwurl = CFBundleCopyPrivateFrameworksURL(appBundle);</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineminus">-    CFURLRef absfwurl = nullptr;</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-    if (fwurl) {</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-      absfwurl = CFURLCopyAbsoluteURL(fwurl);</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineminus">-      CFRelease(fwurl);</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-    }</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-    if (absfwurl) {</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-      CFURLRef xulurl =</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-        CFURLCreateCopyAppendingPathComponent(nullptr, absfwurl,</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineminus">-                                              CFSTR(&quot;XUL.framework&quot;),</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-                                              true);</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineminus">-      if (xulurl) {</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineminus">-        CFURLRef xpcomurl =</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineminus">-          CFURLCreateCopyAppendingPathComponent(nullptr, xulurl,</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineminus">-                                                CFSTR(&quot;libxpcom.dylib&quot;),</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineminus">-                                                false);</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineminus">-</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineminus">-        if (xpcomurl) {</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineminus">-          if (CFURLGetFileSystemRepresentation(xpcomurl, true,</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineminus">-                                               (UInt8*) exePath,</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineminus">-                                               sizeof(exePath)) &amp;&amp;</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineminus">-              access(tbuffer, R_OK | X_OK) == 0) {</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineminus">-            if (realpath(tbuffer, exePath)) {</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineminus">-              greFound = true;</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-            }</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-          }</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-          CFRelease(xpcomurl);</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-        }</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-        CFRelease(xulurl);</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineminus">-      }</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineminus">-      CFRelease(absfwurl);</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-    }</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineminus">-  }</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineminus">-  if (!greFound) {</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineminus">-#endif</span>
<a href="#l4.80"></a><span id="l4.80">     Output(&quot;Could not find the Mozilla runtime.\n&quot;);</span>
<a href="#l4.81"></a><span id="l4.81">     return NS_ERROR_FAILURE;</span>
<a href="#l4.82"></a><span id="l4.82">   }</span>
<a href="#l4.83"></a><span id="l4.83"> </span>
<a href="#l4.84"></a><span id="l4.84">   // We do this because of data in bug 771745</span>
<a href="#l4.85"></a><span id="l4.85">   XPCOMGlueEnablePreload();</span>
<a href="#l4.86"></a><span id="l4.86"> </span>
<a href="#l4.87"></a><span id="l4.87">   rv = XPCOMGlueStartup(exePath);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/im/installer/Makefile.in</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/im/installer/Makefile.in</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -106,19 +106,17 @@ ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l5.4"></a><span id="l5.4"> MOZ_PKG_MAC_DSSTORE=branding/dsstore</span>
<a href="#l5.5"></a><span id="l5.5"> MOZ_PKG_MAC_BACKGROUND=branding/background.png</span>
<a href="#l5.6"></a><span id="l5.6"> MOZ_PKG_MAC_ICON=branding/disk.icns</span>
<a href="#l5.7"></a><span id="l5.7"> MOZ_PKG_MAC_EXTRA=--symlink &quot;/Applications:/ &quot;</span>
<a href="#l5.8"></a><span id="l5.8"> endif</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10"> NON_OMNIJAR_FILES =</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-ifndef LIBXUL_SDK</span>
<a href="#l5.13"></a><span id="l5.13"> INSTALL_SDK = 1</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-endif</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16"> GENERATE_CACHE=1</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18"> include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/signing.mk</span>
<a href="#l5.19"></a><span id="l5.19"> include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/packager.mk</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21"> ifeq (Darwin, $(OS_ARCH))</span>
<a href="#l5.22"></a><span id="l5.22"> BINPATH = $(_BINPATH)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/app.mozbuild</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/app.mozbuild</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -2,18 +2,17 @@</span>
<a href="#l6.4"></a><span id="l6.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.5"></a><span id="l6.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.6"></a><span id="l6.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> include('/mailnews/mailnews.mozbuild')</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10"> DIRS += ['/mail/components']</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-if not CONFIG['LIBXUL_SDK']:</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-    include('/toolkit/toolkit.mozbuild')</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+include('/toolkit/toolkit.mozbuild')</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16"> if CONFIG['MOZ_EXTENSIONS']:</span>
<a href="#l6.17"></a><span id="l6.17">     DIRS += ['/extensions']</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19"> DIRS += ['/%s' % CONFIG['MOZ_BRANDING_DIRECTORY']]</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21"> if CONFIG['MOZ_COMPOSER']:</span>
<a href="#l6.22"></a><span id="l6.22">     DIRS += ['/editor/ui']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/app/Makefile.in</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/app/Makefile.in</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -18,19 +18,16 @@ DEFINES += -DMOZ_SOURCE_REPO=&quot;$(SOURCE_R</span>
<a href="#l7.4"></a><span id="l7.4"> endif</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6"> DEFINES += \</span>
<a href="#l7.7"></a><span id="l7.7">   -DTHUNDERBIRD_ICO='&quot;$(DIST)/branding/thunderbird.ico&quot;' \</span>
<a href="#l7.8"></a><span id="l7.8">   -DGRE_MILESTONE=$(GRE_MILESTONE) \</span>
<a href="#l7.9"></a><span id="l7.9">   -DGRE_BUILDID=$(GRE_BUILDID) \</span>
<a href="#l7.10"></a><span id="l7.10">    $(NULL)</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-include $(topsrcdir)/config/rules.mk</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-else</span>
<a href="#l7.15"></a><span id="l7.15"> # Build a binary bootstrapping with XRE_main</span>
<a href="#l7.16"></a><span id="l7.16"> </span>
<a href="#l7.17"></a><span id="l7.17"> ifndef MOZ_WINCONSOLE</span>
<a href="#l7.18"></a><span id="l7.18"> ifdef MOZ_DEBUG</span>
<a href="#l7.19"></a><span id="l7.19"> MOZ_WINCONSOLE = 1</span>
<a href="#l7.20"></a><span id="l7.20"> else</span>
<a href="#l7.21"></a><span id="l7.21"> MOZ_WINCONSOLE = 0</span>
<a href="#l7.22"></a><span id="l7.22"> endif</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineat">@@ -78,18 +75,16 @@ endif</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25"> ifneq ($(OS_ARCH),WINNT)</span>
<a href="#l7.26"></a><span id="l7.26"> libs::</span>
<a href="#l7.27"></a><span id="l7.27"> 	cp -p $(MOZ_APP_NAME)$(BIN_SUFFIX) $(DIST)/bin/$(MOZ_APP_NAME)-bin$(BIN_SUFFIX)</span>
<a href="#l7.28"></a><span id="l7.28"> </span>
<a href="#l7.29"></a><span id="l7.29"> GARBAGE += $(addprefix $(DIST)/bin/defaults/pref/, all.js all-thunderbird.js mailnews.js)</span>
<a href="#l7.30"></a><span id="l7.30"> endif # ! WinNT</span>
<a href="#l7.31"></a><span id="l7.31"> </span>
<a href="#l7.32"></a><span id="l7.32" class="difflineminus">-endif # LIBXUL_SDK</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-</span>
<a href="#l7.34"></a><span id="l7.34"> ifneq (,$(filter windows,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l7.35"></a><span id="l7.35"> ICON_SUFFIX=.ico</span>
<a href="#l7.36"></a><span id="l7.36"> </span>
<a href="#l7.37"></a><span id="l7.37"> DESKTOP_ICONS = \</span>
<a href="#l7.38"></a><span id="l7.38"> 	abcardWindow \</span>
<a href="#l7.39"></a><span id="l7.39"> 	addressbookWindow \</span>
<a href="#l7.40"></a><span id="l7.40"> 	msgcomposeWindow \</span>
<a href="#l7.41"></a><span id="l7.41"> 	$(NULL)</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineat">@@ -112,22 +107,20 @@ endif</span>
<a href="#l7.43"></a><span id="l7.43"> ifdef MOZ_WIDGET_GTK</span>
<a href="#l7.44"></a><span id="l7.44"> libs::</span>
<a href="#l7.45"></a><span id="l7.45"> 	$(INSTALL) $(IFLAGS1) $(DIST)/branding/default* $(DIST)/bin/chrome/icons/default</span>
<a href="#l7.46"></a><span id="l7.46"> endif</span>
<a href="#l7.47"></a><span id="l7.47"> </span>
<a href="#l7.48"></a><span id="l7.48"> libs:: $(srcdir)/profile/prefs.js</span>
<a href="#l7.49"></a><span id="l7.49"> 	$(INSTALL) $(IFLAGS1) $^ $(DIST)/bin/defaults/profile</span>
<a href="#l7.50"></a><span id="l7.50"> </span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-ifndef LIBXUL_SDK</span>
<a href="#l7.52"></a><span id="l7.52"> # channel-prefs.js is handled separate from other prefs due to bug 756325</span>
<a href="#l7.53"></a><span id="l7.53"> libs:: $(srcdir)/profile/channel-prefs.js</span>
<a href="#l7.54"></a><span id="l7.54"> 	$(NSINSTALL) -D $(DIST)/bin/defaults/pref</span>
<a href="#l7.55"></a><span id="l7.55"> 	$(call py_action,preprocessor,-Fsubstitution $(PREF_PPFLAGS) $(ACDEFINES) $^ -o $(DIST)/bin/defaults/pref/channel-prefs.js)</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineminus">-endif</span>
<a href="#l7.57"></a><span id="l7.57"> </span>
<a href="#l7.58"></a><span id="l7.58"> libs:: $(srcdir)/blocklist.xml</span>
<a href="#l7.59"></a><span id="l7.59"> 	$(INSTALL) $(IFLAGS1) $^ $(DIST)/bin</span>
<a href="#l7.60"></a><span id="l7.60"> </span>
<a href="#l7.61"></a><span id="l7.61"> ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l7.62"></a><span id="l7.62"> </span>
<a href="#l7.63"></a><span id="l7.63"> MAC_APP_NAME = $(MOZ_APP_DISPLAYNAME)</span>
<a href="#l7.64"></a><span id="l7.64"> </span>
<a href="#l7.65"></a><span id="l7.65" class="difflineat">@@ -153,39 +146,18 @@ tools repackage:: $(PROGRAM)</span>
<a href="#l7.66"></a><span id="l7.66"> 	$(MKDIR) -p $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l7.67"></a><span id="l7.67"> 	rsync -a --exclude '*.in' $(srcdir)/macbuild/Contents $(DIST)/$(MOZ_MACBUNDLE_NAME) --exclude English.lproj</span>
<a href="#l7.68"></a><span id="l7.68"> 	$(MKDIR) -p $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)</span>
<a href="#l7.69"></a><span id="l7.69"> 	rsync -a --exclude '*.in' $(srcdir)/macbuild/Contents/Resources/English.lproj/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)</span>
<a href="#l7.70"></a><span id="l7.70"> 	sed -e 's/%APP_VERSION%/$(MOZ_APP_VERSION)/' -e 's/%MAC_APP_NAME%/$(MAC_APP_NAME)/' -e 's/%LOWER_MAC_APP_NAME%/$(LOWER_MAC_APP_NAME)/' $(srcdir)/macbuild/Contents/Info.plist.in &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Info.plist</span>
<a href="#l7.71"></a><span id="l7.71"> 	sed -e 's/%MAC_APP_NAME%/$(MAC_APP_NAME)/' $(srcdir)/macbuild/Contents/Resources/English.lproj/InfoPlist.strings.in | iconv -f UTF-8 -t UTF-16 &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)/InfoPlist.strings</span>
<a href="#l7.72"></a><span id="l7.72"> 	rsync -a --exclude-from='$(srcdir)/macbuild/Contents/MacOS-files.in' $(DIST)/bin/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Resources</span>
<a href="#l7.73"></a><span id="l7.73"> 	rsync -a --include-from='$(srcdir)/macbuild/Contents/MacOS-files.in' --exclude '*' $(DIST)/bin/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/$(XR_STUB_NAME) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/thunderbird</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineminus">-else</span>
<a href="#l7.77"></a><span id="l7.77"> 	$(RM) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/$(PROGRAM)</span>
<a href="#l7.78"></a><span id="l7.78"> 	rsync -aL $(PROGRAM) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l7.79"></a><span id="l7.79" class="difflineminus">-endif</span>
<a href="#l7.80"></a><span id="l7.80"> 	$(MKDIR) -p $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Library/Spotlight</span>
<a href="#l7.81"></a><span id="l7.81"> 	rsync -a --copy-unsafe-links $(DIST)/package/thunderbird.mdimporter $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Library/Spotlight</span>
<a href="#l7.82"></a><span id="l7.82"> 	cp -RL $(DIST)/branding/thunderbird.icns $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Resources/thunderbird.icns</span>
<a href="#l7.83"></a><span id="l7.83"> 	printf APPLMOZM &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/PkgInfo</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineminus">-else</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineminus">-libs::</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/$(XULRUNNER_STUB_NAME)$(BIN_SUFFIX) $(DIST)/bin/thunderbird$(BIN_SUFFIX)</span>
<a href="#l7.88"></a><span id="l7.88"> endif</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineminus">-endif</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineminus">-</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineminus">-ifndef SKIP_COPY_XULRUNNER</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineminus">-libs::</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineminus">-ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineminus">-	rsync -a --copy-unsafe-links $(LIBXUL_DIST)/XUL.framework $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Frameworks</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineminus">-else</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineminus">-	$(NSINSTALL) -D $(DIST)/bin/xulrunner</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineminus">-	(cd $(LIBXUL_SDK)/bin &amp;&amp; tar $(TAR_CREATE_FLAGS) - .) | (cd $(DIST)/bin/xulrunner &amp;&amp; tar -xf -)</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineminus">-endif # cocoa</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineminus">-endif # SKIP_COPY_XULRUNNER</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineminus">-endif # LIBXUL_SDK</span>
<a href="#l7.102"></a><span id="l7.102"> </span>
<a href="#l7.103"></a><span id="l7.103"> # Note that anything you do to dist/ down here isn't going to make it into the</span>
<a href="#l7.104"></a><span id="l7.104"> # Mac build, since it's already been copied over to the .app, above.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/app/moz.build</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/app/moz.build</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -4,52 +4,51 @@</span>
<a href="#l8.4"></a><span id="l8.4"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> DIRS += ['profile']</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> GENERATED_INCLUDES += [</span>
<a href="#l8.9"></a><span id="l8.9">     '/build',</span>
<a href="#l8.10"></a><span id="l8.10"> ]</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-if not CONFIG['LIBXUL_SDK']:</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-    GeckoProgram(CONFIG['MOZ_APP_NAME'], msvcrt='static')</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-    USE_LIBS += ['mozglue']</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-    SOURCES += ['nsMailApp.cpp']</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-    LOCAL_INCLUDES += [</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-        '/mozilla/toolkit/xre',</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-        '/mozilla/xpcom/base',</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-        '/mozilla/xpcom/build',</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineminus">-    ]</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+GeckoProgram(CONFIG['MOZ_APP_NAME'], msvcrt='static')</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+USE_LIBS += ['mozglue']</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+SOURCES += ['nsMailApp.cpp']</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+LOCAL_INCLUDES += [</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+    '/mozilla/toolkit/xre',</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+    '/mozilla/xpcom/base',</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+    '/mozilla/xpcom/build',</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+]</span>
<a href="#l8.29"></a><span id="l8.29"> </span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-    DELAYLOAD_DLLS += [</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-        'mozglue.dll',</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-    ]</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+DELAYLOAD_DLLS += [</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineplus">+    'mozglue.dll',</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+]</span>
<a href="#l8.36"></a><span id="l8.36"> </span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-    if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-        RCINCLUDE = 'splash.rc'</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineminus">-        DEFINES['MOZ_THUNDERBIRD'] = True</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+    RCINCLUDE = 'splash.rc'</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+    DEFINES['MOZ_THUNDERBIRD'] = True</span>
<a href="#l8.43"></a><span id="l8.43"> </span>
<a href="#l8.44"></a><span id="l8.44" class="difflineminus">-    if CONFIG['_MSC_VER']:</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineminus">-        # Always enter a Windows program through wmain, whether or not we're</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineminus">-        # a console application.</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-        WIN32_EXE_LDFLAGS += ['-ENTRY:wmainCRTStartup']</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+if CONFIG['_MSC_VER']:</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+    # Always enter a Windows program through wmain, whether or not we're</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+    # a console application.</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+    WIN32_EXE_LDFLAGS += ['-ENTRY:wmainCRTStartup']</span>
<a href="#l8.52"></a><span id="l8.52"> </span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-    # Control the default heap size.</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-    # This is the heap returned by GetProcessHeap().</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-    # As we use the CRT heap, the default size is too large and wastes VM.</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-    #</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineminus">-    # The default heap size is 1MB on Win32.</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineminus">-    # The heap will grow if need be.</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-    #</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-    # Set it to 256k.  See bug 127069.</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineminus">-    if CONFIG['OS_ARCH'] == 'WINNT' and not CONFIG['GNU_CC']:</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineminus">-        LDFLAGS += ['/HEAP:0x40000']</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineplus">+# Control the default heap size.</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+# This is the heap returned by GetProcessHeap().</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineplus">+# As we use the CRT heap, the default size is too large and wastes VM.</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineplus">+#</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineplus">+# The default heap size is 1MB on Win32.</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineplus">+# The heap will grow if need be.</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineplus">+#</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineplus">+# Set it to 256k.  See bug 127069.</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+if CONFIG['OS_ARCH'] == 'WINNT' and not CONFIG['GNU_CC']:</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineplus">+    LDFLAGS += ['/HEAP:0x40000']</span>
<a href="#l8.73"></a><span id="l8.73"> </span>
<a href="#l8.74"></a><span id="l8.74" class="difflineminus">-    if CONFIG['MOZ_LINKER']:</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-        OS_LIBS += CONFIG['MOZ_ZLIB_LIBS']</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+if CONFIG['MOZ_LINKER']:</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+    OS_LIBS += CONFIG['MOZ_ZLIB_LIBS']</span>
<a href="#l8.78"></a><span id="l8.78"> </span>
<a href="#l8.79"></a><span id="l8.79"> DEFINES['APP_VERSION'] = CONFIG['MOZ_APP_VERSION']</span>
<a href="#l8.80"></a><span id="l8.80"> </span>
<a href="#l8.81"></a><span id="l8.81"> if CONFIG['MOZILLA_OFFICIAL']:</span>
<a href="#l8.82"></a><span id="l8.82">     DEFINES['MOZILLA_OFFICIAL'] = True</span>
<a href="#l8.83"></a><span id="l8.83"> </span>
<a href="#l8.84"></a><span id="l8.84"> DISABLE_STL_WRAPPING = True</span>
<a href="#l8.85"></a><span id="l8.85"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/app/nsMailApp.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/app/nsMailApp.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -205,82 +205,34 @@ FileExists(const char *path)</span>
<a href="#l9.4"></a><span id="l9.4">   MultiByteToWideChar(CP_UTF8, 0, path, -1, wideDir, MAX_PATH);</span>
<a href="#l9.5"></a><span id="l9.5">   DWORD fileAttrs = GetFileAttributesW(wideDir);</span>
<a href="#l9.6"></a><span id="l9.6">   return fileAttrs != INVALID_FILE_ATTRIBUTES;</span>
<a href="#l9.7"></a><span id="l9.7"> #else</span>
<a href="#l9.8"></a><span id="l9.8">   return access(path, R_OK) == 0;</span>
<a href="#l9.9"></a><span id="l9.9"> #endif</span>
<a href="#l9.10"></a><span id="l9.10"> }</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-#ifdef LIBXUL_SDK</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-#  define XPCOM_PATH &quot;xulrunner&quot; XPCOM_FILE_PATH_SEPARATOR XPCOM_DLL</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-#else</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-#  define XPCOM_PATH XPCOM_DLL</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-#endif</span>
<a href="#l9.17"></a><span id="l9.17"> static nsresult</span>
<a href="#l9.18"></a><span id="l9.18"> InitXPCOMGlue(const char *argv0, nsIFile **xreDirectory)</span>
<a href="#l9.19"></a><span id="l9.19"> {</span>
<a href="#l9.20"></a><span id="l9.20">   char exePath[MAXPATHLEN];</span>
<a href="#l9.21"></a><span id="l9.21"> </span>
<a href="#l9.22"></a><span id="l9.22">   nsresult rv = mozilla::BinaryPath::Get(argv0, exePath);</span>
<a href="#l9.23"></a><span id="l9.23">   if (NS_FAILED(rv)) {</span>
<a href="#l9.24"></a><span id="l9.24">     Output(&quot;Couldn't find the application directory.\n&quot;);</span>
<a href="#l9.25"></a><span id="l9.25">     return rv;</span>
<a href="#l9.26"></a><span id="l9.26">   }</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28">   char *lastSlash = strrchr(exePath, XPCOM_FILE_PATH_SEPARATOR[0]);</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineminus">-  if (!lastSlash || (size_t(lastSlash - exePath) &gt; MAXPATHLEN - sizeof(XPCOM_PATH) - 1))</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+  if (!lastSlash || (size_t(lastSlash - exePath) &gt; MAXPATHLEN - sizeof(XPCOM_DLL) - 1))</span>
<a href="#l9.31"></a><span id="l9.31">     return NS_ERROR_FAILURE;</span>
<a href="#l9.32"></a><span id="l9.32"> </span>
<a href="#l9.33"></a><span id="l9.33" class="difflineminus">-  strcpy(lastSlash + 1, XPCOM_PATH);</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineminus">-  lastSlash += sizeof(XPCOM_PATH) - sizeof(XPCOM_DLL);</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+  strcpy(lastSlash + 1, XPCOM_DLL);</span>
<a href="#l9.36"></a><span id="l9.36"> </span>
<a href="#l9.37"></a><span id="l9.37">   if (!FileExists(exePath)) {</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineminus">-#if defined(LIBXUL_SDK) &amp;&amp; defined(XP_MACOSX)</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-    // Check for &lt;bundle&gt;/Contents/Frameworks/XUL.framework/libxpcom.dylib</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineminus">-    bool greFound = false;</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineminus">-    CFBundleRef appBundle = CFBundleGetMainBundle();</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineminus">-    if (!appBundle)</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineminus">-      return NS_ERROR_FAILURE;</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineminus">-    CFURLRef fwurl = CFBundleCopyPrivateFrameworksURL(appBundle);</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineminus">-    CFURLRef absfwurl = nullptr;</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineminus">-    if (fwurl) {</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineminus">-      absfwurl = CFURLCopyAbsoluteURL(fwurl);</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineminus">-      CFRelease(fwurl);</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineminus">-    }</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineminus">-    if (absfwurl) {</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineminus">-      CFURLRef xulurl =</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineminus">-        CFURLCreateCopyAppendingPathComponent(nullptr, absfwurl,</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineminus">-                                              CFSTR(&quot;XUL.framework&quot;),</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineminus">-                                              true);</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineminus">-</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineminus">-      if (xulurl) {</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-        CFURLRef xpcomurl =</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineminus">-          CFURLCreateCopyAppendingPathComponent(nullptr, xulurl,</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineminus">-                                                CFSTR(&quot;libxpcom.dylib&quot;),</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineminus">-                                                false);</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineminus">-</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineminus">-        if (xpcomurl) {</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineminus">-          if (CFURLGetFileSystemRepresentation(xpcomurl, true,</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineminus">-                                               (UInt8*) exePath,</span>
<a href="#l9.65"></a><span id="l9.65" class="difflineminus">-                                               sizeof(exePath)) &amp;&amp;</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineminus">-              access(tbuffer, R_OK | X_OK) == 0) {</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineminus">-            if (realpath(tbuffer, exePath)) {</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineminus">-              greFound = true;</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineminus">-            }</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineminus">-          }</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineminus">-          CFRelease(xpcomurl);</span>
<a href="#l9.72"></a><span id="l9.72" class="difflineminus">-        }</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineminus">-        CFRelease(xulurl);</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineminus">-      }</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-      CFRelease(absfwurl);</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineminus">-    }</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineminus">-  }</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineminus">-  if (!greFound) {</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineminus">-#endif</span>
<a href="#l9.80"></a><span id="l9.80">     Output(&quot;Could not find the Mozilla runtime.\n&quot;);</span>
<a href="#l9.81"></a><span id="l9.81">     return NS_ERROR_FAILURE;</span>
<a href="#l9.82"></a><span id="l9.82">   }</span>
<a href="#l9.83"></a><span id="l9.83"> </span>
<a href="#l9.84"></a><span id="l9.84">   // We do this because of data in bug 771745</span>
<a href="#l9.85"></a><span id="l9.85">   XPCOMGlueEnablePreload();</span>
<a href="#l9.86"></a><span id="l9.86"> </span>
<a href="#l9.87"></a><span id="l9.87">   rv = XPCOMGlueStartup(exePath);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/installer/Makefile.in</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/installer/Makefile.in</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -106,19 +106,17 @@ ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l10.4"></a><span id="l10.4"> MOZ_PKG_MAC_DSSTORE=branding/dsstore</span>
<a href="#l10.5"></a><span id="l10.5"> MOZ_PKG_MAC_BACKGROUND=branding/background.png</span>
<a href="#l10.6"></a><span id="l10.6"> MOZ_PKG_MAC_ICON=branding/disk.icns</span>
<a href="#l10.7"></a><span id="l10.7"> MOZ_PKG_MAC_EXTRA=--symlink '/Applications:/ '</span>
<a href="#l10.8"></a><span id="l10.8"> endif</span>
<a href="#l10.9"></a><span id="l10.9"> </span>
<a href="#l10.10"></a><span id="l10.10"> NON_OMNIJAR_FILES = defaults/messenger/mailViews.dat</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-ifndef LIBXUL_SDK</span>
<a href="#l10.13"></a><span id="l10.13"> INSTALL_SDK = 1</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-endif</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16"> include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/signing.mk</span>
<a href="#l10.17"></a><span id="l10.17"> include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/packager.mk</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> ifeq (Darwin, $(OS_ARCH))</span>
<a href="#l10.20"></a><span id="l10.20"> BINPATH = $(_BINPATH)</span>
<a href="#l10.21"></a><span id="l10.21"> DEFINES += -DAPPNAME=$(_APPNAME)</span>
<a href="#l10.22"></a><span id="l10.22"> else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/suite/app.mozbuild</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/suite/app.mozbuild</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,17 +1,16 @@</span>
<a href="#l11.4"></a><span id="l11.4"> # vim: set filetype=python:</span>
<a href="#l11.5"></a><span id="l11.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9"> include('/mailnews/mailnews.mozbuild')</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">-if not CONFIG['LIBXUL_SDK']:</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    include('/toolkit/toolkit.mozbuild')</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+include('/toolkit/toolkit.mozbuild')</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15"> if CONFIG['MOZ_EXTENSIONS']:</span>
<a href="#l11.16"></a><span id="l11.16">     DIRS += ['/extensions']</span>
<a href="#l11.17"></a><span id="l11.17"> </span>
<a href="#l11.18"></a><span id="l11.18"> if CONFIG['MOZ_COMPOSER']:</span>
<a href="#l11.19"></a><span id="l11.19">     DIRS += ['/editor/ui']</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21"> DIRS += ['/%s' % CONFIG['MOZ_BRANDING_DIRECTORY']]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/suite/app/Makefile.in</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/suite/app/Makefile.in</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -4,19 +4,16 @@</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> AB_CD = $(MOZ_UI_LOCALE) </span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7"> DEFINES += \</span>
<a href="#l12.8"></a><span id="l12.8"> 	-DSEAMONKEY_ICO=\&quot;$(DIST)/branding/seamonkey.ico\&quot; \</span>
<a href="#l12.9"></a><span id="l12.9"> 	-DHTML_FILE_ICO=\&quot;$(DIST)/branding/html-file.ico\&quot; \</span>
<a href="#l12.10"></a><span id="l12.10"> 	$(NULL)</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-include $(topsrcdir)/config/rules.mk</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-else</span>
<a href="#l12.15"></a><span id="l12.15"> # Build a binary bootstrapping with XRE_main</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17"> ifndef MOZ_WINCONSOLE</span>
<a href="#l12.18"></a><span id="l12.18"> ifdef MOZ_DEBUG</span>
<a href="#l12.19"></a><span id="l12.19"> MOZ_WINCONSOLE = 1</span>
<a href="#l12.20"></a><span id="l12.20"> else</span>
<a href="#l12.21"></a><span id="l12.21"> MOZ_WINCONSOLE = 0</span>
<a href="#l12.22"></a><span id="l12.22"> endif</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineat">@@ -48,18 +45,16 @@ endif</span>
<a href="#l12.24"></a><span id="l12.24"> </span>
<a href="#l12.25"></a><span id="l12.25"> ifneq ($(OS_ARCH),WINNT)</span>
<a href="#l12.26"></a><span id="l12.26"> </span>
<a href="#l12.27"></a><span id="l12.27"> libs:: </span>
<a href="#l12.28"></a><span id="l12.28"> 	cp -p $(MOZ_APP_NAME)$(BIN_SUFFIX) $(DIST)/bin/$(MOZ_APP_NAME)-bin$(BIN_SUFFIX)</span>
<a href="#l12.29"></a><span id="l12.29"> </span>
<a href="#l12.30"></a><span id="l12.30"> endif</span>
<a href="#l12.31"></a><span id="l12.31"> </span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-endif # LIBXUL_SDK</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineminus">-</span>
<a href="#l12.34"></a><span id="l12.34"> libs:: blocklist.xml</span>
<a href="#l12.35"></a><span id="l12.35"> 	$(INSTALL) $(IFLAGS1) $^ $(DIST)/bin</span>
<a href="#l12.36"></a><span id="l12.36"> </span>
<a href="#l12.37"></a><span id="l12.37"> ifneq (,$(filter-out WINNT Darwin,$(OS_ARCH)))</span>
<a href="#l12.38"></a><span id="l12.38"> $(MOZ_APP_NAME).1: seamonkey.man.in $(GLOBAL_DEPS) $(DEPTH)/config/autoconf.mk</span>
<a href="#l12.39"></a><span id="l12.39"> 	@sed -e &quot;s|\@bindir\@|$(bindir)|g&quot; -e &quot;s|\@mozappdir\@|$(mozappdir)|g&quot; \</span>
<a href="#l12.40"></a><span id="l12.40"> 		-e &quot;s|\@MOZ_APP_DISPLAYNAME\@|$(MOZ_APP_DISPLAYNAME)|g&quot; \</span>
<a href="#l12.41"></a><span id="l12.41"> 		-e &quot;s|\@MOZ_APP_NAME\@|$(MOZ_APP_NAME)|g&quot; \</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineat">@@ -134,37 +129,16 @@ tools:: $(PROGRAM)</span>
<a href="#l12.43"></a><span id="l12.43"> 	rsync -a --exclude CVS --exclude &quot;*.in&quot; $(srcdir)/macbuild/Contents $(DIST)/$(MOZ_MACBUNDLE_NAME) --exclude English.lproj</span>
<a href="#l12.44"></a><span id="l12.44"> 	mkdir -p $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)</span>
<a href="#l12.45"></a><span id="l12.45"> 	rsync -a --exclude CVS --exclude &quot;*.in&quot; $(srcdir)/macbuild/Contents/Resources/English.lproj/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)</span>
<a href="#l12.46"></a><span id="l12.46"> 	sed -e &quot;s/\@MOZ_APP_NAME\@/$(MOZ_APP_NAME)/&quot; -e &quot;s/\@MAC_APP_NAME\@/$(MAC_APP_NAME)/&quot; -e &quot;s/\@MOZ_APP_DISPLAYNAME\@/$(MOZ_APP_DISPLAYNAME)/&quot; -e &quot;s/\@MOZ_APP_VERSION\@/$(MOZ_APP_VERSION)/&quot; $(srcdir)/macbuild/Contents/Info.plist.in &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Info.plist</span>
<a href="#l12.47"></a><span id="l12.47"> 	sed -e &quot;s/\@MOZ_APP_NAME\@/$(MOZ_APP_NAME)/&quot; -e &quot;s/\@MAC_APP_NAME\@/$(MAC_APP_NAME)/&quot; -e &quot;s/\@MOZ_APP_DISPLAYNAME\@/$(MOZ_APP_DISPLAYNAME)/&quot; -e &quot;s/\@MOZ_APP_VERSION\@/$(MOZ_APP_VERSION)/&quot; $(srcdir)/macbuild/Contents/Resources/English.lproj/InfoPlist.strings.in | iconv -f UTF-8 -t UTF-16 &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/$(LPROJ)/InfoPlist.strings</span>
<a href="#l12.48"></a><span id="l12.48"> 	rsync -a --exclude-from='$(srcdir)/macbuild/Contents/MacOS-files.in' $(DIST)/bin/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Resources</span>
<a href="#l12.49"></a><span id="l12.49"> 	rsync -a --include-from='$(srcdir)/macbuild/Contents/MacOS-files.in' --exclude '*' $(DIST)/bin/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l12.50"></a><span id="l12.50"> 	rm -f $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/$(APPFILES)/mangle $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/$(APPFILES)/shlibsign</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/$(XR_STUB_NAME) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/seamonkey</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-else</span>
<a href="#l12.54"></a><span id="l12.54"> 	rm -f $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/$(PROGRAM)</span>
<a href="#l12.55"></a><span id="l12.55"> 	rsync -aL $(PROGRAM) $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-endif</span>
<a href="#l12.57"></a><span id="l12.57"> 	-cp -L $(DIST)/bin/mangle $(DIST)/bin/shlibsign $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/$(APPFILES)</span>
<a href="#l12.58"></a><span id="l12.58"> 	cp -RL $(DIST)/branding/icons/*.icns $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Resources/</span>
<a href="#l12.59"></a><span id="l12.59"> 	printf APPLMOZZ &gt; $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/PkgInfo</span>
<a href="#l12.60"></a><span id="l12.60"> #       remove CVS dirs from packaged app</span>
<a href="#l12.61"></a><span id="l12.61"> 	find $(DIST)/$(MOZ_MACBUNDLE_NAME) -type d -name &quot;CVS&quot; -prune -exec rm -rf {} \;</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineminus">-else</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineminus">-libs::</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineminus">-	cp $(LIBXUL_DIST)/bin/$(XULRUNNER_STUB_NAME)$(BIN_SUFFIX) $(DIST)/bin/seamonkey$(BIN_SUFFIX)</span>
<a href="#l12.66"></a><span id="l12.66"> endif</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineminus">-endif</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineminus">-</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineminus">-ifndef SKIP_COPY_XULRUNNER</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineminus">-libs::</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineminus">-ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineminus">-	rsync -a --copy-unsafe-links $(LIBXUL_DIST)/XUL.framework $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/Frameworks</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineminus">-else</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineminus">-	$(NSINSTALL) -D $(DIST)/bin/xulrunner</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineminus">-	(cd $(LIBXUL_SDK)/bin &amp;&amp; tar $(TAR_CREATE_FLAGS) - .) | (cd $(DIST)/bin/xulrunner &amp;&amp; tar -xf -)</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineminus">-endif # cocoa</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineminus">-endif # SKIP_COPY_XULRUNNER</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineminus">-endif # LIBXUL_SDK</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/suite/app/moz.build</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/suite/app/moz.build</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -1,48 +1,47 @@</span>
<a href="#l13.4"></a><span id="l13.4"> # vim: set filetype=python:</span>
<a href="#l13.5"></a><span id="l13.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.6"></a><span id="l13.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.7"></a><span id="l13.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9" class="difflineminus">-if not CONFIG['LIBXUL_SDK']:</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineminus">-    GeckoProgram(CONFIG['MOZ_APP_NAME'], msvcrt='static')</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineminus">-    USE_LIBS += ['mozglue']</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    SOURCES += ['nsSuiteApp.cpp']</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-    LOCAL_INCLUDES += [</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-        '/mozilla/toolkit/xre',</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-        '/mozilla/xpcom/base',</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-        '/mozilla/xpcom/build',</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+GeckoProgram(CONFIG['MOZ_APP_NAME'], msvcrt='static')</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+USE_LIBS += ['mozglue']</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+SOURCES += ['nsSuiteApp.cpp']</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+LOCAL_INCLUDES += [</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+    '/mozilla/toolkit/xre',</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+    '/mozilla/xpcom/base',</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+    '/mozilla/xpcom/build',</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+]</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+GENERATED_INCLUDES += ['/build']</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineplus">+</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineplus">+if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineplus">+    RCINCLUDE = 'splash.rc'</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineplus">+    DEFINES['MOZ_SUITE'] = True</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+    DELAYLOAD_DLLS += [</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+        'mozglue.dll',</span>
<a href="#l13.33"></a><span id="l13.33">     ]</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineminus">-    GENERATED_INCLUDES += ['/build']</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineminus">-</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineminus">-    if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineminus">-        RCINCLUDE = 'splash.rc'</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-        DEFINES['MOZ_SUITE'] = True</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineminus">-</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineminus">-        DELAYLOAD_DLLS += [</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineminus">-            'mozglue.dll',</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineminus">-        ]</span>
<a href="#l13.43"></a><span id="l13.43"> </span>
<a href="#l13.44"></a><span id="l13.44" class="difflineminus">-    if CONFIG['_MSC_VER']:</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineminus">-        # Always enter a Windows program through wmain, whether or not we're</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineminus">-        # a console application.</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineminus">-        WIN32_EXE_LDFLAGS += ['-ENTRY:wmainCRTStartup']</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+if CONFIG['_MSC_VER']:</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+    # Always enter a Windows program through wmain, whether or not we're</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+    # a console application.</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+    WIN32_EXE_LDFLAGS += ['-ENTRY:wmainCRTStartup']</span>
<a href="#l13.52"></a><span id="l13.52"> </span>
<a href="#l13.53"></a><span id="l13.53" class="difflineminus">-    # Control the default heap size.</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineminus">-    # This is the heap returned by GetProcessHeap().</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineminus">-    # As we use the CRT heap, the default size is too large and wastes VM.</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineminus">-    #</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineminus">-    # The default heap size is 1MB on Win32.</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineminus">-    # The heap will grow if need be.</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineminus">-    #</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineminus">-    # Set it to 256k.  See bug 127069.</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineminus">-    if CONFIG['OS_ARCH'] == 'WINNT' and not CONFIG['GNU_CC']:</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineminus">-        LDFLAGS += ['/HEAP:0x40000']</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+# Control the default heap size.</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+# This is the heap returned by GetProcessHeap().</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineplus">+# As we use the CRT heap, the default size is too large and wastes VM.</span>
<a href="#l13.66"></a><span id="l13.66" class="difflineplus">+#</span>
<a href="#l13.67"></a><span id="l13.67" class="difflineplus">+# The default heap size is 1MB on Win32.</span>
<a href="#l13.68"></a><span id="l13.68" class="difflineplus">+# The heap will grow if need be.</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineplus">+#</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+# Set it to 256k.  See bug 127069.</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineplus">+if CONFIG['OS_ARCH'] == 'WINNT' and not CONFIG['GNU_CC']:</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+    LDFLAGS += ['/HEAP:0x40000']</span>
<a href="#l13.73"></a><span id="l13.73"> </span>
<a href="#l13.74"></a><span id="l13.74" class="difflineminus">-    if CONFIG['MOZ_LINKER']:</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineminus">-        OS_LIBS += CONFIG['MOZ_ZLIB_LIBS']</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineplus">+if CONFIG['MOZ_LINKER']:</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineplus">+    OS_LIBS += CONFIG['MOZ_ZLIB_LIBS']</span>
<a href="#l13.78"></a><span id="l13.78"> </span>
<a href="#l13.79"></a><span id="l13.79"> DEFINES['APP_VERSION'] = CONFIG['MOZ_APP_VERSION']</span>
<a href="#l13.80"></a><span id="l13.80"> </span>
<a href="#l13.81"></a><span id="l13.81"> DISABLE_STL_WRAPPING = True</span>
<a href="#l13.82"></a><span id="l13.82"> </span>
<a href="#l13.83"></a><span id="l13.83"> FINAL_TARGET_FILES.defaults += ['permissions']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/suite/app/nsSuiteApp.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/suite/app/nsSuiteApp.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -208,82 +208,34 @@ FileExists(const char *path)</span>
<a href="#l14.4"></a><span id="l14.4">   MultiByteToWideChar(CP_UTF8, 0, path, -1, wideDir, MAX_PATH);</span>
<a href="#l14.5"></a><span id="l14.5">   DWORD fileAttrs = GetFileAttributesW(wideDir);</span>
<a href="#l14.6"></a><span id="l14.6">   return fileAttrs != INVALID_FILE_ATTRIBUTES;</span>
<a href="#l14.7"></a><span id="l14.7"> #else</span>
<a href="#l14.8"></a><span id="l14.8">   return access(path, R_OK) == 0;</span>
<a href="#l14.9"></a><span id="l14.9"> #endif</span>
<a href="#l14.10"></a><span id="l14.10"> }</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-#ifdef LIBXUL_SDK</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-#  define XPCOM_PATH &quot;xulrunner&quot; XPCOM_FILE_PATH_SEPARATOR XPCOM_DLL</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-#else</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-#  define XPCOM_PATH XPCOM_DLL</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-#endif</span>
<a href="#l14.17"></a><span id="l14.17"> static nsresult</span>
<a href="#l14.18"></a><span id="l14.18"> InitXPCOMGlue(const char *argv0, nsIFile **xreDirectory)</span>
<a href="#l14.19"></a><span id="l14.19"> {</span>
<a href="#l14.20"></a><span id="l14.20">   char exePath[MAXPATHLEN];</span>
<a href="#l14.21"></a><span id="l14.21"> </span>
<a href="#l14.22"></a><span id="l14.22">   nsresult rv = mozilla::BinaryPath::Get(argv0, exePath);</span>
<a href="#l14.23"></a><span id="l14.23">   if (NS_FAILED(rv)) {</span>
<a href="#l14.24"></a><span id="l14.24">     Output(&quot;Couldn't find the application directory.\n&quot;);</span>
<a href="#l14.25"></a><span id="l14.25">     return rv;</span>
<a href="#l14.26"></a><span id="l14.26">   }</span>
<a href="#l14.27"></a><span id="l14.27"> </span>
<a href="#l14.28"></a><span id="l14.28">   char *lastSlash = strrchr(exePath, XPCOM_FILE_PATH_SEPARATOR[0]);</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineminus">-  if (!lastSlash || (size_t(lastSlash - exePath) &gt; MAXPATHLEN - sizeof(XPCOM_PATH) - 1))</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+  if (!lastSlash || (size_t(lastSlash - exePath) &gt; MAXPATHLEN - sizeof(XPCOM_DLL) - 1))</span>
<a href="#l14.31"></a><span id="l14.31">     return NS_ERROR_FAILURE;</span>
<a href="#l14.32"></a><span id="l14.32"> </span>
<a href="#l14.33"></a><span id="l14.33" class="difflineminus">-  strcpy(lastSlash + 1, XPCOM_PATH);</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineminus">-  lastSlash += sizeof(XPCOM_PATH) - sizeof(XPCOM_DLL);</span>
<a href="#l14.35"></a><span id="l14.35" class="difflineplus">+  strcpy(lastSlash + 1, XPCOM_DLL);</span>
<a href="#l14.36"></a><span id="l14.36"> </span>
<a href="#l14.37"></a><span id="l14.37">   if (!FileExists(exePath)) {</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineminus">-#if defined(LIBXUL_SDK) &amp;&amp; defined(XP_MACOSX)</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineminus">-    // Check for &lt;bundle&gt;/Contents/Frameworks/XUL.framework/libxpcom.dylib</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineminus">-    bool greFound = false;</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineminus">-    CFBundleRef appBundle = CFBundleGetMainBundle();</span>
<a href="#l14.42"></a><span id="l14.42" class="difflineminus">-    if (!appBundle)</span>
<a href="#l14.43"></a><span id="l14.43" class="difflineminus">-      return NS_ERROR_FAILURE;</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineminus">-    CFURLRef fwurl = CFBundleCopyPrivateFrameworksURL(appBundle);</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineminus">-    CFURLRef absfwurl = nullptr;</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineminus">-    if (fwurl) {</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineminus">-      absfwurl = CFURLCopyAbsoluteURL(fwurl);</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineminus">-      CFRelease(fwurl);</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineminus">-    }</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-    if (absfwurl) {</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineminus">-      CFURLRef xulurl =</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineminus">-        CFURLCreateCopyAppendingPathComponent(nullptr, absfwurl,</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineminus">-                                              CFSTR(&quot;XUL.framework&quot;),</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineminus">-                                              true);</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineminus">-</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineminus">-      if (xulurl) {</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineminus">-        CFURLRef xpcomurl =</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineminus">-          CFURLCreateCopyAppendingPathComponent(nullptr, xulurl,</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineminus">-                                                CFSTR(&quot;libxpcom.dylib&quot;),</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineminus">-                                                false);</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineminus">-</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineminus">-        if (xpcomurl) {</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineminus">-          if (CFURLGetFileSystemRepresentation(xpcomurl, true,</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineminus">-                                               (UInt8*) exePath,</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineminus">-                                               sizeof(exePath)) &amp;&amp;</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineminus">-              access(tbuffer, R_OK | X_OK) == 0) {</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineminus">-            if (realpath(tbuffer, exePath)) {</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineminus">-              greFound = true;</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineminus">-            }</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineminus">-          }</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineminus">-          CFRelease(xpcomurl);</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineminus">-        }</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineminus">-        CFRelease(xulurl);</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineminus">-      }</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineminus">-      CFRelease(absfwurl);</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineminus">-    }</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineminus">-  }</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineminus">-  if (!greFound) {</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineminus">-#endif</span>
<a href="#l14.80"></a><span id="l14.80">     Output(&quot;Could not find the Mozilla runtime.\n&quot;);</span>
<a href="#l14.81"></a><span id="l14.81">     return NS_ERROR_FAILURE;</span>
<a href="#l14.82"></a><span id="l14.82">   }</span>
<a href="#l14.83"></a><span id="l14.83"> </span>
<a href="#l14.84"></a><span id="l14.84">   // We do this because of data in bug 771745</span>
<a href="#l14.85"></a><span id="l14.85">   XPCOMGlueEnablePreload();</span>
<a href="#l14.86"></a><span id="l14.86"> </span>
<a href="#l14.87"></a><span id="l14.87">   rv = XPCOMGlueStartup(exePath);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/suite/browser/Makefile.in</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/suite/browser/Makefile.in</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,12 +1,10 @@</span>
<a href="#l15.4"></a><span id="l15.4"> #</span>
<a href="#l15.5"></a><span id="l15.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.6"></a><span id="l15.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.7"></a><span id="l15.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l15.10"></a><span id="l15.10"> </span>
<a href="#l15.11"></a><span id="l15.11" class="difflineminus">-ifndef LIBXUL_SDK</span>
<a href="#l15.12"></a><span id="l15.12"> # channel-prefs.js is handled separate from other prefs due to bug 756325.</span>
<a href="#l15.13"></a><span id="l15.13"> libs:: $(srcdir)/channel-prefs.js</span>
<a href="#l15.14"></a><span id="l15.14"> 	$(call py_action,preprocessor,-Fsubstitution $(PREF_PPFLAGS) $(ACDEFINES) $^ -o $(DIST)/bin/defaults/pref/channel-prefs.js)</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/suite/browser/moz.build</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/suite/browser/moz.build</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -16,17 +16,12 @@ EXTRA_COMPONENTS += [</span>
<a href="#l16.4"></a><span id="l16.4"> JAR_MANIFESTS += ['jar.mn']</span>
<a href="#l16.5"></a><span id="l16.5"> </span>
<a href="#l16.6"></a><span id="l16.6"> for var in ('MOZ_APP_NAME', 'MOZ_APP_DISPLAYNAME', 'MOZ_APP_VERSION'):</span>
<a href="#l16.7"></a><span id="l16.7">     DEFINES[var] = '&quot;%s&quot;' % CONFIG[var]</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9"> if CONFIG['MOZILLA_OFFICIAL']:</span>
<a href="#l16.10"></a><span id="l16.10">     DEFINES['OFFICIAL_BUILD'] = 1</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-if CONFIG['LIBXUL_SDK']:</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-    PREF_JS_EXPORTS += [</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineminus">-        'channel-prefs.js'</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineminus">-    ]</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineminus">-</span>
<a href="#l16.17"></a><span id="l16.17"> JS_PREFERENCE_FILES += [</span>
<a href="#l16.18"></a><span id="l16.18">     'browser-prefs.js',</span>
<a href="#l16.19"></a><span id="l16.19"> ]</span>
<a href="#l16.20"></a><span id="l16.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/suite/installer/Makefile.in</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/suite/installer/Makefile.in</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -27,20 +27,16 @@ MOZ_LOCALIZED_PKG_LIST = \</span>
<a href="#l17.4"></a><span id="l17.4"> DEFINES += -DMOZ_APP_NAME=$(MOZ_APP_NAME) -DPREF_DIR=$(PREF_DIR)</span>
<a href="#l17.5"></a><span id="l17.5"> </span>
<a href="#l17.6"></a><span id="l17.6"> DEFINES += -DJAREXT=</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8"> ifdef ENABLE_TESTS</span>
<a href="#l17.9"></a><span id="l17.9"> DEFINES += -DENABLE_TESTS=1</span>
<a href="#l17.10"></a><span id="l17.10"> endif</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-DEFINES += -DLIBXUL_SDK=1</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-endif</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-</span>
<a href="#l17.16"></a><span id="l17.16"> ifdef MOZ_ANGLE_RENDERER</span>
<a href="#l17.17"></a><span id="l17.17"> DEFINES += -DMOZ_ANGLE_RENDERER=$(MOZ_ANGLE_RENDERER)</span>
<a href="#l17.18"></a><span id="l17.18"> ifdef MOZ_D3DCOMPILER_VISTA_DLL</span>
<a href="#l17.19"></a><span id="l17.19"> DEFINES += -DMOZ_D3DCOMPILER_VISTA_DLL=$(MOZ_D3DCOMPILER_VISTA_DLL)</span>
<a href="#l17.20"></a><span id="l17.20"> endif</span>
<a href="#l17.21"></a><span id="l17.21"> ifdef MOZ_D3DCOMPILER_XP_DLL</span>
<a href="#l17.22"></a><span id="l17.22"> DEFINES += -DMOZ_D3DCOMPILER_XP_DLL=$(MOZ_D3DCOMPILER_XP_DLL)</span>
<a href="#l17.23"></a><span id="l17.23"> endif</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineat">@@ -140,19 +136,17 @@ endif</span>
<a href="#l17.25"></a><span id="l17.25"> NON_OMNIJAR_FILES = \</span>
<a href="#l17.26"></a><span id="l17.26"> 	defaults/messenger/mailViews.dat \</span>
<a href="#l17.27"></a><span id="l17.27"> 	defaults/profile/panels.rdf \</span>
<a href="#l17.28"></a><span id="l17.28"> 	defaults/profile/mimeTypes.rdf \</span>
<a href="#l17.29"></a><span id="l17.29"> 	defaults/profile/chrome/userChrome-example.css \</span>
<a href="#l17.30"></a><span id="l17.30"> 	defaults/profile/chrome/userContent-example.css \</span>
<a href="#l17.31"></a><span id="l17.31"> 	$(NULL)</span>
<a href="#l17.32"></a><span id="l17.32"> </span>
<a href="#l17.33"></a><span id="l17.33" class="difflineminus">-ifndef LIBXUL_SDK</span>
<a href="#l17.34"></a><span id="l17.34"> INSTALL_SDK = 1</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineminus">-endif</span>
<a href="#l17.36"></a><span id="l17.36">  </span>
<a href="#l17.37"></a><span id="l17.37"> include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/packager.mk</span>
<a href="#l17.38"></a><span id="l17.38"> </span>
<a href="#l17.39"></a><span id="l17.39"> ifeq (Darwin, $(OS_ARCH))</span>
<a href="#l17.40"></a><span id="l17.40"> BINPATH = $(_BINPATH)</span>
<a href="#l17.41"></a><span id="l17.41"> DEFINES += -DAPPNAME=$(_APPNAME)</span>
<a href="#l17.42"></a><span id="l17.42"> else</span>
<a href="#l17.43"></a><span id="l17.43"> BINPATH = bin</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/suite/installer/package-manifest.in</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/suite/installer/package-manifest.in</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -637,30 +637,25 @@</span>
<a href="#l18.4"></a><span id="l18.4"> @RESPATH@/chrome/icons/default/script-file.ico</span>
<a href="#l18.5"></a><span id="l18.5"> @RESPATH@/chrome/icons/default/xml-file.ico</span>
<a href="#l18.6"></a><span id="l18.6"> @RESPATH@/chrome/icons/default/xul-file.ico</span>
<a href="#l18.7"></a><span id="l18.7"> #endif</span>
<a href="#l18.8"></a><span id="l18.8"> </span>
<a href="#l18.9"></a><span id="l18.9"> ; [Default Preferences]</span>
<a href="#l18.10"></a><span id="l18.10"> ; All the browser/general pref files must be part of base to prevent migration bugs</span>
<a href="#l18.11"></a><span id="l18.11"> @RESPATH@/@PREF_DIR@/browser-prefs.js</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-#ifdef LIBXUL_SDK</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-@RESPATH@/@PREF_DIR@/channel-prefs.js</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-#endif</span>
<a href="#l18.15"></a><span id="l18.15"> #ifdef MOZ_SERVICES_SYNC</span>
<a href="#l18.16"></a><span id="l18.16"> @RESPATH@/@PREF_DIR@/services-sync.js</span>
<a href="#l18.17"></a><span id="l18.17"> #endif</span>
<a href="#l18.18"></a><span id="l18.18"> @RESPATH@/@PREF_DIR@/composer.js</span>
<a href="#l18.19"></a><span id="l18.19"> @RESPATH@/greprefs.js</span>
<a href="#l18.20"></a><span id="l18.20"> @RESPATH@/defaults/autoconfig/prefcalls.js</span>
<a href="#l18.21"></a><span id="l18.21"> @RESPATH@/defaults/permissions</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineminus">-#ifndef LIBXUL_SDK</span>
<a href="#l18.23"></a><span id="l18.23"> ; Warning: changing the path to channel-prefs.js can cause bugs. (Bug 756325)</span>
<a href="#l18.24"></a><span id="l18.24"> @RESPATH@/defaults/pref/channel-prefs.js</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">-#endif</span>
<a href="#l18.26"></a><span id="l18.26"> </span>
<a href="#l18.27"></a><span id="l18.27"> ; [Layout Engine Resources]</span>
<a href="#l18.28"></a><span id="l18.28"> ; Layout debug extension.</span>
<a href="#l18.29"></a><span id="l18.29"> #ifdef ENABLE_TESTS</span>
<a href="#l18.30"></a><span id="l18.30"> #ifdef MOZ_DEBUG</span>
<a href="#l18.31"></a><span id="l18.31"> @RESPATH@/chrome/layoutdebug@JAREXT@</span>
<a href="#l18.32"></a><span id="l18.32"> @RESPATH@/chrome/layoutdebug.manifest</span>
<a href="#l18.33"></a><span id="l18.33"> @RESPATH@/components/layout_debug.xpt</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

