<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 22576:21f2508f16a2268aa2c53400705c9bf3dc0b7f9d</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 21f2508f16a2268aa2c53400705c9bf3dc0b7f9d" />
<meta property="og:url" content="/comm-central/rev/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d" />
<meta property="og:description" content="Bug 1331081 - omit addEventListener/removeEventListener's third parameter when it's false, rs=Fallen." />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 21f2508f16a2268aa2c53400705c9bf3dc0b7f9d 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">shortlog</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">files</a> |
changeset |
<a href="/comm-central/raw-rev/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">raw</a>  | <a href="/comm-central/archive/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1331081">Bug 1331081</a> - omit addEventListener/removeEventListener's third parameter when it's false, rs=Fallen.
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#70;&#108;&#111;&#114;&#105;&#97;&#110;&#32;&#81;&#117;&#232;&#122;&#101;&#32;&#60;&#102;&#108;&#111;&#114;&#105;&#97;&#110;&#64;&#113;&#117;&#101;&#122;&#101;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Sun, 19 Nov 2017 10:54:55 +0100</td></tr>

<tr>
 <td>changeset 22576</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">21f2508f16a2268aa2c53400705c9bf3dc0b7f9d</a></td>
</tr>



<tr>
<td>parent 22575</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/0d601be171e546943bd62f15a13db0b784875c3d">0d601be171e546943bd62f15a13db0b784875c3d</a>
</td>
</tr>

<tr>
<td>child 22577</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/9992e10b341b3c91de991878055e0222e2c27f6f">9992e10b341b3c91de991878055e0222e2c27f6f</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=21f2508f16a2268aa2c53400705c9bf3dc0b7f9d">13769</a></td></tr>
<tr><td>push user</td><td>florian@queze.net</td></tr>
<tr><td>push date</td><td class="date age">Sun, 19 Nov 2017 09:55:16 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@6ad50e5e75fa [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6ad50e5e75facb08fd07cbe12454de596233dfbc">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6ad50e5e75facb08fd07cbe12454de596233dfbc&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6ad50e5e75facb08fd07cbe12454de596233dfbc&newProject=comm-central&newRevision=21f2508f16a2268aa2c53400705c9bf3dc0b7f9d&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6ad50e5e75facb08fd07cbe12454de596233dfbc&newProject=comm-central&newRevision=21f2508f16a2268aa2c53400705c9bf3dc0b7f9d&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6ad50e5e75facb08fd07cbe12454de596233dfbc&newProject=comm-central&newRevision=21f2508f16a2268aa2c53400705c9bf3dc0b7f9d&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Fallen%29&revcount=50">Fallen</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1331081">1331081</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1331081">Bug 1331081</a> - omit addEventListener/removeEventListener's third parameter when it's false, rs=Fallen.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/chat/protocols/matrix/matrix-sdk/sync.js">chat/protocols/matrix/matrix-sdk/sync.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/chat/protocols/matrix/matrix-sdk/sync.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/chat/protocols/matrix/matrix-sdk/sync.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/chat/protocols/matrix/matrix-sdk/sync.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/chat/protocols/matrix/matrix-sdk/sync.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/chat/protocols/matrix/matrix-sdk/sync.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/ComposerCommands.js">editor/ui/composer/content/ComposerCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/ComposerCommands.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/ComposerCommands.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/ComposerCommands.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/ComposerCommands.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/ComposerCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/StructBarContextMenu.js">editor/ui/composer/content/StructBarContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/StructBarContextMenu.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/StructBarContextMenu.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/StructBarContextMenu.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/StructBarContextMenu.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/StructBarContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editor.js">editor/ui/composer/content/editor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editor.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editor.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editor.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editor.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editor.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editorApplicationOverlay.js">editor/ui/composer/content/editorApplicationOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editorApplicationOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editorApplicationOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editorApplicationOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editorApplicationOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/composer/content/editorApplicationOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/dialogs/content/EdInputProps.js">editor/ui/dialogs/content/EdInputProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/dialogs/content/EdInputProps.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/dialogs/content/EdInputProps.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/dialogs/content/EdInputProps.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/dialogs/content/EdInputProps.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/editor/ui/dialogs/content/EdInputProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/blist.js">im/content/blist.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/blist.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/blist.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/blist.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/blist.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/blist.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/contact.xml">im/content/contact.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/contact.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/contact.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/contact.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/contact.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/contact.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/convZoom.js">im/content/convZoom.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/convZoom.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/convZoom.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/convZoom.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/convZoom.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/convZoom.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/conversation.xml">im/content/conversation.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/conversation.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/conversation.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/conversation.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/conversation.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/conversation.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/group.xml">im/content/group.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/group.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/group.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/group.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/group.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/group.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/instantbird.js">im/content/instantbird.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/instantbird.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/instantbird.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/instantbird.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/instantbird.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/instantbird.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/preferences/advanced.js">im/content/preferences/advanced.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/preferences/advanced.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/preferences/advanced.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/preferences/advanced.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/preferences/advanced.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/preferences/advanced.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/tabbrowser.xml">im/content/tabbrowser.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/tabbrowser.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/tabbrowser.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/tabbrowser.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/tabbrowser.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/im/content/tabbrowser.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/folderDisplay.js">mail/base/content/folderDisplay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/folderDisplay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/folderDisplay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/folderDisplay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/folderDisplay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/folderDisplay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/glodaFacetBindings.xml">mail/base/content/glodaFacetBindings.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/glodaFacetBindings.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/glodaFacetBindings.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/glodaFacetBindings.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/glodaFacetBindings.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/glodaFacetBindings.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailCore.js">mail/base/content/mailCore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailCore.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailCore.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailCore.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailCore.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailCore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWidgets.xml">mail/base/content/mailWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWidgets.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWidgets.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWidgets.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWidgets.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWindow.js">mail/base/content/mailWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWindow.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWindow.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWindow.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWindow.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/mailWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgHdrViewOverlay.js">mail/base/content/msgHdrViewOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgHdrViewOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgHdrViewOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgHdrViewOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgHdrViewOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgHdrViewOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/multimessageview.js">mail/base/content/multimessageview.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/multimessageview.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/multimessageview.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/multimessageview.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/multimessageview.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/multimessageview.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/plugins.js">mail/base/content/plugins.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/plugins.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/plugins.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/plugins.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/plugins.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/plugins.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/quickFilterBar.js">mail/base/content/quickFilterBar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/quickFilterBar.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/quickFilterBar.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/quickFilterBar.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/quickFilterBar.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/quickFilterBar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/safeMode.js">mail/base/content/safeMode.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/safeMode.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/safeMode.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/safeMode.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/safeMode.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/safeMode.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/specialTabs.js">mail/base/content/specialTabs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/specialTabs.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/specialTabs.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/specialTabs.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/specialTabs.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/specialTabs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/tabmail.xml">mail/base/content/tabmail.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/tabmail.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/tabmail.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/tabmail.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/tabmail.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/content/tabmail.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/modules/quickFilterManager.js">mail/base/modules/quickFilterManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/modules/quickFilterManager.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/modules/quickFilterManager.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/modules/quickFilterManager.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/modules/quickFilterManager.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/base/modules/quickFilterManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/cloudfile/content/addAccountDialog.js">mail/components/cloudfile/content/addAccountDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/cloudfile/content/addAccountDialog.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/cloudfile/content/addAccountDialog.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/cloudfile/content/addAccountDialog.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/cloudfile/content/addAccountDialog.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/cloudfile/content/addAccountDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/bigFileObserver.js">mail/components/compose/content/bigFileObserver.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/bigFileObserver.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/bigFileObserver.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/bigFileObserver.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/bigFileObserver.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/bigFileObserver.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/cloudAttachmentLinkManager.js">mail/components/compose/content/cloudAttachmentLinkManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/cloudAttachmentLinkManager.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/cloudAttachmentLinkManager.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/cloudAttachmentLinkManager.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/cloudAttachmentLinkManager.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/compose/content/cloudAttachmentLinkManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imStatusSelector.js">mail/components/im/content/imStatusSelector.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imStatusSelector.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imStatusSelector.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imStatusSelector.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imStatusSelector.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imStatusSelector.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imcontact.xml">mail/components/im/content/imcontact.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imcontact.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imcontact.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imcontact.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imcontact.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imcontact.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imconversation.xml">mail/components/im/content/imconversation.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imconversation.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imconversation.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imconversation.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imconversation.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/im/content/imconversation.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/preferences/preferencesTab.js">mail/components/preferences/preferencesTab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/preferences/preferencesTab.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/preferences/preferencesTab.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/preferences/preferencesTab.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/preferences/preferencesTab.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/components/preferences/preferencesTab.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/mailviews/content/msgViewPickerOverlay.js">mail/extensions/mailviews/content/msgViewPickerOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/mailviews/content/msgViewPickerOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/mailviews/content/msgViewPickerOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/mailviews/content/msgViewPickerOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/mailviews/content/msgViewPickerOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/mailviews/content/msgViewPickerOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js">mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/attachment/test-attachment-events.js">mail/test/mozmill/attachment/test-attachment-events.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/attachment/test-attachment-events.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/attachment/test-attachment-events.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/attachment/test-attachment-events.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/attachment/test-attachment-events.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/attachment/test-attachment-events.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-content-tab.js">mail/test/mozmill/content-tabs/test-content-tab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-content-tab.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-content-tab.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-content-tab.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-content-tab.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-content-tab.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-install-xpi.js">mail/test/mozmill/content-tabs/test-install-xpi.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-install-xpi.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-install-xpi.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-install-xpi.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-install-xpi.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/content-tabs/test-install-xpi.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">mail/test/mozmill/shared-modules/test-content-tab-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-content-tab-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-window-helpers.js">mail/test/mozmill/shared-modules/test-window-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-window-helpers.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-window-helpers.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-window-helpers.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-window-helpers.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mail/test/mozmill/shared-modules/test-window-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/content/newmailalert.js">mailnews/base/content/newmailalert.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/content/newmailalert.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/content/newmailalert.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/content/newmailalert.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/content/newmailalert.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/content/newmailalert.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/prefs/content/am-archiveoptions.js">mailnews/base/prefs/content/am-archiveoptions.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/prefs/content/am-archiveoptions.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/prefs/content/am-archiveoptions.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/prefs/content/am-archiveoptions.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/prefs/content/am-archiveoptions.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/base/prefs/content/am-archiveoptions.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/linkToolbarOverlay.js">suite/browser/linkToolbarOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/linkToolbarOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/linkToolbarOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/linkToolbarOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/linkToolbarOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/linkToolbarOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/mailNavigatorOverlay.js">suite/browser/mailNavigatorOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/mailNavigatorOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/mailNavigatorOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/mailNavigatorOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/mailNavigatorOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/mailNavigatorOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/navigator.js">suite/browser/navigator.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/navigator.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/navigator.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/navigator.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/navigator.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/navigator.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/safeBrowsingOverlay.js">suite/browser/safeBrowsingOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/safeBrowsingOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/safeBrowsingOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/safeBrowsingOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/safeBrowsingOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/safeBrowsingOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/tabbrowser.xml">suite/browser/tabbrowser.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/tabbrowser.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/tabbrowser.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/tabbrowser.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/tabbrowser.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/tabbrowser.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug435325.js">suite/browser/test/browser/browser_bug435325.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug435325.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug435325.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug435325.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug435325.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug435325.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug561636.js">suite/browser/test/browser/browser_bug561636.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug561636.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug561636.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug561636.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug561636.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug561636.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug595507.js">suite/browser/test/browser/browser_bug595507.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug595507.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug595507.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug595507.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug595507.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_bug595507.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_ctrlTab.js">suite/browser/test/browser/browser_ctrlTab.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_ctrlTab.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_ctrlTab.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_ctrlTab.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_ctrlTab.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_ctrlTab.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js">suite/browser/test/browser/browser_pluginCrashCommentAndURL.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginnotification.js">suite/browser/test/browser/browser_pluginnotification.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginnotification.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginnotification.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginnotification.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginnotification.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_pluginnotification.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_popupNotification.js">suite/browser/test/browser/browser_popupNotification.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_popupNotification.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_popupNotification.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_popupNotification.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_popupNotification.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/browser_popupNotification.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/head.js">suite/browser/test/browser/head.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/head.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/head.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/head.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/head.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/browser/head.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/mochitest/test_contextmenu.html">suite/browser/test/mochitest/test_contextmenu.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/mochitest/test_contextmenu.html">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/mochitest/test_contextmenu.html">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/mochitest/test_contextmenu.html">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/mochitest/test_contextmenu.html">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/test/mochitest/test_contextmenu.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/urlbarBindings.xml">suite/browser/urlbarBindings.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/urlbarBindings.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/urlbarBindings.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/urlbarBindings.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/urlbarBindings.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/urlbarBindings.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/webDeveloperOverlay.js">suite/browser/webDeveloperOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/webDeveloperOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/webDeveloperOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/webDeveloperOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/webDeveloperOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/browser/webDeveloperOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bindings/notification.xml">suite/common/bindings/notification.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bindings/notification.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bindings/notification.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bindings/notification.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bindings/notification.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bindings/notification.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/bm-props.js">suite/common/bookmarks/bm-props.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/bm-props.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/bm-props.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/bm-props.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/bm-props.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/bm-props.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/browser-places.js">suite/common/bookmarks/browser-places.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/browser-places.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/browser-places.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/browser-places.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/browser-places.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/browser-places.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/editBookmarkOverlay.js">suite/common/bookmarks/editBookmarkOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/editBookmarkOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/editBookmarkOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/editBookmarkOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/editBookmarkOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/bookmarks/editBookmarkOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/browser_dataman_basics.js">suite/common/dataman/tests/browser_dataman_basics.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/browser_dataman_basics.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/browser_dataman_basics.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/browser_dataman_basics.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/browser_dataman_basics.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/browser_dataman_basics.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/dataman_storage.html">suite/common/dataman/tests/dataman_storage.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/dataman_storage.html">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/dataman_storage.html">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/dataman_storage.html">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/dataman_storage.html">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/dataman/tests/dataman_storage.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js">suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/fullscreen-video.xhtml">suite/common/fullscreen-video.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/fullscreen-video.xhtml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/fullscreen-video.xhtml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/fullscreen-video.xhtml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/fullscreen-video.xhtml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/fullscreen-video.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js">suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-applications.js">suite/common/pref/pref-applications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-applications.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-applications.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-applications.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-applications.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-applications.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-offlineapps.js">suite/common/pref/pref-offlineapps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-offlineapps.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-offlineapps.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-offlineapps.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-offlineapps.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-offlineapps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-search.js">suite/common/pref/pref-search.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-search.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-search.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-search.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-search.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/pref/pref-search.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncSetup.js">suite/common/sync/syncSetup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncSetup.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncSetup.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncSetup.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncSetup.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncSetup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncUI.js">suite/common/sync/syncUI.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncUI.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncUI.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncUI.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncUI.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/sync/syncUI.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tasksOverlay.js">suite/common/tasksOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tasksOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tasksOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tasksOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tasksOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tasksOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_354894.js">suite/common/tests/browser/browser_354894.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_354894.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_354894.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_354894.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_354894.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_354894.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_423132.js">suite/common/tests/browser/browser_423132.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_423132.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_423132.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_423132.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_423132.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_423132.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_447951.js">suite/common/tests/browser/browser_447951.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_447951.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_447951.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_447951.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_447951.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_447951.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_461634.js">suite/common/tests/browser/browser_461634.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_461634.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_461634.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_461634.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_461634.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_461634.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_465223.js">suite/common/tests/browser/browser_465223.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_465223.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_465223.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_465223.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_465223.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_465223.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_466937_sample.html">suite/common/tests/browser/browser_466937_sample.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_466937_sample.html">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_466937_sample.html">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_466937_sample.html">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_466937_sample.html">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_466937_sample.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_477657.js">suite/common/tests/browser/browser_477657.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_477657.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_477657.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_477657.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_477657.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_477657.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_490040.js">suite/common/tests/browser/browser_490040.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_490040.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_490040.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_490040.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_490040.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_490040.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_514751.js">suite/common/tests/browser/browser_514751.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_514751.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_514751.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_514751.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_514751.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_514751.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_524745.js">suite/common/tests/browser/browser_524745.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_524745.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_524745.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_524745.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_524745.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_524745.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_528776.js">suite/common/tests/browser/browser_528776.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_528776.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_528776.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_528776.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_528776.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_528776.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_586068-cascaded_restore.js">suite/common/tests/browser/browser_586068-cascaded_restore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_586068-cascaded_restore.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_586068-cascaded_restore.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_586068-cascaded_restore.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_586068-cascaded_restore.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_586068-cascaded_restore.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_615394-SSWindowState_events.js">suite/common/tests/browser/browser_615394-SSWindowState_events.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_615394-SSWindowState_events.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_615394-SSWindowState_events.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_615394-SSWindowState_events.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_615394-SSWindowState_events.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_615394-SSWindowState_events.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_636279.js">suite/common/tests/browser/browser_636279.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_636279.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_636279.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_636279.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_636279.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_636279.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_form_restore_events_sample.html">suite/common/tests/browser/browser_form_restore_events_sample.html</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_form_restore_events_sample.html">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_form_restore_events_sample.html">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_form_restore_events_sample.html">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_form_restore_events_sample.html">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_form_restore_events_sample.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_markPageAsFollowedLink.js">suite/common/tests/browser/browser_markPageAsFollowedLink.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_markPageAsFollowedLink.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_markPageAsFollowedLink.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_markPageAsFollowedLink.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_markPageAsFollowedLink.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/browser_markPageAsFollowedLink.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/head.js">suite/common/tests/browser/head.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/head.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/head.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/head.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/head.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/tests/browser/head.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/utilityOverlay.js">suite/common/utilityOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/utilityOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/utilityOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/utilityOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/utilityOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/utilityOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewApplyThemeOverlay.js">suite/common/viewApplyThemeOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewApplyThemeOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewApplyThemeOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewApplyThemeOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewApplyThemeOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewApplyThemeOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewSourceOverlay.js">suite/common/viewSourceOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewSourceOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewSourceOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewSourceOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewSourceOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewSourceOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewZoomOverlay.js">suite/common/viewZoomOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewZoomOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewZoomOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewZoomOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewZoomOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/common/viewZoomOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/extensions/debugQA/content/debugQAMenuOverlay.js">suite/extensions/debugQA/content/debugQAMenuOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/extensions/debugQA/content/debugQAMenuOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/extensions/debugQA/content/debugQAMenuOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/extensions/debugQA/content/debugQAMenuOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/extensions/debugQA/content/debugQAMenuOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/extensions/debugQA/content/debugQAMenuOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/feeds/src/FeedWriter.js">suite/feeds/src/FeedWriter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/feeds/src/FeedWriter.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/feeds/src/FeedWriter.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/feeds/src/FeedWriter.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/feeds/src/FeedWriter.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/feeds/src/FeedWriter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/MsgComposeCommands.js">suite/mailnews/compose/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/addressingWidgetOverlay.js">suite/mailnews/compose/addressingWidgetOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/addressingWidgetOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/addressingWidgetOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/addressingWidgetOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/addressingWidgetOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/compose/addressingWidgetOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/mailWidgets.xml">suite/mailnews/mailWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/mailWidgets.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/mailWidgets.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/mailWidgets.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/mailWidgets.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/mailWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgHdrViewOverlay.js">suite/mailnews/msgHdrViewOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgHdrViewOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgHdrViewOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgHdrViewOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgHdrViewOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgHdrViewOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgViewPickerOverlay.js">suite/mailnews/msgViewPickerOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgViewPickerOverlay.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgViewPickerOverlay.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgViewPickerOverlay.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgViewPickerOverlay.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/msgViewPickerOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/prefs/pref-tags.js">suite/mailnews/prefs/pref-tags.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/prefs/pref-tags.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/prefs/pref-tags.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/prefs/pref-tags.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/prefs/pref-tags.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/prefs/pref-tags.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/tabmail.xml">suite/mailnews/tabmail.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/tabmail.xml">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/tabmail.xml">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/tabmail.xml">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/tabmail.xml">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/mailnews/tabmail.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/DownloadTaskbarProgress.jsm">suite/modules/DownloadTaskbarProgress.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/DownloadTaskbarProgress.jsm">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/DownloadTaskbarProgress.jsm">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/DownloadTaskbarProgress.jsm">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/DownloadTaskbarProgress.jsm">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/DownloadTaskbarProgress.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/WindowsPreviewPerTab.jsm">suite/modules/WindowsPreviewPerTab.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/WindowsPreviewPerTab.jsm">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/WindowsPreviewPerTab.jsm">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/WindowsPreviewPerTab.jsm">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/WindowsPreviewPerTab.jsm">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/modules/WindowsPreviewPerTab.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/smile/test/browser_Application.js">suite/smile/test/browser_Application.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/smile/test/browser_Application.js">file</a> |
<a href="/comm-central/annotate/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/smile/test/browser_Application.js">annotate</a> |
<a href="/comm-central/diff/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/smile/test/browser_Application.js">diff</a> |
<a href="/comm-central/comparison/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/smile/test/browser_Application.js">comparison</a> |
<a href="/comm-central/log/21f2508f16a2268aa2c53400705c9bf3dc0b7f9d/suite/smile/test/browser_Application.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/chat/protocols/matrix/matrix-sdk/sync.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/chat/protocols/matrix/matrix-sdk/sync.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -365,17 +365,17 @@ SyncApi.prototype.sync = function() {</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">     var client = this.client;</span>
<a href="#l1.6"></a><span id="l1.6">     var self = this;</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">     this._running = true;</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">     if (global.document) {</span>
<a href="#l1.11"></a><span id="l1.11">         this._onOnlineBound = this._onOnline.bind(this);</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-        global.document.addEventListener(&quot;online&quot;, this._onOnlineBound, false);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+        global.document.addEventListener(&quot;online&quot;, this._onOnlineBound);</span>
<a href="#l1.14"></a><span id="l1.14">     }</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">     // We need to do one-off checks before we can begin the /sync loop.</span>
<a href="#l1.17"></a><span id="l1.17">     // These are:</span>
<a href="#l1.18"></a><span id="l1.18">     //   1) We need to get push rules so we can check if events should bing as we get</span>
<a href="#l1.19"></a><span id="l1.19">     //      them from /sync.</span>
<a href="#l1.20"></a><span id="l1.20">     //   2) We need to get/create a filter which we can use for /sync.</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -429,17 +429,17 @@ SyncApi.prototype.sync = function() {</span>
<a href="#l1.23"></a><span id="l1.23"> };</span>
<a href="#l1.24"></a><span id="l1.24"> </span>
<a href="#l1.25"></a><span id="l1.25"> /**</span>
<a href="#l1.26"></a><span id="l1.26">  * Stops the sync object from syncing.</span>
<a href="#l1.27"></a><span id="l1.27">  */</span>
<a href="#l1.28"></a><span id="l1.28"> SyncApi.prototype.stop = function() {</span>
<a href="#l1.29"></a><span id="l1.29">     debuglog(&quot;SyncApi.stop&quot;);</span>
<a href="#l1.30"></a><span id="l1.30">     if (global.document) {</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-        global.document.removeEventListener(&quot;online&quot;, this._onOnlineBound, false);</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+        global.document.removeEventListener(&quot;online&quot;, this._onOnlineBound);</span>
<a href="#l1.33"></a><span id="l1.33">         this._onOnlineBound = undefined;</span>
<a href="#l1.34"></a><span id="l1.34">     }</span>
<a href="#l1.35"></a><span id="l1.35">     this._running = false;</span>
<a href="#l1.36"></a><span id="l1.36">     if (this._currentSyncRequest) { this._currentSyncRequest.abort(); }</span>
<a href="#l1.37"></a><span id="l1.37">     if (this._keepAliveTimer) {</span>
<a href="#l1.38"></a><span id="l1.38">         clearTimeout(this._keepAliveTimer);</span>
<a href="#l1.39"></a><span id="l1.39">         this._keepAliveTimer = null;</span>
<a href="#l1.40"></a><span id="l1.40">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/editor/ui/composer/content/ComposerCommands.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/editor/ui/composer/content/ComposerCommands.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -2388,17 +2388,17 @@ var nsValidateCommand =</span>
<a href="#l2.4"></a><span id="l2.4">       // nsIFile throws an exception if it's not a file url</span>
<a href="#l2.5"></a><span id="l2.5">     } catch (e) { ifile = null; }</span>
<a href="#l2.6"></a><span id="l2.6">     if (ifile)</span>
<a href="#l2.7"></a><span id="l2.7">     {</span>
<a href="#l2.8"></a><span id="l2.8">       URL2Validate = ifile.path;</span>
<a href="#l2.9"></a><span id="l2.9">       var vwin = window.open(&quot;http://validator.w3.org/file-upload.html&quot;,</span>
<a href="#l2.10"></a><span id="l2.10">                              &quot;EditorValidate&quot;);</span>
<a href="#l2.11"></a><span id="l2.11">       // Window loads asynchronously, so pass control to the load listener:</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-      vwin.addEventListener(&quot;load&quot;, this.validateFilePageLoaded, false);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+      vwin.addEventListener(&quot;load&quot;, this.validateFilePageLoaded);</span>
<a href="#l2.14"></a><span id="l2.14">     }</span>
<a href="#l2.15"></a><span id="l2.15">     else</span>
<a href="#l2.16"></a><span id="l2.16">     {</span>
<a href="#l2.17"></a><span id="l2.17">       var vwin2 = window.open(&quot;http://validator.w3.org/check?uri=&quot;</span>
<a href="#l2.18"></a><span id="l2.18">                               + URL2Validate</span>
<a href="#l2.19"></a><span id="l2.19">                               + &quot;&amp;doctype=Inline&quot;,</span>
<a href="#l2.20"></a><span id="l2.20">                               &quot;EditorValidate&quot;);</span>
<a href="#l2.21"></a><span id="l2.21">       // This does the validation, no need to wait for page loaded.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/editor/ui/composer/content/StructBarContextMenu.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/editor/ui/composer/content/StructBarContextMenu.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -111,17 +111,17 @@ function StructChangeTag()</span>
<a href="#l3.4"></a><span id="l3.4"> {</span>
<a href="#l3.5"></a><span id="l3.5">   var textbox = document.createElementNS(XUL_NS, &quot;textbox&quot;);</span>
<a href="#l3.6"></a><span id="l3.6">   textbox.setAttribute(&quot;value&quot;, gContextMenuNode.getAttribute(&quot;value&quot;));</span>
<a href="#l3.7"></a><span id="l3.7">   textbox.setAttribute(&quot;width&quot;, gContextMenuNode.boxObject.width);</span>
<a href="#l3.8"></a><span id="l3.8">   textbox.className = &quot;struct-textbox&quot;;</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10">   gContextMenuNode.parentNode.replaceChild(textbox, gContextMenuNode);</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  textbox.addEventListener(&quot;keypress&quot;, OnKeyPress, false);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  textbox.addEventListener(&quot;keypress&quot;, OnKeyPress);</span>
<a href="#l3.14"></a><span id="l3.14">   textbox.addEventListener(&quot;blur&quot;, ResetStructToolbar, true);</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16">   textbox.select();</span>
<a href="#l3.17"></a><span id="l3.17"> }</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> function StructSelectTag()</span>
<a href="#l3.20"></a><span id="l3.20"> {</span>
<a href="#l3.21"></a><span id="l3.21">   SelectFocusNodeAncestor(gContextMenuFiringDocumentElement);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/editor/ui/composer/content/editor.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/editor/ui/composer/content/editor.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -3037,19 +3037,19 @@ function UpdateStructToolbar()</span>
<a href="#l4.4"></a><span id="l4.4">     button = document.createElementNS(XUL_NS, &quot;toolbarbutton&quot;);</span>
<a href="#l4.5"></a><span id="l4.5">     button.setAttribute(&quot;label&quot;,   &quot;&lt;&quot; + tag + &quot;&gt;&quot;);</span>
<a href="#l4.6"></a><span id="l4.6">     button.setAttribute(&quot;value&quot;,   tag);</span>
<a href="#l4.7"></a><span id="l4.7">     button.setAttribute(&quot;context&quot;, &quot;structToolbarContext&quot;);</span>
<a href="#l4.8"></a><span id="l4.8">     button.className = &quot;struct-button&quot;;</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">     toolbar.insertBefore(button, toolbar.firstChild);</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    button.addEventListener(&quot;command&quot;, newCommandListener(element), false);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-    button.addEventListener(&quot;contextmenu&quot;, newContextmenuListener(button, element), false);</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+    button.addEventListener(&quot;command&quot;, newCommandListener(element));</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+    button.addEventListener(&quot;contextmenu&quot;, newContextmenuListener(button, element));</span>
<a href="#l4.18"></a><span id="l4.18"> </span>
<a href="#l4.19"></a><span id="l4.19">     if (isFocusNode &amp;&amp; oneElementSelected) {</span>
<a href="#l4.20"></a><span id="l4.20">       button.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l4.21"></a><span id="l4.21">       isFocusNode = false;</span>
<a href="#l4.22"></a><span id="l4.22">     }</span>
<a href="#l4.23"></a><span id="l4.23"> </span>
<a href="#l4.24"></a><span id="l4.24">     tmp = element;</span>
<a href="#l4.25"></a><span id="l4.25">     element = element.parentNode;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/editor/ui/composer/content/editorApplicationOverlay.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/editor/ui/composer/content/editorApplicationOverlay.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -16,17 +16,17 @@ function initEditorContextMenuItems(aEve</span>
<a href="#l5.4"></a><span id="l5.4">   // Hide the applications separator if there's no add-on apps present. </span>
<a href="#l5.5"></a><span id="l5.5">   gContextMenu.showItem(&quot;context-sep-apps&quot;, gContextMenu.shouldShowSeparator(&quot;context-sep-apps&quot;));</span>
<a href="#l5.6"></a><span id="l5.6"> }</span>
<a href="#l5.7"></a><span id="l5.7">   </span>
<a href="#l5.8"></a><span id="l5.8"> function initEditorContextMenuListener(aEvent)</span>
<a href="#l5.9"></a><span id="l5.9"> {</span>
<a href="#l5.10"></a><span id="l5.10">   var popup = document.getElementById(&quot;contentAreaContextMenu&quot;);</span>
<a href="#l5.11"></a><span id="l5.11">   if (popup)</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    popup.addEventListener(&quot;popupshowing&quot;, initEditorContextMenuItems, false);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    popup.addEventListener(&quot;popupshowing&quot;, initEditorContextMenuItems);</span>
<a href="#l5.14"></a><span id="l5.14"> }</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16"> addEventListener(&quot;load&quot;, initEditorContextMenuListener, false);</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18"> function editDocument(aDocument)      </span>
<a href="#l5.19"></a><span id="l5.19"> {</span>
<a href="#l5.20"></a><span id="l5.20">   if (!aDocument)</span>
<a href="#l5.21"></a><span id="l5.21">     aDocument = window.content.document;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInputProps.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInputProps.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -172,17 +172,17 @@ function SelectInputType()</span>
<a href="#l6.4"></a><span id="l6.4">       break;</span>
<a href="#l6.5"></a><span id="l6.5">     case 6:</span>
<a href="#l6.6"></a><span id="l6.6">       gDialog.inputValue.disabled = true;</span>
<a href="#l6.7"></a><span id="l6.7">       gDialog.inputAccept.disabled = false;</span>
<a href="#l6.8"></a><span id="l6.8">       break;</span>
<a href="#l6.9"></a><span id="l6.9">     case 8:</span>
<a href="#l6.10"></a><span id="l6.10">       gDialog.inputValue.disabled = true;</span>
<a href="#l6.11"></a><span id="l6.11">       gDialog.AdvancedEditDeck.setAttribute(&quot;selectedIndex&quot;, 1);</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-      gDialog.inputName.removeEventListener(&quot;input&quot;, onInput, false);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+      gDialog.inputName.removeEventListener(&quot;input&quot;, onInput);</span>
<a href="#l6.14"></a><span id="l6.14">       break;</span>
<a href="#l6.15"></a><span id="l6.15">     case 7:</span>
<a href="#l6.16"></a><span id="l6.16">       gDialog.inputValueDeck.setAttribute(&quot;selectedIndex&quot;, 1);</span>
<a href="#l6.17"></a><span id="l6.17">       break;</span>
<a href="#l6.18"></a><span id="l6.18">   }</span>
<a href="#l6.19"></a><span id="l6.19">   onInput();</span>
<a href="#l6.20"></a><span id="l6.20"> }</span>
<a href="#l6.21"></a><span id="l6.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/im/content/blist.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/im/content/blist.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -559,17 +559,17 @@ var buddyList = {</span>
<a href="#l7.4"></a><span id="l7.4">     }</span>
<a href="#l7.5"></a><span id="l7.5"> </span>
<a href="#l7.6"></a><span id="l7.6">     if (elt.hasAttribute(&quot;usingDefault&quot;))</span>
<a href="#l7.7"></a><span id="l7.7">       elt.setAttribute(&quot;value&quot;, elt.getAttribute(&quot;usingDefault&quot;));</span>
<a href="#l7.8"></a><span id="l7.8">     TextboxSpellChecker.unregisterTextbox(elt);</span>
<a href="#l7.9"></a><span id="l7.9">     elt.removeAttribute(&quot;editing&quot;);</span>
<a href="#l7.10"></a><span id="l7.10">     elt.setAttribute(&quot;role&quot;, &quot;button&quot;);</span>
<a href="#l7.11"></a><span id="l7.11">     elt.setAttribute(&quot;aria-haspopup&quot;, &quot;true&quot;);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    elt.removeEventListener(&quot;blur&quot;, this.statusMessageBlur, false);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    elt.removeEventListener(&quot;blur&quot;, this.statusMessageBlur);</span>
<a href="#l7.14"></a><span id="l7.14">     if (!elt.getAttribute(&quot;focused&quot;))</span>
<a href="#l7.15"></a><span id="l7.15">       return;</span>
<a href="#l7.16"></a><span id="l7.16">     // Force layout to remove input binding.</span>
<a href="#l7.17"></a><span id="l7.17">     elt.getBoundingClientRect();</span>
<a href="#l7.18"></a><span id="l7.18">     elt.focus();</span>
<a href="#l7.19"></a><span id="l7.19">   },</span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21">   openStatusTypePopup: function() {</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -775,17 +775,17 @@ var buddyList = {</span>
<a href="#l7.23"></a><span id="l7.23">     // Apply the new display name only if it is different from the current one.</span>
<a href="#l7.24"></a><span id="l7.24">     if (aSave &amp;&amp; elt.value != elt.getAttribute(&quot;value&quot;))</span>
<a href="#l7.25"></a><span id="l7.25">       Services.core.globalUserStatus.displayName = elt.value;</span>
<a href="#l7.26"></a><span id="l7.26">     else if (elt.hasAttribute(&quot;usingDefault&quot;))</span>
<a href="#l7.27"></a><span id="l7.27">       elt.setAttribute(&quot;value&quot;, elt.getAttribute(&quot;usingDefault&quot;));</span>
<a href="#l7.28"></a><span id="l7.28"> </span>
<a href="#l7.29"></a><span id="l7.29">     elt.removeAttribute(&quot;editing&quot;);</span>
<a href="#l7.30"></a><span id="l7.30">     elt.setAttribute(&quot;role&quot;, &quot;button&quot;);</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-    elt.removeEventListener(&quot;blur&quot;, this.displayNameBlur, false);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+    elt.removeEventListener(&quot;blur&quot;, this.displayNameBlur);</span>
<a href="#l7.33"></a><span id="l7.33">     if (!elt.getAttribute(&quot;focused&quot;))</span>
<a href="#l7.34"></a><span id="l7.34">       return;</span>
<a href="#l7.35"></a><span id="l7.35">     // Force layout to remove input binding.</span>
<a href="#l7.36"></a><span id="l7.36">     elt.getBoundingClientRect();</span>
<a href="#l7.37"></a><span id="l7.37">     elt.focus();</span>
<a href="#l7.38"></a><span id="l7.38">   },</span>
<a href="#l7.39"></a><span id="l7.39"> </span>
<a href="#l7.40"></a><span id="l7.40">   load: function bl_load() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/im/content/contact.xml</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/im/content/contact.xml</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -334,17 +334,17 @@</span>
<a href="#l8.4"></a><span id="l8.4">       &lt;parameter name=&quot;aSave&quot;/&gt;</span>
<a href="#l8.5"></a><span id="l8.5">       &lt;body&gt;</span>
<a href="#l8.6"></a><span id="l8.6">       &lt;![CDATA[</span>
<a href="#l8.7"></a><span id="l8.7">         if (aSave) {</span>
<a href="#l8.8"></a><span id="l8.8">           this.contact.alias =</span>
<a href="#l8.9"></a><span id="l8.9">             document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;displayname&quot;).value;</span>
<a href="#l8.10"></a><span id="l8.10">         }</span>
<a href="#l8.11"></a><span id="l8.11">         this.removeAttribute(&quot;aliasing&quot;);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-        this.parentNode.removeEventListener(&quot;select&quot;, this._parentSelectListener, false);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+        this.parentNode.removeEventListener(&quot;select&quot;, this._parentSelectListener);</span>
<a href="#l8.14"></a><span id="l8.14">         delete this._parentSelectListener;</span>
<a href="#l8.15"></a><span id="l8.15">         this.parentNode.focus();</span>
<a href="#l8.16"></a><span id="l8.16">       ]]&gt;</span>
<a href="#l8.17"></a><span id="l8.17">       &lt;/body&gt;</span>
<a href="#l8.18"></a><span id="l8.18">      &lt;/method&gt;</span>
<a href="#l8.19"></a><span id="l8.19"> </span>
<a href="#l8.20"></a><span id="l8.20">      &lt;method name=&quot;delete&quot;&gt;</span>
<a href="#l8.21"></a><span id="l8.21">       &lt;body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/im/content/convZoom.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/im/content/convZoom.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -17,17 +17,17 @@ var FullZoom = {</span>
<a href="#l9.4"></a><span id="l9.4">     }</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6">     Services.prefs.addObserver(FullZoom.prefName, FullZoom, false);</span>
<a href="#l9.7"></a><span id="l9.7">     FullZoom.applyPrefValue();</span>
<a href="#l9.8"></a><span id="l9.8">   },</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10">   destroy: function FullZoom_destroy() {</span>
<a href="#l9.11"></a><span id="l9.11">     Services.prefs.removeObserver(FullZoom.prefName, FullZoom);</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    window.removeEventListener(&quot;DOMMouseScroll&quot;, FullZoom.handleMouseScrolled, false);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    window.removeEventListener(&quot;DOMMouseScroll&quot;, FullZoom.handleMouseScrolled);</span>
<a href="#l9.14"></a><span id="l9.14">   },</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16">   // Events Handlers / Observe</span>
<a href="#l9.17"></a><span id="l9.17">   handleMouseScrolled: function FullZoom_handleMouseScrolled(event) {</span>
<a href="#l9.18"></a><span id="l9.18">     if (!event.ctrlKey || event.altKey || event.shiftKey || !event.detail)</span>
<a href="#l9.19"></a><span id="l9.19">       return;</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21">     if (event.detail &lt; 0 )</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/im/content/conversation.xml</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/im/content/conversation.xml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -2147,17 +2147,17 @@</span>
<a href="#l10.4"></a><span id="l10.4">           if (aSave) {</span>
<a href="#l10.5"></a><span id="l10.5">             // apply the new topic only if it is different from the current one</span>
<a href="#l10.6"></a><span id="l10.6">             if (elt.value != convBinding._conv.topic)</span>
<a href="#l10.7"></a><span id="l10.7">               convBinding._conv.topic = elt.value;</span>
<a href="#l10.8"></a><span id="l10.8">           }</span>
<a href="#l10.9"></a><span id="l10.9">           this.editing = false;</span>
<a href="#l10.10"></a><span id="l10.10">           elt.removeEventListener(&quot;keypress&quot;, this._topicKeyPress, true);</span>
<a href="#l10.11"></a><span id="l10.11">           delete this._topicKeyPress;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-          elt.removeEventListener(&quot;blur&quot;, this._topicBlur, false);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+          elt.removeEventListener(&quot;blur&quot;, this._topicBlur);</span>
<a href="#l10.14"></a><span id="l10.14">           delete this._topicBlur;</span>
<a href="#l10.15"></a><span id="l10.15">           if (!elt.getAttribute(&quot;focused&quot;))</span>
<a href="#l10.16"></a><span id="l10.16">             return;</span>
<a href="#l10.17"></a><span id="l10.17">           // Shift focus back to the input box. Ideally we would keep the focus</span>
<a href="#l10.18"></a><span id="l10.18">           // on the topic here, but the conv-top is currently not accessible</span>
<a href="#l10.19"></a><span id="l10.19">           // via the keyboard, so doing that would leave us stranded.</span>
<a href="#l10.20"></a><span id="l10.20">           convBinding.editor.focus();</span>
<a href="#l10.21"></a><span id="l10.21">         ]]&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/im/content/group.xml</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/im/content/group.xml</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -121,17 +121,17 @@</span>
<a href="#l11.4"></a><span id="l11.4">                if (!contactElt.hasAttribute(&quot;selected&quot;) &amp;&amp;</span>
<a href="#l11.5"></a><span id="l11.5">                    !contactElt.hasAttribute(&quot;open&quot;))</span>
<a href="#l11.6"></a><span id="l11.6">                  this.observe(contactElt.contact, &quot;contact-display-name-changed&quot;);</span>
<a href="#l11.7"></a><span id="l11.7">                else</span>
<a href="#l11.8"></a><span id="l11.8">                  remaining.push(contactElt);</span>
<a href="#l11.9"></a><span id="l11.9">              }</span>
<a href="#l11.10"></a><span id="l11.10">              this._pendingReorders = remaining;</span>
<a href="#l11.11"></a><span id="l11.11">              if (remaining.length == 0) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-               this.parentNode.removeEventListener(&quot;select&quot;, this._selectListener, false);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+               this.parentNode.removeEventListener(&quot;select&quot;, this._selectListener);</span>
<a href="#l11.14"></a><span id="l11.14">                this._selectListener = null;</span>
<a href="#l11.15"></a><span id="l11.15">              }</span>
<a href="#l11.16"></a><span id="l11.16">            }).bind(this);</span>
<a href="#l11.17"></a><span id="l11.17">            this.parentNode.addEventListener(&quot;select&quot;, this._selectListener);</span>
<a href="#l11.18"></a><span id="l11.18">          }</span>
<a href="#l11.19"></a><span id="l11.19">        ]]&gt;</span>
<a href="#l11.20"></a><span id="l11.20">        &lt;/body&gt;</span>
<a href="#l11.21"></a><span id="l11.21">      &lt;/method&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/im/content/instantbird.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/im/content/instantbird.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -19,18 +19,18 @@ var convWindow = {</span>
<a href="#l12.4"></a><span id="l12.4">              window.arguments[0] instanceof XULElement) {</span>
<a href="#l12.5"></a><span id="l12.5">         // swap the given tab with the default dummy conversation tab</span>
<a href="#l12.6"></a><span id="l12.6">         // and then close the original tab in the other window.</span>
<a href="#l12.7"></a><span id="l12.7">         let tab = window.arguments.shift();</span>
<a href="#l12.8"></a><span id="l12.8">         getTabBrowser().importPanel(tab);</span>
<a href="#l12.9"></a><span id="l12.9">       }</span>
<a href="#l12.10"></a><span id="l12.10">     }</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-    window.addEventListener(&quot;mousemove&quot;, MousePosTracker, false);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-    window.addEventListener(&quot;dragover&quot;, MousePosTracker, false);</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+    window.addEventListener(&quot;mousemove&quot;, MousePosTracker);</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+    window.addEventListener(&quot;dragover&quot;, MousePosTracker);</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17">     window.addEventListener(&quot;unload&quot;, convWindow.unload);</span>
<a href="#l12.18"></a><span id="l12.18">     window.addEventListener(&quot;resize&quot;, convWindow.onresize);</span>
<a href="#l12.19"></a><span id="l12.19">     window.addEventListener(&quot;activate&quot;, convWindow.onactivate, true);</span>
<a href="#l12.20"></a><span id="l12.20">     window.QueryInterface(Ci.nsIInterfaceRequestor)</span>
<a href="#l12.21"></a><span id="l12.21">           .getInterface(Ci.nsIWebNavigation)</span>
<a href="#l12.22"></a><span id="l12.22">           .QueryInterface(Ci.nsIDocShellTreeItem).treeOwner</span>
<a href="#l12.23"></a><span id="l12.23">           .QueryInterface(Ci.nsIInterfaceRequestor)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/im/content/preferences/advanced.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/im/content/preferences/advanced.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -28,20 +28,20 @@ var gAdvancedPane = {</span>
<a href="#l13.4"></a><span id="l13.4">       var preference = document.getElementById(&quot;browser.preferences.advanced.selectedTabIndex&quot;);</span>
<a href="#l13.5"></a><span id="l13.5">       if (preference.value !== null)</span>
<a href="#l13.6"></a><span id="l13.6">         advancedPrefs.selectedIndex = preference.value;</span>
<a href="#l13.7"></a><span id="l13.7">     }</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9">     this.updateConnectionGroupbox();</span>
<a href="#l13.10"></a><span id="l13.10"> #ifdef MOZ_UPDATER</span>
<a href="#l13.11"></a><span id="l13.11">     let onUnload = function () {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-      window.removeEventListener(&quot;unload&quot;, onUnload, false);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+      window.removeEventListener(&quot;unload&quot;, onUnload);</span>
<a href="#l13.14"></a><span id="l13.14">       Services.prefs.removeObserver(&quot;app.update.&quot;, this);</span>
<a href="#l13.15"></a><span id="l13.15">     }.bind(this);</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, onUnload, false);</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, onUnload);</span>
<a href="#l13.18"></a><span id="l13.18">     Services.prefs.addObserver(&quot;app.update.&quot;, this, false);</span>
<a href="#l13.19"></a><span id="l13.19">     this.updateReadPrefs();</span>
<a href="#l13.20"></a><span id="l13.20"> #endif</span>
<a href="#l13.21"></a><span id="l13.21"> </span>
<a href="#l13.22"></a><span id="l13.22">     let bundlePrefs = document.getElementById(&quot;bundlePreferences&quot;);</span>
<a href="#l13.23"></a><span id="l13.23"> </span>
<a href="#l13.24"></a><span id="l13.24">     // Notify observers that the UI is now ready</span>
<a href="#l13.25"></a><span id="l13.25">     Services.obs.notifyObservers(window, &quot;advanced-pane-loaded&quot;, null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/im/content/tabbrowser.xml</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/im/content/tabbrowser.xml</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1515,21 +1515,21 @@</span>
<a href="#l14.4"></a><span id="l14.4">                    xbl:inherits=&quot;value=label,crop,mirror&quot;</span>
<a href="#l14.5"></a><span id="l14.5">                    flex=&quot;1&quot;</span>
<a href="#l14.6"></a><span id="l14.6">                    crop=&quot;end&quot;/&gt;</span>
<a href="#l14.7"></a><span id="l14.7">       &lt;/xul:hbox&gt;</span>
<a href="#l14.8"></a><span id="l14.8">     &lt;/content&gt;</span>
<a href="#l14.9"></a><span id="l14.9"> </span>
<a href="#l14.10"></a><span id="l14.10">     &lt;implementation implements=&quot;nsIDOMEventListener&quot;&gt;</span>
<a href="#l14.11"></a><span id="l14.11">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-        window.addEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+        window.addEventListener(&quot;resize&quot;, this);</span>
<a href="#l14.14"></a><span id="l14.14">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l14.15"></a><span id="l14.15"> </span>
<a href="#l14.16"></a><span id="l14.16">       &lt;destructor&gt;&lt;![CDATA[</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-        window.removeEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineplus">+        window.removeEventListener(&quot;resize&quot;, this);</span>
<a href="#l14.19"></a><span id="l14.19">         MousePosTracker.removeListener(this);</span>
<a href="#l14.20"></a><span id="l14.20">       ]]&gt;&lt;/destructor&gt;</span>
<a href="#l14.21"></a><span id="l14.21"> </span>
<a href="#l14.22"></a><span id="l14.22">       &lt;property name=&quot;label&quot;&gt;</span>
<a href="#l14.23"></a><span id="l14.23">         &lt;setter&gt;&lt;![CDATA[</span>
<a href="#l14.24"></a><span id="l14.24">           if (!this.label) {</span>
<a href="#l14.25"></a><span id="l14.25">             this.removeAttribute(&quot;mirror&quot;);</span>
<a href="#l14.26"></a><span id="l14.26">             this.removeAttribute(&quot;sizelimit&quot;);</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineat">@@ -2099,24 +2099,24 @@</span>
<a href="#l14.28"></a><span id="l14.28">         this._updateTabsVisibilityStatus();</span>
<a href="#l14.29"></a><span id="l14.29">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l14.30"></a><span id="l14.30"> </span>
<a href="#l14.31"></a><span id="l14.31">       &lt;handler event=&quot;popuphiding&quot;&gt;</span>
<a href="#l14.32"></a><span id="l14.32">       &lt;![CDATA[</span>
<a href="#l14.33"></a><span id="l14.33">         // clear out the menu popup and remove the listeners</span>
<a href="#l14.34"></a><span id="l14.34">         while (this.hasChildNodes()) {</span>
<a href="#l14.35"></a><span id="l14.35">           var menuItem = this.lastChild;</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineminus">-          menuItem.removeEventListener(&quot;command&quot;, this, false);</span>
<a href="#l14.37"></a><span id="l14.37" class="difflineminus">-          menuItem.tab.removeEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l14.38"></a><span id="l14.38" class="difflineplus">+          menuItem.removeEventListener(&quot;command&quot;, this);</span>
<a href="#l14.39"></a><span id="l14.39" class="difflineplus">+          menuItem.tab.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l14.40"></a><span id="l14.40">           menuItem.tab.mCorrespondingMenuitem = null;</span>
<a href="#l14.41"></a><span id="l14.41">           menuItem.remove();</span>
<a href="#l14.42"></a><span id="l14.42">         }</span>
<a href="#l14.43"></a><span id="l14.43">         var tabcontainer = document.getBindingParent(this);</span>
<a href="#l14.44"></a><span id="l14.44" class="difflineminus">-        tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineminus">-        tabcontainer.removeEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+        tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this);</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+        tabcontainer.removeEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l14.48"></a><span id="l14.48">         window.XULBrowserWindow.setOverLink(&quot;&quot;, null);</span>
<a href="#l14.49"></a><span id="l14.49">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l14.50"></a><span id="l14.50"> </span>
<a href="#l14.51"></a><span id="l14.51">       &lt;handler event=&quot;DOMMenuItemActive&quot;&gt;</span>
<a href="#l14.52"></a><span id="l14.52">       &lt;![CDATA[</span>
<a href="#l14.53"></a><span id="l14.53">         if (!this._xulWindow || !this._xulWindow.XULBrowserWindow)</span>
<a href="#l14.54"></a><span id="l14.54">           return;</span>
<a href="#l14.55"></a><span id="l14.55"> </span>
<a href="#l14.56"></a><span id="l14.56" class="difflineat">@@ -2190,17 +2190,17 @@</span>
<a href="#l14.57"></a><span id="l14.57">             let enableDblClick = function (event) {</span>
<a href="#l14.58"></a><span id="l14.58">               if (event.detail == 1 &amp;&amp; !clickedOnce) {</span>
<a href="#l14.59"></a><span id="l14.59">                 clickedOnce = true;</span>
<a href="#l14.60"></a><span id="l14.60">                 return;</span>
<a href="#l14.61"></a><span id="l14.61">               }</span>
<a href="#l14.62"></a><span id="l14.62">               setTimeout(function() {</span>
<a href="#l14.63"></a><span id="l14.63">                 tabbedBrowser._blockDblClick = false;</span>
<a href="#l14.64"></a><span id="l14.64">               }, 0);</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineminus">-              tabbedBrowser.removeEventListener(&quot;click&quot;, enableDblClick, false);</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+              tabbedBrowser.removeEventListener(&quot;click&quot;, enableDblClick);</span>
<a href="#l14.67"></a><span id="l14.67">             };</span>
<a href="#l14.68"></a><span id="l14.68">             tabbedBrowser.addEventListener(&quot;click&quot;, enableDblClick);</span>
<a href="#l14.69"></a><span id="l14.69">           }</span>
<a href="#l14.70"></a><span id="l14.70">           else // &quot;tabs&quot;</span>
<a href="#l14.71"></a><span id="l14.71">             tabbedBrowser.removeCurrentTab();</span>
<a href="#l14.72"></a><span id="l14.72">         }</span>
<a href="#l14.73"></a><span id="l14.73">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l14.74"></a><span id="l14.74">       &lt;handler event=&quot;dblclick&quot; button=&quot;0&quot; phase=&quot;capturing&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/base/content/folderDisplay.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/base/content/folderDisplay.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -169,17 +169,17 @@ function FolderDisplayWidget(aTabInfo, a</span>
<a href="#l15.4"></a><span id="l15.4">   // Create a DOM node for the fake tree box below.</span>
<a href="#l15.5"></a><span id="l15.5">   let domNode = document.createElementNS(</span>
<a href="#l15.6"></a><span id="l15.6">       &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;, &quot;vbox&quot;);</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8">   // We care about onselect events, so add a listener for that.</span>
<a href="#l15.9"></a><span id="l15.9">   let self = this;</span>
<a href="#l15.10"></a><span id="l15.10">   domNode.addEventListener(&quot;select&quot;, function () {</span>
<a href="#l15.11"></a><span id="l15.11">     self.view.dbView.selectionChanged();</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  }, false);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  });</span>
<a href="#l15.14"></a><span id="l15.14"> </span>
<a href="#l15.15"></a><span id="l15.15">   /**</span>
<a href="#l15.16"></a><span id="l15.16">    * Create a fake tree box object for if/when this folder is in the background.</span>
<a href="#l15.17"></a><span id="l15.17">    * We need to give it a DOM object to send events to, including the onselect</span>
<a href="#l15.18"></a><span id="l15.18">    * event we care about and for which we added a handler above, and all the</span>
<a href="#l15.19"></a><span id="l15.19">    * other events we don't care about.</span>
<a href="#l15.20"></a><span id="l15.20">    */</span>
<a href="#l15.21"></a><span id="l15.21">   this._fakeTreeBox = new FakeTreeBoxObject(domNode);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/base/content/glodaFacetBindings.xml</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/base/content/glodaFacetBindings.xml</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -330,17 +330,17 @@</span>
<a href="#l16.4"></a><span id="l16.4">       &lt;body&gt;&lt;![CDATA[</span>
<a href="#l16.5"></a><span id="l16.5">         this.filterNode = document.getAnonymousElementByAttribute(</span>
<a href="#l16.6"></a><span id="l16.6">                             this, &quot;anonid&quot;, &quot;filter&quot;);</span>
<a href="#l16.7"></a><span id="l16.7">         this.groupDisplayProperty = this.getAttribute(&quot;groupDisplayProperty&quot;);</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9">         let dis = this;</span>
<a href="#l16.10"></a><span id="l16.10">         this.filterNode.addEventListener(&quot;change&quot;, function(event) {</span>
<a href="#l16.11"></a><span id="l16.11">           return dis.filterChanged(event);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-        }, false);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+        });</span>
<a href="#l16.14"></a><span id="l16.14"> </span>
<a href="#l16.15"></a><span id="l16.15">         this.selectedValue = &quot;all&quot;;</span>
<a href="#l16.16"></a><span id="l16.16">       ]]&gt;&lt;/body&gt;</span>
<a href="#l16.17"></a><span id="l16.17">     &lt;/method&gt;</span>
<a href="#l16.18"></a><span id="l16.18">     &lt;method name=&quot;build&quot;&gt;</span>
<a href="#l16.19"></a><span id="l16.19">       &lt;parameter name=&quot;aFirstTime&quot; /&gt;</span>
<a href="#l16.20"></a><span id="l16.20">       &lt;body&gt;&lt;![CDATA[</span>
<a href="#l16.21"></a><span id="l16.21">         if (aFirstTime) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/base/content/mailCore.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/base/content/mailCore.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -310,17 +310,17 @@ function onViewToolbarsPopupShowing(aEve</span>
<a href="#l17.4"></a><span id="l17.4">         popup.insertBefore(menuItem, firstMenuItem);</span>
<a href="#l17.5"></a><span id="l17.5"> </span>
<a href="#l17.6"></a><span id="l17.6">         let onMenuItemCommand = function(aEvent) {</span>
<a href="#l17.7"></a><span id="l17.7">           let hidden = aEvent.originalTarget.getAttribute(&quot;checked&quot;) != &quot;true&quot;;</span>
<a href="#l17.8"></a><span id="l17.8">           toolbar.setAttribute(hidingAttribute, hidden);</span>
<a href="#l17.9"></a><span id="l17.9">           document.persist(toolbar.id, hidingAttribute);</span>
<a href="#l17.10"></a><span id="l17.10">         }</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-        menuItem.addEventListener(&quot;command&quot;, onMenuItemCommand, false);</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+        menuItem.addEventListener(&quot;command&quot;, onMenuItemCommand);</span>
<a href="#l17.14"></a><span id="l17.14">       }</span>
<a href="#l17.15"></a><span id="l17.15">     }</span>
<a href="#l17.16"></a><span id="l17.16">   }</span>
<a href="#l17.17"></a><span id="l17.17"> }</span>
<a href="#l17.18"></a><span id="l17.18"> </span>
<a href="#l17.19"></a><span id="l17.19"> function toJavaScriptConsole()</span>
<a href="#l17.20"></a><span id="l17.20"> {</span>
<a href="#l17.21"></a><span id="l17.21">   HUDService.openBrowserConsoleOrFocus();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mail/base/content/mailWidgets.xml</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mail/base/content/mailWidgets.xml</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -2371,30 +2371,30 @@</span>
<a href="#l18.4"></a><span id="l18.4">         ]]&gt;</span>
<a href="#l18.5"></a><span id="l18.5">       &lt;/destructor&gt;</span>
<a href="#l18.6"></a><span id="l18.6">     &lt;/implementation&gt;</span>
<a href="#l18.7"></a><span id="l18.7">     &lt;handlers&gt;</span>
<a href="#l18.8"></a><span id="l18.8">       &lt;handler event=&quot;mousemove&quot; action=&quot;this.updateHover(event);&quot;/&gt;</span>
<a href="#l18.9"></a><span id="l18.9">       &lt;handler event=&quot;click&quot; button=&quot;0&quot; action=&quot;if (this.updateHover(event) &gt;= 0) this.fire();&quot;/&gt;</span>
<a href="#l18.10"></a><span id="l18.10">       &lt;handler event=&quot;popupshowing&quot;&gt;</span>
<a href="#l18.11"></a><span id="l18.11">         &lt;![CDATA[</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-          this.parentNode.addEventListener(&quot;blur&quot;, this.onBlurMenuList, false);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+          this.parentNode.addEventListener(&quot;blur&quot;, this.onBlurMenuList);</span>
<a href="#l18.14"></a><span id="l18.14">           var box = this.tree.treeBoxObject;</span>
<a href="#l18.15"></a><span id="l18.15">           box.focused = true;</span>
<a href="#l18.16"></a><span id="l18.16">           var index = this.setInitialSelection();</span>
<a href="#l18.17"></a><span id="l18.17">           var height = box.view.rowCount * box.rowHeight;</span>
<a href="#l18.18"></a><span id="l18.18">           height += this.boxObject.height - box.treeBody.boxObject.height;</span>
<a href="#l18.19"></a><span id="l18.19">           this.height = height;</span>
<a href="#l18.20"></a><span id="l18.20">           if (index &gt;= 0)</span>
<a href="#l18.21"></a><span id="l18.21">             setTimeout(function() { box.ensureRowIsVisible(index); }, 0);</span>
<a href="#l18.22"></a><span id="l18.22">         ]]&gt;</span>
<a href="#l18.23"></a><span id="l18.23">       &lt;/handler&gt;</span>
<a href="#l18.24"></a><span id="l18.24">       &lt;handler event=&quot;popuphiding&quot;&gt;</span>
<a href="#l18.25"></a><span id="l18.25">         &lt;![CDATA[</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">-          this.parentNode.removeEventListener(&quot;blur&quot;, this.onBlurMenuList, false);</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+          this.parentNode.removeEventListener(&quot;blur&quot;, this.onBlurMenuList);</span>
<a href="#l18.28"></a><span id="l18.28">         ]]&gt;</span>
<a href="#l18.29"></a><span id="l18.29">       &lt;/handler&gt;</span>
<a href="#l18.30"></a><span id="l18.30">     &lt;/handlers&gt;</span>
<a href="#l18.31"></a><span id="l18.31">   &lt;/binding&gt;</span>
<a href="#l18.32"></a><span id="l18.32"> </span>
<a href="#l18.33"></a><span id="l18.33">   &lt;binding id=&quot;folderSummary-popup&quot; extends=&quot;chrome://global/content/bindings/popup.xml#tooltip&quot;&gt;</span>
<a href="#l18.34"></a><span id="l18.34">     &lt;content&gt;</span>
<a href="#l18.35"></a><span id="l18.35">       &lt;children&gt;</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineat">@@ -2718,23 +2718,23 @@</span>
<a href="#l18.37"></a><span id="l18.37">                 xbl:inherits=&quot;disabled,_moz-menuactive=active&quot;</span>
<a href="#l18.38"></a><span id="l18.38">                 oncommand=&quot;event.stopPropagation();&quot;&gt;</span>
<a href="#l18.39"></a><span id="l18.39">         &lt;children includes=&quot;menupopup&quot;/&gt;</span>
<a href="#l18.40"></a><span id="l18.40">       &lt;/xul:menu&gt;</span>
<a href="#l18.41"></a><span id="l18.41">     &lt;/content&gt;</span>
<a href="#l18.42"></a><span id="l18.42"> </span>
<a href="#l18.43"></a><span id="l18.43">     &lt;implementation implements=&quot;nsIDOMEventListener&quot;&gt;</span>
<a href="#l18.44"></a><span id="l18.44">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineminus">-        this._parentMenupopup.addEventListener(&quot;DOMMenuItemActive&quot;, this, false);</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineminus">-        this._parentMenupopup.addEventListener(&quot;popuphidden&quot;, this, false);</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+        this._parentMenupopup.addEventListener(&quot;DOMMenuItemActive&quot;, this);</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineplus">+        this._parentMenupopup.addEventListener(&quot;popuphidden&quot;, this);</span>
<a href="#l18.49"></a><span id="l18.49">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l18.50"></a><span id="l18.50"> </span>
<a href="#l18.51"></a><span id="l18.51">       &lt;destructor&gt;&lt;![CDATA[</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineminus">-        this._parentMenupopup.removeEventListener(&quot;DOMMenuItemActive&quot;, this, false);</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineminus">-        this._parentMenupopup.removeEventListener(&quot;popuphidden&quot;, this, false);</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineplus">+        this._parentMenupopup.removeEventListener(&quot;DOMMenuItemActive&quot;, this);</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineplus">+        this._parentMenupopup.removeEventListener(&quot;popuphidden&quot;, this);</span>
<a href="#l18.56"></a><span id="l18.56">       ]]&gt;&lt;/destructor&gt;</span>
<a href="#l18.57"></a><span id="l18.57"> </span>
<a href="#l18.58"></a><span id="l18.58">       &lt;field name=&quot;menuitem&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.59"></a><span id="l18.59">         document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;menuitem&quot;);</span>
<a href="#l18.60"></a><span id="l18.60">       &lt;/field&gt;</span>
<a href="#l18.61"></a><span id="l18.61">       &lt;field name=&quot;menu&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l18.62"></a><span id="l18.62">         document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;menu&quot;);</span>
<a href="#l18.63"></a><span id="l18.63">       &lt;/field&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/base/content/mailWindow.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/base/content/mailWindow.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -142,18 +142,18 @@ function onCopyOrDragStart(e) {</span>
<a href="#l19.4"></a><span id="l19.4"> }</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6"> function CreateMailWindowGlobals()</span>
<a href="#l19.7"></a><span id="l19.7"> {</span>
<a href="#l19.8"></a><span id="l19.8">   // get the messenger instance</span>
<a href="#l19.9"></a><span id="l19.9">   messenger = Components.classes[&quot;@mozilla.org/messenger;1&quot;]</span>
<a href="#l19.10"></a><span id="l19.10">                         .createInstance(Components.interfaces.nsIMessenger);</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  window.addEventListener(&quot;blur&quot;, appIdleManager.onBlur, false);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-  window.addEventListener(&quot;focus&quot;, appIdleManager.onFocus, false);</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+  window.addEventListener(&quot;blur&quot;, appIdleManager.onBlur);</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+  window.addEventListener(&quot;focus&quot;, appIdleManager.onFocus);</span>
<a href="#l19.16"></a><span id="l19.16"> </span>
<a href="#l19.17"></a><span id="l19.17">   //Create windows status feedback</span>
<a href="#l19.18"></a><span id="l19.18">   // set the JS implementation of status feedback before creating the c++ one..</span>
<a href="#l19.19"></a><span id="l19.19">   window.MsgStatusFeedback = new nsMsgStatusFeedback();</span>
<a href="#l19.20"></a><span id="l19.20">   // double register the status feedback object as the xul browser window implementation</span>
<a href="#l19.21"></a><span id="l19.21">   window.QueryInterface(Components.interfaces.nsIInterfaceRequestor)</span>
<a href="#l19.22"></a><span id="l19.22">         .getInterface(Components.interfaces.nsIWebNavigation)</span>
<a href="#l19.23"></a><span id="l19.23">         .QueryInterface(Components.interfaces.nsIDocShellTreeItem).treeOwner</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/base/content/msgHdrViewOverlay.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/base/content/msgHdrViewOverlay.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -2289,17 +2289,17 @@ function displayAttachmentsForExpandedVi</span>
<a href="#l20.4"></a><span id="l20.4"> </span>
<a href="#l20.5"></a><span id="l20.5">     var lastPartID;</span>
<a href="#l20.6"></a><span id="l20.6">     var unknownSize = false;</span>
<a href="#l20.7"></a><span id="l20.7">     for (let attachment of currentAttachments) {</span>
<a href="#l20.8"></a><span id="l20.8">       // Create a new attachment widget</span>
<a href="#l20.9"></a><span id="l20.9">       var displayName = SanitizeAttachmentDisplayName(attachment);</span>
<a href="#l20.10"></a><span id="l20.10">       var item = attachmentList.appendItem(attachment, displayName);</span>
<a href="#l20.11"></a><span id="l20.11">       item.setAttribute(&quot;tooltiptext&quot;, attachment.name);</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-      item.addEventListener(&quot;command&quot;, attachmentItemCommand, false);</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+      item.addEventListener(&quot;command&quot;, attachmentItemCommand);</span>
<a href="#l20.14"></a><span id="l20.14"> </span>
<a href="#l20.15"></a><span id="l20.15">       // Check if this attachment's part ID is a child of the last attachment</span>
<a href="#l20.16"></a><span id="l20.16">       // we counted. If so, skip it, since we already accounted for its size</span>
<a href="#l20.17"></a><span id="l20.17">       // from its parent.</span>
<a href="#l20.18"></a><span id="l20.18">       if (!lastPartID || attachment.partID.indexOf(lastPartID) != 0) {</span>
<a href="#l20.19"></a><span id="l20.19">         lastPartID = attachment.partID;</span>
<a href="#l20.20"></a><span id="l20.20">         if (attachment.size !== null)</span>
<a href="#l20.21"></a><span id="l20.21">           totalSize += attachment.size;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -1654,17 +1654,17 @@ var TabsInTitlebar = {</span>
<a href="#l21.4"></a><span id="l21.4">       Services.prefs.addObserver(this._drawInTitlePref, this, false);</span>
<a href="#l21.5"></a><span id="l21.5">       Services.prefs.addObserver(this._autoHidePref, this, false);</span>
<a href="#l21.6"></a><span id="l21.6"> </span>
<a href="#l21.7"></a><span id="l21.7">       this.allowedBy(&quot;sizemode&quot;, false);</span>
<a href="#l21.8"></a><span id="l21.8">       window.addEventListener(&quot;resize&quot;, function (event) {</span>
<a href="#l21.9"></a><span id="l21.9">         if (event.target != window)</span>
<a href="#l21.10"></a><span id="l21.10">           return;</span>
<a href="#l21.11"></a><span id="l21.11">         TabsInTitlebar.allowedBy(&quot;sizemode&quot;, true);</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-      }, false);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+      });</span>
<a href="#l21.14"></a><span id="l21.14"> </span>
<a href="#l21.15"></a><span id="l21.15">       // Always disable on unsupported GTK versions.</span>
<a href="#l21.16"></a><span id="l21.16">       if (AppConstants.MOZ_WIDGET_TOOLKIT == &quot;gtk3&quot;) {</span>
<a href="#l21.17"></a><span id="l21.17">         this.allowedBy(&quot;gtk&quot;, window.matchMedia(&quot;(-moz-gtk-csd-available)&quot;));</span>
<a href="#l21.18"></a><span id="l21.18">       }</span>
<a href="#l21.19"></a><span id="l21.19"> </span>
<a href="#l21.20"></a><span id="l21.20">       // We need to update the appearance of the titlebar when the menu changes</span>
<a href="#l21.21"></a><span id="l21.21">       // from the active to the inactive state. We can't, however, rely on</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/base/content/multimessageview.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/base/content/multimessageview.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -241,17 +241,17 @@ MultiMessageSummary.prototype = {</span>
<a href="#l22.4"></a><span id="l22.4">       itemHeaderNode.appendChild(authorNode);</span>
<a href="#l22.5"></a><span id="l22.5"> </span>
<a href="#l22.6"></a><span id="l22.6">       let subjectNode = document.createElement(&quot;span&quot;);</span>
<a href="#l22.7"></a><span id="l22.7">       subjectNode.classList.add(&quot;subject&quot;, &quot;primary_header&quot;, &quot;link&quot;);</span>
<a href="#l22.8"></a><span id="l22.8">       subjectNode.textContent = message.mime2DecodedSubject ||</span>
<a href="#l22.9"></a><span id="l22.9">                                 formatString(&quot;noSubject&quot;);</span>
<a href="#l22.10"></a><span id="l22.10">       subjectNode.addEventListener(&quot;click&quot;, function() {</span>
<a href="#l22.11"></a><span id="l22.11">         window.top.gFolderDisplay.selectMessages(thread);</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-      }, false);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+      });</span>
<a href="#l22.14"></a><span id="l22.14">       itemHeaderNode.appendChild(subjectNode);</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16">       if (thread &amp;&amp; thread.length &gt; 1) {</span>
<a href="#l22.17"></a><span id="l22.17">         let numUnreadStr = &quot;&quot;;</span>
<a href="#l22.18"></a><span id="l22.18">         if (numUnread)</span>
<a href="#l22.19"></a><span id="l22.19">           numUnreadStr = formatString(</span>
<a href="#l22.20"></a><span id="l22.20">             &quot;numUnread&quot;, [numUnread.toLocaleString()], numUnread</span>
<a href="#l22.21"></a><span id="l22.21">           );</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineat">@@ -270,17 +270,17 @@ MultiMessageSummary.prototype = {</span>
<a href="#l22.23"></a><span id="l22.23">       dateNode.classList.add(&quot;date&quot;, &quot;right&quot;);</span>
<a href="#l22.24"></a><span id="l22.24">       dateNode.textContent = makeFriendlyDateAgo(new Date(message.date / 1000));</span>
<a href="#l22.25"></a><span id="l22.25">       itemHeaderNode.appendChild(dateNode);</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27">       authorNode.classList.add(&quot;primary_header&quot;, &quot;link&quot;);</span>
<a href="#l22.28"></a><span id="l22.28">       authorNode.addEventListener(&quot;click&quot;, function() {</span>
<a href="#l22.29"></a><span id="l22.29">         window.top.gFolderDisplay.selectMessage(message);</span>
<a href="#l22.30"></a><span id="l22.30">         window.top.document.getElementById(&quot;messagepane&quot;).focus();</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-      }, false);</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+      });</span>
<a href="#l22.33"></a><span id="l22.33">       itemHeaderNode.appendChild(authorNode);</span>
<a href="#l22.34"></a><span id="l22.34">     }</span>
<a href="#l22.35"></a><span id="l22.35"> </span>
<a href="#l22.36"></a><span id="l22.36">     let tagNode = document.createElement(&quot;span&quot;);</span>
<a href="#l22.37"></a><span id="l22.37">     tagNode.classList.add(&quot;tags&quot;);</span>
<a href="#l22.38"></a><span id="l22.38">     this._addTagNodes(tags, tagNode);</span>
<a href="#l22.39"></a><span id="l22.39">     itemHeaderNode.appendChild(tagNode);</span>
<a href="#l22.40"></a><span id="l22.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/base/content/plugins.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/base/content/plugins.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -581,17 +581,17 @@ var gPluginHandler = {</span>
<a href="#l23.4"></a><span id="l23.4"> </span>
<a href="#l23.5"></a><span id="l23.5">         // Use a weak reference, so we don't have to remove it...</span>
<a href="#l23.6"></a><span id="l23.6">         Services.obs.addObserver(observer, &quot;crash-report-status&quot;, true);</span>
<a href="#l23.7"></a><span id="l23.7">         // ...alas, now we need something to hold a strong reference to prevent</span>
<a href="#l23.8"></a><span id="l23.8">         // it from being GC. But I don't want to manually manage the reference's</span>
<a href="#l23.9"></a><span id="l23.9">         // lifetime (which should be no greater than the page).</span>
<a href="#l23.10"></a><span id="l23.10">         // Clever solution? Use a closue with an event listener on the document.</span>
<a href="#l23.11"></a><span id="l23.11">         // When the doc goes away, so do the listener references and the closure.</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-        doc.addEventListener(&quot;mozCleverClosureHack&quot;, observer, false);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+        doc.addEventListener(&quot;mozCleverClosureHack&quot;, observer);</span>
<a href="#l23.14"></a><span id="l23.14">       }</span>
<a href="#l23.15"></a><span id="l23.15">     }</span>
<a href="#l23.16"></a><span id="l23.16"> </span>
<a href="#l23.17"></a><span id="l23.17">     let crashText = this.getPluginUI(plugin, &quot;crashedText&quot;);</span>
<a href="#l23.18"></a><span id="l23.18">     crashText.textContent = messageString;</span>
<a href="#l23.19"></a><span id="l23.19">     let browser = tabmail.getBrowserForSelectedTab();</span>
<a href="#l23.20"></a><span id="l23.20"> </span>
<a href="#l23.21"></a><span id="l23.21">     let link = this.getPluginUI(plugin, &quot;reloadLink&quot;);</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineat">@@ -673,14 +673,14 @@ var gPluginHandler = {</span>
<a href="#l23.23"></a><span id="l23.23">       link.setAttribute(&quot;value&quot;, messengerBundle.getString(&quot;crashedpluginsMessage.learnMore&quot;));</span>
<a href="#l23.24"></a><span id="l23.24">       link.href = crashHelpUrl;</span>
<a href="#l23.25"></a><span id="l23.25">       let description = notification.ownerDocument.getAnonymousElementByAttribute(notification, &quot;anonid&quot;, &quot;messageText&quot;);</span>
<a href="#l23.26"></a><span id="l23.26">       description.appendChild(link);</span>
<a href="#l23.27"></a><span id="l23.27"> </span>
<a href="#l23.28"></a><span id="l23.28">       // Remove the notfication when the page is reloaded.</span>
<a href="#l23.29"></a><span id="l23.29">       doc.defaultView.top.addEventListener(&quot;unload&quot;, function() {</span>
<a href="#l23.30"></a><span id="l23.30">         notificationBox.removeNotification(notification);</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-      }, false);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+      });</span>
<a href="#l23.33"></a><span id="l23.33">     }</span>
<a href="#l23.34"></a><span id="l23.34"> </span>
<a href="#l23.35"></a><span id="l23.35">   }</span>
<a href="#l23.36"></a><span id="l23.36"> };</span>
<a href="#l23.37"></a><span id="l23.37"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mail/base/content/quickFilterBar.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mail/base/content/quickFilterBar.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -30,17 +30,17 @@ var QuickFilterBarMuxer = {</span>
<a href="#l24.4"></a><span id="l24.4">     this.tabmail.registerTabMonitor(this);</span>
<a href="#l24.5"></a><span id="l24.5"> </span>
<a href="#l24.6"></a><span id="l24.6">     // -- window hookups</span>
<a href="#l24.7"></a><span id="l24.7">     let dis = this;</span>
<a href="#l24.8"></a><span id="l24.8">     // know when a resize happens so we can expand things collapsed by our</span>
<a href="#l24.9"></a><span id="l24.9">     //  overflow handler (registered by attribute in the XUL file).</span>
<a href="#l24.10"></a><span id="l24.10">     window.addEventListener(&quot;resize&quot;, function QFBM_resizeWrap() {</span>
<a href="#l24.11"></a><span id="l24.11">                               dis.onWindowResize();</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-                            }, false);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+                            });</span>
<a href="#l24.14"></a><span id="l24.14"> </span>
<a href="#l24.15"></a><span id="l24.15">     this._bindUI();</span>
<a href="#l24.16"></a><span id="l24.16">   },</span>
<a href="#l24.17"></a><span id="l24.17"> </span>
<a href="#l24.18"></a><span id="l24.18">   //////////////////////////////////////////////////////////////////////////////</span>
<a href="#l24.19"></a><span id="l24.19">   // FolderDisplayListener</span>
<a href="#l24.20"></a><span id="l24.20"> </span>
<a href="#l24.21"></a><span id="l24.21">   /**</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineat">@@ -207,17 +207,17 @@ var QuickFilterBarMuxer = {</span>
<a href="#l24.23"></a><span id="l24.23">           let [postValue, update] =</span>
<a href="#l24.24"></a><span id="l24.24">             latchedFilterDef.onCommand(preValue, domNode, aEvent, document);</span>
<a href="#l24.25"></a><span id="l24.25">           QuickFilterBarMuxer.activeFilterer.setFilterValue(</span>
<a href="#l24.26"></a><span id="l24.26">             latchedFilterDef.name, postValue, !update);</span>
<a href="#l24.27"></a><span id="l24.27">           if (update)</span>
<a href="#l24.28"></a><span id="l24.28">             QuickFilterBarMuxer.deferredUpdateSearch();</span>
<a href="#l24.29"></a><span id="l24.29">         };</span>
<a href="#l24.30"></a><span id="l24.30">       }</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-      domNode.addEventListener(&quot;command&quot;, handler, false);</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+      domNode.addEventListener(&quot;command&quot;, handler);</span>
<a href="#l24.33"></a><span id="l24.33"> </span>
<a href="#l24.34"></a><span id="l24.34">       if (&quot;domBindExtra&quot; in filterDef)</span>
<a href="#l24.35"></a><span id="l24.35">         filterDef.domBindExtra(document, this, domNode);</span>
<a href="#l24.36"></a><span id="l24.36">     }</span>
<a href="#l24.37"></a><span id="l24.37">   },</span>
<a href="#l24.38"></a><span id="l24.38"> </span>
<a href="#l24.39"></a><span id="l24.39">   /**</span>
<a href="#l24.40"></a><span id="l24.40">    * Update the UI to reflect the state of the filterer constraints.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mail/base/content/safeMode.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mail/base/content/safeMode.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -57,16 +57,16 @@ function onOK() {</span>
<a href="#l25.4"></a><span id="l25.4"> }</span>
<a href="#l25.5"></a><span id="l25.5"> </span>
<a href="#l25.6"></a><span id="l25.6"> function onCancel() {</span>
<a href="#l25.7"></a><span id="l25.7">   Services.startup.quit(Services.startup.eForceQuit);</span>
<a href="#l25.8"></a><span id="l25.8"> }</span>
<a href="#l25.9"></a><span id="l25.9"> </span>
<a href="#l25.10"></a><span id="l25.10"> function onLoad() {</span>
<a href="#l25.11"></a><span id="l25.11">   document.getElementById(&quot;tasks&quot;)</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-          .addEventListener(&quot;CheckboxStateChange&quot;, updateOKButtonState, false);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+          .addEventListener(&quot;CheckboxStateChange&quot;, updateOKButtonState);</span>
<a href="#l25.14"></a><span id="l25.14"> }</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16"> function updateOKButtonState() {</span>
<a href="#l25.17"></a><span id="l25.17">   document.documentElement.getButton(&quot;accept&quot;).disabled =</span>
<a href="#l25.18"></a><span id="l25.18">     !document.getElementById(&quot;resetToolbars&quot;).checked &amp;&amp;</span>
<a href="#l25.19"></a><span id="l25.19">     !document.getElementById(&quot;disableAddons&quot;).checked;</span>
<a href="#l25.20"></a><span id="l25.20"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/base/content/specialTabs.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/base/content/specialTabs.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -272,17 +272,17 @@ var contentTabBaseType = {</span>
<a href="#l26.4"></a><span id="l26.4">     return -1;</span>
<a href="#l26.5"></a><span id="l26.5">   },</span>
<a href="#l26.6"></a><span id="l26.6"> </span>
<a href="#l26.7"></a><span id="l26.7">   closeTab: function onTabClosed(aTab) {</span>
<a href="#l26.8"></a><span id="l26.8">     aTab.browser.removeEventListener(&quot;DOMTitleChanged&quot;,</span>
<a href="#l26.9"></a><span id="l26.9">                                      aTab.titleListener, true);</span>
<a href="#l26.10"></a><span id="l26.10">     aTab.browser.removeEventListener(&quot;DOMWindowClose&quot;,</span>
<a href="#l26.11"></a><span id="l26.11">                                      aTab.closeListener, true);</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-    aTab.browser.removeEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler, false);</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+    aTab.browser.removeEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler);</span>
<a href="#l26.14"></a><span id="l26.14">     gPluginHandler.removeEventListeners(aTab.browser);</span>
<a href="#l26.15"></a><span id="l26.15">     aTab.browser.webProgress.removeProgressListener(aTab.filter);</span>
<a href="#l26.16"></a><span id="l26.16">     aTab.filter.removeProgressListener(aTab.progressListener);</span>
<a href="#l26.17"></a><span id="l26.17">     aTab.browser.destroy();</span>
<a href="#l26.18"></a><span id="l26.18">   },</span>
<a href="#l26.19"></a><span id="l26.19"> </span>
<a href="#l26.20"></a><span id="l26.20">   saveTabState: function onSaveTabState(aTab) {</span>
<a href="#l26.21"></a><span id="l26.21">     aTab.browser.setAttribute(&quot;type&quot;, &quot;content&quot;);</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineat">@@ -556,17 +556,17 @@ var specialTabs = {</span>
<a href="#l26.23"></a><span id="l26.23">     request.onerror = onDownloadError;</span>
<a href="#l26.24"></a><span id="l26.24">     request.timeout = this.REQUEST_TIMEOUT;</span>
<a href="#l26.25"></a><span id="l26.25">     request.ontimeout = onDownloadError;</span>
<a href="#l26.26"></a><span id="l26.26">     request.send(null);</span>
<a href="#l26.27"></a><span id="l26.27">   },</span>
<a href="#l26.28"></a><span id="l26.28"> </span>
<a href="#l26.29"></a><span id="l26.29">   // This will open any special tabs if necessary on startup.</span>
<a href="#l26.30"></a><span id="l26.30">   openSpecialTabsOnStartup: function() {</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, specialTabs.onunload, false);</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, specialTabs.onunload);</span>
<a href="#l26.33"></a><span id="l26.33"> </span>
<a href="#l26.34"></a><span id="l26.34">     let browser = document.getElementById(&quot;dummycontentbrowser&quot;);</span>
<a href="#l26.35"></a><span id="l26.35"> </span>
<a href="#l26.36"></a><span id="l26.36">     // Manually hook up session and global history for the first browser</span>
<a href="#l26.37"></a><span id="l26.37">     // so that we don't have to load global history before bringing up a</span>
<a href="#l26.38"></a><span id="l26.38">     // window.</span>
<a href="#l26.39"></a><span id="l26.39">     // Wire up session and global history before any possible</span>
<a href="#l26.40"></a><span id="l26.40">     // progress notifications for back/forward button updating</span>
<a href="#l26.41"></a><span id="l26.41" class="difflineat">@@ -690,17 +690,17 @@ var specialTabs = {</span>
<a href="#l26.42"></a><span id="l26.42">                           aArgs.clickHandler :</span>
<a href="#l26.43"></a><span id="l26.43">                           &quot;specialTabs.defaultClickHandler(event);&quot;;</span>
<a href="#l26.44"></a><span id="l26.44">       aTab.browser.setAttribute(&quot;onclick&quot;, aTab.clickHandler);</span>
<a href="#l26.45"></a><span id="l26.45"> </span>
<a href="#l26.46"></a><span id="l26.46">       // Set this attribute so that when favicons fail to load, we remove the</span>
<a href="#l26.47"></a><span id="l26.47">       // image attribute and just show the default tab icon.</span>
<a href="#l26.48"></a><span id="l26.48">       aTab.tabNode.setAttribute(&quot;onerror&quot;, &quot;this.removeAttribute('image');&quot;);</span>
<a href="#l26.49"></a><span id="l26.49"> </span>
<a href="#l26.50"></a><span id="l26.50" class="difflineminus">-      aTab.browser.addEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler, false);</span>
<a href="#l26.51"></a><span id="l26.51" class="difflineplus">+      aTab.browser.addEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler);</span>
<a href="#l26.52"></a><span id="l26.52">       gPluginHandler.addEventListeners(aTab.browser);</span>
<a href="#l26.53"></a><span id="l26.53"> </span>
<a href="#l26.54"></a><span id="l26.54">       // Now initialise the find bar.</span>
<a href="#l26.55"></a><span id="l26.55">       aTab.findbar = aTab.panel.querySelector(&quot;findbar&quot;);</span>
<a href="#l26.56"></a><span id="l26.56">       aTab.findbar.setAttribute(&quot;browserid&quot;,</span>
<a href="#l26.57"></a><span id="l26.57">                                 &quot;contentTabBrowser&quot; + this.lastBrowserId);</span>
<a href="#l26.58"></a><span id="l26.58"> </span>
<a href="#l26.59"></a><span id="l26.59">       // Default to reload being disabled.</span>
<a href="#l26.60"></a><span id="l26.60" class="difflineat">@@ -913,17 +913,17 @@ var specialTabs = {</span>
<a href="#l26.61"></a><span id="l26.61">     link.className = &quot;text-link telemetry-text-link&quot;;</span>
<a href="#l26.62"></a><span id="l26.62">     link.setAttribute(&quot;value&quot;, telemetryBundle.get(&quot;telemetryLinkLabel&quot;));</span>
<a href="#l26.63"></a><span id="l26.63">     link.addEventListener('click', function() {</span>
<a href="#l26.64"></a><span id="l26.64">       openPrivacyPolicy('tab');</span>
<a href="#l26.65"></a><span id="l26.65">       // Remove the notification on which the user clicked</span>
<a href="#l26.66"></a><span id="l26.66">       notification.parentNode.removeNotification(notification, true);</span>
<a href="#l26.67"></a><span id="l26.67">       // Add a new notification to that tab, with no &quot;Learn more&quot; link</span>
<a href="#l26.68"></a><span id="l26.68">       notifyBox.appendNotification(telemetryText, &quot;telemetry&quot;, null, notifyBox.PRIORITY_INFO_LOW, buttons);</span>
<a href="#l26.69"></a><span id="l26.69" class="difflineminus">-    }, false);</span>
<a href="#l26.70"></a><span id="l26.70" class="difflineplus">+    });</span>
<a href="#l26.71"></a><span id="l26.71"> </span>
<a href="#l26.72"></a><span id="l26.72">     let description = notification.ownerDocument.getAnonymousElementByAttribute(notification, &quot;anonid&quot;, &quot;messageText&quot;);</span>
<a href="#l26.73"></a><span id="l26.73">     description.appendChild(link);</span>
<a href="#l26.74"></a><span id="l26.74">   },</span>
<a href="#l26.75"></a><span id="l26.75">   /**</span>
<a href="#l26.76"></a><span id="l26.76">    * Looks at the existing prefs and determines if we should show about:rights</span>
<a href="#l26.77"></a><span id="l26.77">    * or not.</span>
<a href="#l26.78"></a><span id="l26.78">    *</span>
<a href="#l26.79"></a><span id="l26.79" class="difflineat">@@ -1137,17 +1137,17 @@ var specialTabs = {</span>
<a href="#l26.80"></a><span id="l26.80">                                 &quot;clickHandler&quot; in aArgs &amp;&amp; aArgs.clickHandler ?</span>
<a href="#l26.81"></a><span id="l26.81">                                 aArgs.clickHandler :</span>
<a href="#l26.82"></a><span id="l26.82">                                 &quot;specialTabs.defaultClickHandler(event);&quot;);</span>
<a href="#l26.83"></a><span id="l26.83"> </span>
<a href="#l26.84"></a><span id="l26.84">       // Set this attribute so that when favicons fail to load, we remove the</span>
<a href="#l26.85"></a><span id="l26.85">       // image attribute and just show the default tab icon.</span>
<a href="#l26.86"></a><span id="l26.86">       aTab.tabNode.setAttribute(&quot;onerror&quot;, &quot;this.removeAttribute('image');&quot;);</span>
<a href="#l26.87"></a><span id="l26.87"> </span>
<a href="#l26.88"></a><span id="l26.88" class="difflineminus">-      aTab.browser.addEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler, false);</span>
<a href="#l26.89"></a><span id="l26.89" class="difflineplus">+      aTab.browser.addEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler);</span>
<a href="#l26.90"></a><span id="l26.90"> </span>
<a href="#l26.91"></a><span id="l26.91"> </span>
<a href="#l26.92"></a><span id="l26.92">       aTab.browser.setAttribute(&quot;id&quot;, &quot;chromeTabBrowser&quot; + this.lastBrowserId);</span>
<a href="#l26.93"></a><span id="l26.93"> </span>
<a href="#l26.94"></a><span id="l26.94">       // Now set up the listeners.</span>
<a href="#l26.95"></a><span id="l26.95">       this._setUpTitleListener(aTab);</span>
<a href="#l26.96"></a><span id="l26.96">       this._setUpCloseWindowListener(aTab);</span>
<a href="#l26.97"></a><span id="l26.97">       if (&quot;onLoad&quot; in aArgs) {</span>
<a href="#l26.98"></a><span id="l26.98" class="difflineat">@@ -1172,17 +1172,17 @@ var specialTabs = {</span>
<a href="#l26.99"></a><span id="l26.99">         &amp;&amp; !docShell.contentViewer.permitUnload());</span>
<a href="#l26.100"></a><span id="l26.100">     },</span>
<a href="#l26.101"></a><span id="l26.101">     closeTab: function onTabClosed(aTab) {</span>
<a href="#l26.102"></a><span id="l26.102">       aTab.browser.removeEventListener(&quot;load&quot;, aTab.loadListener, true);</span>
<a href="#l26.103"></a><span id="l26.103">       aTab.browser.removeEventListener(&quot;DOMTitleChanged&quot;,</span>
<a href="#l26.104"></a><span id="l26.104">                                        aTab.titleListener, true);</span>
<a href="#l26.105"></a><span id="l26.105">       aTab.browser.removeEventListener(&quot;DOMWindowClose&quot;,</span>
<a href="#l26.106"></a><span id="l26.106">                                        aTab.closeListener, true);</span>
<a href="#l26.107"></a><span id="l26.107" class="difflineminus">-      aTab.browser.removeEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler, false);</span>
<a href="#l26.108"></a><span id="l26.108" class="difflineplus">+      aTab.browser.removeEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler);</span>
<a href="#l26.109"></a><span id="l26.109">       aTab.browser.destroy();</span>
<a href="#l26.110"></a><span id="l26.110">     },</span>
<a href="#l26.111"></a><span id="l26.111">     saveTabState: function onSaveTabState(aTab) {</span>
<a href="#l26.112"></a><span id="l26.112">     },</span>
<a href="#l26.113"></a><span id="l26.113">     showTab: function onShowTab(aTab) {</span>
<a href="#l26.114"></a><span id="l26.114">     },</span>
<a href="#l26.115"></a><span id="l26.115">     persistTab: function onPersistTab(aTab) {</span>
<a href="#l26.116"></a><span id="l26.116">       if (aTab.browser.currentURI.spec == &quot;about:blank&quot;)</span>
<a href="#l26.117"></a><span id="l26.117" class="difflineat">@@ -1313,17 +1313,17 @@ var specialTabs = {</span>
<a href="#l26.118"></a><span id="l26.118">                              false);</span>
<a href="#l26.119"></a><span id="l26.119">     Services.obs.addObserver(this.xpInstallObserver, &quot;addon-install-failed&quot;,</span>
<a href="#l26.120"></a><span id="l26.120">                              false);</span>
<a href="#l26.121"></a><span id="l26.121">     Services.obs.addObserver(this.xpInstallObserver, &quot;addon-install-complete&quot;,</span>
<a href="#l26.122"></a><span id="l26.122">                              false);</span>
<a href="#l26.123"></a><span id="l26.123">   },</span>
<a href="#l26.124"></a><span id="l26.124"> </span>
<a href="#l26.125"></a><span id="l26.125">   onunload: function () {</span>
<a href="#l26.126"></a><span id="l26.126" class="difflineminus">-    window.removeEventListener(&quot;unload&quot;, specialTabs.onunload, false);</span>
<a href="#l26.127"></a><span id="l26.127" class="difflineplus">+    window.removeEventListener(&quot;unload&quot;, specialTabs.onunload);</span>
<a href="#l26.128"></a><span id="l26.128"> </span>
<a href="#l26.129"></a><span id="l26.129">     Services.obs.removeObserver(specialTabs.xpInstallObserver,</span>
<a href="#l26.130"></a><span id="l26.130">                                 &quot;addon-install-disabled&quot;);</span>
<a href="#l26.131"></a><span id="l26.131">     Services.obs.removeObserver(specialTabs.xpInstallObserver,</span>
<a href="#l26.132"></a><span id="l26.132">                                 &quot;addon-install-blocked&quot;);</span>
<a href="#l26.133"></a><span id="l26.133">     Services.obs.removeObserver(specialTabs.xpInstallObserver,</span>
<a href="#l26.134"></a><span id="l26.134">                                 &quot;addon-install-failed&quot;);</span>
<a href="#l26.135"></a><span id="l26.135">     Services.obs.removeObserver(specialTabs.xpInstallObserver,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/base/content/tabmail.xml</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/base/content/tabmail.xml</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1748,42 +1748,42 @@</span>
<a href="#l27.4"></a><span id="l27.4">             this.mCollapseToolbar.collapsed = true;</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6">           this.firstChild.minWidth = this.mTabMinWidth;</span>
<a href="#l27.7"></a><span id="l27.7">           this.firstChild.maxWidth = this.mTabMaxWidth;</span>
<a href="#l27.8"></a><span id="l27.8">           this.adjustTabstrip();</span>
<a href="#l27.9"></a><span id="l27.9"> </span>
<a href="#l27.10"></a><span id="l27.10">           Services.prefs.addObserver(&quot;mail.tabs.&quot;, this._prefObserver, false);</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-          window.addEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+          window.addEventListener(&quot;resize&quot;, this);</span>
<a href="#l27.14"></a><span id="l27.14"> </span>
<a href="#l27.15"></a><span id="l27.15">           // Listen to overflow/underflow events on the tabstrip,</span>
<a href="#l27.16"></a><span id="l27.16">           // we cannot put these as xbl handlers on the entire binding because</span>
<a href="#l27.17"></a><span id="l27.17">           // they would also get called for the all-tabs popup scrollbox.</span>
<a href="#l27.18"></a><span id="l27.18">           // Also, we can't rely on event.target becuase these are all</span>
<a href="#l27.19"></a><span id="l27.19">           // anonymous nodes.</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineminus">-          this.mTabstrip.addEventListener(&quot;overflow&quot;, this, false);</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-          this.mTabstrip.addEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineplus">+          this.mTabstrip.addEventListener(&quot;overflow&quot;, this);</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+          this.mTabstrip.addEventListener(&quot;underflow&quot;, this);</span>
<a href="#l27.24"></a><span id="l27.24">         ]]&gt;</span>
<a href="#l27.25"></a><span id="l27.25">       &lt;/constructor&gt;</span>
<a href="#l27.26"></a><span id="l27.26"> </span>
<a href="#l27.27"></a><span id="l27.27">       &lt;destructor&gt;</span>
<a href="#l27.28"></a><span id="l27.28">         &lt;![CDATA[</span>
<a href="#l27.29"></a><span id="l27.29">           Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l27.30"></a><span id="l27.30"> </span>
<a href="#l27.31"></a><span id="l27.31">           Services.prefs.removeObserver(&quot;mail.tabs.&quot;, this._prefObserver);</span>
<a href="#l27.32"></a><span id="l27.32"> </span>
<a href="#l27.33"></a><span id="l27.33">           // Release timer to avoid reference cycles.</span>
<a href="#l27.34"></a><span id="l27.34">           if (this._animateTimer) {</span>
<a href="#l27.35"></a><span id="l27.35">             this._animateTimer.cancel();</span>
<a href="#l27.36"></a><span id="l27.36">             this._animateTimer = null;</span>
<a href="#l27.37"></a><span id="l27.37">           }</span>
<a href="#l27.38"></a><span id="l27.38"> </span>
<a href="#l27.39"></a><span id="l27.39" class="difflineminus">-          this.mTabstrip.removeEventListener(&quot;overflow&quot;, this, false);</span>
<a href="#l27.40"></a><span id="l27.40" class="difflineminus">-          this.mTabstrip.removeEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineplus">+          this.mTabstrip.removeEventListener(&quot;overflow&quot;, this);</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineplus">+          this.mTabstrip.removeEventListener(&quot;underflow&quot;, this);</span>
<a href="#l27.43"></a><span id="l27.43">         ]]&gt;</span>
<a href="#l27.44"></a><span id="l27.44">       &lt;/destructor&gt;</span>
<a href="#l27.45"></a><span id="l27.45"> </span>
<a href="#l27.46"></a><span id="l27.46">       &lt;field name=&quot;tabmail&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l27.47"></a><span id="l27.47">         document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l27.48"></a><span id="l27.48">       &lt;/field&gt;</span>
<a href="#l27.49"></a><span id="l27.49"> </span>
<a href="#l27.50"></a><span id="l27.50">       &lt;field name=&quot;tabbox&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l27.51"></a><span id="l27.51" class="difflineat">@@ -2510,19 +2510,19 @@</span>
<a href="#l27.52"></a><span id="l27.52"> </span>
<a href="#l27.53"></a><span id="l27.53">           menuItem.setAttribute(&quot;class&quot;, &quot;menuitem-iconic alltabs-item menuitem-with-favicon&quot;);</span>
<a href="#l27.54"></a><span id="l27.54"> </span>
<a href="#l27.55"></a><span id="l27.55">           this._setMenuitemAttributes(menuItem, aTab);</span>
<a href="#l27.56"></a><span id="l27.56"> </span>
<a href="#l27.57"></a><span id="l27.57">           // Keep some attributes of the menuitem in sync with its</span>
<a href="#l27.58"></a><span id="l27.58">           // corresponding tab (e.g. the tab label)</span>
<a href="#l27.59"></a><span id="l27.59">           aTab.mCorrespondingMenuitem = menuItem;</span>
<a href="#l27.60"></a><span id="l27.60" class="difflineminus">-          aTab.addEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l27.61"></a><span id="l27.61" class="difflineplus">+          aTab.addEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l27.62"></a><span id="l27.62">           menuItem.tab = aTab;</span>
<a href="#l27.63"></a><span id="l27.63" class="difflineminus">-          menuItem.addEventListener(&quot;command&quot;, this, false);</span>
<a href="#l27.64"></a><span id="l27.64" class="difflineplus">+          menuItem.addEventListener(&quot;command&quot;, this);</span>
<a href="#l27.65"></a><span id="l27.65"> </span>
<a href="#l27.66"></a><span id="l27.66">           this.appendChild(menuItem);</span>
<a href="#l27.67"></a><span id="l27.67">           return menuItem;</span>
<a href="#l27.68"></a><span id="l27.68">         ]]&gt;&lt;/body&gt;</span>
<a href="#l27.69"></a><span id="l27.69">       &lt;/method&gt;</span>
<a href="#l27.70"></a><span id="l27.70"> </span>
<a href="#l27.71"></a><span id="l27.71">       &lt;method name=&quot;_setMenuitemAttributes&quot;&gt;</span>
<a href="#l27.72"></a><span id="l27.72">         &lt;parameter name=&quot;aMenuitem&quot;/&gt;</span>
<a href="#l27.73"></a><span id="l27.73" class="difflineat">@@ -2567,44 +2567,44 @@</span>
<a href="#l27.74"></a><span id="l27.74"> </span>
<a href="#l27.75"></a><span id="l27.75">         // Listen for changes in the tab bar.</span>
<a href="#l27.76"></a><span id="l27.76">         this._mutationObserver.observe(tabcontainer, {</span>
<a href="#l27.77"></a><span id="l27.77">           attributes: true,</span>
<a href="#l27.78"></a><span id="l27.78">           subtree: true,</span>
<a href="#l27.79"></a><span id="l27.79">           attributeFilter: [&quot;label&quot;, &quot;crop&quot;, &quot;busy&quot;, &quot;image&quot;, &quot;selected&quot;]</span>
<a href="#l27.80"></a><span id="l27.80">         });</span>
<a href="#l27.81"></a><span id="l27.81"> </span>
<a href="#l27.82"></a><span id="l27.82" class="difflineminus">-        tabmail.addEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l27.83"></a><span id="l27.83" class="difflineminus">-        tabcontainer.mTabstrip.addEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l27.84"></a><span id="l27.84" class="difflineplus">+        tabmail.addEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l27.85"></a><span id="l27.85" class="difflineplus">+        tabcontainer.mTabstrip.addEventListener(&quot;scroll&quot;, this);</span>
<a href="#l27.86"></a><span id="l27.86"> </span>
<a href="#l27.87"></a><span id="l27.87">         // if an animation is in progress and the user</span>
<a href="#l27.88"></a><span id="l27.88">         // clicks on the &quot;all tabs&quot; button, stop the animation</span>
<a href="#l27.89"></a><span id="l27.89">         tabcontainer._stopAnimation();</span>
<a href="#l27.90"></a><span id="l27.90"> </span>
<a href="#l27.91"></a><span id="l27.91">         for (var i = 0; i &lt; tabs.length; i++) {</span>
<a href="#l27.92"></a><span id="l27.92">           this._createTabMenuItem(tabs[i]);</span>
<a href="#l27.93"></a><span id="l27.93">         }</span>
<a href="#l27.94"></a><span id="l27.94">         this._updateTabsVisibilityStatus();</span>
<a href="#l27.95"></a><span id="l27.95">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l27.96"></a><span id="l27.96"> </span>
<a href="#l27.97"></a><span id="l27.97">       &lt;handler event=&quot;popuphiding&quot;&gt;</span>
<a href="#l27.98"></a><span id="l27.98">       &lt;![CDATA[</span>
<a href="#l27.99"></a><span id="l27.99">         // clear out the menu popup and remove the listeners</span>
<a href="#l27.100"></a><span id="l27.100">         while (this.hasChildNodes()) {</span>
<a href="#l27.101"></a><span id="l27.101">           var menuItem = this.lastChild;</span>
<a href="#l27.102"></a><span id="l27.102" class="difflineminus">-          menuItem.removeEventListener(&quot;command&quot;, this, false);</span>
<a href="#l27.103"></a><span id="l27.103" class="difflineminus">-          menuItem.tab.removeEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l27.104"></a><span id="l27.104" class="difflineplus">+          menuItem.removeEventListener(&quot;command&quot;, this);</span>
<a href="#l27.105"></a><span id="l27.105" class="difflineplus">+          menuItem.tab.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l27.106"></a><span id="l27.106">           menuItem.tab.mCorrespondingMenuitem = null;</span>
<a href="#l27.107"></a><span id="l27.107">           menuItem.remove();</span>
<a href="#l27.108"></a><span id="l27.108">         }</span>
<a href="#l27.109"></a><span id="l27.109">         this._mutationObserver.disconnect();</span>
<a href="#l27.110"></a><span id="l27.110"> </span>
<a href="#l27.111"></a><span id="l27.111">         var tabcontainer = document.getElementById('tabmail').tabContainer;</span>
<a href="#l27.112"></a><span id="l27.112" class="difflineminus">-        tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l27.113"></a><span id="l27.113" class="difflineminus">-        tabcontainer.tabmail.removeEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l27.114"></a><span id="l27.114" class="difflineplus">+        tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this);</span>
<a href="#l27.115"></a><span id="l27.115" class="difflineplus">+        tabcontainer.tabmail.removeEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l27.116"></a><span id="l27.116">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l27.117"></a><span id="l27.117">     &lt;/handlers&gt;</span>
<a href="#l27.118"></a><span id="l27.118">   &lt;/binding&gt;</span>
<a href="#l27.119"></a><span id="l27.119">   &lt;!-- close-tab-button binding</span>
<a href="#l27.120"></a><span id="l27.120">        This binding relies on the structure of the tabmail-tabs binding.</span>
<a href="#l27.121"></a><span id="l27.121">        Therefore it should only be used as a child of the tab or the tabs</span>
<a href="#l27.122"></a><span id="l27.122">        element.  This binding is exposed as a pseudo-public-API so themes</span>
<a href="#l27.123"></a><span id="l27.123">        can customize the tabbar appearance without having to be scriptable</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mail/base/modules/quickFilterManager.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mail/base/modules/quickFilterManager.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -806,17 +806,17 @@ var TagFacetingFilter = {</span>
<a href="#l28.4"></a><span id="l28.4">   domBindExtra: function(aDocument, aMuxer, aNode) {</span>
<a href="#l28.5"></a><span id="l28.5">     // Tag filtering mode menu (All of/Any of)</span>
<a href="#l28.6"></a><span id="l28.6">     function commandHandler(aEvent) {</span>
<a href="#l28.7"></a><span id="l28.7">       let filterValue = aMuxer.getFilterValueForMutation(TagFacetingFilter.name);</span>
<a href="#l28.8"></a><span id="l28.8">       filterValue.mode = aEvent.target.value;</span>
<a href="#l28.9"></a><span id="l28.9">       aMuxer.updateSearch();</span>
<a href="#l28.10"></a><span id="l28.10">     }</span>
<a href="#l28.11"></a><span id="l28.11">     aDocument.getElementById(&quot;qfb-boolean-mode&quot;).addEventListener(</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-      &quot;ValueChange&quot;, commandHandler, false);</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+      &quot;ValueChange&quot;, commandHandler);</span>
<a href="#l28.14"></a><span id="l28.14">   },</span>
<a href="#l28.15"></a><span id="l28.15"> </span>
<a href="#l28.16"></a><span id="l28.16">   reflectInDOM: function TFF_reflectInDOM(aNode, aFilterValue,</span>
<a href="#l28.17"></a><span id="l28.17">                                           aDocument, aMuxer) {</span>
<a href="#l28.18"></a><span id="l28.18">     aNode.checked = aFilterValue ? true : false;</span>
<a href="#l28.19"></a><span id="l28.19">     if ((aFilterValue != null) &amp;&amp;</span>
<a href="#l28.20"></a><span id="l28.20">         (typeof(aFilterValue) == &quot;object&quot;))</span>
<a href="#l28.21"></a><span id="l28.21">       this._populateTagBar(aFilterValue, aDocument, aMuxer);</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineat">@@ -882,18 +882,18 @@ var TagFacetingFilter = {</span>
<a href="#l28.23"></a><span id="l28.23">         addCount++;</span>
<a href="#l28.24"></a><span id="l28.24"> </span>
<a href="#l28.25"></a><span id="l28.25">         // Keep in mind that the XBL does not get built for dynamically created</span>
<a href="#l28.26"></a><span id="l28.26">         //  elements such as these until they get displayed, which definitely</span>
<a href="#l28.27"></a><span id="l28.27">         //  means not before we append it into the tree.</span>
<a href="#l28.28"></a><span id="l28.28">         let button = aDocument.createElement(&quot;toolbarbutton&quot;);</span>
<a href="#l28.29"></a><span id="l28.29"> </span>
<a href="#l28.30"></a><span id="l28.30">         button.setAttribute(&quot;id&quot;, &quot;qfb-tag-&quot; + tag.key);</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineminus">-        button.addEventListener(&quot;command&quot;, commandHandler, false);</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineminus">-        button.addEventListener(&quot;click&quot;, rightClickHandler, false);</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineplus">+        button.addEventListener(&quot;command&quot;, commandHandler);</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineplus">+        button.addEventListener(&quot;click&quot;, rightClickHandler);</span>
<a href="#l28.35"></a><span id="l28.35">         button.setAttribute(&quot;type&quot;, &quot;checkbox&quot;);</span>
<a href="#l28.36"></a><span id="l28.36">         if (keywordMap[tag.key] !== null) {</span>
<a href="#l28.37"></a><span id="l28.37">           button.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l28.38"></a><span id="l28.38">           if (!keywordMap[tag.key])</span>
<a href="#l28.39"></a><span id="l28.39">             button.setAttribute(&quot;inverted&quot;, &quot;true&quot;);</span>
<a href="#l28.40"></a><span id="l28.40">         }</span>
<a href="#l28.41"></a><span id="l28.41">         button.setAttribute(&quot;label&quot;, tag.tag);</span>
<a href="#l28.42"></a><span id="l28.42">         button.setAttribute(&quot;value&quot;, tag.key);</span>
<a href="#l28.43"></a><span id="l28.43" class="difflineat">@@ -1082,17 +1082,17 @@ var MessageTextFilter = {</span>
<a href="#l28.44"></a><span id="l28.44">         // ...so explicitly select the current index.</span>
<a href="#l28.45"></a><span id="l28.45">         threadPane.view.selection.select(threadPane.currentIndex);</span>
<a href="#l28.46"></a><span id="l28.46">         return false;</span>
<a href="#l28.47"></a><span id="l28.47">       }</span>
<a href="#l28.48"></a><span id="l28.48">       // - Enter when upsell is actively proposed...</span>
<a href="#l28.49"></a><span id="l28.49">       else if (aEvent.keyCode == aEvent.DOM_VK_RETURN) {</span>
<a href="#l28.50"></a><span id="l28.50">       }</span>
<a href="#l28.51"></a><span id="l28.51">       return true;</span>
<a href="#l28.52"></a><span id="l28.52" class="difflineminus">-    }, false);</span>
<a href="#l28.53"></a><span id="l28.53" class="difflineplus">+    });</span>
<a href="#l28.54"></a><span id="l28.54"> </span>
<a href="#l28.55"></a><span id="l28.55">     // -- Blurring kills upsell.</span>
<a href="#l28.56"></a><span id="l28.56">     aNode.addEventListener(&quot;blur&quot;, function(aEvent) {</span>
<a href="#l28.57"></a><span id="l28.57">       let panel = aDocument.getElementById(&quot;qfb-text-search-upsell&quot;);</span>
<a href="#l28.58"></a><span id="l28.58">       if ((Services.focus.activeWindow != aDocument.defaultView ||</span>
<a href="#l28.59"></a><span id="l28.59">            aDocument.commandDispatcher.focusedElement != aNode.inputField) &amp;&amp;</span>
<a href="#l28.60"></a><span id="l28.60">           panel.state == &quot;open&quot;) {</span>
<a href="#l28.61"></a><span id="l28.61">         panel.hidePopup();</span>
<a href="#l28.62"></a><span id="l28.62" class="difflineat">@@ -1105,17 +1105,17 @@ var MessageTextFilter = {</span>
<a href="#l28.63"></a><span id="l28.63">       let filterDef = MessageTextFilter.textFilterDefsByDomId[aEvent.target.id];</span>
<a href="#l28.64"></a><span id="l28.64">       state.states[filterDef.name] = aEvent.target.checked;</span>
<a href="#l28.65"></a><span id="l28.65">       aMuxer.updateSearch();</span>
<a href="#l28.66"></a><span id="l28.66">     }</span>
<a href="#l28.67"></a><span id="l28.67"> </span>
<a href="#l28.68"></a><span id="l28.68">     for (let name in this.textFilterDefs) {</span>
<a href="#l28.69"></a><span id="l28.69">       let textFilter  = this.textFilterDefs[name];</span>
<a href="#l28.70"></a><span id="l28.70">       aDocument.getElementById(textFilter.domId).addEventListener(</span>
<a href="#l28.71"></a><span id="l28.71" class="difflineminus">-        &quot;command&quot;, commandHandler, false);</span>
<a href="#l28.72"></a><span id="l28.72" class="difflineplus">+        &quot;command&quot;, commandHandler);</span>
<a href="#l28.73"></a><span id="l28.73">     }</span>
<a href="#l28.74"></a><span id="l28.74">   },</span>
<a href="#l28.75"></a><span id="l28.75"> </span>
<a href="#l28.76"></a><span id="l28.76">   onCommand: function(aState, aNode, aEvent, aDocument) {</span>
<a href="#l28.77"></a><span id="l28.77">     let text = aNode.value.length ? aNode.value : null;</span>
<a href="#l28.78"></a><span id="l28.78">     if (text == aState.text) {</span>
<a href="#l28.79"></a><span id="l28.79">       let upsell = aDocument.getElementById(&quot;qfb-text-search-upsell&quot;);</span>
<a href="#l28.80"></a><span id="l28.80">       if (upsell.state == &quot;open&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mail/components/cloudfile/content/addAccountDialog.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mail/components/cloudfile/content/addAccountDialog.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -73,17 +73,17 @@ var addAccountDialog = {</span>
<a href="#l29.4"></a><span id="l29.4">     this.removeTitleMenuItem();</span>
<a href="#l29.5"></a><span id="l29.5"> </span>
<a href="#l29.6"></a><span id="l29.6">     // Determine whether any account types were added to the menulist,</span>
<a href="#l29.7"></a><span id="l29.7">     // if not, return early.</span>
<a href="#l29.8"></a><span id="l29.8">     if (this.addAccountTypes() == 0)</span>
<a href="#l29.9"></a><span id="l29.9">       return;</span>
<a href="#l29.10"></a><span id="l29.10"> </span>
<a href="#l29.11"></a><span id="l29.11">     // Hook up our onInput event handler</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-    this._settings.addEventListener(&quot;DOMContentLoaded&quot;, this, false);</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+    this._settings.addEventListener(&quot;DOMContentLoaded&quot;, this);</span>
<a href="#l29.14"></a><span id="l29.14"> </span>
<a href="#l29.15"></a><span id="l29.15">     this._settings.addEventListener(&quot;overflow&quot;, this);</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17">     // Hook up the selection handler.</span>
<a href="#l29.18"></a><span id="l29.18">     this._accountType.addEventListener(&quot;select&quot;, this);</span>
<a href="#l29.19"></a><span id="l29.19">     // Also call it to run it for the default selection.</span>
<a href="#l29.20"></a><span id="l29.20">     addAccountDialog.accountTypeSelected();</span>
<a href="#l29.21"></a><span id="l29.21"> </span>
<a href="#l29.22"></a><span id="l29.22" class="difflineat">@@ -99,17 +99,17 @@ var addAccountDialog = {</span>
<a href="#l29.23"></a><span id="l29.23">     // listener, so we'll call the function here manually.</span>
<a href="#l29.24"></a><span id="l29.24">     this.onIFrameLoaded(null);</span>
<a href="#l29.25"></a><span id="l29.25"> </span>
<a href="#l29.26"></a><span id="l29.26">     addAccountDialog.fitIFrame();</span>
<a href="#l29.27"></a><span id="l29.27">   },</span>
<a href="#l29.28"></a><span id="l29.28"> </span>
<a href="#l29.29"></a><span id="l29.29">   onUnInit: function() {</span>
<a href="#l29.30"></a><span id="l29.30">     // Clean-up the event listeners.</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineminus">-    this._settings.removeEventListener(&quot;DOMContentLoaded&quot;, this, false);</span>
<a href="#l29.32"></a><span id="l29.32" class="difflineplus">+    this._settings.removeEventListener(&quot;DOMContentLoaded&quot;, this);</span>
<a href="#l29.33"></a><span id="l29.33">     this._settings.removeEventListener(&quot;overflow&quot;, this);</span>
<a href="#l29.34"></a><span id="l29.34">     this._accountType.removeEventListener(&quot;select&quot;, this);</span>
<a href="#l29.35"></a><span id="l29.35"> </span>
<a href="#l29.36"></a><span id="l29.36">     return true;</span>
<a href="#l29.37"></a><span id="l29.37">   },</span>
<a href="#l29.38"></a><span id="l29.38"> </span>
<a href="#l29.39"></a><span id="l29.39">   handleEvent: function(aEvent) {</span>
<a href="#l29.40"></a><span id="l29.40">     switch (aEvent.type) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -2602,18 +2602,18 @@ function ComposeStartup(aParams)</span>
<a href="#l30.4"></a><span id="l30.4"> </span>
<a href="#l30.5"></a><span id="l30.5">   // Observe dictionary removals.</span>
<a href="#l30.6"></a><span id="l30.6">   dictionaryRemovalObserver.addObserver();</span>
<a href="#l30.7"></a><span id="l30.7"> </span>
<a href="#l30.8"></a><span id="l30.8">   var identityList = document.getElementById(&quot;msgIdentity&quot;);</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10">   document.addEventListener(&quot;keypress&quot;, awDocumentKeyPress, true);</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-  document.addEventListener(&quot;paste&quot;, onPasteOrDrop, false);</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-  document.addEventListener(&quot;drop&quot;, onPasteOrDrop, false);</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+  document.addEventListener(&quot;paste&quot;, onPasteOrDrop);</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+  document.addEventListener(&quot;drop&quot;, onPasteOrDrop);</span>
<a href="#l30.16"></a><span id="l30.16"> </span>
<a href="#l30.17"></a><span id="l30.17">   if (identityList)</span>
<a href="#l30.18"></a><span id="l30.18">     FillIdentityList(identityList);</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20">   if (!params) {</span>
<a href="#l30.21"></a><span id="l30.21">     // This code will go away soon as now arguments are passed to the window using a object of type nsMsgComposeParams instead of a string</span>
<a href="#l30.22"></a><span id="l30.22"> </span>
<a href="#l30.23"></a><span id="l30.23">     params = Components.classes[&quot;@mozilla.org/messengercompose/composeparams;1&quot;].createInstance(Components.interfaces.nsIMsgComposeParams);</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineat">@@ -4429,17 +4429,17 @@ function AddAttachments(aAttachments, aC</span>
<a href="#l30.25"></a><span id="l30.25">       gAttachmentsSize += attachment.size;</span>
<a href="#l30.26"></a><span id="l30.26"> </span>
<a href="#l30.27"></a><span id="l30.27">     try {</span>
<a href="#l30.28"></a><span id="l30.28">       item.setAttribute(&quot;tooltiptext&quot;, decodeURI(attachment.url));</span>
<a href="#l30.29"></a><span id="l30.29">     }</span>
<a href="#l30.30"></a><span id="l30.30">     catch(e) {</span>
<a href="#l30.31"></a><span id="l30.31">       item.setAttribute(&quot;tooltiptext&quot;, attachment.url);</span>
<a href="#l30.32"></a><span id="l30.32">     }</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineminus">-    item.addEventListener(&quot;command&quot;, OpenSelectedAttachment, false);</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+    item.addEventListener(&quot;command&quot;, OpenSelectedAttachment);</span>
<a href="#l30.35"></a><span id="l30.35"> </span>
<a href="#l30.36"></a><span id="l30.36">     if (attachment.sendViaCloud) {</span>
<a href="#l30.37"></a><span id="l30.37">       try {</span>
<a href="#l30.38"></a><span id="l30.38">         let cloudProvider = cloudFileAccounts.getAccount(attachment.cloudProviderKey);</span>
<a href="#l30.39"></a><span id="l30.39">         item.cloudProvider = cloudProvider;</span>
<a href="#l30.40"></a><span id="l30.40">         item.image = cloudProvider.iconClass;</span>
<a href="#l30.41"></a><span id="l30.41">         item.originalUrl = attachment.url;</span>
<a href="#l30.42"></a><span id="l30.42">       } catch (ex) {dump(ex);}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mail/components/compose/content/bigFileObserver.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mail/components/compose/content/bigFileObserver.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -24,22 +24,22 @@ var gBigFileObserver = {</span>
<a href="#l31.4"></a><span id="l31.4">     if (aPermanent)</span>
<a href="#l31.5"></a><span id="l31.5">       Services.prefs.setBoolPref(&quot;mail.compose.big_attachments.notify&quot;, false);</span>
<a href="#l31.6"></a><span id="l31.6">     else</span>
<a href="#l31.7"></a><span id="l31.7">       this.sessionHidden = true;</span>
<a href="#l31.8"></a><span id="l31.8">   },</span>
<a href="#l31.9"></a><span id="l31.9"> </span>
<a href="#l31.10"></a><span id="l31.10">   init: function() {</span>
<a href="#l31.11"></a><span id="l31.11">     let bucket = document.getElementById(&quot;attachmentBucket&quot;);</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-    bucket.addEventListener(&quot;attachments-added&quot;, this, false);</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-    bucket.addEventListener(&quot;attachments-removed&quot;, this, false);</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineminus">-    bucket.addEventListener(&quot;attachments-uploading&quot;, this, false);</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineminus">-    bucket.addEventListener(&quot;attachment-uploaded&quot;, this, false);</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineminus">-    bucket.addEventListener(&quot;attachment-upload-failed&quot;, this, false);</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineminus">-    bucket.addEventListener(&quot;attachments-converted&quot;, this, false);</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+    bucket.addEventListener(&quot;attachments-added&quot;, this);</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineplus">+    bucket.addEventListener(&quot;attachments-removed&quot;, this);</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineplus">+    bucket.addEventListener(&quot;attachments-uploading&quot;, this);</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineplus">+    bucket.addEventListener(&quot;attachment-uploaded&quot;, this);</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineplus">+    bucket.addEventListener(&quot;attachment-upload-failed&quot;, this);</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineplus">+    bucket.addEventListener(&quot;attachments-converted&quot;, this);</span>
<a href="#l31.24"></a><span id="l31.24"> </span>
<a href="#l31.25"></a><span id="l31.25">     this.sessionHidden = false;</span>
<a href="#l31.26"></a><span id="l31.26">     this.privacyWarned = false;</span>
<a href="#l31.27"></a><span id="l31.27">     this.bigFiles = [];</span>
<a href="#l31.28"></a><span id="l31.28">   },</span>
<a href="#l31.29"></a><span id="l31.29"> </span>
<a href="#l31.30"></a><span id="l31.30">   handleEvent: function(event) {</span>
<a href="#l31.31"></a><span id="l31.31">     if (this.hidden)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/components/compose/content/cloudAttachmentLinkManager.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/components/compose/content/cloudAttachmentLinkManager.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -2,19 +2,19 @@</span>
<a href="#l32.4"></a><span id="l32.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l32.5"></a><span id="l32.5">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.6"></a><span id="l32.6"> </span>
<a href="#l32.7"></a><span id="l32.7"> var gCloudAttachmentLinkManager = {</span>
<a href="#l32.8"></a><span id="l32.8">   init: function() {</span>
<a href="#l32.9"></a><span id="l32.9">     this.cloudAttachments = [];</span>
<a href="#l32.10"></a><span id="l32.10"> </span>
<a href="#l32.11"></a><span id="l32.11">     let bucket = document.getElementById(&quot;attachmentBucket&quot;);</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-    bucket.addEventListener(&quot;attachment-uploaded&quot;, this, false);</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-    bucket.addEventListener(&quot;attachments-removed&quot;, this, false);</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineminus">-    bucket.addEventListener(&quot;attachments-converted&quot;, this, false);</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineplus">+    bucket.addEventListener(&quot;attachment-uploaded&quot;, this);</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineplus">+    bucket.addEventListener(&quot;attachments-removed&quot;, this);</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+    bucket.addEventListener(&quot;attachments-converted&quot;, this);</span>
<a href="#l32.18"></a><span id="l32.18"> </span>
<a href="#l32.19"></a><span id="l32.19">     // If we're restoring a draft that has some attachments,</span>
<a href="#l32.20"></a><span id="l32.20">     // check to see if any of them are marked to be sent via</span>
<a href="#l32.21"></a><span id="l32.21">     // cloud, and if so, add them to our list.</span>
<a href="#l32.22"></a><span id="l32.22">     for (let i = 0; i &lt; bucket.getRowCount(); ++i) {</span>
<a href="#l32.23"></a><span id="l32.23">       let attachment = bucket.getItemAtIndex(i).attachment;</span>
<a href="#l32.24"></a><span id="l32.24">       if (attachment &amp;&amp; attachment.sendViaCloud)</span>
<a href="#l32.25"></a><span id="l32.25">         this.cloudAttachments.push(attachment);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mail/components/im/content/imStatusSelector.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mail/components/im/content/imStatusSelector.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -170,17 +170,17 @@ var statusSelector = {</span>
<a href="#l33.4"></a><span id="l33.4">       delete this._statusTypeBeforeEditing;</span>
<a href="#l33.5"></a><span id="l33.5">       delete this._statusTypeEditing;</span>
<a href="#l33.6"></a><span id="l33.6">     }</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8">     if (elt.hasAttribute(&quot;usingDefault&quot;))</span>
<a href="#l33.9"></a><span id="l33.9">       elt.setAttribute(&quot;value&quot;, elt.getAttribute(&quot;usingDefault&quot;));</span>
<a href="#l33.10"></a><span id="l33.10">     TextboxSpellChecker.unregisterTextbox(elt);</span>
<a href="#l33.11"></a><span id="l33.11">     elt.removeAttribute(&quot;editing&quot;);</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-    elt.removeEventListener(&quot;blur&quot;, this.statusMessageBlur, false);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+    elt.removeEventListener(&quot;blur&quot;, this.statusMessageBlur);</span>
<a href="#l33.14"></a><span id="l33.14"> </span>
<a href="#l33.15"></a><span id="l33.15">     // We need to put the focus back on the label after the textbox</span>
<a href="#l33.16"></a><span id="l33.16">     // binding has been detached, otherwise the focus gets lost (it's</span>
<a href="#l33.17"></a><span id="l33.17">     // on none of the elements in the document), but before that we</span>
<a href="#l33.18"></a><span id="l33.18">     // need to flush the layout.</span>
<a href="#l33.19"></a><span id="l33.19">     elt.getBoundingClientRect();</span>
<a href="#l33.20"></a><span id="l33.20">     elt.focus();</span>
<a href="#l33.21"></a><span id="l33.21">   },</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineat">@@ -250,18 +250,18 @@ var statusSelector = {</span>
<a href="#l33.23"></a><span id="l33.23">     let elt = document.getElementById(&quot;displayName&quot;);</span>
<a href="#l33.24"></a><span id="l33.24">     // Apply the new display name only if it is different from the current one.</span>
<a href="#l33.25"></a><span id="l33.25">     if (aSave &amp;&amp; elt.value != elt.getAttribute(&quot;value&quot;))</span>
<a href="#l33.26"></a><span id="l33.26">       Services.core.globalUserStatus.displayName = elt.value;</span>
<a href="#l33.27"></a><span id="l33.27">     else if (elt.hasAttribute(&quot;usingDefault&quot;))</span>
<a href="#l33.28"></a><span id="l33.28">       elt.setAttribute(&quot;value&quot;, elt.getAttribute(&quot;usingDefault&quot;));</span>
<a href="#l33.29"></a><span id="l33.29"> </span>
<a href="#l33.30"></a><span id="l33.30">     elt.removeAttribute(&quot;editing&quot;);</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-    elt.removeEventListener(&quot;keypress&quot;, this.displayNameKeyPress, false);</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineminus">-    elt.removeEventListener(&quot;blur&quot;, this.displayNameBlur, false);</span>
<a href="#l33.33"></a><span id="l33.33" class="difflineplus">+    elt.removeEventListener(&quot;keypress&quot;, this.displayNameKeyPress);</span>
<a href="#l33.34"></a><span id="l33.34" class="difflineplus">+    elt.removeEventListener(&quot;blur&quot;, this.displayNameBlur);</span>
<a href="#l33.35"></a><span id="l33.35">   },</span>
<a href="#l33.36"></a><span id="l33.36"> </span>
<a href="#l33.37"></a><span id="l33.37">   init: function ss_load() {</span>
<a href="#l33.38"></a><span id="l33.38">     let events = [&quot;status-changed&quot;];</span>
<a href="#l33.39"></a><span id="l33.39">     statusSelector.displayCurrentStatus();</span>
<a href="#l33.40"></a><span id="l33.40"> </span>
<a href="#l33.41"></a><span id="l33.41">     if (document.getElementById(&quot;displayName&quot;)) {</span>
<a href="#l33.42"></a><span id="l33.42">       events.push(&quot;user-display-name-changed&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mail/components/im/content/imcontact.xml</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mail/components/im/content/imcontact.xml</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -143,18 +143,17 @@</span>
<a href="#l34.4"></a><span id="l34.4">         // trigger a re-order (and a removeContact call), which sets</span>
<a href="#l34.5"></a><span id="l34.5">         // this.parentNode to undefined.</span>
<a href="#l34.6"></a><span id="l34.6">         let listbox = this.parentNode;</span>
<a href="#l34.7"></a><span id="l34.7">         if (aSave) {</span>
<a href="#l34.8"></a><span id="l34.8">           this.contact.alias = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;,</span>
<a href="#l34.9"></a><span id="l34.9">                                                                        &quot;displayname&quot;).value;</span>
<a href="#l34.10"></a><span id="l34.10">         }</span>
<a href="#l34.11"></a><span id="l34.11">         this.removeAttribute(&quot;aliasing&quot;);</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-        listbox.removeEventListener(&quot;select&quot;, this._parentSelectListener,</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineminus">-                                    false);</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+        listbox.removeEventListener(&quot;select&quot;, this._parentSelectListener);</span>
<a href="#l34.15"></a><span id="l34.15">         delete this._parentSelectListener;</span>
<a href="#l34.16"></a><span id="l34.16">         listbox.focus();</span>
<a href="#l34.17"></a><span id="l34.17">       ]]&gt;</span>
<a href="#l34.18"></a><span id="l34.18">       &lt;/body&gt;</span>
<a href="#l34.19"></a><span id="l34.19">      &lt;/method&gt;</span>
<a href="#l34.20"></a><span id="l34.20"> </span>
<a href="#l34.21"></a><span id="l34.21">      &lt;method name=&quot;deleteContact&quot;&gt;</span>
<a href="#l34.22"></a><span id="l34.22">       &lt;body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/components/im/content/imconversation.xml</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/components/im/content/imconversation.xml</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1763,17 +1763,17 @@</span>
<a href="#l35.4"></a><span id="l35.4">          if (aSave) {</span>
<a href="#l35.5"></a><span id="l35.5">            // apply the new topic only if it is different from the current one</span>
<a href="#l35.6"></a><span id="l35.6">            if (elt.value != elt.getAttribute(&quot;value&quot;))</span>
<a href="#l35.7"></a><span id="l35.7">              convBinding._conv.topic = elt.value;</span>
<a href="#l35.8"></a><span id="l35.8">          }</span>
<a href="#l35.9"></a><span id="l35.9">          this.removeAttribute(&quot;editing&quot;);</span>
<a href="#l35.10"></a><span id="l35.10">          elt.removeEventListener(&quot;keypress&quot;, this._topicKeyPress, true);</span>
<a href="#l35.11"></a><span id="l35.11">          delete this._topicKeyPress;</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-         elt.removeEventListener(&quot;blur&quot;, this._topicBlur, false);</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+         elt.removeEventListener(&quot;blur&quot;, this._topicBlur);</span>
<a href="#l35.14"></a><span id="l35.14">          delete this._topicBlur;</span>
<a href="#l35.15"></a><span id="l35.15"> </span>
<a href="#l35.16"></a><span id="l35.16">          // After removing the &quot;editing&quot; attribute, the focus is on an element</span>
<a href="#l35.17"></a><span id="l35.17">          // that can't receive keyboard events, so move it to somewhere else.</span>
<a href="#l35.18"></a><span id="l35.18">          convBinding.editor.focus();</span>
<a href="#l35.19"></a><span id="l35.19">        ]]&gt;</span>
<a href="#l35.20"></a><span id="l35.20">        &lt;/body&gt;</span>
<a href="#l35.21"></a><span id="l35.21">      &lt;/method&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mail/components/preferences/preferencesTab.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mail/components/preferences/preferencesTab.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -65,17 +65,17 @@ var preferencesTabType = {</span>
<a href="#l36.4"></a><span id="l36.4"> </span>
<a href="#l36.5"></a><span id="l36.5">     aTab.panel.appendChild(clone);</span>
<a href="#l36.6"></a><span id="l36.6"> </span>
<a href="#l36.7"></a><span id="l36.7">     // Start setting up the browser.</span>
<a href="#l36.8"></a><span id="l36.8">     aTab.browser = aTab.panel.querySelector(&quot;browser&quot;);</span>
<a href="#l36.9"></a><span id="l36.9"> </span>
<a href="#l36.10"></a><span id="l36.10">     aTab.browser.setAttribute(&quot;id&quot;, &quot;preferencesTabBrowser&quot; + this.lastBrowserId);</span>
<a href="#l36.11"></a><span id="l36.11"> </span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-    aTab.browser.addEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler, false);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+    aTab.browser.addEventListener(&quot;DOMLinkAdded&quot;, DOMLinkHandler);</span>
<a href="#l36.14"></a><span id="l36.14"> </span>
<a href="#l36.15"></a><span id="l36.15">     // Default to reload being disabled.</span>
<a href="#l36.16"></a><span id="l36.16">     aTab.reloadEnabled = false;</span>
<a href="#l36.17"></a><span id="l36.17"> </span>
<a href="#l36.18"></a><span id="l36.18">     aTab.url = aArgs.contentPage;</span>
<a href="#l36.19"></a><span id="l36.19">     aTab.paneID = aArgs.paneID;</span>
<a href="#l36.20"></a><span id="l36.20">     aTab.tabID = aArgs.tabID;</span>
<a href="#l36.21"></a><span id="l36.21">     aTab.otherArgs = aArgs.otherArgs;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mail/extensions/mailviews/content/msgViewPickerOverlay.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mail/extensions/mailviews/content/msgViewPickerOverlay.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -75,18 +75,17 @@ function ViewChangeByMenuitem(aMenuitem)</span>
<a href="#l37.4"></a><span id="l37.4">  * Mediates interaction with the #viewPickerPopup.  In theory this should be</span>
<a href="#l37.5"></a><span id="l37.5">  *  an XBL binding, but for the insanity where the view picker may not be</span>
<a href="#l37.6"></a><span id="l37.6">  *  visible at all times (or ever).  No view picker widget, no binding.</span>
<a href="#l37.7"></a><span id="l37.7">  */</span>
<a href="#l37.8"></a><span id="l37.8"> var ViewPickerBinding = {</span>
<a href="#l37.9"></a><span id="l37.9">   _init: function ViewPickerBinding_init() {</span>
<a href="#l37.10"></a><span id="l37.10">     window.addEventListener(</span>
<a href="#l37.11"></a><span id="l37.11">       &quot;MailViewChanged&quot;,</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-      function(aEvent) { ViewPickerBinding.updateDisplay(aEvent); },</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-      false);</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+      function(aEvent) { ViewPickerBinding.updateDisplay(aEvent); });</span>
<a href="#l37.15"></a><span id="l37.15">   },</span>
<a href="#l37.16"></a><span id="l37.16"> </span>
<a href="#l37.17"></a><span id="l37.17">   /**</span>
<a href="#l37.18"></a><span id="l37.18">    * Return true if the view picker is visible.  This is used by the</span>
<a href="#l37.19"></a><span id="l37.19">    *  FolderDisplayWidget to know whether or not to actually use mailviews. (The</span>
<a href="#l37.20"></a><span id="l37.20">    *  idea is that if we are not visible, then it would be confusing to the user</span>
<a href="#l37.21"></a><span id="l37.21">    *  if we filtered their mail since they would have no feedback about this and</span>
<a href="#l37.22"></a><span id="l37.22">    *  no way to change it.)</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineat">@@ -254,9 +253,9 @@ function RefreshTagsPopup(aMenupopup)</span>
<a href="#l37.24"></a><span id="l37.24"> function ViewPickerOnLoad()</span>
<a href="#l37.25"></a><span id="l37.25"> {</span>
<a href="#l37.26"></a><span id="l37.26">   var viewPickerPopup = document.getElementById(&quot;viewPickerPopup&quot;);</span>
<a href="#l37.27"></a><span id="l37.27">   if (viewPickerPopup)</span>
<a href="#l37.28"></a><span id="l37.28">     RefreshAllViewPopups(viewPickerPopup, true);</span>
<a href="#l37.29"></a><span id="l37.29"> }</span>
<a href="#l37.30"></a><span id="l37.30"> </span>
<a href="#l37.31"></a><span id="l37.31"> </span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-window.addEventListener(&quot;load&quot;, ViewPickerOnLoad, false);</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineplus">+window.addEventListener(&quot;load&quot;, ViewPickerOnLoad);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mail/extensions/smime/content/msgHdrViewSMIMEOverlay.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -205,18 +205,18 @@ function onSMIMEBeforeShowHeaderPane() {</span>
<a href="#l38.4"></a><span id="l38.4">     gExpandedHeaderView.sender.enclosingRow.collapsed = true;</span>
<a href="#l38.5"></a><span id="l38.5">     delete gExpandedHeaderView.sender;</span>
<a href="#l38.6"></a><span id="l38.6">   }</span>
<a href="#l38.7"></a><span id="l38.7"> }</span>
<a href="#l38.8"></a><span id="l38.8"> </span>
<a href="#l38.9"></a><span id="l38.9"> function msgHdrViewSMIMEOnLoad(event)</span>
<a href="#l38.10"></a><span id="l38.10"> {</span>
<a href="#l38.11"></a><span id="l38.11">   window.crypto.enableSmartCardEvents = true;</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-  document.addEventListener(&quot;smartcard-insert&quot;, onSmartCardChange, false);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-  document.addEventListener(&quot;smartcard-remove&quot;, onSmartCardChange, false);</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+  document.addEventListener(&quot;smartcard-insert&quot;, onSmartCardChange);</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineplus">+  document.addEventListener(&quot;smartcard-remove&quot;, onSmartCardChange);</span>
<a href="#l38.16"></a><span id="l38.16">   if (!gSMIMEBundle)</span>
<a href="#l38.17"></a><span id="l38.17">     gSMIMEBundle = document.getElementById(&quot;bundle_read_smime&quot;);</span>
<a href="#l38.18"></a><span id="l38.18"> </span>
<a href="#l38.19"></a><span id="l38.19">   // we want to register our security header sink as an opaque nsISupports</span>
<a href="#l38.20"></a><span id="l38.20">   // on the msgHdrSink used by mail.....</span>
<a href="#l38.21"></a><span id="l38.21">   msgWindow.msgHeaderSink.securityInfo = smimeHeaderSink;</span>
<a href="#l38.22"></a><span id="l38.22"> </span>
<a href="#l38.23"></a><span id="l38.23">   gSignedUINode = document.getElementById('signedHdrIcon');</span>
<a href="#l38.24"></a><span id="l38.24" class="difflineat">@@ -235,18 +235,18 @@ function msgHdrViewSMIMEOnLoad(event)</span>
<a href="#l38.25"></a><span id="l38.25">   gEncryptedURIService =</span>
<a href="#l38.26"></a><span id="l38.26">     Components.classes[&quot;@mozilla.org/messenger-smime/smime-encrypted-uris-service;1&quot;]</span>
<a href="#l38.27"></a><span id="l38.27">     .getService(Components.interfaces.nsIEncryptedSMIMEURIsService);</span>
<a href="#l38.28"></a><span id="l38.28"> }</span>
<a href="#l38.29"></a><span id="l38.29"> </span>
<a href="#l38.30"></a><span id="l38.30"> function msgHdrViewSMIMEOnUnload(event)</span>
<a href="#l38.31"></a><span id="l38.31"> {</span>
<a href="#l38.32"></a><span id="l38.32">   window.crypto.enableSmartCardEvents = false;</span>
<a href="#l38.33"></a><span id="l38.33" class="difflineminus">-  document.removeEventListener(&quot;smartcard-insert&quot;, onSmartCardChange, false);</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineminus">-  document.removeEventListener(&quot;smartcard-remove&quot;, onSmartCardChange, false);</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineplus">+  document.removeEventListener(&quot;smartcard-insert&quot;, onSmartCardChange);</span>
<a href="#l38.36"></a><span id="l38.36" class="difflineplus">+  document.removeEventListener(&quot;smartcard-remove&quot;, onSmartCardChange);</span>
<a href="#l38.37"></a><span id="l38.37">   forgetEncryptedURI();</span>
<a href="#l38.38"></a><span id="l38.38">   removeEventListener('messagepane-loaded', msgHdrViewSMIMEOnLoad, true);</span>
<a href="#l38.39"></a><span id="l38.39">   removeEventListener('messagepane-unloaded', msgHdrViewSMIMEOnUnload, true);</span>
<a href="#l38.40"></a><span id="l38.40">   removeEventListener('messagepane-hide', msgHdrViewSMIMEOnMessagePaneHide, true);</span>
<a href="#l38.41"></a><span id="l38.41">   removeEventListener('messagepane-unhide', msgHdrViewSMIMEOnMessagePaneUnhide, true);</span>
<a href="#l38.42"></a><span id="l38.42"> }</span>
<a href="#l38.43"></a><span id="l38.43"> </span>
<a href="#l38.44"></a><span id="l38.44"> function msgHdrViewSMIMEOnMessagePaneHide()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mail/test/mozmill/attachment/test-attachment-events.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mail/test/mozmill/attachment/test-attachment-events.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -46,17 +46,17 @@ function test_attachments_added_on_singl</span>
<a href="#l39.4"></a><span id="l39.4">   let lastEvent;</span>
<a href="#l39.5"></a><span id="l39.5">   let listener = function(event) {</span>
<a href="#l39.6"></a><span id="l39.6">     eventCount++;</span>
<a href="#l39.7"></a><span id="l39.7">     lastEvent = event;</span>
<a href="#l39.8"></a><span id="l39.8">   }</span>
<a href="#l39.9"></a><span id="l39.9"> </span>
<a href="#l39.10"></a><span id="l39.10">   // Open up the compose window</span>
<a href="#l39.11"></a><span id="l39.11">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsAdded, listener, false);</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsAdded, listener);</span>
<a href="#l39.14"></a><span id="l39.14"> </span>
<a href="#l39.15"></a><span id="l39.15">   // Attach a single file</span>
<a href="#l39.16"></a><span id="l39.16">   add_attachment(cw, &quot;http://www.example.com/1&quot;, 0);</span>
<a href="#l39.17"></a><span id="l39.17"> </span>
<a href="#l39.18"></a><span id="l39.18">   // Make sure we only saw the event once</span>
<a href="#l39.19"></a><span id="l39.19">   assert_equals(1, eventCount);</span>
<a href="#l39.20"></a><span id="l39.20"> </span>
<a href="#l39.21"></a><span id="l39.21">   // Make sure that we were passed the right subject</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineat">@@ -74,18 +74,17 @@ function test_attachments_added_on_singl</span>
<a href="#l39.23"></a><span id="l39.23">   assert_equals(&quot;http://www.example.com/2&quot;,</span>
<a href="#l39.24"></a><span id="l39.24">                 subjects.queryElementAt(0, Ci.nsIMsgAttachment).url);</span>
<a href="#l39.25"></a><span id="l39.25"> </span>
<a href="#l39.26"></a><span id="l39.26">   // And check that we don't receive the event if we try to attach a file</span>
<a href="#l39.27"></a><span id="l39.27">   // that's already attached.</span>
<a href="#l39.28"></a><span id="l39.28">   add_attachment(cw, &quot;http://www.example.com/2&quot;);</span>
<a href="#l39.29"></a><span id="l39.29">   assert_equals(2, eventCount);</span>
<a href="#l39.30"></a><span id="l39.30"> </span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsAdded, listener,</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineminus">-                                               false);</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsAdded, listener);</span>
<a href="#l39.34"></a><span id="l39.34">   close_compose_window(cw);</span>
<a href="#l39.35"></a><span id="l39.35"> }</span>
<a href="#l39.36"></a><span id="l39.36"> </span>
<a href="#l39.37"></a><span id="l39.37"> /**</span>
<a href="#l39.38"></a><span id="l39.38">  * Test that the attachments-added event is fired when we add a series</span>
<a href="#l39.39"></a><span id="l39.39">  * of files all at once.</span>
<a href="#l39.40"></a><span id="l39.40">  */</span>
<a href="#l39.41"></a><span id="l39.41"> function test_attachments_added_on_multiple() {</span>
<a href="#l39.42"></a><span id="l39.42" class="difflineat">@@ -99,17 +98,17 @@ function test_attachments_added_on_multi</span>
<a href="#l39.43"></a><span id="l39.43"> </span>
<a href="#l39.44"></a><span id="l39.44">   // Prepare the attachments - we store the names in attachmentNames to</span>
<a href="#l39.45"></a><span id="l39.45">   // make sure that we observed the right event subjects later on.</span>
<a href="#l39.46"></a><span id="l39.46">   let attachmentUrls = [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.47"></a><span id="l39.47">                         &quot;http://www.example.com/2&quot;];</span>
<a href="#l39.48"></a><span id="l39.48"> </span>
<a href="#l39.49"></a><span id="l39.49">   // Open the compose window and add the attachments</span>
<a href="#l39.50"></a><span id="l39.50">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.51"></a><span id="l39.51" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsAdded, listener, false);</span>
<a href="#l39.52"></a><span id="l39.52" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsAdded, listener);</span>
<a href="#l39.53"></a><span id="l39.53"> </span>
<a href="#l39.54"></a><span id="l39.54">   add_attachments(cw, attachmentUrls);</span>
<a href="#l39.55"></a><span id="l39.55"> </span>
<a href="#l39.56"></a><span id="l39.56">   // Make sure we only saw a single attachments-added for this group</span>
<a href="#l39.57"></a><span id="l39.57">   // of files.</span>
<a href="#l39.58"></a><span id="l39.58">   assert_equals(1, eventCount);</span>
<a href="#l39.59"></a><span id="l39.59"> </span>
<a href="#l39.60"></a><span id="l39.60">   // Now make sure we got passed the right subjects for the event</span>
<a href="#l39.61"></a><span id="l39.61" class="difflineat">@@ -126,17 +125,17 @@ function test_attachments_added_on_multi</span>
<a href="#l39.62"></a><span id="l39.62"> </span>
<a href="#l39.63"></a><span id="l39.63">   attachmentUrls = [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.64"></a><span id="l39.64">                     &quot;http://www.example.com/2&quot;,</span>
<a href="#l39.65"></a><span id="l39.65">                     &quot;http://www.example.com/3&quot;];</span>
<a href="#l39.66"></a><span id="l39.66"> </span>
<a href="#l39.67"></a><span id="l39.67">   // Open the compose window and attach the files, and ensure that we saw</span>
<a href="#l39.68"></a><span id="l39.68">   // the attachments-added event</span>
<a href="#l39.69"></a><span id="l39.69">   cw = open_compose_new_mail(mc);</span>
<a href="#l39.70"></a><span id="l39.70" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsAdded, listener, false);</span>
<a href="#l39.71"></a><span id="l39.71" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsAdded, listener);</span>
<a href="#l39.72"></a><span id="l39.72"> </span>
<a href="#l39.73"></a><span id="l39.73">   add_attachments(cw, attachmentUrls);</span>
<a href="#l39.74"></a><span id="l39.74">   assert_equals(2, eventCount);</span>
<a href="#l39.75"></a><span id="l39.75"> </span>
<a href="#l39.76"></a><span id="l39.76">   // Make sure that we got the right subjects back</span>
<a href="#l39.77"></a><span id="l39.77">   subjects = lastEvent.detail;</span>
<a href="#l39.78"></a><span id="l39.78">   assert_true(subjects instanceof Ci.nsIMutableArray);</span>
<a href="#l39.79"></a><span id="l39.79">   assert_equals(3, subjects.length);</span>
<a href="#l39.80"></a><span id="l39.80" class="difflineat">@@ -145,18 +144,17 @@ function test_attachments_added_on_multi</span>
<a href="#l39.81"></a><span id="l39.81">     assert_true(attachmentUrls.includes(attachment.url));</span>
<a href="#l39.82"></a><span id="l39.82">   }</span>
<a href="#l39.83"></a><span id="l39.83"> </span>
<a href="#l39.84"></a><span id="l39.84">   // Make sure we don't fire the event again if we try to attach the same</span>
<a href="#l39.85"></a><span id="l39.85">   // files.</span>
<a href="#l39.86"></a><span id="l39.86">   add_attachments(cw, attachmentUrls);</span>
<a href="#l39.87"></a><span id="l39.87">   assert_equals(2, eventCount);</span>
<a href="#l39.88"></a><span id="l39.88"> </span>
<a href="#l39.89"></a><span id="l39.89" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsAdded, listener,</span>
<a href="#l39.90"></a><span id="l39.90" class="difflineminus">-                                               false);</span>
<a href="#l39.91"></a><span id="l39.91" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsAdded, listener);</span>
<a href="#l39.92"></a><span id="l39.92">   close_compose_window(cw);</span>
<a href="#l39.93"></a><span id="l39.93"> }</span>
<a href="#l39.94"></a><span id="l39.94"> </span>
<a href="#l39.95"></a><span id="l39.95"> /**</span>
<a href="#l39.96"></a><span id="l39.96">  * Test that the attachments-removed event is fired when removing a</span>
<a href="#l39.97"></a><span id="l39.97">  * single file.</span>
<a href="#l39.98"></a><span id="l39.98">  */</span>
<a href="#l39.99"></a><span id="l39.99"> function test_attachments_removed_on_single() {</span>
<a href="#l39.100"></a><span id="l39.100" class="difflineat">@@ -166,18 +164,17 @@ function test_attachments_removed_on_sin</span>
<a href="#l39.101"></a><span id="l39.101">   let listener = function(event) {</span>
<a href="#l39.102"></a><span id="l39.102">     eventCount++;</span>
<a href="#l39.103"></a><span id="l39.103">     lastEvent = event;</span>
<a href="#l39.104"></a><span id="l39.104">   }</span>
<a href="#l39.105"></a><span id="l39.105"> </span>
<a href="#l39.106"></a><span id="l39.106"> </span>
<a href="#l39.107"></a><span id="l39.107">   // Open up the compose window, attach a file...</span>
<a href="#l39.108"></a><span id="l39.108">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.109"></a><span id="l39.109" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsRemoved, listener,</span>
<a href="#l39.110"></a><span id="l39.110" class="difflineminus">-                                            false);</span>
<a href="#l39.111"></a><span id="l39.111" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsRemoved, listener);</span>
<a href="#l39.112"></a><span id="l39.112"> </span>
<a href="#l39.113"></a><span id="l39.113">   add_attachment(cw, &quot;http://www.example.com/1&quot;);</span>
<a href="#l39.114"></a><span id="l39.114"> </span>
<a href="#l39.115"></a><span id="l39.115">   // Now select that attachment and delete it</span>
<a href="#l39.116"></a><span id="l39.116">   let removedAttachmentItem = select_attachments(cw, 0);</span>
<a href="#l39.117"></a><span id="l39.117">   // We need to hold a reference to removedAttachment here because</span>
<a href="#l39.118"></a><span id="l39.118">   // the delete routine nulls it out from the attachmentitem.</span>
<a href="#l39.119"></a><span id="l39.119">   let removedAttachment = removedAttachmentItem[0].attachment;</span>
<a href="#l39.120"></a><span id="l39.120" class="difflineat">@@ -201,18 +198,17 @@ function test_attachments_removed_on_sin</span>
<a href="#l39.121"></a><span id="l39.121"> </span>
<a href="#l39.122"></a><span id="l39.122">   assert_equals(2, eventCount);</span>
<a href="#l39.123"></a><span id="l39.123">   subjects = lastEvent.detail;</span>
<a href="#l39.124"></a><span id="l39.124">   assert_true(subjects instanceof Ci.nsIMutableArray);</span>
<a href="#l39.125"></a><span id="l39.125">   assert_equals(1, subjects.length);</span>
<a href="#l39.126"></a><span id="l39.126">   assert_equals(subjects.queryElementAt(0, Ci.nsIMsgAttachment).url,</span>
<a href="#l39.127"></a><span id="l39.127">                 &quot;http://www.example.com/2&quot;);</span>
<a href="#l39.128"></a><span id="l39.128"> </span>
<a href="#l39.129"></a><span id="l39.129" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsRemoved, listener,</span>
<a href="#l39.130"></a><span id="l39.130" class="difflineminus">-                                               false);</span>
<a href="#l39.131"></a><span id="l39.131" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsRemoved, listener);</span>
<a href="#l39.132"></a><span id="l39.132">   close_compose_window(cw);</span>
<a href="#l39.133"></a><span id="l39.133"> }</span>
<a href="#l39.134"></a><span id="l39.134"> </span>
<a href="#l39.135"></a><span id="l39.135"> /**</span>
<a href="#l39.136"></a><span id="l39.136">  * Test that the attachments-removed event is fired when removing multiple</span>
<a href="#l39.137"></a><span id="l39.137">  * files all at once.</span>
<a href="#l39.138"></a><span id="l39.138">  */</span>
<a href="#l39.139"></a><span id="l39.139"> function test_attachments_removed_on_multiple() {</span>
<a href="#l39.140"></a><span id="l39.140" class="difflineat">@@ -221,18 +217,17 @@ function test_attachments_removed_on_mul</span>
<a href="#l39.141"></a><span id="l39.141">   let lastEvent;</span>
<a href="#l39.142"></a><span id="l39.142">   let listener = function(event) {</span>
<a href="#l39.143"></a><span id="l39.143">     eventCount++;</span>
<a href="#l39.144"></a><span id="l39.144">     lastEvent = event;</span>
<a href="#l39.145"></a><span id="l39.145">   }</span>
<a href="#l39.146"></a><span id="l39.146"> </span>
<a href="#l39.147"></a><span id="l39.147">   // Open up the compose window and attach some files...</span>
<a href="#l39.148"></a><span id="l39.148">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.149"></a><span id="l39.149" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsRemoved, listener,</span>
<a href="#l39.150"></a><span id="l39.150" class="difflineminus">-                                            false);</span>
<a href="#l39.151"></a><span id="l39.151" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsRemoved, listener);</span>
<a href="#l39.152"></a><span id="l39.152"> </span>
<a href="#l39.153"></a><span id="l39.153">   add_attachments(cw, [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.154"></a><span id="l39.154">                        &quot;http://www.example.com/2&quot;,</span>
<a href="#l39.155"></a><span id="l39.155">                        &quot;http://www.example.com/3&quot;]);</span>
<a href="#l39.156"></a><span id="l39.156"> </span>
<a href="#l39.157"></a><span id="l39.157">   // Select all three attachments, and remove them.</span>
<a href="#l39.158"></a><span id="l39.158">   let removedAttachmentItems = select_attachments(cw, 0, 2);</span>
<a href="#l39.159"></a><span id="l39.159"> </span>
<a href="#l39.160"></a><span id="l39.160" class="difflineat">@@ -258,18 +253,17 @@ function test_attachments_removed_on_mul</span>
<a href="#l39.161"></a><span id="l39.161">   // Ok, let's attach and remove some again to ensure that we still see the event.</span>
<a href="#l39.162"></a><span id="l39.162">   add_attachments(cw, [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.163"></a><span id="l39.163">                        &quot;http://www.example.com/2&quot;]);</span>
<a href="#l39.164"></a><span id="l39.164"> </span>
<a href="#l39.165"></a><span id="l39.165">   select_attachments(cw, 0, 1);</span>
<a href="#l39.166"></a><span id="l39.166">   cw.window.goDoCommand(&quot;cmd_delete&quot;);</span>
<a href="#l39.167"></a><span id="l39.167">   assert_equals(2, eventCount);</span>
<a href="#l39.168"></a><span id="l39.168"> </span>
<a href="#l39.169"></a><span id="l39.169" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsRemoved, listener,</span>
<a href="#l39.170"></a><span id="l39.170" class="difflineminus">-                                               false);</span>
<a href="#l39.171"></a><span id="l39.171" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsRemoved, listener);</span>
<a href="#l39.172"></a><span id="l39.172">   close_compose_window(cw);</span>
<a href="#l39.173"></a><span id="l39.173"> }</span>
<a href="#l39.174"></a><span id="l39.174"> </span>
<a href="#l39.175"></a><span id="l39.175"> /**</span>
<a href="#l39.176"></a><span id="l39.176">  * Test that we don't see the attachments-removed event if no attachments</span>
<a href="#l39.177"></a><span id="l39.177">  * are selected when hitting &quot;Delete&quot;</span>
<a href="#l39.178"></a><span id="l39.178">  */</span>
<a href="#l39.179"></a><span id="l39.179"> function test_no_attachments_removed_on_none() {</span>
<a href="#l39.180"></a><span id="l39.180" class="difflineat">@@ -278,31 +272,29 @@ function test_no_attachments_removed_on_</span>
<a href="#l39.181"></a><span id="l39.181">   let lastEvent;</span>
<a href="#l39.182"></a><span id="l39.182">   let listener = function(event) {</span>
<a href="#l39.183"></a><span id="l39.183">     eventCount++;</span>
<a href="#l39.184"></a><span id="l39.184">     lastEvent = event;</span>
<a href="#l39.185"></a><span id="l39.185">   }</span>
<a href="#l39.186"></a><span id="l39.186"> </span>
<a href="#l39.187"></a><span id="l39.187">   // Open the compose window and add some attachments.</span>
<a href="#l39.188"></a><span id="l39.188">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.189"></a><span id="l39.189" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsRemoved, listener,</span>
<a href="#l39.190"></a><span id="l39.190" class="difflineminus">-                                            false);</span>
<a href="#l39.191"></a><span id="l39.191" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentsRemoved, listener);</span>
<a href="#l39.192"></a><span id="l39.192"> </span>
<a href="#l39.193"></a><span id="l39.193">   add_attachments(cw, [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.194"></a><span id="l39.194">                        &quot;http://www.example.com/2&quot;,</span>
<a href="#l39.195"></a><span id="l39.195">                        &quot;http://www.example.com/3&quot;]);</span>
<a href="#l39.196"></a><span id="l39.196"> </span>
<a href="#l39.197"></a><span id="l39.197">   // Choose no attachments</span>
<a href="#l39.198"></a><span id="l39.198">   cw.e(&quot;attachmentBucket&quot;).clearSelection();</span>
<a href="#l39.199"></a><span id="l39.199">   // Run the delete command</span>
<a href="#l39.200"></a><span id="l39.200">   cw.window.goDoCommand(&quot;cmd_delete&quot;);</span>
<a href="#l39.201"></a><span id="l39.201">   // Make sure we didn't see the attachments_removed event.</span>
<a href="#l39.202"></a><span id="l39.202">   assert_equals(0, eventCount);</span>
<a href="#l39.203"></a><span id="l39.203" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsRemoved, listener,</span>
<a href="#l39.204"></a><span id="l39.204" class="difflineminus">-                                               false);</span>
<a href="#l39.205"></a><span id="l39.205" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentsRemoved, listener);</span>
<a href="#l39.206"></a><span id="l39.206"> </span>
<a href="#l39.207"></a><span id="l39.207">   close_compose_window(cw);</span>
<a href="#l39.208"></a><span id="l39.208"> }</span>
<a href="#l39.209"></a><span id="l39.209"> </span>
<a href="#l39.210"></a><span id="l39.210"> /**</span>
<a href="#l39.211"></a><span id="l39.211">  * Test that we see the attachment-renamed event when an attachments</span>
<a href="#l39.212"></a><span id="l39.212">  * name is changed.</span>
<a href="#l39.213"></a><span id="l39.213">  */</span>
<a href="#l39.214"></a><span id="l39.214" class="difflineat">@@ -325,18 +317,17 @@ function test_attachment_renamed() {</span>
<a href="#l39.215"></a><span id="l39.215">   gMockPromptService.register();</span>
<a href="#l39.216"></a><span id="l39.216">   // The inoutValue is used to set the attachment name</span>
<a href="#l39.217"></a><span id="l39.217">   gMockPromptService.inoutValue = kRenameTo1;</span>
<a href="#l39.218"></a><span id="l39.218">   gMockPromptService.returnValue = true;</span>
<a href="#l39.219"></a><span id="l39.219"> </span>
<a href="#l39.220"></a><span id="l39.220">   // Open up the compose window, attach some files, choose the first</span>
<a href="#l39.221"></a><span id="l39.221">   // attachment, and choose to rename it.</span>
<a href="#l39.222"></a><span id="l39.222">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.223"></a><span id="l39.223" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentRenamed, listener,</span>
<a href="#l39.224"></a><span id="l39.224" class="difflineminus">-                                            false);</span>
<a href="#l39.225"></a><span id="l39.225" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentRenamed, listener);</span>
<a href="#l39.226"></a><span id="l39.226"> </span>
<a href="#l39.227"></a><span id="l39.227">   add_attachments(cw, [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.228"></a><span id="l39.228">                        &quot;http://www.example.com/2&quot;,</span>
<a href="#l39.229"></a><span id="l39.229">                        &quot;http://www.example.com/3&quot;]);</span>
<a href="#l39.230"></a><span id="l39.230"> </span>
<a href="#l39.231"></a><span id="l39.231">   select_attachments(cw, 0);</span>
<a href="#l39.232"></a><span id="l39.232">   cw.window.goDoCommand(&quot;cmd_renameAttachment&quot;);</span>
<a href="#l39.233"></a><span id="l39.233"> </span>
<a href="#l39.234"></a><span id="l39.234" class="difflineat">@@ -381,18 +372,17 @@ function test_attachment_renamed() {</span>
<a href="#l39.235"></a><span id="l39.235">   let renamedAttachment3 = lastEvent.target.attachment;</span>
<a href="#l39.236"></a><span id="l39.236">   let originalName3 = lastEvent.detail;</span>
<a href="#l39.237"></a><span id="l39.237">   assert_true(renamedAttachment3 instanceof Ci.nsIMsgAttachment);</span>
<a href="#l39.238"></a><span id="l39.238">   assert_equals(kRenameTo3, renamedAttachment3.name);</span>
<a href="#l39.239"></a><span id="l39.239">   assert_true(renamedAttachment3.url.includes(&quot;http://www.example.com/2&quot;));</span>
<a href="#l39.240"></a><span id="l39.240">   assert_equals(&quot;www.example.com/2&quot;, originalName3);</span>
<a href="#l39.241"></a><span id="l39.241"> </span>
<a href="#l39.242"></a><span id="l39.242">   // Unregister the Mock Prompt service, and remove our observer.</span>
<a href="#l39.243"></a><span id="l39.243" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentRenamed, listener,</span>
<a href="#l39.244"></a><span id="l39.244" class="difflineminus">-                                            false);</span>
<a href="#l39.245"></a><span id="l39.245" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentRenamed, listener);</span>
<a href="#l39.246"></a><span id="l39.246"> </span>
<a href="#l39.247"></a><span id="l39.247">   close_compose_window(cw);</span>
<a href="#l39.248"></a><span id="l39.248">   gMockPromptService.unregister();</span>
<a href="#l39.249"></a><span id="l39.249"> }</span>
<a href="#l39.250"></a><span id="l39.250"> </span>
<a href="#l39.251"></a><span id="l39.251"> /**</span>
<a href="#l39.252"></a><span id="l39.252">  * Test that the attachment-renamed event is not fired if we set the</span>
<a href="#l39.253"></a><span id="l39.253">  * filename to be blank.</span>
<a href="#l39.254"></a><span id="l39.254" class="difflineat">@@ -411,25 +401,23 @@ function test_no_attachment_renamed_on_b</span>
<a href="#l39.255"></a><span id="l39.255">   gMockPromptService.reset();</span>
<a href="#l39.256"></a><span id="l39.256">   gMockPromptService.register();</span>
<a href="#l39.257"></a><span id="l39.257">   gMockPromptService.inoutValue = &quot;&quot;;</span>
<a href="#l39.258"></a><span id="l39.258">   gMockPromptService.returnValue = true;</span>
<a href="#l39.259"></a><span id="l39.259"> </span>
<a href="#l39.260"></a><span id="l39.260">   // Open the compose window, attach some files, select one, and chooes to</span>
<a href="#l39.261"></a><span id="l39.261">   // rename it.</span>
<a href="#l39.262"></a><span id="l39.262">   let cw = open_compose_new_mail(mc);</span>
<a href="#l39.263"></a><span id="l39.263" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentRenamed, listener,</span>
<a href="#l39.264"></a><span id="l39.264" class="difflineminus">-                                            false);</span>
<a href="#l39.265"></a><span id="l39.265" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).addEventListener(kAttachmentRenamed, listener);</span>
<a href="#l39.266"></a><span id="l39.266"> </span>
<a href="#l39.267"></a><span id="l39.267">   add_attachments(cw, [&quot;http://www.example.com/1&quot;,</span>
<a href="#l39.268"></a><span id="l39.268">                        &quot;http://www.example.com/2&quot;,</span>
<a href="#l39.269"></a><span id="l39.269">                        &quot;http://www.example.com/3&quot;]);</span>
<a href="#l39.270"></a><span id="l39.270"> </span>
<a href="#l39.271"></a><span id="l39.271">   select_attachments(cw, 0);</span>
<a href="#l39.272"></a><span id="l39.272">   cw.window.goDoCommand(&quot;cmd_renameAttachment&quot;);</span>
<a href="#l39.273"></a><span id="l39.273"> </span>
<a href="#l39.274"></a><span id="l39.274">   // Ensure that we didn't see the attachment-renamed event.</span>
<a href="#l39.275"></a><span id="l39.275">   assert_equals(0, eventCount);</span>
<a href="#l39.276"></a><span id="l39.276" class="difflineminus">-  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentRenamed, listener,</span>
<a href="#l39.277"></a><span id="l39.277" class="difflineminus">-                                               false);</span>
<a href="#l39.278"></a><span id="l39.278" class="difflineplus">+  cw.e(&quot;attachmentBucket&quot;).removeEventListener(kAttachmentRenamed, listener);</span>
<a href="#l39.279"></a><span id="l39.279">   close_compose_window(cw);</span>
<a href="#l39.280"></a><span id="l39.280">   gMockPromptService.unregister();</span>
<a href="#l39.281"></a><span id="l39.281"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-content-tab.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-content-tab.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -147,17 +147,17 @@ function test_content_tab_default_favico</span>
<a href="#l40.4"></a><span id="l40.4">   assert_content_tab_has_favicon(tab, url + &quot;favicon.ico&quot;);</span>
<a href="#l40.5"></a><span id="l40.5"> }</span>
<a href="#l40.6"></a><span id="l40.6"> </span>
<a href="#l40.7"></a><span id="l40.7"> function test_content_tab_onbeforeunload() {</span>
<a href="#l40.8"></a><span id="l40.8">   let count = mc.tabmail.tabContainer.childNodes.length;</span>
<a href="#l40.9"></a><span id="l40.9">   let tab = mc.tabmail.tabInfo[count-1];</span>
<a href="#l40.10"></a><span id="l40.10">   tab.browser.contentWindow.addEventListener(&quot;beforeunload&quot;, function (event) {</span>
<a href="#l40.11"></a><span id="l40.11">     event.returnValue = &quot;Green llama in your car&quot;;</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-  }, false);</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+  });</span>
<a href="#l40.14"></a><span id="l40.14"> </span>
<a href="#l40.15"></a><span id="l40.15">   const interactionPref = &quot;dom.require_user_interaction_for_beforeunload&quot;;</span>
<a href="#l40.16"></a><span id="l40.16">   Services.prefs.setBoolPref(interactionPref, false);</span>
<a href="#l40.17"></a><span id="l40.17"> </span>
<a href="#l40.18"></a><span id="l40.18">   plan_for_modal_dialog(&quot;commonDialog&quot;, function (controller) {</span>
<a href="#l40.19"></a><span id="l40.19">     controller.window.document.documentElement.getButton(&quot;accept&quot;).doCommand();</span>
<a href="#l40.20"></a><span id="l40.20">   });</span>
<a href="#l40.21"></a><span id="l40.21">   mc.tabmail.closeTab(tab);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/test/mozmill/content-tabs/test-install-xpi.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/test/mozmill/content-tabs/test-install-xpi.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -24,25 +24,25 @@ var gNewTab;</span>
<a href="#l41.4"></a><span id="l41.4"> var gNotificationBox;</span>
<a href="#l41.5"></a><span id="l41.5"> </span>
<a href="#l41.6"></a><span id="l41.6"> var ALERT_TIMEOUT = 50000;</span>
<a href="#l41.7"></a><span id="l41.7"> </span>
<a href="#l41.8"></a><span id="l41.8"> var AlertWatcher = {</span>
<a href="#l41.9"></a><span id="l41.9">   planForAlert: function(aController) {</span>
<a href="#l41.10"></a><span id="l41.10">     this.alerted = false;</span>
<a href="#l41.11"></a><span id="l41.11">     aController.window.document.addEventListener(&quot;AlertActive&quot;,</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-                                                 this.alertActive, false);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+                                                 this.alertActive);</span>
<a href="#l41.14"></a><span id="l41.14">   },</span>
<a href="#l41.15"></a><span id="l41.15">   waitForAlert: function(aController) {</span>
<a href="#l41.16"></a><span id="l41.16">     if (!this.alerted) {</span>
<a href="#l41.17"></a><span id="l41.17">       aController.waitFor(() =&gt; this.alerted, &quot;Timeout waiting for alert&quot;,</span>
<a href="#l41.18"></a><span id="l41.18">                           ALERT_TIMEOUT, 100);</span>
<a href="#l41.19"></a><span id="l41.19">     }</span>
<a href="#l41.20"></a><span id="l41.20">     aController.window.document.removeEventListener(&quot;AlertActive&quot;,</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineminus">-                                                    this.alertActive, false);</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineplus">+                                                    this.alertActive);</span>
<a href="#l41.23"></a><span id="l41.23">   },</span>
<a href="#l41.24"></a><span id="l41.24">   alerted: false,</span>
<a href="#l41.25"></a><span id="l41.25">   alertActive: function() {</span>
<a href="#l41.26"></a><span id="l41.26">     AlertWatcher.alerted = true;</span>
<a href="#l41.27"></a><span id="l41.27">   }</span>
<a href="#l41.28"></a><span id="l41.28"> };</span>
<a href="#l41.29"></a><span id="l41.29"> </span>
<a href="#l41.30"></a><span id="l41.30"> var setupModule = function (module) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-content-tab-helpers.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-content-tab-helpers.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -119,33 +119,33 @@ function MockExtProtConstructor() {</span>
<a href="#l42.4"></a><span id="l42.4">  * install notifications.</span>
<a href="#l42.5"></a><span id="l42.5">  */</span>
<a href="#l42.6"></a><span id="l42.6"> var ALERT_TIMEOUT = 10000;</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8"> var NotificationWatcher = {</span>
<a href="#l42.9"></a><span id="l42.9">   planForNotification: function(aController) {</span>
<a href="#l42.10"></a><span id="l42.10">     this.alerted = false;</span>
<a href="#l42.11"></a><span id="l42.11">     aController.window.document.addEventListener(&quot;AlertActive&quot;,</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-                                                 this.alertActive, false);</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+                                                 this.alertActive);</span>
<a href="#l42.14"></a><span id="l42.14">   },</span>
<a href="#l42.15"></a><span id="l42.15">   waitForNotification: function(aController) {</span>
<a href="#l42.16"></a><span id="l42.16">     if (!this.alerted) {</span>
<a href="#l42.17"></a><span id="l42.17">       aController.waitFor(() =&gt; this.alerted, &quot;Timeout waiting for alert&quot;,</span>
<a href="#l42.18"></a><span id="l42.18">                           ALERT_TIMEOUT, 100);</span>
<a href="#l42.19"></a><span id="l42.19">     }</span>
<a href="#l42.20"></a><span id="l42.20">     // Double check the notification box has finished animating.</span>
<a href="#l42.21"></a><span id="l42.21">     let notificationBox =</span>
<a href="#l42.22"></a><span id="l42.22">       mc.tabmail.selectedTab.panel.querySelector(&quot;notificationbox&quot;);</span>
<a href="#l42.23"></a><span id="l42.23">     if (notificationBox &amp;&amp; notificationBox._animating)</span>
<a href="#l42.24"></a><span id="l42.24">       aController.waitFor(() =&gt; !notificationBox._animating,</span>
<a href="#l42.25"></a><span id="l42.25">                           &quot;Timeout waiting for notification box animation to finish&quot;,</span>
<a href="#l42.26"></a><span id="l42.26">                           ALERT_TIMEOUT, 100);</span>
<a href="#l42.27"></a><span id="l42.27"> </span>
<a href="#l42.28"></a><span id="l42.28">     aController.window.document.removeEventListener(&quot;AlertActive&quot;,</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineminus">-                                                    this.alertActive, false);</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineplus">+                                                    this.alertActive);</span>
<a href="#l42.31"></a><span id="l42.31">   },</span>
<a href="#l42.32"></a><span id="l42.32">   alerted: false,</span>
<a href="#l42.33"></a><span id="l42.33">   alertActive: function() {</span>
<a href="#l42.34"></a><span id="l42.34">     NotificationWatcher.alerted = true;</span>
<a href="#l42.35"></a><span id="l42.35">   }</span>
<a href="#l42.36"></a><span id="l42.36"> };</span>
<a href="#l42.37"></a><span id="l42.37"> </span>
<a href="#l42.38"></a><span id="l42.38"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-window-helpers.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-window-helpers.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -1716,22 +1716,22 @@ function augment_controller(aController,</span>
<a href="#l43.4"></a><span id="l43.4"> </span>
<a href="#l43.5"></a><span id="l43.5">     doc.addEventListener(&quot;keypress&quot;, __peek_keypress_handler, true);</span>
<a href="#l43.6"></a><span id="l43.6"> </span>
<a href="#l43.7"></a><span id="l43.7">     doc.addEventListener(&quot;focus&quot;, __peek_focus_handler, true);</span>
<a href="#l43.8"></a><span id="l43.8">     doc.addEventListener(&quot;blur&quot;, __peek_focus_handler, true);</span>
<a href="#l43.9"></a><span id="l43.9"> </span>
<a href="#l43.10"></a><span id="l43.10">     // - bubbling listeners</span>
<a href="#l43.11"></a><span id="l43.11">     // (so we can see if the event got killed / eaten)</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-    doc.addEventListener(&quot;mousedown&quot;, __bubbled_click_handler, false);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineminus">-    doc.addEventListener(&quot;click&quot;, __bubbled_click_handler, false);</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineminus">-    doc.addEventListener(&quot;contextmenu&quot;, __bubbled_click_handler, false);</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineminus">-    doc.addEventListener(&quot;mouseup&quot;, __bubbled_click_handler, false);</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineplus">+    doc.addEventListener(&quot;mousedown&quot;, __bubbled_click_handler);</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineplus">+    doc.addEventListener(&quot;click&quot;, __bubbled_click_handler);</span>
<a href="#l43.18"></a><span id="l43.18" class="difflineplus">+    doc.addEventListener(&quot;contextmenu&quot;, __bubbled_click_handler);</span>
<a href="#l43.19"></a><span id="l43.19" class="difflineplus">+    doc.addEventListener(&quot;mouseup&quot;, __bubbled_click_handler);</span>
<a href="#l43.20"></a><span id="l43.20"> </span>
<a href="#l43.21"></a><span id="l43.21" class="difflineminus">-    doc.addEventListener(&quot;keypress&quot;, __bubbled_keypress_handler, false);</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineplus">+    doc.addEventListener(&quot;keypress&quot;, __bubbled_keypress_handler);</span>
<a href="#l43.23"></a><span id="l43.23"> </span>
<a href="#l43.24"></a><span id="l43.24">     // - also, add pop-up shown/hidden events....</span>
<a href="#l43.25"></a><span id="l43.25">     // We need to add these directly to the popups themselves in order to</span>
<a href="#l43.26"></a><span id="l43.26">     //  see anything.</span>
<a href="#l43.27"></a><span id="l43.27">     let popups = doc.documentElement.getElementsByTagName(&quot;menupopup&quot;);</span>
<a href="#l43.28"></a><span id="l43.28">     for (let i = 0; i &lt; popups.length; i++) {</span>
<a href="#l43.29"></a><span id="l43.29">       let popup = popups[i];</span>
<a href="#l43.30"></a><span id="l43.30">       popup.addEventListener(&quot;popupshowing&quot;, __popup_showing, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mailnews/base/content/newmailalert.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mailnews/base/content/newmailalert.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -128,20 +128,20 @@ function showAlert()</span>
<a href="#l44.4"></a><span id="l44.4">       !Services.prefs.getBoolPref(&quot;toolkit.cosmeticAnimations.enabled&quot;)) {</span>
<a href="#l44.5"></a><span id="l44.5">     alertContainer.setAttribute(&quot;noanimation&quot;, true);</span>
<a href="#l44.6"></a><span id="l44.6">     setTimeout(closeAlert, gOpenTime);</span>
<a href="#l44.7"></a><span id="l44.7">     return;</span>
<a href="#l44.8"></a><span id="l44.8">   }</span>
<a href="#l44.9"></a><span id="l44.9"> </span>
<a href="#l44.10"></a><span id="l44.10">   alertContainer.addEventListener(&quot;animationend&quot;, function hideAlert(event) {</span>
<a href="#l44.11"></a><span id="l44.11">     if (event.animationName == &quot;fade-in&quot;) {</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-      alertContainer.removeEventListener(&quot;animationend&quot;, hideAlert, false);</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+      alertContainer.removeEventListener(&quot;animationend&quot;, hideAlert);</span>
<a href="#l44.14"></a><span id="l44.14">       setTimeout(fadeOutAlert, gOpenTime);</span>
<a href="#l44.15"></a><span id="l44.15">     }</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineminus">-  }, false);</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineplus">+  });</span>
<a href="#l44.18"></a><span id="l44.18"> </span>
<a href="#l44.19"></a><span id="l44.19">   alertContainer.setAttribute(&quot;fade-in&quot;, true);</span>
<a href="#l44.20"></a><span id="l44.20"> }</span>
<a href="#l44.21"></a><span id="l44.21"> </span>
<a href="#l44.22"></a><span id="l44.22"> function resizeAlert(aMoveOffScreen)</span>
<a href="#l44.23"></a><span id="l44.23"> {</span>
<a href="#l44.24"></a><span id="l44.24">   var alertTextBox = document.getElementById(&quot;alertTextBox&quot;);</span>
<a href="#l44.25"></a><span id="l44.25">   var alertImageBox = document.getElementById(&quot;alertImageBox&quot;);</span>
<a href="#l44.26"></a><span id="l44.26" class="difflineat">@@ -166,20 +166,20 @@ function resizeAlert(aMoveOffScreen)</span>
<a href="#l44.27"></a><span id="l44.27">   window.moveTo(x, y);</span>
<a href="#l44.28"></a><span id="l44.28"> }</span>
<a href="#l44.29"></a><span id="l44.29"> </span>
<a href="#l44.30"></a><span id="l44.30"> function fadeOutAlert()</span>
<a href="#l44.31"></a><span id="l44.31"> {</span>
<a href="#l44.32"></a><span id="l44.32">   var alertContainer = document.getElementById(&quot;alertContainer&quot;);</span>
<a href="#l44.33"></a><span id="l44.33">   alertContainer.addEventListener(&quot;animationend&quot;, function fadeOut(event) {</span>
<a href="#l44.34"></a><span id="l44.34">     if (event.animationName == &quot;fade-out&quot;) {</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineminus">-      alertContainer.removeEventListener(&quot;animationend&quot;, fadeOut, false);</span>
<a href="#l44.36"></a><span id="l44.36" class="difflineplus">+      alertContainer.removeEventListener(&quot;animationend&quot;, fadeOut);</span>
<a href="#l44.37"></a><span id="l44.37">       closeAlert();</span>
<a href="#l44.38"></a><span id="l44.38">     }</span>
<a href="#l44.39"></a><span id="l44.39" class="difflineminus">-  }, false);</span>
<a href="#l44.40"></a><span id="l44.40" class="difflineplus">+  });</span>
<a href="#l44.41"></a><span id="l44.41">   alertContainer.setAttribute(&quot;fade-out&quot;, true);</span>
<a href="#l44.42"></a><span id="l44.42"> }</span>
<a href="#l44.43"></a><span id="l44.43"> </span>
<a href="#l44.44"></a><span id="l44.44"> function closeAlert()</span>
<a href="#l44.45"></a><span id="l44.45"> {</span>
<a href="#l44.46"></a><span id="l44.46">   if (gAlertListener)</span>
<a href="#l44.47"></a><span id="l44.47">     gAlertListener.observe(null, &quot;alertfinished&quot;, &quot;&quot;);</span>
<a href="#l44.48"></a><span id="l44.48">   window.close();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-archiveoptions.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-archiveoptions.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -10,21 +10,21 @@ var gIdentity = null;</span>
<a href="#l45.4"></a><span id="l45.4">  * appropriate values, and update the archive hierarchy example.</span>
<a href="#l45.5"></a><span id="l45.5">  */</span>
<a href="#l45.6"></a><span id="l45.6"> function onLoadArchiveOptions() {</span>
<a href="#l45.7"></a><span id="l45.7">   // extract the account</span>
<a href="#l45.8"></a><span id="l45.8">   gIdentity = window.arguments[0];</span>
<a href="#l45.9"></a><span id="l45.9"> </span>
<a href="#l45.10"></a><span id="l45.10">   let granularity = document.getElementById(&quot;archiveGranularity&quot;);</span>
<a href="#l45.11"></a><span id="l45.11">   granularity.selectedIndex = gIdentity.archiveGranularity;</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-  granularity.addEventListener(&quot;command&quot;, updateArchiveExample, false);</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+  granularity.addEventListener(&quot;command&quot;, updateArchiveExample);</span>
<a href="#l45.14"></a><span id="l45.14"> </span>
<a href="#l45.15"></a><span id="l45.15">   let kfs = document.getElementById(&quot;archiveKeepFolderStructure&quot;);</span>
<a href="#l45.16"></a><span id="l45.16">   kfs.checked = gIdentity.archiveKeepFolderStructure;</span>
<a href="#l45.17"></a><span id="l45.17" class="difflineminus">-  kfs.addEventListener(&quot;command&quot;, updateArchiveExample, false);</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineplus">+  kfs.addEventListener(&quot;command&quot;, updateArchiveExample);</span>
<a href="#l45.19"></a><span id="l45.19"> </span>
<a href="#l45.20"></a><span id="l45.20">   updateArchiveExample();</span>
<a href="#l45.21"></a><span id="l45.21"> }</span>
<a href="#l45.22"></a><span id="l45.22"> </span>
<a href="#l45.23"></a><span id="l45.23"> /**</span>
<a href="#l45.24"></a><span id="l45.24">  * Save the archive settings to the current identity.</span>
<a href="#l45.25"></a><span id="l45.25">  */</span>
<a href="#l45.26"></a><span id="l45.26"> function onAcceptArchiveOptions() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgHdrViewSMIMEOverlay.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -168,18 +168,18 @@ function onSmartCardChange()</span>
<a href="#l46.4"></a><span id="l46.4">   // only reload encrypted windows</span>
<a href="#l46.5"></a><span id="l46.5">   if (gMyLastEncryptedURI &amp;&amp; gEncryptionStatus != -1)</span>
<a href="#l46.6"></a><span id="l46.6">     ReloadMessage();</span>
<a href="#l46.7"></a><span id="l46.7"> }</span>
<a href="#l46.8"></a><span id="l46.8"> </span>
<a href="#l46.9"></a><span id="l46.9"> function msgHdrViewSMIMEOnLoad(event)</span>
<a href="#l46.10"></a><span id="l46.10"> {</span>
<a href="#l46.11"></a><span id="l46.11">   window.crypto.enableSmartCardEvents = true;</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-  document.addEventListener(&quot;smartcard-insert&quot;, onSmartCardChange, false);</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineminus">-  document.addEventListener(&quot;smartcard-remove&quot;, onSmartCardChange, false);</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineplus">+  document.addEventListener(&quot;smartcard-insert&quot;, onSmartCardChange);</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineplus">+  document.addEventListener(&quot;smartcard-remove&quot;, onSmartCardChange);</span>
<a href="#l46.16"></a><span id="l46.16">   if (!gSMIMEBundle)</span>
<a href="#l46.17"></a><span id="l46.17">     gSMIMEBundle = document.getElementById(&quot;bundle_read_smime&quot;);</span>
<a href="#l46.18"></a><span id="l46.18"> </span>
<a href="#l46.19"></a><span id="l46.19">   // we want to register our security header sink as an opaque nsISupports</span>
<a href="#l46.20"></a><span id="l46.20">   // on the msgHdrSink used by mail.....</span>
<a href="#l46.21"></a><span id="l46.21">   msgWindow.msgHeaderSink.securityInfo = smimeHeaderSink;</span>
<a href="#l46.22"></a><span id="l46.22"> </span>
<a href="#l46.23"></a><span id="l46.23">   gSignedUINode = document.getElementById('signedHdrIcon');</span>
<a href="#l46.24"></a><span id="l46.24" class="difflineat">@@ -199,18 +199,18 @@ function msgHdrViewSMIMEOnLoad(event)</span>
<a href="#l46.25"></a><span id="l46.25">   gEncryptedURIService = </span>
<a href="#l46.26"></a><span id="l46.26">     Components.classes[&quot;@mozilla.org/messenger-smime/smime-encrypted-uris-service;1&quot;]</span>
<a href="#l46.27"></a><span id="l46.27">     .getService(Components.interfaces.nsIEncryptedSMIMEURIsService);</span>
<a href="#l46.28"></a><span id="l46.28"> }</span>
<a href="#l46.29"></a><span id="l46.29"> </span>
<a href="#l46.30"></a><span id="l46.30"> function msgHdrViewSMIMEOnUnload(event)</span>
<a href="#l46.31"></a><span id="l46.31"> {</span>
<a href="#l46.32"></a><span id="l46.32">   window.crypto.enableSmartCardEvents = false;</span>
<a href="#l46.33"></a><span id="l46.33" class="difflineminus">-  document.removeEventListener(&quot;smartcard-insert&quot;, onSmartCardChange, false);</span>
<a href="#l46.34"></a><span id="l46.34" class="difflineminus">-  document.removeEventListener(&quot;smartcard-remove&quot;, onSmartCardChange, false);</span>
<a href="#l46.35"></a><span id="l46.35" class="difflineplus">+  document.removeEventListener(&quot;smartcard-insert&quot;, onSmartCardChange);</span>
<a href="#l46.36"></a><span id="l46.36" class="difflineplus">+  document.removeEventListener(&quot;smartcard-remove&quot;, onSmartCardChange);</span>
<a href="#l46.37"></a><span id="l46.37">   forgetEncryptedURI();</span>
<a href="#l46.38"></a><span id="l46.38">   removeEventListener(&quot;messagepane-loaded&quot;, msgHdrViewSMIMEOnLoad, true);</span>
<a href="#l46.39"></a><span id="l46.39">   removeEventListener(&quot;messagepane-unloaded&quot;, msgHdrViewSMIMEOnUnload, true);</span>
<a href="#l46.40"></a><span id="l46.40">   removeEventListener(&quot;messagepane-hide&quot;, msgHdrViewSMIMEOnMessagePaneHide, true);</span>
<a href="#l46.41"></a><span id="l46.41">   removeEventListener(&quot;messagepane-unhide&quot;, msgHdrViewSMIMEOnMessagePaneUnhide, true);</span>
<a href="#l46.42"></a><span id="l46.42"> }</span>
<a href="#l46.43"></a><span id="l46.43"> </span>
<a href="#l46.44"></a><span id="l46.44"> function msgHdrViewSMIMEOnMessagePaneHide()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/suite/browser/linkToolbarOverlay.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/suite/browser/linkToolbarOverlay.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -184,27 +184,25 @@ LinkToolbarUI.prototype.initialized = fa</span>
<a href="#l47.4"></a><span id="l47.4"> </span>
<a href="#l47.5"></a><span id="l47.5"> LinkToolbarUI.prototype.initHandlers =</span>
<a href="#l47.6"></a><span id="l47.6"> function()</span>
<a href="#l47.7"></a><span id="l47.7"> {</span>
<a href="#l47.8"></a><span id="l47.8">   var contentArea = document.getElementById(&quot;appcontent&quot;);</span>
<a href="#l47.9"></a><span id="l47.9">   if (linkToolbarUI.isLinkToolbarEnabled())</span>
<a href="#l47.10"></a><span id="l47.10">   {</span>
<a href="#l47.11"></a><span id="l47.11">     if (!linkToolbarUI.addHandlerActive) {</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-      contentArea.addEventListener(&quot;select&quot;, linkToolbarUI.tabSelected,</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineminus">-                                   false);</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineplus">+      contentArea.addEventListener(&quot;select&quot;, linkToolbarUI.tabSelected);</span>
<a href="#l47.15"></a><span id="l47.15">       contentArea.addEventListener(&quot;DOMLinkAdded&quot;, linkToolbarUI.linkAdded,</span>
<a href="#l47.16"></a><span id="l47.16">                                    true);</span>
<a href="#l47.17"></a><span id="l47.17">       linkToolbarUI.addHandlerActive = true;</span>
<a href="#l47.18"></a><span id="l47.18">     }</span>
<a href="#l47.19"></a><span id="l47.19">   } else</span>
<a href="#l47.20"></a><span id="l47.20">   {</span>
<a href="#l47.21"></a><span id="l47.21">     if (linkToolbarUI.addHandlerActive) {</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineminus">-      contentArea.removeEventListener(&quot;select&quot;, linkToolbarUI.tabSelected,</span>
<a href="#l47.23"></a><span id="l47.23" class="difflineminus">-                                      false);</span>
<a href="#l47.24"></a><span id="l47.24" class="difflineplus">+      contentArea.removeEventListener(&quot;select&quot;, linkToolbarUI.tabSelected);</span>
<a href="#l47.25"></a><span id="l47.25">       contentArea.removeEventListener(&quot;DOMLinkAdded&quot;, linkToolbarUI.linkAdded,</span>
<a href="#l47.26"></a><span id="l47.26">                                       true);</span>
<a href="#l47.27"></a><span id="l47.27">       linkToolbarUI.addHandlerActive = false;</span>
<a href="#l47.28"></a><span id="l47.28">     }</span>
<a href="#l47.29"></a><span id="l47.29">   }</span>
<a href="#l47.30"></a><span id="l47.30">   if (!linkToolbarUI.initialized)</span>
<a href="#l47.31"></a><span id="l47.31">   {</span>
<a href="#l47.32"></a><span id="l47.32">     linkToolbarUI.initialized = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/suite/browser/mailNavigatorOverlay.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/suite/browser/mailNavigatorOverlay.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -151,17 +151,17 @@ function initMailContextMenuItems(aEvent</span>
<a href="#l48.4"></a><span id="l48.4"> </span>
<a href="#l48.5"></a><span id="l48.5">   gContextMenu.showItem(&quot;context-sep-apps&quot;, gContextMenu.shouldShowSeparator(&quot;context-sep-apps&quot;));</span>
<a href="#l48.6"></a><span id="l48.6"> }</span>
<a href="#l48.7"></a><span id="l48.7"> </span>
<a href="#l48.8"></a><span id="l48.8"> function initMailContextMenuPopupListener(aEvent)</span>
<a href="#l48.9"></a><span id="l48.9"> {</span>
<a href="#l48.10"></a><span id="l48.10">   var popup = document.getElementById(&quot;contentAreaContextMenu&quot;);</span>
<a href="#l48.11"></a><span id="l48.11">   if (popup)</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-    popup.addEventListener(&quot;popupshowing&quot;, initMailContextMenuItems, false);</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+    popup.addEventListener(&quot;popupshowing&quot;, initMailContextMenuItems);</span>
<a href="#l48.14"></a><span id="l48.14"> }</span>
<a href="#l48.15"></a><span id="l48.15"> </span>
<a href="#l48.16"></a><span id="l48.16"> function hideMenuitems() {</span>
<a href="#l48.17"></a><span id="l48.17">   document.getElementById(&quot;menu_newCard&quot;).hidden = gUseExternalMailto;</span>
<a href="#l48.18"></a><span id="l48.18">   var menu_sendPage = document.getElementById(&quot;menu_sendPage&quot;);</span>
<a href="#l48.19"></a><span id="l48.19">   if (menu_sendPage)</span>
<a href="#l48.20"></a><span id="l48.20">     menu_sendPage.hidden = gUseExternalMailto;</span>
<a href="#l48.21"></a><span id="l48.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/suite/browser/navigator.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/suite/browser/navigator.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -161,25 +161,25 @@ const gFormSubmitObserver = {</span>
<a href="#l49.4"></a><span id="l49.4">         // error message.</span>
<a href="#l49.5"></a><span id="l49.5">         if (gFormSubmitObserver.panel.firstChild.textContent !=</span>
<a href="#l49.6"></a><span id="l49.6">               e.originalTarget.validationMessage) {</span>
<a href="#l49.7"></a><span id="l49.7">           gFormSubmitObserver.panel.firstChild.textContent =</span>
<a href="#l49.8"></a><span id="l49.8">             e.originalTarget.validationMessage;</span>
<a href="#l49.9"></a><span id="l49.9">         }</span>
<a href="#l49.10"></a><span id="l49.10">       }</span>
<a href="#l49.11"></a><span id="l49.11">     }</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-    element.addEventListener(&quot;input&quot;, inputHandler, false);</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineminus">-    element.addEventListener(&quot;blur&quot;, blurHandler, false);</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineplus">+    element.addEventListener(&quot;input&quot;, inputHandler);</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineplus">+    element.addEventListener(&quot;blur&quot;, blurHandler);</span>
<a href="#l49.16"></a><span id="l49.16"> </span>
<a href="#l49.17"></a><span id="l49.17">     // One event to bring them all and in the darkness bind them.</span>
<a href="#l49.18"></a><span id="l49.18">     this.panel.addEventListener(&quot;popuphiding&quot;, function popupHidingHandler(aEvent) {</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineminus">-      aEvent.target.removeEventListener(&quot;popuphiding&quot;, popupHidingHandler, false);</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineminus">-      element.removeEventListener(&quot;input&quot;, inputHandler, false);</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineminus">-      element.removeEventListener(&quot;blur&quot;, blurHandler, false);</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineminus">-    }, false);</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineplus">+      aEvent.target.removeEventListener(&quot;popuphiding&quot;, popupHidingHandler);</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineplus">+      element.removeEventListener(&quot;input&quot;, inputHandler);</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineplus">+      element.removeEventListener(&quot;blur&quot;, blurHandler);</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineplus">+    });</span>
<a href="#l49.27"></a><span id="l49.27"> </span>
<a href="#l49.28"></a><span id="l49.28">     this.panel.hidden = false;</span>
<a href="#l49.29"></a><span id="l49.29"> </span>
<a href="#l49.30"></a><span id="l49.30">     var win = element.ownerDocument.defaultView;</span>
<a href="#l49.31"></a><span id="l49.31">     var style = win.getComputedStyle(element, null);</span>
<a href="#l49.32"></a><span id="l49.32">     var scale = win.QueryInterface(Components.interfaces.nsIInterfaceRequestor)</span>
<a href="#l49.33"></a><span id="l49.33">                    .getInterface(Components.interfaces.nsIDOMWindowUtils)</span>
<a href="#l49.34"></a><span id="l49.34">                    .fullZoom;</span>
<a href="#l49.35"></a><span id="l49.35" class="difflineat">@@ -593,17 +593,17 @@ function Startup()</span>
<a href="#l49.36"></a><span id="l49.36">     // Make sure we're safe at the left/top edge of screen</span>
<a href="#l49.37"></a><span id="l49.37">     document.documentElement.setAttribute(&quot;screenX&quot;, screen.availLeft);</span>
<a href="#l49.38"></a><span id="l49.38">     document.documentElement.setAttribute(&quot;screenY&quot;, screen.availTop);</span>
<a href="#l49.39"></a><span id="l49.39">   }</span>
<a href="#l49.40"></a><span id="l49.40"> </span>
<a href="#l49.41"></a><span id="l49.41">   // hook up UI through progress listener</span>
<a href="#l49.42"></a><span id="l49.42">   getBrowser().addProgressListener(window.XULBrowserWindow);</span>
<a href="#l49.43"></a><span id="l49.43">   // setup the search service DOMLinkAdded listener</span>
<a href="#l49.44"></a><span id="l49.44" class="difflineminus">-  getBrowser().addEventListener(&quot;DOMLinkAdded&quot;, BrowserSearch, false);</span>
<a href="#l49.45"></a><span id="l49.45" class="difflineplus">+  getBrowser().addEventListener(&quot;DOMLinkAdded&quot;, BrowserSearch);</span>
<a href="#l49.46"></a><span id="l49.46">   // hook up drag'n'drop</span>
<a href="#l49.47"></a><span id="l49.47">   getBrowser().droppedLinkHandler = handleDroppedLink;</span>
<a href="#l49.48"></a><span id="l49.48"> </span>
<a href="#l49.49"></a><span id="l49.49">   var uriToLoad = &quot;&quot;;</span>
<a href="#l49.50"></a><span id="l49.50"> </span>
<a href="#l49.51"></a><span id="l49.51">   // Check window.arguments[0]. If not null then use it for uriArray</span>
<a href="#l49.52"></a><span id="l49.52">   // otherwise the new window is being called when another browser</span>
<a href="#l49.53"></a><span id="l49.53">   // window already exists so use the New Window pref for uriArray</span>
<a href="#l49.54"></a><span id="l49.54" class="difflineat">@@ -752,17 +752,17 @@ function Startup()</span>
<a href="#l49.55"></a><span id="l49.55"> </span>
<a href="#l49.56"></a><span id="l49.56">     // initialize the sync UI</span>
<a href="#l49.57"></a><span id="l49.57">     gSyncUI.init();</span>
<a href="#l49.58"></a><span id="l49.58"> </span>
<a href="#l49.59"></a><span id="l49.59">     // initialize the session-restore service</span>
<a href="#l49.60"></a><span id="l49.60">     setTimeout(InitSessionStoreCallback, 0);</span>
<a href="#l49.61"></a><span id="l49.61">   }</span>
<a href="#l49.62"></a><span id="l49.62"> </span>
<a href="#l49.63"></a><span id="l49.63" class="difflineminus">-  window.addEventListener(&quot;MozAfterPaint&quot;, DelayedStartup, false);</span>
<a href="#l49.64"></a><span id="l49.64" class="difflineplus">+  window.addEventListener(&quot;MozAfterPaint&quot;, DelayedStartup);</span>
<a href="#l49.65"></a><span id="l49.65"> }</span>
<a href="#l49.66"></a><span id="l49.66"> </span>
<a href="#l49.67"></a><span id="l49.67"> // Minimal gBrowserInit shim to keep the Addon-SDK happy.</span>
<a href="#l49.68"></a><span id="l49.68"> var gBrowserInit = {</span>
<a href="#l49.69"></a><span id="l49.69">   delayedStartupFinished: false,</span>
<a href="#l49.70"></a><span id="l49.70"> }</span>
<a href="#l49.71"></a><span id="l49.71"> </span>
<a href="#l49.72"></a><span id="l49.72"> function DelayedStartup() {</span>
<a href="#l49.73"></a><span id="l49.73" class="difflineat">@@ -869,17 +869,17 @@ function Shutdown()</span>
<a href="#l49.74"></a><span id="l49.74"> {</span>
<a href="#l49.75"></a><span id="l49.75">   AeroPeek.onCloseWindow(window);</span>
<a href="#l49.76"></a><span id="l49.76"> </span>
<a href="#l49.77"></a><span id="l49.77">   PlacesStarButton.uninit();</span>
<a href="#l49.78"></a><span id="l49.78"> </span>
<a href="#l49.79"></a><span id="l49.79">   // shut down browser access support</span>
<a href="#l49.80"></a><span id="l49.80">   window.browserDOMWindow = null;</span>
<a href="#l49.81"></a><span id="l49.81"> </span>
<a href="#l49.82"></a><span id="l49.82" class="difflineminus">-  getBrowser().removeEventListener(&quot;DOMLinkAdded&quot;, BrowserSearch, false);</span>
<a href="#l49.83"></a><span id="l49.83" class="difflineplus">+  getBrowser().removeEventListener(&quot;DOMLinkAdded&quot;, BrowserSearch);</span>
<a href="#l49.84"></a><span id="l49.84"> </span>
<a href="#l49.85"></a><span id="l49.85">   try {</span>
<a href="#l49.86"></a><span id="l49.86">     getBrowser().removeProgressListener(window.XULBrowserWindow);</span>
<a href="#l49.87"></a><span id="l49.87">   } catch (ex) {</span>
<a href="#l49.88"></a><span id="l49.88">     // Perhaps we didn't get around to adding the progress listener</span>
<a href="#l49.89"></a><span id="l49.89">   }</span>
<a href="#l49.90"></a><span id="l49.90"> </span>
<a href="#l49.91"></a><span id="l49.91">   window.XULBrowserWindow.destroy();</span>
<a href="#l49.92"></a><span id="l49.92" class="difflineat">@@ -1267,17 +1267,17 @@ var BrowserSearch = {</span>
<a href="#l49.93"></a><span id="l49.93">       function webSearchCallback() {</span>
<a href="#l49.94"></a><span id="l49.94">         // This needs to be in a timeout so that we don't end up refocused</span>
<a href="#l49.95"></a><span id="l49.95">         // in the url bar</span>
<a href="#l49.96"></a><span id="l49.96">         setTimeout(BrowserSearch.webSearch, 0);</span>
<a href="#l49.97"></a><span id="l49.97">       }</span>
<a href="#l49.98"></a><span id="l49.98"> </span>
<a href="#l49.99"></a><span id="l49.99">       win = window.openDialog(getBrowserURL(), &quot;_blank&quot;,</span>
<a href="#l49.100"></a><span id="l49.100">                               &quot;chrome,all,dialog=no&quot;, &quot;about:blank&quot;);</span>
<a href="#l49.101"></a><span id="l49.101" class="difflineminus">-      win.addEventListener(&quot;load&quot;, webSearchCallback, false);</span>
<a href="#l49.102"></a><span id="l49.102" class="difflineplus">+      win.addEventListener(&quot;load&quot;, webSearchCallback);</span>
<a href="#l49.103"></a><span id="l49.103">       return;</span>
<a href="#l49.104"></a><span id="l49.104">     }</span>
<a href="#l49.105"></a><span id="l49.105"> </span>
<a href="#l49.106"></a><span id="l49.106">     if (isElementVisible(this.searchBar)) {</span>
<a href="#l49.107"></a><span id="l49.107">       this.searchBar.select();</span>
<a href="#l49.108"></a><span id="l49.108">       this.searchBar.focus();</span>
<a href="#l49.109"></a><span id="l49.109">     } else if (this.searchSidebar) {</span>
<a href="#l49.110"></a><span id="l49.110">       this.searchSidebar.focus();</span>
<a href="#l49.111"></a><span id="l49.111" class="difflineat">@@ -2413,31 +2413,31 @@ function SetPageProxyState(aState, aURI)</span>
<a href="#l49.112"></a><span id="l49.112">     gProxyFavIcon = document.getElementById(&quot;page-proxy-favicon&quot;);</span>
<a href="#l49.113"></a><span id="l49.113">   if (!gProxyDeck)</span>
<a href="#l49.114"></a><span id="l49.114">     gProxyDeck = document.getElementById(&quot;page-proxy-deck&quot;);</span>
<a href="#l49.115"></a><span id="l49.115"> </span>
<a href="#l49.116"></a><span id="l49.116">   gProxyButton.setAttribute(&quot;pageproxystate&quot;, aState);</span>
<a href="#l49.117"></a><span id="l49.117"> </span>
<a href="#l49.118"></a><span id="l49.118">   if (aState == &quot;valid&quot;) {</span>
<a href="#l49.119"></a><span id="l49.119">     gLastValidURLStr = gURLBar.value;</span>
<a href="#l49.120"></a><span id="l49.120" class="difflineminus">-    gURLBar.addEventListener(&quot;input&quot;, UpdatePageProxyState, false);</span>
<a href="#l49.121"></a><span id="l49.121" class="difflineplus">+    gURLBar.addEventListener(&quot;input&quot;, UpdatePageProxyState);</span>
<a href="#l49.122"></a><span id="l49.122">     if (gBrowser.shouldLoadFavIcon(aURI)) {</span>
<a href="#l49.123"></a><span id="l49.123">       var favStr = gBrowser.buildFavIconString(aURI);</span>
<a href="#l49.124"></a><span id="l49.124">       if (favStr != gProxyFavIcon.src) {</span>
<a href="#l49.125"></a><span id="l49.125">         gBrowser.loadFavIcon(aURI, &quot;src&quot;, gProxyFavIcon);</span>
<a href="#l49.126"></a><span id="l49.126">         gProxyDeck.selectedIndex = 0;</span>
<a href="#l49.127"></a><span id="l49.127">       }</span>
<a href="#l49.128"></a><span id="l49.128">       else gProxyDeck.selectedIndex = 1;</span>
<a href="#l49.129"></a><span id="l49.129">     }</span>
<a href="#l49.130"></a><span id="l49.130">     else {</span>
<a href="#l49.131"></a><span id="l49.131">       gProxyDeck.selectedIndex = 0;</span>
<a href="#l49.132"></a><span id="l49.132">       gProxyFavIcon.removeAttribute(&quot;src&quot;);</span>
<a href="#l49.133"></a><span id="l49.133">     }</span>
<a href="#l49.134"></a><span id="l49.134">   } else if (aState == &quot;invalid&quot;) {</span>
<a href="#l49.135"></a><span id="l49.135" class="difflineminus">-    gURLBar.removeEventListener(&quot;input&quot;, UpdatePageProxyState, false);</span>
<a href="#l49.136"></a><span id="l49.136" class="difflineplus">+    gURLBar.removeEventListener(&quot;input&quot;, UpdatePageProxyState);</span>
<a href="#l49.137"></a><span id="l49.137">     gProxyDeck.selectedIndex = 0;</span>
<a href="#l49.138"></a><span id="l49.138">     gProxyFavIcon.removeAttribute(&quot;src&quot;);</span>
<a href="#l49.139"></a><span id="l49.139">   }</span>
<a href="#l49.140"></a><span id="l49.140"> }</span>
<a href="#l49.141"></a><span id="l49.141"> </span>
<a href="#l49.142"></a><span id="l49.142"> function handlePageProxyClick(aEvent)</span>
<a href="#l49.143"></a><span id="l49.143"> {</span>
<a href="#l49.144"></a><span id="l49.144">   switch (aEvent.button) {</span>
<a href="#l49.145"></a><span id="l49.145" class="difflineat">@@ -2861,29 +2861,29 @@ var LightWeightThemeWebInstaller = {</span>
<a href="#l49.146"></a><span id="l49.146">     var data = this._getThemeFromNode(event.target);</span>
<a href="#l49.147"></a><span id="l49.147">     if (!data)</span>
<a href="#l49.148"></a><span id="l49.148">       return;</span>
<a href="#l49.149"></a><span id="l49.149"> </span>
<a href="#l49.150"></a><span id="l49.150">     this._resetPreview();</span>
<a href="#l49.151"></a><span id="l49.151"> </span>
<a href="#l49.152"></a><span id="l49.152">     this._previewWindow = event.target.ownerDocument.defaultView;</span>
<a href="#l49.153"></a><span id="l49.153">     this._previewWindow.addEventListener(&quot;pagehide&quot;, this, true);</span>
<a href="#l49.154"></a><span id="l49.154" class="difflineminus">-    gBrowser.tabContainer.addEventListener(&quot;TabSelect&quot;, this, false);</span>
<a href="#l49.155"></a><span id="l49.155" class="difflineplus">+    gBrowser.tabContainer.addEventListener(&quot;TabSelect&quot;, this);</span>
<a href="#l49.156"></a><span id="l49.156"> </span>
<a href="#l49.157"></a><span id="l49.157">     this._manager.previewTheme(data);</span>
<a href="#l49.158"></a><span id="l49.158">   },</span>
<a href="#l49.159"></a><span id="l49.159"> </span>
<a href="#l49.160"></a><span id="l49.160">   _resetPreview: function (event) {</span>
<a href="#l49.161"></a><span id="l49.161">     if (!this._previewWindow ||</span>
<a href="#l49.162"></a><span id="l49.162">         event &amp;&amp; !this._isAllowed(event.target))</span>
<a href="#l49.163"></a><span id="l49.163">       return;</span>
<a href="#l49.164"></a><span id="l49.164"> </span>
<a href="#l49.165"></a><span id="l49.165">     this._previewWindow.removeEventListener(&quot;pagehide&quot;, this, true);</span>
<a href="#l49.166"></a><span id="l49.166">     this._previewWindow = null;</span>
<a href="#l49.167"></a><span id="l49.167" class="difflineminus">-    gBrowser.tabContainer.removeEventListener(&quot;TabSelect&quot;, this, false);</span>
<a href="#l49.168"></a><span id="l49.168" class="difflineplus">+    gBrowser.tabContainer.removeEventListener(&quot;TabSelect&quot;, this);</span>
<a href="#l49.169"></a><span id="l49.169"> </span>
<a href="#l49.170"></a><span id="l49.170">     this._manager.resetPreview();</span>
<a href="#l49.171"></a><span id="l49.171">   },</span>
<a href="#l49.172"></a><span id="l49.172"> </span>
<a href="#l49.173"></a><span id="l49.173">   _isAllowed: function (node) {</span>
<a href="#l49.174"></a><span id="l49.174">     var uri = node.ownerDocument.documentURIObject;</span>
<a href="#l49.175"></a><span id="l49.175">     return Services.perms.testPermission(uri, &quot;install&quot;) == Services.perms.ALLOW_ACTION;</span>
<a href="#l49.176"></a><span id="l49.176">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/suite/browser/safeBrowsingOverlay.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/suite/browser/safeBrowsingOverlay.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -48,13 +48,13 @@ var gSafeBrowsing = {</span>
<a href="#l50.4"></a><span id="l50.4">    */</span>
<a href="#l50.5"></a><span id="l50.5">   getReportURL: function getReportURL(aName) {</span>
<a href="#l50.6"></a><span id="l50.6">     var pageUri = getBrowser().currentURI.cloneIgnoringRef();</span>
<a href="#l50.7"></a><span id="l50.7">     return SafeBrowsing.getReportURL(aName, pageUri);</span>
<a href="#l50.8"></a><span id="l50.8">   },</span>
<a href="#l50.9"></a><span id="l50.9"> </span>
<a href="#l50.10"></a><span id="l50.10">   initOverlay: function initOverlay(aEvent) {</span>
<a href="#l50.11"></a><span id="l50.11">     var popup = document.getElementById(&quot;helpPopup&quot;);</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-    popup.addEventListener(&quot;popupshowing&quot;, gSafeBrowsing.initMenuItems, false);</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+    popup.addEventListener(&quot;popupshowing&quot;, gSafeBrowsing.initMenuItems);</span>
<a href="#l50.14"></a><span id="l50.14">   }</span>
<a href="#l50.15"></a><span id="l50.15"> }</span>
<a href="#l50.16"></a><span id="l50.16"> </span>
<a href="#l50.17"></a><span id="l50.17" class="difflineminus">-window.addEventListener(&quot;load&quot;, gSafeBrowsing.initOverlay, false);</span>
<a href="#l50.18"></a><span id="l50.18" class="difflineplus">+window.addEventListener(&quot;load&quot;, gSafeBrowsing.initOverlay);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/suite/browser/tabbrowser.xml</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/suite/browser/tabbrowser.xml</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -3067,17 +3067,17 @@</span>
<a href="#l51.4"></a><span id="l51.4">         &lt;/getter&gt;</span>
<a href="#l51.5"></a><span id="l51.5">       &lt;/property&gt;</span>
<a href="#l51.6"></a><span id="l51.6"> </span>
<a href="#l51.7"></a><span id="l51.7">       &lt;field name=&quot;_lastSearchString&quot;&gt;null&lt;/field&gt;</span>
<a href="#l51.8"></a><span id="l51.8">       &lt;field name=&quot;_lastSearchHighlight&quot;&gt;false&lt;/field&gt;</span>
<a href="#l51.9"></a><span id="l51.9"> </span>
<a href="#l51.10"></a><span id="l51.10">       &lt;constructor&gt;</span>
<a href="#l51.11"></a><span id="l51.11">         &lt;![CDATA[</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-          document.addEventListener(&quot;keypress&quot;, this._keyEventHandler, false);</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+          document.addEventListener(&quot;keypress&quot;, this._keyEventHandler);</span>
<a href="#l51.14"></a><span id="l51.14">           this.arrowKeysShouldWrap = /Mac/.test(navigator.platform);</span>
<a href="#l51.15"></a><span id="l51.15">           // Bail out early if we are in tabmail. See Bug 521803.</span>
<a href="#l51.16"></a><span id="l51.16">           if (!this.mPanelContainer)</span>
<a href="#l51.17"></a><span id="l51.17">             return;</span>
<a href="#l51.18"></a><span id="l51.18"> </span>
<a href="#l51.19"></a><span id="l51.19">           this.mCurrentBrowser = this.mPanelContainer.firstChild.firstChild;</span>
<a href="#l51.20"></a><span id="l51.20">           this.mCurrentTab = this.tabContainer.firstChild;</span>
<a href="#l51.21"></a><span id="l51.21"> </span>
<a href="#l51.22"></a><span id="l51.22" class="difflineat">@@ -3133,17 +3133,17 @@</span>
<a href="#l51.23"></a><span id="l51.23">           var onclick = this.getAttribute(&quot;oncontentclick&quot;);</span>
<a href="#l51.24"></a><span id="l51.24">           if (onclick)</span>
<a href="#l51.25"></a><span id="l51.25">             this.onContentClick = new Function(&quot;event&quot;, onclick);</span>
<a href="#l51.26"></a><span id="l51.26">         ]]&gt;</span>
<a href="#l51.27"></a><span id="l51.27">       &lt;/constructor&gt;</span>
<a href="#l51.28"></a><span id="l51.28"> </span>
<a href="#l51.29"></a><span id="l51.29">       &lt;destructor&gt;</span>
<a href="#l51.30"></a><span id="l51.30">         &lt;![CDATA[</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineminus">-          document.removeEventListener(&quot;keypress&quot;, this._keyEventHandler, false);</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineplus">+          document.removeEventListener(&quot;keypress&quot;, this._keyEventHandler);</span>
<a href="#l51.33"></a><span id="l51.33">           // Bail out early if we are in tabmail. See Bug 521803.</span>
<a href="#l51.34"></a><span id="l51.34">           if (!this.mPanelContainer)</span>
<a href="#l51.35"></a><span id="l51.35">             return;</span>
<a href="#l51.36"></a><span id="l51.36"> </span>
<a href="#l51.37"></a><span id="l51.37">           for (var i = 0; i &lt; this.mTabListeners.length; ++i) {</span>
<a href="#l51.38"></a><span id="l51.38">             this.browsers[i].webProgress.removeProgressListener(this.mTabFilters[i]);</span>
<a href="#l51.39"></a><span id="l51.39">             this.mTabFilters[i].removeProgressListener(this.mTabListeners[i]);</span>
<a href="#l51.40"></a><span id="l51.40">             this.mTabFilters[i] = null;</span>
<a href="#l51.41"></a><span id="l51.41" class="difflineat">@@ -3327,23 +3327,23 @@</span>
<a href="#l51.42"></a><span id="l51.42">     &lt;implementation implements=&quot;nsIDOMEventListener&quot;&gt;</span>
<a href="#l51.43"></a><span id="l51.43">       &lt;constructor&gt;</span>
<a href="#l51.44"></a><span id="l51.44">         &lt;![CDATA[</span>
<a href="#l51.45"></a><span id="l51.45">           var tab = this.firstChild;</span>
<a href="#l51.46"></a><span id="l51.46">           // set the tabstrip's minWidth too, otherwise it immediately overflows</span>
<a href="#l51.47"></a><span id="l51.47">           this.mTabstrip.style.minWidth =</span>
<a href="#l51.48"></a><span id="l51.48">           tab.style.minWidth = this.mPrefs.getIntPref(&quot;browser.tabs.tabMinWidth&quot;) + &quot;px&quot;;</span>
<a href="#l51.49"></a><span id="l51.49">           tab.style.maxWidth = this.mPrefs.getIntPref(&quot;browser.tabs.tabMaxWidth&quot;) + &quot;px&quot;;</span>
<a href="#l51.50"></a><span id="l51.50" class="difflineminus">-          window.addEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l51.51"></a><span id="l51.51" class="difflineplus">+          window.addEventListener(&quot;resize&quot;, this);</span>
<a href="#l51.52"></a><span id="l51.52">         ]]&gt;</span>
<a href="#l51.53"></a><span id="l51.53">       &lt;/constructor&gt;</span>
<a href="#l51.54"></a><span id="l51.54"> </span>
<a href="#l51.55"></a><span id="l51.55">       &lt;destructor&gt;</span>
<a href="#l51.56"></a><span id="l51.56">         &lt;![CDATA[</span>
<a href="#l51.57"></a><span id="l51.57" class="difflineminus">-          window.removeEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l51.58"></a><span id="l51.58" class="difflineplus">+          window.removeEventListener(&quot;resize&quot;, this);</span>
<a href="#l51.59"></a><span id="l51.59">         ]]&gt;</span>
<a href="#l51.60"></a><span id="l51.60">       &lt;/destructor&gt;</span>
<a href="#l51.61"></a><span id="l51.61"> </span>
<a href="#l51.62"></a><span id="l51.62">       &lt;field name=&quot;mPrefs&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l51.63"></a><span id="l51.63">         Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l51.64"></a><span id="l51.64">                   .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l51.65"></a><span id="l51.65">       &lt;/field&gt;</span>
<a href="#l51.66"></a><span id="l51.66"> </span>
<a href="#l51.67"></a><span id="l51.67" class="difflineat">@@ -3560,17 +3560,17 @@</span>
<a href="#l51.68"></a><span id="l51.68">             // Keep some attributes of the menuitem in sync with its</span>
<a href="#l51.69"></a><span id="l51.69">             // corresponding tab (e.g. the tab label)</span>
<a href="#l51.70"></a><span id="l51.70">             aTabNode.mCorrespondingMenuitem = menuItem;</span>
<a href="#l51.71"></a><span id="l51.71">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;label&quot;);</span>
<a href="#l51.72"></a><span id="l51.72">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;crop&quot;);</span>
<a href="#l51.73"></a><span id="l51.73">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;image&quot;);</span>
<a href="#l51.74"></a><span id="l51.74">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;busy&quot;);</span>
<a href="#l51.75"></a><span id="l51.75">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;selected&quot;);</span>
<a href="#l51.76"></a><span id="l51.76" class="difflineminus">-            aTabNode.addEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l51.77"></a><span id="l51.77" class="difflineplus">+            aTabNode.addEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l51.78"></a><span id="l51.78">             menuItem.tab = aTabNode;</span>
<a href="#l51.79"></a><span id="l51.79">             this.appendChild(menuItem);</span>
<a href="#l51.80"></a><span id="l51.80">             return menuItem;</span>
<a href="#l51.81"></a><span id="l51.81">           ]]&gt;</span>
<a href="#l51.82"></a><span id="l51.82">         &lt;/body&gt;</span>
<a href="#l51.83"></a><span id="l51.83">       &lt;/method&gt;</span>
<a href="#l51.84"></a><span id="l51.84">     &lt;/implementation&gt;</span>
<a href="#l51.85"></a><span id="l51.85"> </span>
<a href="#l51.86"></a><span id="l51.86" class="difflineat">@@ -3578,18 +3578,18 @@</span>
<a href="#l51.87"></a><span id="l51.87">       &lt;handler event=&quot;popupshowing&quot;&gt;</span>
<a href="#l51.88"></a><span id="l51.88">         &lt;![CDATA[</span>
<a href="#l51.89"></a><span id="l51.89">           // set up the menu popup</span>
<a href="#l51.90"></a><span id="l51.90">           let tabcontainer = document.getBindingParent(this);</span>
<a href="#l51.91"></a><span id="l51.91">           let tabs = tabcontainer.childNodes;</span>
<a href="#l51.92"></a><span id="l51.92"> </span>
<a href="#l51.93"></a><span id="l51.93">           // Listen for changes in the tab bar.</span>
<a href="#l51.94"></a><span id="l51.94">           let tabbrowser = document.getBindingParent(tabcontainer);</span>
<a href="#l51.95"></a><span id="l51.95" class="difflineminus">-          tabbrowser.addEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l51.96"></a><span id="l51.96" class="difflineminus">-          tabcontainer.mTabstrip.addEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l51.97"></a><span id="l51.97" class="difflineplus">+          tabbrowser.addEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l51.98"></a><span id="l51.98" class="difflineplus">+          tabcontainer.mTabstrip.addEventListener(&quot;scroll&quot;, this);</span>
<a href="#l51.99"></a><span id="l51.99"> </span>
<a href="#l51.100"></a><span id="l51.100">           for (let i = 0; i &lt; tabs.length; i++)</span>
<a href="#l51.101"></a><span id="l51.101">             this._createTabMenuItem(tabs[i]);</span>
<a href="#l51.102"></a><span id="l51.102">           this._updateTabsVisibilityStatus();</span>
<a href="#l51.103"></a><span id="l51.103">         ]]&gt;</span>
<a href="#l51.104"></a><span id="l51.104">       &lt;/handler&gt;</span>
<a href="#l51.105"></a><span id="l51.105"> </span>
<a href="#l51.106"></a><span id="l51.106">       &lt;handler event=&quot;popuphiding&quot;&gt;</span>
<a href="#l51.107"></a><span id="l51.107" class="difflineat">@@ -3598,24 +3598,24 @@</span>
<a href="#l51.108"></a><span id="l51.108">           while (this.hasChildNodes())</span>
<a href="#l51.109"></a><span id="l51.109">           {</span>
<a href="#l51.110"></a><span id="l51.110">             let menuItem = this.lastChild;</span>
<a href="#l51.111"></a><span id="l51.111">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;label&quot;);</span>
<a href="#l51.112"></a><span id="l51.112">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;crop&quot;);</span>
<a href="#l51.113"></a><span id="l51.113">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;image&quot;);</span>
<a href="#l51.114"></a><span id="l51.114">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;busy&quot;);</span>
<a href="#l51.115"></a><span id="l51.115">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;selected&quot;);</span>
<a href="#l51.116"></a><span id="l51.116" class="difflineminus">-            menuItem.tab.removeEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l51.117"></a><span id="l51.117" class="difflineplus">+            menuItem.tab.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l51.118"></a><span id="l51.118">             menuItem.tab.mCorrespondingMenuitem = null;</span>
<a href="#l51.119"></a><span id="l51.119">             menuItem.tab = null;</span>
<a href="#l51.120"></a><span id="l51.120">             menuItem.remove();</span>
<a href="#l51.121"></a><span id="l51.121">           }</span>
<a href="#l51.122"></a><span id="l51.122">           let tabcontainer = document.getBindingParent(this);</span>
<a href="#l51.123"></a><span id="l51.123" class="difflineminus">-          tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l51.124"></a><span id="l51.124" class="difflineminus">-          document.getBindingParent(tabcontainer).removeEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l51.125"></a><span id="l51.125" class="difflineplus">+          tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this);</span>
<a href="#l51.126"></a><span id="l51.126" class="difflineplus">+          document.getBindingParent(tabcontainer).removeEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l51.127"></a><span id="l51.127">         ]]&gt;</span>
<a href="#l51.128"></a><span id="l51.128">       &lt;/handler&gt;</span>
<a href="#l51.129"></a><span id="l51.129"> </span>
<a href="#l51.130"></a><span id="l51.130">       &lt;handler event=&quot;command&quot;&gt;</span>
<a href="#l51.131"></a><span id="l51.131">         &lt;![CDATA[</span>
<a href="#l51.132"></a><span id="l51.132">           let tabcontainer = document.getBindingParent(this);</span>
<a href="#l51.133"></a><span id="l51.133">           let tab = event.target.tab;</span>
<a href="#l51.134"></a><span id="l51.134">           if (tabcontainer.selectedItem == tab)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/suite/browser/test/browser/browser_bug435325.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_bug435325.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l52.4"></a><span id="l52.4"> /* Ensure that clicking the button in the Offline mode neterror page makes the browser go online. See bug 435325. */</span>
<a href="#l52.5"></a><span id="l52.5"> </span>
<a href="#l52.6"></a><span id="l52.6"> var proxyPrefValue;</span>
<a href="#l52.7"></a><span id="l52.7"> </span>
<a href="#l52.8"></a><span id="l52.8"> function test() {</span>
<a href="#l52.9"></a><span id="l52.9">   waitForExplicitFinish();</span>
<a href="#l52.10"></a><span id="l52.10"> </span>
<a href="#l52.11"></a><span id="l52.11">   gBrowser.selectedTab = gBrowser.addTab();</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-  window.addEventListener(&quot;DOMContentLoaded&quot;, checkPage, false);</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+  window.addEventListener(&quot;DOMContentLoaded&quot;, checkPage);</span>
<a href="#l52.14"></a><span id="l52.14"> </span>
<a href="#l52.15"></a><span id="l52.15"> </span>
<a href="#l52.16"></a><span id="l52.16">   // Tests always connect to localhost, and per bug 87717, localhost is now</span>
<a href="#l52.17"></a><span id="l52.17">   // reachable in offline mode.  To avoid this, disable any proxy.</span>
<a href="#l52.18"></a><span id="l52.18">   proxyPrefValue = Services.prefs.getIntPref(&quot;network.proxy.type&quot;);</span>
<a href="#l52.19"></a><span id="l52.19">   Services.prefs.setIntPref(&quot;network.proxy.type&quot;, 0);</span>
<a href="#l52.20"></a><span id="l52.20"> </span>
<a href="#l52.21"></a><span id="l52.21">   // Go offline and disable the proxy and cache, then try to load the test URL.</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineat">@@ -25,17 +25,17 @@ function test() {</span>
<a href="#l52.23"></a><span id="l52.23"> }</span>
<a href="#l52.24"></a><span id="l52.24"> </span>
<a href="#l52.25"></a><span id="l52.25"> function checkPage() {</span>
<a href="#l52.26"></a><span id="l52.26">   if(content.location == &quot;about:blank&quot;) {</span>
<a href="#l52.27"></a><span id="l52.27">     info(&quot;got about:blank, which is expected once, so return&quot;);</span>
<a href="#l52.28"></a><span id="l52.28">     return;</span>
<a href="#l52.29"></a><span id="l52.29">   }</span>
<a href="#l52.30"></a><span id="l52.30"> </span>
<a href="#l52.31"></a><span id="l52.31" class="difflineminus">-  window.removeEventListener(&quot;DOMContentLoaded&quot;, checkPage, false);</span>
<a href="#l52.32"></a><span id="l52.32" class="difflineplus">+  window.removeEventListener(&quot;DOMContentLoaded&quot;, checkPage);</span>
<a href="#l52.33"></a><span id="l52.33"> </span>
<a href="#l52.34"></a><span id="l52.34">   ok(Services.io.offline, &quot;Setting Services.io.offline to true.&quot;);</span>
<a href="#l52.35"></a><span id="l52.35">   is(gBrowser.contentDocument.documentURI.substring(0,27),</span>
<a href="#l52.36"></a><span id="l52.36">     &quot;about:neterror?e=netOffline&quot;, &quot;Loading the Offline mode neterror page.&quot;);</span>
<a href="#l52.37"></a><span id="l52.37"> </span>
<a href="#l52.38"></a><span id="l52.38">   // Now press the &quot;Try Again&quot; button</span>
<a href="#l52.39"></a><span id="l52.39">   ok(gBrowser.contentDocument.getElementById(&quot;errorTryAgain&quot;),</span>
<a href="#l52.40"></a><span id="l52.40">     &quot;The error page has got a #errorTryAgain element&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/suite/browser/test/browser/browser_bug561636.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_bug561636.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -69,29 +69,29 @@ function test1() {</span>
<a href="#l53.4"></a><span id="l53.4">  * the invalid element is focused and a popup appears.</span>
<a href="#l53.5"></a><span id="l53.5">  */</span>
<a href="#l53.6"></a><span id="l53.6"> function test2()</span>
<a href="#l53.7"></a><span id="l53.7"> {</span>
<a href="#l53.8"></a><span id="l53.8">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input required id='i'&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.9"></a><span id="l53.9">   let tab = gBrowser.addTab();</span>
<a href="#l53.10"></a><span id="l53.10"> </span>
<a href="#l53.11"></a><span id="l53.11">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test2gIpopupShown() {</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test2gIpopupShown, false);</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test2gIpopupShown);</span>
<a href="#l53.14"></a><span id="l53.14"> </span>
<a href="#l53.15"></a><span id="l53.15">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.16"></a><span id="l53.16">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.17"></a><span id="l53.17">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.18"></a><span id="l53.18"> </span>
<a href="#l53.19"></a><span id="l53.19">     checkPopupShow();</span>
<a href="#l53.20"></a><span id="l53.20">     checkPopupMessage(doc);</span>
<a href="#l53.21"></a><span id="l53.21"> </span>
<a href="#l53.22"></a><span id="l53.22">     // Clean-up and next test.</span>
<a href="#l53.23"></a><span id="l53.23">     gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.24"></a><span id="l53.24">     executeSoon(test3);</span>
<a href="#l53.25"></a><span id="l53.25" class="difflineminus">-  }, false);</span>
<a href="#l53.26"></a><span id="l53.26" class="difflineplus">+  });</span>
<a href="#l53.27"></a><span id="l53.27"> </span>
<a href="#l53.28"></a><span id="l53.28">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test2TabLBLoad(aEvent) {</span>
<a href="#l53.29"></a><span id="l53.29">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test2TabLBLoad, true);</span>
<a href="#l53.30"></a><span id="l53.30"> </span>
<a href="#l53.31"></a><span id="l53.31">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.32"></a><span id="l53.32">   }, true);</span>
<a href="#l53.33"></a><span id="l53.33"> </span>
<a href="#l53.34"></a><span id="l53.34">   gBrowser.selectedTab = tab;</span>
<a href="#l53.35"></a><span id="l53.35" class="difflineat">@@ -103,29 +103,29 @@ function test2()</span>
<a href="#l53.36"></a><span id="l53.36">  * the first invalid element is focused and a popup appears.</span>
<a href="#l53.37"></a><span id="l53.37">  */</span>
<a href="#l53.38"></a><span id="l53.38"> function test3()</span>
<a href="#l53.39"></a><span id="l53.39"> {</span>
<a href="#l53.40"></a><span id="l53.40">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input&gt;&lt;input id='i' required&gt;&lt;input required&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.41"></a><span id="l53.41">   let tab = gBrowser.addTab();</span>
<a href="#l53.42"></a><span id="l53.42"> </span>
<a href="#l53.43"></a><span id="l53.43">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test3gIPopupShown() {</span>
<a href="#l53.44"></a><span id="l53.44" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test3gIPopupShown, false);</span>
<a href="#l53.45"></a><span id="l53.45" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test3gIPopupShown);</span>
<a href="#l53.46"></a><span id="l53.46"> </span>
<a href="#l53.47"></a><span id="l53.47">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.48"></a><span id="l53.48">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.49"></a><span id="l53.49">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.50"></a><span id="l53.50"> </span>
<a href="#l53.51"></a><span id="l53.51">     checkPopupShow();</span>
<a href="#l53.52"></a><span id="l53.52">     checkPopupMessage(doc);</span>
<a href="#l53.53"></a><span id="l53.53"> </span>
<a href="#l53.54"></a><span id="l53.54">     // Clean-up and next test.</span>
<a href="#l53.55"></a><span id="l53.55">     gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.56"></a><span id="l53.56">     executeSoon(test4a);</span>
<a href="#l53.57"></a><span id="l53.57" class="difflineminus">-  }, false);</span>
<a href="#l53.58"></a><span id="l53.58" class="difflineplus">+  });</span>
<a href="#l53.59"></a><span id="l53.59"> </span>
<a href="#l53.60"></a><span id="l53.60">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test3TabLBLoad(aEvent) {</span>
<a href="#l53.61"></a><span id="l53.61">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test3TabLBLoad, true);</span>
<a href="#l53.62"></a><span id="l53.62"> </span>
<a href="#l53.63"></a><span id="l53.63">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.64"></a><span id="l53.64">   }, true);</span>
<a href="#l53.65"></a><span id="l53.65"> </span>
<a href="#l53.66"></a><span id="l53.66">   gBrowser.selectedTab = tab;</span>
<a href="#l53.67"></a><span id="l53.67" class="difflineat">@@ -137,17 +137,17 @@ function test3()</span>
<a href="#l53.68"></a><span id="l53.68">  * invalid element if the element becomes valid.</span>
<a href="#l53.69"></a><span id="l53.69">  */</span>
<a href="#l53.70"></a><span id="l53.70"> function test4a()</span>
<a href="#l53.71"></a><span id="l53.71"> {</span>
<a href="#l53.72"></a><span id="l53.72">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input id='i' required&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.73"></a><span id="l53.73">   let tab = gBrowser.addTab();</span>
<a href="#l53.74"></a><span id="l53.74"> </span>
<a href="#l53.75"></a><span id="l53.75">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test4agIPopupShown() {</span>
<a href="#l53.76"></a><span id="l53.76" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test4agIPopupShown, false);</span>
<a href="#l53.77"></a><span id="l53.77" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test4agIPopupShown);</span>
<a href="#l53.78"></a><span id="l53.78"> </span>
<a href="#l53.79"></a><span id="l53.79">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.80"></a><span id="l53.80">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.81"></a><span id="l53.81">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.82"></a><span id="l53.82"> </span>
<a href="#l53.83"></a><span id="l53.83">     checkPopupShow();</span>
<a href="#l53.84"></a><span id="l53.84">     checkPopupMessage(doc);</span>
<a href="#l53.85"></a><span id="l53.85"> </span>
<a href="#l53.86"></a><span id="l53.86" class="difflineat">@@ -155,17 +155,17 @@ function test4a()</span>
<a href="#l53.87"></a><span id="l53.87"> </span>
<a href="#l53.88"></a><span id="l53.88">     executeSoon(function () {</span>
<a href="#l53.89"></a><span id="l53.89">       checkPopupHide();</span>
<a href="#l53.90"></a><span id="l53.90"> </span>
<a href="#l53.91"></a><span id="l53.91">       // Clean-up and next test.</span>
<a href="#l53.92"></a><span id="l53.92">       gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.93"></a><span id="l53.93">       executeSoon(test4b);</span>
<a href="#l53.94"></a><span id="l53.94">     });</span>
<a href="#l53.95"></a><span id="l53.95" class="difflineminus">-  }, false);</span>
<a href="#l53.96"></a><span id="l53.96" class="difflineplus">+  });</span>
<a href="#l53.97"></a><span id="l53.97"> </span>
<a href="#l53.98"></a><span id="l53.98">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test4aTabLBLoad(aEvent) {</span>
<a href="#l53.99"></a><span id="l53.99">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test4aTabLBLoad, true);</span>
<a href="#l53.100"></a><span id="l53.100"> </span>
<a href="#l53.101"></a><span id="l53.101">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.102"></a><span id="l53.102">   }, true);</span>
<a href="#l53.103"></a><span id="l53.103"> </span>
<a href="#l53.104"></a><span id="l53.104">   gBrowser.selectedTab = tab;</span>
<a href="#l53.105"></a><span id="l53.105" class="difflineat">@@ -177,17 +177,17 @@ function test4a()</span>
<a href="#l53.106"></a><span id="l53.106">  * invalid element if the element is still invalid.</span>
<a href="#l53.107"></a><span id="l53.107">  */</span>
<a href="#l53.108"></a><span id="l53.108"> function test4b()</span>
<a href="#l53.109"></a><span id="l53.109"> {</span>
<a href="#l53.110"></a><span id="l53.110">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input type='email' id='i' required&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.111"></a><span id="l53.111">   let tab = gBrowser.addTab();</span>
<a href="#l53.112"></a><span id="l53.112"> </span>
<a href="#l53.113"></a><span id="l53.113">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test4bgIpopupShown() {</span>
<a href="#l53.114"></a><span id="l53.114" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test4bgIpopupShown, false);</span>
<a href="#l53.115"></a><span id="l53.115" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test4bgIpopupShown);</span>
<a href="#l53.116"></a><span id="l53.116"> </span>
<a href="#l53.117"></a><span id="l53.117">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.118"></a><span id="l53.118">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.119"></a><span id="l53.119">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.120"></a><span id="l53.120"> </span>
<a href="#l53.121"></a><span id="l53.121">     checkPopupShow();</span>
<a href="#l53.122"></a><span id="l53.122">     checkPopupMessage(doc);</span>
<a href="#l53.123"></a><span id="l53.123"> </span>
<a href="#l53.124"></a><span id="l53.124" class="difflineat">@@ -195,17 +195,17 @@ function test4b()</span>
<a href="#l53.125"></a><span id="l53.125"> </span>
<a href="#l53.126"></a><span id="l53.126">     executeSoon(function () {</span>
<a href="#l53.127"></a><span id="l53.127">       checkPopupShow();</span>
<a href="#l53.128"></a><span id="l53.128"> </span>
<a href="#l53.129"></a><span id="l53.129">       // Clean-up and next test.</span>
<a href="#l53.130"></a><span id="l53.130">       gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.131"></a><span id="l53.131">       executeSoon(test5);</span>
<a href="#l53.132"></a><span id="l53.132">     });</span>
<a href="#l53.133"></a><span id="l53.133" class="difflineminus">-  }, false);</span>
<a href="#l53.134"></a><span id="l53.134" class="difflineplus">+  });</span>
<a href="#l53.135"></a><span id="l53.135"> </span>
<a href="#l53.136"></a><span id="l53.136">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test4bTabLBLoad(aEvent) {</span>
<a href="#l53.137"></a><span id="l53.137">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test4bTabLBLoad, true);</span>
<a href="#l53.138"></a><span id="l53.138"> </span>
<a href="#l53.139"></a><span id="l53.139">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.140"></a><span id="l53.140">   }, true);</span>
<a href="#l53.141"></a><span id="l53.141"> </span>
<a href="#l53.142"></a><span id="l53.142">   gBrowser.selectedTab = tab;</span>
<a href="#l53.143"></a><span id="l53.143" class="difflineat">@@ -217,17 +217,17 @@ function test4b()</span>
<a href="#l53.144"></a><span id="l53.144">  * element.</span>
<a href="#l53.145"></a><span id="l53.145">  */</span>
<a href="#l53.146"></a><span id="l53.146"> function test5()</span>
<a href="#l53.147"></a><span id="l53.147"> {</span>
<a href="#l53.148"></a><span id="l53.148">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input id='i' required&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.149"></a><span id="l53.149">   let tab = gBrowser.addTab();</span>
<a href="#l53.150"></a><span id="l53.150"> </span>
<a href="#l53.151"></a><span id="l53.151">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test5gIpopupShown() {</span>
<a href="#l53.152"></a><span id="l53.152" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test5gIpopupShown, false);</span>
<a href="#l53.153"></a><span id="l53.153" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test5gIpopupShown);</span>
<a href="#l53.154"></a><span id="l53.154"> </span>
<a href="#l53.155"></a><span id="l53.155">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.156"></a><span id="l53.156">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.157"></a><span id="l53.157">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.158"></a><span id="l53.158"> </span>
<a href="#l53.159"></a><span id="l53.159">     checkPopupShow();</span>
<a href="#l53.160"></a><span id="l53.160">     checkPopupMessage(doc);</span>
<a href="#l53.161"></a><span id="l53.161"> </span>
<a href="#l53.162"></a><span id="l53.162" class="difflineat">@@ -235,17 +235,17 @@ function test5()</span>
<a href="#l53.163"></a><span id="l53.163"> </span>
<a href="#l53.164"></a><span id="l53.164">     executeSoon(function () {</span>
<a href="#l53.165"></a><span id="l53.165">       checkPopupHide();</span>
<a href="#l53.166"></a><span id="l53.166"> </span>
<a href="#l53.167"></a><span id="l53.167">       // Clean-up and next test.</span>
<a href="#l53.168"></a><span id="l53.168">       gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.169"></a><span id="l53.169">       executeSoon(test6);</span>
<a href="#l53.170"></a><span id="l53.170">     });</span>
<a href="#l53.171"></a><span id="l53.171" class="difflineminus">-  }, false);</span>
<a href="#l53.172"></a><span id="l53.172" class="difflineplus">+  });</span>
<a href="#l53.173"></a><span id="l53.173"> </span>
<a href="#l53.174"></a><span id="l53.174">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test5TabLBLoad(aEvent) {</span>
<a href="#l53.175"></a><span id="l53.175">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test5TabLBLoad, true);</span>
<a href="#l53.176"></a><span id="l53.176"> </span>
<a href="#l53.177"></a><span id="l53.177">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.178"></a><span id="l53.178">   }, true);</span>
<a href="#l53.179"></a><span id="l53.179"> </span>
<a href="#l53.180"></a><span id="l53.180">   gBrowser.selectedTab = tab;</span>
<a href="#l53.181"></a><span id="l53.181" class="difflineat">@@ -256,17 +256,17 @@ function test5()</span>
<a href="#l53.182"></a><span id="l53.182">  * In this test, we check that we can hide the popup by pressing TAB.</span>
<a href="#l53.183"></a><span id="l53.183">  */</span>
<a href="#l53.184"></a><span id="l53.184"> function test6()</span>
<a href="#l53.185"></a><span id="l53.185"> {</span>
<a href="#l53.186"></a><span id="l53.186">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input id='i' required&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.187"></a><span id="l53.187">   let tab = gBrowser.addTab();</span>
<a href="#l53.188"></a><span id="l53.188"> </span>
<a href="#l53.189"></a><span id="l53.189">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test6gIpopupShown() {</span>
<a href="#l53.190"></a><span id="l53.190" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test6gIpopupShown, false);</span>
<a href="#l53.191"></a><span id="l53.191" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test6gIpopupShown);</span>
<a href="#l53.192"></a><span id="l53.192"> </span>
<a href="#l53.193"></a><span id="l53.193">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.194"></a><span id="l53.194">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.195"></a><span id="l53.195">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.196"></a><span id="l53.196"> </span>
<a href="#l53.197"></a><span id="l53.197">     checkPopupShow();</span>
<a href="#l53.198"></a><span id="l53.198">     checkPopupMessage(doc);</span>
<a href="#l53.199"></a><span id="l53.199"> </span>
<a href="#l53.200"></a><span id="l53.200" class="difflineat">@@ -274,17 +274,17 @@ function test6()</span>
<a href="#l53.201"></a><span id="l53.201"> </span>
<a href="#l53.202"></a><span id="l53.202">     executeSoon(function () {</span>
<a href="#l53.203"></a><span id="l53.203">       checkPopupHide();</span>
<a href="#l53.204"></a><span id="l53.204"> </span>
<a href="#l53.205"></a><span id="l53.205">       // Clean-up and next test.</span>
<a href="#l53.206"></a><span id="l53.206">       gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.207"></a><span id="l53.207">       executeSoon(test7);</span>
<a href="#l53.208"></a><span id="l53.208">     });</span>
<a href="#l53.209"></a><span id="l53.209" class="difflineminus">-  }, false);</span>
<a href="#l53.210"></a><span id="l53.210" class="difflineplus">+  });</span>
<a href="#l53.211"></a><span id="l53.211"> </span>
<a href="#l53.212"></a><span id="l53.212">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test6TabLBLoad(aEvent) {</span>
<a href="#l53.213"></a><span id="l53.213">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test6TabLBLoad, true);</span>
<a href="#l53.214"></a><span id="l53.214"> </span>
<a href="#l53.215"></a><span id="l53.215">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.216"></a><span id="l53.216">   }, true);</span>
<a href="#l53.217"></a><span id="l53.217"> </span>
<a href="#l53.218"></a><span id="l53.218">   gBrowser.selectedTab = tab;</span>
<a href="#l53.219"></a><span id="l53.219" class="difflineat">@@ -295,17 +295,17 @@ function test6()</span>
<a href="#l53.220"></a><span id="l53.220">  * In this test, we check that the popup will hide if we move to another tab.</span>
<a href="#l53.221"></a><span id="l53.221">  */</span>
<a href="#l53.222"></a><span id="l53.222"> function test7()</span>
<a href="#l53.223"></a><span id="l53.223"> {</span>
<a href="#l53.224"></a><span id="l53.224">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input id='i' required&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.225"></a><span id="l53.225">   let tab = gBrowser.addTab();</span>
<a href="#l53.226"></a><span id="l53.226"> </span>
<a href="#l53.227"></a><span id="l53.227">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test7gIpopupShown() {</span>
<a href="#l53.228"></a><span id="l53.228" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test7gIpopupShown, false);</span>
<a href="#l53.229"></a><span id="l53.229" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test7gIpopupShown);</span>
<a href="#l53.230"></a><span id="l53.230"> </span>
<a href="#l53.231"></a><span id="l53.231">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.232"></a><span id="l53.232">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.233"></a><span id="l53.233">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.234"></a><span id="l53.234"> </span>
<a href="#l53.235"></a><span id="l53.235">     checkPopupShow();</span>
<a href="#l53.236"></a><span id="l53.236">     checkPopupMessage(doc);</span>
<a href="#l53.237"></a><span id="l53.237"> </span>
<a href="#l53.238"></a><span id="l53.238" class="difflineat">@@ -316,17 +316,17 @@ function test7()</span>
<a href="#l53.239"></a><span id="l53.239">     executeSoon(function() {</span>
<a href="#l53.240"></a><span id="l53.240">       checkPopupHide();</span>
<a href="#l53.241"></a><span id="l53.241"> </span>
<a href="#l53.242"></a><span id="l53.242">       // Clean-up and next test.</span>
<a href="#l53.243"></a><span id="l53.243">       gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.244"></a><span id="l53.244">       gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.245"></a><span id="l53.245">       executeSoon(test8);</span>
<a href="#l53.246"></a><span id="l53.246">     });</span>
<a href="#l53.247"></a><span id="l53.247" class="difflineminus">-  }, false);</span>
<a href="#l53.248"></a><span id="l53.248" class="difflineplus">+  });</span>
<a href="#l53.249"></a><span id="l53.249"> </span>
<a href="#l53.250"></a><span id="l53.250">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test7TabLBLoad(aEvent) {</span>
<a href="#l53.251"></a><span id="l53.251">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test7TabLBLoad, true);</span>
<a href="#l53.252"></a><span id="l53.252"> </span>
<a href="#l53.253"></a><span id="l53.253">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.254"></a><span id="l53.254">   }, true);</span>
<a href="#l53.255"></a><span id="l53.255"> </span>
<a href="#l53.256"></a><span id="l53.256">   gBrowser.selectedTab = tab;</span>
<a href="#l53.257"></a><span id="l53.257" class="difflineat">@@ -379,31 +379,31 @@ function test8()</span>
<a href="#l53.258"></a><span id="l53.258">  * In this test, we check that the author defined error message is shown.</span>
<a href="#l53.259"></a><span id="l53.259">  */</span>
<a href="#l53.260"></a><span id="l53.260"> function test9()</span>
<a href="#l53.261"></a><span id="l53.261"> {</span>
<a href="#l53.262"></a><span id="l53.262">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input x-moz-errormessage='foo' required id='i'&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.263"></a><span id="l53.263">   let tab = gBrowser.addTab();</span>
<a href="#l53.264"></a><span id="l53.264"> </span>
<a href="#l53.265"></a><span id="l53.265">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test9gIpopupShown() {</span>
<a href="#l53.266"></a><span id="l53.266" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test9gIpopupShown, false);</span>
<a href="#l53.267"></a><span id="l53.267" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test9gIpopupShown);</span>
<a href="#l53.268"></a><span id="l53.268"> </span>
<a href="#l53.269"></a><span id="l53.269">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.270"></a><span id="l53.270">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l53.271"></a><span id="l53.271">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.272"></a><span id="l53.272"> </span>
<a href="#l53.273"></a><span id="l53.273">     checkPopupShow();</span>
<a href="#l53.274"></a><span id="l53.274"> </span>
<a href="#l53.275"></a><span id="l53.275">     is(gInvalidFormPopup.firstChild.textContent, &quot;foo&quot;,</span>
<a href="#l53.276"></a><span id="l53.276">        &quot;The panel should show the author defined error message&quot;);</span>
<a href="#l53.277"></a><span id="l53.277"> </span>
<a href="#l53.278"></a><span id="l53.278">     // Clean-up and next test.</span>
<a href="#l53.279"></a><span id="l53.279">     gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.280"></a><span id="l53.280">     executeSoon(test10);</span>
<a href="#l53.281"></a><span id="l53.281" class="difflineminus">-  }, false);</span>
<a href="#l53.282"></a><span id="l53.282" class="difflineplus">+  });</span>
<a href="#l53.283"></a><span id="l53.283"> </span>
<a href="#l53.284"></a><span id="l53.284">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test9TabLBLoad(aEvent) {</span>
<a href="#l53.285"></a><span id="l53.285">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test9TabLBLoad, true);</span>
<a href="#l53.286"></a><span id="l53.286"> </span>
<a href="#l53.287"></a><span id="l53.287">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.288"></a><span id="l53.288">   }, true);</span>
<a href="#l53.289"></a><span id="l53.289"> </span>
<a href="#l53.290"></a><span id="l53.290">   gBrowser.selectedTab = tab;</span>
<a href="#l53.291"></a><span id="l53.291" class="difflineat">@@ -414,44 +414,44 @@ function test9()</span>
<a href="#l53.292"></a><span id="l53.292">  * In this test, we check that the message is correctly updated when it changes.</span>
<a href="#l53.293"></a><span id="l53.293">  */</span>
<a href="#l53.294"></a><span id="l53.294"> function test10()</span>
<a href="#l53.295"></a><span id="l53.295"> {</span>
<a href="#l53.296"></a><span id="l53.296">   let uri = &quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input type='email' required id='i'&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;&quot;;</span>
<a href="#l53.297"></a><span id="l53.297">   let tab = gBrowser.addTab();</span>
<a href="#l53.298"></a><span id="l53.298"> </span>
<a href="#l53.299"></a><span id="l53.299">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function test10gIpopupShown() {</span>
<a href="#l53.300"></a><span id="l53.300" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test10gIpopupShown, false);</span>
<a href="#l53.301"></a><span id="l53.301" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, test10gIpopupShown);</span>
<a href="#l53.302"></a><span id="l53.302"> </span>
<a href="#l53.303"></a><span id="l53.303">     let doc = gBrowser.contentDocument;</span>
<a href="#l53.304"></a><span id="l53.304">     let input = doc.getElementById('i');</span>
<a href="#l53.305"></a><span id="l53.305">     is(doc.activeElement, input, &quot;First invalid element should be focused&quot;);</span>
<a href="#l53.306"></a><span id="l53.306"> </span>
<a href="#l53.307"></a><span id="l53.307">     checkPopupShow();</span>
<a href="#l53.308"></a><span id="l53.308"> </span>
<a href="#l53.309"></a><span id="l53.309">     is(gInvalidFormPopup.firstChild.textContent, input.validationMessage,</span>
<a href="#l53.310"></a><span id="l53.310">        &quot;The panel should show the current validation message&quot;);</span>
<a href="#l53.311"></a><span id="l53.311"> </span>
<a href="#l53.312"></a><span id="l53.312">     input.addEventListener('input', function test10InputInput() {</span>
<a href="#l53.313"></a><span id="l53.313" class="difflineminus">-      input.removeEventListener('input', test10InputInput, false);</span>
<a href="#l53.314"></a><span id="l53.314" class="difflineplus">+      input.removeEventListener('input', test10InputInput);</span>
<a href="#l53.315"></a><span id="l53.315"> </span>
<a href="#l53.316"></a><span id="l53.316">       executeSoon(function() {</span>
<a href="#l53.317"></a><span id="l53.317">         // Now, the element suffers from another error, the message should have</span>
<a href="#l53.318"></a><span id="l53.318">         // been updated.</span>
<a href="#l53.319"></a><span id="l53.319">         is(gInvalidFormPopup.firstChild.textContent, input.validationMessage,</span>
<a href="#l53.320"></a><span id="l53.320">            &quot;The panel should show the current validation message&quot;);</span>
<a href="#l53.321"></a><span id="l53.321"> </span>
<a href="#l53.322"></a><span id="l53.322">         // Clean-up and next test.</span>
<a href="#l53.323"></a><span id="l53.323">         gBrowser.removeTab(gBrowser.selectedTab);</span>
<a href="#l53.324"></a><span id="l53.324">         executeSoon(finish);</span>
<a href="#l53.325"></a><span id="l53.325">       });</span>
<a href="#l53.326"></a><span id="l53.326" class="difflineminus">-    }, false);</span>
<a href="#l53.327"></a><span id="l53.327" class="difflineplus">+    });</span>
<a href="#l53.328"></a><span id="l53.328"> </span>
<a href="#l53.329"></a><span id="l53.329">     EventUtils.synthesizeKey('f', {});</span>
<a href="#l53.330"></a><span id="l53.330" class="difflineminus">-  }, false);</span>
<a href="#l53.331"></a><span id="l53.331" class="difflineplus">+  });</span>
<a href="#l53.332"></a><span id="l53.332"> </span>
<a href="#l53.333"></a><span id="l53.333">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function test10TabLBLoad(aEvent) {</span>
<a href="#l53.334"></a><span id="l53.334">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, test10TabLBLoad, true);</span>
<a href="#l53.335"></a><span id="l53.335"> </span>
<a href="#l53.336"></a><span id="l53.336">     gBrowser.contentDocument.getElementById('s').click();</span>
<a href="#l53.337"></a><span id="l53.337">   }, true);</span>
<a href="#l53.338"></a><span id="l53.338"> </span>
<a href="#l53.339"></a><span id="l53.339">   gBrowser.selectedTab = tab;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/suite/browser/test/browser/browser_bug595507.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_bug595507.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -8,29 +8,29 @@ ok(gInvalidFormPopup,</span>
<a href="#l54.4"></a><span id="l54.4"> function test()</span>
<a href="#l54.5"></a><span id="l54.5"> {</span>
<a href="#l54.6"></a><span id="l54.6">   waitForExplicitFinish();</span>
<a href="#l54.7"></a><span id="l54.7"> </span>
<a href="#l54.8"></a><span id="l54.8">   let uri = &quot;data:text/html,&lt;iframe src=\&quot;data:text/html,&lt;iframe name='t'&gt;&lt;/iframe&gt;&lt;form target='t' action='data:text/html,'&gt;&lt;input required id='i'&gt;&lt;input id='s' type='submit'&gt;&lt;/form&gt;\&quot;&lt;/iframe&gt;&quot;;</span>
<a href="#l54.9"></a><span id="l54.9">   let tab = gBrowser.addTab();</span>
<a href="#l54.10"></a><span id="l54.10"> </span>
<a href="#l54.11"></a><span id="l54.11">   gInvalidFormPopup.addEventListener(&quot;popupshown&quot;, function testgIpopupShown() {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, testgIpopupShown, false);</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineplus">+    gInvalidFormPopup.removeEventListener(&quot;popupshown&quot;, testgIpopupShown);</span>
<a href="#l54.14"></a><span id="l54.14"> </span>
<a href="#l54.15"></a><span id="l54.15">     let doc = gBrowser.contentDocument.getElementsByTagName('iframe')[0].contentDocument;</span>
<a href="#l54.16"></a><span id="l54.16">     is(doc.activeElement, doc.getElementById('i'),</span>
<a href="#l54.17"></a><span id="l54.17">        &quot;First invalid element should be focused&quot;);</span>
<a href="#l54.18"></a><span id="l54.18"> </span>
<a href="#l54.19"></a><span id="l54.19">     ok(gInvalidFormPopup.state == 'showing' || gInvalidFormPopup.state == 'open',</span>
<a href="#l54.20"></a><span id="l54.20">        &quot;The invalid form popup should be shown&quot;);</span>
<a href="#l54.21"></a><span id="l54.21"> </span>
<a href="#l54.22"></a><span id="l54.22">     // Clean-up and next test.</span>
<a href="#l54.23"></a><span id="l54.23">     gBrowser.removeTab(gBrowser.selectedTab, {animate: false});</span>
<a href="#l54.24"></a><span id="l54.24">     executeSoon(finish);</span>
<a href="#l54.25"></a><span id="l54.25" class="difflineminus">-  }, false);</span>
<a href="#l54.26"></a><span id="l54.26" class="difflineplus">+  });</span>
<a href="#l54.27"></a><span id="l54.27"> </span>
<a href="#l54.28"></a><span id="l54.28">   tab.linkedBrowser.addEventListener(&quot;load&quot;, function testTabLBLoad(aEvent) {</span>
<a href="#l54.29"></a><span id="l54.29">     tab.linkedBrowser.removeEventListener(&quot;load&quot;, testTabLBLoad, true);</span>
<a href="#l54.30"></a><span id="l54.30"> </span>
<a href="#l54.31"></a><span id="l54.31">     gBrowser.contentDocument.getElementsByTagName('iframe')[0].contentDocument</span>
<a href="#l54.32"></a><span id="l54.32">       .getElementById('s').click();</span>
<a href="#l54.33"></a><span id="l54.33">   }, true);</span>
<a href="#l54.34"></a><span id="l54.34"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/suite/browser/test/browser/browser_ctrlTab.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_ctrlTab.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -58,35 +58,35 @@ function test() {</span>
<a href="#l55.4"></a><span id="l55.4">   assertTabs(1);</span>
<a href="#l55.5"></a><span id="l55.5"> </span>
<a href="#l55.6"></a><span id="l55.6">   { // test for bug 445768</span>
<a href="#l55.7"></a><span id="l55.7">     let focusedWindow = document.commandDispatcher.focusedWindow;</span>
<a href="#l55.8"></a><span id="l55.8">     let eventConsumed = true;</span>
<a href="#l55.9"></a><span id="l55.9">     let detectKeyEvent = function (event) {</span>
<a href="#l55.10"></a><span id="l55.10">       eventConsumed = event.defaultPrevented;</span>
<a href="#l55.11"></a><span id="l55.11">     };</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-    document.addEventListener(&quot;keypress&quot;, detectKeyEvent, false);</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+    document.addEventListener(&quot;keypress&quot;, detectKeyEvent);</span>
<a href="#l55.14"></a><span id="l55.14">     pressCtrlTab();</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineminus">-    document.removeEventListener(&quot;keypress&quot;, detectKeyEvent, false);</span>
<a href="#l55.16"></a><span id="l55.16" class="difflineplus">+    document.removeEventListener(&quot;keypress&quot;, detectKeyEvent);</span>
<a href="#l55.17"></a><span id="l55.17">     ok(eventConsumed, &quot;Ctrl+Tab consumed by the tabbed browser if one tab is open&quot;);</span>
<a href="#l55.18"></a><span id="l55.18">     is(focusedWindow.location, document.commandDispatcher.focusedWindow.location,</span>
<a href="#l55.19"></a><span id="l55.19">        &quot;Ctrl+Tab doesn't change focus if one tab is open&quot;);</span>
<a href="#l55.20"></a><span id="l55.20">   }</span>
<a href="#l55.21"></a><span id="l55.21"> </span>
<a href="#l55.22"></a><span id="l55.22">   gBrowser.addTab();</span>
<a href="#l55.23"></a><span id="l55.23">   gBrowser.addTab();</span>
<a href="#l55.24"></a><span id="l55.24">   gBrowser.addTab();</span>
<a href="#l55.25"></a><span id="l55.25"> </span>
<a href="#l55.26"></a><span id="l55.26">   assertTabs(4);</span>
<a href="#l55.27"></a><span id="l55.27">   selectTabs([0, 1, 2, 3]);</span>
<a href="#l55.28"></a><span id="l55.28">   pressCtrlTab();</span>
<a href="#l55.29"></a><span id="l55.29" class="difflineminus">-  ctrlTab.panel.addEventListener(&quot;popupshown&quot;, stickyTests, false);</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineplus">+  ctrlTab.panel.addEventListener(&quot;popupshown&quot;, stickyTests);</span>
<a href="#l55.31"></a><span id="l55.31"> </span>
<a href="#l55.32"></a><span id="l55.32">   function stickyTests() {</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineminus">-    ctrlTab.panel.removeEventListener(&quot;popupshown&quot;, stickyTests, false);</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineplus">+    ctrlTab.panel.removeEventListener(&quot;popupshown&quot;, stickyTests);</span>
<a href="#l55.35"></a><span id="l55.35"> </span>
<a href="#l55.36"></a><span id="l55.36">     EventUtils.synthesizeKey(&quot;f&quot;, { ctrlKey: true });</span>
<a href="#l55.37"></a><span id="l55.37">     is(document.activeElement, ctrlTab.searchField.inputField,</span>
<a href="#l55.38"></a><span id="l55.38">        &quot;Ctrl+Tab -&gt; Ctrl+F focuses the panel's search field&quot;);</span>
<a href="#l55.39"></a><span id="l55.39"> </span>
<a href="#l55.40"></a><span id="l55.40">     releaseCtrl();</span>
<a href="#l55.41"></a><span id="l55.41">     ok(isOpen(),</span>
<a href="#l55.42"></a><span id="l55.42">        &quot;panel is sticky after focusing the search field and releasing the Ctrl key&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_pluginCrashCommentAndURL.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -22,24 +22,23 @@ function test() {</span>
<a href="#l56.4"></a><span id="l56.4">             getService(Ci.nsIEnvironment);</span>
<a href="#l56.5"></a><span id="l56.5">   let noReport = env.get(&quot;MOZ_CRASHREPORTER_NO_REPORT&quot;);</span>
<a href="#l56.6"></a><span id="l56.6">   let serverURL = env.get(&quot;MOZ_CRASHREPORTER_URL&quot;);</span>
<a href="#l56.7"></a><span id="l56.7">   env.set(&quot;MOZ_CRASHREPORTER_NO_REPORT&quot;, &quot;&quot;);</span>
<a href="#l56.8"></a><span id="l56.8">   env.set(&quot;MOZ_CRASHREPORTER_URL&quot;, SERVER_URL);</span>
<a href="#l56.9"></a><span id="l56.9"> </span>
<a href="#l56.10"></a><span id="l56.10">   let tab = gBrowser.loadOneTab(&quot;about:blank&quot;, { inBackground: false });</span>
<a href="#l56.11"></a><span id="l56.11">   let browser = tab.linkedBrowser;</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-  browser.addEventListener(&quot;PluginCrashed&quot;, onCrash, false);</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+  browser.addEventListener(&quot;PluginCrashed&quot;, onCrash);</span>
<a href="#l56.14"></a><span id="l56.14">   Services.obs.addObserver(onSubmitStatus, &quot;crash-report-status&quot;, false);</span>
<a href="#l56.15"></a><span id="l56.15"> </span>
<a href="#l56.16"></a><span id="l56.16">   registerCleanupFunction(function cleanUp() {</span>
<a href="#l56.17"></a><span id="l56.17">     env.set(&quot;MOZ_CRASHREPORTER_NO_REPORT&quot;, noReport);</span>
<a href="#l56.18"></a><span id="l56.18">     env.set(&quot;MOZ_CRASHREPORTER_URL&quot;, serverURL);</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineminus">-    gBrowser.selectedBrowser.removeEventListener(&quot;PluginCrashed&quot;, onCrash,</span>
<a href="#l56.20"></a><span id="l56.20" class="difflineminus">-                                                 false);</span>
<a href="#l56.21"></a><span id="l56.21" class="difflineplus">+    gBrowser.selectedBrowser.removeEventListener(&quot;PluginCrashed&quot;, onCrash);</span>
<a href="#l56.22"></a><span id="l56.22">     Services.obs.removeObserver(onSubmitStatus, &quot;crash-report-status&quot;);</span>
<a href="#l56.23"></a><span id="l56.23">     gBrowser.removeCurrentTab();</span>
<a href="#l56.24"></a><span id="l56.24">   });</span>
<a href="#l56.25"></a><span id="l56.25"> </span>
<a href="#l56.26"></a><span id="l56.26">   doNextRun();</span>
<a href="#l56.27"></a><span id="l56.27"> }</span>
<a href="#l56.28"></a><span id="l56.28"> </span>
<a href="#l56.29"></a><span id="l56.29"> var runs = [</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/suite/browser/test/browser/browser_pluginnotification.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_pluginnotification.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -13,44 +13,44 @@ Components.utils.import(&quot;resource://gre/</span>
<a href="#l57.4"></a><span id="l57.4"> // This listens for the next opened tab and checks it is of the right url.</span>
<a href="#l57.5"></a><span id="l57.5"> // opencallback is called when the new tab is fully loaded</span>
<a href="#l57.6"></a><span id="l57.6"> // closecallback is called when the tab is closed</span>
<a href="#l57.7"></a><span id="l57.7"> function TabOpenListener(url, opencallback, closecallback) {</span>
<a href="#l57.8"></a><span id="l57.8">   this.url = url;</span>
<a href="#l57.9"></a><span id="l57.9">   this.opencallback = opencallback;</span>
<a href="#l57.10"></a><span id="l57.10">   this.closecallback = closecallback;</span>
<a href="#l57.11"></a><span id="l57.11"> </span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-  gBrowser.tabContainer.addEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+  gBrowser.tabContainer.addEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l57.14"></a><span id="l57.14"> }</span>
<a href="#l57.15"></a><span id="l57.15"> </span>
<a href="#l57.16"></a><span id="l57.16"> TabOpenListener.prototype = {</span>
<a href="#l57.17"></a><span id="l57.17">   url: null,</span>
<a href="#l57.18"></a><span id="l57.18">   opencallback: null,</span>
<a href="#l57.19"></a><span id="l57.19">   closecallback: null,</span>
<a href="#l57.20"></a><span id="l57.20">   tab: null,</span>
<a href="#l57.21"></a><span id="l57.21">   browser: null,</span>
<a href="#l57.22"></a><span id="l57.22"> </span>
<a href="#l57.23"></a><span id="l57.23">   handleEvent: function(event) {</span>
<a href="#l57.24"></a><span id="l57.24">     if (event.type == &quot;TabOpen&quot;) {</span>
<a href="#l57.25"></a><span id="l57.25" class="difflineminus">-      gBrowser.tabContainer.removeEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l57.26"></a><span id="l57.26" class="difflineplus">+      gBrowser.tabContainer.removeEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l57.27"></a><span id="l57.27">       this.tab = event.originalTarget;</span>
<a href="#l57.28"></a><span id="l57.28">       this.browser = this.tab.linkedBrowser;</span>
<a href="#l57.29"></a><span id="l57.29" class="difflineminus">-      gBrowser.addEventListener(&quot;pageshow&quot;, this, false);</span>
<a href="#l57.30"></a><span id="l57.30" class="difflineplus">+      gBrowser.addEventListener(&quot;pageshow&quot;, this);</span>
<a href="#l57.31"></a><span id="l57.31">     } else if (event.type == &quot;pageshow&quot;) {</span>
<a href="#l57.32"></a><span id="l57.32">       if (event.target.location.href != this.url)</span>
<a href="#l57.33"></a><span id="l57.33">         return;</span>
<a href="#l57.34"></a><span id="l57.34" class="difflineminus">-      gBrowser.removeEventListener(&quot;pageshow&quot;, this, false);</span>
<a href="#l57.35"></a><span id="l57.35" class="difflineminus">-      this.tab.addEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l57.36"></a><span id="l57.36" class="difflineplus">+      gBrowser.removeEventListener(&quot;pageshow&quot;, this);</span>
<a href="#l57.37"></a><span id="l57.37" class="difflineplus">+      this.tab.addEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l57.38"></a><span id="l57.38">       var url = this.browser.contentDocument.location.href;</span>
<a href="#l57.39"></a><span id="l57.39">       is(url, this.url, &quot;Should have opened the correct tab&quot;);</span>
<a href="#l57.40"></a><span id="l57.40">       this.opencallback(this.tab, this.browser.contentWindow);</span>
<a href="#l57.41"></a><span id="l57.41">     } else if (event.type == &quot;TabClose&quot;) {</span>
<a href="#l57.42"></a><span id="l57.42">       if (event.originalTarget != this.tab)</span>
<a href="#l57.43"></a><span id="l57.43">         return;</span>
<a href="#l57.44"></a><span id="l57.44" class="difflineminus">-      this.tab.removeEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l57.45"></a><span id="l57.45" class="difflineplus">+      this.tab.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l57.46"></a><span id="l57.46">       this.opencallback = null;</span>
<a href="#l57.47"></a><span id="l57.47">       this.tab = null;</span>
<a href="#l57.48"></a><span id="l57.48">       this.browser = null;</span>
<a href="#l57.49"></a><span id="l57.49">       // Let the window close complete</span>
<a href="#l57.50"></a><span id="l57.50">       executeSoon(this.closecallback);</span>
<a href="#l57.51"></a><span id="l57.51">       this.closecallback = null;</span>
<a href="#l57.52"></a><span id="l57.52">     }</span>
<a href="#l57.53"></a><span id="l57.53">   }</span>
<a href="#l57.54"></a><span id="l57.54" class="difflineat">@@ -640,22 +640,22 @@ function test18a() {</span>
<a href="#l57.55"></a><span id="l57.55">   var overlay = doc.getAnonymousElementByAttribute(plugin, &quot;anonid&quot;, &quot;main&quot;);</span>
<a href="#l57.56"></a><span id="l57.56">   ok(overlay.style.visibility != &quot;hidden&quot;, &quot;Test 18a, Plugin overlay should exist, not be hidden&quot;);</span>
<a href="#l57.57"></a><span id="l57.57">   var updateLink = doc.getAnonymousElementByAttribute(plugin, &quot;anonid&quot;, &quot;checkForUpdatesLink&quot;);</span>
<a href="#l57.58"></a><span id="l57.58">   ok(updateLink.style.visibility != &quot;hidden&quot;, &quot;Test 18a, Plugin should have an update link&quot;);</span>
<a href="#l57.59"></a><span id="l57.59"> </span>
<a href="#l57.60"></a><span id="l57.60">   var tabOpenListener = new TabOpenListener(Services.urlFormatter.formatURLPref(&quot;plugins.update.url&quot;), false, false);</span>
<a href="#l57.61"></a><span id="l57.61">   tabOpenListener.handleEvent = function(event) {</span>
<a href="#l57.62"></a><span id="l57.62">     if (event.type == &quot;TabOpen&quot;) {</span>
<a href="#l57.63"></a><span id="l57.63" class="difflineminus">-      gBrowser.tabContainer.removeEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l57.64"></a><span id="l57.64" class="difflineplus">+      gBrowser.tabContainer.removeEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l57.65"></a><span id="l57.65">       this.tab = event.originalTarget;</span>
<a href="#l57.66"></a><span id="l57.66">       this.browser = this.tab.linkedBrowser;</span>
<a href="#l57.67"></a><span id="l57.67" class="difflineminus">-      gBrowser.addEventListener(&quot;pageshow&quot;, this, false);</span>
<a href="#l57.68"></a><span id="l57.68" class="difflineplus">+      gBrowser.addEventListener(&quot;pageshow&quot;, this);</span>
<a href="#l57.69"></a><span id="l57.69">     } else if (event.type == &quot;pageshow&quot;) {</span>
<a href="#l57.70"></a><span id="l57.70" class="difflineminus">-      gBrowser.removeEventListener(&quot;pageshow&quot;, this, false);</span>
<a href="#l57.71"></a><span id="l57.71" class="difflineplus">+      gBrowser.removeEventListener(&quot;pageshow&quot;, this);</span>
<a href="#l57.72"></a><span id="l57.72">       is(this.browser.contentDocument.location.href, this.url, &quot;Test 18a, Update link should open up the plugin check page&quot;);</span>
<a href="#l57.73"></a><span id="l57.73">       gBrowser.removeTab(this.tab);</span>
<a href="#l57.74"></a><span id="l57.74">       test18b();</span>
<a href="#l57.75"></a><span id="l57.75">     }</span>
<a href="#l57.76"></a><span id="l57.76">   };</span>
<a href="#l57.77"></a><span id="l57.77">   EventUtils.synthesizeMouseAtCenter(updateLink, {}, gTestBrowser.contentWindow);</span>
<a href="#l57.78"></a><span id="l57.78"> }</span>
<a href="#l57.79"></a><span id="l57.79"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/suite/browser/test/browser/browser_popupNotification.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/suite/browser/test/browser/browser_popupNotification.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -12,17 +12,17 @@ function test() {</span>
<a href="#l58.4"></a><span id="l58.4"> </span>
<a href="#l58.5"></a><span id="l58.5">   runNextTest();</span>
<a href="#l58.6"></a><span id="l58.6"> }</span>
<a href="#l58.7"></a><span id="l58.7"> </span>
<a href="#l58.8"></a><span id="l58.8"> function cleanUp() {</span>
<a href="#l58.9"></a><span id="l58.9">   for (var topic in gActiveObservers)</span>
<a href="#l58.10"></a><span id="l58.10">     Services.obs.removeObserver(gActiveObservers[topic], topic);</span>
<a href="#l58.11"></a><span id="l58.11">   for (var eventName in gActiveListeners)</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-    PopupNotifications.panel.removeEventListener(eventName, gActiveListeners[eventName], false);</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineplus">+    PopupNotifications.panel.removeEventListener(eventName, gActiveListeners[eventName]);</span>
<a href="#l58.14"></a><span id="l58.14"> }</span>
<a href="#l58.15"></a><span id="l58.15"> </span>
<a href="#l58.16"></a><span id="l58.16"> var gActiveListeners = {};</span>
<a href="#l58.17"></a><span id="l58.17"> var gActiveObservers = {};</span>
<a href="#l58.18"></a><span id="l58.18"> var gShownState = {};</span>
<a href="#l58.19"></a><span id="l58.19"> </span>
<a href="#l58.20"></a><span id="l58.20"> function runNextTest() {</span>
<a href="#l58.21"></a><span id="l58.21">   let nextTest = tests[gTestIndex];</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineat">@@ -89,23 +89,23 @@ function runNextTest() {</span>
<a href="#l58.23"></a><span id="l58.23"> </span>
<a href="#l58.24"></a><span id="l58.24"> function doOnPopupEvent(eventName, callback, numExpected) {</span>
<a href="#l58.25"></a><span id="l58.25">   gActiveListeners[eventName] = function (event) {</span>
<a href="#l58.26"></a><span id="l58.26">     if (event.target != PopupNotifications.panel)</span>
<a href="#l58.27"></a><span id="l58.27">       return;</span>
<a href="#l58.28"></a><span id="l58.28">     if (typeof(numExpected) === &quot;number&quot;)</span>
<a href="#l58.29"></a><span id="l58.29">       numExpected--;</span>
<a href="#l58.30"></a><span id="l58.30">     if (!numExpected) {</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineminus">-      PopupNotifications.panel.removeEventListener(eventName, gActiveListeners[eventName], false);</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineplus">+      PopupNotifications.panel.removeEventListener(eventName, gActiveListeners[eventName]);</span>
<a href="#l58.33"></a><span id="l58.33">       delete gActiveListeners[eventName];</span>
<a href="#l58.34"></a><span id="l58.34">     }</span>
<a href="#l58.35"></a><span id="l58.35"> </span>
<a href="#l58.36"></a><span id="l58.36">     callback.call(PopupNotifications.panel);</span>
<a href="#l58.37"></a><span id="l58.37">   }</span>
<a href="#l58.38"></a><span id="l58.38" class="difflineminus">-  PopupNotifications.panel.addEventListener(eventName, gActiveListeners[eventName], false);</span>
<a href="#l58.39"></a><span id="l58.39" class="difflineplus">+  PopupNotifications.panel.addEventListener(eventName, gActiveListeners[eventName]);</span>
<a href="#l58.40"></a><span id="l58.40"> }</span>
<a href="#l58.41"></a><span id="l58.41"> </span>
<a href="#l58.42"></a><span id="l58.42"> var gTestIndex = 0;</span>
<a href="#l58.43"></a><span id="l58.43"> var gNewTab;</span>
<a href="#l58.44"></a><span id="l58.44"> </span>
<a href="#l58.45"></a><span id="l58.45"> function basicNotification() {</span>
<a href="#l58.46"></a><span id="l58.46">   var self = this;</span>
<a href="#l58.47"></a><span id="l58.47">   this.browser = gBrowser.selectedBrowser;</span>
<a href="#l58.48"></a><span id="l58.48" class="difflineat">@@ -742,25 +742,25 @@ function triggerSecondaryCommand(popup, </span>
<a href="#l58.49"></a><span id="l58.49">   info(&quot;[Test #&quot; + gTestIndex + &quot;] triggering secondary command&quot;);</span>
<a href="#l58.50"></a><span id="l58.50">   let notifications = popup.childNodes;</span>
<a href="#l58.51"></a><span id="l58.51">   ok(notifications.length &gt; 0, &quot;at least one notification displayed&quot;);</span>
<a href="#l58.52"></a><span id="l58.52">   let notification = notifications[0];</span>
<a href="#l58.53"></a><span id="l58.53"> </span>
<a href="#l58.54"></a><span id="l58.54">   notification.button.focus();</span>
<a href="#l58.55"></a><span id="l58.55"> </span>
<a href="#l58.56"></a><span id="l58.56">   popup.addEventListener(&quot;popupshown&quot;, function triggerPopupShown() {</span>
<a href="#l58.57"></a><span id="l58.57" class="difflineminus">-    popup.removeEventListener(&quot;popupshown&quot;, triggerPopupShown, false);</span>
<a href="#l58.58"></a><span id="l58.58" class="difflineplus">+    popup.removeEventListener(&quot;popupshown&quot;, triggerPopupShown);</span>
<a href="#l58.59"></a><span id="l58.59"> </span>
<a href="#l58.60"></a><span id="l58.60">     // Press down until the desired command is selected</span>
<a href="#l58.61"></a><span id="l58.61">     for (let i = 0; i &lt;= index; i++)</span>
<a href="#l58.62"></a><span id="l58.62">       EventUtils.synthesizeKey(&quot;VK_DOWN&quot;, {});</span>
<a href="#l58.63"></a><span id="l58.63"> </span>
<a href="#l58.64"></a><span id="l58.64">     // Activate</span>
<a href="#l58.65"></a><span id="l58.65">     EventUtils.synthesizeKey(&quot;VK_RETURN&quot;, {});</span>
<a href="#l58.66"></a><span id="l58.66" class="difflineminus">-  }, false);</span>
<a href="#l58.67"></a><span id="l58.67" class="difflineplus">+  });</span>
<a href="#l58.68"></a><span id="l58.68"> </span>
<a href="#l58.69"></a><span id="l58.69">   // One down event to open the popup</span>
<a href="#l58.70"></a><span id="l58.70">   EventUtils.synthesizeKey(&quot;VK_DOWN&quot;, { altKey: (navigator.platform.indexOf(&quot;Mac&quot;) == -1) });</span>
<a href="#l58.71"></a><span id="l58.71"> }</span>
<a href="#l58.72"></a><span id="l58.72"> </span>
<a href="#l58.73"></a><span id="l58.73"> function loadURI(uri, callback) {</span>
<a href="#l58.74"></a><span id="l58.74">   if (callback) {</span>
<a href="#l58.75"></a><span id="l58.75">     gBrowser.addEventListener(&quot;load&quot;, function loadURIgBLoad() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/suite/browser/test/browser/head.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/suite/browser/test/browser/head.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -45,19 +45,19 @@ function waitForCondition(condition, nex</span>
<a href="#l59.4"></a><span id="l59.4"> </span>
<a href="#l59.5"></a><span id="l59.5"> function whenNewWindowLoaded(aOptions, aCallback) {</span>
<a href="#l59.6"></a><span id="l59.6">   var { private } = aOptions;</span>
<a href="#l59.7"></a><span id="l59.7">   var features = private ? &quot;private,chrome,all,dialog=no&quot; :</span>
<a href="#l59.8"></a><span id="l59.8">                            &quot;non-private,chrome,all,dialog=no&quot;;</span>
<a href="#l59.9"></a><span id="l59.9">   var win = window.openDialog(getBrowserURL(), &quot;_blank&quot;, features,</span>
<a href="#l59.10"></a><span id="l59.10">                               &quot;about:blank&quot;);</span>
<a href="#l59.11"></a><span id="l59.11">   win.addEventListener(&quot;load&quot;, function onLoad() {</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-    win.removeEventListener(&quot;load&quot;, onLoad, false);</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+    win.removeEventListener(&quot;load&quot;, onLoad);</span>
<a href="#l59.14"></a><span id="l59.14">     aCallback(win);</span>
<a href="#l59.15"></a><span id="l59.15" class="difflineminus">-  }, false);</span>
<a href="#l59.16"></a><span id="l59.16" class="difflineplus">+  });</span>
<a href="#l59.17"></a><span id="l59.17"> }</span>
<a href="#l59.18"></a><span id="l59.18"> </span>
<a href="#l59.19"></a><span id="l59.19"> function updateBlocklist(aCallback) {</span>
<a href="#l59.20"></a><span id="l59.20">   var blocklistNotifier = Components.classes[&quot;@mozilla.org/extensions/blocklist;1&quot;]</span>
<a href="#l59.21"></a><span id="l59.21">                                     .getService(Components.interfaces.nsITimerCallback);</span>
<a href="#l59.22"></a><span id="l59.22">   var observer = function() {</span>
<a href="#l59.23"></a><span id="l59.23">     Services.obs.removeObserver(observer, &quot;blocklist-updated&quot;);</span>
<a href="#l59.24"></a><span id="l59.24">     SimpleTest.executeSoon(aCallback);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/suite/browser/test/mochitest/test_contextmenu.html</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/suite/browser/test/mochitest/test_contextmenu.html</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -938,40 +938,40 @@ function startTest() {</span>
<a href="#l60.4"></a><span id="l60.4">     contenteditable.focus(); // content editable needs to be focused to enable spellcheck</span>
<a href="#l60.5"></a><span id="l60.5">     inputspell = subwindow.document.getElementById(&quot;test-input-spellcheck&quot;);</span>
<a href="#l60.6"></a><span id="l60.6">     pagemenu = subwindow.document.getElementById(&quot;test-pagemenu&quot;);</span>
<a href="#l60.7"></a><span id="l60.7"> </span>
<a href="#l60.8"></a><span id="l60.8">     // SeaMonkey specific elements.</span>
<a href="#l60.9"></a><span id="l60.9">     img_link   = subwindow.document.getElementById(&quot;test-image-link&quot;);</span>
<a href="#l60.10"></a><span id="l60.10">     img_mailto = subwindow.document.getElementById(&quot;test-image-mailto&quot;);</span>
<a href="#l60.11"></a><span id="l60.11"> </span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-    contextMenu.addEventListener(&quot;popupshown&quot;, function() { runTest(++testNum); }, false);</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineplus">+    contextMenu.addEventListener(&quot;popupshown&quot;, function() { runTest(++testNum); });</span>
<a href="#l60.14"></a><span id="l60.14">     runTest(1);</span>
<a href="#l60.15"></a><span id="l60.15"> }</span>
<a href="#l60.16"></a><span id="l60.16"> </span>
<a href="#l60.17"></a><span id="l60.17"> // We open this in a separate window, because the Mochitests run inside a frame.</span>
<a href="#l60.18"></a><span id="l60.18"> // The frame causes an extra menu item, and prevents running the test</span>
<a href="#l60.19"></a><span id="l60.19"> // standalone (ie, clicking the test name in the Mochitest window) to see</span>
<a href="#l60.20"></a><span id="l60.20"> // success/failure messages.</span>
<a href="#l60.21"></a><span id="l60.21"> var painted = false, loaded = false;</span>
<a href="#l60.22"></a><span id="l60.22"> </span>
<a href="#l60.23"></a><span id="l60.23"> function waitForEvents(event)</span>
<a href="#l60.24"></a><span id="l60.24"> {</span>
<a href="#l60.25"></a><span id="l60.25">   if (event.type == &quot;MozAfterPaint&quot;)</span>
<a href="#l60.26"></a><span id="l60.26">     painted = true;</span>
<a href="#l60.27"></a><span id="l60.27">   else if (event.type == &quot;load&quot;)</span>
<a href="#l60.28"></a><span id="l60.28">     loaded = true;</span>
<a href="#l60.29"></a><span id="l60.29">   if (painted &amp;&amp; loaded) {</span>
<a href="#l60.30"></a><span id="l60.30" class="difflineminus">-    subwindow.removeEventListener(&quot;MozAfterPaint&quot;, waitForEvents, false);</span>
<a href="#l60.31"></a><span id="l60.31" class="difflineplus">+    subwindow.removeEventListener(&quot;MozAfterPaint&quot;, waitForEvents);</span>
<a href="#l60.32"></a><span id="l60.32">     subwindow.onload = null;</span>
<a href="#l60.33"></a><span id="l60.33">     startTest();</span>
<a href="#l60.34"></a><span id="l60.34">   }</span>
<a href="#l60.35"></a><span id="l60.35"> }</span>
<a href="#l60.36"></a><span id="l60.36"> </span>
<a href="#l60.37"></a><span id="l60.37"> var subwindow = window.open(&quot;./subtst_contextmenu.html&quot;, &quot;contextmenu-subtext&quot;, &quot;width=600,height=700&quot;);</span>
<a href="#l60.38"></a><span id="l60.38" class="difflineminus">-subwindow.addEventListener(&quot;MozAfterPaint&quot;, waitForEvents, false);</span>
<a href="#l60.39"></a><span id="l60.39" class="difflineplus">+subwindow.addEventListener(&quot;MozAfterPaint&quot;, waitForEvents);</span>
<a href="#l60.40"></a><span id="l60.40"> subwindow.onload = waitForEvents;</span>
<a href="#l60.41"></a><span id="l60.41"> </span>
<a href="#l60.42"></a><span id="l60.42"> SimpleTest.waitForExplicitFinish();</span>
<a href="#l60.43"></a><span id="l60.43"> &lt;/script&gt;</span>
<a href="#l60.44"></a><span id="l60.44"> &lt;/pre&gt;</span>
<a href="#l60.45"></a><span id="l60.45"> &lt;/body&gt;</span>
<a href="#l60.46"></a><span id="l60.46"> &lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/suite/browser/urlbarBindings.xml</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/suite/browser/urlbarBindings.xml</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -53,23 +53,23 @@</span>
<a href="#l61.4"></a><span id="l61.4">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l61.5"></a><span id="l61.5">         this.mPrefs.addObserver(&quot;browser.urlbar&quot;, this.mPrefObserver, false);</span>
<a href="#l61.6"></a><span id="l61.6"> </span>
<a href="#l61.7"></a><span id="l61.7">         this.updatePref(&quot;browser.urlbar.showPopup&quot;);</span>
<a href="#l61.8"></a><span id="l61.8">         this.updatePref(&quot;browser.urlbar.autoFill&quot;);</span>
<a href="#l61.9"></a><span id="l61.9">         this.updatePref(&quot;browser.urlbar.showSearch&quot;);</span>
<a href="#l61.10"></a><span id="l61.10">         this.updatePref(&quot;browser.urlbar.formatting.enabled&quot;);</span>
<a href="#l61.11"></a><span id="l61.11">         this.inputField.controllers.insertControllerAt(0, this._editItemsController);</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-        this.inputField.addEventListener(&quot;overflow&quot;, this, false);</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineminus">-        this.inputField.addEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l61.14"></a><span id="l61.14" class="difflineplus">+        this.inputField.addEventListener(&quot;overflow&quot;, this);</span>
<a href="#l61.15"></a><span id="l61.15" class="difflineplus">+        this.inputField.addEventListener(&quot;underflow&quot;, this);</span>
<a href="#l61.16"></a><span id="l61.16">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l61.17"></a><span id="l61.17"> </span>
<a href="#l61.18"></a><span id="l61.18">       &lt;destructor&gt;&lt;![CDATA[</span>
<a href="#l61.19"></a><span id="l61.19" class="difflineminus">-        this.inputField.removeEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l61.20"></a><span id="l61.20" class="difflineminus">-        this.inputField.removeEventListener(&quot;overflow&quot;, this, false);</span>
<a href="#l61.21"></a><span id="l61.21" class="difflineplus">+        this.inputField.removeEventListener(&quot;underflow&quot;, this);</span>
<a href="#l61.22"></a><span id="l61.22" class="difflineplus">+        this.inputField.removeEventListener(&quot;overflow&quot;, this);</span>
<a href="#l61.23"></a><span id="l61.23">         this.inputField.controllers.removeController(this._editItemsController);</span>
<a href="#l61.24"></a><span id="l61.24">         this.mPrefs.removeObserver(&quot;browser.urlbar&quot;, this.mPrefObserver);</span>
<a href="#l61.25"></a><span id="l61.25">       ]]&gt;&lt;/destructor&gt;</span>
<a href="#l61.26"></a><span id="l61.26"> </span>
<a href="#l61.27"></a><span id="l61.27">       &lt;field name=&quot;mPrefs&quot;&gt;</span>
<a href="#l61.28"></a><span id="l61.28">         var svc = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l61.29"></a><span id="l61.29">                             .getService(Components.interfaces.nsIPrefService);</span>
<a href="#l61.30"></a><span id="l61.30">         svc.getBranch(null);</span>
<a href="#l61.31"></a><span id="l61.31" class="difflineat">@@ -545,27 +545,27 @@</span>
<a href="#l61.32"></a><span id="l61.32">         // calls updateEngines but doesn't cause the ``Search for ...''</span>
<a href="#l61.33"></a><span id="l61.33">         // display string to be updated</span>
<a href="#l61.34"></a><span id="l61.34">         if ( (!this.mEnginesReady &amp;&amp; this.defaultSearchEngine) ||</span>
<a href="#l61.35"></a><span id="l61.35">              !(&quot;mShowSearch&quot; in this) )</span>
<a href="#l61.36"></a><span id="l61.36">           this.updatePref(&quot;browser.urlbar.showSearch&quot;);</span>
<a href="#l61.37"></a><span id="l61.37"> </span>
<a href="#l61.38"></a><span id="l61.38">         if (this.mShowSearch) {</span>
<a href="#l61.39"></a><span id="l61.39">           this.textbox.mSearchInputTO = 0;</span>
<a href="#l61.40"></a><span id="l61.40" class="difflineminus">-          this.textbox.addEventListener(&quot;input&quot;, this.mInputListener, false);</span>
<a href="#l61.41"></a><span id="l61.41" class="difflineplus">+          this.textbox.addEventListener(&quot;input&quot;, this.mInputListener);</span>
<a href="#l61.42"></a><span id="l61.42">           if (&quot;searchValue&quot; in this.mSearchBox)</span>
<a href="#l61.43"></a><span id="l61.43">             this.mSearchBox.searchValue = this.textbox.currentSearchString;</span>
<a href="#l61.44"></a><span id="l61.44">           else</span>
<a href="#l61.45"></a><span id="l61.45">             this.mSearchBox.setAttribute(&quot;searchvalue&quot;, this.textbox.currentSearchString);</span>
<a href="#l61.46"></a><span id="l61.46">         }</span>
<a href="#l61.47"></a><span id="l61.47">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l61.48"></a><span id="l61.48"> </span>
<a href="#l61.49"></a><span id="l61.49">       &lt;handler event=&quot;popuphiding&quot;&gt;&lt;![CDATA[</span>
<a href="#l61.50"></a><span id="l61.50">         if (this.mShowSearch)</span>
<a href="#l61.51"></a><span id="l61.51" class="difflineminus">-          this.textbox.removeEventListener(&quot;input&quot;, this.mInputListener, false);</span>
<a href="#l61.52"></a><span id="l61.52" class="difflineplus">+          this.textbox.removeEventListener(&quot;input&quot;, this.mInputListener);</span>
<a href="#l61.53"></a><span id="l61.53">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l61.54"></a><span id="l61.54">     &lt;/handlers&gt;</span>
<a href="#l61.55"></a><span id="l61.55">   &lt;/binding&gt;</span>
<a href="#l61.56"></a><span id="l61.56"> </span>
<a href="#l61.57"></a><span id="l61.57">   &lt;binding id=&quot;autocomplete-search-box&quot;&gt;</span>
<a href="#l61.58"></a><span id="l61.58">     &lt;content orient=&quot;vertical&quot;/&gt;</span>
<a href="#l61.59"></a><span id="l61.59"> </span>
<a href="#l61.60"></a><span id="l61.60">     &lt;implementation&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/suite/browser/webDeveloperOverlay.js</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/suite/browser/webDeveloperOverlay.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -82,34 +82,34 @@ var gWebDeveloper = {</span>
<a href="#l62.4"></a><span id="l62.4">   enableDebugger: function(aItem) {</span>
<a href="#l62.5"></a><span id="l62.5">     var shouldEnable = aItem.getAttribute(&quot;checked&quot;) == &quot;true&quot;;</span>
<a href="#l62.6"></a><span id="l62.6">     Services.prefs.setBoolPref(&quot;devtools.debugger.remote-enabled&quot;, shouldEnable);</span>
<a href="#l62.7"></a><span id="l62.7">   },</span>
<a href="#l62.8"></a><span id="l62.8"> </span>
<a href="#l62.9"></a><span id="l62.9">   handleEvent: function(aEvent) {</span>
<a href="#l62.10"></a><span id="l62.10">     switch (aEvent.type) {</span>
<a href="#l62.11"></a><span id="l62.11">       case &quot;load&quot;:</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-        window.removeEventListener(&quot;load&quot;, gWebDeveloper, false);</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineminus">-        window.addEventListener(&quot;unload&quot;, gWebDeveloper, false);</span>
<a href="#l62.14"></a><span id="l62.14" class="difflineplus">+        window.removeEventListener(&quot;load&quot;, gWebDeveloper);</span>
<a href="#l62.15"></a><span id="l62.15" class="difflineplus">+        window.addEventListener(&quot;unload&quot;, gWebDeveloper);</span>
<a href="#l62.16"></a><span id="l62.16">         var popup = document.getElementById(&quot;toolsPopup&quot;);</span>
<a href="#l62.17"></a><span id="l62.17" class="difflineminus">-        popup.addEventListener(&quot;popupshowing&quot;, gWebDeveloper, false);</span>
<a href="#l62.18"></a><span id="l62.18" class="difflineplus">+        popup.addEventListener(&quot;popupshowing&quot;, gWebDeveloper);</span>
<a href="#l62.19"></a><span id="l62.19">         // Don't use gDevToolsBrowser.updateCommandAvailability() at the moment</span>
<a href="#l62.20"></a><span id="l62.20">         // because some tools aren't working.</span>
<a href="#l62.21"></a><span id="l62.21">         if (!gDevToolsBrowser._old_updateCommandAvailability) {</span>
<a href="#l62.22"></a><span id="l62.22">           gDevToolsBrowser._old_updateCommandAvailability = gDevToolsBrowser.updateCommandAvailability;</span>
<a href="#l62.23"></a><span id="l62.23">           gDevToolsBrowser.updateCommandAvailability = this.updateCommandAvailability;</span>
<a href="#l62.24"></a><span id="l62.24">         }</span>
<a href="#l62.25"></a><span id="l62.25">         // Add Devtools menuitems, observers, and listeners</span>
<a href="#l62.26"></a><span id="l62.26">         gDevToolsBrowser.registerBrowserWindow(window);</span>
<a href="#l62.27"></a><span id="l62.27">         Services.prefs.addObserver(this.devtoolsThemePref, this, false);</span>
<a href="#l62.28"></a><span id="l62.28">         this.updateDevtoolsThemeAttribute();</span>
<a href="#l62.29"></a><span id="l62.29">         break;</span>
<a href="#l62.30"></a><span id="l62.30"> </span>
<a href="#l62.31"></a><span id="l62.31">       case &quot;unload&quot;:</span>
<a href="#l62.32"></a><span id="l62.32" class="difflineminus">-        window.removeEventListener(&quot;unload&quot;, gWebDeveloper, false);</span>
<a href="#l62.33"></a><span id="l62.33" class="difflineplus">+        window.removeEventListener(&quot;unload&quot;, gWebDeveloper);</span>
<a href="#l62.34"></a><span id="l62.34">         gDevToolsBrowser.forgetBrowserWindow(window);</span>
<a href="#l62.35"></a><span id="l62.35">         Services.prefs.removeObserver(this.devtoolsThemePref, this);</span>
<a href="#l62.36"></a><span id="l62.36"> </span>
<a href="#l62.37"></a><span id="l62.37">         var desc = Object.getOwnPropertyDescriptor(window, &quot;DeveloperToolbar&quot;);</span>
<a href="#l62.38"></a><span id="l62.38">         if (desc &amp;&amp; !desc.get)</span>
<a href="#l62.39"></a><span id="l62.39">           DeveloperToolbar.destroy();</span>
<a href="#l62.40"></a><span id="l62.40">         break;</span>
<a href="#l62.41"></a><span id="l62.41"> </span>
<a href="#l62.42"></a><span id="l62.42" class="difflineat">@@ -201,9 +201,9 @@ var gWebDeveloper = {</span>
<a href="#l62.43"></a><span id="l62.43">     //toggleCmd(&quot;Tools:BrowserContentToolbox&quot;, remoteEnabled &amp;&amp; win.gMultiProcessBrowser);</span>
<a href="#l62.44"></a><span id="l62.44">     toggleCmd(&quot;Tools:BrowserContentToolbox&quot;, false);</span>
<a href="#l62.45"></a><span id="l62.45"> </span>
<a href="#l62.46"></a><span id="l62.46">     // Enable DevTools connection screen, if the preference allows this.</span>
<a href="#l62.47"></a><span id="l62.47">     toggleCmd(&quot;Tools:DevToolsConnect&quot;, devtoolsRemoteEnabled);</span>
<a href="#l62.48"></a><span id="l62.48">   },</span>
<a href="#l62.49"></a><span id="l62.49"> }</span>
<a href="#l62.50"></a><span id="l62.50"> </span>
<a href="#l62.51"></a><span id="l62.51" class="difflineminus">-window.addEventListener(&quot;load&quot;, gWebDeveloper, false);</span>
<a href="#l62.52"></a><span id="l62.52" class="difflineplus">+window.addEventListener(&quot;load&quot;, gWebDeveloper);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/suite/common/bindings/notification.xml</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/suite/common/bindings/notification.xml</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -868,32 +868,30 @@</span>
<a href="#l63.4"></a><span id="l63.4">                                           return;</span>
<a href="#l63.5"></a><span id="l63.5">                                         if (aEvent.button != 0)</span>
<a href="#l63.6"></a><span id="l63.6">                                           return;</span>
<a href="#l63.7"></a><span id="l63.7">                                         aEvent.preventDefault();</span>
<a href="#l63.8"></a><span id="l63.8">                                         aEvent.stopPropagation();</span>
<a href="#l63.9"></a><span id="l63.9">                                         if (callbackArgs.length == 0)</span>
<a href="#l63.10"></a><span id="l63.10">                                           callbackArgs = [ aEvent ];</span>
<a href="#l63.11"></a><span id="l63.11">                                         callback.apply(this, callbackArgs);</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-                                      }.bind(this),</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineminus">-                                      false);</span>
<a href="#l63.14"></a><span id="l63.14" class="difflineplus">+                                      }.bind(this));</span>
<a href="#l63.15"></a><span id="l63.15"> </span>
<a href="#l63.16"></a><span id="l63.16">             linkNode.addEventListener(&quot;keydown&quot;,</span>
<a href="#l63.17"></a><span id="l63.17">                                       function(aEvent) {</span>
<a href="#l63.18"></a><span id="l63.18">                                         if (!aEvent.isTrusted)</span>
<a href="#l63.19"></a><span id="l63.19">                                           return;</span>
<a href="#l63.20"></a><span id="l63.20">                                         if (aEvent.keyCode != aEvent.DOM_VK_RETURN)</span>
<a href="#l63.21"></a><span id="l63.21">                                           return;</span>
<a href="#l63.22"></a><span id="l63.22">                                         aEvent.preventDefault();</span>
<a href="#l63.23"></a><span id="l63.23">                                         aEvent.stopPropagation();</span>
<a href="#l63.24"></a><span id="l63.24">                                         if (callbackArgs.length == 0)</span>
<a href="#l63.25"></a><span id="l63.25">                                           callbackArgs = [ aEvent ];</span>
<a href="#l63.26"></a><span id="l63.26">                                         callback.apply(this, callbackArgs);</span>
<a href="#l63.27"></a><span id="l63.27" class="difflineminus">-                                      }.bind(this),</span>
<a href="#l63.28"></a><span id="l63.28" class="difflineminus">-                                      false);</span>
<a href="#l63.29"></a><span id="l63.29" class="difflineplus">+                                      }.bind(this));</span>
<a href="#l63.30"></a><span id="l63.30">           ]]&gt;</span>
<a href="#l63.31"></a><span id="l63.31">         &lt;/body&gt;</span>
<a href="#l63.32"></a><span id="l63.32">       &lt;/method&gt;</span>
<a href="#l63.33"></a><span id="l63.33"> </span>
<a href="#l63.34"></a><span id="l63.34">       &lt;!-- Callback for user clicking &quot;submit a report&quot; link --&gt;</span>
<a href="#l63.35"></a><span id="l63.35">       &lt;method name=&quot;submitReport&quot;&gt;</span>
<a href="#l63.36"></a><span id="l63.36">         &lt;parameter name=&quot;pluginDumpID&quot;/&gt;</span>
<a href="#l63.37"></a><span id="l63.37">         &lt;parameter name=&quot;browserDumpID&quot;/&gt;</span>
<a href="#l63.38"></a><span id="l63.38" class="difflineat">@@ -2337,17 +2335,17 @@</span>
<a href="#l63.39"></a><span id="l63.39">               Components.classes[&quot;@mozilla.org/observer-service;1&quot;]</span>
<a href="#l63.40"></a><span id="l63.40">                         .getService(Components.interfaces.nsIObserverService)</span>
<a href="#l63.41"></a><span id="l63.41">                         .addObserver(observer, &quot;crash-report-status&quot;, true);</span>
<a href="#l63.42"></a><span id="l63.42">               // ...alas, now we need something to hold a strong reference to prevent</span>
<a href="#l63.43"></a><span id="l63.43">               // it from being GC. But I don't want to manually manage the reference's</span>
<a href="#l63.44"></a><span id="l63.44">               // lifetime (which should be no greater than the page).</span>
<a href="#l63.45"></a><span id="l63.45">               // Clever solution? Use a closure with an event listener on the statusDiv.</span>
<a href="#l63.46"></a><span id="l63.46">               // When it goes away, so do the listener references and the closure.</span>
<a href="#l63.47"></a><span id="l63.47" class="difflineminus">-              statusDiv.addEventListener(&quot;mozCleverClosureHack&quot;, observer, false);</span>
<a href="#l63.48"></a><span id="l63.48" class="difflineplus">+              statusDiv.addEventListener(&quot;mozCleverClosureHack&quot;, observer);</span>
<a href="#l63.49"></a><span id="l63.49">             }</span>
<a href="#l63.50"></a><span id="l63.50">           }</span>
<a href="#l63.51"></a><span id="l63.51"> </span>
<a href="#l63.52"></a><span id="l63.52">           // If we don't have a minidumpID, we can't (or didn't) submit anything.</span>
<a href="#l63.53"></a><span id="l63.53">           // This can happen if the plugin is killed from the task manager.</span>
<a href="#l63.54"></a><span id="l63.54">           if (!pluginDumpID) {</span>
<a href="#l63.55"></a><span id="l63.55">             status = &quot;noReport&quot;;</span>
<a href="#l63.56"></a><span id="l63.56">           }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/suite/common/bookmarks/bm-props.js</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/suite/common/bookmarks/bm-props.js</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -350,27 +350,27 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l64.4"></a><span id="l64.4">           acceptButton.disabled = !this._inputIsValid();</span>
<a href="#l64.5"></a><span id="l64.5">         break;</span>
<a href="#l64.6"></a><span id="l64.6">     }</span>
<a href="#l64.7"></a><span id="l64.7"> </span>
<a href="#l64.8"></a><span id="l64.8">     if (!this._readOnly) {</span>
<a href="#l64.9"></a><span id="l64.9">       // Listen on uri fields to enable accept button if input is valid</span>
<a href="#l64.10"></a><span id="l64.10">       if (this._itemType == BOOKMARK_ITEM) {</span>
<a href="#l64.11"></a><span id="l64.11">         this._element(&quot;locationField&quot;)</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-            .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineplus">+            .addEventListener(&quot;input&quot;, this);</span>
<a href="#l64.14"></a><span id="l64.14">         if (this._isAddKeywordDialog) {</span>
<a href="#l64.15"></a><span id="l64.15">           this._element(&quot;keywordField&quot;)</span>
<a href="#l64.16"></a><span id="l64.16" class="difflineminus">-              .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.17"></a><span id="l64.17" class="difflineplus">+              .addEventListener(&quot;input&quot;, this);</span>
<a href="#l64.18"></a><span id="l64.18">         }</span>
<a href="#l64.19"></a><span id="l64.19">       }</span>
<a href="#l64.20"></a><span id="l64.20">       else if (this._itemType == LIVEMARK_CONTAINER) {</span>
<a href="#l64.21"></a><span id="l64.21">         this._element(&quot;feedLocationField&quot;)</span>
<a href="#l64.22"></a><span id="l64.22" class="difflineminus">-            .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.23"></a><span id="l64.23" class="difflineplus">+            .addEventListener(&quot;input&quot;, this);</span>
<a href="#l64.24"></a><span id="l64.24">         this._element(&quot;siteLocationField&quot;)</span>
<a href="#l64.25"></a><span id="l64.25" class="difflineminus">-            .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.26"></a><span id="l64.26" class="difflineplus">+            .addEventListener(&quot;input&quot;, this);</span>
<a href="#l64.27"></a><span id="l64.27">       }</span>
<a href="#l64.28"></a><span id="l64.28">     }</span>
<a href="#l64.29"></a><span id="l64.29">   },</span>
<a href="#l64.30"></a><span id="l64.30"> </span>
<a href="#l64.31"></a><span id="l64.31">   // nsIDOMEventListener</span>
<a href="#l64.32"></a><span id="l64.32">   handleEvent: function BPP_handleEvent(aEvent) {</span>
<a href="#l64.33"></a><span id="l64.33">     var target = aEvent.target;</span>
<a href="#l64.34"></a><span id="l64.34">     switch (aEvent.type) {</span>
<a href="#l64.35"></a><span id="l64.35" class="difflineat">@@ -443,25 +443,25 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l64.36"></a><span id="l64.36">   },</span>
<a href="#l64.37"></a><span id="l64.37"> </span>
<a href="#l64.38"></a><span id="l64.38">   onDialogUnload: function BPP_onDialogUnload() {</span>
<a href="#l64.39"></a><span id="l64.39"> </span>
<a href="#l64.40"></a><span id="l64.40">   // gEditItemOverlay does not exist anymore here, so don't rely on it.</span>
<a href="#l64.41"></a><span id="l64.41">     this._mutationObserver.disconnect();</span>
<a href="#l64.42"></a><span id="l64.42">     delete this._mutationObserver;</span>
<a href="#l64.43"></a><span id="l64.43"> </span>
<a href="#l64.44"></a><span id="l64.44" class="difflineminus">-    window.removeEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l64.45"></a><span id="l64.45" class="difflineplus">+    window.removeEventListener(&quot;resize&quot;, this);</span>
<a href="#l64.46"></a><span id="l64.46">     // Calling removeEventListener with arguments which do not identify any</span>
<a href="#l64.47"></a><span id="l64.47">     // currently registered EventListener on the EventTarget has no effect.</span>
<a href="#l64.48"></a><span id="l64.48">     this._element(&quot;locationField&quot;)</span>
<a href="#l64.49"></a><span id="l64.49" class="difflineminus">-        .removeEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.50"></a><span id="l64.50" class="difflineplus">+        .removeEventListener(&quot;input&quot;, this);</span>
<a href="#l64.51"></a><span id="l64.51">     this._element(&quot;feedLocationField&quot;)</span>
<a href="#l64.52"></a><span id="l64.52" class="difflineminus">-        .removeEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.53"></a><span id="l64.53" class="difflineplus">+        .removeEventListener(&quot;input&quot;, this);</span>
<a href="#l64.54"></a><span id="l64.54">     this._element(&quot;siteLocationField&quot;)</span>
<a href="#l64.55"></a><span id="l64.55" class="difflineminus">-        .removeEventListener(&quot;input&quot;, this, false);</span>
<a href="#l64.56"></a><span id="l64.56" class="difflineplus">+        .removeEventListener(&quot;input&quot;, this);</span>
<a href="#l64.57"></a><span id="l64.57"> </span>
<a href="#l64.58"></a><span id="l64.58">   },</span>
<a href="#l64.59"></a><span id="l64.59"> </span>
<a href="#l64.60"></a><span id="l64.60">   onDialogAccept: function BPP_onDialogAccept() {</span>
<a href="#l64.61"></a><span id="l64.61">     // We must blur current focused element to save its changes correctly</span>
<a href="#l64.62"></a><span id="l64.62">     document.commandDispatcher.focusedElement.blur();</span>
<a href="#l64.63"></a><span id="l64.63">     // The order here is important! We have to uninit the panel first, otherwise</span>
<a href="#l64.64"></a><span id="l64.64">     // late changes could force it to commit more transactions.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/suite/common/bookmarks/browser-places.js</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/suite/common/bookmarks/browser-places.js</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -13,18 +13,18 @@ var StarUI = {</span>
<a href="#l65.4"></a><span id="l65.4"> </span>
<a href="#l65.5"></a><span id="l65.5">   // Edit-bookmark panel</span>
<a href="#l65.6"></a><span id="l65.6">   get panel() {</span>
<a href="#l65.7"></a><span id="l65.7">     delete this.panel;</span>
<a href="#l65.8"></a><span id="l65.8">     var element = this._element(&quot;editBookmarkPanel&quot;);</span>
<a href="#l65.9"></a><span id="l65.9">     // initially the panel is hidden</span>
<a href="#l65.10"></a><span id="l65.10">     // to avoid impacting startup / new window performance</span>
<a href="#l65.11"></a><span id="l65.11">     element.hidden = false;</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-    element.addEventListener(&quot;popuphidden&quot;, this, false);</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineminus">-    element.addEventListener(&quot;keypress&quot;, this, false);</span>
<a href="#l65.14"></a><span id="l65.14" class="difflineplus">+    element.addEventListener(&quot;popuphidden&quot;, this);</span>
<a href="#l65.15"></a><span id="l65.15" class="difflineplus">+    element.addEventListener(&quot;keypress&quot;, this);</span>
<a href="#l65.16"></a><span id="l65.16">     return this.panel = element;</span>
<a href="#l65.17"></a><span id="l65.17">   },</span>
<a href="#l65.18"></a><span id="l65.18"> </span>
<a href="#l65.19"></a><span id="l65.19">   // Array of command elements to disable when the panel is opened.</span>
<a href="#l65.20"></a><span id="l65.20">   get _blockedCommands() {</span>
<a href="#l65.21"></a><span id="l65.21">     delete this._blockedCommands;</span>
<a href="#l65.22"></a><span id="l65.22">     return this._blockedCommands =</span>
<a href="#l65.23"></a><span id="l65.23">       [&quot;cmd_close&quot;, &quot;cmd_closeWindow&quot;].map(id =&gt; this._element(id));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/suite/common/bookmarks/editBookmarkOverlay.js</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/suite/common/bookmarks/editBookmarkOverlay.js</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -202,17 +202,17 @@ var gEditItemOverlay = {</span>
<a href="#l66.4"></a><span id="l66.4">     this._showHideRows();</span>
<a href="#l66.5"></a><span id="l66.5"> </span>
<a href="#l66.6"></a><span id="l66.6">     // observe changes</span>
<a href="#l66.7"></a><span id="l66.7">     if (!this._observersAdded) {</span>
<a href="#l66.8"></a><span id="l66.8">       // Single bookmarks observe any change.  History entries and multiEdit</span>
<a href="#l66.9"></a><span id="l66.9">       // observe only tags changes, through bookmarks.</span>
<a href="#l66.10"></a><span id="l66.10">       if (this._itemId != -1 || this._uri || this._multiEdit)</span>
<a href="#l66.11"></a><span id="l66.11">         PlacesUtils.bookmarks.addObserver(this, false);</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-      window.addEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+      window.addEventListener(&quot;unload&quot;, this);</span>
<a href="#l66.14"></a><span id="l66.14">       this._observersAdded = true;</span>
<a href="#l66.15"></a><span id="l66.15">     }</span>
<a href="#l66.16"></a><span id="l66.16"> </span>
<a href="#l66.17"></a><span id="l66.17">     this._initialized = true;</span>
<a href="#l66.18"></a><span id="l66.18">   },</span>
<a href="#l66.19"></a><span id="l66.19"> </span>
<a href="#l66.20"></a><span id="l66.20">   /**</span>
<a href="#l66.21"></a><span id="l66.21">    * Finds tags that are in common among this._tags entries that track tags</span>
<a href="#l66.22"></a><span id="l66.22" class="difflineat">@@ -774,17 +774,17 @@ var gEditItemOverlay = {</span>
<a href="#l66.23"></a><span id="l66.23">     if (tagsSelectorRow.collapsed) {</span>
<a href="#l66.24"></a><span id="l66.24">       expander.className = &quot;expander-up&quot;;</span>
<a href="#l66.25"></a><span id="l66.25">       expander.setAttribute(&quot;tooltiptext&quot;,</span>
<a href="#l66.26"></a><span id="l66.26">                             expander.getAttribute(&quot;tooltiptextup&quot;));</span>
<a href="#l66.27"></a><span id="l66.27">       tagsSelectorRow.collapsed = false;</span>
<a href="#l66.28"></a><span id="l66.28">       this._rebuildTagsSelectorList();</span>
<a href="#l66.29"></a><span id="l66.29"> </span>
<a href="#l66.30"></a><span id="l66.30">       // This is a no-op if we've added the listener.</span>
<a href="#l66.31"></a><span id="l66.31" class="difflineminus">-      tagsSelector.addEventListener(&quot;CheckboxStateChange&quot;, this, false);</span>
<a href="#l66.32"></a><span id="l66.32" class="difflineplus">+      tagsSelector.addEventListener(&quot;CheckboxStateChange&quot;, this);</span>
<a href="#l66.33"></a><span id="l66.33">     }</span>
<a href="#l66.34"></a><span id="l66.34">     else {</span>
<a href="#l66.35"></a><span id="l66.35">       expander.className = &quot;expander-down&quot;;</span>
<a href="#l66.36"></a><span id="l66.36">       expander.setAttribute(&quot;tooltiptext&quot;,</span>
<a href="#l66.37"></a><span id="l66.37">                             expander.getAttribute(&quot;tooltiptextdown&quot;));</span>
<a href="#l66.38"></a><span id="l66.38">       tagsSelectorRow.collapsed = true;</span>
<a href="#l66.39"></a><span id="l66.39">     }</span>
<a href="#l66.40"></a><span id="l66.40">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/suite/common/dataman/tests/browser_dataman_basics.js</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/suite/common/dataman/tests/browser_dataman_basics.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -785,25 +785,25 @@ function test_storage_load(aWin) {</span>
<a href="#l67.4"></a><span id="l67.4">   let rootDir = getRootDirectory(gTestPath).replace(&quot;chrome://mochitests/content/&quot;, &quot;http://mochi.test:8888/&quot;);</span>
<a href="#l67.5"></a><span id="l67.5">   let testURL = rootDir + &quot;dataman_storage.html&quot;;</span>
<a href="#l67.6"></a><span id="l67.6">   let storagetab = gBrowser.addTab(testURL);</span>
<a href="#l67.7"></a><span id="l67.7">   let stWin = storagetab.linkedBrowser.contentWindow.wrappedJSObject;</span>
<a href="#l67.8"></a><span id="l67.8">   let dmStorageListener = {</span>
<a href="#l67.9"></a><span id="l67.9">     handleEvent: function dmStorageHandler(aEvent) {</span>
<a href="#l67.10"></a><span id="l67.10">       let tab = aEvent.target;</span>
<a href="#l67.11"></a><span id="l67.11">       if (tab == storagetab) {</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-        gBrowser.tabContainer.removeEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineplus">+        gBrowser.tabContainer.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l67.14"></a><span id="l67.14">         // Force DOM Storage to write its data to the disk.</span>
<a href="#l67.15"></a><span id="l67.15">         Services.obs.notifyObservers(null, &quot;domstorage-flush-timer&quot;, &quot;&quot;);</span>
<a href="#l67.16"></a><span id="l67.16">         Services.perms.remove(&quot;mochi.test&quot;, &quot;offline-app&quot;);</span>
<a href="#l67.17"></a><span id="l67.17">         Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l67.18"></a><span id="l67.18">       }</span>
<a href="#l67.19"></a><span id="l67.19">     },</span>
<a href="#l67.20"></a><span id="l67.20">   };</span>
<a href="#l67.21"></a><span id="l67.21" class="difflineminus">-  gBrowser.tabContainer.addEventListener(&quot;TabClose&quot;, dmStorageListener, false);</span>
<a href="#l67.22"></a><span id="l67.22" class="difflineplus">+  gBrowser.tabContainer.addEventListener(&quot;TabClose&quot;, dmStorageListener);</span>
<a href="#l67.23"></a><span id="l67.23"> },</span>
<a href="#l67.24"></a><span id="l67.24"> </span>
<a href="#l67.25"></a><span id="l67.25"> function test_storage_wait(aWin) {</span>
<a href="#l67.26"></a><span id="l67.26">   // Wait to make sure that DOM Storage flushing has actually worked.</span>
<a href="#l67.27"></a><span id="l67.27">   setTimeout(function foo() {</span>
<a href="#l67.28"></a><span id="l67.28">       Services.obs.notifyObservers(window, TEST_DONE, null); }, 1000);</span>
<a href="#l67.29"></a><span id="l67.29"> },</span>
<a href="#l67.30"></a><span id="l67.30"> </span>
<a href="#l67.31"></a><span id="l67.31" class="difflineat">@@ -838,17 +838,17 @@ function test_storage(aWin) {</span>
<a href="#l67.32"></a><span id="l67.32">   isnot(aWin.gTabs.activePanel, &quot;storagePanel&quot;,</span>
<a href="#l67.33"></a><span id="l67.33">     &quot;Storage panel is not selected any more&quot;);</span>
<a href="#l67.34"></a><span id="l67.34"> </span>
<a href="#l67.35"></a><span id="l67.35">   Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l67.36"></a><span id="l67.36"> },</span>
<a href="#l67.37"></a><span id="l67.37"> </span>
<a href="#l67.38"></a><span id="l67.38"> function test_close(aWin) {</span>
<a href="#l67.39"></a><span id="l67.39">   function dmWindowClosedListener() {</span>
<a href="#l67.40"></a><span id="l67.40" class="difflineminus">-    aWin.removeEventListener(&quot;unload&quot;, dmWindowClosedListener, false);</span>
<a href="#l67.41"></a><span id="l67.41" class="difflineplus">+    aWin.removeEventListener(&quot;unload&quot;, dmWindowClosedListener);</span>
<a href="#l67.42"></a><span id="l67.42">     isnot(content.document.documentElement.id, &quot;dataman-page&quot;,</span>
<a href="#l67.43"></a><span id="l67.43">        &quot;The active tab is not the Data Manager&quot;);</span>
<a href="#l67.44"></a><span id="l67.44">     Services.obs.notifyObservers(window, TEST_DONE, null);</span>
<a href="#l67.45"></a><span id="l67.45">   }</span>
<a href="#l67.46"></a><span id="l67.46" class="difflineminus">-  aWin.addEventListener(&quot;unload&quot;, dmWindowClosedListener, false);</span>
<a href="#l67.47"></a><span id="l67.47" class="difflineplus">+  aWin.addEventListener(&quot;unload&quot;, dmWindowClosedListener);</span>
<a href="#l67.48"></a><span id="l67.48">   aWin.close();</span>
<a href="#l67.49"></a><span id="l67.49"> }</span>
<a href="#l67.50"></a><span id="l67.50"> ];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/suite/common/dataman/tests/dataman_storage.html</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/suite/common/dataman/tests/dataman_storage.html</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -10,18 +10,18 @@ function eventSeen(e){</span>
<a href="#l68.4"></a><span id="l68.4">     setTimeout(close, 1000);</span>
<a href="#l68.5"></a><span id="l68.5"> }</span>
<a href="#l68.6"></a><span id="l68.6"> &lt;/script&gt;</span>
<a href="#l68.7"></a><span id="l68.7"> &lt;/head&gt;</span>
<a href="#l68.8"></a><span id="l68.8"> &lt;body&gt;</span>
<a href="#l68.9"></a><span id="l68.9"> &lt;h1&gt;Test&lt;/h1&gt;</span>
<a href="#l68.10"></a><span id="l68.10"> &lt;p id=&quot;eventCnt&quot;&gt;*&lt;/p&gt;</span>
<a href="#l68.11"></a><span id="l68.11"> &lt;script&gt;</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-document.body.addEventListener('storage', eventSeen, false);</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineminus">-document.addEventListener('idb-done', eventSeen, false);</span>
<a href="#l68.14"></a><span id="l68.14" class="difflineplus">+document.body.addEventListener('storage', eventSeen);</span>
<a href="#l68.15"></a><span id="l68.15" class="difflineplus">+document.addEventListener('idb-done', eventSeen);</span>
<a href="#l68.16"></a><span id="l68.16"> </span>
<a href="#l68.17"></a><span id="l68.17"> localStorage.setItem(&quot;localtest&quot;, &quot;foo&quot;); // issues no storage event (!?)</span>
<a href="#l68.18"></a><span id="l68.18"> globalStorage['mochi.test'].setItem(&quot;globaltest&quot;, &quot;bar&quot;); // issues a storage event</span>
<a href="#l68.19"></a><span id="l68.19"> </span>
<a href="#l68.20"></a><span id="l68.20"> var request = mozIndexedDB.open(&quot;test&quot;, &quot;test-decription&quot;);</span>
<a href="#l68.21"></a><span id="l68.21"> request.onsuccess = function(e) {</span>
<a href="#l68.22"></a><span id="l68.22">   var db = e.target.result;</span>
<a href="#l68.23"></a><span id="l68.23">   var setVrequest = db.setVersion(&quot;1.0&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/suite/common/downloads/tests/browser/browser_nsISuiteDownloadManagerUI.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -11,22 +11,22 @@ function test_visibility_open()</span>
<a href="#l69.4"></a><span id="l69.4"> }</span>
<a href="#l69.5"></a><span id="l69.5"> </span>
<a href="#l69.6"></a><span id="l69.6"> function test_visibility_closed(aWin)</span>
<a href="#l69.7"></a><span id="l69.7"> {</span>
<a href="#l69.8"></a><span id="l69.8">   var dmui = Components.classes[&quot;@mozilla.org/download-manager-ui;1&quot;]</span>
<a href="#l69.9"></a><span id="l69.9">                        .getService(Components.interfaces.nsISuiteDownloadManagerUI);</span>
<a href="#l69.10"></a><span id="l69.10"> </span>
<a href="#l69.11"></a><span id="l69.11">   function dmWindowClosedListener() {</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-    aWin.removeEventListener(&quot;unload&quot;, dmWindowClosedListener, false);</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+    aWin.removeEventListener(&quot;unload&quot;, dmWindowClosedListener);</span>
<a href="#l69.14"></a><span id="l69.14">     is(dmui.recentWindow, null,</span>
<a href="#l69.15"></a><span id="l69.15">        &quot;nsIDownloadManagerUI indicates that the UI is not visible&quot;);</span>
<a href="#l69.16"></a><span id="l69.16">     finish();</span>
<a href="#l69.17"></a><span id="l69.17">   }</span>
<a href="#l69.18"></a><span id="l69.18" class="difflineminus">-  aWin.addEventListener(&quot;unload&quot;, dmWindowClosedListener, false);</span>
<a href="#l69.19"></a><span id="l69.19" class="difflineplus">+  aWin.addEventListener(&quot;unload&quot;, dmWindowClosedListener);</span>
<a href="#l69.20"></a><span id="l69.20">   aWin.close();</span>
<a href="#l69.21"></a><span id="l69.21"> }</span>
<a href="#l69.22"></a><span id="l69.22"> </span>
<a href="#l69.23"></a><span id="l69.23"> var testFuncs = [</span>
<a href="#l69.24"></a><span id="l69.24">     test_visibility_open</span>
<a href="#l69.25"></a><span id="l69.25">   , test_visibility_closed /* all tests after this *must* expect there to be</span>
<a href="#l69.26"></a><span id="l69.26">                               no open window, otherwise they will fail! */</span>
<a href="#l69.27"></a><span id="l69.27"> ];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/suite/common/fullscreen-video.xhtml</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/suite/common/fullscreen-video.xhtml</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -17,57 +17,57 @@ var video;</span>
<a href="#l70.4"></a><span id="l70.4"> var closeIcon;</span>
<a href="#l70.5"></a><span id="l70.5"> </span>
<a href="#l70.6"></a><span id="l70.6"> var title = (contentVideo.currentSrc || contentVideo.src).replace(/^.*\//, &quot;&quot;);</span>
<a href="#l70.7"></a><span id="l70.7"> try {</span>
<a href="#l70.8"></a><span id="l70.8">   title = decodeURI(title);</span>
<a href="#l70.9"></a><span id="l70.9"> } catch (e) {}</span>
<a href="#l70.10"></a><span id="l70.10"> document.title = title;</span>
<a href="#l70.11"></a><span id="l70.11"> </span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-window.addEventListener(&quot;focus&quot;, onFocus, false);</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineminus">-window.addEventListener(&quot;unload&quot;, onUnload, false);</span>
<a href="#l70.14"></a><span id="l70.14" class="difflineminus">-window.addEventListener(&quot;keypress&quot;, onKeyPress, false);</span>
<a href="#l70.15"></a><span id="l70.15" class="difflineplus">+window.addEventListener(&quot;focus&quot;, onFocus);</span>
<a href="#l70.16"></a><span id="l70.16" class="difflineplus">+window.addEventListener(&quot;unload&quot;, onUnload);</span>
<a href="#l70.17"></a><span id="l70.17" class="difflineplus">+window.addEventListener(&quot;keypress&quot;, onKeyPress);</span>
<a href="#l70.18"></a><span id="l70.18"> </span>
<a href="#l70.19"></a><span id="l70.19"> function onFocus() {</span>
<a href="#l70.20"></a><span id="l70.20" class="difflineminus">-  window.removeEventListener(&quot;focus&quot;, onFocus, false);</span>
<a href="#l70.21"></a><span id="l70.21" class="difflineplus">+  window.removeEventListener(&quot;focus&quot;, onFocus);</span>
<a href="#l70.22"></a><span id="l70.22"> </span>
<a href="#l70.23"></a><span id="l70.23">   window.fullScreen = true;</span>
<a href="#l70.24"></a><span id="l70.24"> </span>
<a href="#l70.25"></a><span id="l70.25" class="difflineminus">-  window.addEventListener(&quot;deactivate&quot;, autoClose, false);</span>
<a href="#l70.26"></a><span id="l70.26" class="difflineplus">+  window.addEventListener(&quot;deactivate&quot;, autoClose);</span>
<a href="#l70.27"></a><span id="l70.27"> </span>
<a href="#l70.28"></a><span id="l70.28">   video = document.querySelector(&quot;video&quot;);</span>
<a href="#l70.29"></a><span id="l70.29">   closeIcon = document.querySelector(&quot;div&quot;);</span>
<a href="#l70.30"></a><span id="l70.30"> </span>
<a href="#l70.31"></a><span id="l70.31" class="difflineminus">-  video.addEventListener(&quot;loadeddata&quot;, onLoadedData, false);</span>
<a href="#l70.32"></a><span id="l70.32" class="difflineplus">+  video.addEventListener(&quot;loadeddata&quot;, onLoadedData);</span>
<a href="#l70.33"></a><span id="l70.33"> </span>
<a href="#l70.34"></a><span id="l70.34">   // Automatically close this window when the playback ended, unless the user</span>
<a href="#l70.35"></a><span id="l70.35">   // interacted with it.</span>
<a href="#l70.36"></a><span id="l70.36" class="difflineminus">-  video.addEventListener(&quot;ended&quot;, autoClose, false);</span>
<a href="#l70.37"></a><span id="l70.37" class="difflineminus">-  window.addEventListener(&quot;click&quot;, cancelAutoClose, false);</span>
<a href="#l70.38"></a><span id="l70.38" class="difflineminus">-  window.addEventListener(&quot;keypress&quot;, cancelAutoClose, false);</span>
<a href="#l70.39"></a><span id="l70.39" class="difflineplus">+  video.addEventListener(&quot;ended&quot;, autoClose);</span>
<a href="#l70.40"></a><span id="l70.40" class="difflineplus">+  window.addEventListener(&quot;click&quot;, cancelAutoClose);</span>
<a href="#l70.41"></a><span id="l70.41" class="difflineplus">+  window.addEventListener(&quot;keypress&quot;, cancelAutoClose);</span>
<a href="#l70.42"></a><span id="l70.42"> </span>
<a href="#l70.43"></a><span id="l70.43" class="difflineminus">-  video.addEventListener(&quot;playing&quot;, hideUI, false);</span>
<a href="#l70.44"></a><span id="l70.44" class="difflineminus">-  video.addEventListener(&quot;seeked&quot;, hideUI, false);</span>
<a href="#l70.45"></a><span id="l70.45" class="difflineminus">-  video.addEventListener(&quot;seeking&quot;, showUI, false);</span>
<a href="#l70.46"></a><span id="l70.46" class="difflineminus">-  video.addEventListener(&quot;pause&quot;, showUI, false);</span>
<a href="#l70.47"></a><span id="l70.47" class="difflineminus">-  video.addEventListener(&quot;ended&quot;, showUI, false);</span>
<a href="#l70.48"></a><span id="l70.48" class="difflineplus">+  video.addEventListener(&quot;playing&quot;, hideUI);</span>
<a href="#l70.49"></a><span id="l70.49" class="difflineplus">+  video.addEventListener(&quot;seeked&quot;, hideUI);</span>
<a href="#l70.50"></a><span id="l70.50" class="difflineplus">+  video.addEventListener(&quot;seeking&quot;, showUI);</span>
<a href="#l70.51"></a><span id="l70.51" class="difflineplus">+  video.addEventListener(&quot;pause&quot;, showUI);</span>
<a href="#l70.52"></a><span id="l70.52" class="difflineplus">+  video.addEventListener(&quot;ended&quot;, showUI);</span>
<a href="#l70.53"></a><span id="l70.53"> </span>
<a href="#l70.54"></a><span id="l70.54" class="difflineminus">-  window.addEventListener(&quot;mousemove&quot;, onMouseMove, false);</span>
<a href="#l70.55"></a><span id="l70.55" class="difflineplus">+  window.addEventListener(&quot;mousemove&quot;, onMouseMove);</span>
<a href="#l70.56"></a><span id="l70.56"> </span>
<a href="#l70.57"></a><span id="l70.57">   video.src = contentVideo.currentSrc || contentVideo.src;</span>
<a href="#l70.58"></a><span id="l70.58"> }</span>
<a href="#l70.59"></a><span id="l70.59"> </span>
<a href="#l70.60"></a><span id="l70.60"> function onLoadedData() {</span>
<a href="#l70.61"></a><span id="l70.61" class="difflineminus">-  video.removeEventListener(&quot;loadeddata&quot;, onLoadedData, false);</span>
<a href="#l70.62"></a><span id="l70.62" class="difflineplus">+  video.removeEventListener(&quot;loadeddata&quot;, onLoadedData);</span>
<a href="#l70.63"></a><span id="l70.63">   video.volume = contentVideo.volume;</span>
<a href="#l70.64"></a><span id="l70.64">   video.muted = contentVideo.muted;</span>
<a href="#l70.65"></a><span id="l70.65">   video.poster = contentVideo.poster;</span>
<a href="#l70.66"></a><span id="l70.66"> </span>
<a href="#l70.67"></a><span id="l70.67">   if (contentVideo.currentTime &amp;&amp; !contentVideo.ended) {</span>
<a href="#l70.68"></a><span id="l70.68" class="difflineminus">-    video.addEventListener(&quot;seeked&quot;, playbackStarts, false);</span>
<a href="#l70.69"></a><span id="l70.69" class="difflineplus">+    video.addEventListener(&quot;seeked&quot;, playbackStarts);</span>
<a href="#l70.70"></a><span id="l70.70"> </span>
<a href="#l70.71"></a><span id="l70.71">     video.currentTime = contentVideo.currentTime;</span>
<a href="#l70.72"></a><span id="l70.72">   } else {</span>
<a href="#l70.73"></a><span id="l70.73">     playbackStarts();</span>
<a href="#l70.74"></a><span id="l70.74">   }</span>
<a href="#l70.75"></a><span id="l70.75"> </span>
<a href="#l70.76"></a><span id="l70.76">   video.controls = true;</span>
<a href="#l70.77"></a><span id="l70.77"> </span>
<a href="#l70.78"></a><span id="l70.78" class="difflineat">@@ -101,32 +101,32 @@ function onKeyPress(event) {</span>
<a href="#l70.79"></a><span id="l70.79">   resetIdleTimer();</span>
<a href="#l70.80"></a><span id="l70.80"> </span>
<a href="#l70.81"></a><span id="l70.81">   if (!video.controls &amp;&amp;</span>
<a href="#l70.82"></a><span id="l70.82">       String.fromCharCode(event.charCode) == &quot; &quot;)</span>
<a href="#l70.83"></a><span id="l70.83">     video.pause();</span>
<a href="#l70.84"></a><span id="l70.84"> }</span>
<a href="#l70.85"></a><span id="l70.85"> </span>
<a href="#l70.86"></a><span id="l70.86"> function playbackStarts() {</span>
<a href="#l70.87"></a><span id="l70.87" class="difflineminus">-  video.removeEventListener(&quot;seeked&quot;, playbackStarts, false);</span>
<a href="#l70.88"></a><span id="l70.88" class="difflineplus">+  video.removeEventListener(&quot;seeked&quot;, playbackStarts);</span>
<a href="#l70.89"></a><span id="l70.89"> </span>
<a href="#l70.90"></a><span id="l70.90">   // Loading the data from the content video may take a second or two. We hide</span>
<a href="#l70.91"></a><span id="l70.91">   // the video during that period.</span>
<a href="#l70.92"></a><span id="l70.92">   document.body.style.visibility = &quot;visible&quot;;</span>
<a href="#l70.93"></a><span id="l70.93">   video.focus();</span>
<a href="#l70.94"></a><span id="l70.94"> }</span>
<a href="#l70.95"></a><span id="l70.95"> </span>
<a href="#l70.96"></a><span id="l70.96"> function autoClose() {</span>
<a href="#l70.97"></a><span id="l70.97">   window.close();</span>
<a href="#l70.98"></a><span id="l70.98"> }</span>
<a href="#l70.99"></a><span id="l70.99"> </span>
<a href="#l70.100"></a><span id="l70.100"> function cancelAutoClose() {</span>
<a href="#l70.101"></a><span id="l70.101" class="difflineminus">-  video.removeEventListener(&quot;ended&quot;, autoClose, false);</span>
<a href="#l70.102"></a><span id="l70.102" class="difflineminus">-  window.removeEventListener(&quot;click&quot;, cancelAutoClose, false);</span>
<a href="#l70.103"></a><span id="l70.103" class="difflineminus">-  window.removeEventListener(&quot;keypress&quot;, cancelAutoClose, false);</span>
<a href="#l70.104"></a><span id="l70.104" class="difflineplus">+  video.removeEventListener(&quot;ended&quot;, autoClose);</span>
<a href="#l70.105"></a><span id="l70.105" class="difflineplus">+  window.removeEventListener(&quot;click&quot;, cancelAutoClose);</span>
<a href="#l70.106"></a><span id="l70.106" class="difflineplus">+  window.removeEventListener(&quot;keypress&quot;, cancelAutoClose);</span>
<a href="#l70.107"></a><span id="l70.107"> }</span>
<a href="#l70.108"></a><span id="l70.108"> </span>
<a href="#l70.109"></a><span id="l70.109"> var idleTimer = 0;</span>
<a href="#l70.110"></a><span id="l70.110"> function resetIdleTimer() {</span>
<a href="#l70.111"></a><span id="l70.111">   clearTimeout(idleTimer);</span>
<a href="#l70.112"></a><span id="l70.112">   idleTimer = setTimeout(hideUI, 2000);</span>
<a href="#l70.113"></a><span id="l70.113"> }</span>
<a href="#l70.114"></a><span id="l70.114"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/suite/common/places/tests/browser/browser_drag_bookmarks_on_toolbar.js</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -84,32 +84,32 @@ function synthesizeDragWithDirection(aEl</span>
<a href="#l71.4"></a><span id="l71.4">   EventUtils.synthesizeMouse(aElement,</span>
<a href="#l71.5"></a><span id="l71.5">                              startingPoint.x,</span>
<a href="#l71.6"></a><span id="l71.6">                              startingPoint.y,</span>
<a href="#l71.7"></a><span id="l71.7">                              { type: &quot;mousedown&quot; });</span>
<a href="#l71.8"></a><span id="l71.8">   EventUtils.synthesizeMouse(aElement,</span>
<a href="#l71.9"></a><span id="l71.9">                              startingPoint.x + xIncrement * 1,</span>
<a href="#l71.10"></a><span id="l71.10">                              startingPoint.y + yIncrement * 1,</span>
<a href="#l71.11"></a><span id="l71.11">                              { type: &quot;mousemove&quot; });</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-  gBookmarksToolbar.addEventListener(&quot;dragstart&quot;, trapDrag, false);</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+  gBookmarksToolbar.addEventListener(&quot;dragstart&quot;, trapDrag);</span>
<a href="#l71.14"></a><span id="l71.14">   EventUtils.synthesizeMouse(aElement,</span>
<a href="#l71.15"></a><span id="l71.15">                              startingPoint.x + xIncrement * 9,</span>
<a href="#l71.16"></a><span id="l71.16">                              startingPoint.y + yIncrement * 9,</span>
<a href="#l71.17"></a><span id="l71.17">                              { type: &quot;mousemove&quot; });</span>
<a href="#l71.18"></a><span id="l71.18">   ok(trapped, &quot;A dragstart event has been trapped.&quot;);</span>
<a href="#l71.19"></a><span id="l71.19" class="difflineminus">-  gBookmarksToolbar.removeEventListener(&quot;dragstart&quot;, trapDrag, false);</span>
<a href="#l71.20"></a><span id="l71.20" class="difflineplus">+  gBookmarksToolbar.removeEventListener(&quot;dragstart&quot;, trapDrag);</span>
<a href="#l71.21"></a><span id="l71.21"> </span>
<a href="#l71.22"></a><span id="l71.22">   // This is likely to cause a click event, and, in case we are dragging a</span>
<a href="#l71.23"></a><span id="l71.23">   // bookmark, an unwanted page visit.  Prevent the click event.</span>
<a href="#l71.24"></a><span id="l71.24" class="difflineminus">-  aElement.addEventListener(&quot;click&quot;, prevent, false);</span>
<a href="#l71.25"></a><span id="l71.25" class="difflineplus">+  aElement.addEventListener(&quot;click&quot;, prevent);</span>
<a href="#l71.26"></a><span id="l71.26">   EventUtils.synthesizeMouse(aElement,</span>
<a href="#l71.27"></a><span id="l71.27">                              startingPoint.x + xIncrement * 9,</span>
<a href="#l71.28"></a><span id="l71.28">                              startingPoint.y + yIncrement * 9,</span>
<a href="#l71.29"></a><span id="l71.29">                              { type: &quot;mouseup&quot; });</span>
<a href="#l71.30"></a><span id="l71.30" class="difflineminus">-  aElement.removeEventListener(&quot;click&quot;, prevent, false);</span>
<a href="#l71.31"></a><span id="l71.31" class="difflineplus">+  aElement.removeEventListener(&quot;click&quot;, prevent);</span>
<a href="#l71.32"></a><span id="l71.32"> </span>
<a href="#l71.33"></a><span id="l71.33">   // Cleanup eventually opened menus.</span>
<a href="#l71.34"></a><span id="l71.34">   if (aElement.localName == &quot;menu&quot; &amp;&amp; aElement.open)</span>
<a href="#l71.35"></a><span id="l71.35">     aElement.open = false;</span>
<a href="#l71.36"></a><span id="l71.36"> }</span>
<a href="#l71.37"></a><span id="l71.37"> </span>
<a href="#l71.38"></a><span id="l71.38"> function getToolbarNodeForItemId(aItemId) {</span>
<a href="#l71.39"></a><span id="l71.39">   var children = document.getElementById(&quot;PlacesToolbarItems&quot;).childNodes;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/suite/common/pref/pref-applications.js</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/suite/common/pref/pref-applications.js</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -836,21 +836,21 @@ var gApplicationsPane = {</span>
<a href="#l72.4"></a><span id="l72.4">     Services.prefs.addObserver(PREF_VIDEO_FEED_SELECTED_WEB, this, false);</span>
<a href="#l72.5"></a><span id="l72.5">     Services.prefs.addObserver(PREF_VIDEO_FEED_SELECTED_ACTION, this, false);</span>
<a href="#l72.6"></a><span id="l72.6"> </span>
<a href="#l72.7"></a><span id="l72.7">     Services.prefs.addObserver(PREF_AUDIO_FEED_SELECTED_APP, this, false);</span>
<a href="#l72.8"></a><span id="l72.8">     Services.prefs.addObserver(PREF_AUDIO_FEED_SELECTED_WEB, this, false);</span>
<a href="#l72.9"></a><span id="l72.9">     Services.prefs.addObserver(PREF_AUDIO_FEED_SELECTED_ACTION, this, false);</span>
<a href="#l72.10"></a><span id="l72.10"> </span>
<a href="#l72.11"></a><span id="l72.11">     // Listen for window unload so we can remove our preference observers.</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, this);</span>
<a href="#l72.14"></a><span id="l72.14"> </span>
<a href="#l72.15"></a><span id="l72.15">     // Listen for user events on the listbox and its children</span>
<a href="#l72.16"></a><span id="l72.16" class="difflineminus">-    this._list.addEventListener(&quot;select&quot;, this, false);</span>
<a href="#l72.17"></a><span id="l72.17" class="difflineminus">-    this._list.addEventListener(&quot;command&quot;, this, false);</span>
<a href="#l72.18"></a><span id="l72.18" class="difflineplus">+    this._list.addEventListener(&quot;select&quot;, this);</span>
<a href="#l72.19"></a><span id="l72.19" class="difflineplus">+    this._list.addEventListener(&quot;command&quot;, this);</span>
<a href="#l72.20"></a><span id="l72.20"> </span>
<a href="#l72.21"></a><span id="l72.21">     // Figure out how we should be sorting the list.  We persist sort settings</span>
<a href="#l72.22"></a><span id="l72.22">     // across sessions, so we can't assume the default sort column/direction.</span>
<a href="#l72.23"></a><span id="l72.23">     this._sortColumn = document.getElementById(&quot;typeColumn&quot;);</span>
<a href="#l72.24"></a><span id="l72.24">     if (document.getElementById(&quot;actionColumn&quot;).hasAttribute(&quot;sortDirection&quot;)) {</span>
<a href="#l72.25"></a><span id="l72.25">       this._sortColumn = document.getElementById(&quot;actionColumn&quot;);</span>
<a href="#l72.26"></a><span id="l72.26">       // The typeColumn element always has a sortDirection attribute,</span>
<a href="#l72.27"></a><span id="l72.27">       // either because it was persisted or because the default value</span>
<a href="#l72.28"></a><span id="l72.28" class="difflineat">@@ -865,19 +865,19 @@ var gApplicationsPane = {</span>
<a href="#l72.29"></a><span id="l72.29">     this._sortVisibleTypes();</span>
<a href="#l72.30"></a><span id="l72.30">     this._rebuildView();</span>
<a href="#l72.31"></a><span id="l72.31"> </span>
<a href="#l72.32"></a><span id="l72.32">     // Notify observers that the UI is now ready</span>
<a href="#l72.33"></a><span id="l72.33">     Services.obs.notifyObservers(window, &quot;app-handler-pane-loaded&quot;, null);</span>
<a href="#l72.34"></a><span id="l72.34">   },</span>
<a href="#l72.35"></a><span id="l72.35"> </span>
<a href="#l72.36"></a><span id="l72.36">   destroy: function() {</span>
<a href="#l72.37"></a><span id="l72.37" class="difflineminus">-    this._list.removeEventListener(&quot;command&quot;, this, false);</span>
<a href="#l72.38"></a><span id="l72.38" class="difflineminus">-    this._list.removeEventListener(&quot;select&quot;, this, false);</span>
<a href="#l72.39"></a><span id="l72.39" class="difflineminus">-    window.removeEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l72.40"></a><span id="l72.40" class="difflineplus">+    this._list.removeEventListener(&quot;command&quot;, this);</span>
<a href="#l72.41"></a><span id="l72.41" class="difflineplus">+    this._list.removeEventListener(&quot;select&quot;, this);</span>
<a href="#l72.42"></a><span id="l72.42" class="difflineplus">+    window.removeEventListener(&quot;unload&quot;, this);</span>
<a href="#l72.43"></a><span id="l72.43">     Services.prefs.removeObserver(PREF_SHOW_PLUGINS_IN_LIST, this);</span>
<a href="#l72.44"></a><span id="l72.44">     Services.prefs.removeObserver(PREF_HIDE_PLUGINS_WITHOUT_EXTENSIONS, this);</span>
<a href="#l72.45"></a><span id="l72.45">     Services.prefs.removeObserver(PREF_FEED_SELECTED_APP, this);</span>
<a href="#l72.46"></a><span id="l72.46">     Services.prefs.removeObserver(PREF_FEED_SELECTED_WEB, this);</span>
<a href="#l72.47"></a><span id="l72.47">     Services.prefs.removeObserver(PREF_FEED_SELECTED_ACTION, this);</span>
<a href="#l72.48"></a><span id="l72.48"> </span>
<a href="#l72.49"></a><span id="l72.49">     Services.prefs.removeObserver(PREF_VIDEO_FEED_SELECTED_APP, this);</span>
<a href="#l72.50"></a><span id="l72.50">     Services.prefs.removeObserver(PREF_VIDEO_FEED_SELECTED_WEB, this);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/suite/common/pref/pref-offlineapps.js</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/suite/common/pref/pref-offlineapps.js</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -13,32 +13,32 @@ function Startup()</span>
<a href="#l73.4"></a><span id="l73.4">   UpdateNotifyBox(always);</span>
<a href="#l73.5"></a><span id="l73.5"> }</span>
<a href="#l73.6"></a><span id="l73.6"> </span>
<a href="#l73.7"></a><span id="l73.7"> var OfflineAppsObserver = {</span>
<a href="#l73.8"></a><span id="l73.8"> </span>
<a href="#l73.9"></a><span id="l73.9">   init: function offlineAppsInit() {</span>
<a href="#l73.10"></a><span id="l73.10">     this.update();</span>
<a href="#l73.11"></a><span id="l73.11">     Services.obs.addObserver(this, &quot;perm-changed&quot;, false);</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, this);</span>
<a href="#l73.14"></a><span id="l73.14">   },</span>
<a href="#l73.15"></a><span id="l73.15"> </span>
<a href="#l73.16"></a><span id="l73.16">   update: function offlineAppsUpdate() {</span>
<a href="#l73.17"></a><span id="l73.17">     UpdateActualCacheSize();</span>
<a href="#l73.18"></a><span id="l73.18">     UpdateOfflineApps();</span>
<a href="#l73.19"></a><span id="l73.19">   },</span>
<a href="#l73.20"></a><span id="l73.20"> </span>
<a href="#l73.21"></a><span id="l73.21">   observe: function offlineAppsObserve(aSubject, aTopic, aData) {</span>
<a href="#l73.22"></a><span id="l73.22">     if (aTopic == &quot;perm-changed&quot;)</span>
<a href="#l73.23"></a><span id="l73.23">       this.update();</span>
<a href="#l73.24"></a><span id="l73.24">   },</span>
<a href="#l73.25"></a><span id="l73.25"> </span>
<a href="#l73.26"></a><span id="l73.26">   handleEvent: function offlineAppsEvent(aEvent) {</span>
<a href="#l73.27"></a><span id="l73.27">     if (aEvent.type == &quot;unload&quot;) {</span>
<a href="#l73.28"></a><span id="l73.28" class="difflineminus">-      window.removeEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l73.29"></a><span id="l73.29" class="difflineplus">+      window.removeEventListener(&quot;unload&quot;, this);</span>
<a href="#l73.30"></a><span id="l73.30">       Services.obs.removeObserver(this, &quot;perm-changed&quot;);</span>
<a href="#l73.31"></a><span id="l73.31">     }</span>
<a href="#l73.32"></a><span id="l73.32">   }</span>
<a href="#l73.33"></a><span id="l73.33"> }</span>
<a href="#l73.34"></a><span id="l73.34"> </span>
<a href="#l73.35"></a><span id="l73.35"> function UpdateActualCacheSize()</span>
<a href="#l73.36"></a><span id="l73.36"> {</span>
<a href="#l73.37"></a><span id="l73.37">   var visitor = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/suite/common/pref/pref-search.js</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/suite/common/pref/pref-search.js</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -7,28 +7,28 @@ Components.utils.import(&quot;resource://gre/</span>
<a href="#l74.4"></a><span id="l74.4"> function Startup() {</span>
<a href="#l74.5"></a><span id="l74.5">   MakeList();</span>
<a href="#l74.6"></a><span id="l74.6">   SearchObserver.init();</span>
<a href="#l74.7"></a><span id="l74.7"> }</span>
<a href="#l74.8"></a><span id="l74.8"> </span>
<a href="#l74.9"></a><span id="l74.9"> var SearchObserver = {</span>
<a href="#l74.10"></a><span id="l74.10">   init: function searchEngineListObserver_init() {</span>
<a href="#l74.11"></a><span id="l74.11">     Services.obs.addObserver(this, &quot;browser-search-engine-modified&quot;, false);</span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l74.13"></a><span id="l74.13" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, this);</span>
<a href="#l74.14"></a><span id="l74.14">   },</span>
<a href="#l74.15"></a><span id="l74.15"> </span>
<a href="#l74.16"></a><span id="l74.16">   observe: function searchEngineListObj_observe(aEngine, aTopic, aVerb) {</span>
<a href="#l74.17"></a><span id="l74.17">     if (aTopic != &quot;browser-search-engine-modified&quot;)</span>
<a href="#l74.18"></a><span id="l74.18">       return;</span>
<a href="#l74.19"></a><span id="l74.19">     MakeList();</span>
<a href="#l74.20"></a><span id="l74.20">   },</span>
<a href="#l74.21"></a><span id="l74.21"> </span>
<a href="#l74.22"></a><span id="l74.22">   handleEvent: function searchEngineListEvent(aEvent) {</span>
<a href="#l74.23"></a><span id="l74.23">     if (aEvent.type == &quot;unload&quot;) {</span>
<a href="#l74.24"></a><span id="l74.24" class="difflineminus">-      window.removeEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l74.25"></a><span id="l74.25" class="difflineplus">+      window.removeEventListener(&quot;unload&quot;, this);</span>
<a href="#l74.26"></a><span id="l74.26">       Services.obs.removeObserver(this, &quot;browser-search-engine-modified&quot;);</span>
<a href="#l74.27"></a><span id="l74.27">     }</span>
<a href="#l74.28"></a><span id="l74.28">   }</span>
<a href="#l74.29"></a><span id="l74.29"> };</span>
<a href="#l74.30"></a><span id="l74.30"> </span>
<a href="#l74.31"></a><span id="l74.31"> function MakeList() {</span>
<a href="#l74.32"></a><span id="l74.32">   var menulist = document.getElementById(&quot;engineList&quot;);</span>
<a href="#l74.33"></a><span id="l74.33">   var currentEngineName = Services.search.currentEngine.name;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1" class="difflineminus">--- a/suite/common/sync/syncSetup.js</span>
<a href="#l75.2"></a><span id="l75.2" class="difflineplus">+++ b/suite/common/sync/syncSetup.js</span>
<a href="#l75.3"></a><span id="l75.3" class="difflineat">@@ -70,17 +70,17 @@ var gSyncSetup = {</span>
<a href="#l75.4"></a><span id="l75.4">         //        of `this`. Fix in a followup. (bug 583347)</span>
<a href="#l75.5"></a><span id="l75.5">         if (add)</span>
<a href="#l75.6"></a><span id="l75.6">           Weave.Svc.Obs.add(topic, self[func], self);</span>
<a href="#l75.7"></a><span id="l75.7">         else</span>
<a href="#l75.8"></a><span id="l75.8">           Weave.Svc.Obs.remove(topic, self[func], self);</span>
<a href="#l75.9"></a><span id="l75.9">       });</span>
<a href="#l75.10"></a><span id="l75.10">     };</span>
<a href="#l75.11"></a><span id="l75.11">     addRem(true);</span>
<a href="#l75.12"></a><span id="l75.12" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, () =&gt; addRem(false), false);</span>
<a href="#l75.13"></a><span id="l75.13" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, () =&gt; addRem(false));</span>
<a href="#l75.14"></a><span id="l75.14"> </span>
<a href="#l75.15"></a><span id="l75.15">     setTimeout(function () {</span>
<a href="#l75.16"></a><span id="l75.16">       // Force Service to be loaded so that engines are registered.</span>
<a href="#l75.17"></a><span id="l75.17">       // See Bug 670082.</span>
<a href="#l75.18"></a><span id="l75.18">       Weave.Service;</span>
<a href="#l75.19"></a><span id="l75.19">     }, 0);</span>
<a href="#l75.20"></a><span id="l75.20"> </span>
<a href="#l75.21"></a><span id="l75.21">     this.captchaBrowser = document.getElementById(&quot;captcha&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1" class="difflineminus">--- a/suite/common/sync/syncUI.js</span>
<a href="#l76.2"></a><span id="l76.2" class="difflineplus">+++ b/suite/common/sync/syncUI.js</span>
<a href="#l76.3"></a><span id="l76.3" class="difflineat">@@ -18,41 +18,41 @@ var gSyncUI = {</span>
<a href="#l76.4"></a><span id="l76.4">          &quot;weave:ui:clear-error&quot;],</span>
<a href="#l76.5"></a><span id="l76.5"> </span>
<a href="#l76.6"></a><span id="l76.6">   _unloaded: false,</span>
<a href="#l76.7"></a><span id="l76.7"> </span>
<a href="#l76.8"></a><span id="l76.8">   init: function SUI_init() {</span>
<a href="#l76.9"></a><span id="l76.9">     // Update the Tools menu according to whether Sync is set up or not.</span>
<a href="#l76.10"></a><span id="l76.10">     let taskPopup = document.getElementById(&quot;taskPopup&quot;);</span>
<a href="#l76.11"></a><span id="l76.11">     if (taskPopup)</span>
<a href="#l76.12"></a><span id="l76.12" class="difflineminus">-      taskPopup.addEventListener(&quot;popupshowing&quot;, this.updateUI.bind(this), false);</span>
<a href="#l76.13"></a><span id="l76.13" class="difflineplus">+      taskPopup.addEventListener(&quot;popupshowing&quot;, this.updateUI.bind(this));</span>
<a href="#l76.14"></a><span id="l76.14"> </span>
<a href="#l76.15"></a><span id="l76.15">     // Proceed to set up the UI if Sync has already started up.</span>
<a href="#l76.16"></a><span id="l76.16">     // Otherwise we'll do it when Sync is firing up.</span>
<a href="#l76.17"></a><span id="l76.17">     if (Components.classes[&quot;@mozilla.org/weave/service;1&quot;]</span>
<a href="#l76.18"></a><span id="l76.18">                   .getService().wrappedJSObject.ready) {</span>
<a href="#l76.19"></a><span id="l76.19">       this.initUI();</span>
<a href="#l76.20"></a><span id="l76.20">       return;</span>
<a href="#l76.21"></a><span id="l76.21">     }</span>
<a href="#l76.22"></a><span id="l76.22"> </span>
<a href="#l76.23"></a><span id="l76.23">     Services.obs.addObserver(this, &quot;weave:service:ready&quot;, true);</span>
<a href="#l76.24"></a><span id="l76.24"> </span>
<a href="#l76.25"></a><span id="l76.25">     // Remove the observer if the window is closed before the observer</span>
<a href="#l76.26"></a><span id="l76.26">     // was triggered.</span>
<a href="#l76.27"></a><span id="l76.27">     window.addEventListener(&quot;unload&quot;, function SUI_unload() {</span>
<a href="#l76.28"></a><span id="l76.28">       gSyncUI._unloaded = true;</span>
<a href="#l76.29"></a><span id="l76.29" class="difflineminus">-      window.removeEventListener(&quot;unload&quot;, SUI_unload, false);</span>
<a href="#l76.30"></a><span id="l76.30" class="difflineplus">+      window.removeEventListener(&quot;unload&quot;, SUI_unload);</span>
<a href="#l76.31"></a><span id="l76.31">       Services.obs.removeObserver(gSyncUI, &quot;weave:service:ready&quot;);</span>
<a href="#l76.32"></a><span id="l76.32"> </span>
<a href="#l76.33"></a><span id="l76.33">       if (Weave.Status.ready) {</span>
<a href="#l76.34"></a><span id="l76.34">         gSyncUI._obs.forEach(function(topic) {</span>
<a href="#l76.35"></a><span id="l76.35">           Services.obs.removeObserver(gSyncUI, topic);</span>
<a href="#l76.36"></a><span id="l76.36">         });</span>
<a href="#l76.37"></a><span id="l76.37">       }</span>
<a href="#l76.38"></a><span id="l76.38" class="difflineminus">-    }, false);</span>
<a href="#l76.39"></a><span id="l76.39" class="difflineplus">+    });</span>
<a href="#l76.40"></a><span id="l76.40">   },</span>
<a href="#l76.41"></a><span id="l76.41"> </span>
<a href="#l76.42"></a><span id="l76.42">   initUI: function SUI_initUI() {</span>
<a href="#l76.43"></a><span id="l76.43">     this._obs.forEach(function(topic) {</span>
<a href="#l76.44"></a><span id="l76.44">       Services.obs.addObserver(this, topic, true);</span>
<a href="#l76.45"></a><span id="l76.45">     }, this);</span>
<a href="#l76.46"></a><span id="l76.46"> </span>
<a href="#l76.47"></a><span id="l76.47">     // Find the alltabs-popup</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1" class="difflineminus">--- a/suite/common/tasksOverlay.js</span>
<a href="#l77.2"></a><span id="l77.2" class="difflineplus">+++ b/suite/common/tasksOverlay.js</span>
<a href="#l77.3"></a><span id="l77.3" class="difflineat">@@ -105,36 +105,36 @@ function toOpenWindowByType(inType, uri,</span>
<a href="#l77.4"></a><span id="l77.4">     return topWindow;</span>
<a href="#l77.5"></a><span id="l77.5">   }</span>
<a href="#l77.6"></a><span id="l77.6">   else</span>
<a href="#l77.7"></a><span id="l77.7">   {</span>
<a href="#l77.8"></a><span id="l77.8">     // open the requested window, but block it until it's fully loaded</span>
<a href="#l77.9"></a><span id="l77.9">     function newWindowLoaded(event)</span>
<a href="#l77.10"></a><span id="l77.10">     {</span>
<a href="#l77.11"></a><span id="l77.11">       // make sure that this handler is called only once</span>
<a href="#l77.12"></a><span id="l77.12" class="difflineminus">-      window.removeEventListener(&quot;unload&quot;, newWindowLoaded, false);</span>
<a href="#l77.13"></a><span id="l77.13" class="difflineminus">-      window[uri].removeEventListener(&quot;load&quot;, newWindowLoaded, false);</span>
<a href="#l77.14"></a><span id="l77.14" class="difflineplus">+      window.removeEventListener(&quot;unload&quot;, newWindowLoaded);</span>
<a href="#l77.15"></a><span id="l77.15" class="difflineplus">+      window[uri].removeEventListener(&quot;load&quot;, newWindowLoaded);</span>
<a href="#l77.16"></a><span id="l77.16">       delete window[uri];</span>
<a href="#l77.17"></a><span id="l77.17">     }</span>
<a href="#l77.18"></a><span id="l77.18"> </span>
<a href="#l77.19"></a><span id="l77.19">     // Remember the newly loading window until it's fully loaded</span>
<a href="#l77.20"></a><span id="l77.20">     // or until the current window passes away.</span>
<a href="#l77.21"></a><span id="l77.21">     // Only pass args if they exist and have a value (see Bug 1279738).</span>
<a href="#l77.22"></a><span id="l77.22">     if (typeof args != &quot;undefined&quot; &amp;&amp; args) {</span>
<a href="#l77.23"></a><span id="l77.23">       window[uri] = openDialog(uri, &quot;&quot;,</span>
<a href="#l77.24"></a><span id="l77.24">                                features || &quot;non-private,all,dialog=no&quot;,</span>
<a href="#l77.25"></a><span id="l77.25">                                args || null);</span>
<a href="#l77.26"></a><span id="l77.26">     }</span>
<a href="#l77.27"></a><span id="l77.27">     else {</span>
<a href="#l77.28"></a><span id="l77.28">       window[uri] = openDialog(uri, &quot;&quot;,</span>
<a href="#l77.29"></a><span id="l77.29">                                features || &quot;non-private,all,dialog=no&quot;);</span>
<a href="#l77.30"></a><span id="l77.30">     }</span>
<a href="#l77.31"></a><span id="l77.31"> </span>
<a href="#l77.32"></a><span id="l77.32" class="difflineminus">-    window[uri].addEventListener(&quot;load&quot;, newWindowLoaded, false);</span>
<a href="#l77.33"></a><span id="l77.33" class="difflineminus">-    window.addEventListener(&quot;unload&quot;, newWindowLoaded, false);</span>
<a href="#l77.34"></a><span id="l77.34" class="difflineplus">+    window[uri].addEventListener(&quot;load&quot;, newWindowLoaded);</span>
<a href="#l77.35"></a><span id="l77.35" class="difflineplus">+    window.addEventListener(&quot;unload&quot;, newWindowLoaded);</span>
<a href="#l77.36"></a><span id="l77.36">   }</span>
<a href="#l77.37"></a><span id="l77.37">   return;</span>
<a href="#l77.38"></a><span id="l77.38"> }</span>
<a href="#l77.39"></a><span id="l77.39"> </span>
<a href="#l77.40"></a><span id="l77.40"> function OpenBrowserWindow()</span>
<a href="#l77.41"></a><span id="l77.41"> {</span>
<a href="#l77.42"></a><span id="l77.42">   var win = Services.wm.getMostRecentWindow(&quot;navigator:browser&quot;);</span>
<a href="#l77.43"></a><span id="l77.43">   if (document.documentElement.getAttribute(&quot;windowtype&quot;) ==</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1" class="difflineminus">--- a/suite/common/tests/browser/browser_354894.js</span>
<a href="#l78.2"></a><span id="l78.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_354894.js</span>
<a href="#l78.3"></a><span id="l78.3" class="difflineat">@@ -183,26 +183,26 @@ function test() {</span>
<a href="#l78.4"></a><span id="l78.4">    */</span>
<a href="#l78.5"></a><span id="l78.5">   function setupTestAndRun(testFn) {</span>
<a href="#l78.6"></a><span id="l78.6">     // Prepare the prefs</span>
<a href="#l78.7"></a><span id="l78.7">     setPrefs();</span>
<a href="#l78.8"></a><span id="l78.8"> </span>
<a href="#l78.9"></a><span id="l78.9">     // Prepare a window; open it and add more tabs</span>
<a href="#l78.10"></a><span id="l78.10">     let newWin = openDialog(location, &quot;_blank&quot;, CHROME_FEATURES, &quot;about:config&quot;);</span>
<a href="#l78.11"></a><span id="l78.11">     newWin.addEventListener(&quot;load&quot;, function loadListener1(aEvent) {</span>
<a href="#l78.12"></a><span id="l78.12" class="difflineminus">-      newWin.removeEventListener(&quot;load&quot;, loadListener1, false);</span>
<a href="#l78.13"></a><span id="l78.13" class="difflineplus">+      newWin.removeEventListener(&quot;load&quot;, loadListener1);</span>
<a href="#l78.14"></a><span id="l78.14">       newWin.getBrowser().addEventListener(&quot;pageshow&quot;, function pageshowListener2(aEvent) {</span>
<a href="#l78.15"></a><span id="l78.15">         newWin.getBrowser().removeEventListener(&quot;pageshow&quot;, pageshowListener2, true);</span>
<a href="#l78.16"></a><span id="l78.16">         for (let url of TEST_URLS) {</span>
<a href="#l78.17"></a><span id="l78.17">           newWin.getBrowser().addTab(url);</span>
<a href="#l78.18"></a><span id="l78.18">         }</span>
<a href="#l78.19"></a><span id="l78.19"> </span>
<a href="#l78.20"></a><span id="l78.20">         executeSoon(() =&gt; testFn(newWin));</span>
<a href="#l78.21"></a><span id="l78.21">       }, true);</span>
<a href="#l78.22"></a><span id="l78.22" class="difflineminus">-    }, false);</span>
<a href="#l78.23"></a><span id="l78.23" class="difflineplus">+    });</span>
<a href="#l78.24"></a><span id="l78.24">   }</span>
<a href="#l78.25"></a><span id="l78.25"> </span>
<a href="#l78.26"></a><span id="l78.26">   /**</span>
<a href="#l78.27"></a><span id="l78.27">    * Test 1: Normal in-session restore</span>
<a href="#l78.28"></a><span id="l78.28">    * @note: Non-Mac only</span>
<a href="#l78.29"></a><span id="l78.29">    */</span>
<a href="#l78.30"></a><span id="l78.30">   function testOpenCloseNormal(nextFn) {</span>
<a href="#l78.31"></a><span id="l78.31">     setupTestAndRun(function(newWin) {</span>
<a href="#l78.32"></a><span id="l78.32" class="difflineat">@@ -217,17 +217,17 @@ function test() {</span>
<a href="#l78.33"></a><span id="l78.33">         newWin.BrowserTryToCloseWindow();</span>
<a href="#l78.34"></a><span id="l78.34">         ok(newWin.closed, &quot;Second close request was granted&quot;);</span>
<a href="#l78.35"></a><span id="l78.35">       }</span>
<a href="#l78.36"></a><span id="l78.36"> </span>
<a href="#l78.37"></a><span id="l78.37">       // Open a new window</span>
<a href="#l78.38"></a><span id="l78.38">       // The previously closed window should be restored</span>
<a href="#l78.39"></a><span id="l78.39">       newWin = openDialog(location, &quot;_blank&quot;, CHROME_FEATURES, &quot;about:blank&quot;);</span>
<a href="#l78.40"></a><span id="l78.40">       newWin.addEventListener(&quot;load&quot;, function loadListener3() {</span>
<a href="#l78.41"></a><span id="l78.41" class="difflineminus">-        newWin.removeEventListener(&quot;load&quot;, loadListener3, false);</span>
<a href="#l78.42"></a><span id="l78.42" class="difflineplus">+        newWin.removeEventListener(&quot;load&quot;, loadListener3);</span>
<a href="#l78.43"></a><span id="l78.43">         executeSoon(function() {</span>
<a href="#l78.44"></a><span id="l78.44">           is(newWin.getBrowser().browsers.length, TEST_URLS.length + 1,</span>
<a href="#l78.45"></a><span id="l78.45">              &quot;Restored window in-session with otherpopup windows around&quot;);</span>
<a href="#l78.46"></a><span id="l78.46"> </span>
<a href="#l78.47"></a><span id="l78.47">           // Cleanup</span>
<a href="#l78.48"></a><span id="l78.48">           newWin.close();</span>
<a href="#l78.49"></a><span id="l78.49"> </span>
<a href="#l78.50"></a><span id="l78.50">           // Next please</span>
<a href="#l78.51"></a><span id="l78.51" class="difflineat">@@ -243,46 +243,46 @@ function test() {</span>
<a href="#l78.52"></a><span id="l78.52">    * @note: Non-Mac only</span>
<a href="#l78.53"></a><span id="l78.53">    */</span>
<a href="#l78.54"></a><span id="l78.54">   function testOpenCloseWindowAndPopup(nextFn) {</span>
<a href="#l78.55"></a><span id="l78.55">     setupTestAndRun(function(newWin) {</span>
<a href="#l78.56"></a><span id="l78.56">       // open some popups</span>
<a href="#l78.57"></a><span id="l78.57">       let popup = openDialog(location, &quot;popup&quot;, POPUP_FEATURES, TEST_URLS[0]);</span>
<a href="#l78.58"></a><span id="l78.58">       let popup2 = openDialog(location, &quot;popup2&quot;, POPUP_FEATURES, TEST_URLS[1]);</span>
<a href="#l78.59"></a><span id="l78.59">       popup2.addEventListener(&quot;load&quot;, function loadListener4() {</span>
<a href="#l78.60"></a><span id="l78.60" class="difflineminus">-        popup2.removeEventListener(&quot;load&quot;, loadListener4, false);</span>
<a href="#l78.61"></a><span id="l78.61" class="difflineplus">+        popup2.removeEventListener(&quot;load&quot;, loadListener4);</span>
<a href="#l78.62"></a><span id="l78.62">         popup2.getBrowser().addEventListener(&quot;pageshow&quot;, function pageshowListener5() {</span>
<a href="#l78.63"></a><span id="l78.63">           popup2.getBrowser().removeEventListener(&quot;pageshow&quot;, pageshowListener5, true);</span>
<a href="#l78.64"></a><span id="l78.64">           popup2.getBrowser().addTab(TEST_URLS[0]);</span>
<a href="#l78.65"></a><span id="l78.65">           // close the window</span>
<a href="#l78.66"></a><span id="l78.66">           newWin.BrowserTryToCloseWindow();</span>
<a href="#l78.67"></a><span id="l78.67"> </span>
<a href="#l78.68"></a><span id="l78.68">           // Close the popup window</span>
<a href="#l78.69"></a><span id="l78.69">           // The test is successful when not this popup window is restored</span>
<a href="#l78.70"></a><span id="l78.70">           // but instead newWin</span>
<a href="#l78.71"></a><span id="l78.71">           popup2.close();</span>
<a href="#l78.72"></a><span id="l78.72"> </span>
<a href="#l78.73"></a><span id="l78.73">           // open a new window the previously closed window should be restored to</span>
<a href="#l78.74"></a><span id="l78.74">           newWin = openDialog(location, &quot;_blank&quot;, CHROME_FEATURES, &quot;about:blank&quot;);</span>
<a href="#l78.75"></a><span id="l78.75">           newWin.addEventListener(&quot;load&quot;, function loadListener6() {</span>
<a href="#l78.76"></a><span id="l78.76" class="difflineminus">-            newWin.removeEventListener(&quot;load&quot;, loadListener6, false);</span>
<a href="#l78.77"></a><span id="l78.77" class="difflineplus">+            newWin.removeEventListener(&quot;load&quot;, loadListener6);</span>
<a href="#l78.78"></a><span id="l78.78">             executeSoon(function() {</span>
<a href="#l78.79"></a><span id="l78.79">               is(newWin.getBrowser().browsers.length, TEST_URLS.length + 1,</span>
<a href="#l78.80"></a><span id="l78.80">                  &quot;Restored window and associated tabs in session&quot;);</span>
<a href="#l78.81"></a><span id="l78.81"> </span>
<a href="#l78.82"></a><span id="l78.82">               // Cleanup</span>
<a href="#l78.83"></a><span id="l78.83">               newWin.close();</span>
<a href="#l78.84"></a><span id="l78.84">               popup.close();</span>
<a href="#l78.85"></a><span id="l78.85"> </span>
<a href="#l78.86"></a><span id="l78.86">               // Next please</span>
<a href="#l78.87"></a><span id="l78.87">               executeSoon(nextFn);</span>
<a href="#l78.88"></a><span id="l78.88">             });</span>
<a href="#l78.89"></a><span id="l78.89">           }, true);</span>
<a href="#l78.90"></a><span id="l78.90">         }, true);</span>
<a href="#l78.91"></a><span id="l78.91" class="difflineminus">-      }, false);</span>
<a href="#l78.92"></a><span id="l78.92" class="difflineplus">+      });</span>
<a href="#l78.93"></a><span id="l78.93">     });</span>
<a href="#l78.94"></a><span id="l78.94">   }</span>
<a href="#l78.95"></a><span id="l78.95"> </span>
<a href="#l78.96"></a><span id="l78.96">   /**</span>
<a href="#l78.97"></a><span id="l78.97">    * Test 3: Open some popup window to check it isn't restored.</span>
<a href="#l78.98"></a><span id="l78.98">    *         Instead nothing at all should be restored</span>
<a href="#l78.99"></a><span id="l78.99">    * @note: Non-Mac only</span>
<a href="#l78.100"></a><span id="l78.100">    */</span>
<a href="#l78.101"></a><span id="l78.101" class="difflineat">@@ -297,17 +297,17 @@ function test() {</span>
<a href="#l78.102"></a><span id="l78.102">       popup.removeEventListener(&quot;load&quot;, loadListener7, true);</span>
<a href="#l78.103"></a><span id="l78.103">       is(popup.getBrowser().browsers.length, 1,</span>
<a href="#l78.104"></a><span id="l78.104">          &quot;Did not restore the popup window (1)&quot;);</span>
<a href="#l78.105"></a><span id="l78.105">       popup.BrowserTryToCloseWindow();</span>
<a href="#l78.106"></a><span id="l78.106"> </span>
<a href="#l78.107"></a><span id="l78.107">       // Real tests</span>
<a href="#l78.108"></a><span id="l78.108">       popup = openDialog(location, &quot;popup&quot;, POPUP_FEATURES, TEST_URLS[1]);</span>
<a href="#l78.109"></a><span id="l78.109">       popup.addEventListener(&quot;load&quot;, function loadListener8() {</span>
<a href="#l78.110"></a><span id="l78.110" class="difflineminus">-        popup.removeEventListener(&quot;load&quot;, loadListener8, false);</span>
<a href="#l78.111"></a><span id="l78.111" class="difflineplus">+        popup.removeEventListener(&quot;load&quot;, loadListener8);</span>
<a href="#l78.112"></a><span id="l78.112">         popup.getBrowser().addEventListener(&quot;pageshow&quot;, function pageshowListener9() {</span>
<a href="#l78.113"></a><span id="l78.113">           popup.getBrowser().removeEventListener(&quot;pageshow&quot;, pageshowListener9, true);</span>
<a href="#l78.114"></a><span id="l78.114">           popup.getBrowser().addTab(TEST_URLS[0]);</span>
<a href="#l78.115"></a><span id="l78.115"> </span>
<a href="#l78.116"></a><span id="l78.116">           is(popup.getBrowser().browsers.length, 2,</span>
<a href="#l78.117"></a><span id="l78.117">              &quot;Did not restore to the popup window (2)&quot;);</span>
<a href="#l78.118"></a><span id="l78.118"> </span>
<a href="#l78.119"></a><span id="l78.119">           // Close the popup window</span>
<a href="#l78.120"></a><span id="l78.120" class="difflineat">@@ -327,17 +327,17 @@ function test() {</span>
<a href="#l78.121"></a><span id="l78.121">               // Cleanup</span>
<a href="#l78.122"></a><span id="l78.122">               newWin.close();</span>
<a href="#l78.123"></a><span id="l78.123"> </span>
<a href="#l78.124"></a><span id="l78.124">               // Next please</span>
<a href="#l78.125"></a><span id="l78.125">               executeSoon(nextFn);</span>
<a href="#l78.126"></a><span id="l78.126">             });</span>
<a href="#l78.127"></a><span id="l78.127">           }, true);</span>
<a href="#l78.128"></a><span id="l78.128">         }, true);</span>
<a href="#l78.129"></a><span id="l78.129" class="difflineminus">-      }, false);</span>
<a href="#l78.130"></a><span id="l78.130" class="difflineplus">+      });</span>
<a href="#l78.131"></a><span id="l78.131">     }, true);</span>
<a href="#l78.132"></a><span id="l78.132">   }</span>
<a href="#l78.133"></a><span id="l78.133"> </span>
<a href="#l78.134"></a><span id="l78.134">     /**</span>
<a href="#l78.135"></a><span id="l78.135">    * Test 4: Open some windows and do undoCloseWindow. This should prevent any</span>
<a href="#l78.136"></a><span id="l78.136">    *         restoring later in the test</span>
<a href="#l78.137"></a><span id="l78.137">    * @note: Non-Mac only</span>
<a href="#l78.138"></a><span id="l78.138">    */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1" class="difflineminus">--- a/suite/common/tests/browser/browser_423132.js</span>
<a href="#l79.2"></a><span id="l79.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_423132.js</span>
<a href="#l79.3"></a><span id="l79.3" class="difflineat">@@ -31,17 +31,17 @@ function test() {</span>
<a href="#l79.4"></a><span id="l79.4">   const testURL = &quot;http://mochi.test:8888/browser/&quot; +</span>
<a href="#l79.5"></a><span id="l79.5">     &quot;suite/common/tests/browser/browser_423132_sample.html&quot;;</span>
<a href="#l79.6"></a><span id="l79.6"> </span>
<a href="#l79.7"></a><span id="l79.7">   // open a new window</span>
<a href="#l79.8"></a><span id="l79.8">   let newWin = openDialog(location, &quot;_blank&quot;, &quot;chrome,all,dialog=no&quot;, &quot;about:blank&quot;);</span>
<a href="#l79.9"></a><span id="l79.9"> </span>
<a href="#l79.10"></a><span id="l79.10">   // make sure sessionstore saves the cookie data, then close the window</span>
<a href="#l79.11"></a><span id="l79.11">   newWin.addEventListener(&quot;load&quot;, function testNewWinLoad(aEvent) {</span>
<a href="#l79.12"></a><span id="l79.12" class="difflineminus">-    newWin.removeEventListener(&quot;load&quot;, testNewWinLoad, false);</span>
<a href="#l79.13"></a><span id="l79.13" class="difflineplus">+    newWin.removeEventListener(&quot;load&quot;, testNewWinLoad);</span>
<a href="#l79.14"></a><span id="l79.14"> </span>
<a href="#l79.15"></a><span id="l79.15">     newWin.getBrowser().selectedBrowser.loadURI(testURL, null, null);</span>
<a href="#l79.16"></a><span id="l79.16"> </span>
<a href="#l79.17"></a><span id="l79.17">     newWin.getBrowser().addEventListener(&quot;pageshow&quot;, function testNewWinPageShow(aEvent) {</span>
<a href="#l79.18"></a><span id="l79.18">       newWin.getBrowser().removeEventListener(&quot;pageshow&quot;, testNewWinPageShow, true);</span>
<a href="#l79.19"></a><span id="l79.19"> </span>
<a href="#l79.20"></a><span id="l79.20">       // get the sessionstore state for the window</span>
<a href="#l79.21"></a><span id="l79.21">       let state = ss.getWindowState(newWin);</span>
<a href="#l79.22"></a><span id="l79.22" class="difflineat">@@ -77,10 +77,10 @@ function test() {</span>
<a href="#l79.23"></a><span id="l79.23">       // clean up</span>
<a href="#l79.24"></a><span id="l79.24">       if (Services.prefs.prefHasUserValue(&quot;browser.sessionstore.interval&quot;))</span>
<a href="#l79.25"></a><span id="l79.25">         Services.prefs.clearUserPref(&quot;browser.sessionstore.interval&quot;);</span>
<a href="#l79.26"></a><span id="l79.26">       cs.removeAll();</span>
<a href="#l79.27"></a><span id="l79.27">       newWin.close();</span>
<a href="#l79.28"></a><span id="l79.28">       is(browserWindowsCount(), 1, &quot;Only one browser window should be open eventually&quot;);</span>
<a href="#l79.29"></a><span id="l79.29">       finish();</span>
<a href="#l79.30"></a><span id="l79.30">     }, true);</span>
<a href="#l79.31"></a><span id="l79.31" class="difflineminus">-  }, false);</span>
<a href="#l79.32"></a><span id="l79.32" class="difflineplus">+  });</span>
<a href="#l79.33"></a><span id="l79.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1" class="difflineminus">--- a/suite/common/tests/browser/browser_447951.js</span>
<a href="#l80.2"></a><span id="l80.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_447951.js</span>
<a href="#l80.3"></a><span id="l80.3" class="difflineat">@@ -15,17 +15,17 @@ function test() {</span>
<a href="#l80.4"></a><span id="l80.4"> </span>
<a href="#l80.5"></a><span id="l80.5">     let tabState = { entries: [] };</span>
<a href="#l80.6"></a><span id="l80.6">     let max_entries = Services.prefs.getIntPref(&quot;browser.sessionhistory.max_entries&quot;);</span>
<a href="#l80.7"></a><span id="l80.7">     for (let i = 0; i &lt; max_entries; i++)</span>
<a href="#l80.8"></a><span id="l80.8">       tabState.entries.push({ url: baseURL + i });</span>
<a href="#l80.9"></a><span id="l80.9"> </span>
<a href="#l80.10"></a><span id="l80.10">     ss.setTabState(tab, JSON.stringify(tabState));</span>
<a href="#l80.11"></a><span id="l80.11">     tab.addEventListener(&quot;SSTabRestored&quot;, function testTabSSTabRestored(aEvent) {</span>
<a href="#l80.12"></a><span id="l80.12" class="difflineminus">-      tab.removeEventListener(&quot;SSTabRestored&quot;, testTabSSTabRestored, false);</span>
<a href="#l80.13"></a><span id="l80.13" class="difflineplus">+      tab.removeEventListener(&quot;SSTabRestored&quot;, testTabSSTabRestored);</span>
<a href="#l80.14"></a><span id="l80.14">       tabState = JSON.parse(ss.getTabState(tab));</span>
<a href="#l80.15"></a><span id="l80.15">       is(tabState.entries.length, max_entries, &quot;session history filled to the limit&quot;);</span>
<a href="#l80.16"></a><span id="l80.16">       is(tabState.entries[0].url, baseURL + 0, &quot;... but not more&quot;);</span>
<a href="#l80.17"></a><span id="l80.17"> </span>
<a href="#l80.18"></a><span id="l80.18">       // visit yet another anchor (appending it to session history)</span>
<a href="#l80.19"></a><span id="l80.19">       let doc = tab.linkedBrowser.contentDocument;</span>
<a href="#l80.20"></a><span id="l80.20">       let event = doc.createEvent(&quot;MouseEvents&quot;);</span>
<a href="#l80.21"></a><span id="l80.21">       event.initMouseEvent(&quot;click&quot;, true, true, doc.defaultView, 1,</span>
<a href="#l80.22"></a><span id="l80.22" class="difflineat">@@ -40,11 +40,11 @@ function test() {</span>
<a href="#l80.23"></a><span id="l80.23">            &quot;... and ignored&quot;);</span>
<a href="#l80.24"></a><span id="l80.24">         is(tabState.entries[0].url, baseURL + 1,</span>
<a href="#l80.25"></a><span id="l80.25">            &quot;... and the first item was removed&quot;);</span>
<a href="#l80.26"></a><span id="l80.26"> </span>
<a href="#l80.27"></a><span id="l80.27">         // clean up</span>
<a href="#l80.28"></a><span id="l80.28">         getBrowser().removeTab(tab);</span>
<a href="#l80.29"></a><span id="l80.29">         finish();</span>
<a href="#l80.30"></a><span id="l80.30">       });</span>
<a href="#l80.31"></a><span id="l80.31" class="difflineminus">-    }, false);</span>
<a href="#l80.32"></a><span id="l80.32" class="difflineplus">+    });</span>
<a href="#l80.33"></a><span id="l80.33">   }, true);</span>
<a href="#l80.34"></a><span id="l80.34"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1" class="difflineminus">--- a/suite/common/tests/browser/browser_461634.js</span>
<a href="#l81.2"></a><span id="l81.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_461634.js</span>
<a href="#l81.3"></a><span id="l81.3" class="difflineat">@@ -39,17 +39,17 @@ function test() {</span>
<a href="#l81.4"></a><span id="l81.4">     catch (ex) {</span>
<a href="#l81.5"></a><span id="l81.5">       return ex.name == &quot;NS_ERROR_ILLEGAL_VALUE&quot;;</span>
<a href="#l81.6"></a><span id="l81.6">     }</span>
<a href="#l81.7"></a><span id="l81.7">   }</span>
<a href="#l81.8"></a><span id="l81.8"> </span>
<a href="#l81.9"></a><span id="l81.9">   // open a window and add the above closed tab list</span>
<a href="#l81.10"></a><span id="l81.10">   let newWin = openDialog(location, &quot;&quot;, &quot;chrome,all,dialog=no&quot;);</span>
<a href="#l81.11"></a><span id="l81.11">   newWin.addEventListener(&quot;load&quot;, function loadListener(aEvent) {</span>
<a href="#l81.12"></a><span id="l81.12" class="difflineminus">-    newWin.removeEventListener(&quot;load&quot;, loadListener, false);</span>
<a href="#l81.13"></a><span id="l81.13" class="difflineplus">+    newWin.removeEventListener(&quot;load&quot;, loadListener);</span>
<a href="#l81.14"></a><span id="l81.14"> </span>
<a href="#l81.15"></a><span id="l81.15">     Services.prefs.setIntPref(&quot;browser.sessionstore.max_tabs_undo&quot;,</span>
<a href="#l81.16"></a><span id="l81.16">                               test_state.windows[0]._closedTabs.length);</span>
<a href="#l81.17"></a><span id="l81.17">     ss.setWindowState(newWin, JSON.stringify(test_state), true);</span>
<a href="#l81.18"></a><span id="l81.18"> </span>
<a href="#l81.19"></a><span id="l81.19">     let closedTabs = JSON.parse(ss.getClosedTabData(newWin));</span>
<a href="#l81.20"></a><span id="l81.20">     is(closedTabs.length, test_state.windows[0]._closedTabs.length,</span>
<a href="#l81.21"></a><span id="l81.21">        &quot;Closed tab list has the expected length&quot;);</span>
<a href="#l81.22"></a><span id="l81.22" class="difflineat">@@ -79,10 +79,10 @@ function test() {</span>
<a href="#l81.23"></a><span id="l81.23">     is(countByTitle(closedTabs, REMEMBER), remember_count,</span>
<a href="#l81.24"></a><span id="l81.24">        &quot;... and tabs not specifically forgetten weren't.&quot;);</span>
<a href="#l81.25"></a><span id="l81.25"> </span>
<a href="#l81.26"></a><span id="l81.26">     // clean up</span>
<a href="#l81.27"></a><span id="l81.27">     newWin.close();</span>
<a href="#l81.28"></a><span id="l81.28">     is(browserWindowsCount(), 1, &quot;Only one browser window should be open eventually&quot;);</span>
<a href="#l81.29"></a><span id="l81.29">     Services.prefs.clearUserPref(&quot;browser.sessionstore.max_tabs_undo&quot;);</span>
<a href="#l81.30"></a><span id="l81.30">     finish();</span>
<a href="#l81.31"></a><span id="l81.31" class="difflineminus">-  }, false);</span>
<a href="#l81.32"></a><span id="l81.32" class="difflineplus">+  });</span>
<a href="#l81.33"></a><span id="l81.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1" class="difflineminus">--- a/suite/common/tests/browser/browser_465223.js</span>
<a href="#l82.2"></a><span id="l82.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_465223.js</span>
<a href="#l82.3"></a><span id="l82.3" class="difflineat">@@ -22,17 +22,17 @@ function test() {</span>
<a href="#l82.4"></a><span id="l82.4">   let uniqueKey1 = &quot;bug 465223.1&quot;;</span>
<a href="#l82.5"></a><span id="l82.5">   let uniqueKey2 = &quot;bug 465223.2&quot;;</span>
<a href="#l82.6"></a><span id="l82.6">   let uniqueValue1 = &quot;unik&quot; + Date.now();</span>
<a href="#l82.7"></a><span id="l82.7">   let uniqueValue2 = &quot;pi != &quot; + Math.random();</span>
<a href="#l82.8"></a><span id="l82.8"> </span>
<a href="#l82.9"></a><span id="l82.9">   // open a window and set a value on it</span>
<a href="#l82.10"></a><span id="l82.10">   let newWin = openDialog(location, &quot;_blank&quot;, &quot;chrome,all,dialog=no&quot;);</span>
<a href="#l82.11"></a><span id="l82.11">   newWin.addEventListener(&quot;load&quot;, function loadListener(aEvent) {</span>
<a href="#l82.12"></a><span id="l82.12" class="difflineminus">-    newWin.removeEventListener(&quot;load&quot;, loadListener, false);</span>
<a href="#l82.13"></a><span id="l82.13" class="difflineplus">+    newWin.removeEventListener(&quot;load&quot;, loadListener);</span>
<a href="#l82.14"></a><span id="l82.14"> </span>
<a href="#l82.15"></a><span id="l82.15">     ss.setWindowValue(newWin, uniqueKey1, uniqueValue1);</span>
<a href="#l82.16"></a><span id="l82.16"> </span>
<a href="#l82.17"></a><span id="l82.17">     let newState = { windows: [{ tabs:[{ entries: [] }], extData: {} }] };</span>
<a href="#l82.18"></a><span id="l82.18">     newState.windows[0].extData[uniqueKey2] = uniqueValue2;</span>
<a href="#l82.19"></a><span id="l82.19">     ss.setWindowState(newWin, JSON.stringify(newState), false);</span>
<a href="#l82.20"></a><span id="l82.20"> </span>
<a href="#l82.21"></a><span id="l82.21">     is(newWin.gBrowser.tabContainer.childNodes.length, 2,</span>
<a href="#l82.22"></a><span id="l82.22" class="difflineat">@@ -51,10 +51,10 @@ function test() {</span>
<a href="#l82.23"></a><span id="l82.23">        &quot;window value was cleared&quot;);</span>
<a href="#l82.24"></a><span id="l82.24">     is(ss.getWindowValue(newWin, uniqueKey2), uniqueValue1,</span>
<a href="#l82.25"></a><span id="l82.25">        &quot;window value was correctly overwritten&quot;);</span>
<a href="#l82.26"></a><span id="l82.26"> </span>
<a href="#l82.27"></a><span id="l82.27">     // clean up</span>
<a href="#l82.28"></a><span id="l82.28">     newWin.close();</span>
<a href="#l82.29"></a><span id="l82.29">     is(browserWindowsCount(), 1, &quot;Only one browser window should be open eventually&quot;);</span>
<a href="#l82.30"></a><span id="l82.30">     finish();</span>
<a href="#l82.31"></a><span id="l82.31" class="difflineminus">-  }, false);</span>
<a href="#l82.32"></a><span id="l82.32" class="difflineplus">+  });</span>
<a href="#l82.33"></a><span id="l82.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1" class="difflineminus">--- a/suite/common/tests/browser/browser_466937_sample.html</span>
<a href="#l83.2"></a><span id="l83.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_466937_sample.html</span>
<a href="#l83.3"></a><span id="l83.3" class="difflineat">@@ -4,18 +4,18 @@</span>
<a href="#l83.4"></a><span id="l83.4"> &lt;title&gt;Test for bug 466937&lt;/title&gt;</span>
<a href="#l83.5"></a><span id="l83.5"> </span>
<a href="#l83.6"></a><span id="l83.6"> &lt;input id=&quot;thief&quot; value=&quot;/home/user/secret&quot;&gt;</span>
<a href="#l83.7"></a><span id="l83.7"> &lt;input type=&quot;file&quot; id=&quot;reverse_thief&quot;&gt;</span>
<a href="#l83.8"></a><span id="l83.8"> &lt;input type=&quot;file&quot; id=&quot;bystander&quot;&gt;</span>
<a href="#l83.9"></a><span id="l83.9"> </span>
<a href="#l83.10"></a><span id="l83.10"> &lt;script&gt;</span>
<a href="#l83.11"></a><span id="l83.11">   window.addEventListener(&quot;DOMContentLoaded&quot;, function windowDOMContentLoaded() {</span>
<a href="#l83.12"></a><span id="l83.12" class="difflineminus">-    window.removeEventListener(&quot;DOMContentLoaded&quot;, windowDOMContentLoaded, false);</span>
<a href="#l83.13"></a><span id="l83.13" class="difflineplus">+    window.removeEventListener(&quot;DOMContentLoaded&quot;, windowDOMContentLoaded);</span>
<a href="#l83.14"></a><span id="l83.14">     if (!document.location.hash) {</span>
<a href="#l83.15"></a><span id="l83.15">       document.location.hash = &quot;#ready&quot;;</span>
<a href="#l83.16"></a><span id="l83.16">     }</span>
<a href="#l83.17"></a><span id="l83.17">     else {</span>
<a href="#l83.18"></a><span id="l83.18">       document.getElementById(&quot;thief&quot;).type = &quot;file&quot;;</span>
<a href="#l83.19"></a><span id="l83.19">       document.getElementById(&quot;reverse_thief&quot;).type = &quot;text&quot;;</span>
<a href="#l83.20"></a><span id="l83.20">     }</span>
<a href="#l83.21"></a><span id="l83.21" class="difflineminus">-  }, false);</span>
<a href="#l83.22"></a><span id="l83.22" class="difflineplus">+  });</span>
<a href="#l83.23"></a><span id="l83.23"> &lt;/script&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1" class="difflineminus">--- a/suite/common/tests/browser/browser_477657.js</span>
<a href="#l84.2"></a><span id="l84.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_477657.js</span>
<a href="#l84.3"></a><span id="l84.3" class="difflineat">@@ -19,17 +19,17 @@ function test() {</span>
<a href="#l84.4"></a><span id="l84.4">   // Test fails randomly on OS X (bug 482975)</span>
<a href="#l84.5"></a><span id="l84.5">   if (&quot;nsILocalFileMac&quot; in Components.interfaces)</span>
<a href="#l84.6"></a><span id="l84.6">     return;</span>
<a href="#l84.7"></a><span id="l84.7"> </span>
<a href="#l84.8"></a><span id="l84.8">   waitForExplicitFinish();</span>
<a href="#l84.9"></a><span id="l84.9"> </span>
<a href="#l84.10"></a><span id="l84.10">   let newWin = openDialog(location, &quot;_blank&quot;, &quot;chrome,all,dialog=no&quot;);</span>
<a href="#l84.11"></a><span id="l84.11">   newWin.addEventListener(&quot;load&quot;, function loadListener(aEvent) {</span>
<a href="#l84.12"></a><span id="l84.12" class="difflineminus">-    newWin.removeEventListener(&quot;load&quot;, loadListener, false);</span>
<a href="#l84.13"></a><span id="l84.13" class="difflineplus">+    newWin.removeEventListener(&quot;load&quot;, loadListener);</span>
<a href="#l84.14"></a><span id="l84.14"> </span>
<a href="#l84.15"></a><span id="l84.15">     let newState = { windows: [{</span>
<a href="#l84.16"></a><span id="l84.16">       tabs: [{ entries: [] }],</span>
<a href="#l84.17"></a><span id="l84.17">       _closedTabs: [{</span>
<a href="#l84.18"></a><span id="l84.18">         state: { entries: [{ url: &quot;about:&quot; }]},</span>
<a href="#l84.19"></a><span id="l84.19">         title: &quot;About:&quot;</span>
<a href="#l84.20"></a><span id="l84.20">       }],</span>
<a href="#l84.21"></a><span id="l84.21">       sizemode: &quot;maximized&quot;</span>
<a href="#l84.22"></a><span id="l84.22" class="difflineat">@@ -71,10 +71,10 @@ function test() {</span>
<a href="#l84.23"></a><span id="l84.23">                 &quot;the window was explicitly unmaximized&quot;);</span>
<a href="#l84.24"></a><span id="l84.24"> </span>
<a href="#l84.25"></a><span id="l84.25">           newWin.close();</span>
<a href="#l84.26"></a><span id="l84.26">           is(browserWindowsCount(), 1, &quot;Only one browser window should be open eventually&quot;);</span>
<a href="#l84.27"></a><span id="l84.27">           finish();</span>
<a href="#l84.28"></a><span id="l84.28">         }, 0);</span>
<a href="#l84.29"></a><span id="l84.29">       }, 0);</span>
<a href="#l84.30"></a><span id="l84.30">     }, 0);</span>
<a href="#l84.31"></a><span id="l84.31" class="difflineminus">-  }, false);</span>
<a href="#l84.32"></a><span id="l84.32" class="difflineplus">+  });</span>
<a href="#l84.33"></a><span id="l84.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1" class="difflineminus">--- a/suite/common/tests/browser/browser_490040.js</span>
<a href="#l85.2"></a><span id="l85.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_490040.js</span>
<a href="#l85.3"></a><span id="l85.3" class="difflineat">@@ -31,17 +31,17 @@ function test() {</span>
<a href="#l85.4"></a><span id="l85.4">       let theWin = aSubject.QueryInterface(Components.interfaces.nsIDOMWindow);</span>
<a href="#l85.5"></a><span id="l85.5">       if (origWin &amp;&amp; theWin != origWin)</span>
<a href="#l85.6"></a><span id="l85.6">         return;</span>
<a href="#l85.7"></a><span id="l85.7"> </span>
<a href="#l85.8"></a><span id="l85.8">       switch (aTopic) {</span>
<a href="#l85.9"></a><span id="l85.9">         case &quot;domwindowopened&quot;:</span>
<a href="#l85.10"></a><span id="l85.10">           origWin = theWin;</span>
<a href="#l85.11"></a><span id="l85.11">           theWin.addEventListener(&quot;load&quot;, function testTheWinLoad() {</span>
<a href="#l85.12"></a><span id="l85.12" class="difflineminus">-            theWin.removeEventListener(&quot;load&quot;, testTheWinLoad, false);</span>
<a href="#l85.13"></a><span id="l85.13" class="difflineplus">+            theWin.removeEventListener(&quot;load&quot;, testTheWinLoad);</span>
<a href="#l85.14"></a><span id="l85.14">             executeSoon(function () {</span>
<a href="#l85.15"></a><span id="l85.15">               // Close the window as soon as the first tab loads, or</span>
<a href="#l85.16"></a><span id="l85.16">               // immediately if there are no tabs.</span>
<a href="#l85.17"></a><span id="l85.17">               if (aState.windowState.windows[0].tabs[0].entries.length) {</span>
<a href="#l85.18"></a><span id="l85.18">                 theWin.gBrowser.addEventListener(&quot;load&quot;,</span>
<a href="#l85.19"></a><span id="l85.19">                                                    function testTheWinLoad2() {</span>
<a href="#l85.20"></a><span id="l85.20">                   theWin.gBrowser.removeEventListener(&quot;load&quot;, testTheWinLoad2,</span>
<a href="#l85.21"></a><span id="l85.21">                                                         true);</span>
<a href="#l85.22"></a><span id="l85.22" class="difflineat">@@ -50,17 +50,17 @@ function test() {</span>
<a href="#l85.23"></a><span id="l85.23">               } else {</span>
<a href="#l85.24"></a><span id="l85.24">                 executeSoon(function () {</span>
<a href="#l85.25"></a><span id="l85.25">                   theWin.close();</span>
<a href="#l85.26"></a><span id="l85.26">                 });</span>
<a href="#l85.27"></a><span id="l85.27">               }</span>
<a href="#l85.28"></a><span id="l85.28">               ss.setWindowState(theWin, JSON.stringify(aState.windowState),</span>
<a href="#l85.29"></a><span id="l85.29">                                 true);</span>
<a href="#l85.30"></a><span id="l85.30">             });</span>
<a href="#l85.31"></a><span id="l85.31" class="difflineminus">-          }, false);</span>
<a href="#l85.32"></a><span id="l85.32" class="difflineplus">+          });</span>
<a href="#l85.33"></a><span id="l85.33">           break;</span>
<a href="#l85.34"></a><span id="l85.34"> </span>
<a href="#l85.35"></a><span id="l85.35">         case &quot;domwindowclosed&quot;:</span>
<a href="#l85.36"></a><span id="l85.36">           Services.ww.unregisterNotification(windowObserver);</span>
<a href="#l85.37"></a><span id="l85.37">           // Use executeSoon to ensure this happens after SS observer.</span>
<a href="#l85.38"></a><span id="l85.38">           executeSoon(function () {</span>
<a href="#l85.39"></a><span id="l85.39">             is(ss.getClosedWindowCount(),</span>
<a href="#l85.40"></a><span id="l85.40">                curClosedWindowCount + (aState.shouldBeAdded ? 1 : 0),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l86.1"></a><span id="l86.1" class="difflineminus">--- a/suite/common/tests/browser/browser_514751.js</span>
<a href="#l86.2"></a><span id="l86.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_514751.js</span>
<a href="#l86.3"></a><span id="l86.3" class="difflineat">@@ -20,31 +20,31 @@ function test() {</span>
<a href="#l86.4"></a><span id="l86.4"> </span>
<a href="#l86.5"></a><span id="l86.5">   let windowObserver = {</span>
<a href="#l86.6"></a><span id="l86.6">     observe: function(aSubject, aTopic, aData) {</span>
<a href="#l86.7"></a><span id="l86.7">       let theWin = aSubject.QueryInterface(Ci.nsIDOMWindow);</span>
<a href="#l86.8"></a><span id="l86.8"> </span>
<a href="#l86.9"></a><span id="l86.9">       switch(aTopic) {</span>
<a href="#l86.10"></a><span id="l86.10">         case &quot;domwindowopened&quot;:</span>
<a href="#l86.11"></a><span id="l86.11">           theWin.addEventListener(&quot;load&quot;, function testTheWinLoad() {</span>
<a href="#l86.12"></a><span id="l86.12" class="difflineminus">-            theWin.removeEventListener(&quot;load&quot;, testTheWinLoad, false);</span>
<a href="#l86.13"></a><span id="l86.13" class="difflineplus">+            theWin.removeEventListener(&quot;load&quot;, testTheWinLoad);</span>
<a href="#l86.14"></a><span id="l86.14">             executeSoon(function() {</span>
<a href="#l86.15"></a><span id="l86.15">               var gotError = false;</span>
<a href="#l86.16"></a><span id="l86.16">               try {</span>
<a href="#l86.17"></a><span id="l86.17">                 ss.setWindowState(theWin, JSON.stringify(state), true);</span>
<a href="#l86.18"></a><span id="l86.18">               } catch (e) {</span>
<a href="#l86.19"></a><span id="l86.19">                 if (/NS_ERROR_MALFORMED_URI/.test(e))</span>
<a href="#l86.20"></a><span id="l86.20">                   gotError = true;</span>
<a href="#l86.21"></a><span id="l86.21">               }</span>
<a href="#l86.22"></a><span id="l86.22">               ok(!gotError, &quot;Didn't get a malformed URI error.&quot;);</span>
<a href="#l86.23"></a><span id="l86.23">               executeSoon(function() {</span>
<a href="#l86.24"></a><span id="l86.24">                 theWin.close();</span>
<a href="#l86.25"></a><span id="l86.25">               });</span>
<a href="#l86.26"></a><span id="l86.26">             });</span>
<a href="#l86.27"></a><span id="l86.27" class="difflineminus">-          }, false);</span>
<a href="#l86.28"></a><span id="l86.28" class="difflineplus">+          });</span>
<a href="#l86.29"></a><span id="l86.29">           break;</span>
<a href="#l86.30"></a><span id="l86.30"> </span>
<a href="#l86.31"></a><span id="l86.31">         case &quot;domwindowclosed&quot;:</span>
<a href="#l86.32"></a><span id="l86.32">           Services.ww.unregisterNotification(this);</span>
<a href="#l86.33"></a><span id="l86.33">           finish();</span>
<a href="#l86.34"></a><span id="l86.34">           break;</span>
<a href="#l86.35"></a><span id="l86.35">       }</span>
<a href="#l86.36"></a><span id="l86.36">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l87.1"></a><span id="l87.1" class="difflineminus">--- a/suite/common/tests/browser/browser_524745.js</span>
<a href="#l87.2"></a><span id="l87.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_524745.js</span>
<a href="#l87.3"></a><span id="l87.3" class="difflineat">@@ -18,17 +18,17 @@ function test() {</span>
<a href="#l87.4"></a><span id="l87.4"> </span>
<a href="#l87.5"></a><span id="l87.5">   let uniqKey = &quot;bug524745&quot;;</span>
<a href="#l87.6"></a><span id="l87.6">   let uniqVal = Date.now();</span>
<a href="#l87.7"></a><span id="l87.7"> </span>
<a href="#l87.8"></a><span id="l87.8">   waitForExplicitFinish();</span>
<a href="#l87.9"></a><span id="l87.9"> </span>
<a href="#l87.10"></a><span id="l87.10">   let window_B = openDialog(location, &quot;_blank&quot;, &quot;chrome,all,dialog=no&quot;);</span>
<a href="#l87.11"></a><span id="l87.11">   window_B.addEventListener(&quot;load&quot;, function testWindowBLoad(aEvent) {</span>
<a href="#l87.12"></a><span id="l87.12" class="difflineminus">-    window_B.removeEventListener(&quot;load&quot;, testWindowBLoad, false);</span>
<a href="#l87.13"></a><span id="l87.13" class="difflineplus">+    window_B.removeEventListener(&quot;load&quot;, testWindowBLoad);</span>
<a href="#l87.14"></a><span id="l87.14"> </span>
<a href="#l87.15"></a><span id="l87.15">       waitForFocus(function() {</span>
<a href="#l87.16"></a><span id="l87.16">         // Add identifying information to window_B</span>
<a href="#l87.17"></a><span id="l87.17">         ss.setWindowValue(window_B, uniqKey, uniqVal);</span>
<a href="#l87.18"></a><span id="l87.18">         let state = JSON.parse(ss.getBrowserState());</span>
<a href="#l87.19"></a><span id="l87.19">         let selectedWindow = state.windows[state.selectedWindow - 1];</span>
<a href="#l87.20"></a><span id="l87.20">         is(selectedWindow.extData &amp;&amp; selectedWindow.extData[uniqKey], uniqVal,</span>
<a href="#l87.21"></a><span id="l87.21">            &quot;selectedWindow is window_B&quot;);</span>
<a href="#l87.22"></a><span id="l87.22" class="difflineat">@@ -50,10 +50,10 @@ function test() {</span>
<a href="#l87.23"></a><span id="l87.23">           // Cleanup</span>
<a href="#l87.24"></a><span id="l87.24">           window.restore();</span>
<a href="#l87.25"></a><span id="l87.25">           window_B.close();</span>
<a href="#l87.26"></a><span id="l87.26">           is(browserWindowsCount(), 1,</span>
<a href="#l87.27"></a><span id="l87.27">              &quot;Only one browser window should be open eventually&quot;);</span>
<a href="#l87.28"></a><span id="l87.28">           finish();</span>
<a href="#l87.29"></a><span id="l87.29">         });</span>
<a href="#l87.30"></a><span id="l87.30">       }, window_B);</span>
<a href="#l87.31"></a><span id="l87.31" class="difflineminus">-  }, false);</span>
<a href="#l87.32"></a><span id="l87.32" class="difflineplus">+  });</span>
<a href="#l87.33"></a><span id="l87.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l88.1"></a><span id="l88.1" class="difflineminus">--- a/suite/common/tests/browser/browser_528776.js</span>
<a href="#l88.2"></a><span id="l88.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_528776.js</span>
<a href="#l88.3"></a><span id="l88.3" class="difflineat">@@ -15,15 +15,15 @@ function test() {</span>
<a href="#l88.4"></a><span id="l88.4">   /** Test for Bug 528776, ported by Bug 548228 **/</span>
<a href="#l88.5"></a><span id="l88.5"> </span>
<a href="#l88.6"></a><span id="l88.6">   waitForExplicitFinish();</span>
<a href="#l88.7"></a><span id="l88.7"> </span>
<a href="#l88.8"></a><span id="l88.8">   browserWindowsCount(1);</span>
<a href="#l88.9"></a><span id="l88.9"> </span>
<a href="#l88.10"></a><span id="l88.10">   var win = openDialog(location, &quot;&quot;, &quot;chrome,all,dialog=no&quot;);</span>
<a href="#l88.11"></a><span id="l88.11">   win.addEventListener(&quot;load&quot;, function loadListener() {</span>
<a href="#l88.12"></a><span id="l88.12" class="difflineminus">-    win.removeEventListener(&quot;load&quot;, loadListener, false);</span>
<a href="#l88.13"></a><span id="l88.13" class="difflineplus">+    win.removeEventListener(&quot;load&quot;, loadListener);</span>
<a href="#l88.14"></a><span id="l88.14">     browserWindowsCount(2);</span>
<a href="#l88.15"></a><span id="l88.15">     win.close();</span>
<a href="#l88.16"></a><span id="l88.16">     browserWindowsCount(1);</span>
<a href="#l88.17"></a><span id="l88.17">     finish();</span>
<a href="#l88.18"></a><span id="l88.18" class="difflineminus">-  }, false);</span>
<a href="#l88.19"></a><span id="l88.19" class="difflineplus">+  });</span>
<a href="#l88.20"></a><span id="l88.20"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l89.1"></a><span id="l89.1" class="difflineminus">--- a/suite/common/tests/browser/browser_586068-cascaded_restore.js</span>
<a href="#l89.2"></a><span id="l89.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_586068-cascaded_restore.js</span>
<a href="#l89.3"></a><span id="l89.3" class="difflineat">@@ -245,21 +245,21 @@ function test_multiWindowState() {</span>
<a href="#l89.4"></a><span id="l89.4">     runNextTest();</span>
<a href="#l89.5"></a><span id="l89.5">   }</span>
<a href="#l89.6"></a><span id="l89.6"> </span>
<a href="#l89.7"></a><span id="l89.7">   // We also want to catch the 2nd window, so we need to observe domwindowopened</span>
<a href="#l89.8"></a><span id="l89.8">   function windowObserver(aSubject, aTopic, aData) {</span>
<a href="#l89.9"></a><span id="l89.9">     let theWin = aSubject.QueryInterface(Components.interfaces.nsIDOMWindow);</span>
<a href="#l89.10"></a><span id="l89.10">     if (aTopic == &quot;domwindowopened&quot;) {</span>
<a href="#l89.11"></a><span id="l89.11">       theWin.addEventListener(&quot;load&quot;, function theWinLoad() {</span>
<a href="#l89.12"></a><span id="l89.12" class="difflineminus">-        theWin.removeEventListener(&quot;load&quot;, theWinLoad, false);</span>
<a href="#l89.13"></a><span id="l89.13" class="difflineplus">+        theWin.removeEventListener(&quot;load&quot;, theWinLoad);</span>
<a href="#l89.14"></a><span id="l89.14"> </span>
<a href="#l89.15"></a><span id="l89.15">         Services.ww.unregisterNotification(windowObserver);</span>
<a href="#l89.16"></a><span id="l89.16">         theWin.getBrowser().addTabsProgressListener(progressListener);</span>
<a href="#l89.17"></a><span id="l89.17" class="difflineminus">-      }, false);</span>
<a href="#l89.18"></a><span id="l89.18" class="difflineplus">+      });</span>
<a href="#l89.19"></a><span id="l89.19">     }</span>
<a href="#l89.20"></a><span id="l89.20">   }</span>
<a href="#l89.21"></a><span id="l89.21">   Services.ww.registerNotification(windowObserver);</span>
<a href="#l89.22"></a><span id="l89.22"> </span>
<a href="#l89.23"></a><span id="l89.23">   window.getBrowser().addTabsProgressListener(progressListener);</span>
<a href="#l89.24"></a><span id="l89.24">   ss.setBrowserState(JSON.stringify(state));</span>
<a href="#l89.25"></a><span id="l89.25"> }</span>
<a href="#l89.26"></a><span id="l89.26"> </span>
<a href="#l89.27"></a><span id="l89.27" class="difflineat">@@ -508,21 +508,21 @@ function test_setBrowserStateInterrupted</span>
<a href="#l89.28"></a><span id="l89.28">     runNextTest();</span>
<a href="#l89.29"></a><span id="l89.29">   }</span>
<a href="#l89.30"></a><span id="l89.30"> </span>
<a href="#l89.31"></a><span id="l89.31">   // We also want to catch the extra windows (there should be 2), so we need to observe domwindowopened</span>
<a href="#l89.32"></a><span id="l89.32">   function windowObserver(aSubject, aTopic, aData) {</span>
<a href="#l89.33"></a><span id="l89.33">     let theWin = aSubject.QueryInterface(Components.interfaces.nsIDOMWindow);</span>
<a href="#l89.34"></a><span id="l89.34">     if (aTopic == &quot;domwindowopened&quot;) {</span>
<a href="#l89.35"></a><span id="l89.35">       theWin.addEventListener(&quot;load&quot;, function wObserverTheWinLoad() {</span>
<a href="#l89.36"></a><span id="l89.36" class="difflineminus">-        theWin.removeEventListener(&quot;load&quot;, wObserverTheWinLoad, false);</span>
<a href="#l89.37"></a><span id="l89.37" class="difflineplus">+        theWin.removeEventListener(&quot;load&quot;, wObserverTheWinLoad);</span>
<a href="#l89.38"></a><span id="l89.38"> </span>
<a href="#l89.39"></a><span id="l89.39">         Services.ww.unregisterNotification(windowObserver);</span>
<a href="#l89.40"></a><span id="l89.40">         theWin.getBrowser().addTabsProgressListener(progressListener);</span>
<a href="#l89.41"></a><span id="l89.41" class="difflineminus">-      }, false);</span>
<a href="#l89.42"></a><span id="l89.42" class="difflineplus">+      });</span>
<a href="#l89.43"></a><span id="l89.43">     }</span>
<a href="#l89.44"></a><span id="l89.44">   }</span>
<a href="#l89.45"></a><span id="l89.45">   Services.ww.registerNotification(windowObserver);</span>
<a href="#l89.46"></a><span id="l89.46"> </span>
<a href="#l89.47"></a><span id="l89.47">   window.getBrowser().addTabsProgressListener(progressListener);</span>
<a href="#l89.48"></a><span id="l89.48">   ss.setBrowserState(JSON.stringify(state1));</span>
<a href="#l89.49"></a><span id="l89.49"> }</span>
<a href="#l89.50"></a><span id="l89.50"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l90.1"></a><span id="l90.1" class="difflineminus">--- a/suite/common/tests/browser/browser_615394-SSWindowState_events.js</span>
<a href="#l90.2"></a><span id="l90.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_615394-SSWindowState_events.js</span>
<a href="#l90.3"></a><span id="l90.3" class="difflineat">@@ -99,26 +99,26 @@ function test_setTabState() {</span>
<a href="#l90.4"></a><span id="l90.4">   }</span>
<a href="#l90.5"></a><span id="l90.5"> </span>
<a href="#l90.6"></a><span id="l90.6">   function onSSTabRestored(aEvent) {</span>
<a href="#l90.7"></a><span id="l90.7">     is(busyEventCount, 1);</span>
<a href="#l90.8"></a><span id="l90.8">     is(readyEventCount, 1);</span>
<a href="#l90.9"></a><span id="l90.9">     is(ss.getTabValue(tab, &quot;baz&quot;), &quot;qux&quot;);</span>
<a href="#l90.10"></a><span id="l90.10">     is(tab.linkedBrowser.currentURI.spec, &quot;http://example.org/&quot;);</span>
<a href="#l90.11"></a><span id="l90.11"> </span>
<a href="#l90.12"></a><span id="l90.12" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.13"></a><span id="l90.13" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.14"></a><span id="l90.14" class="difflineminus">-    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.15"></a><span id="l90.15" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.16"></a><span id="l90.16" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.17"></a><span id="l90.17" class="difflineplus">+    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.18"></a><span id="l90.18"> </span>
<a href="#l90.19"></a><span id="l90.19">     runNextTest();</span>
<a href="#l90.20"></a><span id="l90.20">   }</span>
<a href="#l90.21"></a><span id="l90.21"> </span>
<a href="#l90.22"></a><span id="l90.22" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.23"></a><span id="l90.23" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.24"></a><span id="l90.24" class="difflineminus">-  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.25"></a><span id="l90.25" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.26"></a><span id="l90.26" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.27"></a><span id="l90.27" class="difflineplus">+  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.28"></a><span id="l90.28">   ss.setTabState(tab, newTabState);</span>
<a href="#l90.29"></a><span id="l90.29"> }</span>
<a href="#l90.30"></a><span id="l90.30"> </span>
<a href="#l90.31"></a><span id="l90.31"> </span>
<a href="#l90.32"></a><span id="l90.32"> function test_duplicateTab() {</span>
<a href="#l90.33"></a><span id="l90.33">   let tab = getBrowser().tabs[1];</span>
<a href="#l90.34"></a><span id="l90.34">   let busyEventCount = 0;</span>
<a href="#l90.35"></a><span id="l90.35">   let readyEventCount = 0;</span>
<a href="#l90.36"></a><span id="l90.36" class="difflineat">@@ -140,26 +140,26 @@ function test_duplicateTab() {</span>
<a href="#l90.37"></a><span id="l90.37">   }</span>
<a href="#l90.38"></a><span id="l90.38"> </span>
<a href="#l90.39"></a><span id="l90.39">   function onSSTabRestored(aEvent) {</span>
<a href="#l90.40"></a><span id="l90.40">     is(busyEventCount, 1);</span>
<a href="#l90.41"></a><span id="l90.41">     is(readyEventCount, 1);</span>
<a href="#l90.42"></a><span id="l90.42">     is(ss.getTabValue(newTab, &quot;baz&quot;), &quot;qux&quot;);</span>
<a href="#l90.43"></a><span id="l90.43">     is(newTab.linkedBrowser.currentURI.spec, &quot;about:logo&quot;);</span>
<a href="#l90.44"></a><span id="l90.44"> </span>
<a href="#l90.45"></a><span id="l90.45" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.46"></a><span id="l90.46" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.47"></a><span id="l90.47" class="difflineminus">-    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.48"></a><span id="l90.48" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.49"></a><span id="l90.49" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.50"></a><span id="l90.50" class="difflineplus">+    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.51"></a><span id="l90.51"> </span>
<a href="#l90.52"></a><span id="l90.52">     runNextTest();</span>
<a href="#l90.53"></a><span id="l90.53">   }</span>
<a href="#l90.54"></a><span id="l90.54"> </span>
<a href="#l90.55"></a><span id="l90.55" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.56"></a><span id="l90.56" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.57"></a><span id="l90.57" class="difflineminus">-  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.58"></a><span id="l90.58" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.59"></a><span id="l90.59" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.60"></a><span id="l90.60" class="difflineplus">+  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.61"></a><span id="l90.61"> </span>
<a href="#l90.62"></a><span id="l90.62">   newTab = ss.duplicateTab(window, tab);</span>
<a href="#l90.63"></a><span id="l90.63"> }</span>
<a href="#l90.64"></a><span id="l90.64"> </span>
<a href="#l90.65"></a><span id="l90.65"> </span>
<a href="#l90.66"></a><span id="l90.66"> function test_undoCloseTab() {</span>
<a href="#l90.67"></a><span id="l90.67">   let tab = getBrowser().tabs[1],</span>
<a href="#l90.68"></a><span id="l90.68">       busyEventCount = 0,</span>
<a href="#l90.69"></a><span id="l90.69" class="difflineat">@@ -181,26 +181,26 @@ function test_undoCloseTab() {</span>
<a href="#l90.70"></a><span id="l90.70">   }</span>
<a href="#l90.71"></a><span id="l90.71"> </span>
<a href="#l90.72"></a><span id="l90.72">   function onSSTabRestored(aEvent) {</span>
<a href="#l90.73"></a><span id="l90.73">     is(busyEventCount, 1);</span>
<a href="#l90.74"></a><span id="l90.74">     is(readyEventCount, 1);</span>
<a href="#l90.75"></a><span id="l90.75">     is(ss.getTabValue(reopenedTab, &quot;baz&quot;), &quot;qux&quot;);</span>
<a href="#l90.76"></a><span id="l90.76">     is(reopenedTab.linkedBrowser.currentURI.spec, &quot;about:logo&quot;);</span>
<a href="#l90.77"></a><span id="l90.77"> </span>
<a href="#l90.78"></a><span id="l90.78" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.79"></a><span id="l90.79" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.80"></a><span id="l90.80" class="difflineminus">-    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.81"></a><span id="l90.81" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.82"></a><span id="l90.82" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.83"></a><span id="l90.83" class="difflineplus">+    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.84"></a><span id="l90.84"> </span>
<a href="#l90.85"></a><span id="l90.85">     runNextTest();</span>
<a href="#l90.86"></a><span id="l90.86">   }</span>
<a href="#l90.87"></a><span id="l90.87"> </span>
<a href="#l90.88"></a><span id="l90.88" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.89"></a><span id="l90.89" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.90"></a><span id="l90.90" class="difflineminus">-  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.91"></a><span id="l90.91" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.92"></a><span id="l90.92" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.93"></a><span id="l90.93" class="difflineplus">+  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.94"></a><span id="l90.94"> </span>
<a href="#l90.95"></a><span id="l90.95">   getBrowser().removeTab(tab);</span>
<a href="#l90.96"></a><span id="l90.96">   reopenedTab = ss.undoCloseTab(window, 0);</span>
<a href="#l90.97"></a><span id="l90.97"> }</span>
<a href="#l90.98"></a><span id="l90.98"> </span>
<a href="#l90.99"></a><span id="l90.99"> </span>
<a href="#l90.100"></a><span id="l90.100"> function test_setWindowState() {</span>
<a href="#l90.101"></a><span id="l90.101">   let testState = {</span>
<a href="#l90.102"></a><span id="l90.102" class="difflineat">@@ -230,26 +230,26 @@ function test_setWindowState() {</span>
<a href="#l90.103"></a><span id="l90.103">     if (++tabRestoredCount &lt; 2)</span>
<a href="#l90.104"></a><span id="l90.104">       return;</span>
<a href="#l90.105"></a><span id="l90.105"> </span>
<a href="#l90.106"></a><span id="l90.106">     is(busyEventCount, 1);</span>
<a href="#l90.107"></a><span id="l90.107">     is(readyEventCount, 1);</span>
<a href="#l90.108"></a><span id="l90.108">     is(getBrowser().tabs[0].linkedBrowser.currentURI.spec, &quot;about:mozilla&quot;);</span>
<a href="#l90.109"></a><span id="l90.109">     is(getBrowser().tabs[1].linkedBrowser.currentURI.spec, &quot;http://example.org/&quot;);</span>
<a href="#l90.110"></a><span id="l90.110"> </span>
<a href="#l90.111"></a><span id="l90.111" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.112"></a><span id="l90.112" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.113"></a><span id="l90.113" class="difflineminus">-    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.114"></a><span id="l90.114" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.115"></a><span id="l90.115" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.116"></a><span id="l90.116" class="difflineplus">+    getBrowser().tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.117"></a><span id="l90.117"> </span>
<a href="#l90.118"></a><span id="l90.118">     runNextTest();</span>
<a href="#l90.119"></a><span id="l90.119">   }</span>
<a href="#l90.120"></a><span id="l90.120"> </span>
<a href="#l90.121"></a><span id="l90.121" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.122"></a><span id="l90.122" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.123"></a><span id="l90.123" class="difflineminus">-  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.124"></a><span id="l90.124" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.125"></a><span id="l90.125" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.126"></a><span id="l90.126" class="difflineplus">+  getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.127"></a><span id="l90.127"> </span>
<a href="#l90.128"></a><span id="l90.128">   ss.setWindowState(window, JSON.stringify(testState), true);</span>
<a href="#l90.129"></a><span id="l90.129"> }</span>
<a href="#l90.130"></a><span id="l90.130"> </span>
<a href="#l90.131"></a><span id="l90.131"> </span>
<a href="#l90.132"></a><span id="l90.132"> function test_setBrowserState() {</span>
<a href="#l90.133"></a><span id="l90.133">   // We'll track events per window so we are sure that they are each happening once</span>
<a href="#l90.134"></a><span id="l90.134">   // pre window.</span>
<a href="#l90.135"></a><span id="l90.135" class="difflineat">@@ -258,55 +258,55 @@ function test_setBrowserState() {</span>
<a href="#l90.136"></a><span id="l90.136"> </span>
<a href="#l90.137"></a><span id="l90.137">   // waitForBrowserState does it's own observing for windows, but doesn't attach</span>
<a href="#l90.138"></a><span id="l90.138">   // the listeners we want here, so do it ourselves.</span>
<a href="#l90.139"></a><span id="l90.139">   let newWindow;</span>
<a href="#l90.140"></a><span id="l90.140">   function windowObserver(aSubject, aTopic, aData) {</span>
<a href="#l90.141"></a><span id="l90.141">     if (aTopic == &quot;domwindowopened&quot;) {</span>
<a href="#l90.142"></a><span id="l90.142">       newWindow = aSubject.QueryInterface(Components.interfaces.nsIDOMWindow);</span>
<a href="#l90.143"></a><span id="l90.143">       newWindow.addEventListener(&quot;load&quot;, function newWindowLoad() {</span>
<a href="#l90.144"></a><span id="l90.144" class="difflineminus">-        newWindow.removeEventListener(&quot;load&quot;, newWindowLoad, false);</span>
<a href="#l90.145"></a><span id="l90.145" class="difflineplus">+        newWindow.removeEventListener(&quot;load&quot;, newWindowLoad);</span>
<a href="#l90.146"></a><span id="l90.146"> </span>
<a href="#l90.147"></a><span id="l90.147">         Services.ww.unregisterNotification(windowObserver);</span>
<a href="#l90.148"></a><span id="l90.148"> </span>
<a href="#l90.149"></a><span id="l90.149">         windowEvents[getOuterWindowID(newWindow)] = { busyEventCount: 0, readyEventCount: 0 };</span>
<a href="#l90.150"></a><span id="l90.150"> </span>
<a href="#l90.151"></a><span id="l90.151" class="difflineminus">-        newWindow.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.152"></a><span id="l90.152" class="difflineminus">-        newWindow.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.153"></a><span id="l90.153" class="difflineminus">-      }, false);</span>
<a href="#l90.154"></a><span id="l90.154" class="difflineplus">+        newWindow.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.155"></a><span id="l90.155" class="difflineplus">+        newWindow.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.156"></a><span id="l90.156" class="difflineplus">+      });</span>
<a href="#l90.157"></a><span id="l90.157">     }</span>
<a href="#l90.158"></a><span id="l90.158">   }</span>
<a href="#l90.159"></a><span id="l90.159"> </span>
<a href="#l90.160"></a><span id="l90.160">   function onSSWindowStateBusy(aEvent) {</span>
<a href="#l90.161"></a><span id="l90.161">     windowEvents[getOuterWindowID(aEvent.originalTarget)].busyEventCount++;</span>
<a href="#l90.162"></a><span id="l90.162">   }</span>
<a href="#l90.163"></a><span id="l90.163"> </span>
<a href="#l90.164"></a><span id="l90.164">   function onSSWindowStateReady(aEvent) {</span>
<a href="#l90.165"></a><span id="l90.165">     windowEvents[getOuterWindowID(aEvent.originalTarget)].readyEventCount++;</span>
<a href="#l90.166"></a><span id="l90.166">   }</span>
<a href="#l90.167"></a><span id="l90.167"> </span>
<a href="#l90.168"></a><span id="l90.168" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.169"></a><span id="l90.169" class="difflineminus">-  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.170"></a><span id="l90.170" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.171"></a><span id="l90.171" class="difflineplus">+  window.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.172"></a><span id="l90.172">   Services.ww.registerNotification(windowObserver);</span>
<a href="#l90.173"></a><span id="l90.173"> </span>
<a href="#l90.174"></a><span id="l90.174">   waitForBrowserState(lameMultiWindowState, function() {</span>
<a href="#l90.175"></a><span id="l90.175">     let checkedWindows = 0;</span>
<a href="#l90.176"></a><span id="l90.176">     for (let [id, winEvents] of Object.entries(windowEvents)) {</span>
<a href="#l90.177"></a><span id="l90.177">       is(winEvents.busyEventCount, 1,</span>
<a href="#l90.178"></a><span id="l90.178">          &quot;[test_setBrowserState] window&quot; + id + &quot; busy event count correct&quot;);</span>
<a href="#l90.179"></a><span id="l90.179">       is(winEvents.readyEventCount, 1,</span>
<a href="#l90.180"></a><span id="l90.180">          &quot;[test_setBrowserState] window&quot; + id + &quot; ready event count correct&quot;);</span>
<a href="#l90.181"></a><span id="l90.181">       checkedWindows++;</span>
<a href="#l90.182"></a><span id="l90.182">     }</span>
<a href="#l90.183"></a><span id="l90.183">     is(checkedWindows, 2,</span>
<a href="#l90.184"></a><span id="l90.184">        &quot;[test_setBrowserState] checked 2 windows&quot;);</span>
<a href="#l90.185"></a><span id="l90.185" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.186"></a><span id="l90.186" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.187"></a><span id="l90.187" class="difflineminus">-    newWindow.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.188"></a><span id="l90.188" class="difflineminus">-    newWindow.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.189"></a><span id="l90.189" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.190"></a><span id="l90.190" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.191"></a><span id="l90.191" class="difflineplus">+    newWindow.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.192"></a><span id="l90.192" class="difflineplus">+    newWindow.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.193"></a><span id="l90.193">     runNextTest();</span>
<a href="#l90.194"></a><span id="l90.194">   });</span>
<a href="#l90.195"></a><span id="l90.195"> }</span>
<a href="#l90.196"></a><span id="l90.196"> </span>
<a href="#l90.197"></a><span id="l90.197"> </span>
<a href="#l90.198"></a><span id="l90.198"> function test_undoCloseWindow() {</span>
<a href="#l90.199"></a><span id="l90.199">   let newWindow, reopenedWindow;</span>
<a href="#l90.200"></a><span id="l90.200"> </span>
<a href="#l90.201"></a><span id="l90.201" class="difflineat">@@ -317,24 +317,24 @@ function test_undoCloseWindow() {</span>
<a href="#l90.202"></a><span id="l90.202">     }</span>
<a href="#l90.203"></a><span id="l90.203">   }</span>
<a href="#l90.204"></a><span id="l90.204">   Services.ww.registerNotification(firstWindowObserver);</span>
<a href="#l90.205"></a><span id="l90.205"> </span>
<a href="#l90.206"></a><span id="l90.206">   waitForBrowserState(lameMultiWindowState, function() {</span>
<a href="#l90.207"></a><span id="l90.207">     // Close the window which isn't window</span>
<a href="#l90.208"></a><span id="l90.208">     newWindow.close();</span>
<a href="#l90.209"></a><span id="l90.209">     reopenedWindow = ss.undoCloseWindow(0);</span>
<a href="#l90.210"></a><span id="l90.210" class="difflineminus">-    reopenedWindow.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.211"></a><span id="l90.211" class="difflineminus">-    reopenedWindow.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.212"></a><span id="l90.212" class="difflineplus">+    reopenedWindow.addEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.213"></a><span id="l90.213" class="difflineplus">+    reopenedWindow.addEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.214"></a><span id="l90.214"> </span>
<a href="#l90.215"></a><span id="l90.215">     reopenedWindow.addEventListener(&quot;load&quot;, function reopenWindowLoad() {</span>
<a href="#l90.216"></a><span id="l90.216" class="difflineminus">-      reopenedWindow.removeEventListener(&quot;load&quot;, reopenWindowLoad, false);</span>
<a href="#l90.217"></a><span id="l90.217" class="difflineplus">+      reopenedWindow.removeEventListener(&quot;load&quot;, reopenWindowLoad);</span>
<a href="#l90.218"></a><span id="l90.218"> </span>
<a href="#l90.219"></a><span id="l90.219" class="difflineminus">-      reopenedWindow.getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.220"></a><span id="l90.220" class="difflineminus">-    }, false);</span>
<a href="#l90.221"></a><span id="l90.221" class="difflineplus">+      reopenedWindow.getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.222"></a><span id="l90.222" class="difflineplus">+    });</span>
<a href="#l90.223"></a><span id="l90.223">   });</span>
<a href="#l90.224"></a><span id="l90.224"> </span>
<a href="#l90.225"></a><span id="l90.225">   let busyEventCount = 0,</span>
<a href="#l90.226"></a><span id="l90.226">       readyEventCount = 0,</span>
<a href="#l90.227"></a><span id="l90.227">       tabRestoredCount = 0;</span>
<a href="#l90.228"></a><span id="l90.228">   // These will listen to the reopened closed window...</span>
<a href="#l90.229"></a><span id="l90.229">   function onSSWindowStateBusy(aEvent) {</span>
<a href="#l90.230"></a><span id="l90.230">     busyEventCount++;</span>
<a href="#l90.231"></a><span id="l90.231" class="difflineat">@@ -346,17 +346,17 @@ function test_undoCloseWindow() {</span>
<a href="#l90.232"></a><span id="l90.232"> </span>
<a href="#l90.233"></a><span id="l90.233">   function onSSTabRestored(aEvent) {</span>
<a href="#l90.234"></a><span id="l90.234">     if (++tabRestoredCount &lt; 4)</span>
<a href="#l90.235"></a><span id="l90.235">       return;</span>
<a href="#l90.236"></a><span id="l90.236"> </span>
<a href="#l90.237"></a><span id="l90.237">     is(busyEventCount, 1);</span>
<a href="#l90.238"></a><span id="l90.238">     is(readyEventCount, 1);</span>
<a href="#l90.239"></a><span id="l90.239"> </span>
<a href="#l90.240"></a><span id="l90.240" class="difflineminus">-    reopenedWindow.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy, false);</span>
<a href="#l90.241"></a><span id="l90.241" class="difflineminus">-    reopenedWindow.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady, false);</span>
<a href="#l90.242"></a><span id="l90.242" class="difflineminus">-    reopenedWindow.gBrowser.tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, false);</span>
<a href="#l90.243"></a><span id="l90.243" class="difflineplus">+    reopenedWindow.removeEventListener(&quot;SSWindowStateBusy&quot;, onSSWindowStateBusy);</span>
<a href="#l90.244"></a><span id="l90.244" class="difflineplus">+    reopenedWindow.removeEventListener(&quot;SSWindowStateReady&quot;, onSSWindowStateReady);</span>
<a href="#l90.245"></a><span id="l90.245" class="difflineplus">+    reopenedWindow.gBrowser.tabContainer.removeEventListener(&quot;SSTabRestored&quot;, onSSTabRestored);</span>
<a href="#l90.246"></a><span id="l90.246"> </span>
<a href="#l90.247"></a><span id="l90.247">     reopenedWindow.close();</span>
<a href="#l90.248"></a><span id="l90.248"> </span>
<a href="#l90.249"></a><span id="l90.249">     runNextTest();</span>
<a href="#l90.250"></a><span id="l90.250">   }</span>
<a href="#l90.251"></a><span id="l90.251"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l91.1"></a><span id="l91.1" class="difflineminus">--- a/suite/common/tests/browser/browser_636279.js</span>
<a href="#l91.2"></a><span id="l91.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_636279.js</span>
<a href="#l91.3"></a><span id="l91.3" class="difflineat">@@ -24,17 +24,17 @@ function test() {</span>
<a href="#l91.4"></a><span id="l91.4">     TabsProgressListener.uninit();</span>
<a href="#l91.5"></a><span id="l91.5">     ss.setBrowserState(stateBackup);</span>
<a href="#l91.6"></a><span id="l91.6">   });</span>
<a href="#l91.7"></a><span id="l91.7"> </span>
<a href="#l91.8"></a><span id="l91.8"> </span>
<a href="#l91.9"></a><span id="l91.9">   TabsProgressListener.init();</span>
<a href="#l91.10"></a><span id="l91.10"> </span>
<a href="#l91.11"></a><span id="l91.11">   window.addEventListener(&quot;SSWindowStateReady&quot;, function onReady() {</span>
<a href="#l91.12"></a><span id="l91.12" class="difflineminus">-    window.removeEventListener(&quot;SSWindowStateReady&quot;, onReady, false);</span>
<a href="#l91.13"></a><span id="l91.13" class="difflineplus">+    window.removeEventListener(&quot;SSWindowStateReady&quot;, onReady);</span>
<a href="#l91.14"></a><span id="l91.14"> </span>
<a href="#l91.15"></a><span id="l91.15">     let firstProgress = true;</span>
<a href="#l91.16"></a><span id="l91.16"> </span>
<a href="#l91.17"></a><span id="l91.17">     TabsProgressListener.setCallback(function (needsRestore, isRestoring) {</span>
<a href="#l91.18"></a><span id="l91.18">       if (firstProgress) {</span>
<a href="#l91.19"></a><span id="l91.19">         firstProgress = false;</span>
<a href="#l91.20"></a><span id="l91.20">         is(isRestoring, 3, &quot;restoring 3 tabs concurrently&quot;);</span>
<a href="#l91.21"></a><span id="l91.21">       } else {</span>
<a href="#l91.22"></a><span id="l91.22" class="difflineat">@@ -43,17 +43,17 @@ function test() {</span>
<a href="#l91.23"></a><span id="l91.23"> </span>
<a href="#l91.24"></a><span id="l91.24">       if (0 == needsRestore) {</span>
<a href="#l91.25"></a><span id="l91.25">         TabsProgressListener.unsetCallback();</span>
<a href="#l91.26"></a><span id="l91.26">         waitForFocus(finish);</span>
<a href="#l91.27"></a><span id="l91.27">       }</span>
<a href="#l91.28"></a><span id="l91.28">     });</span>
<a href="#l91.29"></a><span id="l91.29"> </span>
<a href="#l91.30"></a><span id="l91.30">     ss.setBrowserState(JSON.stringify(state));</span>
<a href="#l91.31"></a><span id="l91.31" class="difflineminus">-  }, false);</span>
<a href="#l91.32"></a><span id="l91.32" class="difflineplus">+  });</span>
<a href="#l91.33"></a><span id="l91.33"> </span>
<a href="#l91.34"></a><span id="l91.34">   ss.setBrowserState(JSON.stringify(statePinned));</span>
<a href="#l91.35"></a><span id="l91.35"> }</span>
<a href="#l91.36"></a><span id="l91.36"> </span>
<a href="#l91.37"></a><span id="l91.37"> function countTabs() {</span>
<a href="#l91.38"></a><span id="l91.38">   let needsRestore = 0, isRestoring = 0;</span>
<a href="#l91.39"></a><span id="l91.39">   let windowsEnum = Services.wm.getEnumerator(&quot;navigator:browser&quot;);</span>
<a href="#l91.40"></a><span id="l91.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l92.1"></a><span id="l92.1" class="difflineminus">--- a/suite/common/tests/browser/browser_form_restore_events_sample.html</span>
<a href="#l92.2"></a><span id="l92.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_form_restore_events_sample.html</span>
<a href="#l92.3"></a><span id="l92.3" class="difflineat">@@ -2,23 +2,23 @@</span>
<a href="#l92.4"></a><span id="l92.4"> &lt;title&gt;Test for form restore events (originally bug 476161)&lt;/title&gt;</span>
<a href="#l92.5"></a><span id="l92.5"> </span>
<a href="#l92.6"></a><span id="l92.6"> &lt;script&gt;</span>
<a href="#l92.7"></a><span id="l92.7"> </span>
<a href="#l92.8"></a><span id="l92.8"> document.addEventListener(&quot;input&quot;, function(aEvent) {</span>
<a href="#l92.9"></a><span id="l92.9">   var inputEl = aEvent.originalTarget;</span>
<a href="#l92.10"></a><span id="l92.10">   var changedEl = document.getElementById(&quot;inputFired&quot;);</span>
<a href="#l92.11"></a><span id="l92.11">   changedEl.textContent += &quot; &quot; + inputEl.id;</span>
<a href="#l92.12"></a><span id="l92.12" class="difflineminus">-}, false);</span>
<a href="#l92.13"></a><span id="l92.13" class="difflineplus">+});</span>
<a href="#l92.14"></a><span id="l92.14"> </span>
<a href="#l92.15"></a><span id="l92.15"> document.addEventListener(&quot;change&quot;, function(aEvent) {</span>
<a href="#l92.16"></a><span id="l92.16">   var inputEl = aEvent.originalTarget;</span>
<a href="#l92.17"></a><span id="l92.17">   var changedEl = document.getElementById(&quot;changeFired&quot;);</span>
<a href="#l92.18"></a><span id="l92.18">   changedEl.textContent += &quot; &quot; + inputEl.id;</span>
<a href="#l92.19"></a><span id="l92.19" class="difflineminus">-}, false);</span>
<a href="#l92.20"></a><span id="l92.20" class="difflineplus">+});</span>
<a href="#l92.21"></a><span id="l92.21"> </span>
<a href="#l92.22"></a><span id="l92.22"> &lt;/script&gt;</span>
<a href="#l92.23"></a><span id="l92.23"> </span>
<a href="#l92.24"></a><span id="l92.24"> &lt;!-- input events --&gt;</span>
<a href="#l92.25"></a><span id="l92.25"> &lt;h3&gt;Text fields with changed text&lt;/h3&gt;</span>
<a href="#l92.26"></a><span id="l92.26"> &lt;input type=&quot;text&quot; id=&quot;modify1&quot;&gt;</span>
<a href="#l92.27"></a><span id="l92.27"> &lt;input type=&quot;text&quot; id=&quot;modify2&quot; value=&quot;preset value&quot;&gt;</span>
<a href="#l92.28"></a><span id="l92.28"> &lt;input type=&quot;text&quot; id=&quot;modify01&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l93.1"></a><span id="l93.1" class="difflineminus">--- a/suite/common/tests/browser/browser_markPageAsFollowedLink.js</span>
<a href="#l93.2"></a><span id="l93.2" class="difflineplus">+++ b/suite/common/tests/browser/browser_markPageAsFollowedLink.js</span>
<a href="#l93.3"></a><span id="l93.3" class="difflineat">@@ -44,20 +44,20 @@ function test()</span>
<a href="#l93.4"></a><span id="l93.4">   let frameCount = 0;</span>
<a href="#l93.5"></a><span id="l93.5">   gBrowser.selectedTab.linkedBrowser.addEventListener(&quot;DOMContentLoaded&quot;,</span>
<a href="#l93.6"></a><span id="l93.6">     function gBrowserDOMContentLoaded(event)</span>
<a href="#l93.7"></a><span id="l93.7">     {</span>
<a href="#l93.8"></a><span id="l93.8">       // Wait for all the frames.</span>
<a href="#l93.9"></a><span id="l93.9">       if (frameCount++ &lt; 2)</span>
<a href="#l93.10"></a><span id="l93.10">         return;</span>
<a href="#l93.11"></a><span id="l93.11">       gBrowser.selectedTab.linkedBrowser.removeEventListener(&quot;DOMContentLoaded&quot;,</span>
<a href="#l93.12"></a><span id="l93.12" class="difflineminus">-        gBrowserDOMContentLoaded, false)</span>
<a href="#l93.13"></a><span id="l93.13" class="difflineplus">+        gBrowserDOMContentLoaded)</span>
<a href="#l93.14"></a><span id="l93.14">       gTabLoaded = true;</span>
<a href="#l93.15"></a><span id="l93.15">       maybeClickLink();</span>
<a href="#l93.16"></a><span id="l93.16" class="difflineminus">-    }, false</span>
<a href="#l93.17"></a><span id="l93.17" class="difflineplus">+    }</span>
<a href="#l93.18"></a><span id="l93.18">   );</span>
<a href="#l93.19"></a><span id="l93.19"> }</span>
<a href="#l93.20"></a><span id="l93.20"> </span>
<a href="#l93.21"></a><span id="l93.21"> function maybeClickLink() {</span>
<a href="#l93.22"></a><span id="l93.22">   if (gTabLoaded &amp;&amp; gLeftFrameVisited) {</span>
<a href="#l93.23"></a><span id="l93.23">     // Click on the link in the left frame to cause a page load in the</span>
<a href="#l93.24"></a><span id="l93.24">     // right frame.</span>
<a href="#l93.25"></a><span id="l93.25">     EventUtils.sendMouseEvent({type: &quot;click&quot;}, &quot;clickme&quot;, content.frames[0]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l94.1"></a><span id="l94.1" class="difflineminus">--- a/suite/common/tests/browser/head.js</span>
<a href="#l94.2"></a><span id="l94.2" class="difflineplus">+++ b/suite/common/tests/browser/head.js</span>
<a href="#l94.3"></a><span id="l94.3" class="difflineat">@@ -52,28 +52,28 @@ function waitForBrowserState(aState, aSe</span>
<a href="#l94.4"></a><span id="l94.4">   }</span>
<a href="#l94.5"></a><span id="l94.5"> </span>
<a href="#l94.6"></a><span id="l94.6">   // Used to add our listener to further windows so we can catch SSTabRestored</span>
<a href="#l94.7"></a><span id="l94.7">   // coming from them when creating a multi-window state.</span>
<a href="#l94.8"></a><span id="l94.8">   function windowObserver(aSubject, aTopic, aData) {</span>
<a href="#l94.9"></a><span id="l94.9">     if (aTopic == &quot;domwindowopened&quot;) {</span>
<a href="#l94.10"></a><span id="l94.10">       let newWindow = aSubject.QueryInterface(Components.interfaces.nsIDOMWindow);</span>
<a href="#l94.11"></a><span id="l94.11">       newWindow.addEventListener(&quot;load&quot;, function newWindowLoad() {</span>
<a href="#l94.12"></a><span id="l94.12" class="difflineminus">-        newWindow.removeEventListener(&quot;load&quot;, newWindowLoad, false);</span>
<a href="#l94.13"></a><span id="l94.13" class="difflineplus">+        newWindow.removeEventListener(&quot;load&quot;, newWindowLoad);</span>
<a href="#l94.14"></a><span id="l94.14"> </span>
<a href="#l94.15"></a><span id="l94.15">         if (++windowsOpen == expectedWindows) {</span>
<a href="#l94.16"></a><span id="l94.16">           Services.ww.unregisterNotification(windowObserver);</span>
<a href="#l94.17"></a><span id="l94.17">           windowObserving = false;</span>
<a href="#l94.18"></a><span id="l94.18">         }</span>
<a href="#l94.19"></a><span id="l94.19"> </span>
<a href="#l94.20"></a><span id="l94.20">         // Track this window so we can remove the progress listener later</span>
<a href="#l94.21"></a><span id="l94.21">         windows.push(newWindow);</span>
<a href="#l94.22"></a><span id="l94.22">         // Add the progress listener</span>
<a href="#l94.23"></a><span id="l94.23">         newWindow.getBrowser().tabContainer.addEventListener(&quot;SSTabRestored&quot;, onSSTabRestored, true);</span>
<a href="#l94.24"></a><span id="l94.24" class="difflineminus">-      }, false);</span>
<a href="#l94.25"></a><span id="l94.25" class="difflineplus">+      });</span>
<a href="#l94.26"></a><span id="l94.26">     }</span>
<a href="#l94.27"></a><span id="l94.27">   }</span>
<a href="#l94.28"></a><span id="l94.28"> </span>
<a href="#l94.29"></a><span id="l94.29">   // We only want to register the notification if we expect more than 1 window</span>
<a href="#l94.30"></a><span id="l94.30">   if (expectedWindows &gt; 1) {</span>
<a href="#l94.31"></a><span id="l94.31">     registerCleanupFunction(function() {</span>
<a href="#l94.32"></a><span id="l94.32">       if (windowObserving) {</span>
<a href="#l94.33"></a><span id="l94.33">         Services.ww.unregisterNotification(windowObserver);</span>
<a href="#l94.34"></a><span id="l94.34" class="difflineat">@@ -133,19 +133,19 @@ function waitForSaveState(aSaveStateCall</span>
<a href="#l94.35"></a><span id="l94.35">   });</span>
<a href="#l94.36"></a><span id="l94.36"> </span>
<a href="#l94.37"></a><span id="l94.37">   observing = true;</span>
<a href="#l94.38"></a><span id="l94.38">   Services.obs.addObserver(observer, topic, false);</span>
<a href="#l94.39"></a><span id="l94.39"> };</span>
<a href="#l94.40"></a><span id="l94.40"> </span>
<a href="#l94.41"></a><span id="l94.41"> function whenWindowLoaded(aWindow, aCallback) {</span>
<a href="#l94.42"></a><span id="l94.42">   aWindow.addEventListener(&quot;load&quot;, function windowLoadListener() {</span>
<a href="#l94.43"></a><span id="l94.43" class="difflineminus">-    aWindow.removeEventListener(&quot;load&quot;, windowLoadListener, false);</span>
<a href="#l94.44"></a><span id="l94.44" class="difflineplus">+    aWindow.removeEventListener(&quot;load&quot;, windowLoadListener);</span>
<a href="#l94.45"></a><span id="l94.45">     executeSoon(function executeWhenWindowLoaded() {</span>
<a href="#l94.46"></a><span id="l94.46">       aCallback(aWindow);</span>
<a href="#l94.47"></a><span id="l94.47">     });</span>
<a href="#l94.48"></a><span id="l94.48" class="difflineminus">-  }, false);</span>
<a href="#l94.49"></a><span id="l94.49" class="difflineplus">+  });</span>
<a href="#l94.50"></a><span id="l94.50"> }</span>
<a href="#l94.51"></a><span id="l94.51"> </span>
<a href="#l94.52"></a><span id="l94.52"> var gUniqueCounter = 0;</span>
<a href="#l94.53"></a><span id="l94.53"> function r() {</span>
<a href="#l94.54"></a><span id="l94.54">   return Date.now() + &quot;-&quot; + (++gUniqueCounter);</span>
<a href="#l94.55"></a><span id="l94.55"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l95.1"></a><span id="l95.1" class="difflineminus">--- a/suite/common/utilityOverlay.js</span>
<a href="#l95.2"></a><span id="l95.2" class="difflineplus">+++ b/suite/common/utilityOverlay.js</span>
<a href="#l95.3"></a><span id="l95.3" class="difflineat">@@ -309,19 +309,19 @@ function goCustomizeToolbar(toolbox)</span>
<a href="#l95.4"></a><span id="l95.4">       sheetFrame.contentWindow.location.reload();</span>
<a href="#l95.5"></a><span id="l95.5">     else</span>
<a href="#l95.6"></a><span id="l95.6">       sheetFrame.setAttribute(&quot;src&quot;, customizeURL);</span>
<a href="#l95.7"></a><span id="l95.7"> </span>
<a href="#l95.8"></a><span id="l95.8">     // Open the panel, but make it invisible until the iframe has loaded so</span>
<a href="#l95.9"></a><span id="l95.9">     // that the user doesn't see a white flash.</span>
<a href="#l95.10"></a><span id="l95.10">     panel.style.visibility = &quot;hidden&quot;;</span>
<a href="#l95.11"></a><span id="l95.11">     toolbox.addEventListener(&quot;beforecustomization&quot;, function toolboxBeforeCustom() {</span>
<a href="#l95.12"></a><span id="l95.12" class="difflineminus">-      toolbox.removeEventListener(&quot;beforecustomization&quot;, toolboxBeforeCustom, false);</span>
<a href="#l95.13"></a><span id="l95.13" class="difflineplus">+      toolbox.removeEventListener(&quot;beforecustomization&quot;, toolboxBeforeCustom);</span>
<a href="#l95.14"></a><span id="l95.14">       panel.style.removeProperty(&quot;visibility&quot;);</span>
<a href="#l95.15"></a><span id="l95.15" class="difflineminus">-    }, false);</span>
<a href="#l95.16"></a><span id="l95.16" class="difflineplus">+    });</span>
<a href="#l95.17"></a><span id="l95.17">     panel.openPopup(toolbox, &quot;after_start&quot;, 0, 0);</span>
<a href="#l95.18"></a><span id="l95.18">     return sheetFrame.contentWindow;</span>
<a href="#l95.19"></a><span id="l95.19">   }</span>
<a href="#l95.20"></a><span id="l95.20">   else {</span>
<a href="#l95.21"></a><span id="l95.21">     return window.openDialog(customizeURL,</span>
<a href="#l95.22"></a><span id="l95.22">                              &quot;&quot;,</span>
<a href="#l95.23"></a><span id="l95.23">                              &quot;chrome,all,dependent&quot;,</span>
<a href="#l95.24"></a><span id="l95.24">                              toolbox);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l96.1"></a><span id="l96.1" class="difflineminus">--- a/suite/common/viewApplyThemeOverlay.js</span>
<a href="#l96.2"></a><span id="l96.2" class="difflineplus">+++ b/suite/common/viewApplyThemeOverlay.js</span>
<a href="#l96.3"></a><span id="l96.3" class="difflineat">@@ -152,21 +152,21 @@ function applyThemeOnLoad()</span>
<a href="#l96.4"></a><span id="l96.4">   // init globals</span>
<a href="#l96.5"></a><span id="l96.5">   gApplyThemeBundle = document.getElementById(&quot;bundle_viewApplyTheme&quot;);</span>
<a href="#l96.6"></a><span id="l96.6">   AddonManager.addAddonListener(gAddonListener);</span>
<a href="#l96.7"></a><span id="l96.7">   reloadThemes();</span>
<a href="#l96.8"></a><span id="l96.8"> </span>
<a href="#l96.9"></a><span id="l96.9">   removeEventListener(&quot;load&quot;, applyThemeOnLoad, false);</span>
<a href="#l96.10"></a><span id="l96.10">   addEventListener(&quot;unload&quot;, applyThemeOnUnload, false);</span>
<a href="#l96.11"></a><span id="l96.11">   var popup = document.getElementById(&quot;menu_viewApplyTheme_Popup&quot;);</span>
<a href="#l96.12"></a><span id="l96.12" class="difflineminus">-  popup.addEventListener(&quot;DOMMenuItemActive&quot;, previewTheme, false);</span>
<a href="#l96.13"></a><span id="l96.13" class="difflineminus">-  popup.addEventListener(&quot;DOMMenuItemInactive&quot;, previewTheme, false);</span>
<a href="#l96.14"></a><span id="l96.14" class="difflineplus">+  popup.addEventListener(&quot;DOMMenuItemActive&quot;, previewTheme);</span>
<a href="#l96.15"></a><span id="l96.15" class="difflineplus">+  popup.addEventListener(&quot;DOMMenuItemInactive&quot;, previewTheme);</span>
<a href="#l96.16"></a><span id="l96.16"> }</span>
<a href="#l96.17"></a><span id="l96.17"> </span>
<a href="#l96.18"></a><span id="l96.18"> function applyThemeOnUnload()</span>
<a href="#l96.19"></a><span id="l96.19"> {</span>
<a href="#l96.20"></a><span id="l96.20">   AddonManager.removeAddonListener(gAddonListener);</span>
<a href="#l96.21"></a><span id="l96.21">   var popup = document.getElementById(&quot;menu_viewApplyTheme_Popup&quot;);</span>
<a href="#l96.22"></a><span id="l96.22" class="difflineminus">-  popup.removeEventListener(&quot;DOMMenuItemActive&quot;, previewTheme, false);</span>
<a href="#l96.23"></a><span id="l96.23" class="difflineminus">-  popup.removeEventListener(&quot;DOMMenuItemInactive&quot;, previewTheme, false);</span>
<a href="#l96.24"></a><span id="l96.24" class="difflineplus">+  popup.removeEventListener(&quot;DOMMenuItemActive&quot;, previewTheme);</span>
<a href="#l96.25"></a><span id="l96.25" class="difflineplus">+  popup.removeEventListener(&quot;DOMMenuItemInactive&quot;, previewTheme);</span>
<a href="#l96.26"></a><span id="l96.26"> }</span>
<a href="#l96.27"></a><span id="l96.27"> </span>
<a href="#l96.28"></a><span id="l96.28"> addEventListener(&quot;load&quot;, applyThemeOnLoad, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l97.1"></a><span id="l97.1" class="difflineminus">--- a/suite/common/viewSourceOverlay.js</span>
<a href="#l97.2"></a><span id="l97.2" class="difflineplus">+++ b/suite/common/viewSourceOverlay.js</span>
<a href="#l97.3"></a><span id="l97.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l97.4"></a><span id="l97.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l97.5"></a><span id="l97.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l97.6"></a><span id="l97.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l97.7"></a><span id="l97.7"> </span>
<a href="#l97.8"></a><span id="l97.8"> // onload make sure we adapt what's needed for partial source</span>
<a href="#l97.9"></a><span id="l97.9" class="difflineminus">-window.addEventListener(&quot;load&quot;, onLoadViewSourceOverlay, false);</span>
<a href="#l97.10"></a><span id="l97.10" class="difflineplus">+window.addEventListener(&quot;load&quot;, onLoadViewSourceOverlay);</span>
<a href="#l97.11"></a><span id="l97.11"> </span>
<a href="#l97.12"></a><span id="l97.12"> function onLoadViewSourceOverlay() {</span>
<a href="#l97.13"></a><span id="l97.13">   if (/viewPartialSource\.xul$/.test(document.location)) {</span>
<a href="#l97.14"></a><span id="l97.14">     // disable menu items that don't work since the selection is munged and</span>
<a href="#l97.15"></a><span id="l97.15">     // the editor doesn't work for MathML</span>
<a href="#l97.16"></a><span id="l97.16">     document.getElementById('cmd_savePage').setAttribute('disabled', 'true');</span>
<a href="#l97.17"></a><span id="l97.17">     document.getElementById('cmd_editPage').setAttribute('disabled', 'true');</span>
<a href="#l97.18"></a><span id="l97.18">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l98.1"></a><span id="l98.1" class="difflineminus">--- a/suite/common/viewZoomOverlay.js</span>
<a href="#l98.2"></a><span id="l98.2" class="difflineplus">+++ b/suite/common/viewZoomOverlay.js</span>
<a href="#l98.3"></a><span id="l98.3" class="difflineat">@@ -327,26 +327,26 @@ var FullZoom = FullZoom || {</span>
<a href="#l98.4"></a><span id="l98.4">     if (aValue &gt; ZoomManager.MAX)</span>
<a href="#l98.5"></a><span id="l98.5">       return ZoomManager.MAX;</span>
<a href="#l98.6"></a><span id="l98.6"> </span>
<a href="#l98.7"></a><span id="l98.7">     return aValue;</span>
<a href="#l98.8"></a><span id="l98.8">   }</span>
<a href="#l98.9"></a><span id="l98.9"> };</span>
<a href="#l98.10"></a><span id="l98.10"> </span>
<a href="#l98.11"></a><span id="l98.11"> /***** init and helper functions for viewZoomOverlay.xul *****/</span>
<a href="#l98.12"></a><span id="l98.12" class="difflineminus">-window.addEventListener(&quot;load&quot;, registerZoomManager, false);</span>
<a href="#l98.13"></a><span id="l98.13" class="difflineminus">-window.addEventListener(&quot;unload&quot;, unregisterZoomManager, false);</span>
<a href="#l98.14"></a><span id="l98.14" class="difflineplus">+window.addEventListener(&quot;load&quot;, registerZoomManager);</span>
<a href="#l98.15"></a><span id="l98.15" class="difflineplus">+window.addEventListener(&quot;unload&quot;, unregisterZoomManager);</span>
<a href="#l98.16"></a><span id="l98.16"> </span>
<a href="#l98.17"></a><span id="l98.17"> function registerZoomManager() {</span>
<a href="#l98.18"></a><span id="l98.18">   FullZoom.init();</span>
<a href="#l98.19"></a><span id="l98.19"> </span>
<a href="#l98.20"></a><span id="l98.20">   var zoomBundle = document.getElementById(&quot;bundle_viewZoom&quot;);</span>
<a href="#l98.21"></a><span id="l98.21">   var zoomMenu = document.getElementById(&quot;menu_zoom&quot;);</span>
<a href="#l98.22"></a><span id="l98.22">   var parentMenu = zoomMenu.parentNode;</span>
<a href="#l98.23"></a><span id="l98.23" class="difflineminus">-  parentMenu.addEventListener(&quot;popupshowing&quot;, updateViewMenu, false);</span>
<a href="#l98.24"></a><span id="l98.24" class="difflineplus">+  parentMenu.addEventListener(&quot;popupshowing&quot;, updateViewMenu);</span>
<a href="#l98.25"></a><span id="l98.25"> </span>
<a href="#l98.26"></a><span id="l98.26">   // initialize menu from toolkit.zoomManager.zoomValues and assign accesskeys</span>
<a href="#l98.27"></a><span id="l98.27">   var zoomFactors = ZoomManager.zoomValues;</span>
<a href="#l98.28"></a><span id="l98.28">   var freeKeys = [ '0', '1', '2', '3', '4', '5', '6', '7', '8', '9' ];</span>
<a href="#l98.29"></a><span id="l98.29"> </span>
<a href="#l98.30"></a><span id="l98.30">   var insertBefore = document.getElementById(&quot;menu_zoomInsertBefore&quot;);</span>
<a href="#l98.31"></a><span id="l98.31">   var popup = insertBefore.parentNode;</span>
<a href="#l98.32"></a><span id="l98.32">   for (var i = 0; i &lt; zoomFactors.length; ++i) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l99.1"></a><span id="l99.1" class="difflineminus">--- a/suite/extensions/debugQA/content/debugQAMenuOverlay.js</span>
<a href="#l99.2"></a><span id="l99.2" class="difflineplus">+++ b/suite/extensions/debugQA/content/debugQAMenuOverlay.js</span>
<a href="#l99.3"></a><span id="l99.3" class="difflineat">@@ -1,22 +1,22 @@</span>
<a href="#l99.4"></a><span id="l99.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l99.5"></a><span id="l99.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l99.6"></a><span id="l99.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l99.7"></a><span id="l99.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l99.8"></a><span id="l99.8"> </span>
<a href="#l99.9"></a><span id="l99.9"> // &quot;about:bloat&quot; is available only when</span>
<a href="#l99.10"></a><span id="l99.10"> // (the application is) compiled with |--enable-logrefcnt|.</span>
<a href="#l99.11"></a><span id="l99.11"> if (&quot;@mozilla.org/network/protocol/about;1?what=bloat&quot; in Components.classes)</span>
<a href="#l99.12"></a><span id="l99.12" class="difflineminus">-  window.addEventListener(&quot;load&quot;, onLoadBloat, false);</span>
<a href="#l99.13"></a><span id="l99.13" class="difflineplus">+  window.addEventListener(&quot;load&quot;, onLoadBloat);</span>
<a href="#l99.14"></a><span id="l99.14"> </span>
<a href="#l99.15"></a><span id="l99.15"> // Unhide (and enable) the Bloat menu and its associated separator.</span>
<a href="#l99.16"></a><span id="l99.16"> function onLoadBloat()</span>
<a href="#l99.17"></a><span id="l99.17"> {</span>
<a href="#l99.18"></a><span id="l99.18" class="difflineminus">-  window.removeEventListener(&quot;load&quot;, onLoadBloat, false);</span>
<a href="#l99.19"></a><span id="l99.19" class="difflineplus">+  window.removeEventListener(&quot;load&quot;, onLoadBloat);</span>
<a href="#l99.20"></a><span id="l99.20"> </span>
<a href="#l99.21"></a><span id="l99.21">   // Ignore windows which don't get the Debug menu, like 'View Source'.</span>
<a href="#l99.22"></a><span id="l99.22">   if (!document.getElementById(&quot;debugMenu&quot;))</span>
<a href="#l99.23"></a><span id="l99.23">     return;</span>
<a href="#l99.24"></a><span id="l99.24"> </span>
<a href="#l99.25"></a><span id="l99.25">   // Enable the menu, only if its feature is currently active.</span>
<a href="#l99.26"></a><span id="l99.26">   var envSvc = Components.classes[&quot;@mozilla.org/process/environment;1&quot;]</span>
<a href="#l99.27"></a><span id="l99.27">                          .getService(Components.interfaces.nsIEnvironment);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l100.1"></a><span id="l100.1" class="difflineminus">--- a/suite/feeds/src/FeedWriter.js</span>
<a href="#l100.2"></a><span id="l100.2" class="difflineplus">+++ b/suite/feeds/src/FeedWriter.js</span>
<a href="#l100.3"></a><span id="l100.3" class="difflineat">@@ -924,21 +924,21 @@ FeedWriter.prototype = {</span>
<a href="#l100.4"></a><span id="l100.4">     this._setSubscribeUsingLabel();</span>
<a href="#l100.5"></a><span id="l100.5"> </span>
<a href="#l100.6"></a><span id="l100.6">     // &quot;Always use...&quot; checkbox initial state</span>
<a href="#l100.7"></a><span id="l100.7">     this._setAlwaysUseCheckedState(feedType);</span>
<a href="#l100.8"></a><span id="l100.8">     this._setAlwaysUseLabel();</span>
<a href="#l100.9"></a><span id="l100.9"> </span>
<a href="#l100.10"></a><span id="l100.10">     // We update the &quot;Always use..&quot; checkbox label whenever the selected item</span>
<a href="#l100.11"></a><span id="l100.11">     // in the list is changed</span>
<a href="#l100.12"></a><span id="l100.12" class="difflineminus">-    handlersMenuPopup.addEventListener(&quot;command&quot;, this, false);</span>
<a href="#l100.13"></a><span id="l100.13" class="difflineplus">+    handlersMenuPopup.addEventListener(&quot;command&quot;, this);</span>
<a href="#l100.14"></a><span id="l100.14"> </span>
<a href="#l100.15"></a><span id="l100.15">     // Set up the &quot;Subscribe Now&quot; button</span>
<a href="#l100.16"></a><span id="l100.16">     this._getUIElement(&quot;subscribeButton&quot;)</span>
<a href="#l100.17"></a><span id="l100.17" class="difflineminus">-        .addEventListener(&quot;command&quot;, this, false);</span>
<a href="#l100.18"></a><span id="l100.18" class="difflineplus">+        .addEventListener(&quot;command&quot;, this);</span>
<a href="#l100.19"></a><span id="l100.19"> </span>
<a href="#l100.20"></a><span id="l100.20">     // first-run ui</span>
<a href="#l100.21"></a><span id="l100.21">     var showFirstRunUI = true;</span>
<a href="#l100.22"></a><span id="l100.22">     try {</span>
<a href="#l100.23"></a><span id="l100.23">       showFirstRunUI = Services.prefs.getBoolPref(PREF_SHOW_FIRST_RUN_UI);</span>
<a href="#l100.24"></a><span id="l100.24">     }</span>
<a href="#l100.25"></a><span id="l100.25">     catch (ex) {</span>
<a href="#l100.26"></a><span id="l100.26">     }</span>
<a href="#l100.27"></a><span id="l100.27" class="difflineat">@@ -1028,18 +1028,18 @@ FeedWriter.prototype = {</span>
<a href="#l100.28"></a><span id="l100.28">     Services.prefs.addObserver(PREF_VIDEO_SELECTED_WEB, this, false);</span>
<a href="#l100.29"></a><span id="l100.29">     Services.prefs.addObserver(PREF_VIDEO_SELECTED_APP, this, false);</span>
<a href="#l100.30"></a><span id="l100.30"> </span>
<a href="#l100.31"></a><span id="l100.31">     Services.prefs.addObserver(PREF_AUDIO_SELECTED_ACTION, this, false);</span>
<a href="#l100.32"></a><span id="l100.32">     Services.prefs.addObserver(PREF_AUDIO_SELECTED_READER, this, false);</span>
<a href="#l100.33"></a><span id="l100.33">     Services.prefs.addObserver(PREF_AUDIO_SELECTED_WEB, this, false);</span>
<a href="#l100.34"></a><span id="l100.34">     Services.prefs.addObserver(PREF_AUDIO_SELECTED_APP, this, false);</span>
<a href="#l100.35"></a><span id="l100.35"> </span>
<a href="#l100.36"></a><span id="l100.36" class="difflineminus">-    this._window.addEventListener(&quot;load&quot;, this, false);</span>
<a href="#l100.37"></a><span id="l100.37" class="difflineminus">-    this._window.addEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l100.38"></a><span id="l100.38" class="difflineplus">+    this._window.addEventListener(&quot;load&quot;, this);</span>
<a href="#l100.39"></a><span id="l100.39" class="difflineplus">+    this._window.addEventListener(&quot;unload&quot;, this);</span>
<a href="#l100.40"></a><span id="l100.40">   },</span>
<a href="#l100.41"></a><span id="l100.41"> </span>
<a href="#l100.42"></a><span id="l100.42">   _writeContent: function writeContent() {</span>
<a href="#l100.43"></a><span id="l100.43">     if (!this._window)</span>
<a href="#l100.44"></a><span id="l100.44">       return;</span>
<a href="#l100.45"></a><span id="l100.45"> </span>
<a href="#l100.46"></a><span id="l100.46">     try {</span>
<a href="#l100.47"></a><span id="l100.47">       // Set up the feed content</span>
<a href="#l100.48"></a><span id="l100.48" class="difflineat">@@ -1052,22 +1052,22 @@ FeedWriter.prototype = {</span>
<a href="#l100.49"></a><span id="l100.49">       this._writeFeedContent(container);</span>
<a href="#l100.50"></a><span id="l100.50">     }</span>
<a href="#l100.51"></a><span id="l100.51">     finally {</span>
<a href="#l100.52"></a><span id="l100.52">       this._removeFeedFromCache();</span>
<a href="#l100.53"></a><span id="l100.53">     }</span>
<a href="#l100.54"></a><span id="l100.54">   },</span>
<a href="#l100.55"></a><span id="l100.55"> </span>
<a href="#l100.56"></a><span id="l100.56">   _close: function close() {</span>
<a href="#l100.57"></a><span id="l100.57" class="difflineminus">-    this._window.removeEventListener(&quot;load&quot;, this, false);</span>
<a href="#l100.58"></a><span id="l100.58" class="difflineminus">-    this._window.removeEventListener(&quot;unload&quot;, this, false);</span>
<a href="#l100.59"></a><span id="l100.59" class="difflineplus">+    this._window.removeEventListener(&quot;load&quot;, this);</span>
<a href="#l100.60"></a><span id="l100.60" class="difflineplus">+    this._window.removeEventListener(&quot;unload&quot;, this);</span>
<a href="#l100.61"></a><span id="l100.61">     this._getUIElement(&quot;handlersMenuPopup&quot;)</span>
<a href="#l100.62"></a><span id="l100.62" class="difflineminus">-        .removeEventListener(&quot;command&quot;, this, false);</span>
<a href="#l100.63"></a><span id="l100.63" class="difflineplus">+        .removeEventListener(&quot;command&quot;, this);</span>
<a href="#l100.64"></a><span id="l100.64">     this._getUIElement(&quot;subscribeButton&quot;)</span>
<a href="#l100.65"></a><span id="l100.65" class="difflineminus">-        .removeEventListener(&quot;command&quot;, this, false);</span>
<a href="#l100.66"></a><span id="l100.66" class="difflineplus">+        .removeEventListener(&quot;command&quot;, this);</span>
<a href="#l100.67"></a><span id="l100.67">     this._document = null;</span>
<a href="#l100.68"></a><span id="l100.68">     this._window = null;</span>
<a href="#l100.69"></a><span id="l100.69">     Services.prefs.removeObserver(PREF_SELECTED_ACTION, this);</span>
<a href="#l100.70"></a><span id="l100.70">     Services.prefs.removeObserver(PREF_SELECTED_READER, this);</span>
<a href="#l100.71"></a><span id="l100.71">     Services.prefs.removeObserver(PREF_SELECTED_WEB, this);</span>
<a href="#l100.72"></a><span id="l100.72">     Services.prefs.removeObserver(PREF_SELECTED_APP, this);</span>
<a href="#l100.73"></a><span id="l100.73">     Services.prefs.removeObserver(PREF_VIDEO_SELECTED_ACTION, this);</span>
<a href="#l100.74"></a><span id="l100.74">     Services.prefs.removeObserver(PREF_VIDEO_SELECTED_READER, this);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l101.1"></a><span id="l101.1" class="difflineminus">--- a/suite/mailnews/compose/MsgComposeCommands.js</span>
<a href="#l101.2"></a><span id="l101.2" class="difflineplus">+++ b/suite/mailnews/compose/MsgComposeCommands.js</span>
<a href="#l101.3"></a><span id="l101.3" class="difflineat">@@ -1168,18 +1168,18 @@ function ComposeStartup(aParams)</span>
<a href="#l101.4"></a><span id="l101.4">   }</span>
<a href="#l101.5"></a><span id="l101.5"> </span>
<a href="#l101.6"></a><span id="l101.6">   // Set the document language to the preference as early as possible.</span>
<a href="#l101.7"></a><span id="l101.7">   document.documentElement</span>
<a href="#l101.8"></a><span id="l101.8">           .setAttribute(&quot;lang&quot;, getPref(&quot;spellchecker.dictionary&quot;));</span>
<a href="#l101.9"></a><span id="l101.9"> </span>
<a href="#l101.10"></a><span id="l101.10">   var identityList = GetMsgIdentityElement();</span>
<a href="#l101.11"></a><span id="l101.11"> </span>
<a href="#l101.12"></a><span id="l101.12" class="difflineminus">-  document.addEventListener(&quot;paste&quot;, onPasteOrDrop, false);</span>
<a href="#l101.13"></a><span id="l101.13" class="difflineminus">-  document.addEventListener(&quot;drop&quot;, onPasteOrDrop, false);</span>
<a href="#l101.14"></a><span id="l101.14" class="difflineplus">+  document.addEventListener(&quot;paste&quot;, onPasteOrDrop);</span>
<a href="#l101.15"></a><span id="l101.15" class="difflineplus">+  document.addEventListener(&quot;drop&quot;, onPasteOrDrop);</span>
<a href="#l101.16"></a><span id="l101.16"> </span>
<a href="#l101.17"></a><span id="l101.17">   if (identityList)</span>
<a href="#l101.18"></a><span id="l101.18">     FillIdentityList(identityList);</span>
<a href="#l101.19"></a><span id="l101.19"> </span>
<a href="#l101.20"></a><span id="l101.20">   if (!params) {</span>
<a href="#l101.21"></a><span id="l101.21">     // This code will go away soon as now arguments are passed to the window</span>
<a href="#l101.22"></a><span id="l101.22">     // using a object of type nsMsgComposeParams instead of a string.</span>
<a href="#l101.23"></a><span id="l101.23">     params = Components.classes[&quot;@mozilla.org/messengercompose/composeparams;1&quot;]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l102.1"></a><span id="l102.1" class="difflineminus">--- a/suite/mailnews/compose/addressingWidgetOverlay.js</span>
<a href="#l102.2"></a><span id="l102.2" class="difflineplus">+++ b/suite/mailnews/compose/addressingWidgetOverlay.js</span>
<a href="#l102.3"></a><span id="l102.3" class="difflineat">@@ -923,28 +923,28 @@ function awGetNextDummyRow()</span>
<a href="#l102.4"></a><span id="l102.4">   return null;</span>
<a href="#l102.5"></a><span id="l102.5"> }</span>
<a href="#l102.6"></a><span id="l102.6"> </span>
<a href="#l102.7"></a><span id="l102.7"> function awSizerListen()</span>
<a href="#l102.8"></a><span id="l102.8"> {</span>
<a href="#l102.9"></a><span id="l102.9">   // when splitter is clicked, fill in necessary dummy rows each time the mouse is moved</span>
<a href="#l102.10"></a><span id="l102.10">   awCalcContentHeight(); // precalculate</span>
<a href="#l102.11"></a><span id="l102.11">   document.addEventListener(&quot;mousemove&quot;, awSizerMouseMove, true);</span>
<a href="#l102.12"></a><span id="l102.12" class="difflineminus">-  document.addEventListener(&quot;mouseup&quot;, awSizerMouseUp, false);</span>
<a href="#l102.13"></a><span id="l102.13" class="difflineplus">+  document.addEventListener(&quot;mouseup&quot;, awSizerMouseUp);</span>
<a href="#l102.14"></a><span id="l102.14"> }</span>
<a href="#l102.15"></a><span id="l102.15"> </span>
<a href="#l102.16"></a><span id="l102.16"> function awSizerMouseMove()</span>
<a href="#l102.17"></a><span id="l102.17"> {</span>
<a href="#l102.18"></a><span id="l102.18">   awCreateOrRemoveDummyRows(2);</span>
<a href="#l102.19"></a><span id="l102.19"> }</span>
<a href="#l102.20"></a><span id="l102.20"> </span>
<a href="#l102.21"></a><span id="l102.21"> function awSizerMouseUp()</span>
<a href="#l102.22"></a><span id="l102.22"> {</span>
<a href="#l102.23"></a><span id="l102.23" class="difflineminus">-  document.removeEventListener(&quot;mousemove&quot;, awSizerMouseMove, false);</span>
<a href="#l102.24"></a><span id="l102.24" class="difflineminus">-  document.removeEventListener(&quot;mouseup&quot;, awSizerMouseUp, false);</span>
<a href="#l102.25"></a><span id="l102.25" class="difflineplus">+  document.removeEventListener(&quot;mousemove&quot;, awSizerMouseMove);</span>
<a href="#l102.26"></a><span id="l102.26" class="difflineplus">+  document.removeEventListener(&quot;mouseup&quot;, awSizerMouseUp);</span>
<a href="#l102.27"></a><span id="l102.27"> }</span>
<a href="#l102.28"></a><span id="l102.28"> </span>
<a href="#l102.29"></a><span id="l102.29"> function awSizerResized(aSplitter)</span>
<a href="#l102.30"></a><span id="l102.30"> {</span>
<a href="#l102.31"></a><span id="l102.31">   // set the height on the listbox rather than on the toolbox</span>
<a href="#l102.32"></a><span id="l102.32">   var listbox = document.getElementById(&quot;addressingWidget&quot;);</span>
<a href="#l102.33"></a><span id="l102.33">   listbox.height = listbox.boxObject.height;</span>
<a href="#l102.34"></a><span id="l102.34">   // remove all the heights set on the splitter's previous siblings</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l103.1"></a><span id="l103.1" class="difflineminus">--- a/suite/mailnews/mailWidgets.xml</span>
<a href="#l103.2"></a><span id="l103.2" class="difflineplus">+++ b/suite/mailnews/mailWidgets.xml</span>
<a href="#l103.3"></a><span id="l103.3" class="difflineat">@@ -1775,30 +1775,30 @@</span>
<a href="#l103.4"></a><span id="l103.4">         ]]&gt;</span>
<a href="#l103.5"></a><span id="l103.5">       &lt;/destructor&gt;</span>
<a href="#l103.6"></a><span id="l103.6">     &lt;/implementation&gt;</span>
<a href="#l103.7"></a><span id="l103.7">     &lt;handlers&gt;</span>
<a href="#l103.8"></a><span id="l103.8">       &lt;handler event=&quot;mousemove&quot; action=&quot;this.updateHover(event);&quot;/&gt;</span>
<a href="#l103.9"></a><span id="l103.9">       &lt;handler event=&quot;click&quot; button=&quot;0&quot; action=&quot;if (this.updateHover(event) &gt;= 0) this.fire();&quot;/&gt;</span>
<a href="#l103.10"></a><span id="l103.10">       &lt;handler event=&quot;popupshowing&quot;&gt;</span>
<a href="#l103.11"></a><span id="l103.11">         &lt;![CDATA[</span>
<a href="#l103.12"></a><span id="l103.12" class="difflineminus">-          this.parentNode.addEventListener(&quot;blur&quot;, this.onBlurMenuList, false);</span>
<a href="#l103.13"></a><span id="l103.13" class="difflineplus">+          this.parentNode.addEventListener(&quot;blur&quot;, this.onBlurMenuList);</span>
<a href="#l103.14"></a><span id="l103.14">           var box = this.tree.treeBoxObject;</span>
<a href="#l103.15"></a><span id="l103.15">           box.focused = true;</span>
<a href="#l103.16"></a><span id="l103.16">           var index = this.setInitialSelection();</span>
<a href="#l103.17"></a><span id="l103.17">           var height = box.view.rowCount * box.rowHeight;</span>
<a href="#l103.18"></a><span id="l103.18">           height += this.boxObject.height - box.treeBody.boxObject.height;</span>
<a href="#l103.19"></a><span id="l103.19">           this.height = height;</span>
<a href="#l103.20"></a><span id="l103.20">           if (index &gt;= 0)</span>
<a href="#l103.21"></a><span id="l103.21">             setTimeout(function() { box.ensureRowIsVisible(index); }, 0);</span>
<a href="#l103.22"></a><span id="l103.22">         ]]&gt;</span>
<a href="#l103.23"></a><span id="l103.23">       &lt;/handler&gt;</span>
<a href="#l103.24"></a><span id="l103.24">       &lt;handler event=&quot;popuphiding&quot;&gt;</span>
<a href="#l103.25"></a><span id="l103.25">         &lt;![CDATA[</span>
<a href="#l103.26"></a><span id="l103.26" class="difflineminus">-          this.parentNode.removeEventListener(&quot;blur&quot;, this.onBlurMenuList, false);</span>
<a href="#l103.27"></a><span id="l103.27" class="difflineplus">+          this.parentNode.removeEventListener(&quot;blur&quot;, this.onBlurMenuList);</span>
<a href="#l103.28"></a><span id="l103.28">         ]]&gt;</span>
<a href="#l103.29"></a><span id="l103.29">       &lt;/handler&gt;</span>
<a href="#l103.30"></a><span id="l103.30">     &lt;/handlers&gt;</span>
<a href="#l103.31"></a><span id="l103.31">   &lt;/binding&gt;</span>
<a href="#l103.32"></a><span id="l103.32"> </span>
<a href="#l103.33"></a><span id="l103.33">   &lt;binding id=&quot;folderSummary-popup&quot; extends=&quot;chrome://global/content/bindings/popup.xml#tooltip&quot;&gt;</span>
<a href="#l103.34"></a><span id="l103.34">     &lt;content&gt;</span>
<a href="#l103.35"></a><span id="l103.35">       &lt;children&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l104.1"></a><span id="l104.1" class="difflineminus">--- a/suite/mailnews/msgHdrViewOverlay.js</span>
<a href="#l104.2"></a><span id="l104.2" class="difflineplus">+++ b/suite/mailnews/msgHdrViewOverlay.js</span>
<a href="#l104.3"></a><span id="l104.3" class="difflineat">@@ -1692,27 +1692,27 @@ function addAttachmentToPopup(popup, att</span>
<a href="#l104.4"></a><span id="l104.4"> </span>
<a href="#l104.5"></a><span id="l104.5">       var openpopup = document.createElement('menupopup');</span>
<a href="#l104.6"></a><span id="l104.6">       openpopup = item.appendChild(openpopup);</span>
<a href="#l104.7"></a><span id="l104.7">       if (attachment.contentType == &quot;text/x-moz-deleted&quot;) {</span>
<a href="#l104.8"></a><span id="l104.8">         item.setAttribute('disabled', 'true');</span>
<a href="#l104.9"></a><span id="l104.9">         return;</span>
<a href="#l104.10"></a><span id="l104.10">       }</span>
<a href="#l104.11"></a><span id="l104.11">       openpopup.attachment = attachment;</span>
<a href="#l104.12"></a><span id="l104.12" class="difflineminus">-      openpopup.addEventListener('popupshowing', FillAttachmentItemPopup, false);</span>
<a href="#l104.13"></a><span id="l104.13" class="difflineplus">+      openpopup.addEventListener('popupshowing', FillAttachmentItemPopup);</span>
<a href="#l104.14"></a><span id="l104.14">       setApplicationIconForAttachment(attachment, item);</span>
<a href="#l104.15"></a><span id="l104.15">     }</span>
<a href="#l104.16"></a><span id="l104.16">   }</span>
<a href="#l104.17"></a><span id="l104.17"> }</span>
<a href="#l104.18"></a><span id="l104.18"> </span>
<a href="#l104.19"></a><span id="l104.19"> function FillAttachmentItemPopup(event)</span>
<a href="#l104.20"></a><span id="l104.20"> {</span>
<a href="#l104.21"></a><span id="l104.21">   var openpopup = event.target;</span>
<a href="#l104.22"></a><span id="l104.22">   var canDetach = CanDetachAttachments() &amp;&amp; !openpopup.attachment.isExternalAttachment;</span>
<a href="#l104.23"></a><span id="l104.23" class="difflineminus">-  openpopup.removeEventListener('popupshowing', FillAttachmentItemPopup, false);</span>
<a href="#l104.24"></a><span id="l104.24" class="difflineplus">+  openpopup.removeEventListener('popupshowing', FillAttachmentItemPopup);</span>
<a href="#l104.25"></a><span id="l104.25"> </span>
<a href="#l104.26"></a><span id="l104.26">   var menuitementry = document.getElementById(&quot;context-openAttachment&quot;).cloneNode(false);</span>
<a href="#l104.27"></a><span id="l104.27">   menuitementry.setAttribute('oncommand', 'this.parentNode.attachment.openAttachment();');</span>
<a href="#l104.28"></a><span id="l104.28">   menuitementry = openpopup.appendChild(menuitementry);</span>
<a href="#l104.29"></a><span id="l104.29"> </span>
<a href="#l104.30"></a><span id="l104.30">   menuitementry = document.getElementById(&quot;context-viewAttachment&quot;).cloneNode(false);</span>
<a href="#l104.31"></a><span id="l104.31">   menuitementry.setAttribute('oncommand', 'this.parentNode.attachment.viewAttachment();');</span>
<a href="#l104.32"></a><span id="l104.32">   menuitementry = openpopup.appendChild(menuitementry);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l105.1"></a><span id="l105.1" class="difflineminus">--- a/suite/mailnews/msgViewPickerOverlay.js</span>
<a href="#l105.2"></a><span id="l105.2" class="difflineplus">+++ b/suite/mailnews/msgViewPickerOverlay.js</span>
<a href="#l105.3"></a><span id="l105.3" class="difflineat">@@ -413,9 +413,9 @@ function RefreshTagsPopup(aMenupopup)</span>
<a href="#l105.4"></a><span id="l105.4"> function ViewPickerOnLoad()</span>
<a href="#l105.5"></a><span id="l105.5"> {</span>
<a href="#l105.6"></a><span id="l105.6">   var viewPickerPopup = document.getElementById(&quot;viewPickerPopup&quot;);</span>
<a href="#l105.7"></a><span id="l105.7">   if (viewPickerPopup)</span>
<a href="#l105.8"></a><span id="l105.8">     RefreshAllViewPopups(viewPickerPopup);</span>
<a href="#l105.9"></a><span id="l105.9"> }</span>
<a href="#l105.10"></a><span id="l105.10"> </span>
<a href="#l105.11"></a><span id="l105.11"> </span>
<a href="#l105.12"></a><span id="l105.12" class="difflineminus">-window.addEventListener(&quot;load&quot;, ViewPickerOnLoad, false);</span>
<a href="#l105.13"></a><span id="l105.13" class="difflineplus">+window.addEventListener(&quot;load&quot;, ViewPickerOnLoad);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l106.1"></a><span id="l106.1" class="difflineminus">--- a/suite/mailnews/prefs/pref-tags.js</span>
<a href="#l106.2"></a><span id="l106.2" class="difflineplus">+++ b/suite/mailnews/prefs/pref-tags.js</span>
<a href="#l106.3"></a><span id="l106.3" class="difflineat">@@ -94,17 +94,17 @@ function AppendTagEntry(aTagInfo, aRefCh</span>
<a href="#l106.4"></a><span id="l106.4">   var colorCell = document.createElement('listcell');</span>
<a href="#l106.5"></a><span id="l106.5">   var colorpicker = document.createElement('colorpicker');</span>
<a href="#l106.6"></a><span id="l106.6">   colorpicker.setAttribute('type', 'button');</span>
<a href="#l106.7"></a><span id="l106.7">   colorpicker.setAttribute('color', aTagInfo.color || 'inherit')</span>
<a href="#l106.8"></a><span id="l106.8">   colorCell.appendChild(colorpicker);</span>
<a href="#l106.9"></a><span id="l106.9"> </span>
<a href="#l106.10"></a><span id="l106.10">   var entry = document.createElement('listitem');</span>
<a href="#l106.11"></a><span id="l106.11">   entry.addEventListener('focus', OnFocus, true);</span>
<a href="#l106.12"></a><span id="l106.12" class="difflineminus">-  entry.addEventListener('change', OnChange, false);</span>
<a href="#l106.13"></a><span id="l106.13" class="difflineplus">+  entry.addEventListener('change', OnChange);</span>
<a href="#l106.14"></a><span id="l106.14">   entry.setAttribute('allowevents', 'true');  // activate textbox and colorpicker</span>
<a href="#l106.15"></a><span id="l106.15">   entry.tagInfo = aTagInfo;</span>
<a href="#l106.16"></a><span id="l106.16">   entry.appendChild(tagCell);</span>
<a href="#l106.17"></a><span id="l106.17">   entry.appendChild(colorCell);</span>
<a href="#l106.18"></a><span id="l106.18"> </span>
<a href="#l106.19"></a><span id="l106.19">   gTagList.insertBefore(entry, aRefChild);</span>
<a href="#l106.20"></a><span id="l106.20">   return entry;</span>
<a href="#l106.21"></a><span id="l106.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l107.1"></a><span id="l107.1" class="difflineminus">--- a/suite/mailnews/tabmail.xml</span>
<a href="#l107.2"></a><span id="l107.2" class="difflineplus">+++ b/suite/mailnews/tabmail.xml</span>
<a href="#l107.3"></a><span id="l107.3" class="difflineat">@@ -1048,40 +1048,40 @@</span>
<a href="#l107.4"></a><span id="l107.4">           this.mTabMinWidth  = this.mPrefs.getIntPref (&quot;browser.tabs.tabMinWidth&quot;);</span>
<a href="#l107.5"></a><span id="l107.5">           this.mTabMaxWidth  = this.mPrefs.getIntPref (&quot;browser.tabs.tabMaxWidth&quot;);</span>
<a href="#l107.6"></a><span id="l107.6">           this.mTabClipWidth = this.mPrefs.getIntPref (&quot;browser.tabs.tabClipWidth&quot;);</span>
<a href="#l107.7"></a><span id="l107.7">           this.mCloseButtons = this.mPrefs.getIntPref (&quot;browser.tabs.closeButtons&quot;);</span>
<a href="#l107.8"></a><span id="l107.8">           this.firstChild.minWidth = this.mTabMinWidth;</span>
<a href="#l107.9"></a><span id="l107.9">           this.firstChild.maxWidth = this.mTabMaxWidth;</span>
<a href="#l107.10"></a><span id="l107.10">           this.adjustTabstrip();</span>
<a href="#l107.11"></a><span id="l107.11">           this.mPrefs.addObserver(&quot;browser.tabs.&quot;, this, false);</span>
<a href="#l107.12"></a><span id="l107.12" class="difflineminus">-          window.addEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l107.13"></a><span id="l107.13" class="difflineplus">+          window.addEventListener(&quot;resize&quot;, this);</span>
<a href="#l107.14"></a><span id="l107.14"> </span>
<a href="#l107.15"></a><span id="l107.15">           // Listen to overflow/underflow events on the tabstrip,</span>
<a href="#l107.16"></a><span id="l107.16">           // we cannot put these as xbl handlers on the entire binding because</span>
<a href="#l107.17"></a><span id="l107.17">           // they would also get called for the all-tabs popup scrollbox.</span>
<a href="#l107.18"></a><span id="l107.18">           // Also, we can't rely on event.target because these are all</span>
<a href="#l107.19"></a><span id="l107.19">           // anonymous nodes.</span>
<a href="#l107.20"></a><span id="l107.20" class="difflineminus">-          this.mTabstrip.addEventListener(&quot;overflow&quot;,  this, false);</span>
<a href="#l107.21"></a><span id="l107.21" class="difflineminus">-          this.mTabstrip.addEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l107.22"></a><span id="l107.22" class="difflineplus">+          this.mTabstrip.addEventListener(&quot;overflow&quot;,  this);</span>
<a href="#l107.23"></a><span id="l107.23" class="difflineplus">+          this.mTabstrip.addEventListener(&quot;underflow&quot;, this);</span>
<a href="#l107.24"></a><span id="l107.24">         ]]&gt;</span>
<a href="#l107.25"></a><span id="l107.25">       &lt;/constructor&gt;</span>
<a href="#l107.26"></a><span id="l107.26"> </span>
<a href="#l107.27"></a><span id="l107.27">       &lt;destructor&gt;</span>
<a href="#l107.28"></a><span id="l107.28">         &lt;![CDATA[</span>
<a href="#l107.29"></a><span id="l107.29">           this.mPrefs.removeObserver(&quot;browser.tabs.&quot;, this);</span>
<a href="#l107.30"></a><span id="l107.30"> </span>
<a href="#l107.31"></a><span id="l107.31">           // Release timer to avoid reference cycles.</span>
<a href="#l107.32"></a><span id="l107.32">           if (this._animateTimer)</span>
<a href="#l107.33"></a><span id="l107.33">           {</span>
<a href="#l107.34"></a><span id="l107.34">             this._animateTimer.cancel();</span>
<a href="#l107.35"></a><span id="l107.35">             this._animateTimer = null;</span>
<a href="#l107.36"></a><span id="l107.36">           }</span>
<a href="#l107.37"></a><span id="l107.37" class="difflineminus">-          this.mTabstrip.removeEventListener(&quot;overflow&quot;, this, false);</span>
<a href="#l107.38"></a><span id="l107.38" class="difflineminus">-          this.mTabstrip.removeEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l107.39"></a><span id="l107.39" class="difflineplus">+          this.mTabstrip.removeEventListener(&quot;overflow&quot;, this);</span>
<a href="#l107.40"></a><span id="l107.40" class="difflineplus">+          this.mTabstrip.removeEventListener(&quot;underflow&quot;, this);</span>
<a href="#l107.41"></a><span id="l107.41">         ]]&gt;</span>
<a href="#l107.42"></a><span id="l107.42">       &lt;/destructor&gt;</span>
<a href="#l107.43"></a><span id="l107.43"> </span>
<a href="#l107.44"></a><span id="l107.44">       &lt;field name=&quot;mPrefs&quot;&gt;</span>
<a href="#l107.45"></a><span id="l107.45">         Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l107.46"></a><span id="l107.46">                   .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l107.47"></a><span id="l107.47">       &lt;/field&gt;</span>
<a href="#l107.48"></a><span id="l107.48"> </span>
<a href="#l107.49"></a><span id="l107.49" class="difflineat">@@ -1398,37 +1398,37 @@</span>
<a href="#l107.50"></a><span id="l107.50">             aTabNode.mCorrespondingMenuitem = menuItem;</span>
<a href="#l107.51"></a><span id="l107.51">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;label&quot;);</span>
<a href="#l107.52"></a><span id="l107.52">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;crop&quot;);</span>
<a href="#l107.53"></a><span id="l107.53">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;image&quot;);</span>
<a href="#l107.54"></a><span id="l107.54">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;busy&quot;);</span>
<a href="#l107.55"></a><span id="l107.55">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;selected&quot;);</span>
<a href="#l107.56"></a><span id="l107.56">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;NewMessages&quot;);</span>
<a href="#l107.57"></a><span id="l107.57">             document.addBroadcastListenerFor(aTabNode, menuItem, &quot;BiffState&quot;);</span>
<a href="#l107.58"></a><span id="l107.58" class="difflineminus">-            aTabNode.addEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l107.59"></a><span id="l107.59" class="difflineplus">+            aTabNode.addEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l107.60"></a><span id="l107.60">             menuItem.tab = aTabNode;</span>
<a href="#l107.61"></a><span id="l107.61" class="difflineminus">-            menuItem.addEventListener(&quot;command&quot;, this, false);</span>
<a href="#l107.62"></a><span id="l107.62" class="difflineplus">+            menuItem.addEventListener(&quot;command&quot;, this);</span>
<a href="#l107.63"></a><span id="l107.63">             this.appendChild(menuItem);</span>
<a href="#l107.64"></a><span id="l107.64">             return menuItem;</span>
<a href="#l107.65"></a><span id="l107.65">           ]]&gt;</span>
<a href="#l107.66"></a><span id="l107.66">         &lt;/body&gt;</span>
<a href="#l107.67"></a><span id="l107.67">       &lt;/method&gt;</span>
<a href="#l107.68"></a><span id="l107.68">     &lt;/implementation&gt;</span>
<a href="#l107.69"></a><span id="l107.69"> </span>
<a href="#l107.70"></a><span id="l107.70">     &lt;handlers&gt;</span>
<a href="#l107.71"></a><span id="l107.71">       &lt;handler event=&quot;popupshowing&quot;&gt;</span>
<a href="#l107.72"></a><span id="l107.72">         &lt;![CDATA[</span>
<a href="#l107.73"></a><span id="l107.73">           // set up the menu popup</span>
<a href="#l107.74"></a><span id="l107.74">           let tabcontainer = document.getBindingParent(this);</span>
<a href="#l107.75"></a><span id="l107.75">           let tabs = tabcontainer.childNodes;</span>
<a href="#l107.76"></a><span id="l107.76"> </span>
<a href="#l107.77"></a><span id="l107.77">           // Listen for changes in the tab bar.</span>
<a href="#l107.78"></a><span id="l107.78">           let tabbrowser = document.getBindingParent(tabcontainer);</span>
<a href="#l107.79"></a><span id="l107.79" class="difflineminus">-          tabbrowser.addEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l107.80"></a><span id="l107.80" class="difflineminus">-          tabcontainer.mTabstrip.addEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l107.81"></a><span id="l107.81" class="difflineplus">+          tabbrowser.addEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l107.82"></a><span id="l107.82" class="difflineplus">+          tabcontainer.mTabstrip.addEventListener(&quot;scroll&quot;, this);</span>
<a href="#l107.83"></a><span id="l107.83"> </span>
<a href="#l107.84"></a><span id="l107.84">           // if an animation is in progress and the user</span>
<a href="#l107.85"></a><span id="l107.85">           // clicks on the &quot;all tabs&quot; button, stop the animation</span>
<a href="#l107.86"></a><span id="l107.86">           tabcontainer._stopAnimation();</span>
<a href="#l107.87"></a><span id="l107.87"> </span>
<a href="#l107.88"></a><span id="l107.88">           for (let i = 0; i &lt; tabs.length; i++)</span>
<a href="#l107.89"></a><span id="l107.89">             this._createTabMenuItem(tabs[i]);</span>
<a href="#l107.90"></a><span id="l107.90">           this._updateTabsVisibilityStatus();</span>
<a href="#l107.91"></a><span id="l107.91" class="difflineat">@@ -1443,24 +1443,24 @@</span>
<a href="#l107.92"></a><span id="l107.92">             let menuItem = this.lastChild;</span>
<a href="#l107.93"></a><span id="l107.93">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;label&quot;);</span>
<a href="#l107.94"></a><span id="l107.94">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;crop&quot;);</span>
<a href="#l107.95"></a><span id="l107.95">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;image&quot;);</span>
<a href="#l107.96"></a><span id="l107.96">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;busy&quot;);</span>
<a href="#l107.97"></a><span id="l107.97">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;selected&quot;);</span>
<a href="#l107.98"></a><span id="l107.98">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;NewMessages&quot;);</span>
<a href="#l107.99"></a><span id="l107.99">             document.removeBroadcastListenerFor(menuItem.tab, menuItem, &quot;BiffState&quot;);</span>
<a href="#l107.100"></a><span id="l107.100" class="difflineminus">-            menuItem.removeEventListener(&quot;command&quot;, this, false);</span>
<a href="#l107.101"></a><span id="l107.101" class="difflineminus">-            menuItem.tab.removeEventListener(&quot;TabClose&quot;, this, false);</span>
<a href="#l107.102"></a><span id="l107.102" class="difflineplus">+            menuItem.removeEventListener(&quot;command&quot;, this);</span>
<a href="#l107.103"></a><span id="l107.103" class="difflineplus">+            menuItem.tab.removeEventListener(&quot;TabClose&quot;, this);</span>
<a href="#l107.104"></a><span id="l107.104">             menuItem.tab.mCorrespondingMenuitem = null;</span>
<a href="#l107.105"></a><span id="l107.105">             menuItem.remove();</span>
<a href="#l107.106"></a><span id="l107.106">           }</span>
<a href="#l107.107"></a><span id="l107.107">           let tabcontainer = document.getBindingParent(this);</span>
<a href="#l107.108"></a><span id="l107.108" class="difflineminus">-          tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this, false);</span>
<a href="#l107.109"></a><span id="l107.109" class="difflineminus">-          document.getBindingParent(tabcontainer).removeEventListener(&quot;TabOpen&quot;, this, false);</span>
<a href="#l107.110"></a><span id="l107.110" class="difflineplus">+          tabcontainer.mTabstrip.removeEventListener(&quot;scroll&quot;, this);</span>
<a href="#l107.111"></a><span id="l107.111" class="difflineplus">+          document.getBindingParent(tabcontainer).removeEventListener(&quot;TabOpen&quot;, this);</span>
<a href="#l107.112"></a><span id="l107.112">         ]]&gt;</span>
<a href="#l107.113"></a><span id="l107.113">       &lt;/handler&gt;</span>
<a href="#l107.114"></a><span id="l107.114"> </span>
<a href="#l107.115"></a><span id="l107.115">       &lt;handler event=&quot;command&quot;&gt;</span>
<a href="#l107.116"></a><span id="l107.116">         &lt;![CDATA[</span>
<a href="#l107.117"></a><span id="l107.117">           let tabcontainer = document.getBindingParent(this);</span>
<a href="#l107.118"></a><span id="l107.118">           tabcontainer.selectedItem = event.target.tab;</span>
<a href="#l107.119"></a><span id="l107.119">         ]]&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l108.1"></a><span id="l108.1" class="difflineminus">--- a/suite/modules/DownloadTaskbarProgress.jsm</span>
<a href="#l108.2"></a><span id="l108.2" class="difflineplus">+++ b/suite/modules/DownloadTaskbarProgress.jsm</span>
<a href="#l108.3"></a><span id="l108.3" class="difflineat">@@ -185,17 +185,17 @@ var DownloadTaskbarProgressUpdater =</span>
<a href="#l108.4"></a><span id="l108.4">         let taskbarProgress = this._taskbar.getTaskbarProgress(docShell);</span>
<a href="#l108.5"></a><span id="l108.5">         this._activeTaskbarProgress = taskbarProgress;</span>
<a href="#l108.6"></a><span id="l108.6"> </span>
<a href="#l108.7"></a><span id="l108.7">         this._updateTaskbar();</span>
<a href="#l108.8"></a><span id="l108.8">         // _onActiveWindowUnload is idempotent, so we don't need to check whether</span>
<a href="#l108.9"></a><span id="l108.9">         // we've already set this before or not.</span>
<a href="#l108.10"></a><span id="l108.10">         aWindow.addEventListener(&quot;unload&quot;, function() {</span>
<a href="#l108.11"></a><span id="l108.11">           DownloadTaskbarProgressUpdater._onActiveWindowUnload(taskbarProgress);</span>
<a href="#l108.12"></a><span id="l108.12" class="difflineminus">-        }, false);</span>
<a href="#l108.13"></a><span id="l108.13" class="difflineplus">+        });</span>
<a href="#l108.14"></a><span id="l108.14">       }</span>
<a href="#l108.15"></a><span id="l108.15">       else {</span>
<a href="#l108.16"></a><span id="l108.16">         this._activeTaskbarProgress = null;</span>
<a href="#l108.17"></a><span id="l108.17">       }</span>
<a href="#l108.18"></a><span id="l108.18">     }</span>
<a href="#l108.19"></a><span id="l108.19">   },</span>
<a href="#l108.20"></a><span id="l108.20"> </span>
<a href="#l108.21"></a><span id="l108.21">   // / Current state displayed on the active window's taskbar item</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l109.1"></a><span id="l109.1" class="difflineminus">--- a/suite/modules/WindowsPreviewPerTab.jsm</span>
<a href="#l109.2"></a><span id="l109.2" class="difflineplus">+++ b/suite/modules/WindowsPreviewPerTab.jsm</span>
<a href="#l109.3"></a><span id="l109.3" class="difflineat">@@ -125,31 +125,31 @@ function getFaviconAsImage(iconurl, priv</span>
<a href="#l109.4"></a><span id="l109.4">  *        The &lt;tab&gt; that this preview is associated with.</span>
<a href="#l109.5"></a><span id="l109.5">  */</span>
<a href="#l109.6"></a><span id="l109.6"> function PreviewController(win, tab) {</span>
<a href="#l109.7"></a><span id="l109.7">   this.win = win;</span>
<a href="#l109.8"></a><span id="l109.8">   this.tab = tab;</span>
<a href="#l109.9"></a><span id="l109.9">   this.linkedBrowser = tab.linkedBrowser;</span>
<a href="#l109.10"></a><span id="l109.10">   this.preview = this.win.createTabPreview(this);</span>
<a href="#l109.11"></a><span id="l109.11"> </span>
<a href="#l109.12"></a><span id="l109.12" class="difflineminus">-  this.tab.addEventListener(&quot;TabAttrModified&quot;, this, false);</span>
<a href="#l109.13"></a><span id="l109.13" class="difflineplus">+  this.tab.addEventListener(&quot;TabAttrModified&quot;, this);</span>
<a href="#l109.14"></a><span id="l109.14"> </span>
<a href="#l109.15"></a><span id="l109.15">   XPCOMUtils.defineLazyGetter(this, &quot;canvasPreview&quot;, function () {</span>
<a href="#l109.16"></a><span id="l109.16">     let canvas = PageThumbs.createCanvas();</span>
<a href="#l109.17"></a><span id="l109.17">     canvas.mozOpaque = true;</span>
<a href="#l109.18"></a><span id="l109.18">     return canvas;</span>
<a href="#l109.19"></a><span id="l109.19">   });</span>
<a href="#l109.20"></a><span id="l109.20"> }</span>
<a href="#l109.21"></a><span id="l109.21"> </span>
<a href="#l109.22"></a><span id="l109.22"> PreviewController.prototype = {</span>
<a href="#l109.23"></a><span id="l109.23">   QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsITaskbarPreviewController,</span>
<a href="#l109.24"></a><span id="l109.24">                                          Components.interfaces.nsIDOMEventListener]),</span>
<a href="#l109.25"></a><span id="l109.25"> </span>
<a href="#l109.26"></a><span id="l109.26">   destroy: function () {</span>
<a href="#l109.27"></a><span id="l109.27" class="difflineminus">-    this.tab.removeEventListener(&quot;TabAttrModified&quot;, this, false);</span>
<a href="#l109.28"></a><span id="l109.28" class="difflineplus">+    this.tab.removeEventListener(&quot;TabAttrModified&quot;, this);</span>
<a href="#l109.29"></a><span id="l109.29"> </span>
<a href="#l109.30"></a><span id="l109.30">     // Break cycles, otherwise we end up leaking the window with everything</span>
<a href="#l109.31"></a><span id="l109.31">     // attached to it.</span>
<a href="#l109.32"></a><span id="l109.32">     delete this.win;</span>
<a href="#l109.33"></a><span id="l109.33">     delete this.preview;</span>
<a href="#l109.34"></a><span id="l109.34">   },</span>
<a href="#l109.35"></a><span id="l109.35"> </span>
<a href="#l109.36"></a><span id="l109.36">   get wrappedJSObject() {</span>
<a href="#l109.37"></a><span id="l109.37" class="difflineat">@@ -344,20 +344,20 @@ XPCOMUtils.defineLazyGetter(PreviewContr</span>
<a href="#l109.38"></a><span id="l109.38">  */</span>
<a href="#l109.39"></a><span id="l109.39"> function TabWindow(win) {</span>
<a href="#l109.40"></a><span id="l109.40">   this.win = win;</span>
<a href="#l109.41"></a><span id="l109.41">   this.tabbrowser = win.getBrowser();</span>
<a href="#l109.42"></a><span id="l109.42"> </span>
<a href="#l109.43"></a><span id="l109.43">   this.previews = new Map();</span>
<a href="#l109.44"></a><span id="l109.44"> </span>
<a href="#l109.45"></a><span id="l109.45">   for (let i = 0; i &lt; this.tabEvents.length; i++)</span>
<a href="#l109.46"></a><span id="l109.46" class="difflineminus">-    this.tabbrowser.tabContainer.addEventListener(this.tabEvents[i], this, false);</span>
<a href="#l109.47"></a><span id="l109.47" class="difflineplus">+    this.tabbrowser.tabContainer.addEventListener(this.tabEvents[i], this);</span>
<a href="#l109.48"></a><span id="l109.48"> </span>
<a href="#l109.49"></a><span id="l109.49">   for (let i = 0; i &lt; this.winEvents.length; i++)</span>
<a href="#l109.50"></a><span id="l109.50" class="difflineminus">-    this.win.addEventListener(this.winEvents[i], this, false);</span>
<a href="#l109.51"></a><span id="l109.51" class="difflineplus">+    this.win.addEventListener(this.winEvents[i], this);</span>
<a href="#l109.52"></a><span id="l109.52"> </span>
<a href="#l109.53"></a><span id="l109.53">   this.tabbrowser.addTabsProgressListener(this);</span>
<a href="#l109.54"></a><span id="l109.54"> </span>
<a href="#l109.55"></a><span id="l109.55">   AeroPeek.windows.push(this);</span>
<a href="#l109.56"></a><span id="l109.56">   let tabs = this.tabbrowser.tabs;</span>
<a href="#l109.57"></a><span id="l109.57">   for (let i = 0; i &lt; tabs.length; i++)</span>
<a href="#l109.58"></a><span id="l109.58">     this.newTab(tabs[i]);</span>
<a href="#l109.59"></a><span id="l109.59"> </span>
<a href="#l109.60"></a><span id="l109.60" class="difflineat">@@ -373,20 +373,20 @@ TabWindow.prototype = {</span>
<a href="#l109.61"></a><span id="l109.61">   destroy: function () {</span>
<a href="#l109.62"></a><span id="l109.62">     this._destroying = true;</span>
<a href="#l109.63"></a><span id="l109.63"> </span>
<a href="#l109.64"></a><span id="l109.64">     let tabs = this.tabbrowser.tabs;</span>
<a href="#l109.65"></a><span id="l109.65"> </span>
<a href="#l109.66"></a><span id="l109.66">     this.tabbrowser.removeTabsProgressListener(this);</span>
<a href="#l109.67"></a><span id="l109.67"> </span>
<a href="#l109.68"></a><span id="l109.68">     for (let i = 0; i &lt; this.winEvents.length; i++)</span>
<a href="#l109.69"></a><span id="l109.69" class="difflineminus">-      this.win.removeEventListener(this.winEvents[i], this, false);</span>
<a href="#l109.70"></a><span id="l109.70" class="difflineplus">+      this.win.removeEventListener(this.winEvents[i], this);</span>
<a href="#l109.71"></a><span id="l109.71"> </span>
<a href="#l109.72"></a><span id="l109.72">     for (let i = 0; i &lt; this.tabEvents.length; i++)</span>
<a href="#l109.73"></a><span id="l109.73" class="difflineminus">-      this.tabbrowser.tabContainer.removeEventListener(this.tabEvents[i], this, false);</span>
<a href="#l109.74"></a><span id="l109.74" class="difflineplus">+      this.tabbrowser.tabContainer.removeEventListener(this.tabEvents[i], this);</span>
<a href="#l109.75"></a><span id="l109.75"> </span>
<a href="#l109.76"></a><span id="l109.76">     for (let i = 0; i &lt; tabs.length; i++)</span>
<a href="#l109.77"></a><span id="l109.77">       this.removeTab(tabs[i]);</span>
<a href="#l109.78"></a><span id="l109.78"> </span>
<a href="#l109.79"></a><span id="l109.79">     let idx = AeroPeek.windows.indexOf(this.win.gTaskbarTabGroup);</span>
<a href="#l109.80"></a><span id="l109.80">     AeroPeek.windows.splice(idx, 1);</span>
<a href="#l109.81"></a><span id="l109.81">     AeroPeek.checkPreviewCount();</span>
<a href="#l109.82"></a><span id="l109.82">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l110.1"></a><span id="l110.1" class="difflineminus">--- a/suite/smile/test/browser_Application.js</span>
<a href="#l110.2"></a><span id="l110.2" class="difflineplus">+++ b/suite/smile/test/browser_Application.js</span>
<a href="#l110.3"></a><span id="l110.3" class="difflineat">@@ -20,33 +20,33 @@ WindowOpenListener.prototype = {</span>
<a href="#l110.4"></a><span id="l110.4">   opencallback: null,</span>
<a href="#l110.5"></a><span id="l110.5">   closecallback: null,</span>
<a href="#l110.6"></a><span id="l110.6">   window: null,</span>
<a href="#l110.7"></a><span id="l110.7">   domwindow: null,</span>
<a href="#l110.8"></a><span id="l110.8"> </span>
<a href="#l110.9"></a><span id="l110.9">   handleEvent: function(event) {</span>
<a href="#l110.10"></a><span id="l110.10">     is(this.domwindow.document.location.href, this.url, &quot;Should have opened the correct window&quot;);</span>
<a href="#l110.11"></a><span id="l110.11"> </span>
<a href="#l110.12"></a><span id="l110.12" class="difflineminus">-    this.domwindow.removeEventListener(&quot;load&quot;, this, false);</span>
<a href="#l110.13"></a><span id="l110.13" class="difflineplus">+    this.domwindow.removeEventListener(&quot;load&quot;, this);</span>
<a href="#l110.14"></a><span id="l110.14">     // Allow any other load handlers to execute</span>
<a href="#l110.15"></a><span id="l110.15">     var self = this;</span>
<a href="#l110.16"></a><span id="l110.16">     executeSoon(function() { self.opencallback(self.domwindow); } );</span>
<a href="#l110.17"></a><span id="l110.17">   },</span>
<a href="#l110.18"></a><span id="l110.18"> </span>
<a href="#l110.19"></a><span id="l110.19">   onWindowTitleChange: function(window, title) {</span>
<a href="#l110.20"></a><span id="l110.20">   },</span>
<a href="#l110.21"></a><span id="l110.21"> </span>
<a href="#l110.22"></a><span id="l110.22">   onOpenWindow: function(window) {</span>
<a href="#l110.23"></a><span id="l110.23">     if (this.window)</span>
<a href="#l110.24"></a><span id="l110.24">       return;</span>
<a href="#l110.25"></a><span id="l110.25"> </span>
<a href="#l110.26"></a><span id="l110.26">     this.window = window;</span>
<a href="#l110.27"></a><span id="l110.27">     this.domwindow = window.QueryInterface(Ci.nsIInterfaceRequestor)</span>
<a href="#l110.28"></a><span id="l110.28">                            .getInterface(Ci.nsIDOMWindow);</span>
<a href="#l110.29"></a><span id="l110.29" class="difflineminus">-    this.domwindow.addEventListener(&quot;load&quot;, this, false);</span>
<a href="#l110.30"></a><span id="l110.30" class="difflineplus">+    this.domwindow.addEventListener(&quot;load&quot;, this);</span>
<a href="#l110.31"></a><span id="l110.31">   },</span>
<a href="#l110.32"></a><span id="l110.32"> </span>
<a href="#l110.33"></a><span id="l110.33">   onCloseWindow: function(window) {</span>
<a href="#l110.34"></a><span id="l110.34">     if (this.window != window)</span>
<a href="#l110.35"></a><span id="l110.35">       return;</span>
<a href="#l110.36"></a><span id="l110.36"> </span>
<a href="#l110.37"></a><span id="l110.37">     Services.wm.removeListener(this);</span>
<a href="#l110.38"></a><span id="l110.38">     this.opencallback = null;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

